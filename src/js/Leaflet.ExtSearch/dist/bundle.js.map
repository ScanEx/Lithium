{"version":3,"sources":["webpack:///webpack/bootstrap ca419f4cb94460ca7e46","webpack:///./src/lib/EventTarget/src/EventTarget.js","webpack:///./src/SearchWidget.js","webpack:///./src/DataProviders/CadastreDataProvider.js","webpack:///./src/DataProviders/CoordinatesDataProvider.js","webpack:///./src/DataProviders/OsmDataProvider.js","webpack:///./src/SearchControl.js","webpack:///./init.js","webpack:///./src/ResultView.js","webpack:///./src/SearchWidget.css"],"names":["EventTarget","listeners","type","callback","push","stack","i","l","length","splice","removeEventListener","event","call","chain","tasks","state","reduce","prev","next","then","Promise","resolve","reject","SearchWidget","container","placeHolder","providers","suggestionTimeout","suggestionLimit","fuzzySearchLimit","retrieveManyOnEnter","replaceInputOnEnter","_container","_allowSuggestion","_providers","_suggestionTimeout","_suggestionLimit","_fuzzySearchLimit","_retrieveManyOnEnter","_replaceInputOnEnter","classList","add","innerHTML","_input","querySelector","_handleChange","bind","addEventListener","_handleMouseMove","_handleSearch","_button","results","input","replaceInput","_search","_selectItem","document","createEvent","initEvent","detail","e","dispatchEvent","text","allowNavigation","filter","provider","showSuggestion","map","completed","find","response","concat","catch","console","log","show","trim","value","_timer","setTimeout","clearTimeout","_suggest","hide","stopPropagation","preventDefault","showOnEnter","item","fetch","properties","placeholder","CadastreDataProvider","serverBase","tolerance","_serverBase","_tolerance","showOnSelect","_cadastreLayers","id","title","reg","str","len","it","exec","limit","strong","retrieveGeometry","cadastreLayer","getCadastreLayer","req","Request","headers","Headers","append","init","method","mode","cache","json","rs","features","name","x","attrs","cn","query","obj","status","CoordinatesDataProvider","rxF","RegExp","rxD","m","Array","isArray","_parseDegrees","parseFloat","coordinates","latDeg","latMin","latSec","lngDeg","lngMin","lngSec","g","_parseCoordinates","result","feature","geometry","OsmDataProvider","_convertGeometry","_key","window","KOSMOSNIMKI_SESSION_KEY","toUpperCase","ObjCode","TypeCode","credentials","Status","Result","a","SearchResult","Geometry","props","Object","keys","k","_strong","Boolean","_withoutGeometry","encodeURIComponent","ObjNameShort","SearchControl","L","Control","extend","includes","Evented","prototype","Mixin","Events","initialize","options","setOptions","onAdd","DomUtil","create","_widget","on","addTo","addBefore","parentNode","_parent","_map","_controlCorners","getPosition","childNodes","_id","insertBefore","setText","setPlaceHolder","nsGmx","ResultView","index","count","_item","_inputText","_replaceInput","_list","setAttribute","style","top","offsetTop","offsetHeight","left","offsetLeft","_handleKey","_handleInputClick","_handleFocus","_handleWheel","DomEvent","disableClickPropagation","disableScrollPropagation","parentElement","appendChild","el","removeClass","listVisible","keyCode","addClass","selectItem","focus","setSelectionRange","complete","display","_items","items","highlight","html","start","toLowerCase","indexOf","head","substr","tail","join","elements","querySelectorAll","_handleClick"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;IChEMA,W;AACF,2BAAa;AAAA;;AACT,aAAKC,SAAL,GAAiB,EAAjB;AACH;;;;yCACgBC,I,EAAMC,Q,EAAU;AAC7B,gBAAG,EAAED,QAAQ,KAAKD,SAAf,CAAH,EAA8B;AAC1B,qBAAKA,SAAL,CAAeC,IAAf,IAAuB,EAAvB;AACH;AACD,iBAAKD,SAAL,CAAeC,IAAf,EAAqBE,IAArB,CAA0BD,QAA1B;AACH;;;4CACoBD,I,EAAMC,Q,EAAU;AACjC,gBAAG,EAAED,QAAQ,KAAKD,SAAf,CAAH,EAA8B;AAC1B;AACH;AACD,gBAAII,QAAQ,KAAKJ,SAAL,CAAeC,IAAf,CAAZ;AACA,iBAAI,IAAII,IAAI,CAAR,EAAWC,IAAIF,MAAMG,MAAzB,EAAiCF,IAAIC,CAArC,EAAwCD,GAAxC,EAA6C;AACzC,oBAAGD,MAAMC,CAAN,MAAaH,QAAhB,EAAyB;AACrBE,0BAAMI,MAAN,CAAaH,CAAb,EAAgB,CAAhB;AACA,2BAAO,KAAKI,mBAAL,CAAyBR,IAAzB,EAA+BC,QAA/B,CAAP;AACH;AACJ;AACJ;;;sCACaQ,K,EAAO;AACjB,gBAAG,EAAEA,MAAMT,IAAN,IAAc,KAAKD,SAArB,CAAH,EAAoC;AAChC;AACH;AACD,gBAAII,QAAQ,KAAKJ,SAAL,CAAeU,MAAMT,IAArB,CAAZ;AACA;AACA,iBAAI,IAAII,IAAI,CAAR,EAAWC,IAAIF,MAAMG,MAAzB,EAAiCF,IAAIC,CAArC,EAAwCD,GAAxC,EAA6C;AACzCD,sBAAMC,CAAN,EAASM,IAAT,CAAc,IAAd,EAAoBD,KAApB;AACH;AACJ;;;;;;QAGIX,W,GAAAA,W;;;;;;;;;;;;;;;;AClCT;;AACA;;AACA;;;;;;;;AAEA,SAASa,KAAT,CAAgBC,KAAhB,EAAuBC,KAAvB,EAA8B;AAC1B,WAAOD,MAAME,MAAN,CACH,UAACC,IAAD,EAAOC,IAAP;AAAA,eAAgBD,KAAKE,IAAL,CAAUD,IAAV,CAAhB;AAAA,KADG,EAEH,IAAIE,OAAJ,CAAa,UAACC,OAAD,EAAUC,MAAV;AAAA,eAAqBD,QAASN,KAAT,CAArB;AAAA,KAAb,CAFG,CAAP;AAIH;;IAEKQ,Y;;;AACF,0BAAYC,SAAZ,QAAmL;AAAA,YAA3JC,WAA2J,QAA3JA,WAA2J;AAAA,YAA9IC,SAA8I,QAA9IA,SAA8I;AAAA,yCAAnIC,iBAAmI;AAAA,YAAnIA,iBAAmI,yCAA/G,IAA+G;AAAA,wCAAzGC,eAAyG;AAAA,YAAzGA,eAAyG,wCAAvF,EAAuF;AAAA,yCAAnFC,gBAAmF;AAAA,YAAnFA,gBAAmF,yCAAhE,IAAgE;AAAA,yCAA1DC,mBAA0D;AAAA,YAA1DA,mBAA0D,yCAApC,KAAoC;AAAA,yCAA7BC,mBAA6B;AAAA,YAA7BA,mBAA6B,yCAAP,KAAO;;AAAA;;AAAA;;AAE/K,cAAKC,UAAL,GAAkBR,SAAlB;AACA,cAAKS,gBAAL,GAAwB,IAAxB;AACA,cAAKC,UAAL,GAAkBR,SAAlB;AACA,cAAKS,kBAAL,GAA0BR,iBAA1B;AACA,cAAKS,gBAAL,GAAwBR,eAAxB;AACA,cAAKS,iBAAL,GAAyBR,gBAAzB;AACA,cAAKS,oBAAL,GAA4BR,mBAA5B;AACA,cAAKS,oBAAL,GAA4BR,mBAA5B;;AAEA,cAAKC,UAAL,CAAgBQ,SAAhB,CAA0BC,GAA1B,CAA8B,oBAA9B;AACA,cAAKT,UAAL,CAAgBU,SAAhB,iDAAwEjB,WAAxE;AACA,cAAKkB,MAAL,GAAc,MAAKX,UAAL,CAAgBY,aAAhB,CAA8B,OAA9B,CAAd;;AAEA,cAAKC,aAAL,GAAqB,MAAKA,aAAL,CAAmBC,IAAnB,OAArB;AACA,cAAKH,MAAL,CAAYI,gBAAZ,CAA6B,OAA7B,EAAsC,MAAKF,aAA3C;;AAEA,cAAKG,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBF,IAAtB,OAAxB;AACA,cAAKH,MAAL,CAAYI,gBAAZ,CAA6B,WAA7B,EAA0C,MAAKC,gBAA/C;AACA,cAAKL,MAAL,CAAYI,gBAAZ,CAA6B,WAA7B,EAA0C,MAAKC,gBAA/C;AACA,cAAKL,MAAL,CAAYI,gBAAZ,CAA6B,MAA7B,EAAqC,MAAKC,gBAA1C;;AAEA,cAAKC,aAAL,GAAqB,MAAKA,aAAL,CAAmBH,IAAnB,OAArB;;AAEA,cAAKI,OAAL,GAAe,MAAKlB,UAAL,CAAgBY,aAAhB,CAA8B,4BAA9B,CAAf;AACA,cAAKM,OAAL,CAAaH,gBAAb,CAA8B,OAA9B,EAAuC,MAAKE,aAA5C;;AAEA,cAAKE,OAAL,GAAe,2BAAe,EAAEC,OAAO,MAAKT,MAAd,EAAsBU,cAAc,MAAKd,oBAAzC,EAAf,CAAf;;AAEA,cAAKe,OAAL,GAAe,MAAKA,OAAL,CAAaR,IAAb,OAAf;AACA,cAAKS,WAAL,GAAmB,MAAKA,WAAL,CAAiBT,IAAjB,OAAnB;;AAEA,cAAKK,OAAL,CAAaJ,gBAAb,CAA8B,qBAA9B,EAAqD,aAAK;AACtD,gBAAIpC,QAAQ6C,SAASC,WAAT,CAAqB,OAArB,CAAZ;AACA9C,kBAAM+C,SAAN,CAAgB,qBAAhB,EAAuC,KAAvC,EAA8C,KAA9C;AACA/C,kBAAMgD,MAAN,GAAeC,EAAED,MAAjB;AACA,kBAAKE,aAAL,CAAmBlD,KAAnB;AACA,kBAAK2C,OAAL,CAAaM,CAAb;AACH,SAND;AAOA,cAAKT,OAAL,CAAaJ,gBAAb,CAA8B,oBAA9B,EAAoD,MAAKQ,WAAzD;;AAEA;AACA;AA3C+K;AA4ClL;;;;iCACSO,I,EAAK;AAAA;;AACX,iBAAKX,OAAL,CAAaY,eAAb,GAA+B,KAA/B;AACA,gBAAIjD,QACA,KAAKoB,UAAL,CACC8B,MADD,CACS;AAAA,uBAAYC,SAASC,cAArB;AAAA,aADT,EAECC,GAFD,CAEK,oBAAY;AACb,uBAAO,iBAAS;AACZ,2BAAO,IAAI/C,OAAJ,CAAY,mBAAW;AAC1B,4BAAIL,MAAMqD,SAAV,EAAqB;AACjB/C,oCAAQN,KAAR;AACH,yBAFD,MAGK;AACDkD,qCACCI,IADD,CACOP,IADP,EACa,OAAK1B,gBADlB,EACoC,KADpC,EAC2C,KAD3C,EAECjB,IAFD,CAEM,oBAAY;AACdJ,sCAAMqD,SAAN,GAAkBE,SAAS9D,MAAT,GAAkB,CAApC;AACAO,sCAAMuD,QAAN,GAAiBvD,MAAMuD,QAAN,CAAeC,MAAf,CAAsBD,QAAtB,CAAjB;AACAjD,wCAAQN,KAAR;AACH,6BAND,EAOCyD,KAPD,CAOO;AAAA,uCAAKC,QAAQC,GAAR,CAAYd,CAAZ,CAAL;AAAA,6BAPP;AAQH;AACJ,qBAdM,CAAP;AAeH,iBAhBD;AAiBH,aApBD,CADJ;AAsBA/C,kBAAOC,KAAP,EAAc,EAAEsD,WAAW,KAAb,EAAoBE,UAAU,EAA9B,EAAd,EACCnD,IADD,CACM,iBAAS;AACX,uBAAKgC,OAAL,CAAawB,IAAb,CAAkB5D,MAAMuD,QAAxB,EAAkCR,KAAKc,IAAL,EAAlC;AACA,uBAAKzB,OAAL,CAAaY,eAAb,GAA+B,IAA/B;AACH,aAJD;AAKH;;;sCACaH,C,EAAG;AAAA;;AACb,gBAAI,KAAKjB,MAAL,CAAYkC,KAAZ,CAAkBrE,MAAtB,EAA8B;AAC1B,oBAAI,KAAKyB,gBAAT,EAA2B;AACvB,yBAAKA,gBAAL,GAAwB,KAAxB;AACA,yBAAK6C,MAAL,GAAcC,WAAW,YAAM;AAC3BC,qCAAc,OAAKF,MAAnB;AACA,+BAAK7C,gBAAL,GAAwB,IAAxB;AACA,4BAAM6B,OAAO,OAAKnB,MAAL,CAAYkC,KAAzB;AACA,+BAAKI,QAAL,CAAcnB,IAAd;AACH,qBALa,EAKX,KAAK3B,kBALM,CAAd;AAMH;AACJ,aAVD,MAWK;AACD,qBAAKgB,OAAL,CAAa+B,IAAb;AACH;AACJ;;;yCACgBtB,C,EAAE;AACfA,cAAEuB,eAAF;AACAvB,cAAEwB,cAAF;AACH;;;gCACQxB,C,EAAG;AAAA;;AACR,gBAAIE,OAAOF,EAAED,MAAb;AACA,gBAAI7C,QAAQ,KAAKoB,UAAL,CACP8B,MADO,CACC;AAAA,uBAAYC,SAASoB,WAArB;AAAA,aADD,EAEPlB,GAFO,CAEH,oBAAY;AACb,uBAAO,iBAAS;AACZ,2BAAO,IAAI/C,OAAJ,CAAY,mBAAW;AAC1B,4BAAIL,MAAMqD,SAAV,EAAqB;AACjB/C,oCAAQN,KAAR;AACH,yBAFD,MAGK;AACDkD,qCACCI,IADD,CACOP,IADP,EACa,OAAKxB,oBAAL,GAA4B,OAAKD,iBAAjC,GAAqD,CADlE,EACqE,IADrE,EAC2E,IAD3E,EAEClB,IAFD,CAEM,oBAAY;AACdJ,sCAAMqD,SAAN,GAAkBE,SAAS9D,MAAT,GAAkB,CAApC;AACAO,sCAAMuD,QAAN,GAAiBvD,MAAMuD,QAAN,CAAeC,MAAf,CAAsBD,QAAtB,CAAjB;AACAjD,wCAAQN,KAAR;AACH,6BAND,EAOCyD,KAPD,CAOO,aAAK;AACRC,wCAAQC,GAAR,CAAYd,CAAZ;AACAvC,wCAAQN,KAAR;AACH,6BAVD;AAWH;AACJ,qBAjBM,CAAP;AAkBH,iBAnBD;AAoBH,aAvBO,CAAZ;;AAyBIF,kBAAOC,KAAP,EAAc,EAACsD,WAAW,KAAZ,EAAmBE,UAAU,EAA7B,EAAd,EACCnD,IADD,CACM,iBAAS;AACX;AACA;AACA;AACA;AACA;AACA;AACH,aARD;;AAUA,iBAAKgC,OAAL,IAAgB,KAAKA,OAAL,CAAa+B,IAAb,EAAhB;AACP;;;oCACYtB,C,EAAE;AACX,gBAAI0B,OAAO1B,EAAED,MAAb;AACA,mBAAO2B,KAAKrB,QAAL,CAAcsB,KAAd,CAAoBD,KAAKE,UAAzB,CAAP;AACH;;;sCACc5B,C,EAAG;AACbA,cAAEuB,eAAF;AACA,iBAAK7B,OAAL,CAAc,EAACK,QAAQ,KAAKhB,MAAL,CAAYkC,KAArB,EAAd;AACJ;;;gCACQf,I,EAAM;AACX,iBAAKnB,MAAL,CAAYkC,KAAZ,GAAoBf,IAApB;AACH;;;uCACee,K,EAAO;AACnB,iBAAKlC,MAAL,CAAY8C,WAAZ,GAA0BZ,KAA1B;AACH;;;;;;QAGItD,Y,GAAAA,Y;;;;;;;;;;;;;;;;AClKT;;;;;;;;IAEMmE,oB;;;AACF,wCAAoC;AAAA,YAAvBC,UAAuB,QAAvBA,UAAuB;AAAA,YAAXC,SAAW,QAAXA,SAAW;;AAAA;;AAAA;;AAEhC,cAAKC,WAAL,GAAmBF,UAAnB;AACA,cAAKG,UAAL,GAAkBF,SAAlB;AACA,cAAK1B,cAAL,GAAsB,IAAtB;AACA,cAAK6B,YAAL,GAAoB,KAApB;AACA,cAAKV,WAAL,GAAmB,IAAnB;AACA,cAAKW,eAAL,GAAuB,CAC5B,EAACC,IAAI,CAAL,EAAQC,OAAO,SAAf,EAA2BC,KAAK,oBAAhC,EAD4B,EAE5B,EAACF,IAAI,CAAL,EAAQC,OAAO,SAAf,EAA0BC,KAAK,gBAA/B,EAF4B,EAG5B,EAACF,IAAI,CAAL,EAAQC,OAAO,OAAf,EAAyBC,KAAK,YAA9B,EAH4B,EAI5B,EAACF,IAAI,CAAL,EAAQC,OAAO,OAAf,EAAyBC,KAAK,QAA9B,EAJ4B,EAKnB,EAACF,IAAI,CAAL,EAAQC,OAAO,KAAf,EAAwBC,KAAK,wBAA7B,EALmB,EAM5B,EAACF,IAAI,EAAL,EAASC,OAAO,OAAhB,EAA0BC,KAAK,gBAA/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnB4B,SAAvB;AAPgC;AA4BnC;;;;yCACiBC,G,EAAKlG,I,EAAM;AACzBkG,kBAAMA,IAAIxB,IAAJ,EAAN;AACA,iBAAK,IAAItE,IAAI,CAAR,EAAW+F,MAAM,KAAKL,eAAL,CAAqBxF,MAA3C,EAAmDF,IAAI+F,GAAvD,EAA4D/F,GAA5D,EAAiE;AAC7D,oBAAIgG,KAAK,KAAKN,eAAL,CAAqB1F,CAArB,CAAT;AACA,oBAAIgG,GAAGL,EAAH,KAAU/F,IAAd,EAAoB;AAAE,2BAAOoG,EAAP;AAAY;AAClC,oBAAIA,GAAGH,GAAH,CAAOI,IAAP,CAAYH,GAAZ,CAAJ,EAAsB;AAAE,2BAAOE,EAAP;AAAY;AACvC;AACD,mBAAO,KAAKN,eAAL,CAAqB,CAArB,CAAP;AACH;;;6BACInB,K,EAAO2B,K,EAAOC,M,EAAQC,gB,EAAiB;AAAA;;AACxC,gBAAMC,gBAAgB,KAAKC,gBAAL,CAAsB/B,KAAtB,CAAtB;AACA,mBAAO,IAAIzD,OAAJ,CAAY,mBAAW;AAC1B;AACA,oBAAIyF,MAAM,IAAIC,OAAJ,CAAe,OAAKjB,WAApB,kBAA4Cc,cAAcV,EAA1D,cAAqEpB,KAArE,mBAAwF,OAAKiB,UAA7F,eAAiHU,KAAjH,CAAV;AACA,oBAAIO,UAAU,IAAIC,OAAJ,EAAd;AACAD,wBAAQE,MAAR,CAAe,cAAf,EAA8B,kBAA9B;AACA,oBAAIC,OAAO;AACPC,4BAAQ,KADD;AAEPC,0BAAM,MAFC;AAGPC,2BAAO;AAHA,iBAAX;AAKA9B,sBAAOsB,GAAP,EAAYK,IAAZ,EACC/F,IADD,CACM;AAAA,2BAAYmD,SAASgD,IAAT,EAAZ;AAAA,iBADN,EAECnG,IAFD,CAEM,gBAAQ;AACV;AACI,wBAAIoG,KAAKD,KAAKE,QAAL,CAAcrD,GAAd,CAAkB,aAAK;AAC5B,+BAAO;AACHsD,kCAAMC,EAAEC,KAAF,CAAQF,IAAR,IAAgBC,EAAEC,KAAF,CAAQC,EAAxB,IAA8BF,EAAEC,KAAF,CAAQ1B,EADzC;AAEHT,wCAAYkC,CAFT;AAGHzD,4CAHG;AAIH4D,mCAAOhD;AAJJ,yBAAP;AAMH,qBAPQ,CAAT;AAQAxD,4BAAQkG,EAAR;AACJ;AACA;AACI;AACJ;AAEH,iBAlBD;AAmBH,aA7BM,CAAP;AA8BH;;;;;;;;;;;;;oBACKO,G,EAAK;AAAA;;AACb,gBAAIhE,OAAOgE,IAAIH,KAAJ,CAAUF,IAAV,IAAkBK,IAAIH,KAAJ,CAAUC,EAA5B,IAAkCE,IAAIH,KAAJ,CAAU1B,EAAvD;AACM,gBAAMU,gBAAgB,KAAKC,gBAAL,CAAsB9C,IAAtB,EAA4BgE,IAAI5H,IAAhC,CAAtB;AACA,mBAAO,IAAIkB,OAAJ,CAAY,mBAAW;AAC1B,oBAAGuF,aAAH,EAAkB;AACd;AACA,wBAAIE,MAAM,IAAIC,OAAJ,CAAe,OAAKjB,WAApB,kBAA4Cc,cAAcV,EAA1D,mBAA0E,OAAKH,UAA/E,sBAA0GhC,IAA1G,CAAV;AACA,wBAAIiD,UAAU,IAAIC,OAAJ,EAAd;AACAD,4BAAQE,MAAR,CAAe,cAAf,EAA8B,kBAA9B;AACA,wBAAIC,OAAO;AACPC,gCAAQ,KADD;AAEPC,8BAAM,MAFC;AAGPC,+BAAO;AAHA,qBAAX;AAKA9B,0BAAOsB,GAAP,EAAYK,IAAZ,EACC/F,IADD,CACM;AAAA,+BAAYmD,SAASgD,IAAT,EAAZ;AAAA,qBADN,EAECnG,IAFD,CAEM,gBAAQ;AACV,4BAAGmG,KAAKS,MAAL,KAAgB,GAAnB,EAAwB;AACpB,gCAAIpH,QAAQ6C,SAASC,WAAT,CAAqB,OAArB,CAAZ;AACA9C,kCAAM+C,SAAN,CAAgB,OAAhB,EAAyB,KAAzB,EAAgC,KAAhC;AACA/C,kCAAMgD,MAAN,GAAe2D,IAAf;AACA,mCAAKzD,aAAL,CAAmBlD,KAAnB;;AAEA,gCAAI4G,KAAKD,KAAKE,QAAL,CAAcrD,GAAd,CAAkB,aAAK;AAC5B,uCAAO;AACHsD,0CAAMC,EAAEC,KAAF,CAAQF,IAAR,IAAgBC,EAAEC,KAAF,CAAQC,EAAxB,IAA8BF,EAAEC,KAAF,CAAQ1B,EADzC;AAEHT,gDAAYkC,CAFT;AAGHzD,oDAHG;AAIH4D,2CAAOC;AAJJ,iCAAP;AAOH,6BARQ,CAAT;AASAzG,oCAAQkG,EAAR;AAEH,yBAjBD,MAkBK;AACDlG,oCAAQiG,IAAR;AACH;AACJ,qBAxBD;AAyBH,iBAnCD,MAoCK;AACDjG,4BAAQ,EAAR;AACH;AACJ,aAxCM,CAAP;AAyCH,S;;;;;;QAGIqE,oB,GAAAA,oB;;;;;;;;;;;;;;;;;;ACzHT;;;;;;;;IAEMsC,uB;;;AACF,uCAAa;AAAA;;AAAA;;AAET,cAAK9D,cAAL,GAAsB,KAAtB;AACA,cAAK6B,YAAL,GAAoB,KAApB;AACA,cAAKV,WAAL,GAAmB,IAAnB;AACA,cAAKE,KAAL,GAAa,MAAKA,KAAL,CAAWzC,IAAX,OAAb;AACA,cAAKuB,IAAL,GAAY,MAAKA,IAAL,CAAUvB,IAAV,OAAZ;;AAEA,cAAKmF,GAAL,GAAW,IAAIC,MAAJ,CAAW,mFAAX,CAAX;AACA,cAAKC,GAAL,GAAW,IAAID,MAAJ,CAAW,mLAAX,CAAX;AATS;AAUZ;;;;0CACiBrD,K,EAAO;AACrB,gBAAIuD,IAAI,KAAKD,GAAL,CAAS5B,IAAT,CAAc1B,KAAd,CAAR;AACA,gBAAIwD,MAAMC,OAAN,CAAcF,CAAd,KAAoBA,EAAE5H,MAAF,KAAa,CAArC,EAAwC;AACpC,uBAAO,KAAK+H,aAAL,CAAoB,CAACH,EAAE,CAAF,CAAD,EAAMA,EAAE,CAAF,CAAN,EAAWA,EAAE,CAAF,CAAX,EAAgBA,EAAE,CAAF,CAAhB,EAAqBA,EAAE,CAAF,CAArB,EAA0BA,EAAE,CAAF,CAA1B,EAAgCjE,GAAhC,CAAoC;AAAA,2BAAKqE,WAAWd,CAAX,CAAL;AAAA,iBAApC,CAApB,CAAP;AACH;AACDU,gBAAI,KAAKH,GAAL,CAAS1B,IAAT,CAAc1B,KAAd,CAAJ;AACA,gBAAIwD,MAAMC,OAAN,CAAeF,CAAf,KAAqBA,EAAE5H,MAAF,KAAa,CAAtC,EAAwC;AACpC,uBAAO,EAACN,MAAM,OAAP,EAAgBuI,aAAa,CAChCD,WAAWJ,EAAE,CAAF,CAAX,CADgC,EAEhCI,WAAWJ,EAAE,CAAF,CAAX,CAFgC,CAA7B,EAAP;AAIH;;AAED,mBAAO,IAAP;AACH;;;4CACgE;AAAA;AAAA,gBAAjDM,MAAiD;AAAA,gBAAzCC,MAAyC;AAAA,gBAAjCC,MAAiC;AAAA,gBAAzBC,MAAyB;AAAA,gBAAjBC,MAAiB;AAAA,gBAATC,MAAS;;AAC7D,mBAAO,EAAC7I,MAAM,OAAP,EAAgBuI,aAAa,CAChCI,SAASC,SAAS,EAAlB,GAAuBC,SAAS,IADA,EAEhCL,SAASC,SAAS,EAAlB,GAAuBC,SAAS,IAFA,CAA7B,EAAP;AAIH;;;8BACM/D,K,EAAM;AACT,mBAAO,IAAIzD,OAAJ,CAAY;AAAA,uBAAWC,QAAQ,EAAR,CAAX;AAAA,aAAZ,CAAP;AACH;;;6BACIwD,K,EAAO2B,K,EAAOC,M,EAAQC,gB,EAAiB;AAAA;;AACxC,gBAAIsC,IAAI,KAAKC,iBAAL,CAAuBpE,KAAvB,CAAR;AACA,mBAAO,IAAIzD,OAAJ,CAAY,mBAAW;AAC1B,oBAAI8H,SAAS,EAACC,SAAS,EAAEjJ,MAAM,SAAR,EAAmBkJ,UAAUJ,CAA7B,EAAgCxD,YAAY,EAA5C,EAAV,EAA4DvB,gBAA5D,EAA4E4D,OAAOhD,KAAnF,EAAb;AACA,oBAAImE,CAAJ,EAAO;AACH,wBAAIrI,QAAQ6C,SAASC,WAAT,CAAqB,OAArB,CAAZ;AACA9C,0BAAM+C,SAAN,CAAgB,OAAhB,EAAyB,KAAzB,EAAgC,KAAhC;AACA/C,0BAAMgD,MAAN,GAAeuF,MAAf;AACA,2BAAKrF,aAAL,CAAmBlD,KAAnB;AACH;AACDU,wBAAQ2H,IAAI,CAACE,MAAD,CAAJ,GAAe,EAAvB;AACH,aATM,CAAP;AAUH;;;;;;QAGIlB,uB,GAAAA,uB;;;;;;;;;;;;;;;;ACpDT;;;;;;;;IAEMqB,e;;;AACF,mCAAyB;AAAA,YAAZ1D,UAAY,QAAZA,UAAY;;AAAA;;AAAA;;AAErB,cAAKE,WAAL,GAAmBF,UAAnB;AACA,cAAKzB,cAAL,GAAsB,IAAtB;AACA,cAAK6B,YAAL,GAAoB,IAApB;AACA,cAAKV,WAAL,GAAmB,IAAnB;AACA,cAAKhB,IAAL,GAAY,MAAKA,IAAL,CAAUvB,IAAV,OAAZ;AACA,cAAKyC,KAAL,GAAa,MAAKA,KAAL,CAAWzC,IAAX,OAAb;AACA,cAAKwG,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBxG,IAAtB,OAAxB;;AAEA,cAAKyG,IAAL,GAAYC,OAAOC,uBAAP,IAAkC,IAAlC,IAA0CD,OAAOC,uBAAP,IAAkC,SAA5E,GAAwF,EAAxF,aAAqGD,OAAOC,uBAAxH;AAVqB;AAWxB;;;;yCACgBL,Q,EAAU;AACvB,oBAAQA,SAASlJ,IAAT,CAAcwJ,WAAd,EAAR;AACI,qBAAK,OAAL;AACIN,6BAASlJ,IAAT,GAAgB,OAAhB;AACA;AACJ,qBAAK,SAAL;AACIkJ,6BAASlJ,IAAT,GAAgB,SAAhB;AACA;AACJ,qBAAK,cAAL;AACIkJ,6BAASlJ,IAAT,GAAgB,cAAhB;AACA;AACJ,qBAAK,YAAL;AACA,qBAAK,UAAL;AACIkJ,6BAASlJ,IAAT,GAAgB,YAAhB;AACA;AACJ,qBAAK,iBAAL;AACIkJ,6BAASlJ,IAAT,GAAgB,iBAAhB;AACA;AACJ;AACI,0BAAM,kBAAN;AAlBR;AAoBA,mBAAOkJ,QAAP;AACH;;;;;;;;;;;;;oBACMtB,G,EAAK;AAAA;;AACR,gBAAMD,8CAA4CC,IAAI6B,OAAhD,kBAAoE7B,IAAI8B,QAAxE,cAAN;AACA,gBAAI/C,MAAM,IAAIC,OAAJ,CAAe,KAAKjB,WAApB,yCAAmEgC,KAAnE,GAA2E,KAAK0B,IAAhF,CAAV;AACA,gBAAIxC,UAAU,IAAIC,OAAJ,EAAd;AACAD,oBAAQE,MAAR,CAAe,cAAf,EAA8B,kBAA9B;AACA,gBAAIC,OAAO;AACPC,wBAAQ,KADD;AAEPC,sBAAM,MAFC;AAGPyC,6BAAa,SAHN;AAIPxC,uBAAO;AAJA,aAAX;AAMA,mBAAO,IAAIjG,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpCiE,sBAAOsB,GAAP,EAAYK,IAAZ,EACC/F,IADD,CACM;AAAA,2BAAYmD,SAASgD,IAAT,EAAZ;AAAA,iBADN,EAECnG,IAFD,CAEM,gBAAQ;AACV,wBAAGmG,KAAKwC,MAAL,KAAgB,IAAnB,EAAwB;AACpB,4BAAMvC,KAAKD,KAAKyC,MAAL,CACV/I,MADU,CACH,UAACgJ,CAAD,EAAGtC,CAAH;AAAA,mCAASsC,EAAEzF,MAAF,CAASmD,EAAEuC,YAAX,CAAT;AAAA,yBADG,EACgC,EADhC,EAEV9F,GAFU,CAEN,aAAK;AACN,gCAAI6E,IAAI,OAAKM,gBAAL,CAAuB5B,EAAEwC,QAAzB,CAAR;AACA,gCAAIC,QAAQC,OAAOC,IAAP,CAAY3C,CAAZ,EACX1D,MADW,CACJ;AAAA,uCAAKsG,MAAM,UAAX;AAAA,6BADI,EAEXtJ,MAFW,CAEJ,UAACgJ,CAAD,EAAGM,CAAH,EAAS;AACbN,kCAAEM,CAAF,IAAO5C,EAAE4C,CAAF,CAAP;AACA,uCAAON,CAAP;AACH,6BALW,EAKT,EALS,CAAZ;AAMA,mCAAO;AACHb,yCAAS;AACLjJ,0CAAM,SADD;AAELkJ,8CAAUJ,CAFL;AAGLxD,gDAAY2E;AAHP,iCADN;AAMHlG,gDANG;AAOH4D,uCAAOC;AAPJ,6BAAP;AASH,yBAnBU,CAAX;AAoBA,4BAAInH,QAAQ6C,SAASC,WAAT,CAAqB,OAArB,CAAZ;AACA9C,8BAAM+C,SAAN,CAAgB,OAAhB,EAAyB,KAAzB,EAAgC,KAAhC;AACA/C,8BAAMgD,MAAN,GAAe4D,EAAf;AACA,+BAAK1D,aAAL,CAAmBlD,KAAnB;AACAU,gCAAQkG,EAAR;AACH,qBA1BD,MA2BK;AACDjG,+BAAOgG,IAAP;AACH;AACJ,iBAjCD,EAkCC9C,KAlCD,CAkCO;AAAA,2BAAYlD,OAAOgD,QAAP,CAAZ;AAAA,iBAlCP;AAmCH,aApCM,CAAP;AAqCH,S;;;6BACIO,K,EAAO2B,K,EAAOC,M,EAAQC,gB,EAAiB;AAAA;;AACxC,mBAAO,IAAItF,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC,oBAAIuD,SAASA,MAAMD,IAAN,EAAb,EAA2B;AACvB,wBAAM2F,UAAUC,QAAQ/D,MAAR,IAAkB,CAAlB,GAAsB,CAAtC;AACA,wBAAMgE,mBAAmBD,QAAQ9D,gBAAR,IAA4B,CAA5B,GAAgC,CAAzD;AACA,wBAAMmB,oEAAkE0C,OAAlE,yBAA6FE,gBAA7F,wBAAgIjE,KAAhI,sBAAsJkE,mBAAmB7F,KAAnB,CAA5J;AACA,wBAAIgC,MAAM,IAAIC,OAAJ,CAAe,OAAKjB,WAApB,yCAAmEgC,KAAnE,GAA2E,OAAK0B,IAAhF,CAAV;AACA,wBAAIxC,UAAU,IAAIC,OAAJ,EAAd;AACAD,4BAAQE,MAAR,CAAe,cAAf,EAA8B,kBAA9B;AACA,wBAAIC,OAAO;AACPC,gCAAQ,KADD;AAEPC,8BAAM,MAFC;AAGPyC,qCAAa,SAHN;AAIPxC,+BAAO;AAJA,qBAAX;AAMA9B,0BAAOsB,GAAP,EAAYK,IAAZ,EACC/F,IADD,CACM;AAAA,+BAAYmD,SAASgD,IAAT,EAAZ;AAAA,qBADN,EAECnG,IAFD,CAEM,gBAAQ;AACV,4BAAGmG,KAAKwC,MAAL,KAAgB,IAAnB,EAAwB;AACpB,gCAAMvC,KAAKD,KAAKyC,MAAL,CACV/I,MADU,CACH,UAACgJ,CAAD,EAAGtC,CAAH;AAAA,uCAASsC,EAAEzF,MAAF,CAASmD,EAAEuC,YAAX,CAAT;AAAA,6BADG,EACgC,EADhC,EAEV9F,GAFU,CAEN,aAAK;AACN,oCAAIuC,oBAAoBgB,EAAEwC,QAA1B,EAAoC;AAChC,wCAAIlB,IAAI,OAAKM,gBAAL,CAAuB5B,EAAEwC,QAAzB,CAAR;AACA,wCAAIC,QAAQC,OAAOC,IAAP,CAAY3C,CAAZ,EACX1D,MADW,CACJ;AAAA,+CAAKsG,MAAM,UAAX;AAAA,qCADI,EAEXtJ,MAFW,CAEJ,UAACgJ,CAAD,EAAGM,CAAH,EAAS;AACbN,0CAAEM,CAAF,IAAO5C,EAAE4C,CAAF,CAAP;AACA,+CAAON,CAAP;AACH,qCALW,EAKT,EALS,CAAZ;AAMA,2CAAO;AACHvC,8CAAMC,EAAEiD,YADL;AAEHxB,iDAAS;AACLjJ,kDAAM,SADD;AAELkJ,sDAAUJ,CAFL;AAGLxD,wDAAY2E;AAHP,yCAFN;AAOH3E,oDAAY2E,KAPT;AAQHlG,wDARG;AASH4D,+CAAOhD;AATJ,qCAAP;AAWH,iCAnBD,MAoBK;AACD,2CAAO;AACH4C,8CAAMC,EAAEiD,YADL;AAEHnF,oDAAYkC,CAFT;AAGHzD,wDAHG;AAIH4D,+CAAOhD;AAJJ,qCAAP;AAMH;AACJ,6BA/BU,CAAX;AAgCA,gCAAI4B,UAAUC,gBAAd,EAAgC;AAC5B,oCAAI/F,QAAQ6C,SAASC,WAAT,CAAqB,OAArB,CAAZ;AACA9C,sCAAM+C,SAAN,CAAgB,OAAhB,EAAyB,KAAzB,EAAgC,KAAhC;AACA/C,sCAAMgD,MAAN,GAAe4D,EAAf;AACA,uCAAK1D,aAAL,CAAmBlD,KAAnB;AACH;AACDU,oCAAQkG,EAAR;AACH,yBAxCD,MAyCK;AACDjG,mCAAOgG,IAAP;AACH;AACJ,qBA/CD,EAgDC9C,KAhDD,CAgDO;AAAA,+BAAYlD,OAAOgD,QAAP,CAAZ;AAAA,qBAhDP;AAkDH,iBA/DD,MAgEK;AACDhD,2BAAO,cAAP;AACH;AACJ,aApEM,CAAP;AAqEH;;;;;;QAGI+H,e,GAAAA,e;;;;;;;;;;;;;;ACjKT;;AAEA,IAAIuB,gBAAgBC,EAAEC,OAAF,CAAUC,MAAV,CAAiB;AACjCC,cAAUH,EAAEI,OAAF,GAAYJ,EAAEI,OAAF,CAAUC,SAAtB,GAAkCL,EAAEM,KAAF,CAAQC,MADnB;AAEjCC,gBAAY,oBAASC,OAAT,EAAkB;AAC1BT,UAAEU,UAAF,CAAa,IAAb,EAAmBD,OAAnB;AACA,aAAKrJ,gBAAL,GAAwB,IAAxB;AACA,aAAKqJ,OAAL,CAAa3J,iBAAb,GAAiC,KAAK2J,OAAL,CAAa3J,iBAAb,IAAkC,IAAnE;AACA,aAAK2J,OAAL,CAAa1J,eAAb,GAA+B,KAAK0J,OAAL,CAAa1J,eAAb,IAAgC,EAA/D;AACH,KAPgC;AAQjC4J,WAAO,eAASrH,GAAT,EAAc;AACjB,aAAKnC,UAAL,GAAkB6I,EAAEY,OAAF,CAAUC,MAAV,CAAiB,KAAjB,EAAwB,oBAAxB,CAAlB;AACA,aAAKC,OAAL,GAAe,+BAAiB,KAAK3J,UAAtB,EAAkC,KAAKsJ,OAAvC,CAAf;AACAnH,YAAIyH,EAAJ,CAAO,OAAP,EAAgB,KAAKD,OAAL,CAAaxI,OAAb,CAAqB+B,IAArB,CAA0BpC,IAA1B,CAA+B,KAAK6I,OAAL,CAAaxI,OAA5C,CAAhB;AACAgB,YAAIyH,EAAJ,CAAO,WAAP,EAAoB,KAAKD,OAAL,CAAaxI,OAAb,CAAqB+B,IAArB,CAA0BpC,IAA1B,CAA+B,KAAK6I,OAAL,CAAaxI,OAA5C,CAApB;AACA,eAAO,KAAKnB,UAAZ;AACH,KAdgC;AAejC6J,WAAO,eAAS1H,GAAT,EAAc;AACjB0G,UAAEC,OAAF,CAAUI,SAAV,CAAoBW,KAApB,CAA0BjL,IAA1B,CAA+B,IAA/B,EAAqCuD,GAArC;AACA,YAAI,KAAKmH,OAAL,CAAaQ,SAAjB,EAA4B;AACxB,iBAAKA,SAAL,CAAe,KAAKR,OAAL,CAAaQ,SAA5B;AACH;AACD,eAAO,IAAP;AACH,KArBgC;;AAuBjCA,eAAW,mBAAS7F,EAAT,EAAa;AACpB,YAAI8F,aAAa,KAAKC,OAAL,IAAgB,KAAKA,OAAL,CAAahK,UAA9C;AACA,YAAI,CAAC+J,UAAL,EAAiB;AACbA,yBAAa,KAAKE,IAAL,IAAa,KAAKA,IAAL,CAAUC,eAAV,CAA0B,KAAKC,WAAL,EAA1B,CAA1B;AACH;AACD,YAAI,CAACJ,UAAL,EAAiB;AACb,iBAAKT,OAAL,CAAaQ,SAAb,GAAyB7F,EAAzB;AACH,SAFD,MAGK;AACD,iBAAK,IAAI3F,IAAI,CAAR,EAAW+F,MAAM0F,WAAWK,UAAX,CAAsB5L,MAA5C,EAAoDF,IAAI+F,GAAxD,EAA6D/F,GAA7D,EAAkE;AAC9D,oBAAIgG,KAAKyF,WAAWK,UAAX,CAAsB9L,CAAtB,CAAT;AACA,oBAAI2F,OAAOK,GAAG+F,GAAd,EAAmB;AACfN,+BAAWO,YAAX,CAAwB,KAAKtK,UAA7B,EAAyCsE,EAAzC;AACA;AACH;AACJ;AACJ;AACD,eAAO,IAAP;AACH,KAzCgC;;AA2CjCiG,WA3CiC,mBA2CxBzI,IA3CwB,EA2ClB;AACX,aAAK6H,OAAL,CAAaY,OAAb,CAAsBzI,IAAtB;AACH,KA7CgC;AA+CjC0I,kBA/CiC,0BA+CjB3H,KA/CiB,EA+CV;AACnB,aAAK8G,OAAL,CAAaa,cAAb,CAA6B3H,KAA7B;AACH;AAjDgC,CAAjB,CAApB;;QAoDS+F,a,GAAAA,a;;;;;;;;;ACtDT;;AACA;;AACA;;AACA;;AACA;;AAEApB,OAAOiD,KAAP,GAAejD,OAAOiD,KAAP,IAAgB,EAA/B;AACAjD,OAAOiD,KAAP,CAAalL,YAAb;AACAiI,OAAOiD,KAAP,CAAa7B,aAAb;AACApB,OAAOiD,KAAP,CAAapD,eAAb;AACAG,OAAOiD,KAAP,CAAazE,uBAAb;AACAwB,OAAOiD,KAAP,CAAa/G,oBAAb,8C;;;;;;;;;;;;;;;;ACXA;;;;;;;;IAEMgH,U;;;AACF,8BAA0C;AAAA,YAA7BtJ,KAA6B,QAA7BA,KAA6B;AAAA,qCAAtBC,YAAsB;AAAA,YAAtBA,YAAsB,qCAAP,KAAO;;AAAA;;AAAA;;AAEtC,cAAKV,MAAL,GAAcS,KAAd;AACA,cAAKuJ,KAAL,GAAa,CAAC,CAAd;AACA,cAAKC,KAAL,GAAa,CAAb;AACA,cAAKC,KAAL,GAAa,IAAb;AACA,cAAKC,UAAL,GAAkB,EAAlB;AACA,cAAKC,aAAL,GAAqB1J,YAArB;AACA,cAAK2J,KAAL,GAAanC,EAAEY,OAAF,CAAUC,MAAV,CAAiB,KAAjB,CAAb;AACA,cAAKsB,KAAL,CAAWC,YAAX,CAAwB,OAAxB,EAAiC,kCAAjC;;AAEA,cAAKlJ,eAAL,GAAuB,IAAvB;;AAEA,cAAKiJ,KAAL,CAAWE,KAAX,CAAiBC,GAAjB,GAA0B,MAAKxK,MAAL,CAAYyK,SAAZ,GAAwB,MAAKzK,MAAL,CAAY0K,YAApC,GAAmD,CAA7E;AACA,cAAKL,KAAL,CAAWE,KAAX,CAAiBI,IAAjB,GAA2B,MAAK3K,MAAL,CAAY4K,UAAvC;;AAEA,cAAKC,UAAL,GAAkB,MAAKA,UAAL,CAAgB1K,IAAhB,OAAlB;AACA,cAAKH,MAAL,CAAYI,gBAAZ,CAA6B,SAA7B,EAAwC,MAAKyK,UAA7C;;AAEA,cAAKC,iBAAL,GAAyB,MAAKA,iBAAL,CAAuB3K,IAAvB,OAAzB;AACA,cAAKH,MAAL,CAAYI,gBAAZ,CAA6B,OAA7B,EAAsC,MAAK0K,iBAA3C;;AAEA,cAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkB5K,IAAlB,OAApB;AACA,cAAKH,MAAL,CAAYI,gBAAZ,CAA6B,OAA7B,EAAsC,MAAK2K,YAA3C;AACA,cAAKV,KAAL,CAAWjK,gBAAX,CAA4B,SAA5B,EAAuC,MAAKyK,UAA5C;;AAEA,cAAKG,YAAL,GAAoB,MAAKA,YAAL,CAAkB7K,IAAlB,OAApB;AACA,cAAKkK,KAAL,CAAWjK,gBAAX,CAA4B,OAA5B,EAAqC,MAAK4K,YAA1C;AACA9C,UAAE+C,QAAF,CAAWC,uBAAX,CAAmC,MAAKb,KAAxC,EAA+Cc,wBAA/C,CAAwE,MAAKd,KAA7E;AACA;AACA;AACA,cAAKrK,MAAL,CAAYoL,aAAZ,CAA0BC,WAA1B,CAAsC,MAAKhB,KAA3C;;AAEA,cAAKnK,aAAL,GAAqB,MAAKA,aAAL,CAAmBC,IAAnB,OAArB;AACA,cAAKH,MAAL,CAAYI,gBAAZ,CAA6B,OAA7B,EAAsC,MAAKF,aAA3C;AAlCsC;AAmCzC;;;;0CAEkBe,C,EAAG;AAClBA,cAAEuB,eAAF;AACH;;;qCAEYvB,C,EAAE;AACX,gBAAG,KAAK+I,KAAL,IAAc,CAAjB,EAAoB;AAChB,oBAAIsB,KAAK,KAAKjB,KAAL,CAAWpK,aAAX,iBAAuC,KAAK+J,KAA5C,QAAT;AACA9B,kBAAEY,OAAF,CAAUyC,WAAV,CAAuBD,EAAvB,EAA2B,kCAA3B;AACH;AACD,iBAAKtB,KAAL,GAAa,CAAC,CAAd;AACA,iBAAKE,KAAL,GAAa,IAAb;AACH;;;sCAEajJ,C,EAAE;AACZ,iBAAKkJ,UAAL,GAAkB,KAAKnK,MAAL,CAAYkC,KAA9B;AACH;;;qCAEajB,C,EAAG;AACbA,cAAEuB,eAAF;AACH;;;mCAEUvB,C,EAAE;AACT,gBAAG,KAAKuK,WAAL,EAAH,EAAuB;AACnB,wBAAQvK,EAAEwK,OAAV;AACI;AACA,yBAAK,EAAL;AACA,yBAAK,EAAL;AACIxK,0BAAEuB,eAAF;AACA;AACJ;AACA,yBAAK,EAAL;AACIvB,0BAAEwB,cAAF;AACAxB,0BAAEuB,eAAF;AACA,4BAAI,KAAKpB,eAAT,EAA0B;AACtB,gCAAI,KAAK4I,KAAL,GAAa,CAAjB,EAAmB;AACf,qCAAKA,KAAL,GAAa,CAAb;AACH,6BAFD,MAGK,IAAI,KAAK,KAAKA,KAAV,IAAmB,KAAKA,KAAL,GAAa,KAAKC,KAAL,GAAa,CAAjD,EAAmD;AACpD,oCAAIqB,MAAK,KAAKjB,KAAL,CAAWpK,aAAX,iBAAuC,KAAK+J,KAA5C,QAAT;AACA9B,kCAAEY,OAAF,CAAUyC,WAAV,CAAuBD,GAAvB,EAA2B,kCAA3B;AACA,kCAAE,KAAKtB,KAAP;AACH,6BAJI,MAKA;AACD,oCAAIsB,OAAK,KAAKjB,KAAL,CAAWpK,aAAX,iBAAuC,KAAK+J,KAA5C,QAAT;AACA9B,kCAAEY,OAAF,CAAUyC,WAAV,CAAuBD,IAAvB,EAA2B,kCAA3B;AACA,qCAAKtB,KAAL,GAAa,KAAKC,KAAL,GAAa,CAA1B;AACH;AACD,gCAAIqB,KAAK,KAAKjB,KAAL,CAAWpK,aAAX,iBAAuC,KAAK+J,KAA5C,QAAT;AACA9B,8BAAEY,OAAF,CAAU4C,QAAV,CAAoBJ,EAApB,EAAwB,kCAAxB;AACA,iCAAKK,UAAL,CAAgB,KAAK3B,KAArB;AACAsB,+BAAGM,KAAH;AACH;AACD;AACJ;AACA,yBAAK,EAAL;AACI3K,0BAAEwB,cAAF;AACAxB,0BAAEuB,eAAF;AACA,4BAAI,KAAKpB,eAAT,EAA0B;AACtB,gCAAG,KAAK4I,KAAL,GAAa,CAAhB,EAAkB;AACd,oCAAIsB,OAAK,KAAKjB,KAAL,CAAWpK,aAAX,iBAAuC,KAAK+J,KAA5C,QAAT;AACA9B,kCAAEY,OAAF,CAAUyC,WAAV,CAAuBD,IAAvB,EAA2B,kCAA3B;AACA,kCAAE,KAAKtB,KAAP;AACAsB,uCAAK,KAAKjB,KAAL,CAAWpK,aAAX,iBAAuC,KAAK+J,KAA5C,QAAL;AACA9B,kCAAEY,OAAF,CAAU4C,QAAV,CAAoBJ,IAApB,EAAwB,kCAAxB;AACA,qCAAKK,UAAL,CAAgB,KAAK3B,KAArB;AACAsB,qCAAGM,KAAH;AACH,6BARD,MASK,IAAI,KAAK5B,KAAL,KAAe,CAAnB,EAAsB;AACvB,qCAAKhK,MAAL,CAAY4L,KAAZ;AACA,qCAAK5L,MAAL,CAAYkC,KAAZ,GAAoB,KAAKiI,UAAzB;AACH;AACJ;AACD;AACJ;AACA,yBAAK,EAAL;AACI,4BAAI,KAAKH,KAAL,GAAa,CAAb,IAAkB,KAAKhK,MAAL,CAAYkC,KAAlC,EAAwC;AACpC,gCAAMf,OAAO,KAAKnB,MAAL,CAAYkC,KAAzB;AACA,iCAAKlC,MAAL,CAAY4L,KAAZ;AACA,iCAAK5L,MAAL,CAAY6L,iBAAZ,CAA8B1K,KAAKtD,MAAnC,EAA2CsD,KAAKtD,MAAhD;AACA,iCAAK0E,IAAL;;AAEA,gCAAIvE,QAAQ6C,SAASC,WAAT,CAAqB,OAArB,CAAZ;AACA9C,kCAAM+C,SAAN,CAAgB,qBAAhB,EAAuC,KAAvC,EAA8C,KAA9C;AACA/C,kCAAMgD,MAAN,GAAeG,IAAf;AACA,iCAAKD,aAAL,CAAmBlD,KAAnB;AACH,yBAVD,MAWK;AACD,iCAAK8N,QAAL,CAAe,KAAK9B,KAApB;AACH;AACD;AACJ;AACA,yBAAK,EAAL;AACI,4BAAI,KAAKA,KAAL,GAAa,CAAjB,EAAoB;AAChB,iCAAKzH,IAAL;AACH;AACD,6BAAKvC,MAAL,CAAY4L,KAAZ;AACA,6BAAK5L,MAAL,CAAYkC,KAAZ,GAAoB,KAAKiI,UAAzB;AACA;AACJ;AACI;AA5ER;AA8EH,aA/ED,MAgFK;AACD,oBAAIlJ,EAAEwK,OAAF,KAAc,EAAd,IAAoB,KAAKzL,MAAL,CAAYkC,KAApC,EAA0C;AACtC,wBAAMf,QAAO,KAAKnB,MAAL,CAAYkC,KAAzB;AACA,yBAAKlC,MAAL,CAAY6L,iBAAZ,CAA8B1K,MAAKtD,MAAnC,EAA2CsD,MAAKtD,MAAhD;;AAEA,wBAAIG,SAAQ6C,SAASC,WAAT,CAAqB,OAArB,CAAZ;AACA9C,2BAAM+C,SAAN,CAAgB,qBAAhB,EAAuC,KAAvC,EAA8C,KAA9C;AACA/C,2BAAMgD,MAAN,GAAeG,KAAf;AACA,yBAAKD,aAAL,CAAmBlD,MAAnB;AACH,iBARD,MASK,IAAIiD,EAAEwK,OAAF,KAAc,EAAlB,EAAqB;AACtB,yBAAKzL,MAAL,CAAYkC,KAAZ,GAAoB,EAApB;AACA,yBAAK8H,KAAL,GAAa,CAAC,CAAd;AACA,yBAAKhK,MAAL,CAAY4L,KAAZ;AACH;AACJ;AAEJ;;;sCAEY;AACT,mBAAO,KAAK3B,KAAL,GAAa,CAAb,IAAkB,KAAKI,KAAL,CAAWE,KAAX,CAAiBwB,OAAjB,KAA6B,MAAtD;AACH;;;mCAEUpO,C,EAAE;AACT,iBAAKuM,KAAL,GAAa,KAAK8B,MAAL,CAAYrO,CAAZ,CAAb;AACA,gBAAMwD,OAAO,KAAK+I,KAAL,CAAWpF,IAAxB;AACA,gBAAI,KAAKsF,aAAT,EAAwB;AACpB,qBAAKpK,MAAL,CAAYkC,KAAZ,GAAoBf,IAApB;AACA,qBAAKnB,MAAL,CAAY6L,iBAAZ,CAA8B1K,KAAKtD,MAAnC,EAA2CsD,KAAKtD,MAAhD;AACH;AACJ;;;qCAEaF,C,EAAGsD,C,EAAE;AACfA,cAAEwB,cAAF;AACA,iBAAKqJ,QAAL,CAAenO,CAAf;AACH;;;iCAEQA,C,EAAE;AACP,gBAAIgF,OAAOhF,KAAK,CAAL,GAAS,KAAKqO,MAAL,CAAYrO,CAAZ,CAAT,GAA0B,KAAKuM,KAAL,GAAa,KAAKA,KAAlB,GAA0B,IAA/D;AACA,gBAAGvH,IAAH,EAAS;AACL,qBAAKuH,KAAL,GAAavH,IAAb;AACA,qBAAKqH,KAAL,GAAa,CAAC,CAAd;AACA,oBAAM7I,OAAOwB,KAAKmC,IAAlB;AACA,oBAAI,KAAKsF,aAAT,EAAwB;AACpB,yBAAKpK,MAAL,CAAYkC,KAAZ,GAAoBf,IAApB;AACA,yBAAKnB,MAAL,CAAY6L,iBAAZ,CAA8B1K,KAAKtD,MAAnC,EAA2CsD,KAAKtD,MAAhD;AACH;AACD,qBAAKmC,MAAL,CAAY4L,KAAZ;AACA,qBAAKrJ,IAAL;;AAEA,oBAAIvE,QAAQ6C,SAASC,WAAT,CAAqB,OAArB,CAAZ;AACA9C,sBAAM+C,SAAN,CAAgB,oBAAhB,EAAsC,KAAtC,EAA6C,KAA7C;AACA/C,sBAAMgD,MAAN,GAAe2B,IAAf;AACA,qBAAKzB,aAAL,CAAmBlD,KAAnB;AACH;AACJ;;;6BAEIiO,K,EAAOC,S,EAAW;AACnB,gBAAID,MAAMpO,MAAV,EAAkB;AACd,qBAAKqM,KAAL,GAAa,IAAb;AACA,qBAAKF,KAAL,GAAa,CAAC,CAAd;AACA,qBAAKgC,MAAL,GAAcC,KAAd;AACA,oBAAME,OAAO,SAAS,KAAKH,MAAL,CACrB3K,MADqB,CACd,UAAC0D,CAAD;AAAA,2BAAOA,EAAED,IAAF,IAAUC,EAAED,IAAF,CAAOjH,MAAxB;AAAA,iBADc,EAErB2D,GAFqB,CAEjB,UAACuD,CAAD,EAAGpH,CAAH,EAAS;AACV,wBAAImH,8DAA4DC,EAAED,IAA9D,YAAJ;AACA,wBAAIoH,aAAaA,UAAUrO,MAA3B,EAAkC;AAC9B,4BAAMuO,QAAQrH,EAAED,IAAF,CAAOuH,WAAP,GAAqBC,OAArB,CAA8BJ,UAAUG,WAAV,EAA9B,CAAd;AACA,4BAAID,SAAS,CAAC,CAAd,EAAiB;AACb,gCAAIG,OAAQxH,EAAED,IAAF,CAAO0H,MAAP,CAAc,CAAd,EAAiBJ,KAAjB,CAAZ;AACA,gCAAGG,KAAK1O,MAAR,EAAe;AACX0O,8FAA4DA,IAA5D;AACH;AACD,gCAAIE,OAAO1H,EAAED,IAAF,CAAO0H,MAAP,CAAcJ,QAAQF,UAAUrO,MAAhC,CAAX;AACA,gCAAG4O,KAAK5O,MAAR,EAAe;AACX4O,8FAA4DA,IAA5D;AACH;AACD3H,mCAAUyH,IAAV,6DAAsEL,SAAtE,eAAyFO,IAAzF;AACH;AACJ;AACD,6CAAuB9O,CAAvB,SAA4BmH,IAA5B;AACH,iBAnBqB,EAmBnB,EAnBmB,EAmBf4H,IAnBe,CAmBV,EAnBU,CAAT,GAmBK,OAnBlB;;AAqBA,qBAAKrC,KAAL,CAAWtK,SAAX,GAAuBoM,IAAvB;AACA,oBAAIQ,WAAW,KAAKtC,KAAL,CAAWuC,gBAAX,CAA4B,IAA5B,CAAf;AACA,qBAAK,IAAIjP,IAAI,CAAb,EAAgBA,IAAIgP,SAAS9O,MAA7B,EAAqC,EAAEF,CAAvC,EAAyC;AACrCgP,6BAAShP,CAAT,EAAYyC,gBAAZ,CAA6B,OAA7B,EAAsC,KAAKyM,YAAL,CAAkB1M,IAAlB,CAAuB,IAAvB,EAA6BxC,CAA7B,CAAtC;AACH;;AAED,qBAAKsM,KAAL,GAAa0C,SAAS9O,MAAtB;AACA,qBAAKwM,KAAL,CAAWE,KAAX,CAAiBwB,OAAjB,GAA2B,OAA3B;AACH;AACJ;;;+BACM;AACH,iBAAK1B,KAAL,CAAWE,KAAX,CAAiBwB,OAAjB,GAA2B,MAA3B;AACH;;;;;;QAGIhC,U,GAAAA,U;;;;;;AChPT,yC","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ca419f4cb94460ca7e46","class EventTarget {\r\n    constructor(){\r\n        this.listeners = {};\r\n    }\r\n    addEventListener(type, callback) {\r\n        if(!(type in this.listeners)) {\r\n            this.listeners[type] = [];\r\n        }\r\n        this.listeners[type].push(callback);\r\n    }\r\n    removeEventListener (type, callback) {\r\n        if(!(type in this.listeners)) {\r\n            return;\r\n        }\r\n        var stack = this.listeners[type];\r\n        for(var i = 0, l = stack.length; i < l; i++) {\r\n            if(stack[i] === callback){\r\n                stack.splice(i, 1);\r\n                return this.removeEventListener(type, callback);\r\n            }\r\n        }\r\n    }\r\n    dispatchEvent(event) {\r\n        if(!(event.type in this.listeners)) {\r\n            return;\r\n        }\r\n        var stack = this.listeners[event.type];\r\n        // event.target = this;\r\n        for(var i = 0, l = stack.length; i < l; i++) {\r\n            stack[i].call(this, event);\r\n        }\r\n    }\r\n}\r\n\r\nexport { EventTarget };\n\n\n// WEBPACK FOOTER //\n// ./src/lib/EventTarget/src/EventTarget.js","import './SearchWidget.css';\r\nimport { ResultView } from './ResultView.js';\r\nimport { EventTarget } from './lib/EventTarget/src/EventTarget.js';\r\n\r\nfunction chain (tasks, state) {\r\n    return tasks.reduce(\r\n        (prev, next) => prev.then(next),\r\n        new Promise ((resolve, reject) => resolve (state))\r\n    );\r\n}\r\n\r\nclass SearchWidget extends EventTarget {\r\n    constructor(container, {placeHolder, providers, suggestionTimeout = 1000, suggestionLimit = 10, fuzzySearchLimit = 1000, retrieveManyOnEnter = false, replaceInputOnEnter = false}){\r\n        super ();\r\n        this._container = container;\r\n        this._allowSuggestion = true;\r\n        this._providers = providers;\r\n        this._suggestionTimeout = suggestionTimeout;\r\n        this._suggestionLimit = suggestionLimit;\r\n        this._fuzzySearchLimit = fuzzySearchLimit;\r\n        this._retrieveManyOnEnter = retrieveManyOnEnter;\r\n        this._replaceInputOnEnter = replaceInputOnEnter;\r\n\r\n        this._container.classList.add('leaflet-ext-search');\r\n        this._container.innerHTML = `<input type=\"text\" value=\"\" placeholder=\"${placeHolder}\" /><span class=\"leaflet-ext-search-button\"></span>`;\r\n        this._input = this._container.querySelector('input');\r\n\r\n        this._handleChange = this._handleChange.bind(this);\r\n        this._input.addEventListener('input', this._handleChange);\r\n\r\n        this._handleMouseMove = this._handleMouseMove.bind(this);\r\n        this._input.addEventListener('mousemove', this._handleMouseMove);        \r\n        this._input.addEventListener('dragstart', this._handleMouseMove);\r\n        this._input.addEventListener('drag', this._handleMouseMove);\r\n\r\n        this._handleSearch = this._handleSearch.bind(this);\r\n\r\n        this._button = this._container.querySelector('.leaflet-ext-search-button');\r\n        this._button.addEventListener('click', this._handleSearch);\r\n\r\n        this.results = new ResultView({ input: this._input, replaceInput: this._replaceInputOnEnter});\r\n\r\n        this._search = this._search.bind(this);\r\n        this._selectItem = this._selectItem.bind(this);\r\n\r\n        this.results.addEventListener('suggestions:confirm', e => {\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('suggestions:confirm', false, false);\r\n            event.detail = e.detail;\r\n            this.dispatchEvent(event);\r\n            this._search(e);                        \r\n        });\r\n        this.results.addEventListener('suggestions:select', this._selectItem);\r\n\r\n        // map.on ('click', this.results.hide.bind(this.results));\r\n        // map.on ('dragstart', this.results.hide.bind(this.results));\r\n    }\r\n    _suggest (text){\r\n        this.results.allowNavigation = false;\r\n        let tasks =\r\n            this._providers\r\n            .filter (provider => provider.showSuggestion)\r\n            .map(provider => {\r\n                return state => {\r\n                    return new Promise(resolve => {\r\n                        if (state.completed) {\r\n                            resolve(state);\r\n                        }\r\n                        else {\r\n                            provider\r\n                            .find (text, this._suggestionLimit, false, false)\r\n                            .then(response => {\r\n                                state.completed = response.length > 0;\r\n                                state.response = state.response.concat(response);\r\n                                resolve(state);\r\n                            })\r\n                            .catch(e => console.log(e));\r\n                        }\r\n                    });\r\n                };\r\n            });\r\n        chain (tasks, { completed: false, response: [] })\r\n        .then(state => {\r\n            this.results.show(state.response, text.trim());\r\n            this.results.allowNavigation = true;\r\n        });\r\n    }\r\n    _handleChange(e) {\r\n        if (this._input.value.length) {\r\n            if (this._allowSuggestion) {\r\n                this._allowSuggestion = false;\r\n                this._timer = setTimeout(() => {\r\n                    clearTimeout (this._timer);\r\n                    this._allowSuggestion = true;\r\n                    const text = this._input.value;\r\n                    this._suggest(text);\r\n                }, this._suggestionTimeout);\r\n            }\r\n        }\r\n        else {\r\n            this.results.hide();\r\n        }\r\n    }\r\n    _handleMouseMove(e){\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n    }\r\n    _search (e) {\r\n        let text = e.detail;\r\n        let tasks = this._providers\r\n            .filter (provider => provider.showOnEnter)\r\n            .map(provider => {\r\n                return state => {\r\n                    return new Promise(resolve => {\r\n                        if (state.completed) {\r\n                            resolve(state);\r\n                        }\r\n                        else {\r\n                            provider\r\n                            .find (text, this._retrieveManyOnEnter ? this._fuzzySearchLimit : 1, true, true)\r\n                            .then(response => {\r\n                                state.completed = response.length > 0;\r\n                                state.response = state.response.concat(response);\r\n                                resolve(state);\r\n                            })\r\n                            .catch(e => {\r\n                                console.log(e);\r\n                                resolve(state);\r\n                            });\r\n                        }\r\n                    });\r\n                };\r\n            });\r\n\r\n            chain (tasks, {completed: false, response: []})\r\n            .then(state => {                \r\n                // if(state.response.length > 0 && !this._retrieveManyOnEnter){\r\n                //     let item = state.response[0];\r\n                //     item.provider\r\n                //     .fetch(item.properties)\r\n                //     .then(response => {});                    \r\n                // }\r\n            });\r\n\r\n            this.results && this.results.hide();\r\n    }\r\n    _selectItem (e){\r\n        let item = e.detail;\r\n        return item.provider.fetch(item.properties);\r\n    }\r\n    _handleSearch (e) {\r\n         e.stopPropagation();\r\n         this._search ({detail: this._input.value});\r\n    }\r\n    setText (text) {\r\n        this._input.value = text;\r\n    }\r\n    setPlaceHolder (value) {\r\n        this._input.placeholder = value;\r\n    }\r\n}\r\n\r\nexport { SearchWidget };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/SearchWidget.js","import { EventTarget } from '../lib/EventTarget/src/EventTarget.js';\r\n\r\nclass CadastreDataProvider extends EventTarget {\r\n    constructor({serverBase, tolerance}){\r\n        super();\r\n        this._serverBase = serverBase;        \r\n        this._tolerance = tolerance;        \r\n        this.showSuggestion = true;\r\n        this.showOnSelect = false;\r\n        this.showOnEnter = true;\r\n        this._cadastreLayers = [\r\n\t\t\t{id: 1, title: 'Участок', \treg: /^\\d\\d:\\d+:\\d+:\\d+$/},\r\n\t\t\t{id: 2, title: 'Квартал',\treg: /^\\d\\d:\\d+:\\d+$/},\r\n\t\t\t{id: 3, title: 'Район', \treg: /^\\d\\d:\\d+$/},\r\n\t\t\t{id: 4, title: 'Округ', \treg: /^\\d\\d$/},\r\n            {id: 5, title: 'ОКС', \t\treg: /^\\d\\d:\\d+:\\d+:\\d+:\\d+$/},\r\n\t\t\t{id: 10, title: 'ЗОУИТ', \treg: /^\\d+\\.\\d+\\.\\d+/}\r\n\t\t\t// ,\r\n\t\t\t// {id: 7, title: 'Границы', \treg: /^\\w+$/},\r\n\t\t\t// {id: 6, title: 'Тер.зоны', \treg: /^\\w+$/},\r\n\t\t\t// {id: 12, title: 'Лес', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 13, title: 'Красные линии', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 15, title: 'СРЗУ', \treg: /^\\w+$/},\r\n\t\t\t// {id: 16, title: 'ОЭЗ', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 9, title: 'ГОК', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 10, title: 'ЗОУИТ', \treg: /^\\w+$/}\r\n\t\t\t// /[^\\d\\:]/g,\r\n\t\t\t// /\\d\\d:\\d+$/,\r\n\t\t\t// /\\d\\d:\\d+:\\d+$/,\r\n\t\t\t// /\\d\\d:\\d+:\\d+:\\d+$/\r\n\t\t];\r\n    }    \r\n    getCadastreLayer (str, type) {\r\n        str = str.trim();\r\n        for (var i = 0, len = this._cadastreLayers.length; i < len; i++) {\r\n            var it = this._cadastreLayers[i];\r\n            if (it.id === type) { return it; }\r\n            if (it.reg.exec(str)) { return it; }\r\n        }\r\n        return this._cadastreLayers[0];\r\n    }\r\n    find(value, limit, strong, retrieveGeometry){   \r\n        const cadastreLayer = this.getCadastreLayer(value);    \r\n        return new Promise(resolve => {\r\n            // let req = new Request(`${this._serverBase}/typeahead?limit=${limit}&skip=0&text=${value}&type=${cadastreLayer.id}`);\r\n            let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?text=${value}&tolerance=${this._tolerance}&limit=${limit}`);\r\n            let headers = new Headers();\r\n            headers.append('Content-Type','application/json');            \r\n            let init = {\r\n                method: 'GET',            \r\n                mode: 'cors',                \r\n                cache: 'default',\r\n            };\r\n            fetch (req, init)\r\n            .then(response => response.json())\r\n            .then(json => {\r\n                // if(json.status === 200){\r\n                    let rs = json.features.map(x => {\r\n                        return {\r\n                            name: x.attrs.name || x.attrs.cn || x.attrs.id,\r\n                            properties: x,\r\n                            provider: this,\r\n                            query: value,\r\n                        };\r\n                    });\r\n                    resolve(rs);\r\n                // }\r\n                // else {\r\n                    // resolve(json);\r\n                // }                                       \r\n                                    \r\n            });\r\n        });\r\n    }\r\n    fetch(obj) {\r\n\t\tvar text = obj.attrs.name || obj.attrs.cn || obj.attrs.id;\r\n        const cadastreLayer = this.getCadastreLayer(text, obj.type);\r\n        return new Promise(resolve => {\r\n            if(cadastreLayer) {\r\n                // let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?tolerance=${this._tolerance}&limit=1&text=${obj.value}`);\r\n                let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?tolerance=${this._tolerance}&limit=1&text=${text}`);\r\n                let headers = new Headers();\r\n                headers.append('Content-Type','application/json');\r\n                let init = {\r\n                    method: 'GET',            \r\n                    mode: 'cors',                    \r\n                    cache: 'default',\r\n                };\r\n                fetch (req, init)\r\n                .then(response => response.json())\r\n                .then(json => {\r\n                    if(json.status === 200) {\r\n                        let event = document.createEvent('Event');\r\n                        event.initEvent('fetch', false, false);\r\n                        event.detail = json;\r\n                        this.dispatchEvent(event);\r\n                        \r\n                        let rs = json.features.map(x => {\r\n                            return {\r\n                                name: x.attrs.name || x.attrs.cn || x.attrs.id,\r\n                                properties: x,\r\n                                provider: this,\r\n                                query: obj,\r\n                            };\r\n                            \r\n                        });\r\n                        resolve(rs);\r\n\r\n                    }\r\n                    else {\r\n                        resolve(json);\r\n                    }                                        \r\n                });\r\n            }\r\n            else {\r\n                resolve([]);\r\n            }            \r\n        });\r\n    }\r\n}\r\n\r\nexport { CadastreDataProvider };\n\n\n// WEBPACK FOOTER //\n// ./src/DataProviders/CadastreDataProvider.js","import { EventTarget } from '../lib/EventTarget/src/EventTarget.js';\r\n\r\nclass CoordinatesDataProvider extends EventTarget {\r\n    constructor(){\r\n        super();        \r\n        this.showSuggestion = false;        \r\n        this.showOnSelect = false;\r\n        this.showOnEnter = true;\r\n        this.fetch = this.fetch.bind(this);\r\n        this.find = this.find.bind(this);        \r\n\r\n        this.rxF = new RegExp('^\\\\s*\\\\-?(\\\\d+(\\\\.\\\\d+)?)(\\\\s+[N|S])?(,\\\\s*|\\\\s+)\\\\-?(\\\\d+(\\\\.\\\\d+)?)(\\\\s+[E|W])?');\r\n        this.rxD = new RegExp('^\\\\s*(\\\\d{1,2})[\\\\s|\\\\u00b0](\\\\d{1,2})[\\\\s|\\\\u0027](\\\\d{1,2}\\\\.\\\\d+)\\\\u0022?(\\\\s+[N|S])?,?\\\\s+(\\\\d{1,2})[\\\\s|\\\\u00b0](\\\\d{1,2})[\\\\s|\\\\u0027](\\\\d{1,2}\\\\.\\\\d+)\\\\u0022?(\\\\s+[E|W])?');\r\n    }\r\n    _parseCoordinates(value) {\r\n        let m = this.rxD.exec(value);\r\n        if (Array.isArray(m) && m.length === 9) {\r\n            return this._parseDegrees ([m[1],m[2],m[3],m[5],m[6],m[7]].map(x => parseFloat(x)));\r\n        }\r\n        m = this.rxF.exec(value);\r\n        if (Array.isArray (m) && m.length === 8){\r\n            return {type: 'Point', coordinates: [\r\n                parseFloat(m[5]),\r\n                parseFloat(m[1])\r\n            ]};\r\n        }\r\n        \r\n        return null;               \r\n    }\r\n    _parseDegrees ([latDeg, latMin, latSec, lngDeg, lngMin, lngSec]) {    \r\n        return {type: 'Point', coordinates: [\r\n            lngDeg + lngMin / 60 + lngSec / 3600,\r\n            latDeg + latMin / 60 + latSec / 3600\r\n        ]};\r\n    }\r\n    fetch (value){\r\n        return new Promise(resolve => resolve([]));\r\n    }\r\n    find(value, limit, strong, retrieveGeometry){        \r\n        let g = this._parseCoordinates(value);        \r\n        return new Promise(resolve => {\r\n            let result = {feature: { type: 'Feature', geometry: g, properties: {} }, provider: this, query: value};\r\n            if (g) {\r\n                let event = document.createEvent('Event');\r\n                event.initEvent('fetch', false, false);\r\n                event.detail = result;\r\n                this.dispatchEvent(event);\r\n            }             \r\n            resolve(g ? [result] : []);\r\n        });\r\n    }\r\n}\r\n\r\nexport { CoordinatesDataProvider };\n\n\n// WEBPACK FOOTER //\n// ./src/DataProviders/CoordinatesDataProvider.js","\r\nimport { EventTarget } from '../lib/EventTarget/src/EventTarget.js';\r\n\r\nclass OsmDataProvider extends EventTarget {\r\n    constructor({serverBase}){\r\n        super();\r\n        this._serverBase = serverBase;             \r\n        this.showSuggestion = true;    \r\n        this.showOnSelect = true;\r\n        this.showOnEnter = true;\r\n        this.find = this.find.bind(this);\r\n        this.fetch = this.fetch.bind(this);\r\n        this._convertGeometry = this._convertGeometry.bind(this);\r\n\r\n        this._key = window.KOSMOSNIMKI_SESSION_KEY == null || window.KOSMOSNIMKI_SESSION_KEY == 'INVALID' ? '' : `&key=${window.KOSMOSNIMKI_SESSION_KEY}`;\r\n    }\r\n    _convertGeometry(geometry) {        \r\n        switch (geometry.type.toUpperCase()) {\r\n            case 'POINT':\r\n                geometry.type = 'Point';\r\n                break;\r\n            case 'POLYGON':\r\n                geometry.type = 'Polygon';\r\n                break;\r\n            case 'MULTIPOLYGON':\r\n                geometry.type = 'MultiPolygon';\r\n                break;\r\n            case 'LINESTRING':\r\n            case 'POLYLINE':\r\n                geometry.type = 'LineString';\r\n                break;\r\n            case 'MULTILINESTRING':\r\n                geometry.type = 'MultiLineString';\r\n                break;\r\n            default:\r\n                throw 'Unknown WKT type';\r\n        }\r\n        return geometry;\r\n    }\r\n    fetch (obj) {\r\n        const query = `WrapStyle=None&RequestType=ID&ID=${obj.ObjCode}&TypeCode=${obj.TypeCode}&UseOSM=1`;        \r\n        let req = new Request(`${this._serverBase}/SearchObject/SearchAddress.ashx?${query}${this._key}`);\r\n        let headers = new Headers();\r\n        headers.append('Content-Type','application/json');        \r\n        let init = {\r\n            method: 'GET',            \r\n            mode: 'cors',\r\n            credentials: 'include',        \r\n            cache: 'default',\r\n        };\r\n        return new Promise((resolve, reject) => {\r\n            fetch (req, init)\r\n            .then(response => response.json())\r\n            .then(json => {\r\n                if(json.Status === 'ok'){\r\n                    const rs = json.Result\r\n                    .reduce((a,x) => a.concat(x.SearchResult), [])\r\n                    .map(x => {\r\n                        let g = this._convertGeometry (x.Geometry);\r\n                        let props = Object.keys(x)\r\n                        .filter(k => k !== 'Geometry')\r\n                        .reduce((a,k) => {\r\n                            a[k] = x[k];\r\n                            return a;\r\n                        }, {});\r\n                        return {\r\n                            feature: {\r\n                                type: 'Feature',\r\n                                geometry: g,\r\n                                properties: props,                            \r\n                            },\r\n                            provider: this,\r\n                            query: obj,\r\n                        };\r\n                    });\r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('fetch', false, false);\r\n                    event.detail = rs;\r\n                    this.dispatchEvent(event);\r\n                    resolve(rs);\r\n                }\r\n                else {\r\n                    reject(json);\r\n                }                \r\n            })\r\n            .catch(response => reject(response));\r\n        });\r\n    }\r\n    find(value, limit, strong, retrieveGeometry){                \r\n        return new Promise((resolve, reject) => {\r\n            if (value || value.trim()) {\r\n                const _strong = Boolean(strong) ? 1 : 0;\r\n                const _withoutGeometry = Boolean(retrieveGeometry) ? 0 : 1; \r\n                const query = `WrapStyle=None&RequestType=SearchObject&IsStrongSearch=${_strong}&WithoutGeometry=${_withoutGeometry}&UseOSM=1&Limit=${limit}&SearchString=${encodeURIComponent(value)}`;        \r\n                let req = new Request(`${this._serverBase}/SearchObject/SearchAddress.ashx?${query}${this._key}`);\r\n                let headers = new Headers();\r\n                headers.append('Content-Type','application/json');        \r\n                let init = {\r\n                    method: 'GET',\r\n                    mode: 'cors', \r\n                    credentials: 'include',\r\n                    cache: 'default',\r\n                };\r\n                fetch (req, init)\r\n                .then(response => response.json())\r\n                .then(json => {                \r\n                    if(json.Status === 'ok'){                    \r\n                        const rs = json.Result\r\n                        .reduce((a,x) => a.concat(x.SearchResult), [])\r\n                        .map(x => {\r\n                            if (retrieveGeometry && x.Geometry) {\r\n                                let g = this._convertGeometry (x.Geometry);\r\n                                let props = Object.keys(x)\r\n                                .filter(k => k !== 'Geometry')\r\n                                .reduce((a,k) => {\r\n                                    a[k] = x[k];\r\n                                    return a;\r\n                                }, {});\r\n                                return {\r\n                                    name: x.ObjNameShort,\r\n                                    feature: {\r\n                                        type: 'Feature',\r\n                                        geometry: g,\r\n                                        properties: props,                            \r\n                                    },\r\n                                    properties: props,\r\n                                    provider: this,\r\n                                    query: value,\r\n                                };\r\n                            }\r\n                            else {\r\n                                return {\r\n                                    name: x.ObjNameShort,\r\n                                    properties: x,\r\n                                    provider: this,\r\n                                    query: value,\r\n                                };\r\n                            }                        \r\n                        });\r\n                        if (strong && retrieveGeometry) {                        \r\n                            let event = document.createEvent('Event');\r\n                            event.initEvent('fetch', false, false);\r\n                            event.detail = rs;\r\n                            this.dispatchEvent(event);\r\n                        }\r\n                        resolve(rs);\r\n                    }\r\n                    else {\r\n                        reject(json);\r\n                    }                \r\n                })\r\n                .catch(response => reject(response));\r\n\r\n            }\r\n            else {\r\n                reject('Empty string');\r\n            }                        \r\n        });\r\n    }\r\n}\r\n\r\nexport { OsmDataProvider };\n\n\n// WEBPACK FOOTER //\n// ./src/DataProviders/OsmDataProvider.js","import { SearchWidget } from './SearchWidget.js';\r\n\r\nlet SearchControl = L.Control.extend({\r\n    includes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n    initialize: function(options) {\r\n        L.setOptions(this, options);\r\n        this._allowSuggestion = true;\r\n        this.options.suggestionTimeout = this.options.suggestionTimeout || 1000;\r\n        this.options.suggestionLimit = this.options.suggestionLimit || 10;\r\n    },\r\n    onAdd: function(map) {\r\n        this._container = L.DomUtil.create('div', 'leaflet-ext-search');\r\n        this._widget = new SearchWidget(this._container, this.options);\r\n        map.on('click', this._widget.results.hide.bind(this._widget.results));\r\n        map.on('dragstart', this._widget.results.hide.bind(this._widget.results));        \r\n        return this._container;\r\n    },\r\n    addTo: function(map) {\r\n        L.Control.prototype.addTo.call(this, map);\r\n        if (this.options.addBefore) {\r\n            this.addBefore(this.options.addBefore);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    addBefore: function(id) {\r\n        let parentNode = this._parent && this._parent._container;\r\n        if (!parentNode) {\r\n            parentNode = this._map && this._map._controlCorners[this.getPosition()];\r\n        }\r\n        if (!parentNode) {\r\n            this.options.addBefore = id;\r\n        }\r\n        else {\r\n            for (let i = 0, len = parentNode.childNodes.length; i < len; i++) {\r\n                let it = parentNode.childNodes[i];\r\n                if (id === it._id) {\r\n                    parentNode.insertBefore(this._container, it);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n    setText (text) {\r\n        this._widget.setText (text);\r\n    },\r\n\r\n    setPlaceHolder (value) {\r\n        this._widget.setPlaceHolder (value);\r\n    },\r\n});\r\n\r\nexport { SearchControl };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/SearchControl.js","import { SearchWidget } from './src/SearchWidget.js';\r\nimport { SearchControl } from './src/SearchControl.js';\r\nimport { OsmDataProvider } from './src/DataProviders/OsmDataProvider.js';\r\nimport { CoordinatesDataProvider } from './src/DataProviders/CoordinatesDataProvider.js';\r\nimport { CadastreDataProvider } from './src/DataProviders/CadastreDataProvider.js';\r\n\r\nwindow.nsGmx = window.nsGmx || {};\r\nwindow.nsGmx.SearchWidget = SearchWidget;\r\nwindow.nsGmx.SearchControl = SearchControl;\r\nwindow.nsGmx.OsmDataProvider = OsmDataProvider;\r\nwindow.nsGmx.CoordinatesDataProvider = CoordinatesDataProvider;\r\nwindow.nsGmx.CadastreDataProvider = CadastreDataProvider;\n\n\n// WEBPACK FOOTER //\n// ./init.js","import { EventTarget } from './lib/EventTarget/src/EventTarget.js';\r\n\r\nclass ResultView extends EventTarget {\r\n    constructor({input, replaceInput = false}){\r\n        super();\r\n        this._input = input;            \r\n        this.index = -1;\r\n        this.count = 0;\r\n        this._item = null;\r\n        this._inputText = '';\r\n        this._replaceInput = replaceInput;\r\n        this._list = L.DomUtil.create('div');\r\n        this._list.setAttribute('class', 'leaflet-ext-search-list noselect');\r\n\r\n        this.allowNavigation = true;\r\n\r\n        this._list.style.top = `${this._input.offsetTop + this._input.offsetHeight + 2}px`;\r\n        this._list.style.left = `${this._input.offsetLeft}px`;\r\n\r\n        this._handleKey = this._handleKey.bind(this);\r\n        this._input.addEventListener('keydown', this._handleKey);\r\n\r\n        this._handleInputClick = this._handleInputClick.bind(this);\r\n        this._input.addEventListener('click', this._handleInputClick);\r\n\r\n        this._handleFocus = this._handleFocus.bind(this);\r\n        this._input.addEventListener('focus', this._handleFocus);\r\n        this._list.addEventListener('keydown', this._handleKey);\r\n\r\n        this._handleWheel = this._handleWheel.bind(this);\r\n        this._list.addEventListener('wheel', this._handleWheel);\r\n        L.DomEvent.disableClickPropagation(this._list).disableScrollPropagation(this._list);\r\n        // this._list.addEventListener('mousewheel', this._handleWheel.bind(this));\r\n        // this._list.addEventListener('MozMousePixelScroll', this._handleWheel.bind(this));       \r\n        this._input.parentElement.appendChild(this._list); \r\n\r\n        this._handleChange = this._handleChange.bind(this);\r\n        this._input.addEventListener('input', this._handleChange);\r\n    }\r\n\r\n    _handleInputClick (e) {\r\n        e.stopPropagation();\r\n    }\r\n\r\n    _handleFocus(e){        \r\n        if(this.index >= 0) {\r\n            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`); \r\n            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n        }\r\n        this.index = -1;\r\n        this._item = null;\r\n    } \r\n\r\n    _handleChange(e){\r\n        this._inputText = this._input.value;\r\n    }\r\n\r\n    _handleWheel (e) {\r\n        e.stopPropagation();        \r\n    } \r\n\r\n    _handleKey(e){        \r\n        if(this.listVisible()) {\r\n            switch (e.keyCode){\r\n                // ArroLeft / ArrowRight\r\n                case 37:\r\n                case 39:\r\n                    e.stopPropagation();\r\n                    break;\r\n                // ArrowDown\r\n                case 40:\r\n                    e.preventDefault();\r\n                    e.stopPropagation();                 \r\n                    if (this.allowNavigation) {                        \r\n                        if (this.index < 0){\r\n                            this.index = 0;\r\n                        }\r\n                        else if (0 <= this.index && this.index < this.count - 1){\r\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n                            ++this.index;\r\n                        }   \r\n                        else {\r\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n                            this.index = this.count - 1;\r\n                        }\r\n                        let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                        L.DomUtil.addClass (el, 'leaflet-ext-search-list-selected'); \r\n                        this.selectItem(this.index);\r\n                        el.focus();\r\n                    }\r\n                    break;\r\n                // ArrowUp\r\n                case 38:\r\n                    e.preventDefault(); \r\n                    e.stopPropagation(); \r\n                    if (this.allowNavigation) {\r\n                        if(this.index > 0){\r\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`); \r\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n                            --this.index;\r\n                            el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                            L.DomUtil.addClass (el, 'leaflet-ext-search-list-selected');\r\n                            this.selectItem(this.index);\r\n                            el.focus();            \r\n                        }\r\n                        else if (this.index === 0) {                    \r\n                            this._input.focus();                \r\n                            this._input.value = this._inputText;                    \r\n                        }\r\n                    }\r\n                    break;\r\n                // Enter\r\n                case 13:\r\n                    if (this.index < 0 && this._input.value){\r\n                        const text = this._input.value;\r\n                        this._input.focus();\r\n                        this._input.setSelectionRange(text.length, text.length);                                      \r\n                        this.hide();\r\n                        \r\n                        let event = document.createEvent('Event');\r\n                        event.initEvent('suggestions:confirm', false, false);\r\n                        event.detail = text;\r\n                        this.dispatchEvent(event);\r\n                    }\r\n                    else {\r\n                        this.complete (this.index);\r\n                    }                   \r\n                    break;\r\n                // Escape\r\n                case 27:\r\n                    if (this.index < 0) {\r\n                        this.hide ();\r\n                    }\r\n                    this._input.focus();\r\n                    this._input.value = this._inputText;\r\n                    break;                 \r\n                default:\r\n                    break;\r\n            }            \r\n        }\r\n        else {            \r\n            if (e.keyCode === 13 && this._input.value){ \r\n                const text = this._input.value;\r\n                this._input.setSelectionRange(text.length, text.length);\r\n\r\n                let event = document.createEvent('Event');\r\n                event.initEvent('suggestions:confirm', false, false);\r\n                event.detail = text;\r\n                this.dispatchEvent(event);                \r\n            }\r\n            else if (e.keyCode === 27){\r\n                this._input.value = '';\r\n                this.index = -1;\r\n                this._input.focus();                \r\n            }\r\n        } \r\n                                                                    \r\n    }\r\n\r\n    listVisible(){\r\n        return this.count > 0 && this._list.style.display !== 'none';\r\n    }\r\n\r\n    selectItem(i){        \r\n        this._item = this._items[i];        \r\n        const text = this._item.name;\r\n        if (this._replaceInput) {\r\n            this._input.value = text;            \r\n            this._input.setSelectionRange(text.length, text.length);\r\n        }        \r\n    }\r\n\r\n    _handleClick (i, e){\r\n        e.preventDefault();\r\n        this.complete (i);\r\n    }\r\n\r\n    complete(i){\r\n        let item = i >= 0 ? this._items[i] : this._item ? this._item : null;\r\n        if(item) {\r\n            this._item = item;        \r\n            this.index = -1;            \r\n            const text = item.name;\r\n            if (this._replaceInput) {\r\n                this._input.value = text;\r\n                this._input.setSelectionRange(text.length, text.length);\r\n            }\r\n            this._input.focus();\r\n            this.hide();\r\n\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('suggestions:select', false, false);\r\n            event.detail = item;\r\n            this.dispatchEvent(event);            \r\n        }        \r\n    }\r\n\r\n    show(items, highlight) {        \r\n        if (items.length) {\r\n            this._item = null;\r\n            this.index = -1;\r\n            this._items = items;\r\n            const html = '<ul>' + this._items\r\n            .filter((x) => x.name && x.name.length)\r\n            .map((x,i) => {\r\n                let name = `<span class=\"leaflet-ext-search-list-item-normal\">${x.name}</span>`;\r\n                if (highlight && highlight.length){\r\n                    const start = x.name.toLowerCase().indexOf (highlight.toLowerCase());\r\n                    if (start != -1) {\r\n                        let head =  x.name.substr(0, start);\r\n                        if(head.length){\r\n                            head = `<span class=\"leaflet-ext-search-list-item-normal\">${head}</span>`;\r\n                        }                        \r\n                        let tail = x.name.substr(start + highlight.length);\r\n                        if(tail.length){\r\n                            tail = `<span class=\"leaflet-ext-search-list-item-normal\">${tail}</span>`;\r\n                        }\r\n                        name = `${head}<span class=\"leaflet-ext-search-list-item-highlight\">${highlight}</span>${tail}`;\r\n                    }                                        \r\n                }                \r\n                return `<li tabindex=${i}>${name}</li>`;               \r\n            }, []).join('') + '</ul>';\r\n\r\n            this._list.innerHTML = html;\r\n            let elements = this._list.querySelectorAll('li');\r\n            for (let i = 0; i < elements.length; ++i){\r\n                elements[i].addEventListener('click', this._handleClick.bind(this, i));            \r\n            }\r\n            \r\n            this.count = elements.length;\r\n            this._list.style.display = 'block';\r\n        }\r\n    }\r\n    hide() {        \r\n        this._list.style.display = 'none';                \r\n    }\r\n}\r\n\r\nexport { ResultView };\n\n\n// WEBPACK FOOTER //\n// ./src/ResultView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/SearchWidget.css\n// module id = 8\n// module chunks = 0"],"sourceRoot":""}