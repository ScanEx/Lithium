{"version":3,"sources":["webpack:///webpack/bootstrap 97d66e0a1c8c5671291b","webpack:///./src/entry.js","webpack:///./src/all.css","webpack:///./src/Views/View.css","webpack:///./src/locale.js","webpack:///./src/PluginPanel.js","webpack:///./src/ViewsFactory.js","webpack:///./src/Views/MyCollectionView.js","webpack:///./src/Views/MyCollection.css","webpack:///./src/Views/BaseView.js","webpack:///./src/Search/SearchControl.js","webpack:///./src/Search/SearchControl.css","webpack:///./src/Models/MyCollectionModel.js","webpack:///./src/Polyfill.js","webpack:///./src/Views/RegisterDlgView.js","webpack:///./src/Views/RegisterDialog.css","webpack:///./src/Models/RegisterModel.js","webpack:///./src/Search/Searcher.js"],"names":["PRODUCTION","NOSIDEBAR","SIDEBAR2","require","pluginName","menuId","toolbarIconId","cssTable","modulePath","gmxCore","getModulePath","PluginPanel","ViewsFactory","publicInterface","afterViewer","params","map","options","aisLastPoint","viewFactory","pluginPanel","sidebar","window","iconSidebarWidget","tab","createTabFunction","icon","active","inactive","hint","_gtxt","querySelector","innerHTML","sidebarPane","setPane","createTab","addEventListener","e","_activeTabId","show","addModule","css","_translationsHash","addtext","module","exports","_isReady","_activeView","_canvas","_div","_views","create","_create","$","append","v","frame","resize","_returnInstance","call","MyCollectionView","MyCollectionModel","RegisterDlgView","RegisterModel","Searcher","_searcher","_rm","_rdv","model","_mcm","_mcv","registerDlg","BaseView","SearchControl","Handlebars","compile","gifLoader","container","find","searchInput","callback","vessel","mmsi","data","vessels","every","x","rs","push","save","bind","tableTemplate","on","collection","length","_clean","count","text","prototype","Object","inProgress","state","progress","hide","h","height","outerHeight","repaint","each","i","elm","inst","off","splice","focus","apply","arguments","_calcHeight","template","getBoundingClientRect","H","topOffset","view","scrollCont","empty","isActive","is","clean","startScreen","position","top","content","mCustomScrollbar","mcsbOptions","_this","target","JSON","parse","attr","infoDialogView","xmin","xmax","longitude","ymin","ymax","latitude","hasOwnProperty","ts_pos_utc","ts_pos_org","dt_pos_utc","closest","html","stringify","stopPropagation","update","_searchString","_sparams","localStorage","getItem","suggestions","appendChild","document","createElement","preferences","classList","add","search","asparams","split","console","log","forEach","p","q","searchBut","prefeBut","removeBut","delay","suggestionsCount","suggestionsFrame","first","current","last","found","values","searchDone","vessel_name","value","doSearch","actualId","queries","fetch","sp","Promise","all","then","a","r","status","json","concat","Name","MMSI","imo","IMO","vessel_type","Type","RS","owner","RegisteredOwner","callsign","Callsign","reject","style","display","suggestion","querySelectorAll","cr","left","bottom","width","Math","round","el","onclick","currentTarget","id","response","offsetWidth","ch","contains","sparam","replace","remove","RegExp","setItem","clearTimeout","onkeydown","keyCode","previousSibling","nextSibling","scrollInertia","prepareSearchInput","temp","click","onkeyup","setTimeout","onpaste","originalEvent","clipboardData","getData","Polyfill","searcher","_actualUpdate","_data","isDirty","predicate","list","thisArg","undefined","findIndex","defineProperty","set","filter","indexOf","new_tasks","some","cv","tasks","axis","callbacks","whileScrolling","mcs","direction","onScrollStart","mousedown","loadMeta","feeldsTree","columns","checked","caption","j","nodes","k","name","disabled","trans","_export","ev","form","FormData","_vesselsToExport","c","serverBase","method","mode","body","credentials","res","src","catch","_showFieldsTree","panel","offset","siblings","_showFieldsTreeBranch","lbl","b","_dialog","_dialogRect","_dialogW","w","_dialogH","_containerH","dx","dy","canvas","screen","sw","parseFloat","getComputedStyle","sh","posX","posY","isMaximized","columns_ts","columnsTs","showDialog","closeFunc","timestamp","dialog","resizable","event","ui","size","parent","titlebar","parents","chb","node","s","n","pop","uls","inputs","eq","_repaintExport","cells","getOuterWidth","setOuterWidth","w1","after","cont_w","calc_w","returnInstance","beforeLoad","load","z","rr","parseInt","version","ds","properties","wait","Date","getTime","actualUpdate","Status","toLowerCase","ErrorInfo","msg","txt","resolve","columnsJson","convert","name1","name3","name2","e0","i0","e1","i1","e2","i2","attributes","nn","_baseUrl","location","href","_aisServices","_serverScript","_aisLastPoint","_screenSearchLayer","screenSearchLayer","_aisLayerID","aisLayerID","_historyLayer","historyLayer","baseUrl","aisServices","getBorder","lmap","nsGmx","leafletMap","dFeatures","gmxDrawing","getFeatures","toGeoJSON","latLngBounds","getBounds","getSouthWest","ne","getNorthEast","min","lng","y","lat","max","minX","maxX","geo","type","coordinates","center","formatTime","d","local","setMinutes","getMinutes","getTimezoneOffset","toLocaleTimeString","formatDate","toLocaleDateString","formatDateTime","isNaN","toLocaleString","formatDate2","dd","m","mm","getDate","slice","getMonth","getFullYear","getHours","getUTCHours","getUTCMinutes","getUTCDate","getUTCMonth","getUTCFullYear","ldd","lm","ly","lh","lmm","placeVesselTypeIcon","sog","searchString","isfuzzy"],"mappings":"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","file":"LloydsPlugin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 97d66e0a1c8c5671291b","let PRODUCTION = false,\r\n    NOSIDEBAR = false,\r\n    SIDEBAR2 = false;\r\nif (has('PRODUCTION')) PRODUCTION = true;\r\nif (has('NOSIDEBAR'))  NOSIDEBAR = true;\r\nif (has('SIDEBAR2'))   SIDEBAR2 = true;\r\n\r\nrequire(\"./all.css\")\r\nrequire(\"./Views/View.css\")\r\nrequire(\"./locale.js\")\r\n\r\n// Handlebars.registerHelper('aisinfoid', function (context) {\r\n//     return context.mmsi + \" \" + context.imo;\r\n// });\r\n\r\n// Handlebars.registerHelper('aisjson', function (context) {\r\n//     return JSON.stringify(context);\r\n// });\r\n\r\nconst pluginName = PRODUCTION ? 'LloydsPlugin' : 'LloydsPluginTest',\r\n      menuId = 'LloydsPlugin',\r\n      toolbarIconId = null, \r\n      cssTable = PRODUCTION ? 'LloydsPlugin' : 'LloydsPlugin',\r\n      modulePath = gmxCore.getModulePath(pluginName);\r\n\r\nconst PluginPanel = require('./PluginPanel.js'),\r\n      ViewsFactory = require('./ViewsFactory');\r\n\r\nconst publicInterface = {\r\n    pluginName: pluginName,\r\n    afterViewer: function (params, map) {\r\n        const options = {\r\n            aisLastPoint: '303F8834DEE2449DAF1DA9CD64B748FE',\r\n            modulePath: modulePath,\r\n            },\r\n            viewFactory = new ViewsFactory(options),\r\n            pluginPanel = new PluginPanel(viewFactory);\r\n        pluginPanel.menuId = menuId;\r\n\r\n        let sidebar = window.iconSidebarWidget,\r\n        tab = window.createTabFunction({\r\n                    icon: \"Lloyds\", //menuId,\r\n                    active: \"lloyds_sidebar-icon\",\r\n                    inactive: \"lloyds_sidebar-icon\",\r\n                    hint: _gtxt('Lloyds.title')\r\n                })()\r\n        tab.querySelector('.Lloyds').innerHTML = '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 14 14\"><path d=\"M13.13,0H0.88A0.83,0.83,0,0,0,0,.88V13.13A0.83,0.83,0,0,0,.88,14H13.13A0.83,0.83,0,0,0,14,13.13V0.88A0.83,0.83,0,0,0,13.13,0ZM12.25,12.25H1.75V1.75h10.5v10.5Z\"/><rect x=\"3.5\" y=\"4.38\" width=\"7\" height=\"1.75\"/><rect x=\"3.5\" y=\"7.88\" width=\"7\" height=\"1.75\"/></svg>';\r\n        pluginPanel.sidebarPane = sidebar.setPane(\r\n            menuId, {\r\n                createTab: ()=>{\r\n                    return tab;\r\n                }\r\n            }\r\n        )\r\n        sidebar.addEventListener('opened', function (e) {\r\n            if (sidebar._activeTabId == menuId)\r\n                pluginPanel.show();\r\n        });\r\n    }\r\n};\r\n\r\ngmxCore.addModule(pluginName, publicInterface, {\r\n    css: cssTable + '.css'\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/all.css\n// module id = 1\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/View.css\n// module id = 3\n// module chunks = 0","\r\n    _translationsHash.addtext('rus', {\r\n        \"Lloyds.title\": \"Регистр Ллойда\",\r\n        \"Lloyds.search_placeholder\": \"Поиск\",\r\n        \"Lloyds.found\":\"Найдено: \",\r\n        \"Lloyds.vesselExclude\":\"удалить\",\r\n        \"Lloyds.showRegister\":\"Открыть регистр\",\r\n        \"Lloyds.cleanList\":\"Очистить список\",\r\n\r\n        \"Lloyds.fieldsSelector\":\"Показывать колонки\",\r\n        \"Lloyds.dlgTitle\":\"Регистр судов\",\r\n        \"Lloyds.closeButton\":\"закрыть\",\r\n        \"Lloyds.expandButton\":\"развернуть\",\r\n        \"Lloyds.shrinkButton\":\"свернуть\",\r\n    });\r\n    _translationsHash.addtext('eng', {\r\n        \"Lloyds.title\": \"Lloyd's register\",\r\n        \"Lloyds.search_placeholder\": \"Search\",\r\n        \"Lloyds.found\":\"Found \",\r\n        \"Lloyds.vesselExclude\":\"remove\",\r\n        \"Lloyds.showRegister\":\"Open register\",\r\n        \"Lloyds.cleanList\":\"Clean\",\r\n        \"Lloyds.fieldsSelector\":\"Select columns\",\r\n        \"Lloyds.dlgTitle\":\"Register\",\r\n        \"Lloyds.closeButton\":\"close\",\r\n        \"Lloyds.expandButton\":\"maximize\",\r\n        \"Lloyds.shrinkButton\":\"minimize\",\r\n    });\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/locale.js","let NOSIDEBAR = false,\r\n    PRODUCTION = false,\r\n    SIDEBAR2 = false;\r\nif (has('NOSIDEBAR'))\r\n    NOSIDEBAR = true;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\n\r\n\r\nmodule.exports = function (viewFactory) {\r\n    let _isReady = false,\r\n        _activeView,\r\n        _canvas = _div(null),\r\n        _views = viewFactory.create(),\r\n        _create = function () {\r\n            $(this.sidebarPane).append(_canvas);\r\n            $(_canvas).append(_views.map(v => v.frame));\r\n            _views[0].resize(true);\r\n            _views[0].show();\r\n            _activeView = _views[0];\r\n            _isReady = true;\r\n        };\r\n    const _returnInstance = {\r\n        show: function () {          \r\n            if (!_isReady)\r\n            {\r\n                _create.call(this);\r\n            }\r\n            else{       \r\n                _activeView && _activeView.show();\r\n            }\r\n        }\r\n    }\r\n    return _returnInstance;\r\n    /*\r\n    let _leftMenuBlock,\r\n        _canvas = _div(null),\r\n        _activeView,\r\n        _views = viewFactory.create(),\r\n        // _aisSearchView,\r\n        // _myFleetMembersView,\r\n        // _historyView,\r\n        //_gifLoader = '<img src=\"img/progress.gif\">',\r\n        _isReady = false,\r\n        _createTabs = function () {\r\n            let tabsTemplate = '<table class=\"ais_tabs\" border=0><tr>' +\r\n                '<td class=\"ais_tab dbsearch_tab unselectable\" unselectable=\"on\">' +\r\n                '<div>{{i \"AISSearch2.DbSearchTab\"}}</div>' +\r\n                '</td><td class=\"ais_tab scrsearch_tab unselectable\" unselectable=\"on\">' +\r\n                '<div>{{i \"AISSearch2.ScreenSearchTab\"}}</div>' +\r\n                '</td><td class=\"ais_tab myfleet_tab unselectable\" unselectable=\"on\">' + // ACTIVE\r\n                '<div>{{i \"AISSearch2.MyFleetTab\"}}</div>' +\r\n                '</td></tr></table>'\r\n\r\n            if (NOSIDEBAR)\r\n                $(_leftMenuBlock.workCanvas).append(_canvas);\r\n            else\r\n                $(this.sidebarPane).append(_canvas);\r\n\r\n            $(_canvas).append(Handlebars.compile(tabsTemplate));\r\n            $(_canvas).append(_views.map(v => v.frame));\r\n    \r\n            let tabs = $('.ais_tab', _canvas),\r\n                _this = this;           \r\n            _views.forEach((v,i) =>{\r\n                v.tab = tabs.eq(i);\r\n                v.resize(true);\r\n            }); \r\n            tabs.on('click', function () {\r\n                if (!$(this).is('.active')) {\r\n                    let target = this;\r\n                    tabs.each(function (i, tab) {\r\n                        if (!$(tab).is('.active') && target == tab) {\r\n                            $(tab).addClass('active');\r\n                            _views[i].show();\r\n                            _activeView = _views[i];\r\n                        }\r\n                        else {\r\n                            $(tab).removeClass('active');\r\n                            _views[i].hide();\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            // Show the first tab\r\n            tabs.eq(0).removeClass('active').click();\r\n\r\n            if (NOSIDEBAR) {\r\n                _returnInstance.hide = function () {\r\n                    $(_leftMenuBlock.parentWorkCanvas).hide();\r\n                    nsGmx.leafletMap.removeLayer(highlight);\r\n                }\r\n\r\n                $(_leftMenuBlock.parentWorkCanvas)\r\n                    .attr('class', 'left_aispanel')\r\n                    .insertAfter('.layers-before');\r\n                var blockItem = _leftMenuBlock.leftPanelItem,\r\n                    blockTitle = $('.leftmenu-path', blockItem.panelCanvas);\r\n                var toggleTitle = function () {\r\n                    if (blockItem.isCollapsed())\r\n                        blockTitle.show();\r\n                    else\r\n                        blockTitle.hide();\r\n                }\r\n                $(blockItem).on('changeVisibility', toggleTitle);\r\n                toggleTitle();\r\n            }\r\n\r\n            // All has been done at first time\r\n            _isReady = true;\r\n        },\r\n\r\n    _returnInstance = {\r\n        show: function () {\r\n            let lmap = nsGmx.leafletMap;\r\n            if (NOSIDEBAR && !_leftMenuBlock)\r\n                _leftMenuBlock = new leftMenu();\r\n\r\n            if ((NOSIDEBAR && (!_leftMenuBlock.createWorkCanvas(\"aispanel\",\r\n                function () { lmap.gmxControlIconManager.get(this.menuId)._iconClick() },\r\n                { path: [_gtxt('AISSearch2.caption')] })\r\n            )) || (!_isReady)) // SIDEBAR\r\n            {\r\n                _createTabs.call(this);\r\n            }\r\n            else{\r\n                if (NOSIDEBAR){\r\n                    $(_leftMenuBlock.parentWorkCanvas)\r\n                    .insertAfter('.layers-before');\r\n                }            \r\n                _activeView && _activeView.show();\r\n            }\r\n        }\r\n    };\r\n    return _returnInstance;\r\n    */\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/PluginPanel.js","/*\r\nconst ScreenSearchView = require('./Views/ScreenSearchView'),\r\n    ScreenSearchModel = require('./Models/ScreenSearchModel'),\r\n    MyFleetView = require('./Views/MyFleetView'),\r\n    MyFleetModel = require('./Models/MyFleetModel'),\r\n    DbSearchView = require('./Views/DbSearchView'),\r\n    DbSearchModel = require('./Models/DbSearchModel'),\r\n    InfoDialogView = require('./Views/InfoDialogView'),\r\n    Toolbox = require('./Toolbox.js');\r\n*/\r\nconst MyCollectionView = require('./Views/MyCollectionView'),\r\n      MyCollectionModel = require('./Models/MyCollectionModel'),\r\n      RegisterDlgView = require('./Views/RegisterDlgView'),\r\n      RegisterModel = require('./Models/RegisterModel'),\r\n      Searcher = require('./Search/Searcher');\r\nmodule.exports = function (options) {   \r\n    const _searcher = new Searcher(options),\r\n          _rm = new RegisterModel(_searcher),\r\n          _rdv = new RegisterDlgView({model:_rm/*, highlight:options.highlight, tools:_tools*/}),\r\n          _mcm = new MyCollectionModel(_searcher),\r\n          _mcv = new MyCollectionView({model:_mcm/*, highlight:options.highlight, tools:_tools*/, registerDlg: _rdv}); \r\n    return {\r\n        create: function () {\r\n            return [_mcv];\r\n        }\r\n    }\r\n    /*\r\n    const _tools = new Toolbox(options),\r\n        //_layersByID = nsGmx.gmxMap.layersByID,\r\n        _searcher = new Searcher(options),\r\n        _mfm = new MyFleetModel(_searcher),\r\n        _ssm = new ScreenSearchModel({ aisLayerSearcher: _searcher, myFleetModel: _mfm }),\r\n        _dbsm = new DbSearchModel(_searcher),\r\n        _dbsv = new DbSearchView({model:_dbsm, highlight:options.highlight, tools:_tools}),\r\n        _ssv = new ScreenSearchView(_ssm),\r\n        _mfv = new MyFleetView(_mfm, _tools),\r\n        _idv = new InfoDialogView({\r\n            tools:_tools,\r\n            aisLayerSearcher: _searcher, \r\n            modulePath: options.modulePath,\r\n            aisView: _dbsv, \r\n            myFleetMembersView: _mfv\r\n        });\r\n        _ssv.infoDialogView = _idv;\r\n        _mfv.infoDialogView = _idv;\r\n        _dbsv.infoDialogView = _idv;\r\n    return {\r\n        get infoDialogView(){\r\n            return _idv;\r\n        },\r\n        create: function () {\r\n            return [ _dbsv, _ssv, _mfv ];\r\n        }\r\n    };\r\n    */\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ViewsFactory.js","require(\"./MyCollection.css\")\r\nconst BaseView = require('./BaseView.js');\r\nconst SearchControl = require('../Search/SearchControl.js');\r\n\r\n//let _searchString = \"\";\r\n\r\nconst MyCollectionView = function ({ model, registerDlg }) {\r\n        BaseView.call(this, model);\r\n        this.frame = $(Handlebars.compile('<div class=\"lloyds_view search_view\">' +\r\n            '<table border=0 class=\"instruments\">' +\r\n            '<tr><td class=\"search_input_container\"></td></tr>' +\r\n            '</table>' +   \r\n            '<table class=\"results\">'+\r\n            '<td class=\"count\"></td>' +\r\n            '<td><div class=\"refresh clicable\"><div>' + this.gifLoader + '</div></div></td></tr>' +\r\n            '</table>'+    \r\n            // '<table class=\"start_screen\"><tr><td>' +\r\n            // '<img src=\"plugins/AIS/AISSearch/svg/steer-weel.svg\">' +\r\n            // '<div>Здесь будут отображаться<br>результаты поиска по названию,<br>' +\r\n            // 'IMO илм MMSI судна' +\r\n            // '</div></td></tr></table>' +\r\n            '<div class=\"ais_vessels\">'+\r\n            '<div class=\"ais_vessel\">' +\r\n            '<table><tr><div class=\"position\">vessel name</div><div>mmsi:  imo: </div></tr></table>' +\r\n            '</div>' +\r\n            '</div>' +\r\n            '<table class=\"menu\">'+\r\n            '<td class=\"open clicable\"><div>{{i \"Lloyds.showRegister\"}}</div></td>' +\r\n            '<td class=\"clean clicable\"><div>{{i \"Lloyds.cleanList\"}}</div></td></tr>' +\r\n            '</table></div>'\r\n        )());\r\n\r\n        this.container = this.frame.find('.ais_vessels');\r\n        //this.startScreen = this.frame.find('.start_screen');\r\n        this.searchInput = new SearchControl({tab:this.frame[0], container:this.frame.find('.search_input_container')[0],\r\n            callback:(v=>{\r\n                        if (!this.vessel || this.vessel.mmsi != v.mmsi || !this.frame.find('.ais_positions_date')[0]) {\r\n                            //LOAD INTO LOCAL REGISTRY\r\n                            if (this.model.data.vessels.every(x=>x.rs!=v.rs)){\r\n                                this.model.data.vessels.push(v);\r\n                                this.model.save();\r\n                                this.show();\r\n                            }\r\n                        }\r\n            }).bind(this)\r\n        });\r\n        this.tableTemplate = '{{#each vessels}}' +\r\n            '<div class=\"ais_vessel\">' +\r\n            '<table border=0><tr>' +\r\n            '<td><div class=\"position\">{{vessel_name}}</div><div>mmsi: {{mmsi}} imo: {{imo}}</div></td>' +\r\n            '<td><div class=\"exclude button\" title=\"{{i \"Lloyds.vesselExclude\"}}\"></div></td>' +\r\n            '</tr></table>' +\r\n            '</div>' +\r\n            '{{/each}}' +\r\n            '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}';\r\n    \r\n        this.frame.find('.menu .open').on('click', ()=>{\r\n            registerDlg.collection = this.model.data.vessels.map(v=>v.rs);\r\n            registerDlg.show();\r\n        })\r\n        this.frame.find('.menu .clean').on('click', (()=>{\r\n            this.model.data.vessels.length = 0;\r\n            this.model.save();\r\n            this.show();\r\n        }).bind(this));        \r\n    },\r\n    _clean = function () {\r\n        //this.startScreen.css({ visibility: \"hidden\" });\r\n        let count = this.model.data && this.model.data.vessels ? this.model.data.vessels.length : 0;\r\n        this.frame.find('.count').text(_gtxt('Lloyds.found') + count);\r\n    };\r\n\r\nMyCollectionView.prototype = Object.create(BaseView.prototype);\r\n\r\nMyCollectionView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh div');\r\n    if (state)\r\n        progress.show();\r\n    else\r\n        progress.hide();\r\n};\r\n\r\nMyCollectionView.prototype.resize = function () { \r\n    let h = $('.iconSidebarControl-pane').height() - this.frame.find('.instruments').outerHeight()\r\n    - this.frame.find('.results').outerHeight() - this.frame.find('.menu').outerHeight();\r\n    this.container.height(h+1);\r\n};\r\n\r\nMyCollectionView.prototype.repaint = function () { \r\n    _clean.call(this);\r\n    BaseView.prototype.repaint.call(this); \r\n    this.frame.find('.exclude').each(((i, elm)=>{\r\n        let inst = this;\r\n        $(elm).on('click', ()=>{\r\n            $(elm).off('click');\r\n            //UPDATE LOCAL REGISTRY\r\n            inst.model.data.vessels.splice(i, 1);\r\n            inst.model.save();\r\n            inst.show();\r\n        })\r\n    }).bind(this));  \r\n};\r\n\r\nMyCollectionView.prototype.show = function () {\r\n    this.frame.show();\r\n    this.searchInput.focus();\r\n    BaseView.prototype.show.apply(this, arguments);\r\n};\r\n\r\nmodule.exports = MyCollectionView;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Views/MyCollectionView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/MyCollection.css\n// module id = 8\n// module chunks = 0","let NOSIDEBAR = false,\r\n    PRODUCTION = false,\r\n    SIDEBAR2 = false;\r\nif (has('NOSIDEBAR'))\r\n    NOSIDEBAR = true;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\n\r\nlet _calcHeight = function () {\r\n    let template = this.frame.find('.ais_vessel')[0] || this.frame.find('.ais_positions_date')[0],\r\n        h = template.getBoundingClientRect().height\r\n    if (NOSIDEBAR)\r\n        return h * 5;\r\n    else {\r\n        let H = $('.iconSidebarControl-pane').height() - this.topOffset;\r\n// console.log(template.getBoundingClientRect())\r\n// console.log(this.topOffset)\r\n// console.log(H)\r\n        return (H - H%h);\r\n    }\r\n};\r\n\r\nconst BaseView = function (model) {\r\n    model.view = this;\r\n    this.model = model;\r\n    this.gifLoader = '<img src=\"img/progress.gif\">';\r\n};\r\n\r\nlet _clean = function(){ \r\n    this.container.find('.info').off('click');\r\n    this.container.find('.position', ).off('click');   \r\n    let scrollCont = this.container.find('.mCSB_container')\r\n    if (scrollCont[0]){\r\n        scrollCont.empty();\r\n    }\r\n    else{\r\n        this.container.empty();\r\n    }\r\n};\r\n\r\nBaseView.prototype = function () {\r\n    return {\r\n        get isActive(){\r\n            return this.frame.is(\":visible\");\r\n        },\r\n        resize: function (clean) {\r\n            let h = _calcHeight.call(this);\r\n            if (this.startScreen){\r\n                this.startScreen.height(h);\r\n                this.container.css({ position:\"relative\", top: -h+\"px\" });\r\n            }\r\n            this.container.height(h);\r\n\r\n            if (clean){\r\n                this.container.empty()\r\n            }\r\n        },\r\n        repaint: function(){\r\n            _clean.call(this);            \r\n//console.log(this.model.data)\r\n            if (!this.model.data)\r\n                return;\r\n            let scrollCont = this.container.find('.mCSB_container'),\r\n            content = $(Handlebars.compile(this.tableTemplate)(this.model.data));          \r\n//console.log(scrollCont[0])\r\n            if (!scrollCont[0]) {\r\n                this.container.append(content).mCustomScrollbar(this.mcsbOptions);\r\n            }\r\n            else {\r\n                $(scrollCont).append(content);\r\n            }\r\n\r\n            var _this = this;\r\n            this.container.find('.info', ).on('click', function (e) {\r\n                let target = $(this),\r\n                    vessel = JSON.parse(target.attr('vessel'))\r\n//console.log(vessel)\r\n                _this.infoDialogView && _this.infoDialogView.show(vessel, (v) => {\r\n//console.log(v)\r\n                    vessel.xmin = vessel.xmax = v.longitude\r\n                    vessel.ymin = vessel.ymax = v.latitude\r\n                    if (vessel.hasOwnProperty('ts_pos_utc')) {\r\n                         vessel.ts_pos_utc = v.ts_pos_utc;\r\n                         vessel.ts_pos_org = v.ts_pos_org;\r\n                         v.dt_pos_utc && $(this).closest('tr').find('.date').html(v.dt_pos_utc);\r\n                    }\r\n                    target.attr('vessel', JSON.stringify(vessel))\r\n                });\r\n                e.stopPropagation();\r\n            });\r\n//             this.container.find('.ais_vessel').on('click', function () {\r\n// //console.log(JSON.parse($(this).find('.info').attr('vessel')))\r\n//                 let v = JSON.parse($(this).find('.info').attr('vessel'));                \r\n//                 v.lastPosition = true;\r\n//                 _this.infoDialogView.showPosition(v);\r\n//             });      \r\n        },\r\n        show: function () {\r\n            this.frame.show();\r\n            this.model.update();\r\n        },\r\n        hide: function () {\r\n            this.frame.hide();\r\n        }\r\n    }\r\n}();\r\n\r\nmodule.exports = BaseView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/BaseView.js","require(\"./SearchControl.css\")\r\n\r\nlet _searchString = \"\",\r\n_sparams = localStorage.getItem('lloyds_searchparams');\r\nconst SearchControl = function ({ tab, container, callback }) {\r\n\r\n    container.innerHTML = '<div class=\"filter\"><input type=\"text\" placeholder=\"' + _gtxt(\"Lloyds.search_placeholder\") + '\"/>' +\r\n        '<div class=\"preferences\"></div>' +\r\n        '<div class=\"searchremove\"><img class=\"search\" src=\"plugins/AIS/AISSearch/svg/search.svg\">' +\r\n        '<img class=\"remove clicable\" src=\"plugins/AIS/AISSearch/svg/remove.svg\"></div>' +\r\n        '</div>';\r\n    let suggestions = tab.appendChild(document.createElement('div')),\r\n        preferences = tab.appendChild(document.createElement('div'))\r\n    suggestions.classList.add(\"suggestions\");\r\n    preferences.classList.add(\"preferences\");\r\n    suggestions.innerHTML = '<div class=\"suggestion\">SOME VESSEL<br><span>mmsi:0, imo:0</span></div>';\r\n    preferences.innerHTML = '<div class=\"section\">Поиск по:</div>' +\r\n    '<div class=\"line\"><div class=\"checkbox imo disabled\"></div><div class=\"label\">IMO<label></div></div>' + \r\n    '<div class=\"line\"><div class=\"checkbox mmsi\"></div><div class=\"label\">MMSI<label></div></div>' + \r\n    '<div class=\"line\"><div class=\"checkbox name disabled\"></div><div class=\"label\">названию</div></div>' + \r\n    '<div class=\"line\"><div class=\"checkbox callsign\"></div><div class=\"label\">позывному<label></div></div>' + \r\n    '<div class=\"line\"><div class=\"checkbox owner\"></div><div class=\"label\">собственнику<label></div></div>';\r\n    !_sparams && (_sparams = 'imo name'); \r\n    if (_sparams.search(/imo/)<0)\r\n        _sparams += ' imo'; \r\n    if (_sparams.search(/name/)<0)\r\n        _sparams += ' name';\r\n    let asparams =_sparams.split(' ');\r\nconsole.log(asparams)\r\n    asparams.forEach((p,i)=>{ preferences.querySelector('.'+p).classList.add('checked') })\r\n\r\n    this.frame = { find: (q) => { return container.querySelector(q) } }\r\n    this.searchInput = this.frame.find('.filter input');\r\n\r\n    let searchBut = this.frame.find('.filter .search'),\r\n        prefeBut = this.frame.find('.filter .preferences'),\r\n        removeBut = this.frame.find('.filter .remove'),\r\n        delay,\r\n        //suggestions = this.frame.find('.suggestions'),\r\n        suggestionsCount = 5,\r\n        suggestionsFrame = { first: 0, current: 0, last: suggestionsCount - 1 },\r\n        found = { values: [] },\r\n        searchDone = function () {\r\n            if (found.values.length > 0) {\r\n                _searchString = found.values[suggestionsFrame.current].vessel_name;\r\n                this.searchInput.value = (_searchString);\r\n                callback(found.values[suggestionsFrame.current]);\r\n            }\r\n            // else {\r\n            //     _clean.call(this);\r\n            // }\r\n        },\r\n        doSearch = function (actualId) {\r\n            let queries = [];\r\n            _sparams.split(' ').forEach(sp=>{       \r\n                queries.push(fetch(\"//kosmosnimki.ru/demo/lloyds/api/v1/Ship/Search/\" + sp + \"/\" + _searchString));\r\n            });\r\n            Promise.all(queries)\r\n            .then(a=>{\r\n//console.log(a)\r\n                return Promise.all(a.map(r=>{\r\n                    if (r.status != 200){\r\n                        console.log(r)                       \r\n                        return [];\r\n                    }\r\n                    else\r\n                        return r.json()\r\n                }))\r\n            })\r\n            .then(a=>{\r\n//console.log(actualId+\" \"+delay)\r\n//console.log(a)\r\n                if (actualId==delay){\r\n                    found = {values:[]};\r\n                    a.forEach(r=>{\r\n                        found.values = found.values.concat(\r\n                            r.map(v=>{\r\n                            return { vessel_name: v.Name, mmsi: v.MMSI, imo: v.IMO, vessel_type: v.Type, rs: v.RS, owner: v.RegisteredOwner, callsign: v.Callsign }\r\n                            })\r\n                        )\r\n                    });\r\n//console.log(found.values)\r\n                }\r\n                else \r\n                    return Promise.reject(\"stop\")                    \r\n            })\r\n            .then(function () { // SUCCEEDED\r\n//console.log(_searchString)\r\n                if (found.values.length == 0 || _searchString == \"\") {\r\n                    suggestions.style.display = 'none';\r\n                    return;\r\n                }\r\n\r\n                let scrollCont = suggestions.querySelector('.mCSB_container'),\r\n                    content = Handlebars.compile(\r\n                        '{{#each values}}<div class=\"suggestion\" id=\"{{@index}}\">{{vessel_name}}<br><span>mmsi:{{mmsi}}, imo:{{imo}}, {{callsign}}</span><br><span>{{owner}}</span></div>{{/each}}'\r\n                    )(found);\r\n                if (!scrollCont) {\r\n                    suggestions.innerHTML = (content);\r\n                    $(suggestions).mCustomScrollbar();\r\n                }\r\n                else\r\n                    scrollCont.innerHTML = (content);\r\n\r\n                let suggestion = suggestions.querySelectorAll('.suggestion');\r\n                if (suggestions.style.display != 'block') {\r\n                    let cr = this.frame.find('.filter').getBoundingClientRect();\r\n                    suggestions.style.display = 'block';\r\n                    suggestions.style.position = 'fixed';\r\n                    suggestions.style.left = cr.left + \"px\"; suggestions.style.top = (cr.bottom - 3) + \"px\";\r\n                    suggestions.style.width = (Math.round(cr.width) - 2) + \"px\";\r\n                    // $(suggestions).offset({ left: cr.left, top: cr.bottom - 3 });\r\n                    // $(suggestions).outerWidth(cr.width)\r\n                }\r\n\r\n                suggestions.style.height = suggestion[0].getBoundingClientRect().height *\r\n                    (found.values.length > suggestionsCount ? suggestionsCount : found.values.length) + \"px\";\r\n\r\n                suggestionsFrame = { first: 0, current: 0, last: suggestionsCount - 1 };\r\n                suggestion[suggestionsFrame.current].classList.add('selected');\r\n                suggestion.forEach(((el, i) =>\r\n                    el.onclick = (e => {\r\n                        suggestionsFrame.current = e.currentTarget.id;\r\n                        suggestions.style.display = 'none';\r\n                        searchDone.call(this);\r\n                    }).bind(this)\r\n                ).bind(this));\r\n            }.bind(this),\r\n            function (response) { // FAILED\r\n                if (response!=\"stop\")\r\n                    console.log(response);\r\n            });\r\n        };\r\n\r\n    tab.addEventListener('click', function(e){\r\n        preferences.style.display = 'none'\r\n    })  \r\n    prefeBut.onclick = function(e){\r\n        if (preferences.style.display != 'block') {\r\n            let cr = this.frame.find('.filter').getBoundingClientRect();\r\n            preferences.style.display = 'block';\r\n            preferences.style.position = 'fixed';\r\n            preferences.style.left = (cr.left + (cr.width-preferences.offsetWidth)/2) + \"px\"; \r\n            preferences.style.top = (cr.bottom + 10) + \"px\";\r\n            e.stopPropagation()\r\n        }\r\n    }.bind(this)\r\n\r\n    preferences.querySelectorAll('.line').forEach(el=>el.onclick = e=>{\r\n        let ch = el.querySelector('.checkbox');\r\n        if (!ch.classList.contains('disabled')) {\r\n            let sparam = ch.classList.value.replace(/ *(checked|checkbox) */g, '');\r\n            if (ch.classList.contains('checked')) {\r\n                ch.classList.remove('checked');\r\n                _sparams = _sparams.replace(new RegExp(sparam), '').replace(/ {2,}/g, ' ');\r\n            }\r\n            else {\r\n                ch.classList.add('checked');\r\n                _sparams = _sparams + ' ' + sparam;\r\n            }\r\n            _sparams = _sparams.replace(/^\\s+|\\s+$/g, '')\r\n            localStorage.setItem('lloyds_searchparams', _sparams);            \r\nconsole.log(_sparams)\r\n        }\r\n        e.stopPropagation()\r\n    })\r\n    \r\n    removeBut.onclick = (function (e) {\r\n        _searchString = '';\r\n        this.searchInput.value = ('');\r\n        this.searchInput.focus();\r\n        clearTimeout(delay)\r\n        removeBut.style.display = 'none';\r\n        searchBut.style.display = 'block';\r\n        suggestions.style.display = 'none';\r\n        //_clean.call(this);\r\n    }.bind(this));\r\n\r\n    this.searchInput.onkeydown = (function (e) {\r\n        let suggestion = suggestions.querySelector('.suggestion.selected');\r\n        if (suggestions.style.display == 'block') {\r\n            if (e.keyCode == 38) {\r\n                if (suggestionsFrame.current > 0) {\r\n                    suggestionsFrame.current--;\r\n                    suggestion.classList.remove('selected')\r\n                    suggestion.previousSibling.classList.add('selected');\r\n                }\r\n            }\r\n            else if (e.keyCode == 40) {\r\n                if (suggestionsFrame.current < found.values.length - 1) {\r\n                    suggestionsFrame.current++;\r\n                    suggestion.classList.remove('selected')\r\n                    suggestion.nextSibling.classList.add('selected');\r\n                }\r\n            }\r\n            if (suggestionsFrame.last < suggestionsFrame.current) {\r\n                suggestionsFrame.last = suggestionsFrame.current;\r\n                suggestionsFrame.first = suggestionsFrame.last - (suggestionsCount - 1);\r\n            }\r\n            if (suggestionsFrame.first > suggestionsFrame.current) {\r\n                suggestionsFrame.first = suggestionsFrame.current;\r\n                suggestionsFrame.last = suggestionsFrame.first + (suggestionsCount - 1);\r\n            }\r\n\r\n            $(suggestions).mCustomScrollbar(\"scrollTo\", \"#\" + suggestionsFrame.first, { scrollInertia: 0 });\r\n        }\r\n    });\r\n\r\n    let prepareSearchInput = function (temp, keyCode) {\r\n        removeBut.style.display = 'block';\r\n        searchBut.style.display = 'none';\r\n//console.log(\"delay clear\"+delay)\r\n//console.log(_searchString + \"==\"+ temp)\r\n        if (_searchString == temp && (!keyCode || keyCode != 13))\r\n            return false;\r\n\r\n        clearTimeout(delay);\r\n\r\n        _searchString = temp;\r\n        if (_searchString == \"\") {\r\n            removeBut.click();\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    this.searchInput.onkeyup = (function (e) {\r\n        let temp = (this.searchInput.value || \"\")\r\n            .replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n        if (!prepareSearchInput(temp, e.keyCode))\r\n            return;\r\n        if (e.keyCode == 13) {\r\n            suggestions.style.display = 'none';\r\n            searchDone.call(this);\r\n        }\r\n        else{\r\n            delay = setTimeout((() => {\r\n                doSearch.apply(this, [delay])\r\n            }).bind(this), 200);\r\n        }\r\n    }.bind(this));\r\n\r\n\r\n    this.searchInput.onpaste = function (e) {\r\n        let temp = ((e.originalEvent || window.clipboardData || e).clipboardData.getData('text') || \"\")\r\n            .replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n        if (!prepareSearchInput(temp))\r\n            return;\r\n        delay = setTimeout((() => {\r\n            doSearch.call(this, [delay])\r\n        }).bind(this), 200);\r\n    }.bind(this);\r\n\r\n}\r\n\r\nSearchControl.prototype.focus = function () {\r\n    this.searchInput.focus();\r\n}\r\n\r\nmodule.exports = SearchControl;\n\n\n// WEBPACK FOOTER //\n// ./src/Search/SearchControl.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Search/SearchControl.css\n// module id = 11\n// module chunks = 0","const Polyfill = require('../Polyfill');\r\nmodule.exports = function (searcher) {\r\n    let _actualUpdate,\r\n        _data = JSON.parse(localStorage.getItem(\"lloyds_collection\"));\r\n    if (!_data)\r\n        _data = { vessels: [] }; \r\n        // {\r\n        //     vessels: [\r\n        //         { vessel_name: 'ACACIA', mmsi: 371044000, imo: 9476599 },\r\n        //         { vessel_name: 'AKADEMIK FERSMAN', mmsi: 273455310, imo: 8313958 },\r\n        //         { vessel_name: 'BALTIMORE BRIDGE', mmsi: 371111000, imo: 9463281 }\r\n        //     ]};\r\n    return {\r\n        searcher: searcher,\r\n        isDirty: true,\r\n        get data() { return _data },\r\n        set data(value) { _data = value; },\r\n        save: function(){\r\n            localStorage.setItem(\"lloyds_collection\", JSON.stringify(_data));\r\n        },\r\n        update: function () {\r\n                this.view.repaint();\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Models/MyCollectionModel.js","module.exports = { \r\n\tfind: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn value;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn undefined;\r\n\t},\r\n\tfindIndex: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn i;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Polyfill.js","require(\"./RegisterDialog.css\")\r\nconst BaseView = require('./BaseView.js');\r\n\r\nconst RegisterDlgView = function ({ model }) {\r\n    BaseView.call(this, model);\r\n\r\n    Object.defineProperty(this, \"collection\", {\r\n        set: (value=>{\r\n//console.log(value)\r\n//console.log(this.model.data.vessels)\r\n        this.model.data.vessels = this.model.data.vessels.filter(v=>value.indexOf(v.RS)!==-1)\r\n//console.log(this.model.data.vessels)\r\n        let new_tasks = value.filter(v=>!this.model.data.vessels || !this.model.data.vessels.some(cv=>cv.RS==v));\r\n//console.log(new_tasks)\r\n        if (new_tasks.length>0){\r\n            this.model.tasks = new_tasks\r\n            .map(id=>fetch(\"//kosmosnimki.ru/demo/lloyds/api/v1/Ship/Get/\"+id))\r\n            this.model.isDirty = true;\r\n        }\r\n//console.log(this.model.isDirty)\r\n    }).bind(this)});\r\n\r\n    this.frame = $(Handlebars.compile('<div class=\"lloyds_register_dlg_view\">' +\r\n    '<div><table class=\"instruments unselectable\" border=0><tr><td>' + \r\n    '<div class=\"fieldstree_selector\"><span>{{i \"Lloyds.fieldsSelector\"}}</span></div><div class=\"rollout\"></div>' +\r\n    '<div class=\"fieldstree_display\" style=\"display:none\">' +\r\n    '<div class=\"select\"><div class=\"fieldstree_selector\"><span>{{i \"Lloyds.fieldsSelector\"}}</span></div><div class=\"rollout up\">&nbsp;</div></div>' +\r\n    '<hr>' + \r\n    '<div class=\"fieldstree_panel\"></div>' +\r\n    '</div>' +    \r\n    '</td><td><div class=\"refresh\" style=\"display:none\">' + this.gifLoader + '</div></td></tr></table></div>' +\r\n    '<div class=\"vessels_columns unselectable\"><table><tr>' + \r\n    '<td class=\"column\">&nbsp;</td>' + \r\n    '</tr></table></div><div class=\"vessels\"></div><div class=\"export button\">Экспорт</div><iframe class=\"export download\" style=\"display:none\"></iframe>' +\r\n    '</div>')())\r\n    this.container = this.frame.find('.vessels');\r\n    let frame = this.frame;\r\n    this.mcsbOptions = {\r\n        axis: \"yx\",\r\n        callbacks: {\r\n            whileScrolling: function () {\r\n                if (this.mcs.direction==\"x\")\r\n                    frame.find('.vessels_columns table').css({position:\"relative\", left:this.mcs.left+\"px\"})\r\n            },\r\n            onScrollStart: function(){ \r\n                if(!frame.find('.fieldstree_display').is(':hover'))\r\n                    frame.find('.rollout.up:visible').mousedown() \r\n            }\r\n        }\r\n    };\r\n\r\n    // FIELDSSELECTOR\r\n    this.model.loadMeta().then((() => {\r\n        let feeldsTree = '<ul>';\r\n        for (let i = 0; i < this.model.data.columns.length; ++i) {\r\n            feeldsTree += '<li class=\"section\"><div class=\"lloyds_dialog_button branch_expand\" style=\"display:none\"/><div class=\"lloyds_dialog_button branch_shrink\"/>'+\r\n            '<input type=\"checkbox\" value=\"' + i + '\" '+(this.model.data.columns[i].checked?'checked':'')+'><label>' + this.model.data.columns[i].caption  + '</label>'\r\n            feeldsTree += '<ul>';\r\n            for (let j = 0; this.model.data.columns[i].nodes && j < this.model.data.columns[i].nodes.length; ++j) {\r\n                feeldsTree += '<li><div class=\"lloyds_dialog_button branch_expand\"/><div class=\"lloyds_dialog_button branch_shrink\" style=\"display:none\"/><input type=\"checkbox\" value=\"' + i+'.'+j + '\" '+\r\n                (this.model.data.columns[i].nodes[j].checked?'checked':'')+'><label>' + this.model.data.columns[i].nodes[j].caption + '</label>'\r\n                feeldsTree += '<ul style=\"display:none\">';\r\n                for (let k = 0; this.model.data.columns[i].nodes[j].nodes && k < this.model.data.columns[i].nodes[j].nodes.length; ++k) {\r\n                    if (this.model.data.columns[i].nodes[j].nodes[k]){\r\n                        if (this.model.data.columns[i].nodes[j].nodes[k].name==\"LRIMOShipNo\" ||\r\n                         this.model.data.columns[i].nodes[j].nodes[k].name==\"ShipName\"){\r\n                            this.model.data.columns[i].nodes[j].nodes[k].checked = true;\r\n                            this.model.data.columns[i].nodes[j].nodes[k].disabled = true;\r\n                         }\r\n\r\n                        feeldsTree += '<li><input type=\"checkbox\" value=\"' + i+'.'+j+'.'+k + '\" '+\r\n                        (this.model.data.columns[i].nodes[j].nodes[k].checked ? 'checked ':'')+\r\n                        (this.model.data.columns[i].nodes[j].nodes[k].disabled ? 'disabled=\"disabled\"':'')+                        \r\n                        '><label>' + this.model.data.columns[i].nodes[j].nodes[k].caption + ' <span>(' + this.model.data.columns[i].nodes[j].nodes[k].trans + ')</span>' + '</label></li>'\r\n                    }\r\n                }\r\n                feeldsTree += '</ul>';\r\n                feeldsTree += \"</li>\";\r\n            }\r\n            feeldsTree += '</ul>';\r\n            feeldsTree += \"</li>\";\r\n        }\r\n        feeldsTree += \"</ul>\";\r\n        this.feeldsTree = $(feeldsTree);\r\n    }).bind(this))\r\n}\r\n\r\nRegisterDlgView.prototype = Object.create(BaseView.prototype);\r\n\r\nconst _export = function(ev){\r\n    let form = new FormData(),\r\n    columns = [];\r\n    //this.frame.find('input.export:checked').each((i,v)=>v.classList[2] && _vesselsToExport.push(v.classList[2]))\r\n    if (!_vesselsToExport.length){\r\n        console.log('Nothing to export');\r\n        return;\r\n    }\r\n    this.frame.find('.column').each((i,c)=>c.classList[1] && columns.push(c.classList[1]))\r\n    form.append('vessels', _vesselsToExport) \r\n    form.append('columns', columns) \r\n    this.inProgress(true);\r\n    fetch(window.serverBase + \"plugins/ais/lloydsexport.ashx\",\r\n    {\r\n        method: \"POST\",\r\n        mode: 'cors',\r\n        body: form,\r\n        credentials: 'include'\r\n    })\r\n    .then(function(res){ return res.text(); })\r\n    .then(function(data){ \r\n        this.inProgress(false);\r\n        if (data.search(/ERROR:/)!=-1){\r\n            return Promise.reject(data)\r\n        }\r\n        this.frame.find(\".export.download\")[0].src = window.serverBase + \"plugins/ais/lloydsexport.ashx?id=\" + data\r\n    }.bind(this))\r\n    .catch((function(data){\r\n        this.inProgress(false);\r\n        console.log( data ) \r\n    }).bind(this))\r\n},\r\n_clean = function () {\r\n        this.container.empty();\r\n        this.container.attr(\"class\", \"vessels\")\r\n    },\r\n    _showFieldsTree = (e, panel) => {\r\n        if (!panel.is(':visible')) {\r\n            panel.show()\r\n            panel.offset(panel.siblings('.fieldstree_selector').offset())\r\n        }\r\n        else\r\n            panel.hide()\r\n        e.stopPropagation();\r\n    },\r\n    _showFieldsTreeBranch = (e, lbl)=>{\r\n        let b = $(e.currentTarget)\r\n        .hide()\r\n        .siblings(lbl).show();\r\n        if (lbl == '.branch_shrink')\r\n            b.siblings('ul').show();\r\n        else\r\n            b.siblings('ul').hide();\r\n        e.stopPropagation();\r\n    }\r\n    \r\nlet _dialog,\r\n    _dialogRect = JSON.parse(localStorage.getItem(\"lloyds_rect\")),\r\n    _dialogW = _dialogRect?_dialogRect.w:710, _dialogH = _dialogRect?_dialogRect.h:450,\r\n    _containerH = _dialogH - 215,\r\n    _vesselsToExport = []// _dialogRect?_dialogRect.ch:280;\r\n\r\nRegisterDlgView.prototype.show = function () {\r\n    if (!_dialog){\r\n        _clean.call(this);\r\n        BaseView.prototype.show.apply(this, arguments);\r\n        this.resize({dx:0, dy:0});\r\n\r\n        let canvas = this.frame,\r\n            screen = $('#all')[0],\r\n            sw = parseFloat(window.getComputedStyle(screen).width),\r\n            sh = parseFloat(window.getComputedStyle(screen).height),\r\n            posX = (sw - _dialogW) / 2.0,\r\n            posY = (sh - _dialogH) / 2.0,\r\n            isMaximized = false,\r\n            columns = this.model.data.columns,\r\n            columns_ts = this.model.data.columnsTs;\r\n\r\n        _dialog = showDialog(\"register\", canvas[0], {\r\n            /*width: _dialogW, height: _dialogH,*/ \r\n            posX: posX, posY: posY,\r\n            closeFunc: (() => { \r\n                _dialog = null; \r\n                localStorage.setItem(\"lloyds_columns\", JSON.stringify({timestamp: columns_ts, nodes:columns}));\r\n                localStorage.setItem(\"lloyds_rect\", JSON.stringify({w:_dialogW, h:_dialogH, ch:_containerH}));\r\n                this.frame.find('.export.download')[0].src = \"\";\r\n            }).bind(this)            \r\n        });\r\n        $(_dialog).dialog({\r\n            resizable: true, resize: ((event, ui) => {\r\n                this.resize({ dy: ui.size.height - _dialogH });\r\n                _dialogW = ui.size.width;\r\n                _dialogH = ui.size.height;\r\n                if (!$('.vessels .mCSB_scrollTools_horizontal').is(':visible'))                \r\n                    this.frame.find('.vessels_columns table').css({position:\"relative\", left:0})\r\n            }).bind(this),\r\n            /*width: _dialogW, height: _dialogH*/\r\n        });\r\n        $(_dialog).parent().css({'min-width': '600px', 'width': _dialogW, 'height': _dialogH})\r\n        $(_dialog).parent().find('.ui-dialog-content').css('min-width', '600px');\r\n        isMaximized = false;\r\n\r\n        // TITLEBAR\t\r\n        canvas.parent('div').css({ 'margin': '0', 'overflow': 'hidden' })\r\n        let titlebar = $(_dialog).parent().find('.ui-dialog-titlebar').css('padding', '0')\r\n            .html('<table class=\"lloyds_dialog_titlebar\"><tr>' +\r\n            '<td><div class=\"choose\">' + _gtxt(\"Lloyds.dlgTitle\") +\r\n            '</div></td>' +\r\n            '<td class=\"window_button\" id=\"expandbut\" title=\"' + _gtxt(\"Lloyds.expandButton\") + '\"><div class=\"lloyds_dialog_button expand\"></div></td>' +\r\n            '<td class=\"window_button\" id=\"shrink\" title=\"' + _gtxt(\"Lloyds.shrinkButton\") + '\" style=\"display:none\"><div class=\"lloyds_dialog_button shrink\"></div></td>' +\r\n            '<td class=\"window_button\" id=\"closebut\" title=\"' + _gtxt(\"Lloyds.closeButton\") + '\"><div class=\"lloyds_dialog_button close\"></div></td>' +\r\n            '</tr></table>');\r\n\r\n        $('#closebut', titlebar).on('click', (e) => { \r\n                if (isMaximized)\r\n                    this.resize({dy : _dialogH - parseFloat(window.getComputedStyle($('#all')[0]).height)});\r\n                $(_dialog).dialog(\"close\"); \r\n            }\r\n        )\r\n        $('#shrink', titlebar).on('click', (e) => {\r\n            $(e.currentTarget).hide()\r\n            $(_dialog).dialog({width:_dialogW, height:_dialogH});\r\n            titlebar.find('#expandbut').show();          \r\n            this.resize({dy : _dialogH - parseFloat(window.getComputedStyle($('#all')[0]).height)});\r\n            $(_dialog).dialog({ resizable: true });\r\n            isMaximized = false;\r\n        })\r\n        $('#expandbut', titlebar).on('click', (e) => {\r\n            $(e.currentTarget).hide()\r\n            let screen = $('#all')[0],\r\n                sw = parseFloat(window.getComputedStyle(screen).width),\r\n                sh = parseFloat(window.getComputedStyle(screen).height);\r\n            $(_dialog).dialog({width:sw, height:sh});\r\n            titlebar.find('#shrink').show();            \r\n            this.resize({dy : sh - _dialogH});\r\n            $(_dialog).dialog({ resizable: false });\r\n            isMaximized = true;\r\n        })\r\n\r\n        // EXPORT\r\n        this.frame.find('.export.button').click(_export.bind(this))    \r\n\r\n        // FIELDSSELECTOR\r\n        if (this.feeldsTree) {\r\n            $('.lloyds_register_dlg_view').parents('.ui-dialog').on(\"mousedown\", (e => {\r\n                this.frame.find('.rollout.up:visible').mousedown()\r\n            }).bind(this))\r\n           \r\n            this.frame.find('.fieldstree_panel').text('').append(this.feeldsTree).mCustomScrollbar();\r\n            this.frame.find('.fieldstree_selector').on('mousedown', (e => {\r\n                _showFieldsTree(e, this.frame.find('.fieldstree_display'));\r\n            }).bind(this));\r\n            this.frame.find('.rollout').on('mousedown', (e => {\r\n                _showFieldsTree(e, this.frame.find('.fieldstree_display'));\r\n            }).bind(this));\r\n            this.feeldsTree.find('.branch_expand').on('mousedown', e => _showFieldsTreeBranch(e, '.branch_shrink'));\r\n            this.feeldsTree.find('.branch_shrink').on('mousedown', e => _showFieldsTreeBranch(e, '.branch_expand'));\r\n            this.feeldsTree.find('input[type=\"checkbox\"]').on('mousedown', (e => {\r\n                let chb = e.currentTarget,\r\n                    id = chb.value.split(\".\"),\r\n                    node = columns[id[0]], parent;\r\n                for (let i=1; i<id.length; ++i){\r\n                    parent = node;\r\n                    node = node.nodes[id[i]];\r\n                }                \r\n                let s=[node], n; \r\n                while(s.length){\r\n                    n=s.pop(); \r\n                    if (!n.disabled)\r\n                        n.checked = !chb.checked;\r\n                    n.nodes && n.nodes.forEach(x=>s.push(x))\r\n                } \r\n                if (parent)      \r\n                    parent.checked = parent.nodes.every(x=>x.checked); \r\n//console.log(parent)\r\n//console.log(node)\r\n                if (chb.checked) {\r\n                    $(chb).parents('ul').siblings('input:not([disabled])').each((i, elm) => { elm.checked = false });\r\n                    $(chb).siblings('ul').find('input:not([disabled])').each((i, elm) => { elm.checked = false })\r\n                }\r\n                else {\r\n                    $(chb).siblings('ul').find('input').each((i, elm) => { elm.checked = true })\r\n                    let uls = $(chb).parents('ul')\r\n                    for (let i = 0; i < uls.length; ++i) {\r\n                        let inputs = uls.eq(i).find('li input'),\r\n                            checked = uls.eq(i).find('li input:checked');\r\n//console.log(inputs.length +\"==\"+ (checked.length+1))\r\n//console.log(uls.eq(i).siblings('input'))\r\n                        if (inputs.length == checked.length+1 && uls.eq(i).siblings('input')[0])\r\n                            uls.eq(i).siblings('input')[0].checked = true;\r\n                    }\r\n                }\r\n                this.repaint();\r\n                e.stopPropagation();\r\n            }).bind(this));\r\n            this.feeldsTree.find('label').on('mousedown', e => {\r\n                $(e.currentTarget).siblings('input[type=\"checkbox\"]').mousedown().click();\r\n                e.stopPropagation();\r\n            })\r\n        }\r\n    }\r\n};\r\n\r\nconst _repaintExport = function(){     \r\n    this.frame.find('.export.get:not(.all)').click((e=>{\r\n        if (!$(e.target).is(':checked')){\r\n            this.frame.find('.export.get.all')[0].checked=0;\r\n            _vesselsToExport.splice(_vesselsToExport.indexOf(e.target.classList[2]),1)\r\n        }\r\n        else{\r\n            _vesselsToExport.push(e.target.classList[2])\r\n        }\r\n    }).bind(this))\r\n    .each((i, el)=>{\r\n        el.checked = _vesselsToExport.indexOf(el.classList[2])!=-1?1:0;\r\n    })    \r\n\r\n    this.frame.find('.export.get.all').click((e=>{\r\n        _vesselsToExport.length = 0;\r\n        this.frame.find('.export.get:not(.all)').each((i,el)=>{\r\n            el.checked=$(e.target).is(':checked')?1:0;\r\n            if (el.checked)\r\n                _vesselsToExport.push(el.classList[2]);\r\n        })\r\n    }).bind(this))[0].checked = this.model.data.vessels.length==0 || this.frame.find('.export.get:not(.all):not(:checked)').length>0?0:1;\r\n}\r\n\r\nRegisterDlgView.prototype.repaint = function () {\r\n    if (!this.frame.is(\":visible\"))\r\n        return true;\r\n    if (this.model.data.columns)\r\n        this.frame.find('.vessels_columns').html(\r\n        Handlebars.compile('<table><tr><td><div class=\"column\"><input type=\"checkbox\" class=\"export get all\"><div></div></div></td>{{#each columns}}{{#each nodes}}{{#each nodes}}'+\r\n        '{{#if checked}}'+\r\n        '<td><div class=\"column {{name}}\">{{caption}}<div>{{trans}}</div></div></td>'+\r\n        '{{/if}}'+\r\n        '{{/each}}{{/each}}{{/each}}</tr></table>')\r\n        (this.model.data))\r\n\r\n    this.tableTemplate = '<table class=\"vessels_data\">{{#each vessels}}<tr>';\r\n    this.tableTemplate += '<td><div><input type=\"checkbox\" class=\"export get {{LRIMOShipNo}}\"></div></td>';\r\n    for (let i=0; i<this.model.data.columns.length; ++i)\r\n    for (let j=0; this.model.data.columns[i].nodes && j<this.model.data.columns[i].nodes.length; ++j)\r\n    for (let k=0; this.model.data.columns[i].nodes[j].nodes && k<this.model.data.columns[i].nodes[j].nodes.length; ++k)\r\n        if (this.model.data.columns[i].nodes[j].nodes[k].checked)\r\n            this.tableTemplate += '<td><div>{{'+this.model.data.columns[i].nodes[j].nodes[k].name+'}}</div></td>';\r\n    this.tableTemplate += '</tr>' +\r\n    '{{/each}}</table>{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}';\r\n\r\n    BaseView.prototype.repaint.apply(this, arguments);\r\n\r\n    _repaintExport.call(this);\r\n\r\n    let columns = this.frame.find('.vessels_columns tr:nth-of-type(1) td div:has(div)'),\r\n        cells = this.frame.find('.vessels_data tr:nth-of-type(1) td div'),\r\n        getOuterWidth = function(el){\r\n            let s = window.getComputedStyle(el),\r\n            w = parseFloat(s.width.replace(/\\D+$/, '')) // ,\r\n            // pl = parseFloat(s[\"padding-left\"].replace(/\\D+$/, '')),\r\n            // pr = parseFloat(s[\"padding-right\"].replace(/\\D+$/, '')),\r\n            // bl = parseFloat(s[\"border-left-width\"].replace(/\\D+$/, '')),\r\n            // br = parseFloat(s[\"border-right-width\"].replace(/\\D+$/, ''));\r\n//console.log(\"get \" + (w + pl + pr + bl + br) + \" = \" + w  + \" + \"+ pl + \" + \" + pr + \" + \" + bl + \" + \" + br)\r\n            return w; // + pl + pr + bl + br;\r\n        },\r\n        setOuterWidth = function(el, w1){\r\n        //     let s = window.getComputedStyle(el),\r\n        //     pl = parseFloat(s[\"padding-left\"].replace(/\\D+$/, '')),\r\n        //     pr = parseFloat(s[\"padding-right\"].replace(/\\D+$/, '')),\r\n        //     bl = parseFloat(s[\"border-left-width\"].replace(/\\D+$/, '')),\r\n        //     br = parseFloat(s[\"border-right-width\"].replace(/\\D+$/, ''));\r\n            let w = w1; // - (pl + pr + bl + br);\r\n//console.log(\"set \" + w + \" = \" + w1 + \" - \"+ pl + \" - \" + pr + \" - \" + bl + \" - \" + br)\r\n            el.style.width = w  + \"px\";\r\n        };\r\n    if (cells.length > 0) {\r\n        $('.vessels_data tr:last-child').after('<tr>'+$('.vessels_columns table tr').html()+'</tr>')\r\n        let cont_w = this.frame.find('.vessels').width()\r\n        this.frame.find('.vessels_data').width(cont_w)\r\n            .parent().width(cont_w);\r\n        columns.each((i, el) => {\r\n            let w = getOuterWidth(cells[i])\r\n            setOuterWidth(el, w)\r\n            setOuterWidth(cells[i], w)\r\n            setOuterWidth(cells.eq(i).parent()[0], w)\r\n            //console.log(cells.eq(i).outerWidth() + \" \" + getOuterWidth(cells[i])+\" \"+$(el).outerWidth())        \r\n        }) \r\n        let calc_w = getOuterWidth(this.frame.find('.vessels_data')[0]); \r\n//console.log(\"cont_w \"+cont_w + \" calc_w \"+calc_w)\r\n        if (calc_w>cont_w){\r\n            setOuterWidth(this.frame.find('.vessels_data')[0], calc_w)\r\n            setOuterWidth(this.frame.find('.vessels_data').parent()[0], calc_w)\r\n        }\r\n        $('.vessels_data tr:last-child').remove()\r\n    }\r\n};\r\n\r\nRegisterDlgView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh');\r\n    if (state)\r\n        progress.show();\r\n    else\r\n        progress.hide();\r\n};\r\n\r\nRegisterDlgView.prototype.resize = function ({dx, dy}) {\r\n    _containerH += dy;\r\n    this.container.height(_containerH);\r\n    \r\n    // let calc_w = parseFloat(getComputedStyle(this.container[0]).width),\r\n    //     columns = this.frame.find('.vessels_columns tr:nth-of-type(1) td div');\r\n    // if (calc_w>columns.length*200){\r\n    //     this.frame.find('.vessels_data').width(calc_w)\r\n    //     .parent().width(calc_w);  \r\n    // }\r\n};\r\n\r\nmodule.exports = RegisterDlgView;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Views/RegisterDlgView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/RegisterDialog.css\n// module id = 15\n// module chunks = 0","let _actualUpdate;\r\nmodule.exports = function (searcher) {\r\n    let returnInstance = {\r\n        data:{vessels:[]},\r\n        isDirty: false,\r\n        loadMeta : ()=>beforeLoad,\r\n        tasks: [],\r\n        load: function () {\r\n            let inst = this;\r\n            return beforeLoad.then(res => {\r\n                return Promise.all(inst.tasks)\r\n                .then(r=>Promise.all(r.map(z=>z.json())))\r\n                .then(r=>{\r\n                    let rr=[]\r\n                    r.forEach((v, i)=>{\r\n                        rr.push({RS:parseInt(v.RS, 10), version:v.version}) \r\n                        v.data.forEach(ds=>ds.properties.forEach(p=>{rr[i][p.name]=p.value}))\r\n                    })\r\n                    inst.data.vessels = inst.data.vessels.concat(rr);\r\n//console.log(inst.data.vessels)\r\n                }) \r\n            })\r\n        },\r\n        update: function () {\r\n            if (!this.isDirty){   \r\n                let inst = this;   \r\n                setTimeout(function wait() {\r\n                    if (inst.view.repaint()){\r\n                        console.log(\"wait\")\r\n                        setTimeout(wait, 10);\r\n                    }\r\n                  }, 10);\r\n                return;\r\n            }\r\n            _actualUpdate = new Date().getTime();\r\n            let inst = this,\r\n                actualUpdate = _actualUpdate;\r\n            this.view.inProgress(true);\r\n            this.load().then(function (res) {\r\n                if (_actualUpdate == actualUpdate) {\r\n                    inst.isDirty = false;\r\n                    inst.view.inProgress(false);            \r\n                    inst.view.repaint();\r\n                }\r\n            }, function (json) {\r\n                inst.data = null;\r\n                //console.log(json)\r\n                if ((json.Status && json.Status.toLowerCase() == \"auth\") ||\r\n                    (json.ErrorInfo && json.ErrorInfo.some && json.ErrorInfo.some(function (r) { return r.Status.toLowerCase() == \"auth\" })))\r\n                    inst.data = { msg: [{ txt: _gtxt(\"AISSearch2.auth\") }], vessels: [] };\r\n                else {\r\n                    //inst.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n                    console.log(json);\r\n                }\r\n                inst.view.inProgress(false);\r\n                inst.view.repaint();\r\n            });\r\n        }\r\n    },\r\n    beforeLoad = new Promise((resolve, reject) => {\r\n        let columnsJson = JSON.parse(localStorage.getItem(\"lloyds_columns\"));\r\n//columnsJson && console.log((new Date().getTime()-columnsJson.timestamp)/60000)\r\n        //if (!columnsJson || ((new Date().getTime()-columnsJson.timestamp)/60000>24*60))\r\n            fetch(\"//kosmosnimki.ru/demo/lloyds/api/v1/Ship/Meta\")\r\n            .then(r=>r.json())\r\n            .then(r=>{   \r\n                let checked = [], convert = a=>a.map(p=>{return {id:p.id, name: p.name1, trans: p.name3, caption: p.name2, nodes:null, checked: checked.indexOf(p.id)!=-1};})\r\n                if (columnsJson){\r\n                    columnsJson.nodes.forEach((e0, i0)=>{e0.nodes.forEach((e1, i1)=>{e1.nodes.forEach((e2, i2)=>{if (e2.checked) checked.push(e2.id)})})})\r\n                    // checked = [columnsJson.a, columnsJson.b, columnsJson.c]\r\n                    // console.log(checked)\r\n                }\r\n                returnInstance.data.columnsTs = new Date().getTime();\r\n                returnInstance.data.columns = [\r\n                    {name: \"general\", caption: \"Основные сведения\", nodes:[\r\n                        {name: \"identification\", caption: r[0].name, nodes:convert(r[0].attributes)},\r\n                        {name: \"type\", caption: r[1].name, nodes:convert(r[1].attributes)},\r\n                        {name: \"safety\", caption: r[4].name, nodes:convert(r[4].attributes)},\r\n                        {name: \"codes\", caption: r[15].name, nodes:convert(r[15].attributes)},\r\n                    ]},\r\n                    {name: \"subjects\", caption: \"Организации\", nodes:[\r\n                        {name: \"owners\", caption: r[2].name, nodes:convert(r[2].attributes)},\r\n                        {name: \"builders\", caption: r[3].name, nodes:convert(r[3].attributes)}\r\n                    ]},\r\n                    {name: \"history\", caption: \"Постройка и эксплуатация\", nodes:[\r\n                        {name: \"history\", caption: r[5].name, nodes:convert(r[5].attributes)},\r\n\r\n                    ]},\r\n                    {name: \"techical_data\", caption: \"Технические данные\", nodes:[\r\n                        {name: \"features\", caption: r[6].name, nodes:convert(r[6].attributes)},\r\n                        {name: \"dimensions\", caption: r[7].name, nodes:convert(r[7].attributes)},\r\n                        {name: \"hull\", caption: r[8].name, nodes:convert(r[8].attributes)},\r\n                        {name: \"tanks\", caption: r[9].name, nodes:convert(r[9].attributes)},\r\n                        {name: \"fuel\", caption: r[12].name, nodes:convert(r[12].attributes)}\r\n                    ]},\r\n                    {name: \"equipment\", caption: \"Оборудование\", nodes:[\r\n                        {name: \"cargo_structures\", caption: r[10].name, nodes:convert(r[10].attributes)},\r\n                        {name: \"engines\", caption: r[11].name, nodes:convert(r[11].attributes)},\r\n                        {name: \"energy_facilities\", caption: r[13].name, nodes:convert(r[13].attributes)},\r\n                        {name: \"thrusters\", caption: r[14].name, nodes:convert(r[14].attributes)}\r\n                    ]},\r\n                ];\r\n                if (columnsJson){\r\n                    returnInstance.data.columns.forEach(c=>{\r\n                        c.nodes.forEach(n=>{\r\n                            n.checked = n.nodes.every(nn=>nn.checked)\r\n                        });\r\n                        c.checked = c.nodes.every(n=>n.checked);\r\n                    })\r\n                }\r\n                else{                   \r\n                    returnInstance.data.columns[0].nodes[0].nodes.forEach(n=>n.checked=true)\r\n                    returnInstance.data.columns[0].nodes[0].checked = true;                 \r\n                    returnInstance.data.columns[0].nodes[1].nodes.forEach(n=>n.checked=true)\r\n                    returnInstance.data.columns[0].nodes[1].checked = true;\r\n                }\r\n                resolve();\r\n            })\r\n            .catch(e=>{console.log(e); reject(e)})\r\n        // else{           \r\n        //     returnInstance.data.columnsTs = columnsJson.timestamp; \r\n        //     returnInstance.data.columns = columnsJson.nodes;            \r\n        //     resolve();\r\n        // }\r\n    });\r\n    return returnInstance;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Models/RegisterModel.js","module.exports = function (options) {\r\n    const _baseUrl = window.serverBase || document.location.href.replace(/^(https?:).+/, \"$1\") + '//maps.kosmosnimki.ru/',\r\n        _aisServices = _baseUrl + \"Plugins/AIS/\",\r\n        _serverScript = _baseUrl + 'VectorLayer/Search.ashx';\r\n    const { aisLastPoint:_aisLastPoint, \r\n        screenSearchLayer:_screenSearchLayer, \r\n        aisLayerID:_aisLayerID, \r\n        historyLayer:_historyLayer \r\n    } = options;\r\n\r\n    return {\r\n        baseUrl: _baseUrl,\r\n        aisServices: _aisServices,\r\n        getBorder: function () {\r\n            var lmap = nsGmx.leafletMap;\r\n            var dFeatures = lmap.gmxDrawing.getFeatures();\r\n            if (dFeatures.length) { return dFeatures[dFeatures.length - 1].toGeoJSON(); }\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat },\r\n                minX = min.x,\r\n                maxX = max.x,\r\n                geo = { type: 'Polygon', coordinates: [[[minX, min.y], [minX, max.y], [maxX, max.y], [maxX, min.y], [minX, min.y]]] },\r\n                w = (maxX - minX) / 2;\r\n\r\n            if (w >= 180) {\r\n                geo = { type: 'Polygon', coordinates: [[[-180, min.y], [-180, max.y], [180, max.y], [180, min.y], [-180, min.y]]] };\r\n            }\r\n            else if (maxX > 180 || minX < -180) {\r\n                var center = ((maxX + minX) / 2) % 360;\r\n                if (center > 180) { center -= 360; }\r\n                else if (center < -180) { center += 360; }\r\n                minX = center - w; maxX = center + w;\r\n                if (minX < -180) {\r\n                    geo = {\r\n                        type: 'MultiPolygon', coordinates: [\r\n                            [[[-180, min.y], [-180, max.y], [maxX, max.y], [maxX, min.y], [-180, min.y]]],\r\n                            [[[minX + 360, min.y], [minX + 360, max.y], [180, max.y], [180, min.y], [minX + 360, min.y]]]\r\n                        ]\r\n                    };\r\n                } else if (maxX > 180) {\r\n                    geo = {\r\n                        type: 'MultiPolygon', coordinates: [\r\n                            [[[minX, min.y], [minX, max.y], [180, max.y], [180, min.y], [minX, min.y]]],\r\n                            [[[-180, min.y], [-180, max.y], [maxX - 360, max.y], [maxX - 360, min.y], [-180, min.y]]]\r\n                        ]\r\n                    };\r\n                }\r\n            }\r\n            return geo;\r\n        },\r\n\r\n        formatTime: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleTimeString();\r\n        },\r\n        formatDate: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleDateString();\r\n        },\r\n        formatDateTime: function (d, local) {\r\n            if (d.isNaN)\r\n                return \"\";\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleString().replace(/,/, \"\");\r\n        },\r\n\r\n        formatDate2: function (d, local) {\r\n            var dd, m, y, h, mm;\r\n            if (local) {\r\n                dd = (\"0\" + d.getDate()).slice(-2);\r\n                m = (\"0\" + (d.getMonth() + 1)).slice(-2);\r\n                y = d.getFullYear();\r\n                h = (\"0\" + d.getHours()).slice(-2);\r\n                mm = (\"0\" + d.getMinutes()).slice(-2);\r\n                return dd + \".\" + m + \".\" + y + \" \" + h + \":\" + mm +\r\n                    \" (\" + (\"0\" + d.getUTCHours()).slice(-2) + \":\" + (\"0\" + d.getUTCMinutes()).slice(-2) + \" UTC)\";\r\n            }\r\n            else {\r\n                dd = (\"0\" + d.getUTCDate()).slice(-2);\r\n                m = (\"0\" + (d.getUTCMonth() + 1)).slice(-2);\r\n                y = d.getUTCFullYear();\r\n                h = (\"0\" + d.getUTCHours()).slice(-2);\r\n                mm = (\"0\" + d.getUTCMinutes()).slice(-2);\r\n                var\r\n                    ldd = (\"0\" + d.getDate()).slice(-2),\r\n                    lm = (\"0\" + (d.getMonth() + 1)).slice(-2),\r\n                    ly = d.getFullYear(),\r\n                    lh = (\"0\" + d.getHours()).slice(-2),\r\n                    lmm = (\"0\" + d.getMinutes()).slice(-2),\r\n                    offset = -d.getTimezoneOffset() / 60;\r\n                return dd + \".\" + m + \".\" + y + \" <span class='utc'>\" + h + \":\" + mm + \" UTC</span> (\" + lh + \":\" + lmm + \")\"\r\n                //return dd+\".\"+m+\".\"+y+\" \"+h+\":\"+mm+\" UTC <br>\"+\r\n                //\"<span class='small'>(\"+ldd+\".\"+lm+\".\"+ly+\" \"+lh+\":\"+lmm+\" UTC\"+(offset>0?\"+\":\"\")+offset+\")</span>\";\r\n            }\r\n        },\r\n        placeVesselTypeIcon: function(vessel){\r\n            switch (vessel.vessel_type.toLowerCase()) {\r\n                case \"cargo\":\r\n                    vessel.icon = \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Ccargo-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"tanker\":\r\n                    vessel.icon = \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Ctanker-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"fishing\":\r\n                    vessel.icon = \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cfishing-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"passenger\":\r\n                    vessel.icon = \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cpassenger-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;                \r\n                case \"hsc\":\r\n                    vessel.icon = \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Chighspeed-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"pleasure craft\":\r\n                case \"sailing\":\r\n                    vessel.icon = \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cpleasure-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"unknown\": \r\n                case \"reserved\": \r\n                case \"other\":\r\n                    vessel.icon = \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cother-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                default:\r\n                    vessel.icon = \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cspecialcraft-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n            }\r\n        },\r\n        searchString: function (searchString, isfuzzy, callback) {\r\n            //console.log(\"http://kosmosnimki.ru/demo/lloyds/api/v1/Ship/Search/\"+searchString)\r\n            //L.gmxUtil.sendCrossDomainPostRequest(\"http://kosmosnimki.ru/demo/lloyds/api/v1/Ship/Search/\"+searchString, request, callback);\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Search/Searcher.js"],"sourceRoot":""}