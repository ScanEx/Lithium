{"version":3,"file":"scanex-weather-view.js","sources":["../node_modules/scanex-async/index.js","../node_modules/svelte/shared.js","../src/Utils.js","../src/Forecast.html","../src/ForecastControl.js","../src/LayerSwitch.html","../node_modules/svelte/store.js","../index.js"],"sourcesContent":["const chain = (tasks, state) => {\r\n    return tasks.reduce(\r\n        (prev, next) => prev.then(next),\r\n        new Promise ((resolve, reject) => resolve (state))\r\n    );\r\n};\r\n\r\nexport { chain };","function noop() {}\n\nfunction assign(tar, src) {\n\tfor (var k in src) tar[k] = src[k];\n\treturn tar;\n}\n\nfunction assignTrue(tar, src) {\n\tfor (var k in src) tar[k] = 1;\n\treturn tar;\n}\n\nfunction isPromise(value) {\n\treturn value && typeof value.then === 'function';\n}\n\nfunction callAfter(fn, i) {\n\tif (i === 0) fn();\n\treturn () => {\n\t\tif (!--i) fn();\n\t};\n}\n\nfunction addLoc(element, file, line, column, char) {\n\telement.__svelte_meta = {\n\t\tloc: { file, line, column, char }\n\t};\n}\n\nfunction exclude(src, prop) {\n\tconst tar = {};\n\tfor (const k in src) k === prop || (tar[k] = src[k]);\n\treturn tar;\n}\n\nfunction run(fn) {\n\tfn();\n}\n\nfunction append(target, node) {\n\ttarget.appendChild(node);\n}\n\nfunction insert(target, node, anchor) {\n\ttarget.insertBefore(node, anchor);\n}\n\nfunction detachNode(node) {\n\tnode.parentNode.removeChild(node);\n}\n\nfunction detachBetween(before, after) {\n\twhile (before.nextSibling && before.nextSibling !== after) {\n\t\tbefore.parentNode.removeChild(before.nextSibling);\n\t}\n}\n\nfunction detachBefore(after) {\n\twhile (after.previousSibling) {\n\t\tafter.parentNode.removeChild(after.previousSibling);\n\t}\n}\n\nfunction detachAfter(before) {\n\twhile (before.nextSibling) {\n\t\tbefore.parentNode.removeChild(before.nextSibling);\n\t}\n}\n\nfunction reinsertBetween(before, after, target) {\n\twhile (before.nextSibling && before.nextSibling !== after) {\n\t\ttarget.appendChild(before.parentNode.removeChild(before.nextSibling));\n\t}\n}\n\nfunction reinsertChildren(parent, target) {\n\twhile (parent.firstChild) target.appendChild(parent.firstChild);\n}\n\nfunction reinsertAfter(before, target) {\n\twhile (before.nextSibling) target.appendChild(before.nextSibling);\n}\n\nfunction reinsertBefore(after, target) {\n\tvar parent = after.parentNode;\n\twhile (parent.firstChild !== after) target.appendChild(parent.firstChild);\n}\n\nfunction destroyEach(iterations, detach) {\n\tfor (var i = 0; i < iterations.length; i += 1) {\n\t\tif (iterations[i]) iterations[i].d(detach);\n\t}\n}\n\nfunction createFragment() {\n\treturn document.createDocumentFragment();\n}\n\nfunction createElement(name) {\n\treturn document.createElement(name);\n}\n\nfunction createSvgElement(name) {\n\treturn document.createElementNS('http://www.w3.org/2000/svg', name);\n}\n\nfunction createText(data) {\n\treturn document.createTextNode(data);\n}\n\nfunction createComment() {\n\treturn document.createComment('');\n}\n\nfunction addListener(node, event, handler) {\n\tnode.addEventListener(event, handler, false);\n}\n\nfunction removeListener(node, event, handler) {\n\tnode.removeEventListener(event, handler, false);\n}\n\nfunction setAttribute(node, attribute, value) {\n\tnode.setAttribute(attribute, value);\n}\n\nfunction setAttributes(node, attributes) {\n\tfor (var key in attributes) {\n\t\tif (key === 'style') {\n\t\t\tnode.style.cssText = attributes[key];\n\t\t} else if (key in node) {\n\t\t\tnode[key] = attributes[key];\n\t\t} else {\n\t\t\tif (attributes[key] === undefined) removeAttribute(node, key);\n\t\t\telse setAttribute(node, key, attributes[key]);\n\t\t}\n\t}\n}\n\nfunction setCustomElementData(node, prop, value) {\n\tif (prop in node) {\n\t\tnode[prop] = value;\n\t} else if (value) {\n\t\tsetAttribute(node, prop, value);\n\t} else {\n\t\tremoveAttribute(node, prop);\n\t}\n}\n\nfunction removeAttribute(node, attribute) {\n\tnode.removeAttribute(attribute);\n}\n\nfunction setXlinkAttribute(node, attribute, value) {\n\tnode.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\n\nfunction getBindingGroupValue(group) {\n\tvar value = [];\n\tfor (var i = 0; i < group.length; i += 1) {\n\t\tif (group[i].checked) value.push(group[i].__value);\n\t}\n\treturn value;\n}\n\nfunction toNumber(value) {\n\treturn value === '' ? undefined : +value;\n}\n\nfunction timeRangesToArray(ranges) {\n\tvar array = [];\n\tfor (var i = 0; i < ranges.length; i += 1) {\n\t\tarray.push({ start: ranges.start(i), end: ranges.end(i) });\n\t}\n\treturn array;\n}\n\nfunction children (element) {\n\treturn Array.from(element.childNodes);\n}\n\nfunction claimElement (nodes, name, attributes, svg) {\n\tfor (var i = 0; i < nodes.length; i += 1) {\n\t\tvar node = nodes[i];\n\t\tif (node.nodeName === name) {\n\t\t\tfor (var j = 0; j < node.attributes.length; j += 1) {\n\t\t\t\tvar attribute = node.attributes[j];\n\t\t\t\tif (!attributes[attribute.name]) node.removeAttribute(attribute.name);\n\t\t\t}\n\t\t\treturn nodes.splice(i, 1)[0]; // TODO strip unwanted attributes\n\t\t}\n\t}\n\n\treturn svg ? createSvgElement(name) : createElement(name);\n}\n\nfunction claimText (nodes, data) {\n\tfor (var i = 0; i < nodes.length; i += 1) {\n\t\tvar node = nodes[i];\n\t\tif (node.nodeType === 3) {\n\t\t\tnode.data = data;\n\t\t\treturn nodes.splice(i, 1)[0];\n\t\t}\n\t}\n\n\treturn createText(data);\n}\n\nfunction setData(text, data) {\n\ttext.data = '' + data;\n}\n\nfunction setInputType(input, type) {\n\ttry {\n\t\tinput.type = type;\n\t} catch (e) {}\n}\n\nfunction setStyle(node, key, value) {\n\tnode.style.setProperty(key, value);\n}\n\nfunction selectOption(select, value) {\n\tfor (var i = 0; i < select.options.length; i += 1) {\n\t\tvar option = select.options[i];\n\n\t\tif (option.__value === value) {\n\t\t\toption.selected = true;\n\t\t\treturn;\n\t\t}\n\t}\n}\n\nfunction selectOptions(select, value) {\n\tfor (var i = 0; i < select.options.length; i += 1) {\n\t\tvar option = select.options[i];\n\t\toption.selected = ~value.indexOf(option.__value);\n\t}\n}\n\nfunction selectValue(select) {\n\tvar selectedOption = select.querySelector(':checked') || select.options[0];\n\treturn selectedOption && selectedOption.__value;\n}\n\nfunction selectMultipleValue(select) {\n\treturn [].map.call(select.querySelectorAll(':checked'), function(option) {\n\t\treturn option.__value;\n\t});\n}\n\nfunction addResizeListener(element, fn) {\n\tif (getComputedStyle(element).position === 'static') {\n\t\telement.style.position = 'relative';\n\t}\n\n\tconst object = document.createElement('object');\n\tobject.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;');\n\tobject.type = 'text/html';\n\n\tlet win;\n\n\tobject.onload = () => {\n\t\twin = object.contentDocument.defaultView;\n\t\twin.addEventListener('resize', fn);\n\t};\n\n\tif (/Trident/.test(navigator.userAgent)) {\n\t\telement.appendChild(object);\n\t\tobject.data = 'about:blank';\n\t} else {\n\t\tobject.data = 'about:blank';\n\t\telement.appendChild(object);\n\t}\n\n\treturn {\n\t\tcancel: () => {\n\t\t\twin && win.removeEventListener && win.removeEventListener('resize', fn);\n\t\t\telement.removeChild(object);\n\t\t}\n\t};\n}\n\nfunction toggleClass(element, name, toggle) {\n\telement.classList.toggle(name, !!toggle);\n}\n\nfunction linear(t) {\n\treturn t;\n}\n\nfunction generateRule({ a, b, delta, duration }, ease, fn) {\n\tconst step = 16.666 / duration;\n\tlet keyframes = '{\\n';\n\n\tfor (let p = 0; p <= 1; p += step) {\n\t\tconst t = a + delta * ease(p);\n\t\tkeyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n\t}\n\n\treturn keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n}\n\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n\tlet hash = 5381;\n\tlet i = str.length;\n\n\twhile (i--) hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n\treturn hash >>> 0;\n}\n\nfunction wrapTransition(component, node, fn, params, intro) {\n\tlet obj = fn.call(component, node, params);\n\tlet duration;\n\tlet ease;\n\tlet cssText;\n\n\tlet initialised = false;\n\n\treturn {\n\t\tt: intro ? 0 : 1,\n\t\trunning: false,\n\t\tprogram: null,\n\t\tpending: null,\n\n\t\trun(b, callback) {\n\t\t\tif (typeof obj === 'function') {\n\t\t\t\ttransitionManager.wait().then(() => {\n\t\t\t\t\tobj = obj();\n\t\t\t\t\tthis._run(b, callback);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis._run(b, callback);\n\t\t\t}\n\t\t},\n\n\t\t_run(b, callback) {\n\t\t\tduration = obj.duration || 300;\n\t\t\tease = obj.easing || linear;\n\n\t\t\tconst program = {\n\t\t\t\tstart: window.performance.now() + (obj.delay || 0),\n\t\t\t\tb,\n\t\t\t\tcallback: callback || noop\n\t\t\t};\n\n\t\t\tif (intro && !initialised) {\n\t\t\t\tif (obj.css && obj.delay) {\n\t\t\t\t\tcssText = node.style.cssText;\n\t\t\t\t\tnode.style.cssText += obj.css(0, 1);\n\t\t\t\t}\n\n\t\t\t\tif (obj.tick) obj.tick(0, 1);\n\t\t\t\tinitialised = true;\n\t\t\t}\n\n\t\t\tif (!b) {\n\t\t\t\tprogram.group = outros.current;\n\t\t\t\toutros.current.remaining += 1;\n\t\t\t}\n\n\t\t\tif (obj.delay) {\n\t\t\t\tthis.pending = program;\n\t\t\t} else {\n\t\t\t\tthis.start(program);\n\t\t\t}\n\n\t\t\tif (!this.running) {\n\t\t\t\tthis.running = true;\n\t\t\t\ttransitionManager.add(this);\n\t\t\t}\n\t\t},\n\n\t\tstart(program) {\n\t\t\tcomponent.fire(`${program.b ? 'intro' : 'outro'}.start`, { node });\n\n\t\t\tprogram.a = this.t;\n\t\t\tprogram.delta = program.b - program.a;\n\t\t\tprogram.duration = duration * Math.abs(program.b - program.a);\n\t\t\tprogram.end = program.start + program.duration;\n\n\t\t\tif (obj.css) {\n\t\t\t\tif (obj.delay) node.style.cssText = cssText;\n\n\t\t\t\tconst rule = generateRule(program, ease, obj.css);\n\t\t\t\ttransitionManager.addRule(rule, program.name = '__svelte_' + hash(rule));\n\n\t\t\t\tnode.style.animation = (node.style.animation || '')\n\t\t\t\t\t.split(', ')\n\t\t\t\t\t.filter(anim => anim && (program.delta < 0 || !/__svelte/.test(anim)))\n\t\t\t\t\t.concat(`${program.name} ${program.duration}ms linear 1 forwards`)\n\t\t\t\t\t.join(', ');\n\t\t\t}\n\n\t\t\tthis.program = program;\n\t\t\tthis.pending = null;\n\t\t},\n\n\t\tupdate(now) {\n\t\t\tconst program = this.program;\n\t\t\tif (!program) return;\n\n\t\t\tconst p = now - program.start;\n\t\t\tthis.t = program.a + program.delta * ease(p / program.duration);\n\t\t\tif (obj.tick) obj.tick(this.t, 1 - this.t);\n\t\t},\n\n\t\tdone() {\n\t\t\tconst program = this.program;\n\t\t\tthis.t = program.b;\n\n\t\t\tif (obj.tick) obj.tick(this.t, 1 - this.t);\n\n\t\t\tcomponent.fire(`${program.b ? 'intro' : 'outro'}.end`, { node });\n\n\t\t\tif (!program.b && !program.invalidated) {\n\t\t\t\tprogram.group.callbacks.push(() => {\n\t\t\t\t\tprogram.callback();\n\t\t\t\t\tif (obj.css) transitionManager.deleteRule(node, program.name);\n\t\t\t\t});\n\n\t\t\t\tif (--program.group.remaining === 0) {\n\t\t\t\t\tprogram.group.callbacks.forEach(run);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (obj.css) transitionManager.deleteRule(node, program.name);\n\t\t\t}\n\n\t\t\tthis.running = !!this.pending;\n\t\t},\n\n\t\tabort(reset) {\n\t\t\tif (this.program) {\n\t\t\t\tif (reset && obj.tick) obj.tick(1, 0);\n\t\t\t\tif (obj.css) transitionManager.deleteRule(node, this.program.name);\n\t\t\t\tthis.program = this.pending = null;\n\t\t\t\tthis.running = false;\n\t\t\t}\n\t\t},\n\n\t\tinvalidate() {\n\t\t\tif (this.program) {\n\t\t\t\tthis.program.invalidated = true;\n\t\t\t}\n\t\t}\n\t};\n}\n\nlet outros = {};\n\nfunction groupOutros() {\n\toutros.current = {\n\t\tremaining: 0,\n\t\tcallbacks: []\n\t};\n}\n\nvar transitionManager = {\n\trunning: false,\n\ttransitions: [],\n\tbound: null,\n\tstylesheet: null,\n\tactiveRules: {},\n\tpromise: null,\n\n\tadd(transition) {\n\t\tthis.transitions.push(transition);\n\n\t\tif (!this.running) {\n\t\t\tthis.running = true;\n\t\t\trequestAnimationFrame(this.bound || (this.bound = this.next.bind(this)));\n\t\t}\n\t},\n\n\taddRule(rule, name) {\n\t\tif (!this.stylesheet) {\n\t\t\tconst style = createElement('style');\n\t\t\tdocument.head.appendChild(style);\n\t\t\ttransitionManager.stylesheet = style.sheet;\n\t\t}\n\n\t\tif (!this.activeRules[name]) {\n\t\t\tthis.activeRules[name] = true;\n\t\t\tthis.stylesheet.insertRule(`@keyframes ${name} ${rule}`, this.stylesheet.cssRules.length);\n\t\t}\n\t},\n\n\tnext() {\n\t\tthis.running = false;\n\n\t\tconst now = window.performance.now();\n\t\tlet i = this.transitions.length;\n\n\t\twhile (i--) {\n\t\t\tconst transition = this.transitions[i];\n\n\t\t\tif (transition.program && now >= transition.program.end) {\n\t\t\t\ttransition.done();\n\t\t\t}\n\n\t\t\tif (transition.pending && now >= transition.pending.start) {\n\t\t\t\ttransition.start(transition.pending);\n\t\t\t}\n\n\t\t\tif (transition.running) {\n\t\t\t\ttransition.update(now);\n\t\t\t\tthis.running = true;\n\t\t\t} else if (!transition.pending) {\n\t\t\t\tthis.transitions.splice(i, 1);\n\t\t\t}\n\t\t}\n\n\t\tif (this.running) {\n\t\t\trequestAnimationFrame(this.bound);\n\t\t} else if (this.stylesheet) {\n\t\t\tlet i = this.stylesheet.cssRules.length;\n\t\t\twhile (i--) this.stylesheet.deleteRule(i);\n\t\t\tthis.activeRules = {};\n\t\t}\n\t},\n\n\tdeleteRule(node, name) {\n\t\tnode.style.animation = node.style.animation\n\t\t\t.split(', ')\n\t\t\t.filter(anim => anim && anim.indexOf(name) === -1)\n\t\t\t.join(', ');\n\t},\n\n\twait() {\n\t\tif (!transitionManager.promise) {\n\t\t\ttransitionManager.promise = Promise.resolve();\n\t\t\ttransitionManager.promise.then(() => {\n\t\t\t\ttransitionManager.promise = null;\n\t\t\t});\n\t\t}\n\n\t\treturn transitionManager.promise;\n\t}\n};\n\nfunction wrapAnimation(node, from, fn, params) {\n\tif (!from) return;\n\n\tconst to = node.getBoundingClientRect();\n\tif (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom) return;\n\n\tconst info = fn(node, { from, to }, params);\n\n\tconst duration = 'duration' in info ? info.duration : 300;\n\tconst delay = 'delay' in info ? info.delay : 0;\n\tconst ease = info.easing || linear;\n\tconst start = window.performance.now() + delay;\n\tconst end = start + duration;\n\n\tconst program = {\n\t\ta: 0,\n\t\tt: 0,\n\t\tb: 1,\n\t\tdelta: 1,\n\t\tduration,\n\t\tstart,\n\t\tend\n\t};\n\n\tconst cssText = node.style.cssText;\n\n\tconst animation = {\n\t\tpending: delay ? program : null,\n\t\tprogram: delay ? null : program,\n\t\trunning: true,\n\n\t\tstart() {\n\t\t\tif (info.css) {\n\t\t\t\tif (delay) node.style.cssText = cssText;\n\n\t\t\t\tconst rule = generateRule(program, ease, info.css);\n\t\t\t\tprogram.name = `__svelte_${hash(rule)}`;\n\n\t\t\t\ttransitionManager.addRule(rule, program.name);\n\n\t\t\t\tnode.style.animation = (node.style.animation || '')\n\t\t\t\t\t.split(', ')\n\t\t\t\t\t.filter(anim => anim && (program.delta < 0 || !/__svelte/.test(anim)))\n\t\t\t\t\t.concat(`${program.name} ${program.duration}ms linear 1 forwards`)\n\t\t\t\t\t.join(', ');\n\t\t\t}\n\n\t\t\tanimation.program = program;\n\t\t\tanimation.pending = null;\n\t\t},\n\n\t\tupdate: now => {\n\t\t\tconst p = now - program.start;\n\t\t\tconst t = program.a + program.delta * ease(p / program.duration);\n\t\t\tif (info.tick) info.tick(t, 1 - t);\n\t\t},\n\n\t\tdone() {\n\t\t\tif (info.tick) info.tick(1, 0);\n\t\t\tanimation.stop();\n\t\t},\n\n\t\tstop() {\n\t\t\tif (info.css) transitionManager.deleteRule(node, program.name);\n\t\t\tanimation.running = false;\n\t\t}\n\t};\n\n\ttransitionManager.add(animation);\n\n\tif (info.tick) info.tick(0, 1);\n\n\tif (delay) {\n\t\tif (info.css) node.style.cssText += info.css(0, 1);\n\t} else {\n\t\tanimation.start();\n\t}\n\n\treturn animation;\n}\n\nfunction fixPosition(node) {\n\tconst style = getComputedStyle(node);\n\n\tif (style.position !== 'absolute' && style.position !== 'fixed') {\n\t\tconst { width, height } = style;\n\t\tconst a = node.getBoundingClientRect();\n\t\tnode.style.position = 'absolute';\n\t\tnode.style.width = width;\n\t\tnode.style.height = height;\n\t\tconst b = node.getBoundingClientRect();\n\n\t\tif (a.left !== b.left || a.top !== b.top) {\n\t\t\tconst style = getComputedStyle(node);\n\t\t\tconst transform = style.transform === 'none' ? '' : style.transform;\n\n\t\t\tnode.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n\t\t}\n\t}\n}\n\nfunction handlePromise(promise, info) {\n\tvar token = info.token = {};\n\n\tfunction update(type, index, key, value) {\n\t\tif (info.token !== token) return;\n\n\t\tinfo.resolved = key && { [key]: value };\n\n\t\tconst child_ctx = assign(assign({}, info.ctx), info.resolved);\n\t\tconst block = type && (info.current = type)(info.component, child_ctx);\n\n\t\tif (info.block) {\n\t\t\tif (info.blocks) {\n\t\t\t\tinfo.blocks.forEach((block, i) => {\n\t\t\t\t\tif (i !== index && block) {\n\t\t\t\t\t\tgroupOutros();\n\t\t\t\t\t\tblock.o(() => {\n\t\t\t\t\t\t\tblock.d(1);\n\t\t\t\t\t\t\tinfo.blocks[i] = null;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tinfo.block.d(1);\n\t\t\t}\n\n\t\t\tblock.c();\n\t\t\tblock[block.i ? 'i' : 'm'](info.mount(), info.anchor);\n\n\t\t\tinfo.component.root.set({}); // flush any handlers that were created\n\t\t}\n\n\t\tinfo.block = block;\n\t\tif (info.blocks) info.blocks[index] = block;\n\t}\n\n\tif (isPromise(promise)) {\n\t\tpromise.then(value => {\n\t\t\tupdate(info.then, 1, info.value, value);\n\t\t}, error => {\n\t\t\tupdate(info.catch, 2, info.error, error);\n\t\t});\n\n\t\t// if we previously had a then/catch block, destroy it\n\t\tif (info.current !== info.pending) {\n\t\t\tupdate(info.pending, 0);\n\t\t\treturn true;\n\t\t}\n\t} else {\n\t\tif (info.current !== info.then) {\n\t\t\tupdate(info.then, 1, info.value, promise);\n\t\t\treturn true;\n\t\t}\n\n\t\tinfo.resolved = { [info.value]: promise };\n\t}\n}\n\nfunction destroyBlock(block, lookup) {\n\tblock.d(1);\n\tlookup[block.key] = null;\n}\n\nfunction outroAndDestroyBlock(block, lookup) {\n\tblock.o(function() {\n\t\tdestroyBlock(block, lookup);\n\t});\n}\n\nfunction fixAndOutroAndDestroyBlock(block, lookup) {\n\tblock.f();\n\toutroAndDestroyBlock(block, lookup);\n}\n\nfunction updateKeyedEach(old_blocks, component, changed, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, intro_method, next, get_context) {\n\tvar o = old_blocks.length;\n\tvar n = list.length;\n\n\tvar i = o;\n\tvar old_indexes = {};\n\twhile (i--) old_indexes[old_blocks[i].key] = i;\n\n\tvar new_blocks = [];\n\tvar new_lookup = {};\n\tvar deltas = {};\n\n\tvar i = n;\n\twhile (i--) {\n\t\tvar child_ctx = get_context(ctx, list, i);\n\t\tvar key = get_key(child_ctx);\n\t\tvar block = lookup[key];\n\n\t\tif (!block) {\n\t\t\tblock = create_each_block(component, key, child_ctx);\n\t\t\tblock.c();\n\t\t} else if (dynamic) {\n\t\t\tblock.p(changed, child_ctx);\n\t\t}\n\n\t\tnew_blocks[i] = new_lookup[key] = block;\n\n\t\tif (key in old_indexes) deltas[key] = Math.abs(i - old_indexes[key]);\n\t}\n\n\tvar will_move = {};\n\tvar did_move = {};\n\n\tfunction insert(block) {\n\t\tblock[intro_method](node, next);\n\t\tlookup[block.key] = block;\n\t\tnext = block.first;\n\t\tn--;\n\t}\n\n\twhile (o && n) {\n\t\tvar new_block = new_blocks[n - 1];\n\t\tvar old_block = old_blocks[o - 1];\n\t\tvar new_key = new_block.key;\n\t\tvar old_key = old_block.key;\n\n\t\tif (new_block === old_block) {\n\t\t\t// do nothing\n\t\t\tnext = new_block.first;\n\t\t\to--;\n\t\t\tn--;\n\t\t}\n\n\t\telse if (!new_lookup[old_key]) {\n\t\t\t// remove old block\n\t\t\tdestroy(old_block, lookup);\n\t\t\to--;\n\t\t}\n\n\t\telse if (!lookup[new_key] || will_move[new_key]) {\n\t\t\tinsert(new_block);\n\t\t}\n\n\t\telse if (did_move[old_key]) {\n\t\t\to--;\n\n\t\t} else if (deltas[new_key] > deltas[old_key]) {\n\t\t\tdid_move[new_key] = true;\n\t\t\tinsert(new_block);\n\n\t\t} else {\n\t\t\twill_move[old_key] = true;\n\t\t\to--;\n\t\t}\n\t}\n\n\twhile (o--) {\n\t\tvar old_block = old_blocks[o];\n\t\tif (!new_lookup[old_block.key]) destroy(old_block, lookup);\n\t}\n\n\twhile (n) insert(new_blocks[n - 1]);\n\n\treturn new_blocks;\n}\n\nfunction measure(blocks) {\n\tconst rects = {};\n\tlet i = blocks.length;\n\twhile (i--) rects[blocks[i].key] = blocks[i].node.getBoundingClientRect();\n\treturn rects;\n}\n\nfunction animate(blocks, rects, fn, params) {\n\tlet i = blocks.length;\n\twhile (i--) {\n\t\tconst block = blocks[i];\n\t\tconst from = rects[block.key];\n\n\t\tif (!from) continue;\n\t\tconst to = block.node.getBoundingClientRect();\n\n\t\tif (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom) continue;\n\n\n\t}\n}\n\nfunction getSpreadUpdate(levels, updates) {\n\tvar update = {};\n\n\tvar to_null_out = {};\n\tvar accounted_for = {};\n\n\tvar i = levels.length;\n\twhile (i--) {\n\t\tvar o = levels[i];\n\t\tvar n = updates[i];\n\n\t\tif (n) {\n\t\t\tfor (var key in o) {\n\t\t\t\tif (!(key in n)) to_null_out[key] = 1;\n\t\t\t}\n\n\t\t\tfor (var key in n) {\n\t\t\t\tif (!accounted_for[key]) {\n\t\t\t\t\tupdate[key] = n[key];\n\t\t\t\t\taccounted_for[key] = 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlevels[i] = n;\n\t\t} else {\n\t\t\tfor (var key in o) {\n\t\t\t\taccounted_for[key] = 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (var key in to_null_out) {\n\t\tif (!(key in update)) update[key] = undefined;\n\t}\n\n\treturn update;\n}\n\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nconst invalidAttributeNameCharacter = /[\\s'\">\\/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n\nfunction spread(args) {\n\tconst attributes = Object.assign({}, ...args);\n\tlet str = '';\n\n\tObject.keys(attributes).forEach(name => {\n\t\tif (invalidAttributeNameCharacter.test(name)) return;\n\n\t\tconst value = attributes[name];\n\t\tif (value === undefined) return;\n\t\tif (value === true) str += \" \" + name;\n\n\t\tconst escaped = String(value)\n\t\t\t.replace(/\"/g, '&#34;')\n\t\t\t.replace(/'/g, '&#39;');\n\n\t\tstr += \" \" + name + \"=\" + JSON.stringify(escaped);\n\t});\n\n\treturn str;\n}\n\nconst escaped = {\n\t'\"': '&quot;',\n\t\"'\": '&#39;',\n\t'&': '&amp;',\n\t'<': '&lt;',\n\t'>': '&gt;'\n};\n\nfunction escape(html) {\n\treturn String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\n\nfunction each(items, assign, fn) {\n\tlet str = '';\n\tfor (let i = 0; i < items.length; i += 1) {\n\t\tstr += fn(assign(items[i], i));\n\t}\n\treturn str;\n}\n\nconst missingComponent = {\n\t_render: () => ''\n};\n\nfunction validateSsrComponent(component, name) {\n\tif (!component || !component._render) {\n\t\tif (name === 'svelte:component') name += 'this={...}';\n\t\tthrow new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n\t}\n\n\treturn component;\n}\n\nfunction debug(file, line, column, values) {\n\tconsole.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`);\n\tconsole.log(values);\n\treturn '';\n}\n\nfunction blankObject() {\n\treturn Object.create(null);\n}\n\nfunction destroy(detach) {\n\tthis.destroy = noop;\n\tthis.fire('destroy');\n\tthis.set = noop;\n\n\tthis._fragment.d(detach !== false);\n\tthis._fragment = null;\n\tthis._state = {};\n}\n\nfunction destroyDev(detach) {\n\tdestroy.call(this, detach);\n\tthis.destroy = function() {\n\t\tconsole.warn('Component was already destroyed');\n\t};\n}\n\nfunction _differs(a, b) {\n\treturn a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\n\nfunction _differsImmutable(a, b) {\n\treturn a != a ? b == b : a !== b;\n}\n\nfunction fire(eventName, data) {\n\tvar handlers =\n\t\teventName in this._handlers && this._handlers[eventName].slice();\n\tif (!handlers) return;\n\n\tfor (var i = 0; i < handlers.length; i += 1) {\n\t\tvar handler = handlers[i];\n\n\t\tif (!handler.__calling) {\n\t\t\ttry {\n\t\t\t\thandler.__calling = true;\n\t\t\t\thandler.call(this, data);\n\t\t\t} finally {\n\t\t\t\thandler.__calling = false;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction flush(component) {\n\tcomponent._lock = true;\n\tcallAll(component._beforecreate);\n\tcallAll(component._oncreate);\n\tcallAll(component._aftercreate);\n\tcomponent._lock = false;\n}\n\nfunction get() {\n\treturn this._state;\n}\n\nfunction init(component, options) {\n\tcomponent._handlers = blankObject();\n\tcomponent._slots = blankObject();\n\tcomponent._bind = options._bind;\n\tcomponent._staged = {};\n\n\tcomponent.options = options;\n\tcomponent.root = options.root || component;\n\tcomponent.store = options.store || component.root.store;\n\n\tif (!options.root) {\n\t\tcomponent._beforecreate = [];\n\t\tcomponent._oncreate = [];\n\t\tcomponent._aftercreate = [];\n\t}\n}\n\nfunction on(eventName, handler) {\n\tvar handlers = this._handlers[eventName] || (this._handlers[eventName] = []);\n\thandlers.push(handler);\n\n\treturn {\n\t\tcancel: function() {\n\t\t\tvar index = handlers.indexOf(handler);\n\t\t\tif (~index) handlers.splice(index, 1);\n\t\t}\n\t};\n}\n\nfunction set(newState) {\n\tthis._set(assign({}, newState));\n\tif (this.root._lock) return;\n\tflush(this.root);\n}\n\nfunction _set(newState) {\n\tvar oldState = this._state,\n\t\tchanged = {},\n\t\tdirty = false;\n\n\tnewState = assign(this._staged, newState);\n\tthis._staged = {};\n\n\tfor (var key in newState) {\n\t\tif (this._differs(newState[key], oldState[key])) changed[key] = dirty = true;\n\t}\n\tif (!dirty) return;\n\n\tthis._state = assign(assign({}, oldState), newState);\n\tthis._recompute(changed, this._state);\n\tif (this._bind) this._bind(changed, this._state);\n\n\tif (this._fragment) {\n\t\tthis.fire(\"state\", { changed: changed, current: this._state, previous: oldState });\n\t\tthis._fragment.p(changed, this._state);\n\t\tthis.fire(\"update\", { changed: changed, current: this._state, previous: oldState });\n\t}\n}\n\nfunction _stage(newState) {\n\tassign(this._staged, newState);\n}\n\nfunction setDev(newState) {\n\tif (typeof newState !== 'object') {\n\t\tthrow new Error(\n\t\t\tthis._debugName + '.set was called without an object of data key-values to update.'\n\t\t);\n\t}\n\n\tthis._checkReadOnly(newState);\n\tset.call(this, newState);\n}\n\nfunction callAll(fns) {\n\twhile (fns && fns.length) fns.shift()();\n}\n\nfunction _mount(target, anchor) {\n\tthis._fragment[this._fragment.i ? 'i' : 'm'](target, anchor || null);\n}\n\nvar PENDING = {};\nvar SUCCESS = {};\nvar FAILURE = {};\n\nfunction removeFromStore() {\n\tthis.store._remove(this);\n}\n\nvar proto = {\n\tdestroy,\n\tget,\n\tfire,\n\ton,\n\tset,\n\t_recompute: noop,\n\t_set,\n\t_stage,\n\t_mount,\n\t_differs\n};\n\nvar protoDev = {\n\tdestroy: destroyDev,\n\tget,\n\tfire,\n\ton,\n\tset: setDev,\n\t_recompute: noop,\n\t_set,\n\t_stage,\n\t_mount,\n\t_differs\n};\n\nexport { blankObject, destroy, destroyDev, _differs, _differsImmutable, fire, flush, get, init, on, set, _set, _stage, setDev, callAll, _mount, PENDING, SUCCESS, FAILURE, removeFromStore, proto, protoDev, wrapAnimation, fixPosition, handlePromise, append, insert, detachNode, detachBetween, detachBefore, detachAfter, reinsertBetween, reinsertChildren, reinsertAfter, reinsertBefore, destroyEach, createFragment, createElement, createSvgElement, createText, createComment, addListener, removeListener, setAttribute, setAttributes, setCustomElementData, removeAttribute, setXlinkAttribute, getBindingGroupValue, toNumber, timeRangesToArray, children, claimElement, claimText, setData, setInputType, setStyle, selectOption, selectOptions, selectValue, selectMultipleValue, addResizeListener, toggleClass, destroyBlock, outroAndDestroyBlock, fixAndOutroAndDestroyBlock, updateKeyedEach, measure, animate, getSpreadUpdate, invalidAttributeNameCharacter, spread, escaped, escape, each, missingComponent, validateSsrComponent, debug, linear, generateRule, hash, wrapTransition, outros, groupOutros, transitionManager, noop, assign, assignTrue, isPromise, callAfter, addLoc, exclude, run };\n","const T = window.nsGmx.Translations;   \r\nconst translate = T.getText.bind(T);\r\n\r\nT.addText('rus', {        \r\n    directions: {\r\n        north: 'С',\r\n        northEast: 'СВ',\r\n        east: 'В',\r\n        southEast: 'ЮВ',\r\n        south: 'Ю',\r\n        southWest: 'ЮЗ',\r\n        west: 'З',\r\n        northWest: 'СВ',\r\n    },        \r\n});\r\n\r\nT.addText('eng', {    \r\n    directions: {\r\n        north: 'N',\r\n        northEast: 'NE',\r\n        east: 'E',\r\n        southEast: 'SE',\r\n        south: 'S',\r\n        southWest: 'SW',\r\n        west: 'W',\r\n        northWest: 'NW',    \r\n    },\r\n});\r\n\r\nconst string_to_array = str => {\r\n    let arr = [];\r\n    for (let i = 0; i < str.length; ++i) {\r\n        arr.push (str.charAt(i));\r\n    }\r\n    return arr;\r\n};\r\n\r\nconst pad = (origin, str, width, sym) => {\r\n    let s = string_to_array (str);\r\n    for (let i = 0; s.length < width; ++i) {\r\n        if (origin === 'left') {\r\n            s.splice (0, 0, sym);\r\n        }\r\n        else {\r\n            s.push (sym);\r\n        }\r\n    }\r\n    return s.join('');\r\n};\r\n\r\nconst pad_left = (str, sym, width) => pad ('left', str, width, sym);\r\nconst pad_right = (str, sym, width) => pad ('right', str, width, sym);\r\n\r\nconst get_task = ({mode, param, lat, lng, hours}) => new Promise ((resolve, reject) => {\r\n    let headers = new Headers();\r\n    headers.append('center', `[${lng},${lat}]`);\r\n    let init = { \r\n        method: 'GET',\r\n        headers,\r\n        mode: 'cors',\r\n        cache: 'default'\r\n    };\r\n\r\n    const endPoint = 'http://95.163.250.203:9898/maritime/v2.0/rest';\r\n    const resolution = 0.5;\r\n    \r\n    let request = new Request(`${endPoint}/${mode}/${param}/${resolution}/${hours}`, init);\r\n\r\n    fetch(request)\r\n    .then(response => response.json())\r\n    .then(response => {\r\n        const {features, code} = response;\r\n        if (code === 500){\r\n            reject(response);\r\n        }\r\n        else {\r\n            resolve ({ param, features });            \r\n        }\r\n    })\r\n    .catch(e => {        \r\n        reject(e);\r\n    });\r\n});\r\n\r\nconst MS_PER_HOUR = 60 * 60 * 1000;\r\nconst MS_PER_DAY = MS_PER_HOUR * 24;\r\n\r\nconst format_date = n => {\r\n    const now = new Date();\r\n    const d = new Date(now.getTime() + n * MS_PER_DAY);\r\n    return d.toLocaleDateString();\r\n};\r\n\r\nconst ZERO_KELVIN = -273.15;\r\nconst format_tmp = t => t && ((t + ZERO_KELVIN).toFixed()) || '';\r\n\r\nconst format_float = s => s && (s.toFixed()) || '';\r\nconst format_wd = d => {\r\n    if (d) {\r\n        if (0 <= d && d <= 22.5) {\r\n            return translate('directions.north');\r\n        }\r\n        else if (22.5 < d && d <= 67.5) {\r\n            return translate('directions.northEast');\r\n        }            \r\n        else if (67.5 < d && d <= 112.5) {\r\n            return translate('directions.east');\r\n        }\r\n        else if (112.5 < d && d <= 157.5) {\r\n            return translate('directions.southEast');\r\n        }            \r\n        else if (157.5 < d && d <= 202.5) {\r\n            return translate('directions.south');\r\n        }\r\n        else if (202.5 < d && d <= 247.5) {\r\n            return translate('directions.southWest');\r\n        }\r\n        else if (247.5 < d && d <= 292.5) {\r\n            return translate('directions.west');\r\n        }\r\n        else if (292.5 < d && d <= 337.5) {\r\n            return translate('directions.northWest');\r\n        }\r\n        else {\r\n            return translate('directions.north');\r\n        }\r\n    }\r\n    else {\r\n        return '';\r\n    }        \r\n};\r\n\r\nconst normalize_lat = lat => {\r\n    if (lat) {\r\n        if (0 <= lat && lat <= 90) {\r\n            return `${lat.toFixed(2)}°N`;\r\n        }\r\n        else if (-90 <= lat && lat < 0) {\r\n            return `${Math.abs(lat).toFixed(2)}°S`;\r\n        }\r\n        else {\r\n            return '';\r\n        }\r\n    }\r\n    else {\r\n        return '';\r\n    }        \r\n};\r\n\r\nconst normalize_lng = lng => {\r\n    const format_lng = x => {\r\n        if (0 <= x && x <= 180) {\r\n            return `${x.toFixed(2)}°E`;\r\n        }\r\n        else if (-180 < x && x < 0) {\r\n            return `${Math.abs(x).toFixed(2)}°W`;\r\n        }\r\n    };\r\n    if (lng) {\r\n        if (-180 < lng && lng <= 180) {\r\n            return format_lng (lng);\r\n        }\r\n        else if (lng > 180) {\r\n            let x = lng;\r\n            while (x > 180) {\r\n                x -= 360;\r\n            }\r\n            return format_lng (x);\r\n        }\r\n        else if (lng <= -180) {\r\n            let x = lng;\r\n            while (x <= -180) {\r\n                x += 360;\r\n            }\r\n            return format_lng (x);\r\n        }\r\n        else {\r\n            return '';\r\n        }\r\n    }\r\n    else {\r\n        return '';\r\n    }        \r\n};\r\n\r\nconst format_coord = latLng => {\r\n    if (latLng) {\r\n        const {lat, lng} = latLng;\r\n        return  `${normalize_lat(lat)} ${normalize_lng(lng)}`;\r\n    }\r\n    else {\r\n        return '';\r\n    }\r\n};\r\n\r\nconst PA_TO_MMHG = 101325 / 760;\r\nconst format_pressure = p => p && ((p / PA_TO_MMHG).toFixed()) || '';  \r\n\r\nconst is_today = d => {\r\n    const now = new Date();\r\n    return d && \r\n    d.getFullYear() === now.getFullYear() &&\r\n    d.getMonth() === now.getMonth() &&\r\n    d.getDate() === now.getDate();\r\n};\r\n\r\nconst FORECAST_PERIOD_HOURS = 72;   \r\nconst FORECAST_DAYS_NUMBER = 4;\r\nconst FORECAST_DAY_HOURS_NUMBER = 8;\r\nconst FORECAST_HOURS_STEP = 3;\r\n\r\nconst FORECAST_DAY_HOURS = (function () {\r\n    const hours = [];\r\n    let j = 0;\r\n    for (let i = 0; i < FORECAST_DAY_HOURS_NUMBER; ++i) {\r\n        hours.push(j);\r\n        j += FORECAST_HOURS_STEP;\r\n    }\r\n    return hours;\r\n})();\r\n\r\nconst FORECAST_HOURS = (function() {\r\n    let hours = [];       \r\n    for (var i = 0; i <= FORECAST_PERIOD_HOURS; i += FORECAST_HOURS_STEP) {\r\n        hours.push(i);\r\n    }\r\n    return hours;\r\n})();\r\n\r\nconst FORECAST_MODES = [\r\n    'gfs',\r\n    //'gefs',\r\n];\r\nconst WEATHER_LAYERS = ['tmp', 'wind', 'precip', 'rh', 'pressure', 'dewpoint', 'cloud'];\r\n//     {\r\n//         name: 'tmp',\r\n//         layers: 'tmp_f000',            \r\n//     },\r\n//     {\r\n//         name:'wind',        \r\n//         layers: 'wind_f000',        \r\n//     },    \r\n//     {\r\n//         name: 'precip',        \r\n//         layers: 'precip_f000',        \r\n//     },\r\n//     {\r\n//         name: 'rh',        \r\n//         layers: 'rh_f000',        \r\n//     },\r\n//     {\r\n//         name: 'pressure',        \r\n//         layers: 'pressure_f000',        \r\n//     },\r\n//     {\r\n//         name: 'dewpoint',        \r\n//         layers: 'dewpoint_f000',        \r\n//     },        \r\n//     {\r\n//         name: 'cloud',        \r\n//         layers: 'cloud_f000',\r\n//     },\r\n// ];\r\n\r\nconst FORECAST_VECTOR = (function () {\r\n    const vect = [];\r\n    const len = FORECAST_DAYS_NUMBER * FORECAST_DAY_HOURS_NUMBER;\r\n    for (let i = 0; i < len; ++i) {\r\n        vect.push(null);\r\n    }\r\n    return vect;\r\n})();\r\n\r\nconst is_now = (d, h) => {\r\n    const now = new Date();        \r\n    const n = now.getHours();\r\n    return is_today(d) && h && h <= n && n < (h + FORECAST_HOURS_STEP);\r\n};\r\n\r\nconst find_hour_index = hour => {\r\n    for (let i = 0; i < FORECAST_HOURS.length; ++i) {\r\n        const h = FORECAST_HOURS[i];\r\n        if (h <= hour && hour < (h + FORECAST_HOURS_STEP)){\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n};\r\n\r\nconst get_wms_now = (mode, lat, lng, now) => new Promise ((resolve, reject) => {    \r\n    get_task({mode, param: 'temperature', lat, lng, hours: 0})\r\n    .then(result => {\r\n        const { features: [f, ... rest]} = result;\r\n        if (f) {\r\n            const {properties: {ts}} = f;\r\n            const h = (now.getTime() - ts * 1000) / MS_PER_HOUR;\r\n            const i = find_hour_index (h);\r\n            resolve (i);\r\n        }\r\n        else {\r\n            resolve(0);\r\n        }\r\n    })\r\n    .catch(e => {\r\n        reject(e);\r\n    });\r\n});\r\n\r\nexport {\r\n    get_task,\r\n    translate,\r\n    format_date,\r\n    format_coord,\r\n    format_float,\r\n    format_pressure,\r\n    format_tmp,\r\n    format_wd,\r\n    is_today,\r\n    is_now,\r\n    FORECAST_PERIOD_HOURS,\r\n    FORECAST_DAYS_NUMBER,\r\n    FORECAST_DAY_HOURS_NUMBER,\r\n    FORECAST_HOURS_STEP,\r\n    FORECAST_DAY_HOURS,\r\n    FORECAST_HOURS,\r\n    FORECAST_MODES,\r\n    FORECAST_VECTOR,\r\n    WEATHER_LAYERS,\r\n    MS_PER_HOUR,\r\n    get_wms_now,\r\n    find_hour_index,\r\n    pad_left,\r\n    pad_right,\r\n};","<div ref:container class=\"weather-view-container\">\r\n    <div class=\"weather-view-params\">\r\n        <table>\r\n            <tr>\r\n                <td on:click=\"hide()\" class=\"weather-view-close\">\r\n                    <i></i>\r\n                </td>\r\n                <td class=\"weather-view-current-spot\" colspan=\"2\"><span>{format_coord(latLng)}</span><i></i></td>                \r\n            </tr>\r\n            <tr>\r\n                <td></td>\r\n                <td class=\"weather-view-param\">{translate('units.hours')}</td>\r\n                <td class=\"weather-view-param-unit\"></td>\r\n            </tr>\r\n            <tr>\r\n                <td></td>\r\n                <td class=\"weather-view-param\">{translate('tmp')}</td>\r\n                <td class=\"weather-view-param-unit\">{translate('units.d')}</td>\r\n            </tr>\r\n            <tr>\r\n                <td></td>\r\n                <td class=\"weather-view-param\">{translate('wind')}</td>\r\n                <td class=\"weather-view-param-unit\">{translate('units.ms')}</td>\r\n            </tr>\r\n            <tr>\r\n                <td></td>\r\n                <td class=\"weather-view-param\">{translate('direction')}</td>\r\n                <td class=\"weather-view-param-unit\"></td>\r\n            </tr>\r\n            <tr>\r\n                <td></td>\r\n                <td class=\"weather-view-param\">{translate('gust')}</td>\r\n                <td class=\"weather-view-param-unit\">{translate('units.ms')}</td>\r\n            </tr>\r\n            <tr>\r\n                <td></td>\r\n                <td class=\"weather-view-param\">{translate('precip')}</td>\r\n                <td class=\"weather-view-param-unit\">{translate('units.mm')}</td>\r\n            </tr>\r\n            <tr>\r\n                <td></td>\r\n                <td class=\"weather-view-param\">{translate('rh')}</td>\r\n                <td class=\"weather-view-param-unit\">%</td>\r\n            </tr>\r\n            <tr>\r\n                <td></td>\r\n                <td class=\"weather-view-param\">{translate('pressure')}</td>\r\n                <td class=\"weather-view-param-unit\">{translate('units.mmhg')}</td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class=\"weather-view-values\">\r\n        <table>\r\n            <tr>        \r\n                {#each days as d}\r\n                    <td colspan=\"{hours.length}\" class=\"weather-view-day weather-view-margin-cell\">\r\n                        {d && d.toLocaleDateString() || ''}\r\n                    </td>\r\n                {/each}                \r\n            </tr>\r\n            <tr>\r\n                {#each days as d, i}\r\n                    {#each hours as h, j}\r\n                        <td on:click=\"selectHour(d,h,i,j)\" class=\"weather-view-hour {j % hours.length === 0 ? 'weather-view-margin-cell' : 'weather-view-cell'}{ is_now(d, h) ? ' weather-view-now' : is_selected(hourIndex, i, j) ? ' weather-view-selected-hour' : '' }\">{h}</td>\r\n                    {/each}            \r\n                {/each}                            \r\n            </tr>\r\n            <tr>        \r\n                {#each tmp as t, i}\r\n                    <td class=\"{i % hours.length === 0 ? 'weather-view-margin-cell' : 'weather-view-cell'}\">{format_tmp(t)}</td>\r\n                {/each}                              \r\n            </tr>\r\n            <tr>        \r\n                {#each ws as s, i}\r\n                    <td class=\"{i % hours.length === 0 ? 'weather-view-margin-cell' : 'weather-view-cell'}\">{format_float(s)}</td>\r\n                {/each}                           \r\n            </tr>\r\n            <tr>        \r\n                {#each wd as d, i}\r\n                    <td class=\"{i % hours.length === 0? 'weather-view-margin-cell' : 'weather-view-cell'}\">{format_wd(d)}</td>\r\n                {/each}                \r\n            </tr>\r\n            <tr>        \r\n                {#each gust as g, i}\r\n                    <td class=\"{i % hours.length === 0 ? 'weather-view-margin-cell' : 'weather-view-cell'}\">{format_float(g)}</td>\r\n                {/each}                 \r\n            <tr>        \r\n                {#each apcp as a, i}\r\n                    <td class=\"{i % hours.length === 0 ? 'weather-view-margin-cell' : 'weather-view-cell'}\">{format_float(a)}</td>\r\n                {/each}                \r\n            </tr>\r\n            <tr>        \r\n                {#each rh as h, i}\r\n                    <td class=\"{i % hours.length === 0 ? 'weather-view-margin-cell' : 'weather-view-cell'}\">{format_float(h)}</td>\r\n                {/each}                \r\n            </tr>\r\n            <tr>        \r\n                {#each prmsl as p, i}\r\n                    <td class=\"{i % hours.length === 0 ? 'weather-view-margin-cell' : 'weather-view-cell'}\">{format_pressure(p)}</td>\r\n                {/each}                \r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n\r\n<style>    \r\n    .weather-view-params,\r\n    .weather-view-values {\r\n        display: inline-block;\r\n        vertical-align: top;\r\n        height: 270px;\r\n    }\r\n    \r\n    .weather-view-values .weather-view-margin-cell {\r\n        border-left: 1px solid #D8E1E8;\r\n    }\r\n    .weather-view-params,    \r\n    .weather-view-values tr:nth-child(1),\r\n    .weather-view-values tr:nth-child(2) {\r\n        background-color: #EBF1F5;\r\n    }\r\n    .weather-view-params tr:first-child td,\r\n    .weather-view-values tr:first-child td {\r\n        border-bottom: 1px solid #D8E1E8;\r\n    }\r\n    .weather-view-params td,\r\n    .weather-view-values td {\r\n        padding: 5px 3px 5px 3px;\r\n        white-space: nowrap;\r\n        text-align: center;\r\n        font-family: 'Roboto', sans-serif;\r\n        font-size: 12px;  \r\n        color: #738694;                              \r\n    }\r\n    .weather-view-params .weather-view-current-spot {            \r\n        color: #48AFF0;\r\n        text-align: center;\r\n    }\r\n    .weather-view-params .weather-view-current-spot i {\r\n        background-image: url('coords.png');\r\n        display: inline-block;               \r\n        background-repeat: no-repeat;\r\n        background-color: transparent;\r\n        width: 14px;\r\n        height: 17px;\r\n        margin-left: 15px;\r\n        vertical-align: middle;\r\n    }\r\n    .weather-view-params .weather-view-param {\r\n        text-align: left;\r\n        padding-left: 10px;\r\n    }\r\n    .weather-view-params .weather-view-param,\r\n    .weather-view-params .weather-view-param-unit {        \r\n        word-wrap: none;\r\n    }\r\n    .weather-view-params .weather-view-param-unit {    \r\n        color: #48AFF0;        \r\n        text-align: right;\r\n    }\r\n    .weather-view-values .weather-view-day {\r\n        text-align: center;\r\n        color: #394B59;        \r\n        width: 200px;        \r\n    }\r\n    .weather-view-values .weather-view-hour {\r\n        cursor: pointer;\r\n    }\r\n    .weather-view-values .weather-view-selected-hour {\r\n        color: white;\r\n        background-color: lightblue;\r\n    }\r\n    .weather-view-values .weather-view-now {\r\n        color: white;\r\n        background-color: #48AFF0;\r\n    }\r\n    .weather-view-params .weather-view-close {\r\n        cursor: pointer;        \r\n        text-align: left;\r\n        padding-left: 10px;\r\n    }\r\n    .weather-view-params .weather-view-close i {\r\n        background-image: url('delete.png');\r\n        width: 10px;\r\n        height: 10px;    \r\n        display: inline-block;               \r\n        background-repeat: no-repeat;\r\n        background-color: transparent;        \r\n    }    \r\n</style>\r\n\r\n<script>\r\n    \r\n    import {\r\n        get_task,\r\n        translate,\r\n        format_date,\r\n        format_coord,\r\n        format_float,\r\n        format_pressure,\r\n        format_tmp,\r\n        format_wd,\r\n        is_today,\r\n        is_now,\r\n        FORECAST_PERIOD_HOURS,\r\n        FORECAST_DAYS_NUMBER,\r\n        FORECAST_DAY_HOURS_NUMBER,\r\n        FORECAST_HOURS_STEP,\r\n        FORECAST_DAY_HOURS,\r\n        FORECAST_HOURS,\r\n        FORECAST_VECTOR,\r\n        MS_PER_HOUR,\r\n        WEATHER_LAYERS,\r\n        get_wms_now,\r\n        find_hour_index,\r\n    } from './Utils.js';       \r\n\r\n    const T = window.nsGmx.Translations;    \r\n    T.addText('rus', {\r\n        forecast: 'Прогноз',        \r\n        units: {\r\n            hours: 'Часы',        \r\n            d: '°C',\r\n            mm: 'мм',\r\n            ms: 'м/с',\r\n            mmhg: 'мм рт. ст.',\r\n        },                      \r\n    });\r\n\r\n    T.addText('eng', {    \r\n        forecast: 'Forecast',                  \r\n        units: {\r\n            hours: 'Hours',\r\n            d: '°C',\r\n            mm: 'mm',\r\n            ms: 'm/s',\r\n            mmhg: 'mmHg',\r\n        },        \r\n    });\r\n\r\n    const lpad = n => n < 10 ? `0${n}` : n;   \r\n    \r\n    const to_iso_date = date => `${date.getFullYear()}-${lpad(date.getMonth() + 1)}-${lpad (date.getDate())}`;\r\n\r\n    const create_time_line = features => {\r\n        return features.reduce ((a, f) => {\r\n            const {properties: {ts}} = f;\r\n            const date = new Date(ts * 1000);\r\n            const d = to_iso_date (date);\r\n            const h = date.getHours();\r\n            a[d] = a[d] || {};\r\n            a[d][h] = f;\r\n            return a;\r\n        }, {});\r\n    };\r\n    \r\n    const normalize_time = features => {      \r\n        const t = create_time_line (features);\r\n        return Object.keys(t).sort().reduce((v, k, i) => {\r\n            return Object.keys(t[k]).reduce((a, h) => {\r\n                for (let j = 0; j < FORECAST_DAY_HOURS_NUMBER; ++j) {\r\n                    const x = parseInt(h, 10);\r\n                    if (FORECAST_DAY_HOURS[j] === x) {\r\n                        a[i * FORECAST_DAY_HOURS_NUMBER + j] = t[k][h];\r\n                        break;\r\n                    }\r\n                    else if (FORECAST_DAY_HOURS[j] > x) {\r\n                        a[i * FORECAST_DAY_HOURS_NUMBER + j - 1] = t[k][h];\r\n                        break;\r\n                    }                    \r\n                }\r\n                return a;\r\n            }, v);\r\n        }, FORECAST_VECTOR.slice());\r\n    };\r\n\r\n    const get_param = (result, p) => {\r\n        for(let i = 0; i < result.length; ++i) {\r\n            let {param, features} = result[i];\r\n            if (param === p) {\r\n                return normalize_time (features);\r\n            }\r\n        }\r\n        return [];\r\n    };\r\n\r\n    const is_selected = (index, i, j) => {\r\n        return index === (i * FORECAST_DAY_HOURS_NUMBER + j);\r\n    };\r\n\r\n    const get_popup = ({active, tmp, ws, wd, apcp, prmsl, rh, hourIndex}) => {\r\n        const name = WEATHER_LAYERS[active];\r\n        let h = '';        \r\n        switch (name) {\r\n            case 'tmp':\r\n                return `<div><span>${format_tmp (tmp[hourIndex])}</span><span>${translate('units.d')}</span></div>`;\r\n            case 'wind':                                    \r\n                return `<div><span>${format_float (ws[hourIndex])}</span><span>${translate('units.ms')}</span><span>${format_wd(wd[hourIndex])}</span></div>`;\r\n            case 'precip':\r\n                return `<div><span>${format_float (apcp[hourIndex])}</span><span>${translate('units.mm')}</span></div>`;\r\n            case 'rh':\r\n                return `<div><span>${format_float (rh[hourIndex])}</span><span>%</span></div>`;\r\n            case 'pressure':\r\n                return `<div><span>${format_pressure (prmsl[hourIndex])}</span><span>${translate('units.mmhg')}</span></div>`;\r\n            case 'dewpoint':\r\n                break;\r\n            case 'cloud':\r\n                break;\r\n            default:\r\n                break;\r\n        }                                \r\n        return h;\r\n    };    \r\n\r\n    const get_initial_hour_index = (days, hours) => {\r\n        for (let i = 0, k = 0; i < days.length; ++i){\r\n            const d = days[i];\r\n            for (let j = 0; j < hours.length; ++j, ++k) {\r\n                const h = hours[j];\r\n                if (is_now(d,h)) {\r\n                    return k;\r\n                }\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n    \r\n    export default {      \r\n        data() {\r\n            return {\r\n                result: [],\r\n                hours: FORECAST_DAY_HOURS,\r\n                latLng: {lat: null, lng: null},\r\n                hourIndex: -1,\r\n            };\r\n        },\r\n        oncreate() {\r\n            const stop = e => e.stopPropagation();\r\n            this.refs.container.addEventListener('click', stop);\r\n            this.refs.container.addEventListener('mousewheel', stop);\r\n            this.refs.container.addEventListener('mousemove', stop);\r\n            const listener = this.store.on('state', ({changed: {mode}}) => {\r\n                if (mode) {\r\n                    this.hide();\r\n                    if (this._marker) {\r\n                        nsGmx.leafletMap.removeControl(this._marker);\r\n                    }\r\n                }                \r\n            });\r\n\r\n            this.on('destroy', listener.cancel);\r\n            const ctl = L.control.gmxIcon({\r\n                id: 'tl-cloud-cover',\r\n                togglable: true,\r\n                title: translate('forecast')\r\n            })\r\n            .on('statechange', ev => {\r\n                if (ev.target.options.isActive) {\r\n                    nsGmx.leafletMap.getContainer().style.cursor = 'crosshair';\r\n                    nsGmx.leafletMap.on ('click', calc);\r\n                }\r\n                else {\r\n                    nsGmx.leafletMap.off ('click', calc);\r\n                    nsGmx.leafletMap.getContainer().style.cursor = '';\r\n                    if (this._marker) {\r\n                        nsGmx.leafletMap.removeControl(this._marker);\r\n                    }\r\n                }\r\n            });\r\n\r\n            const calc = ev => {                \r\n                const {latlng: {lat, lng}} = ev;                \r\n                const { mode, moment, active } = this.store.get();                \r\n                if (mode && lat && lng) {                                   \r\n                    if (this._marker) {\r\n                        nsGmx.leafletMap.removeControl(this._marker);\r\n                    }\r\n                    const icon = L.divIcon({className: 'weather-view-marker'});\r\n                    this._marker = L.marker({lat, lng}, {icon});                        \r\n                    nsGmx.leafletMap.addControl(this._marker);\r\n                    nsGmx.widgets.notifications.startAction('WeatherView');                \r\n                    const tasks = ['temperature', 'wind', 'precipitation', 'pressure', 'humidity'].map(param => {\r\n                        return get_task ({mode, param, lat, lng, hours: FORECAST_PERIOD_HOURS});\r\n                    });                    \r\n                    Promise.all(tasks)\r\n                    .then (result => {\r\n                        nsGmx.widgets.notifications.stopAction('WeatherView', 'success');                                                            \r\n                        window.iconSidebarWidget.open(\"weather-pane\");\r\n\r\n                        this.set({result, latLng: {lat, lng}});\r\n\r\n                        if (0 <= active && active < WEATHER_LAYERS.length) { \r\n                            const {tmp, ws, wd, apcp, prmsl, rh, hourIndex, days, hours} = this.get();\r\n                            const i = hourIndex < 0 ? get_initial_hour_index(days, hours) : hourIndex;\r\n                            this._marker.bindPopup(get_popup ({active, tmp, ws, wd, apcp, prmsl, rh, hourIndex: i}), {className: 'weather-view-popup'}).openPopup();\r\n                        }                          \r\n                        this.show();\r\n                    })\r\n                    .catch(e => {       \r\n                        if (this._marker) {\r\n                            nsGmx.leafletMap.removeControl(this._marker);\r\n                        }                 \r\n                        console.log(e);                        \r\n                        this.set({result: []});\r\n                        nsGmx.widgets.notifications.stopAction('WeatherView', 'fail');                        \r\n                    }); \r\n                }\r\n\r\n                // nsGmx.leafletMap.off('click', calc);\r\n                // ctl.setActive(false);\r\n            };\r\n            nsGmx.leafletMap.addControl(ctl);\r\n        },\r\n        ondestroy() {\r\n            this.refs.container.removeEventListener('click');\r\n            this.refs.container.removeEventListener('mousewheel');\r\n            this.refs.container.removeEventListener('mousemove');\r\n        },\r\n        computed: {          \r\n            tmp: ({result}) => {   \r\n                return get_param(result, 'temperature').map(f => f && f.properties.tmp || null);\r\n            },\r\n            ws: ({wind}) => wind.wind,\r\n            wd: ({wind}) => wind.wd,\r\n            gust: ({wind}) => wind.gust,\r\n            apcp: ({result}) => {\r\n                return get_param (result, 'precipitation').map(f => f && f.properties.precip || null);\r\n            },\r\n            prmsl: ({result}) => {\r\n                return get_param (result, 'pressure').map(f => f && f.properties.pressure || null);\r\n            },\r\n            wind: ({result}) => {                \r\n                return get_param (result, 'wind').reduce((a, f) => {\r\n                    if (f) {\r\n                        const {properties: {wind, wd, gust}} = f;\r\n                        a.wind = a.wind.concat(wind);\r\n                        a.wd = a.wd.concat(wd);\r\n                        a.gust = a.gust.concat(gust);\r\n                    }\r\n                    else {\r\n                        a.wind = a.wind.concat(null);\r\n                        a.wd = a.wd.concat(null);\r\n                        a.gust = a.gust.concat(null);\r\n                    }\r\n                    return a;\r\n                }, {wind: [], wd: [], gust: []});\r\n            }, \r\n            rh: ({result}) =>  {\r\n                return get_param(result, 'humidity').map(f => f && f.properties.rh || null);\r\n            },\r\n            days: ({times}) => {\r\n                if (times.length > 0) {\r\n                    const ds = times.reduce((a, ts) => {\r\n                            const t = new Date(ts * 1000);\r\n                            const d = to_iso_date (t);\r\n                            a[d] = new Date(d);\r\n                            return a;\r\n                        }, {});\r\n                    return Object.keys(ds).map (k => ds[k]);\r\n                }\r\n                else {\r\n                    return new Array(FORECAST_DAYS_NUMBER);\r\n                }\r\n            },\r\n            times: ({result}) => {\r\n                return result.reduce((a,{features}) => {\r\n                    return features.reduce((b,{properties: {ts}}) => b.concat(ts), a);                    \r\n                }, []).sort();\r\n            },\r\n        },\r\n        methods: {\r\n            show () {\r\n                this.refs.container.style.display = 'flex';\r\n            },            \r\n            hide () {                \r\n                this.refs.container.style.display = 'none';\r\n            },\r\n            selectHour (day, hour, i, j) {\r\n                const { mode } = this.store.get();\r\n                const { latLng: {lat, lng} } = this.get();\r\n                const now = new Date(day.getFullYear(), day.getMonth(), day.getDate(), hour);\r\n                this.set({hourIndex: i * FORECAST_DAY_HOURS_NUMBER + j});\r\n                get_wms_now (mode, lat, lng, now)\r\n                .then(moment => {\r\n                    this.store.set({moment});\r\n                })\r\n                .catch(e => {\r\n                    console.log (e);\r\n                });                                                                \r\n            },\r\n        },\r\n        helpers: {\r\n            translate,\r\n            format_coord,\r\n            format_date,\r\n            format_tmp,\r\n            format_wd,\r\n            format_float,\r\n            format_pressure,\r\n            is_selected,\r\n            is_now,\r\n        },\r\n    };\r\n</script>","import Forecast from './Forecast.html';\r\nimport './ForecastControl.css';\r\n\r\nexport default L.Control.extend({\r\n    includes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n\r\n    initialize: function (options) {\r\n        L.setOptions(this, options);\r\n    },\r\n    \r\n    onAdd: function (map) {\r\n        this._container = L.DomUtil.create('div', 'weather-view');\r\n        this._container.addEventListener ('mousewheel', e => e.stopPropagation()); \r\n        this._widget = new Forecast({\r\n            target: this._container,\r\n            store: this.options.store,            \r\n        });\r\n        this._widget.hide();       \r\n        return this._container;\r\n    },        \r\n});","<div class=\"weather-view-layers\">\r\n    <div class=\"mode-selector\">\r\n        <label>{translate('mode')}</label>\r\n        <select bind:value=$mode>\r\n            {#each modes as x }\r\n                <option value=\"{x}\">{x.toUpperCase()}</option>\r\n            {/each}\r\n        </select>\r\n    </div>    \r\n    <ul>\r\n        {#each layers as x, i}\r\n            <li on:click=\"toggle(i)\">\r\n                <i class=\"layer-bullet{ i === $active ? ' layer-bullet-active' : ' layer-bullet-inactive' }\"></i>\r\n                <i class=\"layer-icon {i === $active ? `weather-view-${x}-active` : `weather-view-${x}-inactive`}\"></i>\r\n                <label class=\"layer-title{ i === $active ? ' layer-title-active' : '' }\">{translate(x)}</label>\r\n            </li>\r\n        {/each}\r\n    </ul>\r\n    {#if $active >= 0}\r\n    <div class=\"legend\">\r\n        <i class=\"{legend}\"></i>\r\n    </div>   \r\n    {/if}\r\n</div>\r\n\r\n<style>\r\n    .weather-view-layers * {\r\n        cursor: pointer; \r\n        color: #738694;\r\n        font-family: 'Roboto', sans-serif;\r\n        font-size: 14px;\r\n    }\r\n    .weather-view-layers .mode-selector {\r\n        background-color: #EBF1F5;        \r\n        padding: 30px 15px 30px 15px;\r\n    }\r\n    .weather-view-layers .mode-selector label,\r\n    .weather-view-layers .mode-selector select {\r\n        vertical-align: middle;\r\n    }    \r\n    .weather-view-layers .mode-selector select {\r\n        width: 205px;\r\n        height: 40px;\r\n        margin-left: 20px;\r\n    }\r\n    .weather-view-layers ul {        \r\n        padding: 20px 15px 15px 15px;\r\n        border: 1px solid #D8E1E8;\r\n        border-radius: 4px;\r\n    }\r\n    .weather-view-layers li {\r\n        padding: 5px 5px 5px 5px;\r\n    }\r\n    .weather-view-layers .layer-bullet,\r\n    .weather-view-layers .layer-icon {\r\n        display: inline-block;               \r\n        background-repeat: no-repeat;\r\n        background-color: transparent;\r\n        width: 16px;\r\n        height: 16px;\r\n        vertical-align: middle;\r\n    }\r\n    .weather-view-layers .layer-icon {\r\n        margin-left: 15px;\r\n    }\r\n    .weather-view-layers .layer-title {\r\n        margin-left: 5px;\r\n        vertical-align: middle;\r\n    }\r\n    .weather-view-layers .weather-view-tmp-inactive {\r\n        background-image: url('tmp.png');        \r\n    }\r\n    .weather-view-layers .weather-view-tmp-active {\r\n        background-image: url('tmp-active.png');        \r\n    }\r\n    .weather-view-layers .weather-view-wind-inactive {\r\n        background-image: url('wind.png');\r\n    }\r\n    .weather-view-layers .weather-view-wind-active {\r\n        background-image: url('wind-active.png');\r\n    }\r\n    .weather-view-layers .weather-view-precip-inactive {\r\n        background-image: url('precip.png');        \r\n    }\r\n    .weather-view-layers .weather-view-precip-active {\r\n        background-image: url('precip-active.png');        \r\n    }\r\n    .weather-view-layers .weather-view-gust-inactive {\r\n        background-image: url('gust.png');        \r\n    }\r\n    .weather-view-layers .weather-view-gust-active {\r\n        background-image: url('gust-active.png');\r\n    }\r\n    .weather-view-layers .weather-view-pressure-inactive {\r\n        background-image: url('pressure.png');        \r\n    }\r\n    .weather-view-layers .weather-view-pressure-active {\r\n        background-image: url('pressure-active.png');\r\n    }\r\n    .weather-view-layers .weather-view-cloud-inactive {\r\n        background-image: url('cloud.png');        \r\n    }\r\n    .weather-view-layers .weather-view-cloud-active {\r\n        background-image: url('cloud-active.png');        \r\n    }\r\n    .weather-view-layers .weather-view-rh-inactive {\r\n        background-image: url('rh.png');        \r\n    }\r\n    .weather-view-layers .weather-view-rh-active {\r\n        background-image: url('rh-active.png');        \r\n    }\r\n    .weather-view-layers .weather-view-dewpoint-inactive {\r\n        background-image: url('dewpoint.png');        \r\n    }\r\n    .weather-view-layers .weather-view-dewpoint-active {\r\n        background-image: url('dewpoint-active.png');\r\n    }\r\n    .weather-view-layers .layer-bullet-inactive {        \r\n        background-image: url('ellipse.png');        \r\n    }\r\n    .weather-view-layers .layer-bullet-active {        \r\n        background-image: url('ellipse-active.png');\r\n    }    \r\n    .weather-view-layers .layer-title-active {\r\n        color: #48AFF0;\r\n    }\r\n    .weather-view-layers ul,\r\n    .weather-view-layers .legend {\r\n        margin: 15px;\r\n    }\r\n    .weather-view-layers .legend-icon {\r\n        display: inline-block;               \r\n        background-repeat: no-repeat;\r\n        background-color: transparent;\r\n        width: 320px;\r\n        height: 80px;\r\n        vertical-align: middle;\r\n    }\r\n    .weather-view-layers .legend-tmp {\r\n        background-image: url('legend-tmp.png');\r\n    }\r\n    .weather-view-layers .legend-wind {\r\n        background-image: url('legend-wind.png');\r\n    }\r\n    .weather-view-layers .legend-precip {\r\n        background-image: url('legend-precip.png');\r\n    }\r\n    .weather-view-layers .legend-rh {\r\n        background-image: url('legend-rh.png');\r\n    }\r\n    .weather-view-layers .legend-pressure {\r\n        background-image: url('legend-pressure.png');\r\n    }\r\n    .weather-view-layers .legend-dewpoint {\r\n        background-image: url('legend-dewpoint.png');\r\n    }\r\n    .weather-view-layers .legend-cloud {\r\n        background-image: url('legend-cloud.png');\r\n    }\r\n</style>\r\n\r\n<script>\r\n    const T = window.nsGmx.Translations;    \r\n    import { \r\n        translate,\r\n        FORECAST_PERIOD_HOURS,\r\n        FORECAST_HOURS_STEP,\r\n        FORECAST_MODES,\r\n        FORECAST_HOURS,\r\n        WEATHER_LAYERS,\r\n        get_wms_now,\r\n        pad_left,\r\n    } from './Utils.js';\r\n\r\n    T.addText('rus', {\r\n        mode: 'Выбор модели',\r\n        now: 'Сейчас',\r\n    });\r\n\r\n    T.addText('eng', {\r\n        mode: 'Select model',\r\n        now: 'Now',\r\n    });\r\n    \r\n    const baseUrl = 'http://95.163.250.203:9898/maritime/v2.0/ogc/wms';\r\n    const format = 'image/png';\r\n\r\n    const pad = h => pad_left (h, '0', 3);\r\n\r\n    export default {\r\n        data () {\r\n            return {\r\n                modes: FORECAST_MODES,\r\n                layers: WEATHER_LAYERS,                            \r\n            };\r\n        },\r\n        computed: {\r\n            legend: ({$active}) => $active >= 0 ? `legend-icon legend-${WEATHER_LAYERS[$active]}` : ''\r\n        },\r\n        oncreate () {\r\n            this._layer = null;\r\n            const listener = this.store.on('state', state => {\r\n                const { current: { mode, active, moment } } = state;\r\n                if (this._layer) {\r\n                    nsGmx.leafletMap.removeLayer (this._layer);\r\n                }\r\n                if (0 <= active && active < WEATHER_LAYERS.length) {\r\n                    const name = WEATHER_LAYERS[active];\r\n                    if (moment < 0) {\r\n                        const {lat, lng} = nsGmx.leafletMap.getCenter();\r\n                        get_wms_now (mode, lat, lng, new Date())\r\n                        .then(moment => {\r\n                            const h = FORECAST_HOURS[moment].toString();\r\n                            this._layer = L.tileLayer.wms(`${baseUrl}/${mode}/${name}/${h}/`, { layers: `${name}_f${pad(h)}`, format, transparent: true });\r\n                            nsGmx.leafletMap.addLayer (this._layer);\r\n                        })\r\n                        .catch(e => console.log);\r\n                    }\r\n                    else {\r\n                        const h = FORECAST_HOURS[moment].toString();\r\n                        this._layer = L.tileLayer.wms(`${baseUrl}/${mode}/${name}/${FORECAST_HOURS[moment]}/`, { layers: `${name}_f${pad(h)}`, format, transparent: true });\r\n                        nsGmx.leafletMap.addLayer (this._layer);\r\n                    }                              \r\n                }\r\n            });\r\n            this.on('destroy', () => {\r\n                listener.cancel();\r\n            });\r\n        },\r\n        ondestroy () {            \r\n        },        \r\n        methods: {\r\n            toggle (index) {\r\n                const { active } = this.store.get();\r\n                if (index === active) {                    \r\n                    this.store.set({active: -1});\r\n                }\r\n                else {                    \r\n                    this.store.set({active: index});\r\n                }\r\n            }\r\n        },       \r\n        helpers: {            \r\n            translate,            \r\n        },\r\n    };\r\n</script>","import {\n\tassign,\n\tblankObject,\n\t_differs,\n\t_differsImmutable,\n\tget,\n\ton,\n\tfire\n} from './shared.js';\n\nfunction Store(state, options) {\n\tthis._handlers = {};\n\tthis._dependents = [];\n\n\tthis._computed = blankObject();\n\tthis._sortedComputedProperties = [];\n\n\tthis._state = assign({}, state);\n\tthis._differs = options && options.immutable ? _differsImmutable : _differs;\n}\n\nassign(Store.prototype, {\n\t_add(component, props) {\n\t\tthis._dependents.push({\n\t\t\tcomponent: component,\n\t\t\tprops: props\n\t\t});\n\t},\n\n\t_init(props) {\n\t\tconst state = {};\n\t\tfor (let i = 0; i < props.length; i += 1) {\n\t\t\tconst prop = props[i];\n\t\t\tstate['$' + prop] = this._state[prop];\n\t\t}\n\t\treturn state;\n\t},\n\n\t_remove(component) {\n\t\tlet i = this._dependents.length;\n\t\twhile (i--) {\n\t\t\tif (this._dependents[i].component === component) {\n\t\t\t\tthis._dependents.splice(i, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t},\n\n\t_set(newState, changed) {\n\t\tconst previous = this._state;\n\t\tthis._state = assign(assign({}, previous), newState);\n\n\t\tfor (let i = 0; i < this._sortedComputedProperties.length; i += 1) {\n\t\t\tthis._sortedComputedProperties[i].update(this._state, changed);\n\t\t}\n\n\t\tthis.fire('state', {\n\t\t\tchanged,\n\t\t\tprevious,\n\t\t\tcurrent: this._state\n\t\t});\n\n\t\tthis._dependents\n\t\t\t.filter(dependent => {\n\t\t\t\tconst componentState = {};\n\t\t\t\tlet dirty = false;\n\n\t\t\t\tfor (let j = 0; j < dependent.props.length; j += 1) {\n\t\t\t\t\tconst prop = dependent.props[j];\n\t\t\t\t\tif (prop in changed) {\n\t\t\t\t\t\tcomponentState['$' + prop] = this._state[prop];\n\t\t\t\t\t\tdirty = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (dirty) {\n\t\t\t\t\tdependent.component._stage(componentState);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t})\n\t\t\t.forEach(dependent => {\n\t\t\t\tdependent.component.set({});\n\t\t\t});\n\n\t\tthis.fire('update', {\n\t\t\tchanged,\n\t\t\tprevious,\n\t\t\tcurrent: this._state\n\t\t});\n\t},\n\n\t_sortComputedProperties() {\n\t\tconst computed = this._computed;\n\t\tconst sorted = this._sortedComputedProperties = [];\n\t\tconst visited = blankObject();\n\t\tlet currentKey;\n\n\t\tfunction visit(key) {\n\t\t\tconst c = computed[key];\n\n\t\t\tif (c) {\n\t\t\t\tc.deps.forEach(dep => {\n\t\t\t\t\tif (dep === currentKey) {\n\t\t\t\t\t\tthrow new Error(`Cyclical dependency detected between ${dep} <-> ${key}`);\n\t\t\t\t\t}\n\n\t\t\t\t\tvisit(dep);\n\t\t\t\t});\n\n\t\t\t\tif (!visited[key]) {\n\t\t\t\t\tvisited[key] = true;\n\t\t\t\t\tsorted.push(c);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const key in this._computed) {\n\t\t\tvisit(currentKey = key);\n\t\t}\n\t},\n\n\tcompute(key, deps, fn) {\n\t\tlet value;\n\n\t\tconst c = {\n\t\t\tdeps,\n\t\t\tupdate: (state, changed, dirty) => {\n\t\t\t\tconst values = deps.map(dep => {\n\t\t\t\t\tif (dep in changed) dirty = true;\n\t\t\t\t\treturn state[dep];\n\t\t\t\t});\n\n\t\t\t\tif (dirty) {\n\t\t\t\t\tconst newValue = fn.apply(null, values);\n\t\t\t\t\tif (this._differs(newValue, value)) {\n\t\t\t\t\t\tvalue = newValue;\n\t\t\t\t\t\tchanged[key] = true;\n\t\t\t\t\t\tstate[key] = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis._computed[key] = c;\n\t\tthis._sortComputedProperties();\n\n\t\tconst state = assign({}, this._state);\n\t\tconst changed = {};\n\t\tc.update(state, changed, true);\n\t\tthis._set(state, changed);\n\t},\n\n\tfire,\n\n\tget,\n\n\ton,\n\n\tset(newState) {\n\t\tconst oldState = this._state;\n\t\tconst changed = this._changed = {};\n\t\tlet dirty = false;\n\n\t\tfor (const key in newState) {\n\t\t\tif (this._computed[key]) throw new Error(`'${key}' is a read-only property`);\n\t\t\tif (this._differs(newState[key], oldState[key])) changed[key] = dirty = true;\n\t\t}\n\t\tif (!dirty) return;\n\n\t\tthis._set(newState, changed);\n\t}\n});\n\nexport { Store };\n","import { chain } from 'scanex-async';\r\nimport ForecastControl from './src/ForecastControl.js';\r\nimport LayerSwitch from './src/LayerSwitch.html';\r\nimport { Store } from 'svelte/store.js';\r\nimport { FORECAST_MODES } from './src/Utils.js'\r\n\r\nimport './src/fonts/fonts.css';\r\n\r\nconst T = window.nsGmx.Translations;    \r\nT.addText('rus', {    \r\n    layers: 'Параметры',\r\n    tmp: 'Температура',\r\n    wind: 'Скорость ветра',\r\n    direction: 'Направление ветра',\r\n    gust: 'Порывы ветра',\r\n    precip: 'Количество осадков',\r\n    pressure: 'Давление', \r\n    dewpoint: 'Температура точки росы',\r\n    rh: 'Относительная влажность',\r\n    cloud: 'Общая облачность',\r\n});\r\nT.addText('eng', {    \r\n    layers: 'Weather Params',\r\n    tmp: 'Temperature',\r\n    wind: 'Wind speed',\r\n    direction: 'Wind direction',\r\n    gust: 'Wind gust',\r\n    precip: 'Precipitation',\r\n    pressure: 'Pressure',\r\n    dewpoint: 'Dewpoint temperature',\r\n    rh: 'Relative humidity',\r\n    cloud: 'General cloudiness',\r\n});\r\n\r\nconst translate = T.getText.bind(T);\r\nconst store = new Store({mode: FORECAST_MODES[0], active: -1, moment: -1});\r\n\r\nconst add_weather_tab = state => new Promise (resolve => {\r\n    let target = window.iconSidebarWidget.setPane(\r\n        \"weather-pane\", {\r\n            createTab: window.createTabFunction({\r\n                icon: \"tl-cloud-cover\",\r\n                active: \"sidebar-icon-active\",\r\n                inactive: \"sidebar-icon-inactive\",\r\n                hint: translate('layers'),\r\n            })\r\n        }\r\n    );    \r\n    state.layerSwitch = new LayerSwitch({target, store});    \r\n    resolve(state);\r\n});\r\n\r\ngmxCore.addModule('WeatherView', {\r\n    pluginName: 'Weather View',\r\n    afterViewer: function(params, map){\r\n        gmxCore.loadCSS(`${gmxCore.getModulePath('WeatherView')}scanex-forecast.css`);\r\n        gmxCore.loadCSS(`${gmxCore.getModulePath('WeatherView')}scanex-weather-view.css`);\r\n        chain([add_weather_tab], {})\r\n        .then(state => {            \r\n            nsGmx.leafletMap.addControl(new ForecastControl({ position: 'bottom', store }));            \r\n        });\t    \r\n    },\r\n});"],"names":["noop","assign","tar","src","k","assignTrue","addLoc","element","file","line","column","char","__svelte_meta","run","fn","append","target","node","appendChild","insert","anchor","insertBefore","detachNode","parentNode","removeChild","destroyEach","iterations","detach","i","length","d","createElement","name","document","createText","data","createTextNode","addListener","event","handler","addEventListener","removeListener","removeEventListener","setData","text","selectOption","select","value","options","option","__value","selected","blankObject","Object","create","_differs","a","b","_differsImmutable","fire","eventName","handlers","this","_handlers","slice","__calling","call","flush","component","_lock","_beforecreate","_oncreate","_aftercreate","get","_state","init","_slots","_bind","_staged","root","store","on","push","index","indexOf","splice","callAll","fns","shift","removeFromStore","_remove","protoDev","destroy","set","_fragment","warn","newState","Error","_debugName","_checkReadOnly","_set","oldState","changed","dirty","key","_recompute","current","previous","p","T","window","nsGmx","Translations","translate","getText","bind","addText","get_task","mode","param","lat","lng","hours","Promise","resolve","reject","headers","Headers","request","Request","endPoint","then","response","json","features","code","catch","e","format_tmp","t","toFixed","format_float","s","format_wd","format_coord","latLng","Math","abs","normalize_lat","format_lng","x","normalize_lng","format_pressure","FORECAST_PERIOD_HOURS","FORECAST_DAYS_NUMBER","FORECAST_DAY_HOURS","j","FORECAST_HOURS","FORECAST_MODES","WEATHER_LAYERS","FORECAST_VECTOR","vect","len","is_now","h","n","Date","getHours","now","getFullYear","getMonth","getDate","is_today","get_wms_now","result","f","ts","properties","hour","find_hour_index","getTime","lpad","to_iso_date","date","normalize_time","reduce","create_time_line","keys","sort","v","parseInt","get_param","is_selected","get_popup","active","tmp","ws","wd","apcp","prmsl","rh","hourIndex","get_initial_hour_index","days","refs","container","style","display","day","moment","log","toLocaleDateString","createComment","g","selectHour","hide","gust","stop","stopPropagation","listener","_this2","_marker","leafletMap","removeControl","cancel","ctl","L","control","gmxIcon","ev","isActive","getContainer","cursor","calc","off","latlng","icon","divIcon","className","marker","addControl","widgets","notifications","startAction","tasks","map","all","stopAction","iconSidebarWidget","open","bindPopup","openPopup","show","wind","concat","precip","pressure","times","ds","Array","Control","extend","Evented","prototype","Mixin","Events","setOptions","_container","DomUtil","_widget","Forecast","baseUrl","format","pad","origin","str","width","sym","arr","charAt","string_to_array","join","toUpperCase","$active","legend","toggle","modes","selectedOption","querySelector","layers","$mode","_layer","state","_this","removeLayer","getCenter","toString","tileLayer","wms","transparent","addLayer","console","Store","_dependents","_computed","_sortedComputedProperties","immutable","props","prop","update","filter","componentState","dependent","_stage","forEach","computed","sorted","visited","currentKey","visit","c","deps","dep","values","newValue","apply","_sortComputedProperties","_changed","add_weather_tab","setPane","createTabFunction","layerSwitch","LayerSwitch","gmxCore","addModule","params","loadCSS","getModulePath","prev","next","ForecastControl","position"],"mappings":"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"}