{"version":3,"file":"main.js","sources":["../src/js/nsGmx.js","../src/js/gmxcore.js","../src/js/utilities.js","../src/js/translations.js","../src/js/lang_ru.js","../src/js/lang_en.js","../src/js/menu.js","../src/js/VirtualLayerManager.js","../src/js/PluginsManager.js","../src/js/drawingObjectsCustomControllers.js","../src/js/GroupEditor.js","../src/js/Controls.js","../src/js/ZoomPropertiesControl.js","../src/js/TinyMCEInit.js","../src/js/LayerStylesEditor.js","../src/js/userObjects.js","../src/js/queryTabs.js","../src/js/queryExternalMaps.js","../src/js/drawingObjects.js","../src/js/multiLayerEditor.js","../src/js/mapHelper.js","../src/js/AuthManager.js","../src/js/GmxWidget/GmxWidget.js","../src/js/DropdownMenuWidget/dropdownMenuWidget.js","../src/js/HeaderWidget/HeaderWidget.js","../src/js/LanguageWidget/languageWidget.js","../src/js/IconLayers/iconLayers.js","../src/js/Popover/popover.js","../src/js/GmxIconLayers/gmxIconLayers.js","../src/js/DateInterval/DateInterval.js","../src/js/CalendarWidget/CalendarWidget.js","../src/js/CalendarWidget-new/CalendarWidget.js","../src/js/CommonCalendarWidget/CommonCalendarWidget.js","../src/js/ClipboardController.js","../src/js/AsyncTaskManager.js","../src/js/AttrTable/DefaultSearchParamsManager.js","../src/js/AttrTable/ServerDataProvider.js","../src/js/AttrTable/SquareCalculation.js","../src/js/AttrTable/AttrTable.js","../src/js/Security/security.js","../src/js/contextMenuController.js","../src/js/version.js","../src/js/ScrollTableControl.js","../src/js/MapsManagerControl.js","../src/js/PluginsEditor/PluginsEditor.js","../src/js/NotificationWidget/NotificationWidget.js","../src/js/LayerTagsControl.js","../src/js/LayersManagerControl.js","../src/js/mapLayers.js","../src/js/AuthWidget/AuthWidget.js","../src/js/AuthWidget.js","../node_modules/scanex-event-target/dist/scanex-event-target.cjs.js","../node_modules/scanex-object-extensions/dist/scanex-object-extensions.cjs.js","../src/js/IconSidebarControl/src/IconSidebarWidget.js","../src/js/LayersTree.js","../src/js/SearchLogic/SearchLogic.js","../node_modules/leaflet-ext-search/dist/main.js","../src/js/SearchLogic/SearchProviders.js","../src/js/queryLoadShp.js","../src/js/loadServerData.js","../src/js/HeaderLinksControl.js","../src/js/TransparencySliderWidget/TransparencySliderWidget.js","../src/js/gmxLayers2/gmxLayers2.js","../node_modules/gmx-plugin-media/dist/main.js","../src/js/EditObjectControl/EditObjectControl.js","../src/js/ProfilePlugin/ProfilePlugin.js","../src/js/LayerEditor/LayerRasterCatalogWidget.js","../src/js/TemporalLayerParams.js","../src/js/QuicklookParams.js","../src/js/LayerProperties.js","../src/js/ShpEncodingWidget.js","../src/js/LayerEditor/TemporalLayerParamsWidget.js","../src/js/SuggestWidget/AttrSuggestWidget.js","../src/js/LayerEditor/LayerQuicklookWidget.js","../src/js/LayerEditor/ManualAttrModel.js","../src/js/LayerEditor/ManualAttrView.js","../src/js/fileBrowser.js","../src/js/tableBrowser.js","../src/js/LayerEditor.js","../src/js/mapCommon.js","../src/js/AttributeValuesProviders.js","../src/js/colorpicker/js/eye.js","../src/js/colorpicker/js/utils.js","../src/js/colorpicker/js/colorpicker.js","../src/js/GridPlugin/GridPlugin.js","../src/js/MapExport/MapExport.js","../src/js/BufferZones/BufferZones.js","../src/js/IndexGrid/IndexGrid.js","../src/js/PhotoLayer/PhotoLayer.js","../src/js/UserGroupWidget/UserGroupWidget.js","../src/js/Leaflet.Dialog/Leaflet.Dialog.js","../src/js/starter.js"],"sourcesContent":["let nsGmx = {};\r\nwindow.nsGmx = nsGmx;\r\nexport default nsGmx;","﻿import nsGmx from './nsGmx.js';\r\n\r\n/** Загрузчик модулей ГеоМиксера\r\nПозволяет загружать модули из разных файлов.\r\nМодуль - единица кода, имеющая уникальное имя и зависящая от других модулей и скриптов.\r\n@namespace\r\n*/\r\n\r\nvar gmxCore = function()\r\n{\r\n    var _callbacks = [];\r\n    var _modules = {}; //null - файл модуля уже загружается, но сам модуль пока не доступен\r\n    var _globalNamespace = this;\r\n\tvar _modulesDefaultHost = \"\";\r\n\tvar _modulePathes = {/*#buildinclude<modules_path.txt>*/};\r\n\tvar _moduleFiles = {/*#buildinclude<module_files.txt>*/};\r\n\r\n    var getScriptURL = function(scriptName)\r\n\t{\r\n        scriptName = scriptName.toLowerCase();\r\n\t\tvar scripts1 = document.getElementsByTagName(\"script\");\r\n\t\tfor (var i = 0; i < scripts1.length; i++)\r\n\t\t{\r\n\t\t\tvar src = scripts1[i].getAttribute(\"src\");\r\n\t\t\tif (src && (src.toLowerCase().indexOf(scriptName) != -1))\r\n\t\t\t\treturn src;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n    //производится регистронезависимое сравнение\r\n\tvar getScriptBase = function(scriptName)\r\n\t{\r\n        scriptName = scriptName.toLowerCase();\r\n\t\tvar url = getScriptURL(scriptName);\r\n\t\treturn url ? url.toLowerCase().substring(0, url.toLowerCase().indexOf(scriptName)) : \"\";\r\n\t}\r\n\r\n    var invokeCallbacks = function()\r\n    {\r\n        for (var k = 0; k < _callbacks.length; k++)\r\n        {\r\n            var isAllModules = true;\r\n            var curModules = _callbacks[k].modules;\r\n\t\t\tvar modules = [];\r\n            for (var m = 0; m < curModules.length; m++)\r\n\t\t\t{\r\n                if ( !_modules[curModules[m]] )\r\n                {\r\n                    isAllModules = false;\r\n                    break;\r\n                }\r\n\t\t\t\tmodules.push(_modules[curModules[m]]);\r\n\t\t\t}\r\n\r\n            if (isAllModules)\r\n            {\r\n                var curCallback = _callbacks[k].callback;\r\n\r\n                //first delete, then callback!\r\n                _callbacks.splice(k, 1);\r\n                k = k - 1;\r\n                curCallback.apply(null, modules);\r\n            }\r\n        }\r\n    }\r\n    var LABjsDeferred = null;\r\n    var lazyLoadLABjs = function()\r\n    {\r\n        if (!LABjsDeferred) {\r\n            LABjsDeferred = $.Deferred();\r\n\r\n            //load LAB.js (snippest from its website)\r\n            (function(g,b,d){var c=b.head||b.getElementsByTagName(\"head\"),D=\"readyState\",E=\"onreadystatechange\",F=\"DOMContentLoaded\",G=\"addEventListener\",H=setTimeout;\r\n            H(function(){if(\"item\"in c){if(!c[0]){H(arguments.callee,25);return}c=c[0]}var a=b.createElement(\"script\"),e=false;a.onload=a[E]=function(){if((a[D]&&a[D]!==\"complete\"&&a[D]!==\"loaded\")||e){return false}a.onload=a[E]=null;e=true;LABjsDeferred.resolve()};\r\n\r\n            a.src = ( getScriptBase('gmxcore.js') || window.gmxJSHost || \"\" ) + 'LAB.min.js';\r\n\r\n            c.insertBefore(a,c.firstChild)},0);if(b[D]==null&&b[G]){b[D]=\"loading\";b[G](F,d=function(){b.removeEventListener(F,d,false);b[D]=\"complete\"},false)}})(this,document);\r\n\r\n        }\r\n\r\n        return LABjsDeferred.promise();\r\n    }\r\n\r\n    var cssLoader = null;\r\n\r\n    var withCachePostfix = function(filename) {\r\n        var sym = filename.indexOf('?') === -1 ? '?' : '&';\r\n        if (window.gmxDropBrowserCache) {\r\n            filename += sym + Math.random();\r\n        } else if (window.nsGmx && nsGmx.buildGUID){\r\n            filename += sym + nsGmx.buildGUID;\r\n        }\r\n\r\n        return filename;\r\n    }\r\n\r\n    var publicInterface =\r\n    /** @lends gmxCore */\r\n    {\r\n        /** Добавить новый модуль\r\n        * @param {String} moduleName Уникальное имя модуля\r\n        * @param {Object|Function} moduleObj Тело модуля или ф-ция, возвращающая тело. Аргумент ф-ции - путь к модулю. Будет вызвана после загрузки всех зависимостей.\r\n        * @param {Object} [options] Дополнительные параметры модуля\r\n        * @param {String[]} [options.require] Какие модули должны быть загрежены перед данным\r\n        * @param {Function} [options.init] Ф-ция для инициализации модуля. Сигнатура: function (moduleObj, modulePath)->{void|{@link jQuery.Deferred}}. Если ф-ция возвращает {@link jQuery.Deferred}, загрузчик будет ждать его для окончания инициализации.\r\n        * @param {String|String[]} [options.css] CSS файлы для загрузки. Пути к CSS указываются относительно файла текущего модуля.\r\n        */\r\n        addModule: function(moduleName, moduleObj, options)\r\n        {\r\n            var requiredModules = (options && 'require' in options) ? options.require : [];\r\n            var initDeferred = null;\r\n            var _this = this;\r\n\r\n            for (var r = 0; r < requiredModules.length; r++)\r\n                this.loadModule( requiredModules[r] );\r\n\r\n            this.addModulesCallback( requiredModules, function()\r\n            {\r\n\r\n                if (options && 'init' in options)\r\n\t\t\t\t{\r\n                    initDeferred = options.init(moduleObj, _modulePathes[moduleName]);\r\n\t\t\t\t}\r\n\r\n                if (options && 'css' in options)\r\n\t\t\t\t{\r\n                    var cssFiles = typeof options.css === 'string' ? [options.css] : options.css;\r\n                    var path = _modulePathes[moduleName] || window.gmxJSHost || \"\";\r\n\r\n                    for (var iF = 0; iF < cssFiles.length; iF++)\r\n                        _this.loadCSS(withCachePostfix(path + cssFiles[iF]));\r\n\t\t\t\t}\r\n\r\n                var doAdd = function() {\r\n                    if (typeof moduleObj === 'function') {\r\n                        moduleObj = moduleObj( _modulePathes[moduleName] );\r\n                    }\r\n                    _modules[moduleName] = moduleObj;\r\n                    invokeCallbacks();\r\n                }\r\n\r\n                if (initDeferred) {\r\n                    initDeferred.done(doAdd);\r\n                } else {\r\n                    doAdd();\r\n                }\r\n            });\r\n        },\r\n\r\n        /** Загрузить модуль\r\n        * @param { String } moduleName Имя модуля для загрузки\r\n        * @param { String } [moduleSource] Имя файла, откуда загружать модуль. Если не указан, будет сформирован в виде (defaultHost + moduleName + '.js')\r\n        * @param { Function } [callback] Ф-ция, которая будет вызвана после загрузки и инициализации. В ф-цию первым параметром передаётся тело модуля\r\n        * @return { jQuery.Deferred } Promise, который будет resolve при загрузке модуля (параметр - модуль).\r\n        */\r\n        loadModule: function(moduleName, moduleSource, callback)\r\n        {\r\n            var def = $.Deferred();\r\n\r\n            if (typeof moduleSource === 'function') {\r\n                callback = moduleSource;\r\n                moduleSource = undefined;\r\n            }\r\n\r\n            this.addModulesCallback([moduleName], function(module)\r\n            {\r\n                callback && callback(module);\r\n                def.resolve(module);\r\n            });\r\n\r\n            if ( ! (moduleName in _modules) )\r\n            {\r\n                _modules[moduleName] = null;\r\n\r\n                var headElem = document.getElementsByTagName(\"head\")[0];\r\n                var newScript = document.createElement('script');\r\n\r\n                var path;\r\n                if (typeof moduleSource != 'undefined')\r\n                {\r\n                    path = moduleSource.match(new RegExp('^https?://', 'i')) ? moduleSource : (window.gmxJSHost || \"\") + moduleSource;\r\n                }\r\n                else\r\n                {\r\n                    path = (moduleName in _moduleFiles) ? _moduleFiles[moduleName] : (_modulesDefaultHost || window.gmxJSHost || \"\") + moduleName + '.js';\r\n                }\r\n\r\n                var pathRegexp = new RegExp('(.*)/[^/]+');\r\n                if ( typeof _modulePathes[moduleName] === 'undefined' )\r\n                    _modulePathes[moduleName] = pathRegexp.test(path) ? path.match(pathRegexp)[1] + \"/\" : \"\";\r\n\r\n                // var pathPostfix = \"\";\r\n\r\n                newScript.onerror = function() {\r\n                    def.reject();\r\n                }\r\n\r\n                newScript.type = 'text/javascript';\r\n                newScript.src = withCachePostfix(path);\r\n                newScript.charset = \"utf-8\";\r\n                headElem.appendChild(newScript);                \r\n            }\r\n\r\n            return def;\r\n        },\r\n\r\n        /** Добавить callback, который будет вызван после загрузки моделей\r\n        *\r\n        * Если модули уже загружены, callback будет вызван сразу же\r\n        *\r\n        * @param {Array} moduleNames Массив имён модулей\r\n        * @param {Function} callback Ф-ция, которую нужно вызвать после загрузки. В качестве аргументов в ф-цию передаются загруженные модули\r\n        */\r\n        addModulesCallback: function( moduleNames, callback )\r\n        {\r\n            _callbacks.push({modules: moduleNames, callback: callback});\r\n            invokeCallbacks();\r\n        },\r\n\r\n        /** Получить модуль по имени.\r\n        *\r\n        * @param {String} moduleName Имя модуля\r\n        * @return {Object} Тело модуля. Если модуль не загружен, вернётся null.\r\n        */\r\n        getModule: function(moduleName)\r\n        {\r\n            return _modules[moduleName] || null;\r\n        },\r\n\r\n        /** Установить дефольный путь к модулям. Используется если указан локальный файл модуля.\r\n        * @param {String} defaultHost Дефолтный путь у модулям.\r\n        */\r\n\t\tsetDefaultModulesHost: function( defaultHost )\r\n\t\t{\r\n\t\t\t_modulesDefaultHost = defaultHost;\r\n\t\t},\r\n\r\n        /** Явно задать полный путь к модулю\r\n        * @param {String} moduleName Имя модуля\r\n        * @param {String} defaultHost Путь к файлу модулю. При загрузке модуля будет загружен файл по указанному пути\r\n        */\r\n        setModuleFile: function(moduleName, moduleFile)\r\n        {\r\n            _moduleFiles[moduleName] = moduleFile;\r\n        },\r\n\r\n        pushModule2GlobalNamespace: function(moduleName)\r\n        {\r\n            if ( !_modules[moduleName] ) return;\r\n            var module = _modules[moduleName];\r\n\r\n            for (var p in module)\r\n                _globalNamespace[p] = module[p];\r\n        },\r\n\r\n        /** Получить путь к директории, из которой был загружен модуль.\r\n        * @param {String} moduleName Имя модуля\r\n        * @returns {String} Путь к директории, из которой был загружен модуль. Для не загруженных модулей ничего не возвращает\r\n        */\r\n\t\tgetModulePath: function(moduleName)\r\n\t\t{\r\n\t\t\treturn _modulePathes[moduleName];\r\n\t\t},\r\n\r\n        /** Возвращает ф-цию, которая делает следующее:\r\n        *\r\n        *  - Если модуль moduleName не загружен, загружает его\r\n        *  - Потом просто вызывает ф-цию с именем functionName из этого модуля, передав ей все свои параметры\r\n        *\r\n        *  - Возвращённая ф-ция при вызове возвращает jQuery.Promise, который будет resolve с параметрами, возвращёнными исходной ф-цией из модуля\r\n        * @param {String} moduleName Имя модуля\r\n        * @param {String} functionName Название ф-ции внутри модуля\r\n        * @param {Function} callback Ф-ция, которая будет вызвана после того, как отработает ф-ция модуля. В callback будет передан ответ исходной ф-ции.\r\n        */\r\n        createDeferredFunction: function(moduleName, functionName, callback)\r\n        {\r\n            var _this = this;\r\n            return function()\r\n            {\r\n                var deferred = $.Deferred();\r\n                var args = arguments;\r\n                _this.loadModule(moduleName).done(function(module)\r\n                {\r\n                    var res = module[functionName].apply(this, args);\r\n                    callback && callback(res);\r\n                    deferred.resolve(res);\r\n                });\r\n\r\n                return deferred.promise();\r\n            }\r\n        },\r\n\r\n        /** Загружает скрипт после предвариетельной проверки условий.\r\n        *\r\n        * @param {Array} filesInfo Массив объектов со следующими свойствами:\r\n        *\r\n        *   * check: function() -> Bool. Если возвращает true, ни js ни css не будет загружены\r\n        *   * script: String. Не обязательно. Скрипт для загрузки, если провалится проверка\r\n        *   * css: String | String[]. Не обязательно. CSS файл(ы) для загрузки, если провалится проверка\r\n        *   @returns {jQuery.Deferred} Deferred, который будет разрешён когда все скрипты выполнятся (окончание загрузки css не отслеживается)\r\n        */\r\n        loadScriptWithCheck: function(filesInfo)\r\n        {\r\n            var _this = this;\r\n            var localFilesInfo = filesInfo.slice(0);\r\n            var def = $.Deferred();\r\n\r\n            var doLoad = function() {\r\n                if (localFilesInfo.length > 0)\r\n                {\r\n                    var curInfo = localFilesInfo.shift();\r\n                    if (curInfo.check())\r\n                        doLoad()\r\n                    else\r\n                    {\r\n                        var css = curInfo.css || [];\r\n                        if (typeof css === 'string') {\r\n                            css = [css];\r\n                        }\r\n                        css.forEach(_this.loadCSS);\r\n\r\n                        if (curInfo.script)\r\n                            _this.loadScript(curInfo.script).then(doLoad);\r\n                        else\r\n                            doLoad();\r\n                    }\r\n                }\r\n                else\r\n                    def.resolve();\r\n            }\r\n\r\n            doLoad();\r\n            return def.promise();\r\n        },\r\n\r\n        /**\r\n        * Загружает отдельный скрипт\r\n        * @param {String} fileName Имя файла скрипта\r\n        * @param {function} [callback] Ф-ция, которая будет вызвана после загрузки\r\n        * @param {String} [charset=utf-8] Кодировка загружаемого файла\r\n        * @returns {jQuery.Deferred}\r\n        */\r\n        loadScript: function(fileName, callback, charset)\r\n        {\r\n            var def = $.Deferred();\r\n            lazyLoadLABjs().done(function()\r\n            {\r\n                var descr = {src: withCachePostfix(fileName)};\r\n                if (charset) {\r\n                    descr.charset = charset;\r\n                }\r\n\r\n                $LAB.script(descr).wait(function()\r\n                {\r\n                    def.resolve();\r\n                    callback && callback();\r\n                })\r\n            })\r\n            return def.promise();\r\n        },\r\n\r\n        /** Загрузить отдельный css файл\r\n        * @param {String} cssFilename Имя css файла.\r\n        */\r\n        loadCSS: function(cssFilename)\r\n        {\r\n            var doLoadCss = function()\r\n            {\r\n                $.getCSS(withCachePostfix(cssFilename));\r\n            }\r\n\r\n            if ('getCSS' in $)\r\n            {\r\n                doLoadCss()\r\n            }\r\n            else\r\n            {\r\n                if (!cssLoader)\r\n                {\r\n                    var path = getScriptBase('gmxcore.js') || window.gmxJSHost || \"\";\r\n                    cssLoader = $.getScript(path + \"jquery/jquery.getCSS.js\");\r\n                }\r\n\r\n                cssLoader.done(doLoadCss);\r\n            }\r\n        }\r\n    }\r\n\r\n    return publicInterface;\r\n}();\r\n\r\nwindow.gmxCore = gmxCore;","import nsGmx from './nsGmx.js';\r\nimport './gmxcore.js';\r\n\r\nnsGmx.Utils = nsGmx.Utils || {};\r\nvar domManipulation = {\r\n    // _el(nodeName, [childs], [attrs])\r\n    _el: function(str, childs, attributes)\r\n    {\r\n        var el = document.createElement(str),\r\n            children = childs,\r\n            attrs = attributes;\r\n\r\n        if (children)\r\n            domManipulation._childs(el, children)\r\n\r\n        if (attrs && attrs.length)\r\n            domManipulation._attr(el, attrs)\r\n\r\n        return el;\r\n    },\r\n    // _t(\"some text\")\r\n    _t: function(str)\r\n    {\r\n        return document.createTextNode(String(str));\r\n    },\r\n    // children - всегда массив\r\n    _childs: function(el, children)\r\n    {\r\n        for (var i = 0; i < children.length; ++i)\r\n            el.appendChild(children[i]);\r\n    },\r\n    //[['css','width','100%']]\r\n    //[['dir','className','name']]\r\n    //[['attr','colSpan',2]]\r\n    _attr: function(el, attrs)\r\n    {\r\n        for (var i = 0; i < attrs.length; ++i)\r\n        {\r\n            var atr = attrs[i],\r\n                type = atr[0];\r\n\r\n            switch (type) {\r\n                case 'css':\r\n                    (el.style[atr[1]] = atr[2]);\r\n                    break;\r\n                case 'dir':\r\n                    el[atr[1]] = atr[2];\r\n                    break;\r\n                case 'attr':\r\n                    el.setAttribute(atr[1], atr[2]);\r\n                    break;\r\n            }\r\n        }\r\n    },\r\n    _table: function(children,attrs){return _el('TABLE',children,attrs)},\r\n    _caption: function(children,attrs){return _el('CAPTION',children,attrs)},\r\n    _thead: function(children,attrs){return _el('THEAD',children,attrs)},\r\n    _tbody: function(children,attrs){return _el('TBODY',children,attrs)},\r\n    _tfoot: function(children,attrs){return _el('TFOOT',children,attrs)},\r\n    _textarea: function(children,attrs){return _el('TEXTAREA',children,attrs)},\r\n    _th: function(children,attrs){return _el('TH',children,attrs);} ,\r\n    _tr: function(children,attrs){return _el('TR',children,attrs);},\r\n    _td: function(children,attrs){return _el('TD',children,attrs);},\r\n    _span: function(children,attrs){return _el('SPAN',children,attrs);},\r\n    _label: function(children,attrs){return _el('LABEL',children,attrs);},\r\n    _li: function(children,attrs){return _el('LI',children,attrs);},\r\n    _ul: function(children,attrs){return _el('UL',children,attrs);},\r\n    _div: function(children,attrs){return _el('DIV',children,attrs);},\r\n    _radio: function(attrs){return _el('INPUT',null,(attrs&&attrs.concat([['attr','type','radio']]))||[['attr','type','radio']])},\r\n    _button: function(children,attrs){return _el('BUTTON',children,attrs)},\r\n    _a: function(children,attrs){return _el('A',children,attrs)},\r\n    _select: function(children,attrs){return _el('SELECT',children,attrs)},\r\n    _option: function(children,attrs){return _el('OPTION',children,attrs);},\r\n    _form: function(children,attrs){return _el('FORM',children,attrs)},\r\n    _iframe: function(children,attrs){return _el('IFRAME',children,attrs)},\r\n    _image: function(children,attrs){return _el('IMG',children,attrs)},\r\n    _img: function(children,attrs){return _el('IMG',children,attrs)},\r\n    _br: function(){return _el('BR')},\r\n    _hr: function(){return _el('HR')},\r\n    _p: function(children,attrs){return _el('P',children,attrs)},\r\n    _b: function(children,attrs){return _el('B',children,attrs)},\r\n    _i: function(children,attrs){return _el('I',children,attrs)},\r\n    _input: function(children,attrs){return _el('INPUT',children,attrs)}\r\n}\r\n\r\nvar _el = domManipulation._el;\r\n\r\n// _(elem, [childs], [attrs])\r\nvar _ = function(ent,childs,attributes)\r\n{\r\n    var el = ent,\r\n        children = childs,\r\n        attrs = attributes;\r\n\r\n    if (children)\r\n        domManipulation._childs(el, children)\r\n\r\n    if (attrs && attrs.length)\r\n        domManipulation._attr(el, attrs)\r\n\r\n    return el;\r\n};\r\n\r\nvar prevGlobals = {};\r\nfor (var k in domManipulation) {\r\n    prevGlobals[k] = window[k];\r\n}\r\n\r\n/** Удаляет из глобальной видимости часть методов, записанных туда при загрузке utilities.js\r\n* @memberOf nsGmx.Utils\r\n*/\r\nnsGmx.Utils.noConflicts = function() {\r\n    for (var k in domManipulation) {\r\n        window[k] = prevGlobals[k];\r\n    }\r\n    return nsGmx.Utils;\r\n}\r\n\r\njQuery.extend(window, domManipulation);      //для обратной совместимости\r\njQuery.extend(nsGmx.Utils, domManipulation);\r\nnsGmx.Utils._ = _;\r\n\r\nif (window.Node && window.Node.prototype)\r\n{\r\n    Node.prototype.removeNode = function()\r\n    {\r\n        var parent = this.parentNode;\r\n        parent && parent.removeChild(this);\r\n    }\r\n}\r\n\r\nfunction getkey(e)\r\n{\r\n    if (window.event)\r\n        return window.event.keyCode;\r\n    else if (e)\r\n        return e.which;\r\n    else\r\n        return null;\r\n}\r\n\r\nfunction show(elem)\r\n{\r\n    elem.style.display = '';\r\n}\r\nfunction hide(elem)\r\n{\r\n    elem.style.display = 'none';\r\n}\r\nfunction hidden(elem)\r\n{\r\n    elem.style.visibility = 'hidden';\r\n}\r\nfunction visible(elem)\r\n{\r\n    elem.style.visibility = 'visible';\r\n}\r\nfunction switchSelect(sel, value)\r\n{\r\n    if (!sel.options || !sel.options.length)\r\n        return sel;\r\n\r\n    for (var i = 0; i < sel.options.length; i++)\r\n    {\r\n        if (value == sel.options[i].value)\r\n        {\r\n            sel.options[i].selected = true;\r\n\r\n            sel.selectedIndex = i;\r\n\r\n            break;\r\n        }\r\n    }\r\n\r\n    return sel;\r\n}\r\nfunction parseColor(str) {\r\n    var res = 0xffffff;\r\n    if (!str)\r\n        return res;\r\n    else\r\n    {\r\n        var components = str.split(\" \");\r\n        if (components.length == 1)\r\n            return parseInt(\"0x\" + str);\r\n        else if (components.length == 3)\r\n            return parseInt(components[0])*0x10000 + parseInt(components[1])*0x100 + parseInt(components[2]);\r\n        else\r\n            return res;\r\n    }\r\n}\r\n\r\nfunction objLength(obj)\r\n{\r\n    var cnt = 0;\r\n    for (var field in obj) cnt++;\r\n\r\n    return cnt;\r\n}\r\nfunction valueInArray(arr, value)\r\n{\r\n    for (var i = 0; i < arr.length; i++)\r\n        if (arr[i] == value)\r\n            return true;\r\n\r\n    return false;\r\n}\r\nfunction getOffsetRect(elem)\r\n{\r\n    var box = elem.getBoundingClientRect(),\r\n        body = document.body,\r\n        docElem = document.documentElement,\r\n        scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\r\n        scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\r\n        clientTop = docElem.clientTop || body.clientTop || 0,\r\n        clientLeft = docElem.clientLeft || body.clientLeft || 0,\r\n        top  = box.top +  scrollTop - clientTop,\r\n        left = box.left + scrollLeft - clientLeft;\r\n\r\n    return { top: Math.round(top), left: Math.round(left) }\r\n}\r\nfunction attachEffects(elem, className)\r\n{\r\n    elem.onmouseover = function()\r\n    {\r\n        jQuery(this).addClass(className)\r\n    }\r\n    elem.onmouseout = function(e)\r\n    {\r\n        var evt = e || window.event,\r\n            // target = evt.srcElement || evt.target,\r\n            relTarget = evt.relatedTarget || evt.toElement;\r\n\r\n        try\r\n        {\r\n            while (relTarget)\r\n            {\r\n                if (relTarget == elem)\r\n                    return;\r\n                relTarget = relTarget.parentNode;\r\n            }\r\n\r\n            jQuery(elem).removeClass(className)\r\n        }\r\n        catch (e)\r\n        {\r\n            jQuery(elem).removeClass(className)\r\n        }\r\n    }\r\n}\r\nfunction makeButton(value, id)\r\n{\r\n    var inp = _input(null, [['dir','className','btn'],['attr','type','submit'],['attr','value',value]]);\r\n    if (typeof id != 'undefined' && id != null)\r\n        inp.id = id;\r\n\r\n    inp.style.padding = '0px 5px';\r\n\r\n    return inp;\r\n}\r\nfunction makeImageButton(url, urlHover)\r\n{\r\n    var btn = _img();\r\n    btn.setAttribute('src',url)\r\n    btn.style.cursor = 'pointer';\r\n    btn.style.border = 'none';\r\n\r\n    if (urlHover)\r\n    {\r\n        btn.onmouseover = function()\r\n        {\r\n            this.setAttribute('src', urlHover);\r\n        }\r\n        btn.onmouseout = function()\r\n        {\r\n            this.setAttribute('src', url);\r\n        }\r\n    }\r\n\r\n    return btn;\r\n}\r\nfunction makeLinkButton(text)\r\n{\r\n    var span = _span([_t(String(text))],[['dir','className','buttonLink']]);\r\n\r\n    attachEffects(span, 'buttonLinkHover')\r\n\r\n    return span;\r\n}\r\n\r\n// function makeHelpButton(helpText){\r\n//  var btn = makeImageButton(window.gmxAPI.getAPIHostRoot() + 'api/img/help.gif');\r\n//  btn.setAttribute('title', helpText)\r\n//  btn.onclick = function(){\r\n//      showDialog('', _t(helpText), 300, 150);\r\n//  }\r\n//  return btn;\r\n// }\r\n\r\nfunction getOwnChildNumber(elem)\r\n{\r\n    for (var i = 0; i < elem.parentNode.childNodes.length; i++)\r\n        if (elem == elem.parentNode.childNodes[i])\r\n            return i;\r\n}\r\nfunction stopEvent(e)\r\n{\r\n    if (!e) e = window.event;\r\n\r\n    //e.cancelBubble is supported by IE - this will kill the bubbling process.\r\n    e.cancelBubble = true;\r\n    e.returnValue = false;\r\n\r\n    //e.stopPropagation works only in Firefox.\r\n    if (e.stopPropagation)\r\n    {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n    }\r\n    return false;\r\n}\r\n\r\n//Показывает диалог (на основе jQuery UI dialog)\r\n//Параметры можно передавать явно и в виде объекта params:\r\n//1. showDialog(title, content, width, height, ?posX, ?posY, ?resizeFunc, ?closeFunc)\r\n//2. showDialog(title, content, params)\r\n//Параметры:\r\n// - title {string} Заголовок диалога\r\n// - content {HTMLDomElement} контент диалога\r\n// - width, height {int} высота и ширина диалога (обязательные параметры!)\r\n// - posX, posY {int} положение диалога относительно экрана. Если не задано - по центру\r\n// - resizeFunc {function} будет вызываться при изменении размера диалога. Аргумент ф-ции - объект с атриубтами width и height\r\n// - closeFunc {function} будет вызываться при закрытии диалога\r\n// - setMinSize {bool} если true (по умолчанию), будут заданы минимальная ширина и высота, равные начальным размерам (width, height)\r\nfunction showDialog(title, content, width, height, posX, posY, resizeFunc, closeFunc)\r\n{\r\n    var params = null;\r\n    if (arguments.length == 3)\r\n    {\r\n        params = $.extend({\r\n            posX: false,\r\n            posY: false,\r\n            setMinSize: true\r\n        }, width);\r\n    }\r\n    else\r\n    {\r\n        params = {\r\n            width: width,\r\n            height: height,\r\n            posX: posX,\r\n            posY: posY,\r\n            resizeFunc: resizeFunc,\r\n            closeFunc: closeFunc,\r\n            setMinSize: true\r\n        }\r\n    }\r\n    var canvas = _div([content]);\r\n\r\n    document.body.appendChild(canvas);\r\n\r\n    var dialogParams = {\r\n        width: params.width,\r\n        height: params.height,\r\n        title: title,\r\n        position: params.posX == false ? 'center' : [params.posX, params.posY],\r\n        resizable: true,\r\n        resize: function(event, ui)\r\n        {\r\n            params.resizeFunc && params.resizeFunc(ui.size);\r\n        },\r\n        close: function()\r\n        {\r\n            if (params.closeFunc && params.closeFunc())\r\n                return;\r\n\r\n            removeDialog(canvas);\r\n        },\r\n        open: function () {\r\n        },\r\n        closeText: null\r\n    };\r\n\r\n    if (params.setMinSize)\r\n    {\r\n        dialogParams.minWidth = params.width;\r\n        dialogParams.minHeight = params.height;\r\n    }\r\n\r\n    jQuery(canvas).dialog(dialogParams);\r\n\r\n    var dialog = canvas.parentNode;\r\n    dialog.style.overflow = '';\r\n\r\n    $(dialog).focusout(function (event) {\r\n\r\n        event.stopImmediatePropagation();\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n        jQuery.support.focusinBubbles = false;\r\n        var ui = $('.ui-dialog-content', this);\r\n            ui.context.st = $(ui).scrollTop();\r\n\r\n    });\r\n\r\n    $(dialog).focusin(function() {\r\n        var uis = $('.ui-dialog-content');\r\n\r\n        $(uis).each(function() {\r\n            var st = $(this).context.st;\r\n            $(this).scrollTop(st);\r\n        });\r\n\r\n    });\r\n\r\n\r\n    jQuery(dialog).children(\"div.ui-resizable-se\").removeClass(\"ui-icon\")\r\n                .removeClass(\"ui-icon-gripsmall-diagonal-se\")\r\n                .removeClass(\"ui-icon-grip-diagonal-se\");\r\n\r\n    return canvas;\r\n}\r\n\r\nfunction removeDialog(canvas)\r\n{\r\n    jQuery(canvas).dialog('destroy').remove();\r\n}\r\n\r\nfunction showErrorMessage(message, removeFlag, title)\r\n{\r\n    var canvas = _div([_t(message)],[['dir','className','errorDialog']]);\r\n    var jQueryDiv = showDialog(title || \"Ошибка!\", canvas, {\r\n            width: 250,\r\n            height: 150,\r\n            closeFunc: function(){\r\n                canvas = null;\r\n            }\r\n        });\r\n\r\n    if (removeFlag)\r\n    {\r\n        setTimeout(function()\r\n        {\r\n            if (canvas)\r\n            {\r\n                jQuery(jQueryDiv).dialog(\"destroy\");\r\n                jQuery(canvas.parentNode).remove();\r\n            }\r\n        }, 2500)\r\n    }\r\n}\r\n\r\nfunction _checkbox(flag, type, name)\r\n{\r\n    var box = _input(null, [['attr','type',type]]);\r\n    box.checked = flag;\r\n\r\n    if (name)\r\n        box.setAttribute('name', name);\r\n\r\n    return box;\r\n}\r\n\r\nfunction insertAtCursor(myField, myValue, sel)\r\n{\r\n    if (myField.id && window.tinyMCE && tinyMCE.get(myField.id)) {\r\n        tinyMCE.execInstanceCommand(myField.id, \"mceInsertContent\", false, myValue);\r\n        return;\r\n    }\r\n\r\n    if (document.selection)\r\n    {\r\n        if (typeof sel != 'undefined')\r\n            sel.text = myValue;\r\n        else\r\n        {\r\n            myField.focus();\r\n            sel = document.selection.createRange();\r\n            sel.text = myValue;\r\n        }\r\n    }\r\n    else if (myField.selectionStart || myField.selectionStart == '0')\r\n    {\r\n        var startPos = myField.selectionStart,\r\n            endPos = myField.selectionEnd;\r\n\r\n        myField.value = myField.value.substring(0, startPos) + myValue + myField.value.substring(endPos, myField.value.length);\r\n    }\r\n    else\r\n        myField.value += myValue;\r\n}\r\n\r\n/* ----------------------------- */\r\n// function sendRequest(url, callback, body)\r\n// {\r\n//  var xmlhttp;\r\n//  if (typeof XMLHttpRequest != 'undefined')\r\n//      xmlhttp = new XMLHttpRequest();\r\n//  else\r\n//      try { xmlhttp = new ActiveXObject(\"Msxml2.XMLHTTP\"); }\r\n//      catch (E) { try {xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\"); } catch (e) { console.log(e); }}\r\n\r\n//  xmlhttp.open(body ? \"POST\" : \"GET\", url, true);\r\n//  if (body)\r\n//  {\r\n//      xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n//      xmlhttp.setRequestHeader('Content-length', body.length);\r\n//  }\r\n//  xmlhttp.onreadystatechange = function() { if (xmlhttp.readyState == 4) callback(xmlhttp); }\r\n//  xmlhttp.send(body || \"\");\r\n// }\r\n\r\n// function sendJSONRequest(url, callback)\r\n// {\r\n//  sendRequest(url, function(xmlhttp)\r\n//  {\r\n//      var text = xmlhttp.responseText;\r\n//      callback(JSON.parse(text));\r\n//  });\r\n// }\r\n\r\nnsGmx.Utils.uniqueGlobalName = (function()\r\n{\r\n    var freeid = 0;\r\n    return function(thing)\r\n    {\r\n        var id = 'gmx_unique_' + freeid++;\r\n        window[id] = thing;\r\n        return id;\r\n    }\r\n})();\r\n\r\n/** Посылает кросс-доменный GET запрос к серверу с использованием транспорта JSONP.\r\n *\r\n * @memberOf nsGmx.Utils\r\n * @param {String} url URL сервера.\r\n * @param {Function} callback Ф-ция, которая будет вызвана при получении от сервера результата.\r\n * @param {String} [callbackParamName=CallbackName] Имя параметра для задания имени ф-ции ответа.\r\n * @param {Function} [errorCallback] Ф-ция, которая будет вызвана в случае ошибки запроса к серверу\r\n */\r\nfunction sendCrossDomainJSONRequest(url, callback, callbackParamName, errorCallback)\r\n{\r\n    callbackParamName = callbackParamName || 'CallbackName';\r\n\r\n    var script = document.createElement(\"script\");\r\n    script.setAttribute(\"charset\", \"UTF-8\");\r\n    var callbackName = nsGmx.Utils.uniqueGlobalName(function(obj)\r\n    {\r\n        callback && callback(obj);\r\n        window[callbackName] = false;\r\n        document.getElementsByTagName(\"head\").item(0).removeChild(script);\r\n    });\r\n\r\n    var sepSym = url.indexOf('?') == -1 ? '?' : '&';\r\n\r\n    if (errorCallback) {\r\n        script.onerror = errorCallback;\r\n    }\r\n\r\n    script.setAttribute(\"src\", url + sepSym + callbackParamName + \"=\" + callbackName + \"&\" + Math.random());\r\n    document.getElementsByTagName(\"head\").item(0).appendChild(script);\r\n}\r\nnsGmx.Utils.sendCrossDomainJSONRequest = sendCrossDomainJSONRequest;\r\n\r\nfunction createCookie(name, value, days)\r\n{\r\n    var expires = '';\r\n    if (days)\r\n    {\r\n        var date = new Date();\r\n        date.setTime(date.getTime() + (days*24*60*60*1000));\r\n        expires = \"; expires=\" + date.toGMTString();\r\n    }\r\n    document.cookie = name + \"=\" + value + expires + \"; path=/\";\r\n}\r\n\r\nfunction readCookie(name)\r\n{\r\n    var nameEQ = name + \"=\";\r\n    var ca = document.cookie.split(';');\r\n    for (var i = 0; i < ca.length; i++)\r\n    {\r\n        var c = ca[i];\r\n        while (c.charAt(0)==' ')\r\n            c = c.substring(1, c.length);\r\n        if (c.indexOf(nameEQ) == 0)\r\n            return c.substring(nameEQ.length, c.length);\r\n    }\r\n    return null;\r\n}\r\n\r\nfunction eraseCookie(name)\r\n{\r\n    createCookie(name, \"\", -1);\r\n}\r\n\r\nfunction getWindowWidth()\r\n{\r\n    var myWidth = 0;\r\n\r\n    if (typeof (window.innerWidth) == 'number')\r\n        myWidth = window.innerWidth;\r\n    else if (document.documentElement && (document.documentElement.clientWidth || document.documentElement.clientHeight))\r\n        myWidth = document.documentElement.clientWidth;\r\n    else if (document.body && (document.body.clientWidth || document.body.clientHeight))\r\n    {\r\n        myWidth = document.body.clientWidth;\r\n    }\r\n\r\n    return myWidth;\r\n}\r\n\r\nfunction getWindowHeight()\r\n{\r\n    var myHeight = 0;\r\n\r\n    if (typeof (window.innerWidth) == 'number' )\r\n        myHeight = window.innerHeight;\r\n    else if (document.documentElement && (document.documentElement.clientWidth || document.documentElement.clientHeight))\r\n        myHeight = document.documentElement.clientHeight;\r\n    else if (document.body && (document.body.clientWidth || document.body.clientHeight))\r\n        myHeight = document.body.clientHeight;\r\n\r\n    return myHeight;\r\n}\r\n\r\nfunction strip(s)\r\n{\r\n    return s.replace(/^\\s*/, \"\").replace(/\\s*$/, \"\");\r\n}\r\n\r\n(function() {\r\n    var replacements = {};\r\n    var temp;\r\n    for (var rus in (temp = {\r\n        \"qwertyuiopasdfghjklzxcvbnm_1234567890\" :\r\n        \"qwertyuiopasdfghjklzxcvbnm_1234567890\",\r\n        \"абвгдезийклмнопрстуфыэ \":\r\n        \"abvgdeziyklmnoprstufye_\",\r\n        \"ёжчхцшщюя\":\r\n        \"yozhchkhtsshshyuya\",\r\n        \"ьъ\":\r\n        \"\",\r\n        \".\":\r\n        \".\"\r\n    }))\r\n    {\r\n        var eng = temp[rus],\r\n            k = eng.length/rus.length;\r\n        for (var i = 0; i < rus.length; i++)\r\n        {\r\n            var r = rus.substring(i, i + 1),\r\n                e = eng.substring(i*k, (i + 1)*k);\r\n            replacements[r] = e;\r\n            replacements[r.toUpperCase()] = e.toUpperCase();\r\n        }\r\n    }\r\n\r\n    nsGmx.Utils.translit = function(name)\r\n    {\r\n        var result = \"\";\r\n        for (var i = 0; i < name.length; i++)\r\n            result += (replacements[name.substring(i, i + 1)] || \"\");\r\n\r\n        return result;\r\n    }\r\n})();\r\n\r\nfunction loadFunc(iframe, callback)\r\n{\r\n    var win = iframe.contentWindow;\r\n\r\n    //skip first onload in safari\r\n    if ( jQuery.browser.safari && !iframe.safariSkipped)\r\n    {\r\n        iframe.safariSkipped = true;\r\n        return;\r\n    }\r\n\r\n    if (iframe.loaded)\r\n    {\r\n        var data = decodeURIComponent(win.name.replace(/\\n/g,'\\n\\\\'));\r\n        jQuery(iframe).remove();\r\n\r\n        var parsedData;\r\n        try\r\n        {\r\n            parsedData = JSON.parse(data)\r\n        }\r\n        catch (e)\r\n        {\r\n            parsedData = {Status:\"error\",ErrorInfo: {ErrorMessage: \"JSON.parse exeption\", ExceptionType:\"JSON.parse\", StackTrace: data}}\r\n        }\r\n\r\n        callback && callback(parsedData);\r\n    }\r\n    else\r\n    {\r\n        win.location = 'about:blank';\r\n        iframe.loaded = true;\r\n    }\r\n\r\n}\r\n\r\nfunction createPostIframe(id, callback)\r\n{\r\n    // var userAgent = navigator.userAgent.toLowerCase(),\r\n    var callbackName = nsGmx.Utils.uniqueGlobalName(function()\r\n    {\r\n        loadFunc(iframe, callback);\r\n    }),\r\n    iframe;\r\n\r\n    try {\r\n        iframe = document.createElement('<iframe style=\"display:none\" onload=\"' + callbackName + '()\" src=\"javascript:true\" id=\"' + id + '\" name=\"' + id + '\"></iframe>');\r\n    }\r\n    catch (e)\r\n    {\r\n        iframe = document.createElement(\"iframe\");\r\n        iframe.style.display = 'none';\r\n        iframe.setAttribute('id', id);\r\n        iframe.setAttribute('name', id);\r\n        iframe.src = 'javascript:true';\r\n        iframe.onload = window[callbackName];\r\n    }\r\n\r\n    return iframe;\r\n}\r\n\r\n(function() {\r\n    var requests = {},\r\n        lastRequestId = 0,\r\n        uniquePrefix = 'id' + Math.random();\r\n\r\n    var processMessage = function(e) {\r\n        if (!(e.origin in requests)) {\r\n            return;\r\n        }\r\n\r\n        var dataStr = decodeURIComponent(e.data.replace(/\\n/g,'\\n\\\\'));\r\n        try {\r\n            var dataObj = JSON.parse(dataStr);\r\n        } catch (e) {\r\n            request.callback && request.callback({Status:\"error\", ErrorInfo: {ErrorMessage: \"JSON.parse exeption\", ExceptionType: \"JSON.parse\", StackTrace: dataStr}});\r\n        }\r\n\r\n        // console.log(dataObj);\r\n        var request = requests[e.origin][dataObj.CallbackName];\r\n        if (!request) return;    // message от других запросов\r\n\r\n        delete requests[e.origin][dataObj.CallbackName];\r\n        delete dataObj.CallbackName;\r\n\r\n        request.iframe.parentNode.removeChild(request.iframe);\r\n        request.callback && request.callback(dataObj);\r\n    }\r\n\r\n    //совместимость с IE8\r\n    if (window.addEventListener) {\r\n        window.addEventListener('message', processMessage);\r\n    } else {\r\n        window.attachEvent('onmessage', processMessage);\r\n    }\r\n\r\n    //скопирована из API для обеспечения независимости от него\r\n    var parseUri = function (str) {\r\n        var o   = parseUri.options,\r\n            m   = o.parser[o.strictMode ? 'strict' : 'loose'].exec(str),\r\n            uri = {},\r\n            i   = 14;\r\n\r\n        while (i--) {\r\n            uri[o.key[i]] = m[i] || '';\r\n        }\r\n\r\n        uri[o.q.name] = {};\r\n        uri[o.key[12]].replace(o.q.parser, function ($0, $1, $2) {\r\n            if ($1) { uri[o.q.name][$1] = $2; }\r\n        });\r\n\r\n        uri.hostOnly = uri.host;\r\n        uri.host = uri.authority; // HACK\r\n\r\n        return uri;\r\n    };\r\n\r\n    parseUri.options = {\r\n        strictMode: false,\r\n        key: ['source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'],\r\n        q:   {\r\n            name:   'queryKey',\r\n            parser: /(?:^|&)([^&=]*)=?([^&]*)/g\r\n        },\r\n        parser: {\r\n            strict: /^(?:([^:\\/?#]+):)?(?:\\/\\/((?:(([^:@]*):?([^:@]*))?@)?([^:\\/?#]*)(?::(\\d*))?))?((((?:[^?#\\/]*\\/)*)([^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,\r\n            loose:  /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/\r\n        }\r\n    };\r\n\r\n    function createPostIframe2(id, callback, url)\r\n    {\r\n        var uniqueId = uniquePrefix + (lastRequestId++);\r\n\r\n        var iframe = document.createElement(\"iframe\");\r\n        iframe.style.display = 'none';\r\n        iframe.setAttribute('id', id);\r\n        iframe.setAttribute('name', id);\r\n        iframe.src = 'javascript:true';\r\n        iframe.callbackName = uniqueId;\r\n        //iframe.onload = window[callbackName];\r\n\r\n        var parsedURL = parseUri(url);\r\n        var origin = (parsedURL.protocol ? (parsedURL.protocol + ':') : window.location.protocol) + '//' + (parsedURL.host || window.location.host);\r\n\r\n        requests[origin] = requests[origin] || {};\r\n        requests[origin][uniqueId] = {callback: callback, iframe: iframe};\r\n\r\n        return iframe;\r\n    }\r\n\r\n    window.createPostIframe2 = createPostIframe2;\r\n\r\n})();\r\n\r\n/** Посылает кроссдоменный POST запрос\r\n*\r\n* @memberOf nsGmx.Utils\r\n* @param {String} url URL запроса\r\n* @param {Object} params Хэш параметров-запросов\r\n* @param {Function} [callback] Callback, который вызывается при приходе ответа с сервера. Единственный параметр ф-ции - собственно данные\r\n* @param {DOMElement} [baseForm] базовая форма запроса. Используется, когда нужно отправить на сервер файл.\r\n*                                В функции эта форма будет модифицироваться, но после отправления запроса будет приведена к исходному виду.\r\n*/\r\nfunction sendCrossDomainPostRequest(url, params, callback, baseForm)\r\n{\r\n    var form,\r\n        rnd = String(Math.random()),\r\n        id = '$$iframe_' + url + rnd;\r\n\r\n    var iframe = window.createPostIframe2(id, callback, url),\r\n        originalFormAction;\r\n\r\n    if (baseForm)\r\n    {\r\n        form = baseForm;\r\n        originalFormAction = form.getAttribute('action');\r\n        form.setAttribute('action', url);\r\n        form.target = id;\r\n\r\n    }\r\n    else\r\n    {\r\n        try {\r\n            form = document.createElement('<form id=' + id + '\" enctype=\"multipart/form-data\" style=\"display:none\" target=\"' + id + '\" action=\"' + url + '\" method=\"post\"></form>');\r\n        }\r\n        catch (e)\r\n        {\r\n            form = document.createElement(\"form\");\r\n            form.style.display = 'none';\r\n            form.setAttribute('enctype', 'multipart/form-data');\r\n            form.target = id;\r\n            form.setAttribute('method', 'POST');\r\n            form.setAttribute('action', url);\r\n            form.id = id;\r\n        }\r\n    }\r\n\r\n    var hiddenParamsDiv = document.createElement(\"div\");\r\n    hiddenParamsDiv.style.display = 'none';\r\n\r\n    if (params.WrapStyle === 'window') {\r\n        params.WrapStyle = 'message';\r\n    }\r\n\r\n    if (params.WrapStyle === 'message') {\r\n        params.CallbackName = iframe.callbackName;\r\n    }\r\n\r\n    for (var paramName in params)\r\n    {\r\n        var input = document.createElement(\"input\");\r\n\r\n        var value = typeof params[paramName] !== 'undefined' ? params[paramName] : '';\r\n\r\n        input.setAttribute('type', 'hidden');\r\n        input.setAttribute('name', paramName);\r\n        input.setAttribute('value', value);\r\n\r\n        hiddenParamsDiv.appendChild(input)\r\n    }\r\n\r\n    form.appendChild(hiddenParamsDiv);\r\n\r\n    if (!baseForm)\r\n        document.body.appendChild(form);\r\n\r\n    document.body.appendChild(iframe);\r\n\r\n    form.submit();\r\n\r\n    if (baseForm)\r\n    {\r\n        form.removeChild(hiddenParamsDiv);\r\n        if (originalFormAction !== null)\r\n            form.setAttribute('action', originalFormAction);\r\n        else\r\n            form.removeAttribute('action');\r\n    }\r\n    else\r\n    {\r\n        form.parentNode.removeChild(form);\r\n    }\r\n}\r\n\r\nvar hooks = {};\r\n\r\n/** Добавляет \"хук\", который будет вызван при ответе сервера соответвующего типа\r\n* @param type {object} - тип хука (соответствует полю \"Status\" ответа сервера) или '*' - добавить к любому ответу\r\n* @param hookFunction {function(response, customErrorDescriptions)} - собственно хук\r\n*/\r\nfunction addParseResponseHook (type, hookFunction) {\r\n    hooks[type] = hooks[type] || [];\r\n    hooks[type].push(hookFunction);\r\n}\r\n\r\n/** Обрабатывает результат выполнения серверного скрипта.\r\n* Для выполнения действий вызывает \"хуки\" соответствующиего типа, добавленные через addParseResponseHook()\r\n* @function\r\n* @global\r\n* @param {object} response JSON, вернувшийся с сервера\r\n* @param {object} customErrorDescriptions хэш \"тип ошибки\" -> \"кастомное сообщение пользователям\".\r\n* @return true, если статус ответа \"ok\", иначе false\r\n*/\r\nfunction parseResponse (response, customErrorDescriptions)\r\n{\r\n    var responseHooks = (hooks[response.Status] || []).concat(hooks['*'] || []);\r\n    for (var h = 0; h < responseHooks.length; h++)\r\n        responseHooks[h](response, customErrorDescriptions);\r\n\r\n    return response.Status == 'ok';\r\n}\r\n\r\nfunction _title(elem, title)\r\n{\r\n    elem.setAttribute('title', title);\r\n}\r\n\r\nfunction parseXML(str)\r\n{\r\n    var xmlDoc;\r\n    try\r\n    {\r\n        if (window.DOMParser)\r\n        {\r\n            var parser = new DOMParser();\r\n            xmlDoc = parser.parseFromString(str,\"text/xml\");\r\n        }\r\n        else // Internet Explorer\r\n        {\r\n            xmlDoc = new ActiveXObject(\"MSXML2.DOMDocument.3.0\");\r\n            xmlDoc.validateOnParse = false;\r\n            xmlDoc.async = false;\r\n            xmlDoc.loadXML(str);\r\n        }\r\n    }\r\n    catch (e)\r\n    {\r\n        alert(e)\r\n    }\r\n\r\n    return xmlDoc;\r\n}\r\n\r\nfunction disableSelection(target)\r\n{\r\n    if (typeof target.onselectstart != \"undefined\")\r\n        target.onselectstart = function(){return false}\r\n    else if (typeof target.style.MozUserSelect != \"undefined\")\r\n        target.style.MozUserSelect = \"none\"\r\n    else\r\n        target.onmousedown = function(){return false}\r\n}\r\n\r\n// function parsePropertiesDate(str)\r\n// {\r\n//  if (str == null || str == \"\")\r\n//      return 0;\r\n\r\n//  var dateParts = str.split('.');\r\n\r\n//  if (dateParts.length != 3)\r\n//      return 0;\r\n\r\n//  return new Date(dateParts[2], dateParts[1] - 1, dateParts[0]).valueOf();\r\n// }\r\n\r\nfunction stringDate(msec, isUtc)\r\n{\r\n    var date = new Date(msec),\r\n        excDate = isUtc ? date.getUTCDate() : date.getDate(),\r\n        excMonth = (isUtc ? date.getUTCMonth() : date.getMonth()) + 1,\r\n        excYear = isUtc ? date.getUTCFullYear() : date.getFullYear();\r\n\r\n    return (excDate < 10 ? '0' + excDate : excDate) + '.' + (excMonth < 10 ? '0' + excMonth : excMonth) + '.' + excYear;\r\n}\r\n\r\nfunction stringTime(msec, isUtc)\r\n{\r\n    var date = new Date(msec),\r\n        excHour = isUtc ? date.getUTCHours() : date.getHours(),\r\n        excMin = isUtc ? date.getUTCMinutes() : date.getMinutes(),\r\n        excSec = isUtc ? date.getUTCSeconds() : date.getSeconds();\r\n\r\n    return (excHour < 10 ? '0' + excHour : excHour) + ':' + (excMin < 10 ? '0' + excMin : excMin) + ':' + (excSec < 10 ? '0' + excSec : excSec);\r\n}\r\n\r\nfunction stringDateTime(msec, isUtc)\r\n{\r\n    return stringDate(msec, isUtc) + ' ' + stringTime(msec, isUtc);\r\n}\r\n\r\n/** Подсвечивает красным input, убирает подсветку через некоторое время\r\n*\r\n* @param {HTMLDOMElement|Array<HTMLDOMElement>} input - целевой input-элемент или массив таких элементов\r\n* @param {integer} delay - время подсвечивания ошибки в миллисекундах\r\n*/\r\nfunction inputError(input, delay)\r\n{\r\n    delay = delay || 1000;\r\n    if (!jQuery.isArray(input))\r\n        input = [input];\r\n\r\n    for (var k = 0; k < input.length; k++)\r\n        jQuery(input[k]).addClass('error');\r\n\r\n    setTimeout(function()\r\n    {\r\n        for (var k = 0; k < input.length; k++)\r\n            if (input[k])\r\n                jQuery(input[k]).removeClass('error');\r\n    }, delay)\r\n}\r\n\r\nfunction equals(x, y)\r\n{\r\n    for (let p in y)\r\n    {\r\n        if (typeof(x[p])=='undefined') { return false; }\r\n    }\r\n\r\n    for (let p in y) {\r\n        if (y[p]) {\r\n            switch (typeof(y[p]))\r\n            {\r\n                case 'object':\r\n                    if (!equals(x[p], y[p])) { return false; } break;\r\n                case 'function':\r\n                    if (typeof(x[p]) == 'undefined' || (p != 'equals' && y[p].toString() != x[p].toString())) { return false; } break;\r\n                default:\r\n                    if (y[p] != x[p]) { return false; }\r\n            }\r\n        }\r\n        else if (x[p]) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    for (let p in x) {\r\n        if (typeof(y[p]) == 'undefined') { return false; }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n    @namespace nsGmx.Utils\r\n    @description Разнообразные вспомогательные ф-ции\r\n*/\r\n$.extend(nsGmx.Utils, {\r\n\r\n    /**\r\n        Возвращает уникальную строку (16 символов из букв и латинских цифр)\r\n        @function\r\n        @memberOf nsGmx.Utils\r\n    */\r\n    generateUniqueID: function()\r\n    {\r\n        var chars = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz\",\r\n            randomstring = '';\r\n\r\n        for (var i = 0; i < 16; i++)\r\n        {\r\n            var rnum = Math.floor(Math.random() * chars.length);\r\n            randomstring += chars.charAt(rnum);\r\n        }\r\n\r\n        return randomstring;\r\n    },\r\n    /**\r\n        Преобразует цвет, заданный в виде числа (0xaabbcc) в строку вида #aabbcc\r\n        @function\r\n        @memberOf nsGmx.Utils\r\n    */\r\n    convertColor: function(intColor)\r\n    {\r\n        var r,g,b;\r\n\r\n        b = (intColor % 256).toString(16);\r\n        if (b.length == 1)\r\n            b = '0' + b;\r\n\r\n        intColor = Math.floor(intColor / 256);\r\n        g = (intColor % 256).toString(16);\r\n        if (g.length == 1)\r\n            g = '0' + g;\r\n\r\n        intColor = Math.floor(intColor / 256);\r\n        r = (intColor % 256).toString(16);\r\n        if (r.length == 1)\r\n            r = '0' + r;\r\n\r\n        return '#' + r + g + b;\r\n    },\r\n    /**\r\n        Преобразует цвет, заданный в виде строки rgb(255, 255, 255) в строку вида #aabbcc\r\n        @function\r\n        @memberOf nsGmx.Utils\r\n    */\r\n    rgb2hex: function(intColor)\r\n    {\r\n        var str,\r\n            arr = intColor.substring(4, intColor.length-1).split(', ');\r\n\r\n        arr = arr.map(function(c){\r\n            var hex = Number(c).toString(16);\r\n            return hex.length == 1 ? \"0\" + hex : hex;\r\n        });\r\n\r\n        str = \"#\" + arr.join('');\r\n\r\n        return str;\r\n    },\r\n\r\n    checkForNumber: function (number) {\r\n        return !(isNaN(number) || typeof(number) === 'undefined' || number === null || number === '');\r\n    },\r\n\r\n    isJSON: function(str) {\r\n        try {\r\n            JSON.parse(str);\r\n        } catch (e) {\r\n            return false;\r\n        }\r\n        if (str === '' || str === 'null' || str === 'undefined' || typeof str === 'number') {\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    },\r\n\r\n    /** Возвращает позицию окна такую, чтобы окно не мешало текущему элементу\r\n        @memberOf nsGmx.Utils\r\n    */\r\n    getDialogPos: function(div, offsetFlag, height)\r\n    {\r\n        var pos = getOffsetRect(div),\r\n            left = pos.left + 30,\r\n            top = pos.top - 10,\r\n            windowHeight = getWindowHeight();\r\n\r\n        if (offsetFlag)\r\n        {\r\n            $(div).children('div,img').each(function()\r\n            {\r\n                if (!this.getAttribute('multiStyle'))\r\n                    left += this.offsetWidth;\r\n            })\r\n        }\r\n\r\n        if (top + 15 + height > windowHeight)\r\n            top -= (top + 15 + height - windowHeight);\r\n\r\n        return {left: left, top: top}\r\n    },\r\n\r\n    /** Устанавливает обычный стиль и генерит похожий стиль при наведении мышки\r\n    @memberOf nsGmx.Utils\r\n    @param layer {L.gmxVectorLayer} Слой\r\n    @param styleIndex {Number} Номер стиля слоя\r\n    @param templateStyle {Style} Стиль, похожий на который надо установить*/\r\n    setMapObjectStyle: function(layer, styleIndex, templateStyle)\r\n    {\r\n        var hoverStyle = $.extend(true, {}, templateStyle);\r\n        var style = layer.getStyle(styleIndex);\r\n\r\n        if (templateStyle.outline && typeof templateStyle.outline.thickness != 'undefined')\r\n            hoverStyle.outline.thickness = Number(templateStyle.outline.thickness) + 1;\r\n\r\n        if (templateStyle.fill && typeof templateStyle.fill.opacity != 'undefined' && templateStyle.fill.opacity > 0)\r\n            hoverStyle.fill.opacity = Math.min(Number(templateStyle.fill.opacity + 20), 100);\r\n\r\n        var newStyle = $.extend(true, {}, style);\r\n        newStyle.RenderStyle = L.gmxUtil.fromServerStyle(templateStyle);\r\n        newStyle.HoverStyle = L.gmxUtil.fromServerStyle(hoverStyle);\r\n\r\n        if (templateStyle.labelTemplate) {\r\n          newStyle.RenderStyle.labelTemplate = templateStyle.labelTemplate;\r\n        }\r\n        if (hoverStyle.labelTemplate) {\r\n          newStyle.HoverStyle.labelTemplate = hoverStyle.labelTemplate;\r\n        }\r\n\r\n        if (templateStyle.labelAnchor) {\r\n          newStyle.RenderStyle.labelAnchor = templateStyle.labelAnchor;\r\n        }\r\n        if (hoverStyle.labelAnchor) {\r\n          newStyle.HoverStyle.labelAnchor = hoverStyle.labelAnchor;\r\n        }\r\n        layer.setStyle(newStyle, styleIndex);\r\n    },\r\n\r\n    // берёт стиль в формате сервера, добавляет в него hover-подсветку\r\n    // и возвращает этот стиль в новом формате Leafelt-Geomixer\r\n    prepareGmxLayerStyle: function(style)\r\n    {\r\n        var templateStyle = style.RenderStyle,\r\n            newStyle = $.extend(true, {}, style),\r\n            hoverStyle = $.extend(true, {}, templateStyle);\r\n\r\n\r\n        if (templateStyle.outline && typeof templateStyle.outline.thickness != 'undefined')\r\n            hoverStyle.outline.thickness = Number(templateStyle.outline.thickness) + 1;\r\n\r\n        if (templateStyle.fill && typeof templateStyle.fill.opacity != 'undefined' && templateStyle.fill.opacity > 0)\r\n            hoverStyle.fill.opacity = Math.min(Number(templateStyle.fill.opacity + 20), 100);\r\n\r\n        newStyle.RenderStyle = L.gmxUtil.fromServerStyle(templateStyle);\r\n        newStyle.HoverStyle = L.gmxUtil.fromServerStyle(hoverStyle);\r\n\r\n        return newStyle;\r\n    },\r\n    /** Конвертация данных между форматами сервера и клиента. Используется в тегах слоёв и в атрибутах объектов векторных слоёв.\r\n    *\r\n    * Форматы сервера:\r\n    *\r\n    *  * datetime - unix timestamp\r\n    *  * date - unix timestamp, кратный 24*3600 секунд\r\n    *  * time - кол-во секунд с полуночи\r\n    *\r\n    * Форматы клиента:\r\n    *\r\n    *  * все числа превращаются в строки\r\n    *  * дата - строка в формате dd.mm.yy\r\n    *  * время - строка в формате hh:mm:ss\r\n    *  * дата-время - dd.mm.yy hh:mm:ss\r\n    *\r\n    * @memberOf nsGmx.Utils\r\n    */\r\n    convertFromServer: function(type, value)\r\n    {\r\n        //if (value === null) return \"null\";\r\n\r\n        if (!type) {\r\n            return value;\r\n        }\r\n\r\n        var lowerCaseType = type.toLowerCase();\r\n\r\n        if (lowerCaseType == 'string')\r\n        {\r\n            return value !== null ? value : ''; //все null интерпретируем как пустые строки!\r\n        }\r\n        else if (lowerCaseType == 'integer' || lowerCaseType == 'float' || lowerCaseType == 'number')\r\n        {\r\n            return value !== null ? String(value) : '';\r\n        }\r\n        else if (lowerCaseType == 'date')\r\n        {\r\n            if (value === null) return '';\r\n\r\n            return stringDate(value*1000, true);\r\n        }\r\n        else if (lowerCaseType == 'time')\r\n        {\r\n            if (value === null) return '';\r\n            return stringTime(value*1000, true);\r\n        }\r\n        else if (lowerCaseType == 'datetime')\r\n        {\r\n            if (value === null) return '';\r\n            return stringDateTime(value*1000, true);\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /** Конвертация данных между форматами сервера и клиента. Используется в тегах слоёв и в атрибутах объектов векторных слоёв.\r\n    * Описание форматов см. в {@link nsGmx.Utils.convertFromServer}\r\n    * Если конвертация невозможна для данного типа, возвращает null\r\n    * @memberOf nsGmx.Utils\r\n    */\r\n    convertToServer: function(type, value)\r\n    {\r\n        if (!type) {\r\n            return value;\r\n        }\r\n\r\n        let lowerCaseType = type.toLowerCase();\r\n\r\n        if (lowerCaseType == 'string')\r\n        {\r\n            return value;\r\n        }\r\n        else if (lowerCaseType == 'integer' || lowerCaseType == 'float' || lowerCaseType == 'number')\r\n        {\r\n            if (value === '') return null;\r\n            let num = Number(value);\r\n            return isNaN(num) ? null : num;\r\n        }\r\n        else if (lowerCaseType == 'date')\r\n        {\r\n            let localDateValue = $.datepicker.parseDate('dd.mm.yy', value);\r\n            if (localDateValue === null) return null;\r\n\r\n            let localValue = localDateValue.valueOf()/1000;\r\n            let timeOffset = (new Date(localValue*1000)).getTimezoneOffset()*60;\r\n            return localValue - timeOffset;\r\n        }\r\n        else if (lowerCaseType == 'time')\r\n        {\r\n            let resTime = $.datepicker.parseTime('HH:mm:ss', value);\r\n            if (!resTime) return null;\r\n\r\n            return resTime.hour*3600 + resTime.minute*60 + resTime.second;\r\n        }\r\n        else if (lowerCaseType == 'datetime')\r\n        {\r\n            let localDateValue = $.datepicker.parseDateTime('dd.mm.yy', 'HH:mm:ss', value);\r\n            if (localDateValue === null) return null;\r\n\r\n            let localValue = localDateValue.valueOf()/1000;\r\n            let timeOffset = (new Date(localValue*1000)).getTimezoneOffset()*60;\r\n            return localValue - timeOffset;\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n\r\n    login: function(redirect_uri, authServerBase, callback, authServer, isHidden){\r\n        var oAuthServer = authServer || 'MyKosmosnimki';\r\n        window.gmxGetServerBase = function(){\r\n            return authServerBase\r\n        }\r\n        var redirectUri = redirect_uri + (redirect_uri.indexOf('?')>0 ? '&' : '?') + 'authServer=' + oAuthServer;\r\n        window.gmxProcessAuthentication = function(userInfo){\r\n            callback && callback(userInfo);\r\n        }\r\n        var features, w = 600, h = 350;\r\n        var handlerName = 'LoginDialog';\r\n        if (oAuthServer != 'MyKosmosnimki') {\r\n            handlerName += oAuthServer;\r\n            h = 400;\r\n        }\r\n        var url = authServerBase + handlerName + '.ashx?redirect_uri=' + escape(redirectUri);\r\n\r\n        if (!isHidden) {\r\n            var top = (screen.height - h)/2, left = (screen.width - w)/2;\r\n            features = 'location=0,menubar=0,resizable=0,status=0,toolbar=0,width='+w+',height='+h+',left='+left+',top='+top ;\r\n\r\n            window.open(url, '_blank', features);\r\n        }\r\n        else {\r\n            $('<iframe />', {\r\n                'src': url,\r\n                'style': 'display: block !important; position: absolute; left: -99999px;'\r\n            }).appendTo('body'); //стиль такой кривой иначе будет бага в FF\r\n        }\r\n    },\r\n\r\n    /** Загружает пользовательский shp файл.\r\n    * Проверяет на ошибки, выводит предупреждения и ошибки в виде стандартных диалогов.\r\n    * @memberof nsGmx.Utils\r\n    * @function\r\n    * @param {File|Form} shpSource Либо форма с полем file, в которой пользователь выбрал файл, либо HTML5 File. Форма должна иметь атрибуты method=\"post\" и enctype=\"multipart/form-data\"\r\n    * @return {jQuery.Deferred} Возвращает promise (аргумент ф-ции - массив объектов из shp файла)\r\n    */\r\n    parseShpFile: (function() //приватные данные\r\n    {\r\n        var translationsAdded = false;\r\n        var addTranslationsLazy = function()\r\n        {\r\n            if (translationsAdded) return;\r\n            _translationsHash.addtext(\"rus\", {\r\n                                \"loadShape.Errors.FileTooBigException\" : \"Файл слишком большой. Ограничение на размер файла 1000 Кб.\",\r\n                                \"loadShape.Errors.ErrorUploadExeption\" : \"Произошла ошибка при попытке загрузить файл.\",\r\n                                \"loadShape.Errors.NoGeometryFile\"      : \"Загруженный файл не содержит геометрических данных.\",\r\n                                \"loadShape.Errors.ErrorUploadNoDependentFiles\" : \"Не найдено необходимых зависимых файлов. Запакуйте все файлы в ZIP архив и повторите загрузку.\"\r\n                             });\r\n\r\n            _translationsHash.addtext(\"eng\", {\r\n                                \"loadShape.Errors.FileTooBigException\" : \"Too big file. File size limit is 1000 Kb.\",\r\n                                \"loadShape.Errors.ErrorUploadExeption\" : \"Error during file uploading.\",\r\n                                \"loadShape.Errors.NoGeometryFile\"      : \"There are no geometry in uploaded file.\",\r\n                                \"loadShape.Errors.ErrorUploadNoDependentFiles\" : \"Not found the necessary dependent files. Add all files in a ZIP archive and upload it again.\"\r\n                             });\r\n\r\n            translationsAdded = true;\r\n        }\r\n\r\n        //непосредственно ф-ция\r\n        return function(shpFileForm) {\r\n            var def = $.Deferred();\r\n\r\n            addTranslationsLazy();\r\n\r\n            var errorMessages = {\r\n                \"CommonUtil.FileTooBigException\" : _gtxt(\"loadShape.Errors.FileTooBigException\"),\r\n                \"CommonUtil.ErrorUploadExeption\" : _gtxt(\"loadShape.Errors.ErrorUploadExeption\"),\r\n                \"CommonUtil.NoGeometryFile\"      : _gtxt(\"loadShape.Errors.NoGeometryFile\"),\r\n                \"CommonUtil.ErrorUploadNoDependentFiles\": _gtxt(\"loadShape.Errors.ErrorUploadNoDependentFiles\")\r\n            };\r\n\r\n            if (window.File && shpFileForm instanceof window.File) {\r\n                if (!window.FormData) {\r\n                    def.reject();\r\n                    return false;\r\n                }\r\n\r\n                var formData = new FormData();\r\n                formData.append('file', shpFileForm);\r\n                var xhr = new XMLHttpRequest();\r\n                xhr.open('POST', window.serverBase + 'ShapeLoader');\r\n                xhr.onload = function (response) {\r\n                    if (xhr.status === 200) {\r\n                        response = JSON.parse(xhr.responseText.substr(1, xhr.responseText.length-2));\r\n\r\n                        if (parseResponse(response, errorMessages)) {\r\n                            def.resolve(response.Result);\r\n                        } else {\r\n                            def.reject(response);\r\n                        }\r\n                    }\r\n                };\r\n\r\n                xhr.send(formData);\r\n            } else {\r\n                sendCrossDomainPostRequest(window.serverBase + \"ShapeLoader\", {WrapStyle: \"window\"}, function(response)\r\n                {\r\n                    if (parseResponse(response, errorMessages)) {\r\n                        def.resolve(response.Result);\r\n                    } else {\r\n                        def.reject(response);\r\n                    }\r\n                }, shpFileForm)\r\n            }\r\n\r\n            return def.promise();\r\n        }\r\n\r\n    })(),\r\n\r\n    /** Позволяет скачать в браузере геометрию в одном из форматов (упакованный в zip архив).\r\n    * @memberof nsGmx.Utils\r\n    * @function\r\n    * @param {Object[]} geoJSONFeatures Массив GeoJSON Features. К сожалению, другие типы GeoJSON объектов не поддерживаются.\r\n    * @param {Object} [options] Доп. параметры\r\n    * @param {String} [options.fileName=markers] Имя файла для скачивания\r\n    * @param {String} [options.format=Shape] В каком формате скачать (Shape, Tab, gpx или несколько через запятую)\r\n    */\r\n    downloadGeometry: function(geoJSONFeatures, options) {\r\n        var objectsByType = {},\r\n            markerIdx = 1;\r\n\r\n        options = $.extend({\r\n            fileName: 'markers',\r\n            format: 'Shape'\r\n        }, options);\r\n\r\n        geoJSONFeatures.forEach(function(item) {\r\n            var geom = item.geometry,\r\n                type = geom.type;\r\n\r\n            objectsByType[type] = objectsByType[type] || [];\r\n\r\n            var title = item.properties && item.properties.title || '';\r\n\r\n            if (type == \"Point\" && !title) {\r\n                title = \"marker \" + markerIdx++;\r\n            }\r\n\r\n            objectsByType[type].push({\r\n                geometry: {\r\n                    type: type.toUpperCase(),\r\n                    coordinates: geom.coordinates\r\n                },\r\n                properties: {text: title}\r\n            });\r\n        });\r\n\r\n        sendCrossDomainPostRequest(window.serverBase + \"Shapefile\", {\r\n            name:     options.fileName,\r\n            format:   options.format,\r\n            points:   JSON.stringify(objectsByType[\"Point\"] || []),\r\n            lines:    JSON.stringify([].concat(objectsByType[\"LineString\"] || [], objectsByType[\"MultiLineString\"] || [])),\r\n            polygons: JSON.stringify([].concat(objectsByType[\"Polygon\"] || [], objectsByType[\"MultiPolygon\"] || []))\r\n        })\r\n    },\r\n\r\n    /** Объединяет массив полигонов/мультиполигонов в новый полигон/мультиполигон\r\n    * @memberof nsGmx.Utils\r\n    */\r\n    joinPolygons: function(objs)\r\n    {\r\n        var polygonObjects = [];\r\n        for (var i = 0; i < objs.length; i++)\r\n        {\r\n            var geom = objs[i];\r\n            if (geom.type == 'POLYGON')\r\n            {\r\n                polygonObjects.push(geom.coordinates);\r\n            }\r\n            else if (geom.type == 'MULTIPOLYGON')\r\n            {\r\n                for (var iC = 0; iC < geom.coordinates.length; iC++)\r\n                    polygonObjects.push(geom.coordinates[iC]);\r\n            }\r\n        }\r\n\r\n        if (polygonObjects.length > 1)\r\n            return {type: \"MULTIPOLYGON\", coordinates: polygonObjects}\r\n        else if (polygonObjects.length == 1)\r\n        {\r\n            return {type: \"POLYGON\", coordinates: polygonObjects[0]}\r\n        }\r\n        else\r\n            return null;\r\n    },\r\n\r\n    joinClippedPolygon: function(polygon) {\r\n\r\n        if (polygon.type !== 'MULTIPOLYGON') {\r\n            return polygon;\r\n        }\r\n\r\n        var origData = [],\r\n            segmentsToJoin = [],\r\n            joinedSegments = [],\r\n            crossPoints = [],\r\n            finalPolygon = [];\r\n\r\n        var equal = function(a, b) {return Math.abs(a - b) < 1e-5;}\r\n\r\n        var coords = polygon.coordinates;\r\n        for (var c = 0; c < coords.length; c++) {\r\n            for (var r = 0; r < coords[c].length; r++) {\r\n                coords[c][r].length = coords[c][r].length - 1;\r\n            }\r\n        }\r\n\r\n        var parseRing = function(origRing) {\r\n            var ring = origRing.coords,\r\n                len = ring.length;\r\n\r\n            var getNextSegment = function(i) {\r\n                var il = (i - 1 + len) % len,\r\n                    points = [];\r\n\r\n                while (i != il) {\r\n                    if (equal(Math.abs(ring[i][0]), 180) && equal(Math.abs(ring[(i+1)%len][0]), 180) ) {\r\n                        return [i, points];\r\n                    }\r\n\r\n                    points.push(ring[i]);\r\n                    i = (i + 1) % len;\r\n                }\r\n\r\n                return [i, points];\r\n            }\r\n\r\n            var segment = getNextSegment(0);\r\n\r\n            var lastI = segment[0];\r\n\r\n            if (!equal(Math.abs(ring[segment[0]][0]), 180)) {\r\n                origRing.regularRing = ring;\r\n                return;\r\n            }\r\n\r\n            do {\r\n                var startI = (segment[0] + 1) % len;\r\n                segment = getNextSegment((startI + 1) % len);\r\n                var nextSegment = {\r\n                    points: [].concat([ring[startI]], segment[1], [ring[segment[0]]])\r\n                }\r\n                segmentsToJoin.push(nextSegment);\r\n                origRing.segments.push(nextSegment);\r\n            } while (segment[0] !== lastI);\r\n        }\r\n\r\n        var findSegment = function(y, joinedSeg) {\r\n            for (var s = 0; s < segmentsToJoin.length; s++) {\r\n                var seg = segmentsToJoin[s];\r\n                if (equal(seg.points[0][1], y) || equal(seg.points[seg.points.length - 1][1], y)) {\r\n                    segmentsToJoin.splice(s, 1);\r\n                    seg.joinedSeg = joinedSeg;\r\n                    var isReg = equal(seg.points[0][1], y);\r\n                    return {\r\n                        points: isReg ? seg.points.slice(1, seg.points.length - 1) : seg.points.slice(1, seg.points.length - 1).reverse(),\r\n                        lastY: isReg ? seg.points[seg.points.length - 1][1] : seg.points[0][1]\r\n                    };\r\n                }\r\n            }\r\n        }\r\n\r\n        var joinSegment = function(y0) {\r\n            var res = {},\r\n                seg = findSegment(y0, res),\r\n                points = seg.points,\r\n                crossPoints = [y0];\r\n\r\n            while (seg.lastY !== y0) {\r\n                crossPoints.push(seg.lastY);\r\n                seg = findSegment(seg.lastY);\r\n                points = points.concat(seg.points);\r\n            }\r\n\r\n            res.points = points;\r\n            res.crossPoints = crossPoints;\r\n            res.minCrossPoint = Math.min.apply(Math, crossPoints);\r\n\r\n            return res;\r\n        }\r\n\r\n        let parseGeometry = function(geom) {\r\n            for (let c = 0; c < geom.coordinates.length; c++) {\r\n                let origComp = [];\r\n                origData.push(origComp);\r\n                let comp = geom.coordinates[c];\r\n                for (let r = 0; r < comp.length; r++) {\r\n                    let origRing = {\r\n                        coords: comp[r],\r\n                        segments: []\r\n                    }\r\n                    origComp.push(origRing);\r\n                    parseRing(origRing);\r\n                }\r\n            }\r\n        }\r\n\r\n        parseGeometry(polygon);\r\n\r\n        segmentsToJoin.forEach(function(segment) {\r\n            if (segment.points[0][0] < 0) {\r\n                segment.points = segment.points.map(function(c) { return [c[0] + 360, c[1]];});\r\n            }\r\n        })\r\n\r\n        while (segmentsToJoin.length) {\r\n            let y0 = segmentsToJoin[0].points[0][1];\r\n            let joinedSeg = joinSegment(y0);\r\n            joinedSegments.push(joinedSeg);\r\n            crossPoints = crossPoints.concat(joinedSeg.crossPoints);\r\n        }\r\n\r\n        crossPoints = crossPoints.sort();\r\n\r\n        joinedSegments = joinedSegments.sort(function(s1, s2) {\r\n            return s1.minCrossPoint - s2.minCrossPoint;\r\n        })\r\n\r\n        joinedSegments.forEach(function(s) {\r\n            s.isExternal = (crossPoints.indexOf(s.minCrossPoint) % 2) === 0;\r\n        })\r\n\r\n        //собираем объединённые сегменты в мультиполигон\r\n        joinedSegments.forEach(function(s) {\r\n            if (s.isExternal) {\r\n                finalPolygon.push([s.points]);\r\n            } else {\r\n                finalPolygon[finalPolygon.length-1].push(s.points);\r\n            }\r\n            s.finalComponent = finalPolygon[finalPolygon.length-1];\r\n        })\r\n\r\n        //добавляем компоненты, которые не пересекались со 180 градусом\r\n        for (let c = 0; c < origData.length; c++) {\r\n            if (origData[c][0].regularRing) {\r\n                console.log('external component', c)\r\n                let geomToCopy = [];\r\n                for (let r = 0; r < origData[c].length; r++) {\r\n                    geomToCopy.push(origData[c][r].regularRing);\r\n                }\r\n                finalPolygon.push(geomToCopy);\r\n                continue;\r\n            }\r\n            for (let r = 1; r < origData[c].length; r++) {\r\n                if (origData[c][r].regularRing) {\r\n                    console.log('internal component', c, r, origData[c][0].segments);\r\n                    for (let s = 0; s < origData[c][0].segments.length; s++) {\r\n                        let joinedSeg = origData[c][0].segments[s].joinedSeg;\r\n                        if (joinedSeg.isExternal) {\r\n                            joinedSeg.finalComponent.push(origData[c][r].regularRing);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (finalPolygon.length === 1) {\r\n            return {type: 'POLYGON', coordinates: finalPolygon[0]};\r\n        } else {\r\n            return {type: 'MULTIPOLYGON', coordinates: finalPolygon};\r\n        }\r\n    },\r\n\r\n    /** Методы для работы с сохранёнными на сервере данными.\r\n    * Сервер позволяет сохранять произвольный текст на сервере и получить ID, по которому можно этот текст получить.\r\n    * Используется для формирования пермалинков (сохранение состояния)\r\n    * @namespace\r\n    * @memberOf nsGmx.Utils\r\n    */\r\n    TinyReference: {\r\n        /** Создать новую ссылку\r\n        * @param {String} data Данные, которые нужно сохранить\r\n        * @return {jQuery.Deferred} Промис, который будет resolve при сохранении данных. Параметр при ресолве: ID, по которому можно получить данные обратно\r\n        */\r\n        create: function(data, tempFlag) {\r\n            var def = $.Deferred();\r\n            sendCrossDomainPostRequest(window.serverBase + \"TinyReference/Create.ashx\", {\r\n                WrapStyle: 'message',\r\n                content: JSON.stringify(data),\r\n                temp: tempFlag\r\n            },\r\n            function(response) {\r\n                if (parseResponse(response)) {\r\n                    def.resolve(response.Result);\r\n                } else {\r\n                    def.reject();\r\n                }\r\n            })\r\n\r\n            return def.promise();\r\n        },\r\n\r\n        /** Получить ранее сохранённые данные по ID\r\n        * @param {String} id полученный при сохранении ID данных\r\n        * @return {jQuery.Deferred} Промис, который будет resolve при получении данных. Параметр при ресолве: данные с сервера\r\n        */\r\n        get: function(id) {\r\n            var def = $.Deferred();\r\n            sendCrossDomainJSONRequest(window.serverBase + \"TinyReference/Get.ashx?id=\" + id, function(response){\r\n                //если пермалинк не найден, сервер не возвращает ошибку, а просто пустой результат\r\n                if (parseResponse(response) && response.Result) {\r\n                    def.resolve(JSON.parse(response.Result));\r\n                } else {\r\n                    def.reject();\r\n                }\r\n            });\r\n\r\n            return def.promise();\r\n        },\r\n\r\n        /** Удалить данные по ID\r\n        * @param {String} id полученный при сохранении ID данных\r\n        * @return {jQuery.Deferred} Промис, который будет resolve при удалении данных\r\n        */\r\n        remove: function(id) {\r\n            var def = $.Deferred();\r\n            sendCrossDomainJSONRequest(window.serverBase + \"TinyReference/Delete.ashx?id=\" + id, function(response){\r\n                if (parseResponse(response)) {\r\n                    def.resolve();\r\n                } else {\r\n                    def.reject();\r\n                }\r\n            });\r\n\r\n            return def.promise();\r\n        }\r\n    },\r\n    isIpad: function() {\r\n        return navigator.userAgent.match(/iPad/i) != null;\r\n    },\r\n\r\n    getLatLngBounds: function (layer) {\r\n        var gmxBounds = layer._gmx.layerID ? L.gmxUtil.getGeometryBounds(layer._gmx.geometry) : layer._gmx.dataManager.getItemsBounds(),\r\n            // srs = layer._gmx.srs,\r\n            array = [];\r\n\r\n        // if (srs) {\r\n        //     for (let proj in L.CRS) {\r\n        //         if (proj.indexOf(srs) !== -1) {\r\n        //             projection = L.CRS[proj];\r\n        //             break;\r\n        //         }\r\n        //     }\r\n        // } else {\r\n        //     projection = L.CRS['EPSG:3395'];\r\n        // }\r\n\r\n        array.push(L.Projection.Mercator.unproject(gmxBounds.min));\r\n        array.push(L.Projection.Mercator.unproject(gmxBounds.max));\r\n        return L.latLngBounds(array);\r\n    },\r\n\r\n    showDialog: showDialog,\r\n    removeDialog: removeDialog,\r\n    makeImageButton: makeImageButton,\r\n    makeLinkButton: makeLinkButton,\r\n    makeButton: makeButton,\r\n    _title: _title,\r\n    _checkbox: _checkbox\r\n});\r\n\r\nwindow.gmxCore.addModule('utilities', nsGmx.Utils);\r\n\r\nconst {\r\n    _br,\r\n    _div,\r\n    _form,\r\n    _iframe,\r\n    _img,\r\n    _input,\r\n    _li,\r\n    _option,\r\n    _span,\r\n    _a,\r\n    _t,\r\n    _table,\r\n    _tbody,\r\n    _textarea,\r\n    _thead,\r\n    _tr,\r\n    _th,\r\n    _td,\r\n    _ul\r\n} = domManipulation;\r\n\r\nwindow.addParseResponseHook = addParseResponseHook;\r\nwindow.parseResponse = parseResponse;\r\n\r\nexport {\r\n    addParseResponseHook,\r\n    attachEffects,\r\n    _br,\r\n    _checkbox,\r\n    createPostIframe,\r\n    disableSelection,\r\n    _div,\r\n    _iframe,\r\n    _img,\r\n    createCookie,\r\n    eraseCookie,\r\n    equals,\r\n    _form,\r\n    getkey,\r\n    getOffsetRect,\r\n    getOwnChildNumber,\r\n    getWindowHeight,\r\n    getWindowWidth,\r\n    show,\r\n    hide,\r\n    hidden,\r\n    _input,\r\n    inputError,\r\n    insertAtCursor,\r\n    _li,\r\n    makeButton,\r\n    makeImageButton,\r\n    makeLinkButton,\r\n    objLength,\r\n    _option,\r\n    parseColor,\r\n    parseResponse,\r\n    parseXML,\r\n    readCookie,\r\n    removeDialog,\r\n    sendCrossDomainJSONRequest,\r\n    sendCrossDomainPostRequest,\r\n    showDialog,\r\n    showErrorMessage,\r\n    stopEvent,\r\n    strip,\r\n    switchSelect,\r\n    _span,\r\n    _a,\r\n    _t,\r\n    _title,\r\n    _table,\r\n    _tbody,\r\n    _textarea,\r\n    _thead,\r\n    _tr,\r\n    _th,\r\n    _td,\r\n    _ul,\r\n    valueInArray,\r\n    visible,\r\n    _,\r\n};","import nsGmx from './nsGmx.js';\r\nimport {\r\n    _div,\r\n    createCookie,\r\n    eraseCookie,\r\n    readCookie,\r\n    makeLinkButton,\r\n    _span,\r\n    _t,\r\n    _title,\r\n} from './utilities.js';\r\n\r\n// var translationsHash = function()\r\n// {\r\n// \tthis.hash = {};\r\n\t\r\n// \tthis.flags = {};\r\n\t\r\n// \tthis.titles = {};\r\n    \r\n//     this._errorHandlers = [];\r\n// }\r\n\r\nvar DEFAULT_LANGUAGE = 'rus';\r\n\r\n//Для запоминания выбора языка пользователем используются куки. \r\n//Запоминается выбор для каждого pathname, а не только для домена целиком\r\n//Формат куки: pathname1=lang1&pathname2=lang2&...\r\nvar _parseLanguageCookie = function()\r\n{\r\n    var text = readCookie(\"language\");\r\n    \r\n    if (!text) \r\n        return {};\r\n    \r\n    var items = text.split('&');\r\n\r\n    //поддержка старого формата кук (просто названия взыка для всех pathname)\r\n    if (items % 2) items = [];\r\n    \r\n    var langs = {};\r\n    for (var i = 0; i < items.length; i++)\r\n    {\r\n        var elems = items[i].split('=');\r\n        langs[decodeURIComponent(elems[0])] = decodeURIComponent(elems[1]);\r\n    }\r\n    \r\n    return langs;\r\n}\r\n\r\nvar _saveLanguageCookie = function(langs)\r\n{\r\n    var cookies = [];\r\n    \r\n    for (var h in langs)\r\n    {\r\n        cookies.push(encodeURIComponent(h) + '=' + encodeURIComponent(langs[h]));\r\n    }\r\n    \r\n    eraseCookie(\"language\");\r\n    createCookie(\"language\", cookies.join('&'));\r\n}\r\n\r\nvar TranslationsManager = function() {\r\n    this.flags = {};\r\n    this.titles = {};\r\n    this.hash = {};\r\n    this._errorHandlers = [];\r\n}\r\n\r\nTranslationsManager.prototype._language = null;\r\n\r\nTranslationsManager.prototype._addTextWithPrefix = function(prefix, lang, newHash) {\r\n    var res = true,\r\n        hash = this.hash;\r\n\r\n    if (!(lang in hash)) {\r\n        hash[lang] = {};\r\n    }\r\n\r\n    for (var k in newHash) {\r\n        var fullKey = prefix + k;\r\n        if (fullKey in hash[lang]) {\r\n            res = false;\r\n        }\r\n        else if (typeof newHash[k] === 'string') {\r\n            hash[lang][fullKey] = newHash[k];\r\n        }\r\n        else {\r\n            this._addTextWithPrefix(fullKey + '.', lang, newHash[k]);\r\n        }        \r\n    }\r\n\r\n    return res;\r\n}\r\n\r\n/** Добавить строки в словарь локализации\r\n @func addText\r\n @memberOf nsGmx.Translations\r\n @param {String} lang Язык, к которому добавляются строки\r\n @param {Object} strings Список добавляемых строк. Должен быть объектом, в котором атрибуты являются ключами перевода.\r\n                 Если значение атрибута - строка, то она записывается как результат локализации данного ключа.\r\n                 Если значение атрибута - другой объект, то название текущего атрибута будет добавлено с точкой \r\n                 к названию атрибутов в этом объекте. Например: {a: {b: 'бэ', c: 'це'}} сформируют ключи локализации 'a.b' и 'a.c'.\r\n*/\r\nTranslationsManager.prototype.addText = function(lang, newHash) {\r\n    this._addTextWithPrefix('', lang, newHash);\r\n}\r\n\r\n/** Получить локализованный текст по ключу для текущего языка\r\n @func getText\r\n @memberOf nsGmx.Translations\r\n @param {String} key Ключ локализации\r\n @return {String} Локализованный текст\r\n*/\r\nTranslationsManager.prototype.getText = function(dictKey) {\r\n    var lang = this.getLanguage(),\r\n        args = arguments,\r\n        getArg = function(i) {\r\n            return args[i + 1] || '';\r\n        };\r\n\r\n    if (!this.hash[lang] || !this.hash[lang][dictKey]) {\r\n        this._errorHandlers.forEach(function(handler) {handler(dictKey, lang);});\r\n        return '';\r\n    } else {\r\n        return this.hash[lang][dictKey].replace(/\\[value(\\d)\\]/g, function(match, argIndex) {\r\n            return getArg(Number(argIndex))\r\n        })\r\n    }\r\n}\r\n\r\n/** Установить текущий язык\r\n @func setLanguage\r\n @memberOf nsGmx.Translations\r\n @param {String} lang Текущий язык (eng/rus/...)\r\n*/\r\nTranslationsManager.prototype.setLanguage = function(lang) {\r\n    TranslationsManager.prototype._language = lang;\r\n}\r\n\r\n/** Получить текущий язык локализации\r\n @func getLanguage\r\n @memberOf nsGmx.Translations\r\n @return {String} Текущий язык (eng/rus/...)\r\n*/\r\nTranslationsManager.prototype.getLanguage = function() {\r\n    return TranslationsManager.prototype._language || \r\n           (typeof window !== 'undefined' && window.language) || \r\n           DEFAULT_LANGUAGE;\r\n}\r\n\r\n/** Добавить обработчик ошибок локализации. \r\n    При возникновении ошибок (не определён язык, не найден перевод) будет вызываться каждый из обработчиков\r\n @func addErrorHandler\r\n @memberOf nsGmx.Translations\r\n @param {function(text, lang)} Обработчик ошибки. В ф-цию передаётся текст и язык\r\n*/\r\nTranslationsManager.prototype.addErrorHandler = function(handler) {\r\n    this._errorHandlers.push(handler);\r\n}\r\n\r\n/** Считать из кук текущий язык локализации.\r\n * В куках отдельно записываются языки для каждого pathname, а не только для домена целиком\r\n @func getLanguageFromCookies\r\n @memberOf nsGmx.Translations\r\n @param {String} [pathname] Идентификатор проекта, для которого нужно запомнить куку. По умолчанию `window.location.pathname`.\r\n @return {String} Язык, записанный в куках для данного pathname\r\n*/\r\nTranslationsManager.prototype.getLanguageFromCookies = function(pathname) {\r\n    return _parseLanguageCookie()[pathname || window.location.pathname];\r\n}\r\n\r\n/** Записать в куки текущий язык локализации.\r\n * В куках отдельно записываются языки для каждого pathname, а не только для домена целиком\r\n @func updateLanguageCookies\r\n @memberOf nsGmx.Translations\r\n @param {String} lang Язык, который нужно записать в куку\r\n @param {String} [pathname] Идентификатор проекта, для которого нужно запомнить куку. По умолчанию `window.location.pathname`.\r\n*/\r\nTranslationsManager.prototype.updateLanguageCookies = function(lang, pathname) {\r\n    var langs = _parseLanguageCookie();\r\n    langs[pathname || window.location.pathname] = lang;\r\n    _saveLanguageCookie(langs);\r\n}\r\n\r\n/** Ф-ции для локализации пользовательского интерфейса\r\n @namespace nsGmx.Translations\r\n*/\r\n\r\nvar commonTranslationsManager = new TranslationsManager();\r\nTranslationsManager.commonManager = commonTranslationsManager;\r\n\r\n//хелпер для вставки локализованных констант в шаблоны. Например: {{i \"layerEditor.dialogTitle\"}}\r\nvar addHanlebarsHelper = function(Handlebars) {\r\n    Handlebars.registerHelper('i', function(dictKey) {\r\n        return commonTranslationsManager.getText(dictKey);\r\n    });\r\n}\r\n\r\naddHanlebarsHelper(Handlebars);\r\n\r\nnsGmx.Translations = commonTranslationsManager;\r\n\r\n//Поддерживаем обратную совместимость - глобальные объекты _gtxt, _translationsHash, translationsHash\r\nvar prev_gtxt = window._gtxt,\r\n    prev_translationsHash = window._translationsHash,\r\n    prevTranslationsHash = window.translationsHash;\r\n    \r\n/** Убирает из глобальной видимости все объекты и ф-ции, связанные с локализацией\r\n @name noConflicts\r\n @memberOf nsGmx.Translations\r\n*/\r\nTranslationsManager.prototype.noConflicts = function() {\r\n    window._gtxt = prev_gtxt;\r\n    window._translationsHash = prev_translationsHash;\r\n    window.translationsHash = prevTranslationsHash;\r\n}\r\n\r\n//Явно добавляем объекты в глобальную видимость\r\nvar DumpClass = function(){};\r\nDumpClass.prototype = commonTranslationsManager;\r\n\r\nwindow._translationsHash = new DumpClass();\r\nwindow._translationsHash.gettext = commonTranslationsManager.getText.bind(commonTranslationsManager);\r\nwindow._translationsHash.addtext = commonTranslationsManager.addText.bind(commonTranslationsManager);\r\nwindow._translationsHash.showLanguages = function() {\r\n    var langCanvas = _div(null, [['dir','className','floatRight'],['css','margin',' 7px 10px 0px 0px']]);\r\n    \r\n    for (var lang in this.hash)\r\n    {\r\n        if (lang != window.language)\r\n        {\r\n            var button = makeLinkButton(window._translationsHash.titles[lang]);\r\n            \r\n            button.style.marginLeft = '5px';\r\n            button.style.fontSize = '11px';\r\n\r\n            button.onclick = function(lang) {\r\n                window.translationsHash.updateLanguageCookies(lang);\r\n\r\n                if (nsGmx && nsGmx.GeomixerFramework) {\r\n                    window.language = lang;\r\n                    _mapHelper.reloadMap();\r\n                } else {\r\n                    window.location.reload();\r\n                }\r\n            }.bind(null, lang);\r\n            \r\n            _title(button, this.titles[lang]);\r\n            \r\n            langCanvas.appendChild(button);\r\n        }\r\n        else \r\n        {\r\n            langCanvas.appendChild(_span([_t(window._translationsHash.titles[lang])], [['css','marginLeft','5px'], ['css','color','#fc830b']]));\r\n        }\r\n    }\r\n\r\n    document.getElementById(\"headerLinks\").appendChild(langCanvas);\r\n};\r\n\r\nwindow._gtxt = function() {\r\n    return commonTranslationsManager.getText.apply(commonTranslationsManager, arguments);\r\n};\r\n\r\nwindow.translationsHash = {\r\n    getLanguageFromCookies: commonTranslationsManager.getLanguageFromCookies.bind(commonTranslationsManager),\r\n    updateLanguageCookies: commonTranslationsManager.updateLanguageCookies.bind(commonTranslationsManager)\r\n};\r\n\r\nwindow.gmxCore && window.gmxCore.addModule('translations',\r\n{\r\n    _translationsHash: window._translationsHash\r\n});\r\n\r\n\r\nconst translationsHash = window.translationsHash;\r\n\r\nexport { translationsHash };","import './translations.js';\r\n\r\n_translationsHash.flags[\"rus\"] = \"img/flag_ru.png\";\r\n\r\n_translationsHash.titles[\"rus\"] = \"Русский\";\r\n\r\n_translationsHash.hash[\"rus\"] = {\r\n\t\"Да\": \"Да\",\r\n\t\"Нет\": \"Нет\",\r\n\t\"Карта\" : \"Карта\",\r\n\t\"Создать\" : \"Создать\",\r\n\t\"Создать карту\" : \"Создать карту\",\r\n\t\"Сохранить\" : \"Сохранить\",\r\n\t\"Сохранить как\" : \"Сохранить как\",\r\n\t\"Сохранить карту как\" : \"Сохранить карту как\",\r\n\t\"Сохранить карту\" : \"Сохранить карту\",\r\n\t\"Экспорт\" : \"Экспорт\",\r\n\t\"Ссылки\" : \"Ссылки\",\r\n\r\n    \"Карта пожаров\": \"Карта пожаров\",\r\n    \"Платформа Геомиксер\": \"Веб-ГИС GeoMixer\",\r\n    \"http://fires.ru\": \"http://fires.ru\",\r\n    \"https://search.kosmosnimki.ru\": \"https://search.kosmosnimki.ru\",\r\n\r\n    \"Данные\": \"Данные\",\r\n    \"Сервисы\": \"Сервисы\",\r\n    \"Поделиться\": \"Поделиться\",\r\n    \"Открыть слой\": \"Открыть слой\",\r\n    \"Создать слой\": \"Создать слой\",\r\n    \"Растровый\": \"Растровый\",\r\n    \"Векторный\": \"Векторный\",\r\n    \"Создать группу\": \"Создать группу\",\r\n    \"Базовые слои\": \"Базовые слои\",\r\n    \"Подключить WMS\": \"Подключить WMS\",\r\n    \"Подключить WFS\": \"Подключить WFS\",\r\n    \"Объекты\": \"Объекты\",\r\n    \"Результаты поиска\": \"Результаты поиска\",\r\n    \"Буфер\": \"Буфер\",\r\n    \"Создание буферных зон\": \"Создание буферных зон\",\r\n    \"Ручная привязка растров\": \"Ручная привязка растров\",\r\n    \"Поиск слоев на карте\": \"Поиск слоев на карте\",\r\n    \"Краудсорсинг данных\": \"Краудсорсинг данных\",\r\n    \"Пакетный геокодинг\": \"Пакетный геокодинг\",\r\n    \"Маршруты\": \"Маршруты\",\r\n    \"Кадастр Росреестра\": \"Кадастр Росреестра\",\r\n    \"Выбрать кадастровый объект\": \"Выбрать кадастровый объект\",\r\n    \"Викимапиа\": \"Викимапиа\",\r\n    \"Каталог СКАНЭКС\": \"Поиск снимков\",\r\n    \"Космоснимки-пожары\": \"Космоснимки-пожары\",\r\n    \"GIBS NASA\": \"Съёмка MODIS (NASA)\",\r\n    \"Руководство пользователя\": \"Документация\",\r\n    \"Руководство\": \"Руководство пользователя\",\r\n    \"GeoMixer API\": \"GeoMixer API\",\r\n    \"Использование плагинов\": \"Использование плагинов\",\r\n\t\"копия\": \"копия\",\r\n\r\n\t\"Открыть\" : \"Открыть\",\r\n\t\"Слой\" : \"Слой\",\r\n\t\"Создать векторный слой\" : \"Создать векторный слой\",\r\n\t\"Создать растровый слой\" : \"Создать растровый слой\",\r\n\t\"Создать мультислой\" : \"Создать мультислой\",\r\n\t\"Вид\" : \"Вид\",\r\n\t\"Дерево слоев\" : \"Дерево слоев\",\r\n\t\"Объекты на карте\" : \"Объекты на карте\",\r\n\t\"Координатная сетка\" : \"Координатная сетка\",\r\n\t\"Индексная сетка\" : \"Индексная сетка\",\r\n\t\"Панель оверлеев\" : \"Панель оверлеев\",\r\n\t\"Загрузить объекты\" : \"Загрузить объекты\",\r\n\t\"Загрузить фотографии\" : \"Загрузить фотографии\",\r\n\t\"Загрузить данные\" : \"Загрузить данные\",\r\n\t\t\"WFS сервер\" : \"WFS сервер\",\r\n\t\t\"WMS сервер\" : \"WMS сервер\",\r\n\t\t\"Кадастровые данные\" : \"Кадастровые данные\",\r\n\t\"Ссылка на карту\" : \"Ссылка на карту\",\r\n\t\"Код для вставки\" : \"Код для вставки карты\",\r\n\t\"Печать\" : \"Печать\",\r\n\t\"Привязать изображение\" : \"Привязать изображение\",\r\n\t\"Сообщить об ошибке на карте\" : \"Сообщить об ошибке на карте\",\r\n\t\"Справка\" : \"Справка\",\r\n\t\"Использование\" : \"Использование\",\r\n\t\"О проекте\" : \"О проекте/Контакты\",\r\n\t\"$$phrase$$_1\" : \"Укажите карту в параметре defaultMapID в файле config.js\",\r\n\t\"У вас нет прав на просмотр данной карты\" : \"У вас нет прав на просмотр данной карты\",\r\n\t\"Access error\" : \"У вас нет прав на просмотр данной карты\",\r\n\t\"Map not found\" : \"Данная карта не существует\",\r\n\t\"Unable to locate EXIF content\" : \"отсутствуют координаты в EXIF\",\r\n\t\"Развернуть карту\" : \"Развернуть карту\",\r\n\t\"Свернуть карту\" : \"Свернуть карту\",\r\n\t\"Точки на изображении:\" : \"Точки на изображении:\",\r\n\t\"Точки на карте:\" : \"Точки на карте:\",\r\n\t\"Координаты\" : \"Координаты\",\r\n\t\"Нарисовать\" : \"Нарисовать\",\r\n\t\"Восстановить\" : \"Восстановить\",\r\n\t\"Видимость\" : \"Видимость\",\r\n\t\"Привязка изображения\" : \"Привязка изображения\",\r\n\t\"$$phrase$$_2\" : \"Точка [value0] находится за пределами изображения\",\r\n\t\"$$phrase$$_3\" : \"Не задана точка [value0] на карте\",\r\n\t\"Соответствие точек\" : \"Соответствие точек\",\r\n\t\"$$phrase$$_4\" : \"Точки 1 и 2 на изображении совпадают\",\r\n\t\"$$phrase$$_5\" : \"Точки 1 и 3 на изображении совпадают\",\r\n\t\"$$phrase$$_6\" : \"Точки 2 и 3 на изображении совпадают\",\r\n\t\"$$phrase$$_7\" : \"Точки 1 и 2 на карте совпадают\",\r\n\t\"$$phrase$$_8\" : \"Точки 1 и 3 на карте совпадают\",\r\n\t\"$$phrase$$_9\" : \"Точки 2 и 3 на карте совпадают\",\r\n\t\"$$phrase$$_10\" : \"Точки на изображении лежат на одной прямой\",\r\n\t\"Создать экскурсию\" : \"Создать экскурсию\",\r\n\t\"Чтобы пользоваться этим сайтом, установите Flash Player\" : \"Чтобы пользоваться этим сайтом, установите Flash Player\",\r\n\t\"из Интернет\" : \"из Интернет\",\r\n\t\"или с локального диска \" : \"или с локального диска \",\r\n\t\"для Internet Explorer\" : \"для Internet Explorer\",\r\n\t\" или \" : \" или \",\r\n\t\"для Internet Firefox\" : \"для Internet Firefox\",\r\n\t\"Скачать shp-файл\" : \"Скачать shp-файл\",\r\n\t\"shp-файл\" : \"shp-файл\",\r\n\t\"gpx-файл\" : \"gpx-файл\",\r\n\t\"Скачать фрагмент растра\" : \"Скачать фрагмент растра\",\r\n\t\"точка\" : \"точка\",\r\n\t\"линия\" : \"линия\",\r\n\t\"прямоугольник\" : \"прямоугольник\",\r\n\t\"многоугольник\" : \"многоугольник\",\r\n\t\"Скачать\" : \"Скачать\",\r\n\t\"Введите имя файла для скачивания\" : \"Введите имя файла для скачивания\",\r\n\t\"Выберите область рамкой на карте\" : \"Выберите область рамкой на карте\",\r\n\t\"Вырезать фрагмент растра\" : \"Вырезать фрагмент растра\",\r\n\t\"К прямоугольнику не подходит ни одного растрового слоя\" : \"К прямоугольнику не подходит ни одного растрового слоя\",\r\n\t\"Загруженный shp-файл пуст\" : \"Загруженный shp-файл пуст\",\r\n\t\"Ошибка скачивания\" : \"Ошибка скачивания\",\r\n\t\"Обновить\" : \"Обновить\",\r\n\t\"Домашняя директория\" : \"Директория проекта\",\r\n\t\"Имя папки\" : \"Имя папки\",\r\n\t\"Имя\" : \"Имя\",\r\n\t\"Размер\" : \"Размер\",\r\n\t\"Дата\" : \"Дата\",\r\n    \"Дата создания\": \"Дата создания\",\r\n\t\"Снять выделение\" : \"Снять выделение\",\r\n\t\"Скопировать\" : \"Скопировать\",\r\n\t\"Удалить\" : \"Удалить\",\r\n\t\"Извлечь\" : \"Извлечь\",\r\n\t\"Упаковать\" : \"Упаковать\",\r\n\t\"Загрузить\" : \"Загрузить\",\r\n    \"Параметр\" : \"Параметр\",\r\n    \"Значение\" : \"Значение\",\r\n    \"VALUE\" : \"VALUE\",\r\n    \"WHERE\" : \"WHERE\",\r\n    \"Операторы\" : \"Операторы\",\r\n    \"Функции\" : \"Функции\",\r\n    \"Метаданные\": \"Метаданные\",\r\n    \"Редактировать колонки\": \"Редактировать колонки\",\r\n\t\"URL сервера\" : \"URL сервера\",\r\n\t\"Формат изображения\" : \"Формат изображения\",\r\n\t\"Введите имя gml-файла для скачивания:\" : \"Введите имя gml-файла для скачивания:\",\r\n\t\"точки\" : \"точки\",\r\n\t\"линии\" : \"линии\",\r\n\t\"полигоны\" : \"полигоны\",\r\n\t\"(ссылка)\" : \"(ссылка)\",\r\n\t\"Сохранить состояние карты\" : \"Сохранить состояние карты\",\r\n\t\"Ссылка на текущее состояние карты\" : \"Ссылка на текущее состояние карты\",\r\n\t\"Добавить стиль\" : \"Добавить стиль\",\r\n\t\"Атрибут >\" : \"Атрибут >\",\r\n\t\"Значение >\" : \"Значение >\",\r\n\t\"Операция >\" : \"Операция >\",\r\n\t\"Накладываемое изображение\" : \"Накладываемое изображение\",\r\n\t\"Цвет\" : \"Цвет\",\r\n\t\"Прозрачность\" : \"Прозрачность\",\r\n\t\"Авторизуйтесь для редактирования фильтров\" : \"Авторизуйтесь для редактирования фильтров\",\r\n\t\"Имя фильтра\" : \"Имя фильтра\",\r\n\t\"Переместить фильтр вверх\" : \"Переместить фильтр вверх\",\r\n\t\"Переместить фильтр вниз\" : \"Переместить фильтр вниз\",\r\n\t\"Удалить фильтр\" : \"Удалить фильтр\",\r\n\t\"Размер шрифта\" : \"Размер шрифта\",\r\n\t\"Смещение\" : \"Смещение\",\r\n\t\"Смещение по x\" : \"Смещение по x\",\r\n\t\"Смещение по y\" : \"Смещение по y\",\r\n\t\"Имя атрибута\" : \"Имя атрибута\",\r\n\t\"Граница обрезки\" : \"Граница обрезки\",\r\n\t\"Граница\" : \"Граница\",\r\n\t\"Толщина линии\" : \"Толщина линии\",\r\n\t\"Заливка\" : \"Заливка\",\r\n    \"Заливка цветом\": \"Заливка цветом\",\r\n    \"Заливка штриховкой\": \"Заливка штриховкой\",\r\n    \"Заливка рисунком\": \"Заливка рисунком\",\r\n    \"Ширина паттерна\": \"Ширина паттерна\",\r\n    \"Ширина отступа\": \"Ширина отступа\",\r\n    \"URL рисунка\": \"URL рисунка\",\r\n\t\"Маркер URL\" : \"Маркер URL\",\r\n\t\"URL изображения\" : \"URL изображения\",\r\n    \"Изображение\" : \"Изображение\",\r\n\t\"Размер точек\" : \"Размер точек\",\r\n\t\"Редактировать стили\" : \"Редактировать стили\",\r\n\t\"Авторизуйтесь для редактирования настроек слоя\" : \"Авторизуйтесь для редактирования настроек слоя\",\r\n\t\"Недостаточно прав для редактирования настроек слоя\" : \"Недостаточно прав для редактирования настроек слоя\",\r\n\t\"Недостаточно прав для редактирования объектов слоя\" : \"Недостаточно прав для редактирования объектов слоя\",\r\n\t\"ID\" : \"ID\",\r\n\t\"Описание\" : \"Описание\",\r\n\t\"Файл\" : \"Файл\",\r\n\t\"Таблица\" : \"Таблица\",\r\n\t\"Каталог с тайлами\" : \"Каталог с тайлами\",\r\n\t\"Каталог растров\" : \"Каталог растров\",\r\n    \"Источник\": \"Источник\",\r\n    \"Данные с датой\": \"Разбить по датам\",\r\n\r\n    \"Дополнительно\": \"Дополнительно\",\r\n    \"Шаблон названий объектов\": \"Шаблон названий объектов\",\r\n\t\"Y (широта)\" : \"Y (широта)\",\r\n\t\"X (долгота)\" : \"X (долгота)\",\r\n\t\"Каталог\" : \"Каталог\",\r\n\t\"Изменить\" : \"Изменить\",\t\r\n\t\"Вид вложенных элементов\" : \"Вид вложенных элементов\",\r\n\t\"Использовать KosmosnimkiAPI\" : \"Загрузить подложки Kosmosnimki\",\r\n\t\"Использовать OpenStreetMap\" : \"Использовать OpenStreetMap\",\r\n\t\"Язык по умолчанию\" : \"Язык по умолчанию\",\r\n    \"Единицы длины\": \"Единицы длины\",\r\n    \"Единицы площади\": \"Единицы площади\",\r\n\t\"Формат координат\": \"Формат координат\",\r\n    \"units.auto\": \"авто\",\r\n    \"units.m\": \"м\",\r\n    \"units.km\": \"км\",\r\n    \"units.nm\": \"м. мили\",\r\n    \"units.m2\": \"м<sup>2\",\r\n    \"units.ha\": \"га\",\r\n    \"units.km2\": \"км<sup>2\",\r\n\t\"coords.dd\" : \"dd.dddd\",\r\n\t\"coords.dms\" : \"dd°mm′ss″\",\r\n\t\"Генерализация\" : \"Генерализация\",\r\n\t\"gereralization.on\": \"включить\",\r\n\t\"gereralization.off\": \"выключить\",\r\n\t\"gereralization.disable\": \"использовать настройки слоев\",\r\n\t\"Количество информационных окошек\" : \"Количество информационных окошек\",\r\n    \"layerOrder.title\": \"Порядок слоёв\",\r\n    \"layerOrder.native\": \"Стандартный\",\r\n    \"layerOrder.vectorOnTop\": \"Вектора сверху\",\r\n\t\"Разрешить поиск в векторных слоях\" : \"Разрешить поиск в векторных слоях\",\r\n\t\"Начальная позиция\" : \"Начальная позиция\",\r\n\t\"Широта\" : \"Широта\",\r\n\t\"Долгота\" : \"Долгота\",\r\n\t\"placeholder degrees\": \"dd.dddd\",\r\n\t\"placeholder zoom\": \"1-21\",\r\n\t\"placeholder minZoom\": \"1\",\r\n\t\"placeholder maxZoom\": \"21\",\r\n\t\"Зум\" : \"Зум\",\r\n\t\"Ссылка (permalink)\" : \"Ссылка (permalink)\",\r\n\t\"Разрешить скачивание\" : \"Разрешить скачивание\",\r\n\t\"Векторных слоев\" : \"Векторных слоев\",\r\n\t\"Растровых слоев\" : \"Растровых слоев\",\r\n\t\"Масштабирование в миникарте\" : \"Масштабирование в миникарте\",\r\n\t\"Показывать всплывающие подсказки\" : \"Показывать всплывающие подсказки\",\r\n\t\"Свойства\" : \"Свойства\",\r\n\t\"Создать копию слоя\" : \"Создать копию слоя\",\r\n\t\"Стили\" : \"Стили\",\r\n\t\"Изображение на карте\" : \"Изображение на карте\",\r\n\t\"Слой [value0]\" : \"Слой [value0]\",\r\n    \"Стили слоя [value0]\" : \"Стили слоя [value0]\",\r\n\t\"Мультислой [value0]\" : \"Мультислой [value0]\",\r\n\t\"Группа [value0]\" : \"Группа [value0]\",\r\n\t\"Карта [value0]\" : \"Карта [value0]\",\r\n\t\"Редактировать стиль\" : \"Редактировать стиль\",\r\n\t\"Редактирование стилей объекта\" : \"Редактирование стилей объекта\",\r\n\t\"Стили слоя\" : \"Стили слоя\",\r\n\t\"Навигация по карте и инструменты\" : \"Навигация по карте и инструменты\",\r\n\t\"Стиль векторного слоя\" : \"Стиль векторного слоя\",\r\n\t\"Управление содержанием карты\" : \"Управление содержанием карты\",\r\n\t\"Пользовательские инструменты\" : \"Пользовательские инструменты\",\r\n\t\"$$help$$_1\" : \"Держите нажатой левую клавишу мыши – перетаскивайте карту курсором. Для приближения и удаления используйте колесико мыши (карта зуммируется к точке под курсором). Для перецентровки по координатам – введите их в строке поиска.\",\r\n\t\"$$help$$_2\" : \"В левой панели отображается список слоев в виде дерева. Для перецентровки карты по экстенту слоя – кликните по его названию в списке. Если данная опция включена администратором карты, вы можете скачивать векторные слои и вырезать и скачивать фрагменты растровых слоев.\",\r\n\t\"$$help$$_3\" : \"Для редактирования стиля векторного слоя кликните на иконку перед названием слоя.\",\r\n\t\"$$help$$_4\" : \"Карта представляет собой набор слоев, отображение которого задается с помощью списка слоев. Чтобы иметь возможность редактировать набор слоев (создавать группы, изменять порядок отображения и т.д.) и сохранять изменения – необходимо авторизоваться. Более подробно см \",\r\n\t\" - Руководство пользователя\" : \" - Руководство пользователя\",\r\n\t\"$$help$$_5\" : \"Пользовательские инструменты одновременно служат для создания объектов на карте, которые затем можно сохранять через «ссылку на карту», и для выполнения простых аналитических функций. \",\r\n\t\"В режиме маркеров: \" : \"В режиме маркеров: \",\r\n\t\"$$help$$_6\" : \"одиночный клик - добавить маркер. Двойной клик по маркеру - удалить. Клик на маркер – открыть всплывающее окошко (балун), клик по балуну – добавить надпись.\",\r\n\t\"В режиме линейка/измерения расстояния, полигон/измерение площади: \" : \"В режиме линейка/измерения расстояния, полигон/измерение площади: \",\r\n\t\"$$help$$_7\" : \"одиночный клик - добавить вершину. Двойной клик - завершить фигуру. Клик на линию - добавить вершину. Двойной клик по вершине - удалить.\",\r\n\t\"$$help$$_8\" : \"Кликните по объекту в списке «объектов на карте», чтобы перецентровать карту на него. Вы можете скачать контуры объектов в shp/tab/kml формате.\",\r\n\t\"$$about$$_1\" : \"это веб-приложение для интерактивного просмотра геоданных и доступа к источникам базовых геоданных в интернете, таким как: \",\r\n\t\"$$about$$_2\" : \"С помощью GeoMixer можно публиковать собственные геоданные во внутренней сети предприятий или в интернет, накладывать их поверх базовых источников и предоставлять к ним доступ для совместной работы сколь угодно большому числу пользователей, разграничивая права доступа.\",\r\n\t\"$$about$$_3\" : \"GeoMixer также включает компонент API, который позволяет встраивать созданные проекты в сторонние веб-сайты и приложения и программно управлять фукционалом интерактивной карты.\",\r\n\t\" - Общее описание\" : \" - Общее описание\",\r\n\t\" - Руководство разработчика\" : \" - Руководство разработчика\",\r\n\t\"Получить API-ключ\" : \"Получить API-ключ\",\r\n\t\"Введите API-ключ\" : \"Введите API-ключ\",\r\n\t\"Печать карты\" : \"Печать карты\",\r\n\t\"$$serviceHelp$$_1\" : \"Позволяет на лету загрузить shp/tab/kml файл небольшого размера в виде пользовательских объектов. После загрузки пользователь может редактировать геометрию объектов и скачивать объекты в том же наборе форматов.\",\r\n\t\"$$serviceHelp$$_2\" : \"По ссылке запоминается текущее положение карты, а так же пользовательские объекты и надписи.\",\r\n\t\"$$serviceHelp$$_3\" : \"Отправляет на печать текущий фрагмент карты.\",\r\n\t\"Редактировать\" : \"Редактировать\",\r\n    \"Удалить объект?\": \"Удалить объект?\",\r\n    \"Удалить отмеченные объекты?\": \"Удалить отмеченные объекты?\",\r\n\t\"Длина\" : \"Длина\",\r\n\t\"Площадь\" : \"Площадь\",\r\n\t\"Добавить подгруппу\" : \"Добавить группу\",\r\n\t\"Введите имя группы\" : \"Создание новой группы\",\r\n\t\"Имя группы\" : \"Имя группы\",\r\n\t\"Включая вложенные слои\" : \"Включая вложенные слои\",\r\n\t\"Удаление группы [value0]\" : \"Удаление группы [value0]\",\r\n\t\"Сохранено\" : \"Сохранено\",\r\n\t\"Прозрачность выбранного слоя/группы/карты\" : \"Прозрачность выбранного слоя/группы/карты\",\r\n\t\"$$updateInfo$$_1\" : \"Для отображения нового слоя необходимо сохранить и перезагрузить карту\",\r\n\t\"Любой\" : \"Любой\",\r\n\t\"Владелец\" : \"Владелец\",\r\n\t\"Последнее изменение\": \"Последнее изменение\",\r\n\t\"Список слоев\" : \"Список слоев\",\r\n\t\"Вы действительно хотите удалить этот слой?\" : \"Вы действительно хотите удалить этот слой?\",\r\n\t\"Ошибка!\" : \"Ошибка!\",\r\n\t\"Ошибка\" : \"Ошибка\",\r\n\t\"Выберите колонку\" : \"Выберите колонку\",\r\n\t\"Список карт\" : \"Список карт\",\r\n\t\"Показать\" : \"Показать\",\r\n\t\"загрузка...\" : \"загрузка...\",\r\n\t\"удаление...\" : \"удаление...\",\r\n\t\"Вы действительно хотите удалить эту карту?\" : \"Вы действительно хотите удалить эту карту?\",\r\n    \"maplist.hint\": \"Группы и слои можно перетащить в текущую карту\",\r\n\t\"Слоя нет в базе\" : \"Слоя нет в базе\",\r\n\t\"ScanEx Web Geomixer - просмотр карты\" : \"ScanEx Web Geomixer - просмотр карты\",\r\n\t\"Изменить параметры поиска\" : \"Изменить параметры поиска\",\r\n\t\"$$search$$_1\" : \"Поиск по векторным слоям и адресной базе\",\r\n\t\"$$search$$_2\" : \"Поиск по адресной базе\",\r\n\t\"Поиск не дал результатов\" : \"Поиск не дал результатов\",\r\n\t\"Очистить\" : \"Очистить\",\r\n\t\"Регистрация\" : \"Регистрация\",\r\n\t\"Восстановление пароля\" : \"Восстановление пароля\",\r\n\t\"Вход\" : \"Вход\",\r\n\t\"Выход\" : \"Выход\",\r\n\t\"Логин\" : \"Логин\",\r\n\t\"Пароль\" : \"Пароль\",\r\n\t\"пароль\" : \"пароль\",\r\n    \"Псевдоним\": \"Псевдоним\",\r\n    \"Полное имя\": \"Полное имя\",\r\n\t\"Пожалуйста, авторизуйтесь\" : \"Пожалуйста, авторизуйтесь\",\r\n    \"адрес электронной почты\": \"адрес электронной почты\",\r\n\t\"Ошибка сервера\" : \"Ошибка сервера\",\r\n\t\"Папка\" : \"Папка\",\r\n\t\" и \" : \" и \",\r\n\t\"Название\" : \"Название\",\r\n\t\"Рейтинг\" : \"Рейтинг\",\r\n\t\"Автор\" : \"Автор\",\r\n\t\"Тематика\" : \"Тематика\",\r\n\t\"Развлекательная\" : \"Развлекательная\",\r\n\t\"Спортивная\" : \"Спортивная\",\r\n\t\"Историческая\" : \"Историческая\",\r\n\t\"Экологическая\" : \"Экологическая\",\r\n\t\"Любая\" : \"Любая\",\r\n\t\"Создать новую тему\" : \"Создать новую тему\",\r\n\t\"Начало периода\" : \"Начало периода\",\r\n\t\"Окончание периода\" : \"Окончание периода\",\r\n\t\"Накладываемые тайлы\" : \"Накладываемые тайлы\",\r\n\t\"Отображать с зума\" : \"Отображать с зума\",\r\n\t\"По\" : \"по\",\r\n\t\"Фильтр\" : \"Фильтр\",\r\n\t\"Подпись\" : \"Подпись\",\r\n\t\"Балун\" : \"Подсказка при наведении и клике\",\r\n\t\"По умолчанию\" : \"По умолчанию\",\r\n\t\"Показывать при клике\": \"Показывать при клике\",\r\n\t\"Показывать при наведении\": \"Показывать при наведении\",\r\n\t\"Символика\" : \"Символика\",\r\n    \"Библиотека стилей\": \"Библиотека стилей\",\r\n    \"Настройка стилей\": \"Настройка стилей\",\r\n\t\"скопировать\": \"скопировать\",\r\n\t\"применить везде\": \"применить везде\",\r\n\t\"Применить\": \"Применить\",\r\n\t\"Кластеризация\" : \"Кластеризация\",\r\n\t\"Минимальный\" : \"Минимальный\",\r\n\t\"Максимальный\" : \"Максимальный\",\r\n\t\"Мин. зум\" : \"Мин. зум\",\r\n\t\"Макс. зум\" : \"Макс. зум\",\r\n\t\"Тип\" : \"Тип\",\r\n\t\"Пешеходная\" : \"Пешеходная\",\r\n\t\"Велосипедная\" : \"Велосипедная\",\r\n\t\"Автомобильная\" : \"Автомобильная\",\r\n\t\"Речная\" : \"Речная\",\r\n\t\"Места\" : \"Места\",\r\n\t\"Маршрут\" : \"Маршрут\",\r\n\t\"Редактировать экскурсию\" : \"Редактировать экскурсию\",\r\n\t\"Добавьте маршрут\" : \"Добавьте маршрут\",\r\n\t\"Выберете темы на пути следования\" : \"Выберете темы на пути следования\",\r\n\t\"$$phrase$$_11\" : \"Добавьте маршрут при помощи инструмента \\\"Линия\\\" на панели инструментов\",\r\n\t\"$$phrase$$_12\" : \"Нет подходящих объектов на карте\",\r\n\t\"Выбор маршрута\" : \"Выбор маршрута\",\r\n\t\"Выбор мест\" : \"Выбор мест\",\r\n\t\"$$phrase$$_13\" : \"У вас нет опубликованных тем на карте. Вы можете добавить тему в разделе Вид-Обсуждения\",\r\n\t\"Обсуждения\" : \"Обсуждения\",\r\n\t\"Экскурсии\" : \"Экскурсии\",\r\n\t\"$$phrase$$_14\" : \"Невозможно удалить карту, использующуюся в качестве карты по умолчанию\",\r\n\t\"$$phrase$$_15\" : \"Невозможно удалить загруженную карту\",\r\n\t\"Назад\" : \"Назад\",\r\n\t\"Вперед\" : \"Вперед\",\r\n\t\"$$phrase$$_16\" : \"Альбома с указанным ID изображения не существует\",\r\n\t\"Редактировать альбом\" : \"Редактировать альбом\",\r\n\t\"Оценить\" : \"Оценить\",\r\n\t\"Поставьте маркер\" : \"Поставьте маркер\",\r\n\t\"на карту и переместите его в нужное место.\" : \"на карту и переместите его в нужное место.\",\r\n\t\"Недостаточно прав для совершения операции\" : \"Недостаточно прав для совершения операции\",\r\n\t\"Новая папка\" : \"Новая папка\",\r\n\t\"Выбрать\" : \"Выбрать\",\r\n\t\"Добавить\" : \"Добавить\",\r\n\t\"$$serviceHelp$$_4\" : \"Пользователь может встроить созданную карту в другой сайт, скопировав код и вставив его внутрь HTML. Требуется указать api-ключ для сайта, на котором будет использоваться данный код.\",\r\n\t\"Масштаб\" : \"Масштаб\",\r\n\t\"Угол поворота\" : \"Угол поворота\",\r\n\t\"Диаграммы\" : \"Диаграммы\",\r\n\t\"График по времени\" : \"График по времени\",\r\n\t\"Маска атрибутов\" : \"Маска атрибутов\",\r\n\t\"Закладки\" : \"Закладки\",\r\n\t\"Добавить закладку\" : \"Добавить закладку\",\r\n\t\"Имя закладки\" : \"Имя закладки\",\r\n\t\"Дерево\" : \"Дерево\",\r\n\t\"Поиск слоев\" : \"Поиск слоев\",\r\n\t\"Пример выражения\": \"[Атрибут1]\\n[Атрибут2]\\nпроизвольный текст\",\r\n\t\"Шкала прозрачности\" : \"Шкала прозрачности\",\r\n\t\"Цвет заливки\" : \"Цвет заливки\",\r\n\t\"Цвет обводки\" : \"Цвет обводки\",\r\n\t\"Цвет шрифта\" : \"Цвет шрифта\",\r\n\t\"Легенда\" : \"Легенда\",\r\n\t\"Событие загрузки карты\" : \"Событие загрузки карты\",\r\n\t\"Мин\" : \"Мин\",\r\n\t\"Макс\" : \"Макс\",\r\n\t\"График\" : \"График\",\r\n\t\"Гистограмма\" : \"Гистограмма\",\r\n\t\"Столбчатая\" : \"Столбчатая\",\r\n\t\"Временная\" : \"Временная\",\r\n\t\"Круговая\" : \"Круговая\",\r\n\t\"Копировать стиль\" : \"Копировать стиль\",\r\n\t\"Применить стиль\" : \"Применить стиль\",\r\n\t\"Не выбран стиль\" : \"Не выбран стиль\",\r\n\t\"Невозможно применить стиль к другому типу геометрии\" : \"Невозможно применить стиль к другому типу геометрии\",\r\n\t\"Общие\" : \"Общие\",\r\n\t\"Доступ\" : \"Доступ\",\r\n\t\"Окно карты\" : \"Окно карты\",\r\n\t\"Загрузка\" : \"Загрузка\",\r\n\t\"Копирайт\" : \"Копирайт\",\r\n\t\"Инструменты\" : \"Инструменты\",\r\n\t\"Загрузить KML\" : \"Загрузить KML\",\r\n\t\"URL файла\" : \"URL файла\",\r\n\t\"Поиск\" : \"Поиск\",\r\n    \"Подложки\": \"Подложки\",\r\n    \"Доступные подложки\": \"Доступные подложки\",\r\n    \"Подложки карты\": \"Подложки карты\",\r\n    \"Выберите слои для поиска по атрибутам\": \"Выберите слои для поиска по атрибутам\",\r\n\t\"Включить синхронизацию слоев\": \"Включить синхронизацию слоев\",\r\n\t\"Выключить синхронизацию слоев\": \"Выключить синхронизацию слоев\",\r\n\r\n\t\"Редактирование прав доступа карты [value0]\" : \"Редактирование прав доступа карты [value0]\",\r\n\t\"Редактирование прав доступа слоя [value0]\" : \"Редактирование прав доступа слоя [value0]\",\r\n\t\"Редактирование прав доступа слоев карты [value0]\" : \"Редактирование прав доступа слоев карты [value0]\",\r\n\t\"Состав группы [value0]\" : \"Состав группы [value0]\",\r\n\t\"Роль\" : \"Роль\",\r\n\t\"Добавить пользователя\" : \"Добавить пользователя\",\r\n\t\"Права доступа\" : \"Права доступа\",\r\n\t\"Права доступа к слоям\" : \"Права доступа к слоям\",\r\n\t\"Пользователи без прав доступа:\" : \"Пользователи без прав доступа:\",\r\n\t\"Пользователи с правами доступа:\" : \"Пользователи с правами доступа:\",\r\n\t\"Выберите нового владельца\" : \"Выберите нового владельца\",\r\n\t\"Сменить владельца\" : \"Сменить владельца\",\r\n\r\n\t\"Объекты RuMap\" : \"Данные RuMap\",\r\n\t\"Объекты пользователей\" : \"Данные пользователей\",\r\n\r\n\r\n\t\"Контакты\" : \"Контакты\",\r\n\t\"Фотографии\" : \"Фотографии\",\r\n\t\"Момент съемки\" : \"Момент съемки\",\r\n\t\"Видео\" : \"Видео\",\r\n\t\"Сообщения\" : \"Сообщения\",\r\n\t\"Ссылка на место\" : \"Ссылка на место\",\r\n\t\"Ссылка на экскурсию\" : \"Ссылка на экскурсию\",\r\n\t\"Ссылка на событие\" : \"Ссылка на событие\",\r\n\t\"Создать новое событие\" : \"Создать новое событие\",\r\n\t\"События\" : \"События\",\r\n\t\"Календарь\" : \"Календарь\",\r\n\t\"Новости\" : \"Новости\",\r\n\t\"Мероприятия\" : \"Мероприятия\",\r\n\t\"Отмена\" : \"Отмена\",\r\n\t\"Пропустить\" : \"Пропустить\",\r\n\t\"Время\" : \"Время\",\r\n\t\"Альбом OpenPhotoVR\" : \"Фотоальбом\",\r\n\t\"Встраиваемый код\" : \"Встраиваемое видео\",\r\n\r\n\t\"Объекты экологического риска\" : \"Объекты экологического риска\",\r\n\t\t\"Санкционированные свалки\" : \"Санкционированные свалки\",\r\n\t\t\"Несанкционированные свалки\" : \"Несанкционированные свалки\",\r\n\t\t\"Полигоны отходов\" : \"Полигоны отходов\",\r\n\t\t\"Предприятия переработки отходов\" : \"Предприятия переработки отходов\",\r\n\t\t\"Факельные установки, ТЭЦ, трубы\" : \"Факельные установки, ТЭЦ, трубы\",\r\n\t\t\"Закрытые свалки\" : \"Закрытые свалки\",\r\n\t\t\"Пункты приема отходов\" : \"Пункты приема отходов\",\r\n\t\t\"Оползни\" : \"Оползни\",\r\n\t\t\"Карстовые явления\" : \"Карстовые явления\",\r\n\t\t\"Суффозионные явления\" : \"Суффозионные явления\",\r\n\r\n\t\"Государство и общество\" : \"Государство и общество\",\r\n\t\t\"Радио\" : \"Радиостанции\",\r\n\t\t\"Правительственные учреждения\" : \"Правительственные учреждения\",\r\n\t\t\"Оптики\" : \"Оптики\",\r\n\t\t\"Охранные агенства\" : \"Охранные агенства\",\r\n\t\t\"Травмпункты\" : \"Травмпункты\",\r\n\t\t\"Таможня\" : \"Таможня\",\r\n\t\t\"Ветеринарные клиники\" : \"Ветеринарные клиники\",\r\n\t\t\"ЗАГС\" : \"ЗАГС\",\r\n\t\t\"Больницы\" : \"Больницы\",\r\n\t\t\"Аптеки\" : \"Аптеки\",\r\n\t\t\"Поликлиники\" : \"Поликлиники\",\r\n\t\t\"Колледжи\" : \"Колледжи\",\r\n\t\t\"Университеты\" : \"Университеты\",\r\n\t\t\"ОВИР\" : \"ОВИР\",\r\n\t\t\"Посольства\" : \"Посольства\",\r\n\t\t\"Почтовые отделения\" : \"Почтовые отделения\",\r\n\t\t\"Суды\" : \"Суды\",\r\n\t\t\"Банки\" : \"Банки\",\r\n\t\t\"Родильные дома\" : \"Родильные дома\",\r\n\t\t\"Дома престарелых\" : \"Дома престарелых\",\r\n\t\t\"Детские сады\" : \"Детские сады\",\r\n\t\t\"Школы\" : \"Школы\",\r\n\t\t\"Инспекции\" : \"Инспекции\",\r\n\t\t\"Адвокаты\" : \"Адвокаты\",\r\n\t\t\"МЧС\" : \"МЧС\",\r\n\t\t\"Муниципальные учреждения\" : \"Муниципальные учреждения\",\r\n\t\t\"Администрация\" : \"Администрация\",\r\n\r\n\t\"Культура и отдых\" : \"Культура и отдых\",\r\n\t\t\"Боулинг\" : \"Боулинг\",\r\n\t\t\"Аквапарки\" : \"Аквапарки\",\r\n\t\t\"Парки развлечений\" : \"Парки развлечений\",\r\n\t\t\"Библиотеки\" : \"Библиотеки\",\r\n\t\t\"Памятники\" : \"Памятники\",\r\n\t\t\"Лагери отдыха\" : \"Лагери отдыха\",\r\n\t\t\"Кинотеатры\" : \"Кинотеатры\",\r\n\t\t\"Цирки\" : \"Цирки\",\r\n\t\t\"Галереи\" : \"Галереи\",\r\n\t\t\"Отели\" : \"Отели\",\r\n\t\t\"Мотели\" : \"Мотели\",\r\n\t\t\"Музеи\" : \"Музеи\",\r\n\t\t\"Концертные залы\" : \"Концертные залы\",\r\n\t\t\"Ночные клубы\" : \"Ночные клубы\",\r\n\t\t\"Театры\" : \"Театры\",\r\n\t\t\"Санатории\" : \"Санатории\",\r\n\t\t\"Зоопарки\" : \"Зоопарки\",\r\n\r\n\t\"Общественное питание\" : \"Общественное питание\",\r\n\t\t\"Кафе\" : \"Кафе\",\r\n\t\t\"Фастфуды\" : \"Фастфуды\",\r\n\t\t\"Рестораны\" : \"Рестораны\",\r\n\t\t\"Кафе-мороженое\" : \"Кафе-мороженое\",\r\n\t\t\"Столовые\" : \"Столовые\",\r\n\r\n\t\"Природные достопримечательности\" : \"Природные достопримечательности\",\r\n\t\t\"Ботанический сад\" : \"Ботанические сады\",\r\n\t\t\"Пещеры\" : \"Пещеры\",\r\n\t\t\"Водопады\" : \"Водопады\",\r\n\t\t\"Парки\" : \"Парки\",\r\n\t\t\"Источники\" : \"Источники\",\r\n\t\t\"Заповедники\" : \"Заповедники\",\r\n\t\t\"Прочие архитектурные и природные достопримечательности\" : \"Архитектурные достопримечательности\",\r\n\r\n\t\"Религия\" : \"Религия\",\r\n\t\t\"Культовые сооружения\" : \"Культовые сооружения\",\r\n\t\t\"Мечети\" : \"Мечети\",\r\n\t\t\"Монастыри\" : \"Монастыри\",\r\n\t\t\"Церкви других христианских конфессий\" : \"Церкви других христианских конфессий\",\r\n\t\t\"Православные церкви\" : \"Православные церкви\",\r\n\t\t\"Синагоги\" : \"Синагоги\",\r\n\r\n\t\"Спорт\" : \"Спорт\",\r\n\t\t\"Стадионы\" : \"Стадионы\",\r\n\t\t\"Теннисные корты\" : \"Теннисные корты\",\r\n\t\t\"Катки\" : \"Катки\",\r\n\t\t\"Ипподромы\" : \"Ипподромы\",\r\n\t\t\"Фитнес\" : \"Фитнес\",\r\n\t\t\"Бассейны\" : \"Бассейны\",\r\n\t\t\"Прокат спортинвентаря\" : \"Прокат спортинвентаря\",\r\n\r\n\t\"Торговля и услуги\" : \"Торговля и услуги\",\r\n\t\t\"Солярии\" : \"Солярии\",\r\n\t\t\"Интернет-кафе\" : \"Интернет-кафе\",\r\n\t\t\"Рынки\" : \"Рынки\",\r\n\t\t\"Стоматологические клиники\" : \"Стоматологические клиники\",\r\n\t\t\"Магазины одежды\" : \"Магазины одежды\",\r\n\t\t\"Парикмахерские\" : \"Парикмахерские\",\r\n\t\t\"Бани\" : \"Бани\",\r\n\t\t\"Магазины обуви\" : \"Магазины обуви\",\r\n\t\t\"Магазины\" : \"Магазины\",\r\n\t\t\"Ателье\" : \"Ателье\",\r\n\t\t\"Такси\" : \"Такси\",\r\n\t\t\"Туризм\" : \"Туризм\",\r\n\r\n\t\"Транспорт и услуги\" : \"Транспорт и услуги\",\r\n\t\t\"Аэропорты\" : \"Аэропорты\",\r\n\t\t\"Автосервисы\" : \"Автосервисы\",\r\n\t\t\"Автовокзалы\" : \"Автовокзалы\",\r\n\t\t\"ДПС\" : \"ДПС\",\r\n\t\t\"ГИБДД\" : \"ГИБДД\",\r\n\t\t\"Шиномонтаж\" : \"Шиномонтаж\",\r\n\t\t\"Парковки бесплатные\" : \"Парковки бесплатные\",\r\n\t\t\"Парковки платные\" : \"Парковки платные\",\r\n\t\t\"АЗС\" : \"АЗС\",\r\n\t\t\"Автомойки\" : \"Автомойки\",\r\n\r\n\t\"Экстренные службы\" : \"Экстренные службы\",\r\n\t\t\"Пожарные/спасатели\" : \"Пожарные/спасатели\",\r\n\t\t\"Милиция\" : \"Милиция\",\r\n\t\t\"Скорая помощь\" : \"Скорая помощь\",\r\n\r\n\t\"Другие темы\" : \"Другие темы\",\r\n\t\t\"Разное\" : \"Разное\",\r\n\r\n\t\"Изменение пароля\" : \"Изменение пароля\",\r\n\t\"Новый пароль\" : \"Новый пароль\",\r\n\t\"Старый пароль\" : \"Старый пароль\",\r\n\t\"Подтвердите пароль\" : \"Подтвердите пароль\",\r\n\t\"Контур\" : \"Контур\",\r\n\t\"$$phrase$$_17\" : \"Добавьте контур при помощи инструмента \\\"Полигон\\\" на панели инструментов\",\r\n\t\"Выбор контура\" : \"Выбор контура\",\r\n\t\"Таблица атрибутов слоя [value0]\" : \"Таблица атрибутов слоя [value0]\",\r\n\t\"Показать параметры поиска\" : \"Показать параметры поиска\",\r\n\t\"Скрыть параметры поиска\" : \"Скрыть параметры поиска\",\r\n\t\"Скрыть\" : \"Скрыть\",\r\n\t\"SQL-условие WHERE\" : \"SQL-условие WHERE\",\r\n    \"Искать внутри полигона\" : \"Искать внутри полигона\",\r\n    \"Искать по пересечению с объектом\" : \"Искать по пересечению с объектом\",\r\n\t\"Колонки\" : \"Колонки\",\r\n\t\"Показывать колонки\" : \"Показывать колонки\",\r\n\t\"Скрыть колонки\" : \"Скрыть колонки\",\r\n\t\"Найти\" : \"Найти\",\r\n\t\"Нет полей\" : \"Нет полей\",\r\n\t\"Нет данных\" : \"Нет данных\",\r\n\t\"Таблица атрибутов\" : \"Таблица атрибутов\",\r\n\t\"Разрешить поиск\" : \"Разрешить поиск\",\r\n\t\"Произвольный\" : \"Произвольный\",\r\n\t\"День\" : \"День\",\r\n\t\"Неделя\" : \"Неделя\",\r\n\t\"Месяц\" : \"Месяц\",\r\n\t\"Год\" : \"Год\",\r\n\t\"Ежегодно\" : \"Ежегодно\",\r\n\t\"Облачность\" : \"Облачность\",\r\n\t\"Период\" : \"Период\",\r\n\t\"Спутниковые покрытия\" : \"Спутниковые покрытия\",\r\n\t\"Редактировать объект слоя [value0]\" : \"Редактировать объект слоя [value0]\",\r\n\t\"Создать объект слоя [value0]\" : \"Создать объект слоя [value0]\",\r\n\t\"Геометрия\" : \"Геометрия\",\r\n\t\"Найти объекты\" : \"Найти объекты\",\r\n\t\"Добавить объекты\" : \"Добавить объекты\",\r\n\t\"Обновить объекты\" : \"Обновить объекты\",\r\n\t\"Копировать объекты\" : \"Копировать объекты\",\r\n\t\"Объекты скопированы\" : \"Объекты скопированы\",\r\n\t\"Объекты добавлены\" : \"Объекты добавлены\",\r\n\t\"Вставить объекты\" : \"Вставить объекты\",\r\n\t\"Вставить объекты не удалось\" : \"Вставить объекты не удалось\",\r\n\t\"Выберите правым кликом слой в левой панели и нажмите \\\"Вставить объекты\\\"\": \"Выберите правым кликом слой в левой панели и нажмите \\\"Вставить объекты\\\"\",\r\n\t\"Изменить колонки\" : \"Изменить колонки\",\r\n\t\"Обновить колонку\" : \"Обновить колонку\",\r\n\t\"Очистить поиск\" : \"Очистить поиск\",\r\n    \"Скачать shp\": \"Скачать shp\",\r\n    \"Скачать gpx\": \"Скачать gpx\",\r\n    \"Скачать csv\": \"Скачать csv\",\r\n    \"Скачать geojson\": \"Скачать geojson\",\r\n    \"Рассчитать площадь\": \"Суммарная площадь\",\r\n\t\"Создать столбец\" : \"Создать столбец\",\r\n\t\"Мультислой\" : \"Мультислой\",\r\n\t\"В дереве слоев остались несохраненные изменения!\" : \"В дереве слоев остались несохраненные изменения!\",\r\n\t\"файл версии отсутствует\" : \"файл версии отсутствует\",\r\n\t\"оверлеи отсутствуют\" : \"оверлеи отсутствуют\",\r\n\t\"Хост\" : \"Хост\",\r\n\t\"Дополнительные карты\" : \"Дополнительные карты\",\r\n\t\"Добавить карту\" : \"Добавить карту\",\r\n\t\"Добавить в таймлайн\" : \"Добавить в таймлайн\",\r\n\t\"Удалить из таймлайна\" : \"Удалить из таймлайна\",\r\n\t\"Невозможно загрузить карту [value0] с домена [value1]\" : \"Невозможно загрузить карту [value0] с домена [value1]\",\r\n\t\"Показывать\" : \"Показывать\",\r\n\t\"Поиск снимков\" : \"Поиск снимков\",\r\n\t\"Принудительно обновить тайлы\" : \"Принудительно обновить тайлы\",\r\n\t\"Обводка\" : \"Обводка\",\r\n\t\"Карта имеет более новую версию. Сохранить?\" : \"Карта имеет более новую версию. Сохранить?\",\r\n\t\"Кодировка\": \"Кодировка\",\r\n\t\"helpPostfix\": \"_rus.html\",\r\n\t\"Показывать чекбокс видимости\": \"Чекбокс видимости\",\r\n\t\"Разворачивать автоматически\": \"Разворачивать автоматически\",\r\n\t\"Другая\": \"Другая\",\r\n\t\"Временнóй слой\": \"Мультивременнóй слой\",\r\n\t\"Колонка даты\": \"Колонка даты\",\r\n\t\"Минимальный период\": \"Мин. период (дни)\",\r\n\t\"Максимальный период\": \"Макс. период (дни)\",\r\n    \"Отсутствует временной атрибут\": \"Отсутствует атрибут типа 'Дата'\",\r\n    \"Период 1 день\": \"Период 1 день\",\r\n    \"Показывать на карте данные за\": \"Показывать на карте данные за\",\r\n    \"1 день\": \"1 день\",\r\n    \"произвольный период\" : \"произвольный период\",\r\n\t\"По границе экрана\": \"По границе экрана\",\r\n\t\"По центру экрана\": \"По центру экрана\",\r\n\t\"Пересечение\": \"Пересечение\",\r\n\t\"Пролистывать слои\": \"Пролистывать слои\",\r\n\t\"Следующий слой\": \"Следующий слой\",\r\n\t\"Предыдущий слой\": \"Предыдущий слой\",\r\n    \"Геометрия не сохранена. Эта возможность будет реализована в будущих версиях Геомиксера.\": \"Геометрия не сохранена. Эта возможность будет реализована в будущих версиях Геомиксера.\",\r\n    \"WMS доступ\": \"WMS/WFS доступ\",\r\n    \"ссылка\": \"ссылка\",\r\n    \"Слой '[value0]' уже есть в карте\": \"Слой '[value0]' уже есть в карте\",\r\n    \"Группа '[value0]' уже есть в карте\": \"Группа '[value0]' уже есть в карте\",\r\n    \"Плагины\": \"Плагины\",\r\n    \"Вручную\": \"Вручную\",\r\n    \"Добавить атрибут\": \"Добавить поле\",\r\n    \"Проекция\": \"Проекция\",\r\n    \"Широта/Долгота (EPSG:4326)\": \"Широта/Долгота (EPSG:4326)\",\r\n    \"Меркатор (EPSG:3395)\": \"Меркатор (EPSG:3395)\",\r\n    \"Из файла\": \"Из файла\",\r\n    \"Мультиполигон\": \"Мультиполигон\",\r\n    \"Мультилиния\": \"Мультилиния\",\r\n    \"Мультиточка\": \"Мультиточка\",\r\n    \"Администрирование\": \"Администрирование\",\r\n    \"Системные настройки\": \"Системные настройки\",\r\n    \"Управление группами\": \"Управление группами\",\r\n    \"Управление группами пользователей\": \"Управление группами пользователей\",\r\n    \"Добавить снимки\": \"Добавить растры\",\r\n    \"Существующие слои\": \"Существующие слои\",\r\n    \"Слои из карты\": \"Слои из карты\",\r\n    \"Слои из КР\": \"Слои из КР\",\r\n    \"Новый слой\": \"Новый слой\",\r\n    \"С экрана\": \"С экрана\",\r\n    \"Добавлен растр\": \"Добавлен растр\",\r\n    \"Добавлены растры\": \"Добавлены растры\",\r\n    \"Выбранный объект не имеет растра\": \"Выбранный объект не имеет растра\",\r\n    \"Этот растр уже был выбран\": \"Этот растр уже был выбран\",\r\n    \"Каталог Растров\": \"Каталог растров\",\r\n    \"Растр\": \"Растр\",\r\n    \"Добавить выбранные растры\": \"Добавить выбранные растры\",\r\n    \"EditObject.menuTitle\" : \"Добавить объект\",\r\n    \"FileBrowser.ExceedLimitMessage\" : \"Размер файла превышает 500 Мб. Используйте GeoMixerFileBrowser для загрузки больших файлов.\",\r\n    \"FileBrowser.DropInfo\" : \"Перетащите файлы сюда\",\r\n    \"EditObject.drawingMenuTitle\" : \"Добавить объект в активный слой\",\r\n    \"Поставить маркер\": \"Поставить маркер\",\r\n    \"Центрировать\": \"Центрировать\",\r\n    \"Пароль изменён\": \"Пароль изменён\",\r\n\t\"портретная\": \"портретная\",\r\n\t\"альбомная\": \"альбомная\",\r\n\t\"gmx_geometry\": \"gmx_geometry\"\r\n};\r\n","import './translations.js';\r\n\r\n_translationsHash.flags[\"eng\"] = \"img/flag_en.png\";\r\n\r\n_translationsHash.titles[\"eng\"] = \"English\";\r\n\r\n_translationsHash.hash[\"eng\"] = {\r\n\t\"Да\": \"Yes\",\r\n\t\"Нет\": \"No\",\r\n\t\"Карта\" : \"Map\",\r\n\t\"Создать\" : \"Create\",\r\n\t\"Создать карту\" : \"Create map\",\r\n\t\"Сохранить\" : \"Save\",\r\n\t\"Сохранить как\" : \"Save as\",\r\n\t\"Сохранить карту как\" : \"Save map as\",\r\n\t\"Сохранить карту\" : \"Save map\",\r\n\t\"Экспорт\" : \"Export\",\r\n\t\"Ссылки\" : \"Links\",\r\n\r\n    \"Карта пожаров\": \"Fires map\",\r\n    \"Поиск снимков\": \"Search Imagery\",\r\n    \"Платформа Геомиксер\": \"GeoMixer Web-GIS\",\r\n    \"http://fires.ru\": \"http://fires-map.com\",\r\n    \"https://search.kosmosnimki.ru\": \"https://search.kosmosnimki.ru/index_eng.html\",\r\n\r\n    \"Данные\": \"Datasets\",\r\n    \"Сервисы\": \"Services\",\r\n    \"Поделиться\": \"Share\",\r\n    \"Открыть слой\": \"Open layer\",\r\n    \"Создать слой\": \"Create layer\",\r\n    \"Растровый\": \"Raster\",\r\n    \"Векторный\": \"Vector\",\r\n    \"Создать группу\": \"Create group\",\r\n    \"Базовые слои\": \"Base layers\",\r\n    \"Подключить WMS\": \"Add WMS\",\r\n    \"Подключить WFS\": \"Add WFS\",\r\n    \"Объекты\": \"User objects\",\r\n    \"Результаты поиска\": \"Search results\",\r\n    \"Буфер\": \"Buffer\",\r\n    \"Создание буферных зон\": \"Buffer zones\",\r\n    \"Ручная привязка растров\": \"Manual rasters shift\",\r\n    \"Поиск слоев на карте\": \"Search layers on map\",\r\n    \"Краудсорсинг данных\": \"Crowdsourcing\",\r\n    \"Пакетный геокодинг\": \"Batch geocode\",\r\n    \"Маршруты\": \"Directions\",\r\n    \"Кадастр Росреестра\": \"Cadastre data of Rosreestr\",\r\n    \"Выбрать кадастровый объект\": \"Select Cadastre item\",\r\n    \"Викимапиа\": \"Wikimapia\",\r\n    \"Каталог СКАНЭКС\": \"Search imagery\",\r\n    \"Космоснимки-пожары\": \"Kosmosnimki-fires\",\r\n    \"GIBS NASA\": \"MODIS Images (NASA)\",\r\n    \"Руководство пользователя\": \"Documentation\",\r\n    \"Руководство\": \"User guide\",\r\n    \"GeoMixer API\": \"GeoMixer API\",\r\n    \"Использование плагинов\": \"Plugins usage\",\r\n\t\"копия\": \"копия\",\r\n\r\n\t\"Открыть\" : \"Open\",\r\n\t\"Слой\" : \"Layer\",\r\n\t\"Создать векторный слой\" : \"Create vector layer\",\r\n\t\"Создать растровый слой\" : \"Create raster layer\",\r\n    \"Создать мультислой\" : \"Create multilayer\",\r\n\t\"Вид\" : \"View\",\r\n\t\"Дерево слоев\" : \"Layers tree\",\r\n\t\"Объекты на карте\" : \"Objects on map\",\r\n\t\"Координатная сетка\" : \"Coordinate grid\",\r\n\t\"Индексная сетка\" : \"Index grid\",\r\n\t\"Панель оверлеев\" : \"Overlays panel\",\r\n\t\"Загрузить объекты\" : \"Upload objects\",\r\n\t\"Загрузить фотографии\" : \"Upload photos\",\r\n\t\"Загрузить данные\" : \"Load data\",\r\n\t\t\"WFS сервер\" : \"WFS server\",\r\n\t\t\"WMS сервер\" : \"WMS server\",\r\n\t\t\"Кадастровые данные\" : \"Cadastre data\",\r\n\t\"Ссылка на карту\" : \"Link to the map\",\r\n\t\"Код для вставки\" : \"Embed code\",\r\n\t\"Печать\" : \"Print\",\r\n\t\"Привязать изображение\" : \"Bind image\",\r\n\t\"Сообщить об ошибке на карте\" : \"Report a map error\",\r\n\t\"Справка\" : \"Help\",\r\n\t\"Использование\" : \"Usage\",\r\n\t\"О проекте\" : \"About/Contacts\",\r\n\t\"$$phrase$$_1\" : \"Choose parameter defaultMapID in config.js file\",\r\n\t\"У вас нет прав на просмотр данной карты\" : \"Sorry, you don’t have permission to view this map\",\r\n\t\"Access error\" : \"Sorry, you don’t have permission to view this map\",\r\n\t\"Map not found\" : \"Sorry, this map not found\",\r\n\t\"Unable to locate EXIF content\" : \"Unable to locate EXIF content\",\r\n\t\"Развернуть карту\" : \"Unfold map\",\r\n\t\"Свернуть карту\" : \"Fold map\",\r\n\t\"Точки на изображении:\" : \"Points on image:\",\r\n\t\"Точки на карте:\" : \"Points on map:\",\r\n\t\"Координаты\" : \"Coordinates\",\r\n\t\"Нарисовать\" : \"Draw\",\r\n\t\"Восстановить\" : \"Restore\",\r\n\t\"Прозрачность\" : \"Transparency\",\r\n\t\"Видимость\" : \"Visibility\",\r\n\t\"Привязка изображения\" : \"Image binding\",\r\n\t\"$$phrase$$_2\" : \"Point [value0] is outside the limits of image\",\r\n\t\"$$phrase$$_3\" : \"Point [value0] is not specified on a map\",\r\n\t\"Соответствие точек\" : \"Point correspondence\",\r\n\t\"$$phrase$$_4\" : \"Points 1 and 2 coincide at the image\",\r\n\t\"$$phrase$$_5\" : \"Points 1 and 3 coincide at the image\",\r\n\t\"$$phrase$$_6\" : \"Points 2 and 3 coincide at the image\",\r\n\t\"$$phrase$$_7\" : \"Points 1 and 2 coincide at the map\",\r\n\t\"$$phrase$$_8\" : \"Points 1 and 3 coincide at the map \",\r\n\t\"$$phrase$$_9\" : \"Points 2 and 3 coincide at the map \",\r\n\t\"$$phrase$$_10\" : \"Points lie on a straight line at the image \",\r\n\t\"Создать экскурсию\" : \"Create guide\",\r\n\t\"Чтобы пользоваться этим сайтом, установите Flash Player\" : \"To use this web site, please, install Flash Player\",\r\n\t\"из Интернет\" : \"from Internet\",\r\n\t\"или с локального диска \" : \"or from local disc\",\r\n\t\"для Internet Explorer\" : \"for Internet Explorer\",\r\n\t\" или \" : \" or \",\r\n\t\"для Firefox\" : \"for Firefox\",\r\n\t\"Скачать shp-файл\" : \"Download shp-file\",\r\n\t\"shp-файл\" : \"shp-file\",\r\n\t\"gpx-файл\" : \"gpx-file\",\r\n\t\"Скачать фрагмент растра\" : \"Download fragment of raster\",\r\n\t\"Очистить\" : \"Delete\",\r\n\t\"точка\" : \"point\",\r\n\t\"линия\" : \"line\",\r\n\t\"прямоугольник\" : \"rectangle\",\r\n\t\"многоугольник\" : \"polygon\",\r\n\t\"Скачать\" : \"Download\",\r\n\t\"Введите имя файла для скачивания\" : \"Enter file name to download\",\r\n\t\"Выберите область рамкой на карте\" : \"Select region using frame\",\r\n\t\"Вырезать фрагмент растра\" : \"Cut fragment of raster\",\r\n\t\"К прямоугольнику не подходит ни одного растрового слоя\" : \"No one raster layer fit the rectangle\",\r\n\t\"Загруженный shp-файл пуст\" : \"The uploaded shp-file is empty\",\r\n\t\"Ошибка скачивания\" : \"Download error\",\r\n\t\"Обновить\" : \"Update\",\r\n\t\"Домашняя директория\" : \"Project directory\",\r\n\t\"Имя папки\" : \"Folder name\",\r\n\t\"Имя\" : \"Name\",\r\n\t\"Тип\" : \"Type\",\r\n\t\"Размер\" : \"Size\",\r\n\t\"Дата\" : \"Date\",\r\n    \"Дата создания\": \"Дата создания\",\r\n\t\"Снять выделение\" : \"Clear selection\",\r\n\t\"Скопировать\" : \"Copy\",\r\n\t\"Удалить\" : \"Delete\",\r\n\t\"Извлечь\" : \"Extract\",\r\n\t\"Упаковать\" : \"Add to archive\",\r\n\t\"Загрузить\" : \"Download\",\r\n    \"Параметр\" : \"Parameter\",\r\n    \"Значение\" : \"Value\",\r\n\t\"VALUE\" : \"VALUE\",\r\n\t\"WHERE\" : \"WHERE\",\r\n\t\"Колонки\" : \"Columns\",\r\n\t\"Операторы\" : \"Operators\",\r\n\t\"Функции\" : \"Functions\",\r\n    \"Метаданные\": \"Metadata\",\r\n    \"Редактировать колонки\": \"Edit columns\",\r\n\t\"URL сервера\" : \"Server URL\",\r\n\t\"Формат изображения\" : \"Image format\",\r\n\t\"Введите имя gml-файла для скачивания:\" : \"Enter gml-file name to download:\",\r\n\t\"точки\" : \"points\",\r\n\t\"линии\" : \"lines\",\r\n\t\"полигоны\" : \"polygons\",\r\n\t\"(ссылка)\" : \"(link)\",\r\n\t\"Сохранить состояние карты\" : \"Save map state\",\r\n\t\"Ссылка на текущее состояние карты\" : \"Link to the map\",\r\n\t\"Добавить стиль\" : \"Add style\",\r\n\t\"Атрибут >\" : \"Attribute >\",\r\n\t\"Значение >\" : \"Value >\",\r\n\t\"Операция >\" : \"Operation >\",\r\n\t\"Накладываемое изображение\" : \"Ground overlay\",\r\n\t\"Цвет\" : \"Color\",\r\n\t\"Авторизуйтесь для редактирования фильтров\" : \"Authorize to edit filters\",\r\n\t\"Имя фильтра\" : \"Filter name\",\r\n\t\"Переместить фильтр вверх\" : \"Move filter up\",\r\n\t\"Переместить фильтр вниз\" : \"Move filter down\",\r\n\t\"Удалить фильтр\" : \"Delete filter\",\r\n\t\"Размер шрифта\" : \"Typesize\",\r\n\t\"Смещение\" : \"Shift\",\r\n\t\"Смещение по x\" : \"X shift\",\r\n\t\"Смещение по y\" : \"Y shift\",\r\n\t\"Имя атрибута\" : \"Attribute name\",\r\n\t\"Граница обрезки\" : \"Clip region\",\r\n\t\"Граница\" : \"Outline\",\r\n\t\"Толщина линии\" : \"Line thickness\",\r\n\t\"Заливка\" : \"Fill\",\r\n    \"Заливка цветом\": \"Color fill\",\r\n    \"Заливка штриховкой\": \"Pattern fill\",\r\n    \"Заливка рисунком\": \"Image fill\",\r\n    \"Ширина паттерна\": \"Pattern width\",\r\n    \"Ширина отступа\": \"Indent width\",\r\n    \"URL рисунка\": \"Image URL\",\r\n\t\"Маркер URL\" : \"Icon URL \",\r\n\t\"URL изображения\" : \"Image URL\",\r\n    \"Изображение\" : \"Image\",\r\n\t\"Размер точек\" : \"Point size\",\r\n\t\"Редактировать стили\" : \"Edit styles\",\r\n\t\"Авторизуйтесь для редактирования настроек слоя\" : \" Authorize to edit layer properties\",\r\n\t\"Недостаточно прав для редактирования настроек слоя\" : \"You have not enough permission to edit layer properties \",\r\n\t\"Недостаточно прав для редактирования объектов слоя\" : \"You have not enough permission to edit layer objects \",\r\n\t\"ID\" : \"ID\",\r\n\t\"Описание\" : \"Description\",\r\n\t\"Файл\" : \"File\",\r\n\t\"Таблица\" : \"Table\",\r\n\t\"Каталог с тайлами\" : \"Tile catalogue\",\r\n    \"Каталог растров\" : \"Raster catalogue\",\r\n    \"Данные с датой\": \"Split through time\",\r\n    \"Источник\": \"Source\",\r\n    \"Дополнительно\": \"Advanced options\",\r\n    \"Шаблон названий объектов\": \"Objects title template\",\r\n\t\"Y (широта)\" : \"Y (latitude)\",\r\n\t\"X (долгота)\" : \"X (longitude)\",\r\n\t\"Каталог\" : \"Catalogue\",\r\n\t\"Изменить\" : \"Change\",\r\n\t\"Вид вложенных элементов\" : \"Form of attached elements\",\r\n\t\"Использовать KosmosnimkiAPI\" : \"Load Kosmosnimki base layers\",\r\n\t\"Использовать OpenStreetMap\" : \"Use OpenStreetMap\",\r\n\t\"Язык по умолчанию\" : \"Default language\",\r\n    \"Единицы длины\": \"Distance unit\",\r\n    \"Единицы площади\": \"Square unit\",\r\n\t\"Формат координат\": \"Coordinates format\",\r\n    \"units.auto\": \"auto\",\r\n    \"units.m\": \"m\",\r\n    \"units.km\": \"km\",\r\n    \"units.nm\": \"nmi\",\r\n    \"units.m2\": \"m<sup>2</sup>\",\r\n    \"units.ha\": \"ha\",\r\n    \"units.km2\": \"km<sup>2</sup>\",\r\n\t\"coords.dd\" : \"dd.dddd\",\r\n\t\"coords.dms\" : \"dd°mm′ss″\",\r\n\t\"Генерализация\" : \"Generalization\",\r\n\t\"gereralization.on\": \"on\",\r\n\t\"gereralization.off\": \"off\",\r\n\t\"gereralization.disable\": \"use layers settings\",\r\n\t\"Количество информационных окошек\" : \"Max popup count\",\r\n    \"layerOrder.title\": \"Layers order\",\r\n    \"layerOrder.native\": \"Native\",\r\n    \"layerOrder.vectorOnTop\": \"Vector on top\",\r\n\t\"Разрешить поиск в векторных слоях\" : \"Allow search vector layers\",\r\n\t\"Начальная позиция\" : \"Start position\",\r\n\t\"Широта\" : \"Latitude\",\r\n\t\"Долгота\" : \"Longitude\",\r\n\t\"placeholder degrees\": \"dd.dddd\",\r\n\t\"placeholder zoom\": \"1-21\",\r\n\t\"placeholder minZoom\": \"1\",\r\n\t\"placeholder maxZoom\": \"21\",\r\n\t\"Зум\" : \"Zoom\",\r\n\t\"Ссылка (permalink)\" : \"Permalink\",\r\n\t\"Разрешить скачивание\" : \"Allow to download\",\r\n\t\"Векторных слоев\" : \"Vector layers\",\r\n\t\"Растровых слоев\" : \"Raster layers\",\r\n\t\"Масштабирование в миникарте\" : \"Minimap zoom delta\",\r\n\t\"Показывать всплывающие подсказки\" : \"Show tooltips\",\r\n\t\"Свойства\" : \"Properties\",\r\n\t\"Создать копию слоя\" : \"Create layer copy\",\r\n\t\"Стили\" : \"Styles\",\r\n\t\"Изображение на карте\" : \"Ground overlay\",\r\n\t\"Слой [value0]\" : \"Layer [value0]\",\r\n\t\"Стили слоя [value0]\" : \"Styles of layer [value0]\",\r\n\t\"Мультислой [value0]\" : \"Multilayer [value0]\",\r\n\t\"Группа [value0]\" : \"Group [value0]\",\r\n\t\"Карта [value0]\" : \"Map [value0]\",\r\n\t\"Редактировать стиль\" : \"Edit style\",\r\n\t\"Редактирование стилей объекта\" : \"Object styles editing\",\r\n\t\"Стили слоя\" : \"Layer styles\",\r\n\t\"Навигация по карте и инструменты\" : \"Map navigation and tools\",\r\n\t\"Список слоев\" : \"List of layers\",\r\n\t\"Стиль векторного слоя\" : \"Vector layer style\",\r\n\t\"Управление содержанием карты\" : \"Map content management\",\r\n\t\"Пользовательские инструменты\" : \"Users tools\",\r\n\t\"$$help$$_1\" : \"Hold mouse left button – move map with cursor. To zoom in or out use mouse wheel (or map zoom slider to zoom to the cursor position). In order to move map center to specified coordinates – enter coordinates in search line.\",\r\n\t\"$$help$$_2\" : \"Layer tree is represented in the left panel. To change map center according to layer extent – click its title in the list. If this option was activated by map administrator, you can download vector layers and cut and download raster layers fragments.\",\r\n\t\"$$help$$_3\" : \"To edit vector layer style click icon near layer name.\",\r\n\t\"$$help$$_4\" : \"Map is a collection of layers, which is displayed using layer tree. It is necessary to authorize to be able to edit the collection of layers (create groups, change display order etc.) and save changes. For more information see \",\r\n\t\" - Руководство пользователя\" : \" – User guide\",\r\n\t\"$$help$$_5\" : \"User tools serve the purpose of creation of objects on map, which can be saved via «save link to the map», and, at the same time, simple analytic functions fulfillment.\",\r\n\t\"В режиме маркеров: \" : \"Creating markers: \",\r\n\t\"$$help$$_6\" : \"single click – add marker. Double click on marker – delete. Click on marker – open pop-up window (balloon), click on balloon – add text.\",\r\n\t\"В режиме линейка/измерения расстояния, полигон/измерение площади: \" : \"Drawing lines/distance measurement, polygon/area measurement: \",\r\n\t\"$$help$$_7\" : \"single click – add vertex. Double click – complete figure. Click on line – add vertex. Double click on vertex – delete.\",\r\n\t\"$$help$$_8\" : \"Click on object in list of «objects on map» to move map center to it. You can download object in shp/tab/kml format.\",\r\n\t\"$$about$$_1\" : \"this web application for interactive geodata view and access to basic data sources in the Internet, such as: \",\r\n\t\"$$about$$_2\" : \" Using GeoMixer you can publish own geodata in intranet or in the Internet, put them over basic data coverages and give access to them for however large number of users, changing access permissions.\",\r\n\t\"$$about$$_3\" : \"GeoMixer also includes API component, which enables integrating the created projects into other web sites and applications and carry out program control over interactive map functional.\",\r\n\t\" - Общее описание\" : \" – General manual\",\r\n\t\" - Руководство разработчика\" : \" – Developer’s gudie\",\r\n\t\"Получить API-ключ\" : \"Get API-key\",\r\n\t\"Введите API-ключ\" : \"Enter API-key\",\r\n\t\"$$serviceHelp$$_1\" : \"Allows to upload small shp/tab/kml file on the fly in the form of user objects. After uploading user can edit geometry of objects and download objects in the same format kit.\",\r\n\t\"$$serviceHelp$$_2\" : \"Link saves current map state, and also user objects and texts.\",\r\n\t\"$$serviceHelp$$_3\" : \"Print current map fragment.\",\r\n\t\"Редактировать\" : \"Edit\",\r\n    \"Удалить объект?\": \"Delete object?\",\r\n    \"Удалить отмеченные объекты?\": \"Delete selected objects?\",\r\n\t\"Длина\" : \"Length\",\r\n\t\"Площадь\" : \"Area\",\r\n\t\"Добавить подгруппу\" : \"Create group\",\r\n\t\"Введите имя группы\" : \"New group creation\",\r\n\t\"Имя группы\" : \"Group name\",\r\n\t\"Включая вложенные слои\" : \"Including attached layers\",\r\n\t\"Удаление группы [value0]\" : \"Delete group [value0]\",\r\n\t\"Сохранено\" : \"Saved\",\r\n\t\"Прозрачность выбранного слоя/группы/карты\" : \"Transparency of the selected layer/group/map\",\r\n\t\"$$updateInfo$$_1\" : \"To display new layer it is necessary to save and reload map\",\r\n\t\"Любой\" : \"Any\",\r\n\t\"Владелец\" : \"Owner\",\r\n\t\"Последнее изменение\": \"Last modification\",\r\n\t\"Вы действительно хотите удалить этот слой?\" : \"Do you really want to delete the selected layer?\",\r\n\t\"Ошибка!\" : \"Error!\",\r\n\t\"Ошибка\" : \"Error\",\r\n\t\"Выберите колонку\" : \"Select column\",\r\n\t\"Список карт\" : \"Maps list\",\r\n\t\"Показать\" : \"Show\",\r\n\t\"загрузка...\" : \"loading...\",\r\n\t\"удаление...\" : \"deleting...\",\r\n\t\"Вы действительно хотите удалить эту карту?\" : \" Do you really want to delete the selected map?\",\r\n    \"maplist.hint\": \"You can drag layers and folders from here to current map\",\r\n\t\"Слоя нет в базе\" : \"Layer is not in base\",\r\n\t\"ScanEx Web Geomixer - просмотр карты\" : \"ScanEx Web Geomixer – map view\",\r\n\t\"Изменить параметры поиска\" : \"Change search parameters\",\r\n\t\"$$search$$_1\" : \"Search vector layers and address base\",\r\n\t\"$$search$$_2\" : \"Search address base\",\r\n\t\"Поиск не дал результатов\" : \"There are no search results\",\r\n\t\"Регистрация\" : \"Registration\",\r\n\t\"Восстановление пароля\" : \"Restore password\",\r\n\t\"Вход\" : \"Login\",\r\n\t\"Выход\" : \"Logout\",\r\n\t\"Логин\" : \"User name\",\r\n\t\"Пароль\" : \"Password\",\r\n\t\"пароль\" : \"password\",\r\n    \"Псевдоним\": \"Nickname\",\r\n    \"Полное имя\": \"Full name\",\r\n\t\"Пожалуйста, авторизуйтесь\" : \"Please, authorize\",\r\n    \"адрес электронной почты\": \"enter your e-mail\",\r\n\t\"Ошибка сервера\" : \"Server error\",\r\n\t\"Папка\" : \"Folder\",\r\n\t\" и \" : \" and \",\r\n\t\"Название\" : \"Title\",\r\n\t\"Рейтинг\" : \"Rating\",\r\n\t\"Автор\" : \"Author\",\r\n\t\"Тематика\" : \"Theme\",\r\n\t\"Развлекательная\" : \"Fun\",\r\n\t\"Спортивная\" : \"Sport\",\r\n\t\"Историческая\" : \"History\",\r\n\t\"Экологическая\" : \"Ecology\",\r\n\t\"Любая\" : \"All\",\r\n\t\"Создать новую тему\" : \"Create topic\",\r\n\t\"Начало периода\" : \"Since\",\r\n\t\"Окончание периода\" : \"Till\",\r\n\t\"Накладываемые тайлы\" : \"Ground tiles\",\r\n\t\"Отображать с зума\" : \"Show with zoom\",\r\n\t\"По\" : \"to\",\r\n\t\"Фильтр\" : \"Filter\",\r\n\t\"Подпись\" : \"Label\",\r\n\t\"Балун\" : \"Balloon\",\r\n\t\"По умолчанию\" : \"Default\",\r\n\t\"Показывать при клике\": \"Show on click\",\r\n\t\"Показывать при наведении\": \"Show on mouse over\",\r\n\t\"Символика\" : \"Shown style\",\r\n    \"Библиотека стилей\": \"Style library\",\r\n    \"Настройка стилей\": \"Style settings\",\r\n\t\"скопировать\": \"copy style\",\r\n\t\"применить везде\": \"apply to all\",\r\n\t\"Применить\": \"Apply\",\r\n    \"Кластеризация\" : \"Clustering\",\r\n\t\"Минимальный\" : \"Mininmal\",\r\n\t\"Максимальный\" : \"Maximal\",\r\n\t\"Мин. зум\" : \"Min. zoom\",\r\n\t\"Макс. зум\" : \"Max. zoom\",\r\n\t\"Пешеходная\" : \"Footpath\",\r\n\t\"Велосипедная\" : \"Bicycle\",\r\n\t\"Автомобильная\" : \"Automobile\",\r\n\t\"Места\" : \"Places\",\r\n\t\"Маршрут\" : \"Route\",\r\n\t\"Редактировать экскурсию\" : \"Edit excursion\",\r\n\t\"Добавьте маршрут\" : \"Add route\",\r\n\t\"Выберете темы на пути следования\" : \"Choose places throughout the journey\",\r\n\t\"$$phrase$$_11\" : \"Add route by clicking \\\"Line\\\" tool on toolbar\",\r\n\t\"$$phrase$$_12\" : \"There are no corresponding objects on the map\",\r\n\t\"Выбор маршрута\" : \"Routes choice\",\r\n\t\"Выбор мест\" : \"Places choice\",\r\n\t\"$$phrase$$_13\" : \"You haven't places om map. You can add place in View-Forum tab\",\r\n\t\"Обсуждения\" : \"Forum\",\r\n\t\"Экскурсии\" : \"Excursions\",\r\n\t\"$$phrase$$_14\" : \"Unable to delete default map\",\r\n\t\"$$phrase$$_15\" : \"Unable to delete current map\",\r\n\t\"Назад\" : \"Back\",\r\n\t\"Вперед\" : \"Forward\",\r\n\t\"$$phrase$$_16\" : \"There is no album with given image ID\",\r\n\t\"Редактировать альбом\" : \"Edit album\",\r\n\t\"Оценить\" : \"Vote\",\r\n\t\"Поставьте маркер\" : \"Add marker\",\r\n\t\"на карту и переместите его в нужное место.\" : \"to map and move it to choosen place.\",\r\n\t\"Недостаточно прав для совершения операции\" : \"Insufficient rights to perform operation\",\r\n\t\"Новая папка\" : \"New folder\",\r\n\t\"Выбрать\" : \"Choose\",\r\n\t\"Добавить\" : \"Add\",\r\n\t\"$$serviceHelp$$_4\" : \"Embedding the map: the user can embed a map window into their site by copying and pasting an HTML snippet. An API key for the site's domain is required.\",\r\n\t\"Масштаб\" : \"Scale\",\r\n\t\"Угол поворота\" : \"Angle\",\r\n\t\"Диаграммы\" : \"Charts\",\r\n\t\"График по времени\" : \"Time chart\",\r\n\t\"Круговая\" : \"Pie chart\",\r\n\t\"Маска атрибутов\" : \"Attributes mask\",\r\n\t\"Закладки\" : \"Bookmarks\",\r\n\t\"Добавить закладку\" : \"Add bookmark\",\r\n\t\"Имя закладки\" : \"Bookmark name\",\r\n\t\"Дерево\" : \"Tree view\",\r\n\t\"Поиск слоев\" : \"Layers search\",\r\n\t\"Пример выражения\": \"[Field1]\\n[Field2]\\nsimple text\",\r\n\t\"Шкала прозрачности\" : \"Transparency bar\",\r\n\t\"Цвет заливки\" : \"Fill color\",\r\n\t\"Цвет обводки\" : \"Outline color\",\r\n\t\"Цвет шрифта\" : \"Font color\",\r\n\t\"Легенда\" : \"Legend\",\r\n\t\"Событие загрузки карты\" : \"Событие загрузки карты\",\r\n\t\"Мин\" : \"Min\",\r\n\t\"Макс\" : \"Max\",\r\n\t\"График\" : \"График\",\r\n\t\"Гистограмма\" : \"Гистограмма\",\r\n\t\"Столбчатая\" : \"Столбчатая\",\r\n\t\"Временная\" : \"Временная\",\r\n\t\"Копировать стиль\" : \"Copy style\",\r\n\t\"Применить стиль\" : \"Apply style\",\r\n\t\"Не выбран стиль\" : \"There is no copied style\",\r\n\t\"Невозможно применить стиль к другому типу геометрии\" : \"Can't apply style to different geometry type\",\r\n\t\"Общие\" : \"Common\",\r\n\t\"Доступ\" : \"Policy\",\r\n\t\"Окно карты\" : \"View\",\r\n\t\"Загрузка\" : \"Onload\",\r\n\t\"Копирайт\" : \"Copyright\",\r\n\t\"Инструменты\" : \"Tools\",\r\n\t\"Загрузить KML\" : \"Load KML\",\r\n\t\"URL файла\" : \"File URL\",\r\n    \"Поиск\" : \"Search\",\r\n    \"Подложки\": \"Base Layers\",\r\n    \"Доступные подложки\": \"Available base layers\",\r\n    \"Подложки карты\": \"Base layers on map\",\r\n    \"Выберите слои для поиска по атрибутам\": \"Select layers for attributes search\",\r\n\t\"Включить синхронизацию слоев\": \"Enable sync layers\",\r\n\t\"Выключить синхронизацию слоев\": \"Disable sync layers\",\r\n\r\n\t\"Редактирование прав доступа карты [value0]\" : \"Map [value0] access editor\",\r\n\t\"Редактирование прав доступа слоя [value0]\" : \"Layer [value0] access editor\",\r\n\t\"Редактирование прав доступа слоев карты [value0]\" : \"Map [value0] layers access editor\",\r\n\t\"Состав группы [value0]\" : \"Users of group [value0]\",\r\n\t\"Роль\" : \"Role\",\r\n\t\"Добавить пользователя\" : \"Add user\",\r\n\t\"Права доступа\" : \"Access permissions\",\r\n\t\"Права доступа к слоям\" : \"Layers access permissions\",\r\n\t\"Пользователи без прав доступа:\" : \"Users wihout access:\",\r\n\t\"Пользователи с правами доступа:\" : \"Users with access:\",\r\n\t\"Выберите нового владельца\" : \"Select new owner\",\r\n\t\"Сменить владельца\" : \"Change owner\",\r\n\r\n\t\"Объекты RuMap\" : \"RuMap objects\",\r\n\t\"Объекты пользователей\" : \"User objects\",\r\n\r\n\t\"Контакты\" : \"Contacts\",\r\n\t\"Фотографии\" : \"Photo\",\r\n\t\"Момент съемки\" : \"Image date\",\r\n\t\"Видео\" : \"Video\",\r\n\t\"Сообщения\" : \"Messages\",\r\n\t\"Ссылка на место\" : \"Ссылка на место\",\r\n\t\"Ссылка на экскурсию\" : \"Ссылка на экскурсию\",\r\n\t\"Ссылка на событие\" : \"Ссылка на событие\",\r\n\t\"Создать новое событие\" : \"Создать новое событие\",\r\n\t\"События\" : \"События\",\r\n\t\"Календарь\" : \"Календарь\",\r\n\t\"Новости\" : \"Новости\",\r\n\t\"Мероприятия\" : \"Мероприятия\",\r\n\t\"Отмена\" : \"Отмена\",\r\n\t\"Пропустить\" : \"Skip\",\r\n\t\"Время\" : \"Время\",\r\n\t\"Альбом OpenPhotoVR\" : \"Фотоальбом\",\r\n\t\"Встраиваемый код\" : \"Embed video\",\r\n\r\n\t\"Объекты экологического риска\" : \"Объекты экологического риска\",\r\n\t\t\"Санкционированные свалки\" : \"Санкционированные свалки\",\r\n\t\t\"Несанкционированные свалки\" : \"Несанкционированные свалки\",\r\n\t\t\"Полигоны отходов\" : \"Полигоны отходов\",\r\n\t\t\"Предприятия переработки отходов\" : \"Предприятия переработки отходов\",\r\n\t\t\"Факельные установки, ТЭЦ, трубы\" : \"Факельные установки, ТЭЦ, трубы\",\r\n\t\t\"Закрытые свалки\" : \"Закрытые свалки\",\r\n\t\t\"Пункты приема отходов\" : \"Пункты приема отходов\",\r\n\t\t\"Оползни\" : \"Оползни\",\r\n\t\t\"Карстовые явления\" : \"Карстовые явления\",\r\n\t\t\"Суффозионные явления\" : \"Суффозионные явления\",\r\n\r\n\t\"Государство и общество\" : \"Государство и общество\",\r\n\t\t\"Радио\" : \"Радио\",\r\n\t\t\"Правительственные учреждения\" : \"Правительственные учреждения\",\r\n\t\t\"Оптики\" : \"Оптики\",\r\n\t\t\"Охранные агенства\" : \"Охранные агенства\",\r\n\t\t\"Травмпункты\" : \"Травмпункты\",\r\n\t\t\"Таможня\" : \"Таможня\",\r\n\t\t\"Ветеринарные клиники\" : \"Ветеринарные клиники\",\r\n\t\t\"ЗАГС\" : \"ЗАГС\",\r\n\t\t\"Больницы\" : \"Больницы\",\r\n\t\t\"Аптеки\" : \"Аптеки\",\r\n\t\t\"Поликлиники\" : \"Поликлиники\",\r\n\t\t\"Колледжи\" : \"Колледжи\",\r\n\t\t\"Университеты\" : \"Университеты\",\r\n\t\t\"ОВИР\" : \"ОВИР\",\r\n\t\t\"Посольства\" : \"Посольства\",\r\n\t\t\"Почтовые отделения\" : \"Почтовые отделения\",\r\n\t\t\"Суды\" : \"Суды\",\r\n\t\t\"Банки\" : \"Банки\",\r\n\t\t\"Родильные дома\" : \"Родильные дома\",\r\n\t\t\"Дома престарелых\" : \"Дома престарелых\",\r\n\t\t\"Детские сады\" : \"Детские сады\",\r\n\t\t\"Школы\" : \"Школы\",\r\n\t\t\"Инспекции\" : \"Инспекции\",\r\n\t\t\"Адвокаты\" : \"Адвокаты\",\r\n\t\t\"МЧС\" : \"МЧС\",\r\n\t\t\"Муниципальные учреждения\" : \"Муниципальные учреждения\",\r\n\t\t\"Администрация\" : \"Администрация\",\r\n\r\n\t\"Культура и отдых\" : \"Культура и отдых\",\r\n\t\t\"Боулинг\" : \"Боулинг\",\r\n\t\t\"Аквапарки\" : \"Аквапарки\",\r\n\t\t\"Парки развлечений\" : \"Парки развлечений\",\r\n\t\t\"Библиотеки\" : \"Библиотеки\",\r\n\t\t\"Памятники\" : \"Памятники\",\r\n\t\t\"Лагери отдыха\" : \"Лагери отдыха\",\r\n\t\t\"Кинотеатры\" : \"Кинотеатры\",\r\n\t\t\"Цирки\" : \"Цирки\",\r\n\t\t\"Галереи\" : \"Галереи\",\r\n\t\t\"Отели\" : \"Отели\",\r\n\t\t\"Мотели\" : \"Мотели\",\r\n\t\t\"Музеи\" : \"Музеи\",\r\n\t\t\"Концертные залы\" : \"Концертные залы\",\r\n\t\t\"Ночные клубы\" : \"Ночные клубы\",\r\n\t\t\"Театры\" : \"Театры\",\r\n\t\t\"Санатории\" : \"Санатории\",\r\n\t\t\"Зоопарки\" : \"Зоопарки\",\r\n\r\n\t\"Общественное питание\" : \"Общественное питание\",\r\n\t\t\"Кафе\" : \"Кафе\",\r\n\t\t\"Фастфуды\" : \"Фастфуды\",\r\n\t\t\"Рестораны\" : \"Рестораны\",\r\n\t\t\"Кафе-мороженое\" : \"Кафе-мороженое\",\r\n\t\t\"Столовые\" : \"Столовые\",\r\n\r\n\t\"Природные достопримечательности\" : \"Природные достопримечательности\",\r\n\t\t\"Ботанический сад\" : \"Ботанические сады\",\r\n\t\t\"Пещеры\" : \"Пещеры\",\r\n\t\t\"Водопады\" : \"Водопады\",\r\n\t\t\"Парки\" : \"Парки\",\r\n\t\t\"Источники\" : \"Источники\",\r\n\t\t\"Заповедники\" : \"Заповедники\",\r\n\t\t\"Прочие архитектурные и природные достопримечательности\" : \"Архитектурные достопримечательности\",\r\n\r\n\t\"Религия\" : \"Религия\",\r\n\t\t\"Культовые сооружения\" : \"Культовые сооружения\",\r\n\t\t\"Мечети\" : \"Мечети\",\r\n\t\t\"Монастыри\" : \"Монастыри\",\r\n\t\t\"Церкви других христианских конфессий\" : \"Церкви других христианских конфессий\",\r\n\t\t\"Православные церкви\" : \"Православные церкви\",\r\n\t\t\"Синагоги\" : \"Синагоги\",\r\n\r\n\t\"Спорт\" : \"Спорт\",\r\n\t\t\"Стадионы\" : \"Стадионы\",\r\n\t\t\"Теннисные корты\" : \"Теннисные корты\",\r\n\t\t\"Катки\" : \"Катки\",\r\n\t\t\"Ипподромы\" : \"Ипподромы\",\r\n\t\t\"Фитнес\" : \"Фитнес\",\r\n\t\t\"Бассейны\" : \"Бассейны\",\r\n\t\t\"Прокат спортинвентаря\" : \"Прокат спортинвентаря\",\r\n\r\n\t\"Торговля и услуги\" : \"Торговля и услуги\",\r\n\t\t\"Солярии\" : \"Солярии\",\r\n\t\t\"Интернет-кафе\" : \"Интернет-кафе\",\r\n\t\t\"Рынки\" : \"Рынки\",\r\n\t\t\"Стоматологические клиники\" : \"Стоматологические клиники\",\r\n\t\t\"Магазины одежды\" : \"Магазины одежды\",\r\n\t\t\"Парикмахерские\" : \"Парикмахерские\",\r\n\t\t\"Бани\" : \"Бани\",\r\n\t\t\"Магазины обуви\" : \"Магазины обуви\",\r\n\t\t\"Магазины\" : \"Магазины\",\r\n\t\t\"Ателье\" : \"Ателье\",\r\n\t\t\"Такси\" : \"Такси\",\r\n\t\t\"Туризм\" : \"Туризм\",\r\n\r\n\t\"Транспорт и услуги\" : \"Транспорт и услуги\",\r\n\t\t\"Аэропорты\" : \"Аэропорты\",\r\n\t\t\"Автосервисы\" : \"Автосервисы\",\r\n\t\t\"Автовокзалы\" : \"Автовокзалы\",\r\n\t\t\"ДПС\" : \"ДПС\",\r\n\t\t\"ГИБДД\" : \"ГИБДД\",\r\n\t\t\"Шиномонтаж\" : \"Шиномонтаж\",\r\n\t\t\"Парковки бесплатные\" : \"Парковки бесплатные\",\r\n\t\t\"Парковки платные\" : \"Парковки платные\",\r\n\t\t\"АЗС\" : \"АЗС\",\r\n\t\t\"Автомойки\" : \"Автомойки\",\r\n\r\n\t\"Экстренные службы\" : \"Экстренные службы\",\r\n\t\t\"Пожарные/спасатели\" : \"Пожарные/спасатели\",\r\n\t\t\"Милиция\" : \"Милиция\",\r\n\t\t\"Скорая помощь\" : \"Скорая помощь\",\r\n\r\n\t\"Другие темы\" : \"Другие темы\",\r\n\t\t\"Разное\" : \"Разное\",\r\n\r\n\t\"Изменение пароля\" : \"Password change\",\r\n\t\"Новый пароль\" : \"New password\",\r\n\t\"Старый пароль\" : \"Old password\",\r\n\t\"Подтвердите пароль\" : \"Confirm password\",\r\n\t\"Контур\" : \"Border\",\r\n\t\"$$phrase$$_17\" : \"Add border by clicking \\\"Polygon\\\" tool on toolbar\",\r\n\t\"Выбор контура\" : \"Border select\",\r\n\t\"Таблица атрибутов слоя [value0]\" : \"[value0] attributes table\",\r\n\t\"Показать параметры поиска\" : \"Show search params\",\r\n\t\"Скрыть параметры поиска\" : \"Hide search params\",\r\n\t\"Скрыть\" : \"Hide\",\r\n\t\"Искать внутри полигона\" : \"Search inside polygon\",\r\n\t\"Искать по пересечению с объектом\" : \"Search by geometry\",\r\n\t\"SQL-условие WHERE\" : \"WHERE SQL expression\",\r\n\t\"Показывать колонки\" : \"Show columns\",\r\n\t\"Скрыть колонки\" : \"Hide columns\",\r\n\t\"Найти\" : \"Search\",\r\n\t\"Нет полей\" : \"Empty fields\",\r\n\t\"Нет данных\" : \"Empty data\",\r\n\t\"Таблица атрибутов\" : \"Attributes table\",\r\n\t\"Разрешить поиск\" : \"Allow search\",\r\n\t\"Произвольный\" : \"Any\",\r\n\t\"День\" : \"Day\",\r\n\t\"Неделя\" : \"Week\",\r\n\t\"Месяц\" : \"Month\",\r\n\t\"Год\" : \"Year\",\r\n\t\"Ежегодно\" : \"Every year\",\r\n\t\"Облачность\" : \"Clouds\",\r\n\t\"Период\" : \"Period\",\r\n\t\"Спутниковые покрытия\" : \"Satellite cover\",\r\n\t\"Редактировать объект слоя [value0]\" : \"Edit layer [value0] object\",\r\n\t\"Создать объект слоя [value0]\" : \"Add layer [value0] object\",\r\n\t\"Геометрия\" : \"Geometry\",\r\n\t\"Найти объекты\" : \"Find objects\",\r\n\t\"Добавить объекты\" : \"Add objects\",\r\n\t\"Обновить объекты\" : \"Update objects\",\r\n\t\"Копировать объекты\" : \"Copy objects\",\r\n\t\"Объекты скопированы\" : \"Objects are copied\",\r\n\t\"Объекты добавлены\" : \"Объекты добавлены\",\r\n\t\"Вставить объекты\" : \"Paste objects\",\r\n\t\"Вставить объекты не удалось\" : \"Paste objects failed\",\r\n\t\"Выберите правым кликом слой в левой панели и нажмите \\\"Вставить объекты\\\"\": \"Right-click on layer name and select \\\"Paste objects\\\"\",\r\n\t\"Изменить колонки\" : \"Update columns\",\r\n\t\"Обновить колонку\" : \"Update column\",\r\n\t\"Очистить поиск\" : \"Clean search\",\r\n    \"Скачать shp\": \"Download shp\",\r\n    \"Скачать gpx\": \"Download gpx\",\r\n    \"Скачать csv\": \"Download csv\",\r\n    \"Скачать geojson\": \"Download geojson\",\r\n    \"Рассчитать площадь\": \"Total square\",\r\n\t\"Создать столбец\" : \"Create column\",\r\n\t\"Мультислой\" : \"Multilayer\",\r\n\t\"В дереве слоев остались несохраненные изменения!\" : \"There are unsaved changes on layers tree!\",\r\n\t\"файл версии отсутствует\" : \"version file doesn't exists\",\r\n\t\"оверлеи отсутствуют\" : \"no overlays present\",\r\n\t\"Хост\" : \"Host\",\r\n\t\"Дополнительные карты\" : \"Additional maps\",\r\n\t\"Добавить карту\" : \"Add map\",\r\n\t\"Добавить в таймлайн\" : \"Add to timeLine\",\r\n\t\"Удалить из таймлайна\" : \"Remove from timeline\",\r\n\t\"Невозможно загрузить карту [value0] с домена [value1]\" : \"Unable to load map [value0] from domain [value1]\",\r\n\t\"Показывать\" : \"Show\",\r\n\t\"Принудительно обновить тайлы\" : \"Forced retiling\",\r\n\t\"Обводка\" : \"Outline\",\r\n\t\"Карта имеет более новую версию. Сохранить?\" : \"The map has a newer version. Save anyway?\",\r\n\t\"Кодировка\": \"Encoding\",\r\n\t\"helpPostfix\": \"_eng.html\",\r\n\t\"Показывать чекбокс видимости\": \"Visibility checkbox\",\r\n\t\"Разворачивать автоматически\": \"Expand automatically\",\r\n\t\"Другая\": \"Another\",\r\n\t\"Временнóй слой\": \"Multitemporal layer\",\r\n\t\"Колонка даты\": \"Date column\",\r\n\t\"Минимальный период\": \"Min. period (days)\",\r\n\t\"Максимальный период\": \"Max. period (days)\",\r\n    \"Отсутствует временной атрибут\": \"Missing attribute with type 'Date'\",\r\n    \"Период 1 день\": \"Period 1 day\",\r\n    \"Показывать на карте данные за\": \"Show data on map within\",\r\n    \"1 день\": \"single day\",\r\n    \"произвольный период\" : \"arbitrary period\",\r\n\t\"По границе экрана\": \"Screen border\",\r\n\t\"По центру экрана\": \"Screen center\",\r\n\t\"Пересечение\": \"Intersection\",\r\n\t\"Пролистывать слои\": \"Scroll layers\",\r\n\t\"Следующий слой\": \"Next layer\",\r\n\t\"Предыдущий слой\": \"Previous layer\",\r\n    \"Геометрия не сохранена. Эта возможность будет реализована в будущих версиях Геомиксера.\": \"Geometry is not saved. This feature will be implemented in future Geomixer versions\",\r\n    \"WMS доступ\": \"WMS/WFS access\",\r\n    \"ссылка\": \"link\",\r\n    \"Слой '[value0]' уже есть в карте\": \"Layer '[value0]' already exists in this map\",\r\n    \"Группа '[value0]' уже есть в карте\": \"Group '[value0]' already exists in this map\",\r\n    \"Плагины\": \"Plugins\",\r\n    \"Вручную\": \"Manually\",\r\n    \"Добавить атрибут\": \"Add attribute\",\r\n    \"Проекция\": \"Projection\",\r\n    \"Широта/Долгота (EPSG:4326)\": \"Lat/Lon (EPSG:4326)\",\r\n    \"Меркатор (EPSG:3395)\": \"Mercator (EPSG:3395)\",\r\n    \"Из файла\": \"From file\",\r\n    \"Мультиполигон\": \"Multipolygon\",\r\n    \"Мультилиния\": \"Multipolyline\",\r\n    \"Мультиточка\": \"Multipoint\",\r\n    \"Администрирование\": \"Administration\",\r\n    \"Системные настройки\": \"System settings\",\r\n    \"Управление группами\": \"User group management\",\r\n    \"Управление группами пользователей\": \"User group management\",\r\n    \"Добавить снимки\": \"Add rasters\",\r\n    \"Существующие слои\": \"Existing layers\",\r\n    \"Слои из карты\": \"Layers from map\",\r\n    \"Слои из КР\": \"Layers from RC\",\r\n    \"Новый слой\": \"New layer\",\r\n    \"С экрана\": \"Select on map\",\r\n    \"Добавлен растр\": \"Raster is added\",\r\n    \"Добавлены растры\": \"Rasters are added\",\r\n    \"Выбранный объект не имеет растра\": \"Selected object has no raster\",\r\n    \"Этот растр уже был выбран\": \"This raster is already selected\",\r\n    \"Каталог Растров\": \"Raster catalog\",\r\n    \"Растр\": \"Raster\",\r\n    \"Добавить выбранные растры\": \"Add selected rasters\",\r\n    \"EditObject.menuTitle\" : \"Add object\",\r\n    \"FileBrowser.ExceedLimitMessage\" : \"File size exceeds 500 Mb. Use GeoMixerFileBrowser tool to upload large files.\",\r\n    \"FileBrowser.DropInfo\" : \"Drop files here\",\r\n    \"EditObject.drawingMenuTitle\" : \"Add object to active layer\",\r\n    \"Поставить маркер\": \"Add marker\",\r\n    \"Центрировать\": \"Set center\",\r\n    \"Пароль изменён\": \"Password has been changed\",\r\n\t\"портретная\": \"portrait view\",\r\n\t\"альбомная\": \"layout view\",\r\n\t\"gmx_geometry\": \"gmx_geometry\"\r\n};\r\n","import nsGmx from './nsGmx.js';\r\nimport {    \r\n    attachEffects,               \r\n    stopEvent,    \r\n    _span,    \r\n} from './utilities.js';\r\n// import './MapExport/MapExport.js';\r\n\r\n/**\r\n  @class\r\n  @virtual\r\n  @name IMenuElem\r\n  @desc Описание пункта верхнего меню ГеоМиксера\r\n  @property {String} id Уникальный идентификатор элемента меню\r\n  @property {String} title Tекст, который будет показываться пользователю\r\n  @property {Function} func Ф-ция, которую нужно вызвать при клике\r\n  @property {IMenuElem[]} childs Массив элементов подменю\r\n*/\r\n\r\n/**\r\n    Верхнее меню ГеоМиксера. Может содержать до 3 уровней вложенности элементов.\r\n    @class\r\n*/\r\nvar UpMenu = function()\r\n{\r\n\r\n    this.submenus = [];\r\n    this.currSel = null;\r\n    this.currUnSel = null;\r\n    this.refs = {};\r\n\r\n    this.parent = null;\r\n    this.loginContainer = null;\r\n    this._isCreated = false;\r\n    this.defaultHash = 'layers';\r\n    this.clicked = false;\r\n    this.openedMenus = [];\r\n    this.currentTopHash = null;\r\n\r\n    \r\n\r\n    document.addEventListener('click', this.hideOnClick.bind(this));\r\n\r\n};\r\n\r\nUpMenu.prototype.hideOnClick = function(e) {\r\n    var parents = $(e.target).parents(),\r\n        parentsArr = $(parents).toArray(),\r\n        isHeader = $(e.target).hasClass('header1Internal'),\r\n        isInsideHeader = parentsArr.some(function (elem) {\r\n            return $(elem).hasClass('header1');\r\n        });\r\n\r\n    if (!isInsideHeader) {\r\n        this.clicked = false;\r\n        this.hideMenus();\r\n        this.currentTopHash = null;\r\n    }\r\n\r\n    if (!isHeader) {\r\n        $(document).find('.header1').each(function() {\r\n            $(this).removeClass('menuActive');\r\n        });\r\n    }\r\n}\r\n\r\n//предполагает, что если callback возвращает true, то итерирование можно прекратить\r\nUpMenu.prototype._iterateMenus = function(elem, callback) {\r\n    if (!elem.childs) {\r\n        return;\r\n    }\r\n\r\n    for (var i = 0; i < elem.childs.length; i++) {\r\n        if (elem.childs[i] && (callback(elem.childs[i]) || this._iterateMenus(elem.childs[i], callback))) {\r\n            return true;\r\n        }\r\n    }\r\n}\r\n\r\n/** Добавляет к меню новый элемент верхнего уровня\r\n*\r\n* Если меню уже было нарисовано, вызов этой ф-ции приведёт к перерисовке\r\n*\r\n*    @param {IMenuElem} elem Элемент меню\r\n*/\r\nUpMenu.prototype.addItem = function(elem)\r\n{\r\n    this.submenus.push(elem)\r\n    this._isCreated && this.draw();\r\n}\r\n\r\n/** Добавляет к меню новый элемент.\r\n*\r\n* Если меню уже было нарисовано, вызов этой ф-ции приведёт к перерисовке\r\n*\r\n*    @param {IMenuElem} newElem Вставляемый элемент меню\r\n*    @param {String} parentID ID элемента меню, к которому добавляется новый элемент\r\n*    @param {String} [insertBeforeID] ID элемента меню, перед которым нужно вставить пункт меню.\r\n*                    Если не указан, пункт меню будет добавлен в конец списка.\r\n*/\r\nUpMenu.prototype.addChildItem = function(newElem, parentID, insertBeforeID)\r\n{\r\n    this._iterateMenus({childs: this.submenus}, function(elem) {\r\n        if (elem.id && elem.id === parentID) {\r\n            elem.childs = elem.childs || [];\r\n\r\n            var index = elem.childs.length;\r\n            elem.childs.forEach(function(childElem, i) {\r\n                if (childElem.id === insertBeforeID) {\r\n                    index = i;\r\n                }\r\n            })\r\n\r\n            elem.childs.splice(index, 0, newElem);\r\n\r\n            this._isCreated && this.draw();\r\n\r\n            return true;\r\n        }\r\n    }.bind(this));\r\n}\r\n\r\n/** Задаёт родителя в DOM дереве для меню\r\n* @param {DOMElement} parent Родительский элемент в DOM дереве\r\n*/\r\nUpMenu.prototype.setParent = function(parent)\r\n{\r\n    this.parent = parent;\r\n\r\n    if (parent)\r\n    {\r\n        $(parent).empty();\r\n        parent.appendChild(_span());\r\n    }\r\n\r\n    this.disabledTabs = {};\r\n}\r\n\r\n// Показывает элемент меню\r\nUpMenu.prototype.showmenu = function(elem)\r\n{\r\n    elem.style.visibility = 'visible';\r\n    if (this.openedMenus.indexOf(elem) === -1) {\r\n        this.openedMenus.push(elem);\r\n    }\r\n}\r\n// Скрывает элемент меню\r\nUpMenu.prototype.hidemenu = function(elem)\r\n{\r\n    elem.style.visibility = 'hidden';\r\n    if (this.openedMenus.indexOf(elem) !== -1) {\r\n        this.openedMenus.splice(this.openedMenus.indexOf(elem), 1);\r\n    }\r\n}\r\n\r\nUpMenu.prototype._template = Handlebars.compile(\r\n'<div class=\"headerContainer\">\\\r\n{{#childs}}{{#if id}}\\\r\n    <div class = \"header1{{#unless childs}} menuClickable{{/unless}}\" hash = \"{{id}}\">\\\r\n        <div class = \"header1Internal\">{{title}}</div>\\\r\n        {{#if childs}}\\\r\n            <ul class = \"header2\" id=\"{{id}}\">\\\r\n            {{#childs}}{{#if id}}\\\r\n                <li class = \"header2{{#unless childs}} menuClickable{{/unless}}\" hash = \"{{id}}\">\\\r\n                    <div class = \"header2{{#if disabled}} menuDisabled{{/if}}{{#delimiter}} menuDelimiter{{/delimiter}}\">\\\r\n                        <div class = \"menuMarkerLeft {{#if checked}} ui-icon ui-icon-check{{/if}}\"></div>\\\r\n                        {{title}}\\\r\n                        {{#if childs}}\\\r\n                            <div class = \"menuMarkerRight\"></div>\\\r\n                        {{/if}}\\\r\n                    </div>\\\r\n                    {{#if childs}}\\\r\n                        <ul class = \"header3\" id=\"{{id}}\">\\\r\n                        {{#childs}}{{#if id}}\\\r\n                            <li class = \"header3 menuClickable\" hash = \"{{id}}\">\\\r\n                                <div class = \"header3{{#if disabled}} menuDisabled{{/if}}{{#delimiter}} menuDelimiter{{/delimiter}}\">\\\r\n                                    <div class = \"menuMarkerLeft {{#if checked}} ui-icon ui-icon-check{{/if}}\"></div>\\\r\n                                    {{title}}\\\r\n                                </div>\\\r\n                            </li>\\\r\n                        {{/if}}{{/childs}}\\\r\n                        </ul>\\\r\n                    {{/if}}\\\r\n                </li>\\\r\n            {{/if}}{{/childs}}\\\r\n            </ul>\\\r\n        {{/if}}\\\r\n    </div>\\\r\n    {{/if}}{{/childs}}\\\r\n</div>');\r\n\r\n/** Основная функция  - рисует меню по заданной структуре\r\n*/\r\nUpMenu.prototype.draw = function()\r\n{\r\n    var ui = $(this._template({\r\n            childs: this.submenus\r\n        })),\r\n        _this = this;\r\n\r\n    $(this.parent.firstChild).empty().append(ui);\r\n\r\n    $(ui).find('.header1').each(function() {\r\n        _this.attachEventOnClick(this, 'menuActive');\r\n        _this.attachEventOnMouseover(this, 'menuActive');\r\n        _this.attachEventOnMouseout(this, 'menuActive');\r\n        $(this).width($(this).width() + 10);\r\n    });\r\n\r\n    $(ui).find('li.header2').each(function() {\r\n        _this.attachEventOnMouseover(this, 'menu2Active');\r\n        _this.attachEventOnMouseout(this, 'menu2Active');\r\n    });\r\n\r\n    $(ui).find('li.header3').each(function() {\r\n        attachEffects(this, 'menu3Active');\r\n    });\r\n\r\n    $(ui).find('.menuClickable').each(function() {\r\n        var id = $(this).attr('hash');\r\n        $(this).click(function(e) {\r\n            e.stopPropagation();\r\n            _this.refs[id].disabled || _this.openTab(id, e);\r\n        });\r\n    });\r\n\r\n    this._iterateMenus({childs: this.submenus}, function(elem) {\r\n        _this.refs[elem.id] = elem;\r\n    })\r\n\r\n    //убираем все скрытые меню\r\n    for (var d in this.disabledTabs)\r\n        this.disableMenus([d]);\r\n\r\n    this._isCreated = true;\r\n}\r\n\r\nUpMenu.prototype.checkItem = function(id, isChecked) {\r\n    if (this.refs[id]) {\r\n        this.refs[id].checked = isChecked;\r\n        $(this.parent).find('li[hash=' + id + ']').find('.menuMarkerLeft').toggleClass('ui-icon ui-icon-check', isChecked);\r\n    }\r\n}\r\n\r\nUpMenu.prototype.removeSelections = function()\r\n{\r\n    $('li.menu3Active').removeClass('menu3Active');\r\n    $('li.menu2Active').removeClass('menu2Active');\r\n    $('li.menuActive').removeClass('menuActive');\r\n}\r\n// Закрывает открытые меню\r\nUpMenu.prototype.hideMenus = function()\r\n{\r\n    var _this = this;\r\n\r\n    $('ul.header2').each(function()\r\n    {\r\n        _this.hidemenu(this);\r\n    })\r\n    $('ul.header3').each(function()\r\n    {\r\n        _this.hidemenu(this);\r\n    })\r\n}\r\n// Открывает закладку\r\nUpMenu.prototype.openRef = function(hash)\r\n{\r\n    _menuUp.removeSelections();\r\n    _menuUp.hideMenus();\r\n    _menuUp.openTab(hash);\r\n}\r\n\r\nUpMenu.prototype.attachEventOnClick = function(elem)\r\n{\r\n    var _this = this;\r\n    elem.onclick = function() {\r\n        if (!_this.clicked) {\r\n            var isTopLevel = $(elem).hasClass('header1'),\r\n                hash = this.getAttribute('hash');\r\n\r\n            if (isTopLevel && !_this.currentTopHash) {\r\n                _this.currentTopHash = hash;\r\n                _this.clicked = true;\r\n            }\r\n\r\n            if ($('#' + hash)[0]) {\r\n                _this.showmenu($('#' + this.getAttribute('hash'))[0]);\r\n            }\r\n\r\n        } else {\r\n            return;\r\n        }\r\n    }\r\n}\r\n\r\nUpMenu.prototype.attachEventOnMouseover = function(elem, className)\r\n{\r\n    let _this = this;\r\n    elem.onmouseover = function() {\r\n        $(this).addClass(className);\r\n        if (_this.clicked) {\r\n            let itemsToClose = [];\r\n            for (let i = 0; i < _this.openedMenus.length; i++) {\r\n                if (!_this.checkInsideElem(elem, _this.openedMenus[i])) {\r\n                    itemsToClose.push(_this.openedMenus[i]);\r\n                }\r\n            }\r\n\r\n            for (let i = 0; i < itemsToClose.length; i++) {\r\n                let ee = itemsToClose[i];\r\n                _this.hidemenu(ee);\r\n            }\r\n\r\n            if ($('#' + this.getAttribute('hash'))[0]) {\r\n                _this.showmenu($('#' + this.getAttribute('hash'))[0]);\r\n            }\r\n\r\n            //add top-level hash\r\n            let isTopLevel = $(elem).hasClass('header1'),\r\n                hash = this.getAttribute('hash');\r\n            if (isTopLevel) {\r\n                _this.currentTopHash = hash;\r\n                $(document).find('.header1').each(function() {\r\n                    $(this).removeClass('menuActive');\r\n                });\r\n                $(this).addClass(className);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nUpMenu.prototype.checkInsideElem = function(elem, descendant)\r\n{\r\n    var parents = $(descendant).parents(),\r\n        parentsArr = $(parents).toArray(),\r\n        isInsideElem = parentsArr.some(function (em) {\r\n            return $(em).attr('hash') === $(elem).attr('hash');\r\n        });\r\n\r\n    return isInsideElem;\r\n}\r\nUpMenu.prototype.attachEventOnMouseout = function(elem, className)\r\n{\r\n    var _this = this;\r\n    elem.onmouseout = function(e) {\r\n        var evt = e || window.event,\r\n            // target = evt.srcElement || evt.target,\r\n            relTarget = evt.relatedTarget || evt.toElement,\r\n            elem = this,\r\n            isTopLevel = $(elem).hasClass('header1'),\r\n            hash = this.getAttribute('hash');\r\n\r\n        try {\r\n            while (relTarget) {\r\n                if (relTarget == elem) {\r\n                    stopEvent(e);\r\n\r\n                    return false;\r\n                }\r\n                relTarget = relTarget.parentNode;\r\n            }\r\n            if (isTopLevel && hash === _this.currentTopHash) {\r\n                return false;\r\n            } else {\r\n                // _this.currentTopHash = null;\r\n                $(elem).removeClass(className);\r\n            }\r\n        } catch (e) {\r\n            if (isTopLevel && hash === _this.currentTopHash) {\r\n                return false;\r\n            } else {\r\n                // _this.currentTopHash = null;\r\n                $(elem).removeClass(className);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nUpMenu.prototype.getNavigatePath = function(path) {\r\n    for (var menuIdx = 0; menuIdx < this.submenus.length; menuIdx++)\r\n    {\r\n        var submenu = this.submenus[menuIdx];\r\n\r\n        if (!submenu) {continue;}\r\n\r\n        if (path == submenu.id)\r\n        {\r\n            return [submenu.title];\r\n        }\r\n\r\n        if (submenu.childs)\r\n        {\r\n            var childsLevel2 = submenu.childs;\r\n            for (var i = 0; i < childsLevel2.length; i++)\r\n            {\r\n                if (!childsLevel2[i]) {continue;}\r\n\r\n                if (childsLevel2[i].childs)\r\n                {\r\n                    var childsLevel3 = childsLevel2[i].childs;\r\n                    // есть подменю, смотрим там\r\n                    for (var j = 0; j < childsLevel3.length; j++)\r\n                    {\r\n                        if (!childsLevel3[j]) {continue;}\r\n\r\n                        if (path == childsLevel3[j].id)\r\n                        {\r\n                            return [submenu.title, childsLevel2[i].title, childsLevel3[j].title];\r\n                        }\r\n                    }\r\n                }\r\n                if (path == childsLevel2[i].id)\r\n                {\r\n                    // совпадение в меню 2го уровня\r\n                    return [submenu.title, childsLevel2[i].title];\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return [];\r\n}\r\n\r\n/** Показывает все ранее скрытые элементы меню\r\n*/\r\nUpMenu.prototype.enableMenus = function()\r\n{\r\n    for (var name in this.disabledTabs)\r\n    {\r\n        $(this.parent).find(\"li[hash='\" + name + \"']\").children('div').css('display','');\r\n\r\n        delete this.disabledTabs[name];\r\n    }\r\n}\r\n/** Скрывает заданные элементы меню\r\n* @param {String[]} arr Массив ID элементов меню, которые нужно скрыть\r\n*/\r\nUpMenu.prototype.disableMenus = function(arr)\r\n{\r\n    for (var i = 0; i < arr.length; i++)\r\n    {\r\n        $(this.parent).find(\"li[hash='\" + arr[i] + \"']\").children('div').css('display','none');\r\n\r\n        this.disabledTabs[arr[i]] = true;\r\n    }\r\n}\r\n\r\nUpMenu.prototype.checkView = function()\r\n{\r\n    if (!nsGmx.AuthManager.isLogin())\r\n    {\r\n        this.enableMenus();\r\n\r\n        this.disableMenus(['mapCreate', 'mapSave', 'mapSaveAs', 'layersMenu', 'pictureBinding']);\r\n    }\r\n    else if (_queryMapLayers.currentMapRights() != \"edit\")\r\n    {\r\n        this.enableMenus();\r\n\r\n        this.disableMenus(['mapSave', 'mapSaveAs', 'layersVector', 'layersRaster', 'layersMultiRaster']);\r\n    }\r\n\r\n    if (!nsGmx.AuthManager.isRole(nsGmx.ROLE_ADMIN)) {\r\n        this.disableMenus(['stileLibrary']);\r\n    }\r\n\r\n    if (_queryMapLayers.currentMapRights() !== \"edit\") {\r\n        this.disableMenus(['mapTabsNew']);\r\n    }\r\n\r\n    if (!nsGmx.AuthManager.canDoAction(nsGmx.ACTION_CREATE_LAYERS))\r\n    {\r\n            this.disableMenus(['layersVector', 'layersRaster', 'layersMultiRaster']);\r\n    }\r\n\r\n    if (!nsGmx.AuthManager.canDoAction(nsGmx.ACTION_CREATE_MAP))\r\n    {\r\n            this.disableMenus(['mapCreate']);\r\n    }\r\n}\r\n\r\nUpMenu.prototype.go = function(container)\r\n{\r\n    this.setParent(container);\r\n\r\n    this.createMenu();\r\n\r\n    this.draw();\r\n\r\n    this.checkView();\r\n\r\n    if (window.location.hash)\r\n    {\r\n        this.currUnsel = function(){};\r\n    }\r\n\r\n    this.openTab(this.defaultHash);\r\n}\r\n\r\nUpMenu.prototype.openTab = function(id, event)\r\n{\r\n    if (this.disabledTabs[id] || !this.refs[id]) {\r\n        return;\r\n    }\r\n\r\n    var item = this.refs[id];\r\n\r\n    this.removeSelections();\r\n    this.hideMenus();\r\n\r\n    if (item.func) {\r\n        this.clicked = false;\r\n        event.stopPropagation();\r\n        this.hideOnClick(event);\r\n        item.func(id);\r\n    } else {\r\n        var func = item[item.checked ? 'onunsel' : 'onsel'];\r\n        this.checkItem(id, !item.checked);\r\n        func && func(id);\r\n    }\r\n}\r\n\r\n/** Блок (контейнер с заголовком) левой панели\r\n    @class\r\n    @param {String} canvasID Уникальный идентификатор блока\r\n    @param {Object} options Параметры\r\n    @param {function} [options.closeFunc] Ф-ция, которая будет вызвана при нажатии на иконку закрытия блока. По умолчанию ничего не делается.\r\n    @param {String[]} [options.path] Массив строк для формирования названия блока (см. метод setTitle()).\r\n                      По умолчанию будет сформирован из верхнего меню ГеоМиксера по canvasID.\r\n    @param {Boolean} [options.showCloseButton=true] Показывать ли кнопку закрытия блока\r\n    @param {Boolean} [options.showMinimizeButton=true] Показывать ли кнопку сворачивания блока\r\n*/\r\nnsGmx.LeftPanelItem = function(canvasID, options) {\r\n    /** Изменение видимости контента (\"свёрнутости\") панели\r\n     * @event nsGmx.LeftPanelItem.changeVisibility\r\n    */\r\n\r\n    options = $.extend({\r\n        closeFunc: function(){},\r\n        showCloseButton: true,\r\n        showMinimizeButton: true\r\n    }, options);\r\n\r\n    //по умолчанию оставляем только последний элемент списка\r\n    if (!options.path) {\r\n        var menuPath = _menuUp.getNavigatePath(canvasID);\r\n        options.path = menuPath.length ? [menuPath[menuPath.length - 1]] : [];\r\n    }\r\n\r\n    var getPathHTML = function(path) {\r\n        if (!path) return '';\r\n\r\n        return Handlebars.compile(\r\n            '<tr>' +\r\n                '{{#path}}' +\r\n                    '<td class=\"leftmenu-path-item {{#last}}menuNavigateCurrent{{/last}}\">{{name}}</td>' +\r\n                    '{{^last}}<td><div class=\"markerRight\"></div></td>{{/last}}' +\r\n                '{{/path}}' +\r\n            '</tr>')(\r\n            {\r\n                path: path.map(function(item, index, arr) {\r\n                    return {name: item, last: index === arr.length-1};\r\n                })\r\n            }\r\n        );\r\n    }\r\n\r\n    var ui = Handlebars.compile(\r\n        '<div class=\"leftmenu-canvas {{id}}\" id=\"{{id}}\">' +\r\n            '{{#isTitle}}<div class=\"leftTitle\">' +\r\n                '{{#showMinimizeButton}}' +\r\n                    '<div class = \"leftmenu-toggle-zone\">' +\r\n                        '<div class=\"ui-helper-noselect leftmenu-toggle-icon leftmenu-down-icon\"></div>' +\r\n                    '</div>' +\r\n                '{{/showMinimizeButton}}' +\r\n                '<table class=\"leftmenu-path ui-helper-noselect\">{{{pathTR}}}</table>' +\r\n                '{{#showCloseButton}}<div class=\"gmx-icon-close\"></div>{{/showCloseButton}}' +\r\n            '</div>{{/isTitle}}' +\r\n            '<div class = \"workCanvas\"></div>' +\r\n        '</div>');\r\n\r\n    /**HTML элемент с блоком (содержит шапку и рабочую область)*/\r\n    this.panelCanvas = $(ui({\r\n        isTitle: !!(options.path.length || options.showCloseButton || options.showMinimizeButton),\r\n        id: 'left_' + canvasID,\r\n        pathTR: getPathHTML(options.path),\r\n        showCloseButton: options.showCloseButton,\r\n        showMinimizeButton: options.showMinimizeButton\r\n    }))[0];\r\n\r\n    /**Рабочая область блока*/\r\n    this.workCanvas = $(this.panelCanvas).find('.workCanvas')[0];\r\n\r\n    /** Программная имитация нажатия кнопки закрытия блока\r\n        @function\r\n    */\r\n    this.close = options.closeFunc;\r\n\r\n    var isUICollapsed = false,\r\n        _this = this;\r\n\r\n    var toggleContentVisibility = function(isCollapsed) {\r\n        if (isUICollapsed !== isCollapsed) {\r\n            isUICollapsed = !isUICollapsed;\r\n            $(_this.workCanvas).toggle();\r\n            $(_this.panelCanvas).find('.leftmenu-toggle-zone div').toggleClass('leftmenu-down-icon leftmenu-right-icon');\r\n            $(_this).trigger('changeVisibility');\r\n        }\r\n    }\r\n\r\n    $('.leftmenu-toggle-zone, .leftmenu-path', this.panelCanvas).click(function() {\r\n        toggleContentVisibility(!isUICollapsed);\r\n    });\r\n\r\n    /** Свернуть панель\r\n        @function\r\n    */\r\n    this.hide = toggleContentVisibility.bind(null, true);\r\n\r\n    /** Развернуть панель\r\n        @function\r\n    */\r\n    this.show = toggleContentVisibility.bind(null, false);\r\n\r\n    /** Свёрнута ли панель */\r\n    this.isCollapsed = function() {return isUICollapsed};\r\n\r\n    $('.leftTitle .gmx-icon-close',  this.panelCanvas).click(options.closeFunc);\r\n\r\n    /** Задать новый заголовок окна\r\n     @param {String[]} [path] Массив строк для формирования названия блока.\r\n                      Предполагается, что последний элемент является собственно названием, а предыдущие - названиями категорий.\r\n    */\r\n    this.setTitle = function(path) {\r\n        $('.leftmenu-path', this.panelCanvas).html(getPathHTML(path));\r\n    }\r\n}\r\n\r\n/** Основное меню ГеоМиксера\r\n * @global\r\n * @type {UpMenu}\r\n */\r\nvar _menuUp = new UpMenu();\r\n\r\n// содержит ссылку на рабочую область для текущей вкладки\r\nvar leftMenu = function()\r\n{\r\n    this.workCanvas = null;\r\n    this.parentWorkCanvas = null;\r\n}\r\n\r\n//варианты вызова:\r\n//    function(canvasID, closeFunc, options) - для обратной совместимости\r\n//    function(canvasID, options)\r\n// options - те же, что и в LeftPanelItem\r\nleftMenu.prototype.createWorkCanvas = function(canvasID, closeFunc, options)\r\n{\r\n    if (typeof closeFunc !== 'function') {\r\n        options = closeFunc || {};\r\n        closeFunc = options.closeFunc;\r\n    } else {\r\n        options = options || {};\r\n    }\r\n\r\n    options.closeFunc = function() {\r\n        $(_this.parentWorkCanvas).hide();\r\n        closeFunc && closeFunc();\r\n    }\r\n\r\n    var _this = this;\r\n    if (!$('#left_' + canvasID).length)\r\n    {\r\n        var leftPanelItem = new nsGmx.LeftPanelItem(canvasID, options);\r\n        this.parentWorkCanvas = leftPanelItem.panelCanvas;\r\n        this.workCanvas = leftPanelItem.workCanvas;\r\n        this.leftPanelItem = leftPanelItem;\r\n\r\n        // так как мы используем dom элементы для поиска панелей после первого добавления\r\n        // возможно, лучше сделать полноценный менеджер панелей левой вкладки\r\n        this.parentWorkCanvas.leftPanelItem = leftPanelItem;\r\n\r\n        $('#leftContentInner').prepend(this.parentWorkCanvas);\r\n\r\n        return false;\r\n    }\r\n    else\r\n    {\r\n        this.parentWorkCanvas = $('#left_' + canvasID)[0];\r\n        this.workCanvas = this.parentWorkCanvas.lastChild;\r\n        this.leftPanelItem = this.parentWorkCanvas.leftPanelItem;\r\n        this.leftPanelItem.close = options.closeFunc;\r\n\r\n        $(this.parentWorkCanvas).show();\r\n\r\n        $('#leftContentInner').prepend(this.parentWorkCanvas);\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\nexport { leftMenu, _menuUp };","﻿import nsGmx from './nsGmx.js';\r\n\r\nnsGmx.VirtualLayerManager = function() {\r\n    this._classes = window.gmxVirtualClasses || {};\r\n    this.loader = this.loader.bind(this);\r\n}\r\n\r\nnsGmx.VirtualLayerManager.prototype.loader = function(type) {\r\n    var promise = new L.gmx.Deferred(),\r\n        classInfo = this._classes[type];\r\n    \r\n    if (!classInfo) {\r\n        promise.resolve();\r\n        return promise;\r\n    }\r\n    \r\n    window.gmxCore.loadModule(classInfo.module, classInfo.file).then(function(module) {\r\n        promise.resolve(module.layerClass);\r\n    }, promise.reject);\r\n    \r\n    return promise;\r\n};","﻿import nsGmx from './nsGmx.js';\r\n\r\n(function(){\r\n\r\n//внутреннее представление плагина\r\nvar Plugin = function(moduleName, file, body, params, pluginName, mapPlugin, isPublic, lazyLoad)\r\n{\r\n    var usageState = mapPlugin && !lazyLoad ? 'unknown' : 'used'; //used, notused, unknown\r\n    var _this = this;\r\n\r\n    var doLoad = function()\r\n    {\r\n        if (_this.body || _this.isLoading)\r\n            return;\r\n\r\n        _this.isLoading = true;\r\n        window.gmxCore.loadModule(moduleName, file).then(function()\r\n        {\r\n            _this.body = window.gmxCore.getModule(moduleName);\r\n            _this.isLoading = false;\r\n            _this.pluginName = _this.pluginName || _this.body.pluginName;\r\n            _this.def.resolve();\r\n        }, function() {\r\n            _this.isLoading = false;\r\n            _this.def.reject();\r\n        });\r\n    }\r\n\r\n    this.body = body;\r\n    this.moduleName = moduleName;\r\n    this.params = params || {};\r\n    this.def = $.Deferred(); //будет resolve когда плагин загрузится\r\n    this.isLoading = false;\r\n    this.mapPlugin = mapPlugin || (body && body.pluginName);\r\n    this.pluginName = pluginName || (this.body && this.body.pluginName);\r\n    this.isPublic = isPublic;\r\n    this.lazyLoad = lazyLoad;\r\n    this.file = file;\r\n\r\n    if (this.body)\r\n        this.def.resolve();\r\n\r\n    //мы не будем пока загружать плагин только если он не глобальный и имеет имя\r\n    // и только если специально не указана загрузка по требованию\r\n    if (!mapPlugin || !pluginName) {\r\n        if (!lazyLoad) {\r\n            doLoad();\r\n        }\r\n    }\r\n\r\n    this.setUsage = function(usage)\r\n    {\r\n        usageState = usage;\r\n        if (usageState === 'used') {\r\n            doLoad();\r\n        }\r\n    }\r\n\r\n    this.isUsed = function()\r\n    {\r\n        return usageState === 'used';\r\n    }\r\n\r\n    this.updateParams = function (newParams) {\r\n        $.extend(true, _this.params, newParams);\r\n    }\r\n}\r\n\r\n/**\r\n  @name IGeomixerPlugin\r\n  @desc Интерфейс плагинов ГеоМиксера\r\n  @class\r\n  @abstract\r\n  @property {String} pluginName Имя плагина для списка плагинов\r\n*/\r\n\r\n/**\r\n  @memberOf IGeomixerPlugin.prototype\r\n  @method\r\n  @name beforeMap\r\n  @desc Вызывется сразу после загрузки всех модулей ядра вьюера (до инициализации карты, проверки пользователя и т.п.).\r\n        Ещё нет информации о пользователе, но пока можно сменить карту для загрузки.\r\n  @param {Object} params Параметры плагина\r\n*/\r\n\r\n/**\r\n  @memberOf IGeomixerPlugin.prototype\r\n  @method\r\n  @name preloadMap\r\n  @desc Вызывется непосредственно перед началом создания слоёв по загруженной информации о карте.\r\n        Карту сменить уже нельзя, но можно как-нибудь повлиять на процесс создания слоёв (например, добавить новые классы слоёв)\r\n  @param {Object} params Параметры плагина\r\n*/\r\n\r\n/**\r\n  @memberOf IGeomixerPlugin.prototype\r\n  @method\r\n  @name beforeViewer\r\n  @desc вызовется до начала инициализации ГеоМиксера, но сразу после инициализации карты\r\n  @param {Object} params Параметры плагина\r\n  @param {gmxAPI.Map} map Основная карта\r\n*/\r\n\r\n/**\r\n  @memberOf IGeomixerPlugin.prototype\r\n  @method\r\n  @name afterViewer\r\n  @desc вызовется после окончания инициализации ГеоМиксера\r\n  @param {Object} params Параметры плагина\r\n  @param {gmxAPI.Map} map Основная карта\r\n*/\r\n\r\n/** Менеджер плагинов. Загружает плагины из конфигурационного файла\r\n*\r\n* Загрузка плагинов происходит из массива window.gmxPlugins.\r\n*\r\n* Каждый элемент этого массива - объект со следующими свойствами:\r\n*\r\n*   * module (имя модуля)\r\n*   * file (из какого файла подгружать модуль, может отсутствовать). Только если указано module\r\n*   * plugin (сам плагин). Если указано, плагин подгружается в явном виде, иначе используется module (и file)\r\n*   * params - объект параметров, будет передаваться в методы модуля\r\n*   * pluginName - имя плагина. Должно быть уникальным. Заменяет IGeomixerPlugin.pluginName. Не рекомендуется использовать без особых причин\r\n*   * mapPlugin {bool, default: true} - является ли плагин плагином карт. Если является, то не будет грузиться по умолчанию.\r\n*   * isPublic {bool, default: false} - нужно ли показывать плагин в списках плагинов (для некоторых плагинов хочется иметь возможность подключать их к картам, но не показывать всем пользователям)\r\n*\r\n* Если очередной элемент массива просто строка (например, \"name\"), то это эквивалентно {module: \"name\", file: \"plugins/name.js\"}\r\n*\r\n* Каждый плагин хранится в отдельном модуле (через свойство module) или подгружается в явном виде (через свойство plugin). Модуль должен реализовывать интерфейс IGeomixerPlugin.\r\n*  @class PluginsManager\r\n*/\r\nvar PluginsManager = function()\r\n{\r\n    var _plugins = [];\r\n    var _pluginsWithName = {};\r\n\r\n    var joinedPluginInfo = {};\r\n\r\n    //сначала загружаем инфу о плагинах из переменной nsGmx._defaultPlugins - плагины по умолчанию\r\n    window.nsGmx && nsGmx._defaultPlugins && $.each(nsGmx._defaultPlugins, function(i, info) {\r\n        if (typeof info === 'string') {\r\n            info = { module: info, file: 'plugins/' + info + '.js' };\r\n        }\r\n        joinedPluginInfo[info.module] = info;\r\n    })\r\n\r\n    //дополняем её инфой из window.gmxPlugins с возможностью перезаписать\r\n    window.gmxPlugins && $.each(window.gmxPlugins, function(i, info) {\r\n        if (typeof info === 'string') {\r\n            info = { module: info, file: 'plugins/' + info + '.js' };\r\n        }\r\n        joinedPluginInfo[info.module] = $.extend(true, joinedPluginInfo[info.module], info);\r\n    })\r\n\r\n    $.each(joinedPluginInfo, function(key, info) {\r\n        if (typeof info === 'string')\r\n            info = { module: info, file: 'plugins/' + info + '.js' };\r\n\r\n        var plugin = new Plugin(\r\n            info.module,\r\n            info.file,\r\n            info.plugin,\r\n            info.params,\r\n            info.pluginName,\r\n            info.mapPlugin,\r\n            info.isPublic || false,\r\n            info.lazyLoad || false\r\n        );\r\n\r\n        _plugins.push(plugin);\r\n\r\n        if (plugin.pluginName) {\r\n            _pluginsWithName[ plugin.pluginName ] = plugin;\r\n        }\r\n        else\r\n        {\r\n            plugin.def.done(function()\r\n            {\r\n                if (plugin.pluginName) {\r\n                    _pluginsWithName[ plugin.pluginName ] = plugin;\r\n                }\r\n            })\r\n        }\r\n    })\r\n\r\n    var _genIterativeFunction = function(funcName)\r\n    {\r\n        return function(map)\r\n        {\r\n            for (var p = 0; p < _plugins.length; p++)\r\n                if ( _plugins[p].isUsed() && _plugins[p].body && _plugins[p].body[funcName]) {\r\n                    //передаём в плагин deep clone параметров, чтобы плагин не мог их менять in-place\r\n                    var params = $.extend(true, {}, _plugins[p].params);\r\n                    try {\r\n                        _plugins[p].body[funcName]( params, map || nsGmx.leafletMap );\r\n                    } catch (e) {\r\n                        console && console.error('Error in function ' + funcName + '() of plugin ' + _plugins[p].moduleName + ': ' + e);\r\n                        console && console.error(e.stack);\r\n                    }\r\n                }\r\n        }\r\n    }\r\n\r\n    //public interface\r\n\r\n    /**\r\n    Вызывет callback когда будут загружены все плагины, загружаемые в данный момент\r\n    @memberOf PluginsManager\r\n     @name done\r\n     @method\r\n     @param {Function} callback Ф-ция, которую нужно будет вызвать\r\n    */\r\n\r\n    this.done = function(f) {\r\n        //не можем использовать $.when, так как при первой ошибке результирующий promise сразу же reject'ится, а нам нужно дождаться загрузки всех плагинов\r\n        var loadingPlugins = _.where(_plugins, {isLoading: true}),\r\n            count = loadingPlugins.length;\r\n\r\n        count || f();\r\n\r\n        loadingPlugins.forEach(function(plugin) {\r\n            plugin.def.always(function() {\r\n                --count || f();\r\n            })\r\n        })\r\n    }\r\n\r\n    /**\r\n     Вызывает beforeMap() у всех плагинов\r\n     @memberOf PluginsManager\r\n     @name beforeMap\r\n     @method\r\n    */\r\n    this.beforeMap = _genIterativeFunction('beforeMap');\r\n\r\n    /**\r\n     Вызывает preloadMap() у всех плагинов\r\n     @memberOf PluginsManager\r\n     @name preloadMap\r\n     @method\r\n    */\r\n    this.preloadMap = _genIterativeFunction('preloadMap');\r\n\r\n    /**\r\n     Вызывает beforeViewer() у всех плагинов\r\n     @memberOf PluginsManager\r\n     @name beforeViewer\r\n     @method\r\n    */\r\n    this.beforeViewer = _genIterativeFunction('beforeViewer');\r\n\r\n    /**\r\n     Вызывает afterViewer() у всех плагинов\r\n     @memberOf PluginsManager\r\n     @name afterViewer\r\n     @method\r\n    */\r\n    this.afterViewer = _genIterativeFunction('afterViewer');\r\n\r\n    /**\r\n     Добавляет пункты меню всех плагинов к меню upMenu\r\n     Устарело! Используйте непосредственное добавление элемента к меню из afterViewer()\r\n     @method\r\n     @ignore\r\n    */\r\n    this.addMenuItems = function( upMenu )\r\n    {\r\n        for (var p = 0; p < _plugins.length; p++) {\r\n            if ( _plugins[p].isUsed() && _plugins[p].body && _plugins[p].body.addMenuItems) {\r\n                var menuItems = _plugins[p].body.addMenuItems();\r\n                for (var i = 0; i < menuItems.length; i++)\r\n                    upMenu.addChildItem(menuItems[i].item, menuItems[i].parentID);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     Вызывает callback(plugin) для каждого плагина\r\n     @memberOf PluginsManager\r\n     @name forEachPlugin\r\n     @method\r\n     @param {Function} callback Ф-ция для итерирования. Первый аргумент ф-ции - модуль плагина.\r\n    */\r\n    this.forEachPlugin = function(callback)\r\n    {\r\n        //if (!_initDone) return;\r\n        for (var p = 0; p < _plugins.length; p++)\r\n            callback(_plugins[p]);\r\n    }\r\n\r\n    /**\r\n     Задаёт, нужно ли в дальнейшем использовать данный плагин\r\n     @memberOf PluginsManager\r\n     @name setUsePlugin\r\n     @method\r\n     @param {String} pluginName Имя плагина\r\n     @param {Bool} isInUse Использовать ли его для карты\r\n    */\r\n    this.setUsePlugin = function(pluginName, isInUse)\r\n    {\r\n        if (pluginName in _pluginsWithName)\r\n            _pluginsWithName[pluginName].setUsage(isInUse ? 'used' : 'notused');\r\n    }\r\n\r\n    /**\r\n     Получить плагин по имени\r\n     @memberOf PluginsManager\r\n     @name getPluginByName\r\n     @method\r\n     @param {String} pluginName Имя плагина\r\n     @returns {IGeomixerPlugin} Модуль плагина, ничего не возвращает, если плагина нет\r\n    */\r\n    this.getPluginByName = function(pluginName)\r\n    {\r\n        return _pluginsWithName[pluginName];\r\n    }\r\n\r\n    /**\r\n     Проверка публичности плагина (можно ли его показывать в различных списках с перечислением подключенных плагинов)\r\n     @memberOf PluginsManager\r\n     @name isPublic\r\n     @method\r\n     @param {String} pluginName Имя плагина\r\n     @returns {Bool} Является ли плагин публичным\r\n    */\r\n    this.isPublic = function(pluginName)\r\n    {\r\n        return _pluginsWithName[pluginName] && _pluginsWithName[pluginName].isPublic;\r\n    }\r\n\r\n    /**\r\n     Обновление параметров плагина\r\n     @memberOf PluginsManager\r\n     @name updateParams\r\n     @method\r\n     @param {String} pluginName Имя плагина\r\n     @param {Object} newParams Новые параметры плагина. Параметры с совпадающими именами будут перезатёрты\r\n    */\r\n    this.updateParams = function(pluginName, newParams) {\r\n        _pluginsWithName[pluginName] && _pluginsWithName[pluginName].updateParams(newParams);\r\n    }\r\n}\r\n\r\nvar publicInterface = {PluginsManager : PluginsManager};\r\nwindow.gmxCore.addModule('PluginsManager', publicInterface);\r\n\r\n})();\r\n","import nsGmx from './nsGmx.js';\r\n\r\n// Делегаты пользовательских объектов - классы, управляющие отображением и сериализацией пользовательских объектов\r\n// Методы:\r\n//   - isHidden(obj) -> Bool\r\n//   - isSerializable(obj) -> Bool\r\nnsGmx.DrawingObjectCustomControllers = (function()\r\n{\r\n\tvar _delegates = [];\r\n\treturn {\r\n\t\taddDelegate: function(delegate)\r\n\t\t{\r\n\t\t\t_delegates.push(delegate);\r\n\t\t},\r\n\t\t\r\n\t\tisHidden: function(obj)\r\n\t\t{\r\n\t\t\tfor (var d = 0; d < _delegates.length; d++)\r\n\t\t\t\tif ('isHidden' in _delegates[d] && _delegates[d].isHidden(obj))\r\n\t\t\t\t\treturn true;\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\t\r\n\t\tisSerializable: function(obj)\r\n\t\t{\r\n\t\t\tfor (var d = 0; d < _delegates.length; d++)\r\n\t\t\t\tif ('isSerializable' in _delegates[d] && !_delegates[d].isSerializable(obj))\r\n\t\t\t\t\treturn false;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n})();","﻿import nsGmx from './nsGmx.js';\r\nimport {\r\n\t_table, _tbody, _tr, _td, _t,\r\n\t_textarea,\r\n\t_div, _span, makeButton,\r\n\t_ul, _li,\r\n\t_checkbox, _input, _a, _br,\r\n\tshowDialog\r\n} from './utilities.js';\r\n\r\n(function(_){\r\n\r\nvar BaseLayersControl = function(container, blm) {\r\n\tvar lang = _translationsHash.getLanguage();\r\n\r\n\t$(container).append(\r\n\t\t'<table class=\"group-editor-blm-table\">' +\r\n\t\t\t'<tr>' +\r\n\t\t\t\t'<td class=\"group-editor-blm-title\">' + _gtxt('Доступные подложки') + '</td>' +\r\n\t\t\t\t'<td class=\"group-editor-blm-title\">' + _gtxt('Подложки карты') + '</td>' +\r\n\t\t\t'</tr><tr>' +\r\n\t\t\t\t'<td class=\"group-editor-blm-available\"></td>' +\r\n\t\t\t\t'<td class=\"group-editor-blm-map\"></td>' +\r\n\t\t\t'</tr>' +\r\n\t\t'</table>'\r\n\t);\r\n\r\n\tvar availContainer = $('<ul class=\"group-editor-blm-ul\"></ul>').appendTo($('.group-editor-blm-available', container));\r\n\tvar mapContainer = $('<ul class=\"group-editor-blm-ul\"></ul>').appendTo($('.group-editor-blm-map', container));\r\n\r\n\tvar constructItem = function(id, title) {\r\n\t\tif (title) {\r\n\t\t\treturn $('<li class=\"group-editor-blm-item\">' + title + '</li>').data('baseLayerID', id);\r\n\t\t} else {\r\n\t\t\treturn $('<li class=\"group-editor-blm-item group-editor-blm-missing-item\">' + id + '</li>').data('baseLayerID', id);\r\n\t\t}\r\n\t}\r\n\r\n\tvar activeIDs = blm.getActiveIDs();\r\n\r\n\tblm.getAll().forEach(function(baseLayer) {\r\n\t\tif (activeIDs.indexOf(baseLayer.id) === -1) {\r\n\t\t\tvar item = constructItem(baseLayer.id, baseLayer.options[lang]);\r\n\t\t\tavailContainer.append(item);\r\n\t\t}\r\n\t})\r\n\r\n\tactiveIDs.forEach(function(id) {\r\n\t\tvar baseLayer = blm.get(id);\r\n\t\tmapContainer.append(constructItem(id, baseLayer && baseLayer.options[lang]));\r\n\t});\r\n\r\n\tvar updateBaseLayers = function() {\r\n\t\tvar activeIDs = [];\r\n\t\tmapContainer.children('li').each(function(index, elem) {\r\n\t\t\tactiveIDs.push($(elem).data('baseLayerID'));\r\n\t\t})\r\n\t\tblm.setActiveIDs(activeIDs);\r\n\t}\r\n\r\n\tmapContainer.sortable({\r\n\t\tconnectWith: '.group-editor-blm-available > ul',\r\n\t\tstop: updateBaseLayers\r\n\t});\r\n\tavailContainer.sortable({\r\n\t\tconnectWith: '.group-editor-blm-map > ul',\r\n\t\tstop: updateBaseLayers\r\n\t});\r\n}\r\n\r\nvar GroupVisibilityPropertiesModel = Backbone.Model.extend({\r\n\tdefaults: {\r\n\t\tisChildRadio: false,\r\n\t\tisVisibilityControl: false,\r\n\t\tisExpanded: false\r\n\t}\r\n})\r\n\r\n//возвращает массив описания элементов таблицы для использования в mapHelper.createPropertiesTable\r\n//model {GroupVisibilityPropertiesModel} - ассоциированные параметры видимости\r\n//showVisibilityCheckbox {bool} - добавлять ли возможность скрывать чекбокс видимости или нет\r\nvar GroupVisibilityPropertiesView = function( model, showVisibilityCheckbox, showExpanded )\r\n{\r\n\tvar _model = model;\r\n\tvar boxSwitch = _checkbox(!_model.get('isChildRadio'), 'checkbox'),\r\n\t\tradioSwitch = _checkbox(_model.get('isChildRadio'), 'radio');\r\n\tvar showCheckbox = _checkbox(_model.get('isVisibilityControl'), 'checkbox');\r\n\tvar isExpanded = _checkbox(_model.get('isExpanded'), 'checkbox');\r\n\r\n\tshowCheckbox.onclick = function()\r\n\t{\r\n\t\t_model.set('isVisibilityControl', this.checked );\r\n\t}\r\n\r\n\tisExpanded.onclick = function()\r\n\t{\r\n\t\t_model.set('isExpanded', this.checked );\r\n\t}\r\n\r\n\tboxSwitch.onclick = function()\r\n\t{\r\n\t\tthis.checked = true;\r\n\t\tradioSwitch.checked = !this.checked;\r\n\r\n\t\t_model.set('isChildRadio', !this.checked);\r\n\t}\r\n\r\n\tradioSwitch.onclick = function()\r\n\t{\r\n\t\tthis.checked = true;\r\n\t\tboxSwitch.checked = !this.checked;\r\n\r\n\t\t_model.set('isChildRadio', this.checked );\r\n\t}\r\n\r\n\tvar ret = [{name: _gtxt(\"Вид вложенных элементов\"), field: 'list', elem: _div([boxSwitch, radioSwitch])}];\r\n\r\n\tif (showVisibilityCheckbox)\r\n\t\tret.push({name: _gtxt(\"Показывать чекбокс видимости\"), elem: _div([showCheckbox])});\r\n\r\n\tif (showExpanded)\r\n\t\tret.push({name: _gtxt(\"Разворачивать автоматически\"), elem: _div([isExpanded])});\r\n\r\n\treturn ret;\r\n}\r\n\r\n/** Показывает диалог добавления новой подгруппы\r\n  @param div {HTMLNode} - куда добавлять новую подгруппу (группа или карта)\r\n  @param layersTree {layersTree} - дерево главной карты\r\n*/\r\nvar addSubGroup = function(div, layersTree)\r\n{\r\n\tvar ul = window._abstractTree.getChildsUl(div.parentNode),\r\n\t\tnewIndex;\r\n\r\n\tif (!ul)\r\n\t\tnewIndex = 0;\r\n\telse\r\n\t\tnewIndex = ul.childNodes.length + 1;\r\n\r\n\tvar groupVisibilityProperties = new GroupVisibilityPropertiesModel();\r\n\tvar groupVisibilityPropertiesControls = new GroupVisibilityPropertiesView( groupVisibilityProperties, true, true );\r\n\r\n\tvar elemProperties = (div.gmxProperties.content) ? div.gmxProperties.content.properties : div.gmxProperties.properties,\r\n\t\tnewName = elemProperties.title,\r\n\t\tinputIndex = _input(null,[['attr','value', newName + ' ' + newIndex],['dir','className','inputStyle'],['css','width','140px']]),\r\n\t\tcreate = makeButton(_gtxt('Создать')),\r\n\t\tpos = nsGmx.Utils.getDialogPos(div, true, 100),\r\n\t\tcreateSubGroup = function()\r\n\t\t{\r\n\t\t\tif (inputIndex.value == '')\r\n\t\t\t\treturn;\r\n\r\n\t\t\tvar parentProperties = div.gmxProperties,\r\n\t\t\t\tnewGroupProperties = {\r\n\t\t\t\t\ttype:'group',\r\n\t\t\t\t\tcontent:{\r\n\t\t\t\t\t\tproperties:{\r\n\t\t\t\t\t\t\ttitle:inputIndex.value,\r\n\t\t\t\t\t\t\tlist: groupVisibilityProperties.get('isChildRadio'),\r\n\t\t\t\t\t\t\tvisible: true,\r\n\t\t\t\t\t\t\tShowCheckbox: groupVisibilityProperties.get('isVisibilityControl'),\r\n\t\t\t\t\t\t\texpanded: groupVisibilityProperties.get('isExpanded'),\r\n\t\t\t\t\t\t\tinitExpand: groupVisibilityProperties.get('isExpanded'),\r\n\t\t\t\t\t\t\tGroupID: nsGmx.Utils.generateUniqueID()\r\n\t\t\t\t\t\t}, children:[]\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tli = window._layersTree.getChildsList(newGroupProperties, parentProperties, false, div.getAttribute('MapID') ? true : window._layersTree.getLayerVisibility($(div).find('input[type=\"checkbox\"]')[0]));\r\n\r\n\t\t\t_queryMapLayers.addDraggable(li)\r\n\r\n\t\t\t_queryMapLayers.addDroppable(li);\r\n\r\n\t\t\t_queryMapLayers.addSwappable(li);\r\n\r\n\t\t\tlayersTree.addTreeElem(div, 0, newGroupProperties);\r\n\r\n\t\t\tvar childsUl = window._abstractTree.getChildsUl(div.parentNode);\r\n\r\n\t\t\tif (childsUl)\r\n\t\t\t{\r\n\t\t\t\twindow._abstractTree.addNode(div.parentNode, li);\r\n\r\n\t\t\t\twindow._layersTree.updateListType(li, true);\r\n\r\n\t\t\t\tif (!childsUl.loaded)\r\n\t\t\t\t\tli.removeNode(true)\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\twindow._abstractTree.addNode(div.parentNode, li);\r\n\r\n\t\t\t\twindow._layersTree.updateListType(li, true);\r\n\t\t\t}\r\n\r\n\t\t\t$(dialogDiv).dialog('destroy');\r\n\t\t\tdialogDiv.removeNode(true);\r\n\r\n\t\t\t_mapHelper.updateUnloadEvent(true);\r\n\t\t};\r\n\r\n\tcreate.onclick = createSubGroup;\r\n\r\n\t$(inputIndex).on('keyup', function(e)\r\n\t{\r\n\t\tif (this.value == '')\r\n\t\t\t$(this).addClass('error');\r\n\t\telse\r\n\t\t\t$(this).removeClass('error');\r\n\r\n\t\tif (e.keyCode === 13)\r\n\t\t{\r\n\t\t\tcreateSubGroup();\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t});\r\n\r\n\tcreate.style.marginTop = '5px';\r\n\r\n\tvar parentDiv = _div([inputIndex, _br(), create],[['css','textAlign','center']]);\r\n\tvar trs = [{name: _gtxt(\"Имя группы\"), elem: inputIndex}].concat(groupVisibilityPropertiesControls);\r\n\r\n\tvar trsControls = _mapHelper.createPropertiesTable(trs, elemProperties, {leftWidth: 100});\r\n\tvar propsTable = _div([_table([_tbody(trsControls)],[['dir','className','propertiesTable']])]);\r\n\t_(parentDiv, [propsTable, _br(), create]);\r\n\r\n\tvar dialogDiv = showDialog(_gtxt(\"Введите имя группы\"), parentDiv, 270, 220, pos.left, pos.top);\r\n}\r\n\r\nvar createGroupEditorProperties = function(div, isMap, mainLayersTree)\r\n{\r\n\tvar elemProperties = (isMap) ? div.gmxProperties.properties : div.gmxProperties.content.properties;\r\n\r\n\tvar rawTree = mainLayersTree.treeModel.getRawTree();\r\n\r\n\tvar title = _input(null,[['attr','value',typeof elemProperties.title != 'undefined' ? elemProperties.title : ''],['dir','className','inputStyle'],['css','width','206px']])\r\n\r\n\tvar visibilityProperties = new GroupVisibilityPropertiesModel({\r\n\t\tisChildRadio: elemProperties.list,\r\n\t\tisVisibilityControl: typeof elemProperties.ShowCheckbox === 'undefined' ? false : elemProperties.ShowCheckbox,\r\n\t\tisExpanded: typeof elemProperties.initExpand === 'undefined' ? false : elemProperties.initExpand\r\n\t});\r\n\tvar visibilityPropertiesView = GroupVisibilityPropertiesView(visibilityProperties, !isMap, !isMap);\r\n\tvisibilityProperties.on('change', function()\r\n\t{\r\n\t\telemProperties.list = visibilityProperties.get('isChildRadio');\r\n\t\telemProperties.ShowCheckbox = visibilityProperties.get('isVisibilityControl');\r\n\t\telemProperties.expanded = elemProperties.initExpand = visibilityProperties.get('isExpanded');\r\n\r\n\t\twindow._layersTree.treeModel.updateNodeVisibility(mainLayersTree.findTreeElem(div).elem, null);\r\n\r\n\t\tvar curBox = div.firstChild;\r\n\t\tif (!elemProperties.ShowCheckbox)\r\n\t\t{\r\n\t\t\tcurBox.checked = true;\r\n\t\t\tcurBox.style.display = 'none';\r\n\t\t\tcurBox.isDummyCheckbox = true;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tcurBox.style.display = 'block';\r\n\t\t\tdelete curBox.isDummyCheckbox;\r\n\t\t}\r\n\r\n\t\tif (isMap) {\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t} else {\r\n\t\t\tmainLayersTree.findTreeElem(div).elem.content.properties = div.gmxProperties.content.properties;\r\n\t\t}\r\n\r\n\t\tvar ul = window._abstractTree.getChildsUl(div.parentNode);\r\n\r\n\t\t$(ul).children('li').each(function()\r\n\t\t{\r\n\t\t\twindow._layersTree.updateListType(this, true);\r\n\t\t})\r\n\t});\r\n\r\n\ttitle.onkeyup = function()\r\n\t{\r\n\t\tif (title.value == '')\r\n\t\t{\r\n\t\t\t$(title).addClass('error');\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telse\r\n\t\t\t$(title).removeClass('error');\r\n\r\n\t\tvar span = $(div).find(\".groupLayer\")[0];\r\n\r\n\t\t$(span).empty();\r\n\r\n\t\t_(span, [_t(title.value)]);\r\n\r\n\t\tif (isMap)\r\n\t\t{\r\n\t\t\t$('.mainmap-title').text(title.value);\r\n\r\n\t\t\tdiv.gmxProperties.properties.title = title.value;\r\n\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.content.properties.title = title.value;\r\n\r\n\t\t\tmainLayersTree.findTreeElem(div).elem.content.properties = div.gmxProperties.content.properties;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tvar addProperties = function(shownProperties)\r\n\t{\r\n\t\treturn _mapHelper.createPropertiesTable(shownProperties, elemProperties, {leftWidth: 100});\r\n\t};\r\n\r\n\tif (isMap)\r\n\t{\r\n\t\tvar useAPI = _checkbox(elemProperties.UseKosmosnimkiAPI, 'checkbox'),\r\n\t\t\tuseOSM = _checkbox(elemProperties.UseOpenStreetMap, 'checkbox'),\r\n\t\t\tdefLang = $('<span class=\"defaultMapLangContainer\">' +\r\n\t\t\t\t\t\t\t'<label><input type=\"radio\" name=\"defLang\" value=\"rus\">rus</label>' +\r\n\t\t\t\t\t\t\t'<label><input type=\"radio\" name=\"defLang\" value=\"eng\">eng</label>' +\r\n\t\t\t\t\t\t'</span>')[0],\r\n\t\t\tdistUnit = $('<span class=\"defaultMapLangContainer\">' +\r\n\t\t\t\t\t\t\t'<label><input type=\"radio\" name=\"distUnit\" value=\"auto\">' + _gtxt('units.auto') + '</label>' +\r\n\t\t\t\t\t\t\t'<label><input type=\"radio\" name=\"distUnit\" value=\"m\">' + _gtxt('units.m') + '</label>' +\r\n\t\t\t\t\t\t\t'<label><input type=\"radio\" name=\"distUnit\" value=\"km\">' + _gtxt('units.km') + '</label>' +\r\n\t\t\t\t\t\t\t'<label><input type=\"radio\" name=\"distUnit\" value=\"nm\">' + _gtxt('units.nm') + '</label>' +\r\n\t\t\t\t\t\t'</span>')[0],\r\n\t\t\tsquareUnit = $('<span class=\"defaultMapLangContainer\">' +\r\n\t\t\t\t\t\t\t'<label><input type=\"radio\" name=\"squareUnit\" value=\"auto\">' + _gtxt('units.auto') + '</label>' +\r\n\t\t\t\t\t\t\t'<label><input type=\"radio\" name=\"squareUnit\" value=\"m2\">' + _gtxt('units.m2') + '</label>' +\r\n\t\t\t\t\t\t\t'<label><input type=\"radio\" name=\"squareUnit\" value=\"ha\">' + _gtxt('units.ha') + '</label>' +\r\n\t\t\t\t\t\t\t'<label><input type=\"radio\" name=\"squareUnit\" value=\"km2\">' + _gtxt('units.km2') + '</label>' +\r\n\t\t\t\t\t\t'</span>')[0],\r\n\t\t   coordinatesFormat = $('<span class=\"defaultMapLangContainer\">' +\r\n\t\t\t\t\t\t\t'<label><input type=\"radio\" name=\"coordinatesFormat\" value=\"0\">' + _gtxt('coords.dd') + '</label>' +\r\n\t\t\t\t\t\t\t'<label><input type=\"radio\" name=\"coordinatesFormat\" value=\"1\">' + _gtxt('coords.dms') + '</label>' +\r\n\t\t\t\t\t\t'</span>')[0],\r\n\t\t\tmaxPopupCount = $('<span class=\"maxPopupCountContainer\">' +\r\n\t\t\t\t\t\t\t'<input type=\"number\" min=\"1\" class=\"inputStyle inputShortWidth\">' +\r\n\t\t\t\t\t\t   '</input>' +\r\n\t\t\t\t\t\t   '</span>')[0],\r\n\t\t\tlayerOrder = $('<select class=\"selectStyle\">' +\r\n\t\t\t\t\t\t\t'<option value=\"Native\">' + _gtxt('layerOrder.native') + '</label>' +\r\n\t\t\t\t\t\t\t'<option value=\"VectorOnTop\">' + _gtxt('layerOrder.vectorOnTop') + '</label>' +\r\n\t\t\t\t\t\t   '</select>')[0],\r\n\t\t\tdownloadVectors = _checkbox(elemProperties.CanDownloadVectors, 'checkbox'),\r\n\t\t\tdownloadRasters = _checkbox(elemProperties.CanDownloadRasters, 'checkbox'),\r\n\t\t\t// WMSLink = _a([_t(_gtxt('ссылка'))], [['attr', 'href', window.serverBase + 'TileService.ashx?map=' + elemProperties.name]]),\r\n\t\t\tWMSLinks = $(Handlebars.compile(\r\n\t\t\t\t'<div>' +\r\n\t\t\t\t\t'<ul>' +\r\n\t\t\t\t\t\t'{{#each this.services}}' +\r\n\t\t\t\t\t\t'<li>' +\r\n\t\t\t\t\t\t\t'{{this.upper}}: {{this.url}}rest/ver1/service/{{this.name}}?map={{this.mapName}}{{#if this.site}}&apikey=[APIKEY_VALUE]{{/if}}' +\r\n\t\t\t\t\t\t'</li>' +\r\n\t\t\t\t\t\t'<br>' +\r\n\t\t\t\t\t\t'{{/each}}' +\r\n\t\t\t\t\t'</ul>' +\r\n\t\t\t\t'</div>'\r\n\t\t\t)({\r\n\t\t\t\tservices: [{\r\n\t\t\t\t\t\tsite: window.mapsSite,\r\n\t\t\t\t\t\turl: window.serverBase,\r\n\t\t\t\t\t\tmapName: elemProperties.MapID,\r\n\t\t\t\t\t\tname: 'wms',\r\n\t\t\t\t\t\tupper: 'WMS'\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tsite: window.mapsSite,\r\n\t\t\t\t\t\turl: window.serverBase,\r\n\t\t\t\t\t\tmapName: elemProperties.MapID,\r\n\t\t\t\t\t\tname: 'wfs',\r\n\t\t\t\t\t\tupper: 'WFS'\r\n\t\t\t\t\t}]\r\n\t\t\t}))[0],\r\n\t\t\tWMSAccess = _checkbox(elemProperties.WMSAccess, 'checkbox'),\r\n\t\t\tdefLat = _input(null,[['attr','placeholder', _gtxt(\"placeholder degrees\")], ['attr','value',elemProperties.DefaultLat !== null ? elemProperties.DefaultLat : ''],['dir','className','inputStyle'],['css','width','62px']]),\r\n\t\t\tdefLong = _input(null,[['attr','placeholder', _gtxt(\"placeholder degrees\")], ['attr','value',elemProperties.DefaultLong !== null ? elemProperties.DefaultLong : ''],['dir','className','inputStyle'],['css','width','62px']]),\r\n\t\t\tdefPermalink = _input(null,[['attr','value',elemProperties.ViewUrl != null ? elemProperties.ViewUrl : ''],['dir','className','inputStyle'],['css','width','206px']]),\r\n\t\t\tdefZoom = _input(null,[['attr','placeholder', _gtxt(\"placeholder zoom\")], ['attr','value',elemProperties.DefaultZoom != null ? elemProperties.DefaultZoom : ''],['dir','className','inputStyle'],['css','width','60px']]),\r\n\t\t\tonLoad = _textarea(null,[['dir','className','inputStyle group-editor-onload']]),\r\n\t\t\tcopyright =  _input(null,[['attr','value',elemProperties.Copyright != null ? elemProperties.Copyright : ''],['dir','className','inputStyle'],['css','width','206px']]),\r\n\t\t\tminViewX =   _input(null,[['attr','placeholder', _gtxt(\"placeholder degrees\")], ['attr','value',elemProperties.MinViewX != null && elemProperties.MinViewX != 0 ? elemProperties.MinViewX : ''],['dir','className','inputStyle'],['css','width','62px']]),\r\n\t\t\tminViewY =   _input(null,[['attr','placeholder', _gtxt(\"placeholder degrees\")], ['attr','value',elemProperties.MinViewY != null && elemProperties.MinViewY != 0 ? elemProperties.MinViewY : ''],['dir','className','inputStyle'],['css','width','62px']]),\r\n\t\t\tmaxViewX =   _input(null,[['attr','placeholder', _gtxt(\"placeholder degrees\")], ['attr','value',elemProperties.MaxViewX != null && elemProperties.MaxViewX != 0 ? elemProperties.MaxViewX : ''],['dir','className','inputStyle'],['css','width','62px']]),\r\n\t\t\tmaxViewY =   _input(null,[['attr','placeholder', _gtxt(\"placeholder degrees\")], ['attr','value',elemProperties.MaxViewY != null && elemProperties.MaxViewY != 0 ? elemProperties.MaxViewY : ''],['dir','className','inputStyle'],['css','width','62px']]),\r\n\t\t\tminZoom =    _input(null,[['attr','placeholder', _gtxt(\"placeholder minZoom\")], ['attr','value',elemProperties.MinZoom != null ? elemProperties.MinZoom : ''],['dir','className','inputStyle'],['css','width','62px']]),\r\n\t\t\tmaxZoom =    _input(null,[['attr','placeholder', _gtxt(\"placeholder maxZoom\")], ['attr','value',elemProperties.MaxZoom != null ? elemProperties.MaxZoom : ''],['dir','className','inputStyle'],['css','width','62px']]);\r\n\r\n\t\tonLoad.value = nsGmx.mappletLoader.get();\r\n\r\n\t\tuseAPI.onclick = function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.UseKosmosnimkiAPI = this.checked;\r\n\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t}\r\n\r\n\t\t$([useAPI, useOSM]).addClass('propertiesTable-checkbox');\r\n\r\n\t\t$('input[value=' + elemProperties.DefaultLanguage + ']', defLang).attr('checked', 'checked');\r\n\t\t$('input[value=' + elemProperties.DistanceUnit + ']', distUnit).attr('checked', 'checked');\r\n\t\t$('input[value=' + elemProperties.SquareUnit + ']', squareUnit).attr('checked', 'checked');\r\n\t\t$('input[value=' + elemProperties.coordinatesFormat + ']', coordinatesFormat).attr('checked', 'checked');\r\n\t\t$('input', maxPopupCount).val(elemProperties.maxPopupContent);\r\n\t\t$('option[value=' + (elemProperties.LayerOrder || 'Native') + ']', layerOrder).attr('selected', 'selected');\r\n\r\n\t\t$('input', defLang).change(function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.DefaultLanguage = this.value;\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t})\r\n\r\n\t\t$('input', distUnit).change(function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.DistanceUnit = this.value;\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t\tnsGmx.leafletMap.options.distanceUnit = this.value;\r\n\t\t})\r\n\r\n\t\t$('input', squareUnit).change(function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.SquareUnit = this.value;\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t\tnsGmx.leafletMap.options.squareUnit = this.value;\r\n\t\t})\r\n\r\n\t\t$('input', coordinatesFormat).change(function()\r\n\t\t{\r\n\t\t\tvar num = Number(this.value),\r\n\t\t\t\tlocationControl = nsGmx.leafletMap.gmxControlsManager.get('location');\r\n\r\n\t\t\tif (locationControl) {\r\n\t\t\t\tlocationControl.setCoordinatesFormat(num);\r\n\t\t\t}\r\n\t\t\tnsGmx.leafletMap.options.coordinatesFormat = num;\r\n\t\t\tdiv.gmxProperties.properties.coordinatesFormat = num;\r\n\t\t})\r\n\t\t$('input', maxPopupCount).change(function()\r\n\t\t{\r\n\t\t\tif (Number(this.value) > 0) {\r\n\t\t\t\tdiv.gmxProperties.properties.maxPopupContent = this.value;\r\n\t\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t\t\tnsGmx.leafletMap.options.maxPopupCount = this.value;\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t$(layerOrder).change(function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.LayerOrder = this.value;\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t})\r\n\r\n\t\tuseOSM.onclick = function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.UseOpenStreetMap = this.checked;\r\n\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t}\r\n\t\tdownloadVectors.onclick = function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.CanDownloadVectors = this.checked;\r\n\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t}\r\n\t\tdownloadRasters.onclick = function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.CanDownloadRasters = this.checked;\r\n\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t}\r\n\r\n\t\tWMSAccess.onclick = function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.WMSAccess = this.checked;\r\n\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\r\n\t\t\t$(WMSLinks).toggle(this.checked);\r\n\t\t}\r\n\r\n\t\tdefLat.onkeyup = function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.DefaultLat = (this.value === '' || isNaN(Number(this.value))) ? null : Number(this.value);\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tdefLong.onkeyup = function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.DefaultLong = (this.value === '' || isNaN(Number(this.value))) ? null : Number(this.value);\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tdefPermalink.onkeyup = function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.ViewUrl = this.value;\r\n\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tdefZoom.onkeyup = function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.DefaultZoom = (this.value === '' || isNaN(Number(this.value))) ? null : Number(this.value);\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tonLoad.onkeyup = function()\r\n\t\t{\r\n\t\t\tnsGmx.mappletLoader.set(this.value);\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tcopyright.onkeyup = function()\r\n\t\t{\r\n\t\t\tdiv.gmxProperties.properties.Copyright = this.value;\r\n\r\n\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tminViewX.onkeyup = function()\r\n\t\t{\r\n\t\t\tif (!isNaN(Number(this.value)))\r\n\t\t\t{\r\n\t\t\t\tdiv.gmxProperties.properties.MinViewX = Number(this.value);\r\n\r\n\t\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tminViewY.onkeyup = function()\r\n\t\t{\r\n\t\t\tif (!isNaN(Number(this.value)))\r\n\t\t\t{\r\n\t\t\t\tdiv.gmxProperties.properties.MinViewY = Number(this.value);\r\n\r\n\t\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tmaxViewX.onkeyup = function()\r\n\t\t{\r\n\t\t\tif (!isNaN(Number(this.value)))\r\n\t\t\t{\r\n\t\t\t\tdiv.gmxProperties.properties.MaxViewX = Number(this.value);\r\n\r\n\t\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tmaxViewY.onkeyup = function()\r\n\t\t{\r\n\t\t\tif (!isNaN(Number(this.value)))\r\n\t\t\t{\r\n\t\t\t\tdiv.gmxProperties.properties.MaxViewY = Number(this.value);\r\n\r\n\t\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tminZoom.onkeyup = function()\r\n\t\t{\r\n\t\t\tif (!isNaN(Number(this.value)))\r\n\t\t\t{\r\n\t\t\t\tdiv.gmxProperties.properties.MinZoom = Number(this.value) || null;\r\n\r\n\t\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tmaxZoom.onkeyup = function()\r\n\t\t{\r\n\t\t\tif (!isNaN(Number(this.value)))\r\n\t\t\t{\r\n\t\t\t\tdiv.gmxProperties.properties.MaxZoom = Number(this.value) || null;\r\n\r\n\t\t\t\trawTree.properties = div.gmxProperties.properties;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tWMSAccess.style.verticalAlign = \"middle\";\r\n\t\t$(WMSLinks).toggle(elemProperties.WMSAccess);\r\n\r\n\t\tvar shownCommonProperties = [\r\n\t\t\t\t\t\t\t\t\t\t{name: _gtxt(\"Имя\"), field: 'title', elem: title},\r\n\t\t\t\t\t\t\t\t\t\t{name: _gtxt(\"ID\"), field: 'name'},\r\n\t\t\t\t\t\t\t\t\t\t{name: _gtxt(\"Копирайт\"), field: 'Copyright', elem: copyright}\r\n\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t.concat(\r\n\t\t\t\t\t\t\t\t\t\t[{name: _gtxt(\"Использовать KosmosnimkiAPI\"), elem: useAPI},\r\n\t\t\t\t\t\t\t\t\t\t{name: _gtxt(\"Язык по умолчанию\"), elem: defLang},\r\n\t\t\t\t\t\t\t\t\t\t{name: _gtxt(\"Единицы длины\"), elem: distUnit},\r\n\t\t\t\t\t\t\t\t\t\t{name: _gtxt(\"Единицы площади\"), elem: squareUnit},\r\n\t\t\t\t\t\t\t\t\t\t{name: _gtxt(\"Формат координат\"), elem: coordinatesFormat},\r\n\t\t\t\t\t\t\t\t\t\t{name: _gtxt(\"Количество информационных окошек\"), elem: maxPopupCount},\r\n\t\t\t\t\t\t\t\t\t\t{name: _gtxt(\"layerOrder.title\"), elem: layerOrder},\r\n\t\t\t\t\t\t\t\t\t\t{name: _gtxt(\"Ссылка (permalink)\"), elem: defPermalink}]\r\n\t\t\t\t\t\t\t\t\t),\r\n\t\t\tshownPolicyProperties = [\r\n\t\t\t\t\t\t\t\t\t\t{name: _gtxt(\"Разрешить скачивание\"), elem: _table([_tbody([_tr([_td([_t(_gtxt('Векторных слоев'))],[['css','width','100px'],['css','height','20px'],['css','paddingLeft','3px']]), _td([downloadVectors])]),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t_tr([_td([_t(_gtxt('Растровых слоев'))],[['css','width','100px'],['css','height','20px'],['css','paddingLeft','3px']]), _td([downloadRasters])])])])},\r\n\t\t\t\t\t\t\t\t\t\t{name: _gtxt(\"WMS доступ\"), elem: _div([WMSAccess/*, WMSLinks*/])}\r\n\t\t\t\t\t\t\t\t\t],\r\n\t\t\tshownViewProperties = [\r\n\t\t\t\t{\r\n\t\t\t\t\tname: _gtxt(\"Начальная позиция\"),\r\n\t\t\t\t\telem: _table([_tbody([_tr([\r\n\t\t\t\t\t\t\t\t\t_td([_span([_t(_gtxt('Широта'))],[['css','marginLeft','3px']]), _br(), defLat],[['css','width','70px']]),\r\n\t\t\t\t\t\t\t\t\t_td([_span([_t(_gtxt('Долгота'))],[['css','marginLeft','3px']]), _br(), defLong],[['css','width','70px']]),\r\n\t\t\t\t\t\t\t\t\t_td([_span([_t(_gtxt('Зум'))],[['css','marginLeft','3px']]), _br(), defZoom],[['css','width','68px']])\r\n\t\t\t\t\t\t\t\t])])],[['css', 'borderCollapse', 'collapse']])\r\n\t\t\t\t}, {\r\n\t\t\t\t\tname: _gtxt(\"Зум\"),\r\n\t\t\t\t\telem: _table([_tbody([_tr([\r\n\t\t\t\t\t\t\t\t\t_td([_span([_t(_gtxt('Мин'))],[['css','marginLeft','3px']]), _br(), minZoom],[['css','width','70px']]),\r\n\t\t\t\t\t\t\t\t\t_td([_span([_t(_gtxt('Макс'))],[['css','marginLeft','3px']]), _br(), maxZoom],[['css','width','70px'], ['css','rowspan','2']])\r\n\t\t\t\t\t\t\t\t])])],[['css', 'borderCollapse', 'collapse']])\r\n\t\t\t\t}, {\r\n\t\t\t\t\tname: _gtxt(\"Граница обрезки\"),\r\n\t\t\t\t\telem:_table([_tbody([\r\n\t\t\t\t\t\t\t\t_tr([\r\n\t\t\t\t\t\t\t\t\t_td([_span(null, [['css','marginLeft','3px']]), _br()],[['css','width','73px']]),\r\n\t\t\t\t\t\t\t\t\t_td([_span([_t(_gtxt('Широта'))],[['css','marginLeft','3px']])],[['css','width','70px']]),\r\n\t\t\t\t\t\t\t\t\t_td([_span([_t(_gtxt('Долгота'))],[['css','marginLeft','3px']])],[['css','width','68px']])]),\r\n\t\t\t\t\t\t\t\t_tr([\r\n\t\t\t\t\t\t\t\t\t_td([_span([_t(_gtxt('Мин'))],[['css','marginLeft','3px']])]),\r\n\t\t\t\t\t\t\t\t\t_td([minViewY]),\r\n\t\t\t\t\t\t\t\t\t_td([minViewX])]),\r\n\t\t\t\t\t\t\t\t_tr([\r\n\t\t\t\t\t\t\t\t\t_td([_span([_t(_gtxt('Макс'))],[['css','marginLeft','3px']])]),\r\n\t\t\t\t\t\t\t\t\t_td([maxViewY]),\r\n\t\t\t\t\t\t\t\t\t_td([maxViewX])])\r\n\t\t\t\t\t\t\t])],[['css', 'borderCollapse', 'collapse']])\r\n\t\t\t\t}];\r\n\r\n\t\tvar id = 'mapProperties' + String(Math.random()).substring(2, 12),\r\n\t\t\ttabMenu = _div([_ul([_li([_a([_t(_gtxt(\"Общие\"))],[['attr','href','#common' + id]])]),\r\n\t\t\t\t\t\t\t\t _li([_a([_t(_gtxt(\"Подложки\"))],[['attr','href','#baselayers' + id]])]),\r\n\t\t\t\t\t\t\t\t _li([_a([_t(_gtxt(\"Доступ\"))],[['attr','href','#policy' + id]])]),\r\n\t\t\t\t\t\t\t\t _li([_a([_t(_gtxt(\"Поиск\"))],[['attr','href','#search' + id]])]),\r\n\t\t\t\t\t\t\t\t _li([_a([_t(_gtxt(\"Окно карты\"))],[['attr','href','#view' + id]])]),\r\n\t\t\t\t\t\t\t\t _li([_a([_t(_gtxt(\"Загрузка\"))],[['attr','href','#onload' + id]])]),\r\n\t\t\t\t\t\t\t\t _li([_a([_t(_gtxt(\"Плагины\"))],[['attr','href','#plugins' + id]])])])]),\r\n\t\t\tdivCommon     = _div(null,[['attr','id','common' + id],['css','width','320px']]),\r\n\t\t\tdivBaseLayers = _div(null,[['attr','id','baselayers' + id],['dir','className','group-editor-tab-container'],['css','overflowY','auto']]),\r\n\t\t\tdivPolicy     = _div(null,[['attr','id','policy' + id],['css','width','320px']]),\r\n\t\t\tdivSearch     = _div(null,[['attr','id','search' + id],['dir','className','group-editor-tab-container']]),\r\n\t\t\tdivView       = _div(null,[['attr','id','view' + id],['css','width','320px']]),\r\n\t\t\tdivOnload     = _div(null,[['attr','id','onload' + id],['dir','className','group-editor-tab-container']]),\r\n\t\t\tdivPlugins    = _div(null,[['attr','id','plugins' + id],['dir','className','group-editor-tab-container']]);\r\n\r\n\t\t_(tabMenu, [divCommon, divBaseLayers, divPolicy, divSearch, divView, divOnload, divPlugins]);\r\n\r\n\t\tnew BaseLayersControl(divBaseLayers, nsGmx.leafletMap.gmxBaseLayersManager);\r\n\r\n\t\t_(divCommon, [_table([_tbody(addProperties(shownCommonProperties))],[['css','width','100%'], ['dir','className','propertiesTable']])]);\r\n\t\t_(divPolicy, [_table([_tbody(addProperties(shownPolicyProperties))],[['css','width','100%'], ['dir','className','propertiesTable']]), WMSLinks]);\r\n\t\t_(divView,   [_table([_tbody(addProperties(shownViewProperties))],  [['css','width','100%'], ['dir','className','propertiesTable']])]);\r\n\t\t_(divOnload, [onLoad]);\r\n\r\n\t\tvar pluginsEditor = nsGmx.createPluginsEditor(divPlugins, _mapHelper.mapPlugins);\r\n\r\n\t\tvar mapLayersTree = new window.layersTree({\r\n\t\t\tshowVisibilityCheckbox: false,\r\n\t\t\tallowActive: false,\r\n\t\t\tallowDblClick: false,\r\n\t\t\tshowStyle: false,\r\n\t\t\tvisibilityFunc: function(props, isVisible) {\r\n\t\t\t\tvar origTreeNode = mainLayersTree.treeModel.findElem('LayerID', props.LayerID).elem;\r\n\t\t\t\torigTreeNode.content.properties.AllowSearch = isVisible;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//формируем новое дерево - без не-векторных слоёв и пустых папок,\r\n\t\t//в котором видимость слоя отражает возможность его скачивания\r\n\t\tvar searchRawTree = mainLayersTree.treeModel.cloneRawTree(function(node) {\r\n\t\t\tif (node.type === 'layer') {\r\n\t\t\t\tvar props = node.content.properties;\r\n\t\t\t\tif (props.type !== 'Vector') {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tprops.visible = !!props.AllowSearch;\r\n\r\n\t\t\t\treturn node;\r\n\t\t\t}\r\n\r\n\t\t\tif (node.type === 'group') {\r\n\t\t\t\tvar children = node.content.children;\r\n\t\t\t\tif (!children.length) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar isVisible = false;\r\n\t\t\t\tfor (var i = 0; i < children.length; i++) {\r\n\t\t\t\t\tisVisible = isVisible || children[i].content.properties.visible;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnode.content.properties.visible = isVisible;\r\n\t\t\t\treturn node;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tvar mapLayersDOM = mapLayersTree.drawTree(searchRawTree, 2);\r\n\t\t$('<div class=\"group-editor-search-title\"/>').text(_gtxt('Выберите слои для поиска по атрибутам')).appendTo(divSearch);\r\n\t\t$(mapLayersDOM).treeview().appendTo(divSearch);\r\n\r\n\t\ttabMenu.updateFunc = function() {\r\n\t\t\tvar props = div.gmxProperties.properties;\r\n\t\t\tprops.UseKosmosnimkiAPI = useAPI.checked;\r\n\t\t\tprops.UseOpenStreetMap = useOSM.checked;\r\n\t\t\tprops.CanDownloadVectors = downloadVectors.checked;\r\n\t\t\tprops.CanDownloadRasters = downloadRasters.checked;\r\n\t\t\tprops.WMSAccess = WMSAccess.checked;\r\n\r\n\t\t\tprops.DefaultLat = (isNaN(Number(defLat.value)) || defLat.value === '') ? null : Number(defLat.value);\r\n\t\t\tprops.DefaultLong = (isNaN(Number(defLong.value)) || defLong.value === '') ? null : Number(defLong.value);\r\n\r\n\t\t\tprops.ViewUrl = defPermalink.checked;\r\n\r\n\t\t\tprops.DefaultZoom = (isNaN(Number(defZoom.value)) || defZoom.value === '') ? null : Number(defZoom.value);\r\n\r\n\t\t\tprops.onLoad = onLoad.value;\r\n\t\t\tprops.Copyright = copyright.value;\r\n\r\n\t\t\tprops.MinViewX = isNaN(Number(minViewX.value)) ? null : Number(minViewX.value);\r\n\t\t\tprops.MinViewY = isNaN(Number(minViewY.value)) ? null : Number(minViewY.value);\r\n\t\t\tprops.MaxViewX = isNaN(Number(maxViewX.value)) ? null : Number(maxViewX.value);\r\n\t\t\tprops.MaxViewY = isNaN(Number(maxViewY.value)) ? null : Number(maxViewY.value);\r\n\t\t\tprops.MaxZoom  = isNaN(Number(maxZoom.value))  ? null : (Number(maxZoom.value) || null);\r\n\t\t\tprops.MinZoom  = isNaN(Number(minZoom.value))  ? null : (Number(minZoom.value) || null);\r\n\r\n\t\t\trawTree.properties = props;\r\n\r\n\t\t\tpluginsEditor.update();\r\n\t\t}\r\n\r\n\t\ttabMenu.closeFunc = function() {\r\n\t\t\tpluginsEditor.closeParamsDialogs();\r\n\t\t}\r\n\r\n\t\treturn tabMenu;\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvar shownProperties = [\r\n\t\t\t{name: _gtxt(\"Имя\"), field: 'title', elem: title},\r\n\t\t\t{name: _gtxt(\"ID\"), field: 'GroupID'}\r\n\t\t].concat(visibilityPropertiesView);\r\n\r\n\t\treturn _div([_table([_tbody(addProperties(shownProperties))],[['css','width','100%']])],[['css','width','320px'], ['dir','className','propertiesTable']]);\r\n\t}\r\n}\r\n\r\nvar _groupEditorsHash = {};\r\n\r\n/** Создаёт диалог редактирование свойств группы. Есть проверка на создание дублирующих диалогов\r\n @param div {HTMLHNode} - элемент дерева, соответствующий редактируемой группе\r\n*/\r\nvar createGroupEditor = function(div)\r\n{\r\n\tvar elemProperties = div.gmxProperties.content.properties\r\n\r\n\tif (_groupEditorsHash[elemProperties.GroupID])\r\n\t\treturn;\r\n\r\n\tvar pos = nsGmx.Utils.getDialogPos(div, true, 140),\r\n\t\tcloseFunc = function()\r\n\t\t{\r\n\t\t\tdelete _groupEditorsHash[elemProperties.GroupID];\r\n\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\tvar canvas = createGroupEditorProperties(div, false, window._layersTree);\r\n\tshowDialog(_gtxt('Группа [value0]', elemProperties.title), canvas, 340, 230, pos.left, pos.top, null, closeFunc);\r\n\t_groupEditorsHash[elemProperties.GroupID] = true;\r\n\r\n\tcanvas.parentNode.style.width = canvas.clientWidth + 'px';\r\n}\r\n\r\nwindow._mapEditorsHash = {};\r\n\r\n/** Создаёт диалог редактирование свойств группы. Есть проверка на создание дублирующих диалогов\r\n @param div {HTMLHNode} - элемент дерева, соответствующий редактируемой карте\r\n*/\r\nvar createMapEditor = function(div, activePage)\r\n{\r\n\tvar elemProperties = div.gmxProperties.properties;\r\n\r\n\tif (window._mapEditorsHash[elemProperties.MapID])\r\n\t\treturn;\r\n\r\n\tvar pos = nsGmx.Utils.getDialogPos(div, true, 530),\r\n\t\tcloseFunc = function()\r\n\t\t{\r\n\t\t\tdelete window._mapEditorsHash[elemProperties.MapID];\r\n\t\t\tcanvas.updateFunc();\r\n\t\t\tcanvas.closeFunc();\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\tvar canvas = createGroupEditorProperties(div, true, window._layersTree);\r\n\tshowDialog(_gtxt('Карта [value0]', elemProperties.title), canvas, 450, 410, pos.left, pos.top, null, closeFunc);\r\n\twindow._mapEditorsHash[elemProperties.MapID] = {\r\n\t\tupdate: canvas.updateFunc\r\n\t};\r\n\r\n\t$(canvas).tabs({active: activePage || 0});\r\n\r\n\tcanvas.parentNode.style.width = canvas.clientWidth + 'px';\r\n}\r\n\r\nwindow.gmxCore.addModule('GroupEditor', {\r\n\taddSubGroup: addSubGroup,\r\n\tcreateGroupEditor: createGroupEditor,\r\n\tcreateMapEditor: createMapEditor\r\n})\r\n\r\n})(nsGmx.Utils._);\r\n","﻿import nsGmx from './nsGmx.js';\r\nimport { showDialog, removeDialog, showErrorMessage, _table, _tbody, _tr, _td, _t, _input, _span, _div, _title } from './utilities.js';\r\n\r\n(function(_) {\r\n/** Разнообразные вспомогательные контролы (базовые элементы GUI)\r\n    @namespace nsGmx.Controls\r\n*/\r\nnsGmx.Controls = {\r\n\r\n\t/** Создаёт контрол выбора цвета */\r\n\tcreateColorPicker: function(color, showFunc, hideFunc, changeFunc){\r\n\t\tlet colorPicker = _div(null, [['dir','className','colorSelector'], ['css','backgroundColor',nsGmx.Utils.convertColor(color)]]);\r\n\r\n\t\t$(colorPicker).ColorPicker({\r\n\t\t\tcolor: nsGmx.Utils.convertColor(color),\r\n\t\t\tonShow: showFunc,\r\n\t\t\tonHide: hideFunc,\r\n\t\t\tonChange: changeFunc\r\n\t\t});\r\n\r\n\t\t_title(colorPicker, _gtxt(\"Цвет\"));\r\n\r\n\t\treturn colorPicker;\r\n\t},\r\n\r\n\t/** Создаёт иконку по описанию стиля слоя и типа геометрии\r\n    */\r\n\tcreateGeometryIcon: function(parentStyle, type){\r\n\t\tlet icon = _div(null, [['css','display','inline-block'],['dir','className','colorIcon'],['attr','styleType','color'],/*['css','backgroundColor','#FFFFFF']*/]);\r\n\t\tif (window.newStyles) {\r\n\t\t\tif (type.indexOf('linestring') < 0) {\r\n\t\t\t\tif (parentStyle.fill && parentStyle.fill.pattern) {\r\n\t\t\t\t\tlet opaqueStyle = L.gmxUtil.fromServerStyle($.extend(true, {}, parentStyle, {fill: {opacity: 100}})),\r\n\t\t\t\t\t\tpatternData = L.gmxUtil.getPatternIcon(null, opaqueStyle);\r\n\t\t\t\t\ticon = patternData ? patternData.canvas : document.createElement('canvas');\r\n\t\t\t\t\t_(icon, [], [['dir','className','icon'],['attr','styleType','icon'],['css','width','13px'],['css','height','13px']]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet fill = _div(null, [['dir','className','fillIcon'],['css','backgroundColor', parentStyle.fillColor ? color2Hex(parentStyle.fillColor) : \"#FFFFFF\"]]),\r\n\t\t\t\t\t\tfillOpacity = (typeof parentStyle.fillOpacity !== 'undefined') ? parentStyle.fillOpacity : 1,\r\n\t\t\t\t\t\tborder = _div(null, [['dir','className','borderIcon'],['attr','styleType','color'],['css','borderColor', parentStyle.color ? color2Hex(parentStyle.color) : \"#0000FF\"]]),\r\n\t\t\t\t\t\tborderOpacity = (typeof parentStyle.opacity !== 'undefined') ? parentStyle.opacity : 1;\r\n\r\n\r\n\t\t\t\t\tfill.style.opacity = fillOpacity;\r\n\t\t\t\t\tborder.style.opacity = borderOpacity;\r\n\r\n\t\t\t\t\tif (type.indexOf('point') > -1) {\r\n\r\n\t\t\t\t\t\tborder.style.height = '5px';\r\n\t\t\t\t\t\tfill.style.height = '5px';\r\n\t\t\t\t\t\tborder.style.width = '5px';\r\n\t\t\t\t\t\tfill.style.width = '5px';\r\n\r\n\t\t\t\t\t\tborder.style.top = '3px';\r\n\t\t\t\t\t\tfill.style.top = '4px';\r\n\t\t\t\t\t\tborder.style.left = '1px';\r\n\t\t\t\t\t\tfill.style.left = '2px';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_(icon, [border, fill]);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tlet border = _div(null, [['dir','className','borderIcon'],['attr','styleType','color'],['css','borderColor', parentStyle.color ? color2Hex(parentStyle.color) : \"#0000FF\"]]),\r\n\t\t\t\t\tborderOpacity = (parentStyle.opacity !== 'undefined') ? parentStyle.opacity : 1;\r\n\r\n\t\t\t\tborder.style.opacity = borderOpacity;\r\n\r\n\t\t\t\tborder.style.width = '4px';\r\n\t\t\t\tborder.style.height = '13px';\r\n\r\n\t\t\t\tborder.style.borderTop = 'none';\r\n\t\t\t\tborder.style.borderBottom = 'none';\r\n\t\t\t\tborder.style.borderLeft = 'none';\r\n\r\n\t\t\t\t_(icon, [border]);\r\n\t\t\t}\r\n        }\r\n        else if (type.indexOf('linestring') < 0) {\r\n            if (parentStyle.fill && parentStyle.fill.pattern) {\r\n                let opaqueStyle = L.gmxUtil.fromServerStyle($.extend(true, {}, parentStyle, {fill: {opacity: 100}})),\r\n                    patternData = L.gmxUtil.getPatternIcon(null, opaqueStyle);\r\n                icon = patternData ? patternData.canvas : document.createElement('canvas');\r\n                _(icon, [], [['dir','className','icon'],['attr','styleType','icon'],['css','width','13px'],['css','height','13px']]);\r\n            }\r\n            else {\r\n                let fill = _div(null, [['dir','className','fillIcon'],['css','backgroundColor',(parentStyle.fill && typeof parentStyle.fill.color != 'undefined') ? nsGmx.Utils.convertColor(parentStyle.fill.color) : \"#FFFFFF\"]]),\r\n                    border = _div(null, [['dir','className','borderIcon'],['attr','styleType','color'],['css','borderColor',(parentStyle.outline && typeof parentStyle.outline.color != 'undefined') ? nsGmx.Utils.convertColor(parentStyle.outline.color) : \"#0000FF\"]]),\r\n                    fillOpacity = (parentStyle.fill && typeof parentStyle.fill.opacity != 'undefined') ? parentStyle.fill.opacity : 100,\r\n                    borderOpacity = (parentStyle.outline && typeof parentStyle.outline.opacity != 'undefined') ? parentStyle.outline.opacity : 100;\r\n\r\n\r\n                fill.style.opacity = fillOpacity / 100;\r\n                border.style.opacity = borderOpacity / 100;\r\n\r\n                if (type.indexOf('point') > -1) {\r\n\r\n                    border.style.height = '5px';\r\n                    fill.style.height = '5px';\r\n                    border.style.width = '5px';\r\n                    fill.style.width = '5px';\r\n\r\n                    border.style.top = '3px';\r\n                    fill.style.top = '4px';\r\n                    border.style.left = '1px';\r\n                    fill.style.left = '2px';\r\n                }\r\n\r\n                _(icon, [border, fill]);\r\n            }\r\n        }\r\n        else {\r\n            let border = _div(null, [['dir','className','borderIcon'],['attr','styleType','color'],['css','borderColor',(parentStyle.outline && typeof parentStyle.outline.color != 'undefined') ? nsGmx.Utils.convertColor(parentStyle.outline.color) : \"#0000FF\"]]),\r\n                borderOpacity = (parentStyle.outline && typeof parentStyle.outline.opacity != 'undefined') ? parentStyle.outline.opacity : 100;\r\n\r\n\r\n            border.style.opacity = borderOpacity / 100;\r\n\r\n            border.style.width = '4px';\r\n            border.style.height = '13px';\r\n\r\n            border.style.borderTop = 'none';\r\n            border.style.borderBottom = 'none';\r\n            border.style.borderLeft = 'none';\r\n\r\n            _(icon, [border]);\r\n        }\r\n\t\t\r\n\r\n\t\ticon.oncontextmenu = function() {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn icon;\r\n\r\n\t\tfunction color2Hex(color) {\r\n\t\t\tif (typeof color === 'number') {\r\n\t\t\t\treturn nsGmx.Utils.convertColor(color);\r\n\t\t\t} else if (typeof color === 'string') {\r\n\t\t\t\tif ((color.indexOf('#') === -1)) {\r\n\t\t\t\t\treturn color2Hex(Number(color));\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn color;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/** Создаёт контрол \"слайдер\".\r\n    */\r\n\tcreateSlider: function(opacity, changeFunc)\t{\r\n\t\tlet divSlider = _div(null, [['css','width','86px'],['css','height','8px'],['css','border','1px solid #cdcdcd']]);\r\n\r\n\t\t$(divSlider).slider(\r\n\t\t\t{\r\n\t\t\t\tmin:0,\r\n\t\t\t\tmax:100,\r\n\t\t\t\tstep:1,\r\n\t\t\t\tvalue: opacity,\r\n\t\t\t\tslide: function(event, ui)\r\n\t\t\t\t{\r\n\t\t\t\t\tchangeFunc(event, ui);\r\n\r\n\t\t\t\t\t_title(divSlider.firstChild, ui.value)\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\tdivSlider.firstChild.style.zIndex = 1;\r\n\r\n\t\tdivSlider.style.width = '100px';\r\n\t\tdivSlider.style.border = 'none';\r\n\t\tdivSlider.style.backgroundImage = 'url(img/slider.png)';\r\n\r\n\t\tdivSlider.firstChild.style.border = 'none';\r\n\t\tdivSlider.firstChild.style.width = '12px';\r\n\t\tdivSlider.firstChild.style.height = '14px';\r\n\t\tdivSlider.firstChild.style.marginLeft = '-6px';\r\n\r\n        divSlider.firstChild.style.top = '-3px';\r\n\r\n\t\tdivSlider.firstChild.style.background = 'transparent url(img/sliderIcon.png) no-repeat';\r\n\r\n\t\tdivSlider.firstChild.onmouseover = function()\r\n\t\t{\r\n\t\t\tdivSlider.firstChild.style.backgroundImage = 'url(img/sliderIcon_a.png)';\r\n\t\t}\r\n\t\tdivSlider.firstChild.onmouseout = function()\r\n\t\t{\r\n\t\t\tdivSlider.firstChild.style.backgroundImage = 'url(img/sliderIcon.png)';\r\n\t\t}\r\n\r\n\t\t_title(divSlider.firstChild, opacity)\r\n\t\t_title(divSlider, _gtxt(\"Прозрачность\"));\r\n\r\n\t\treturn divSlider;\r\n\t},\r\n\r\n\tcreateInput: function(value, changeFunc){\r\n\t\tlet input = _input(null, [['dir','className','inputStyle'],['css','width','30px'],['attr','value',value]]);\r\n\t\tinput.onkeyup = changeFunc;\r\n\t\treturn input;\r\n\t},\r\n\r\n    /** Создаёт диалог, позволяющий выбрать пользователю один из нарисованных на карте объектов\r\n     * @param {String} name Уникальный идентификатор диалога\r\n     * @param {function(gmxAPI.DrawingObject)} callback Ф-ция, которая вызовется при выборе пользователем одного из объектов\r\n     * @param {Object} [params] Дополнительные параметры диалога\r\n     * @param {String} [params.title] Заголовок диалога\r\n     * @param {String} [params.geomType=null] Ограничения на тип геометрии (POINT, LINESTRING, POLYGON). null - без ограничений\r\n     * @param {String} [params.errorTitle] Заголовок диалога с ошибками (например, если нет объектов)\r\n     * @param {String} [params.errorMessage] Текст диалога с ошибками (например, если нет объектов)\r\n     * @param {Number} [params.width=250] Ширина диалога в пикселях\r\n    */\r\n    chooseDrawingBorderDialog: function(name, callback, params)\r\n    {\r\n        let TYPE_CONVERT_DICT = {\r\n            Polyline: 'linestring',\r\n            MultiPolyline: 'linestring',\r\n            Rectangle: 'polygon',\r\n            Polygon: 'polygon',\r\n            MultiPolygon: 'polygon',\r\n            Point: 'point'\r\n        }\r\n        let _params = $.extend({\r\n            title:         _gtxt(\"Выбор контура\"),\r\n            geomType:      null,\r\n            errorTitle:   _gtxt(\"$$phrase$$_12\"),\r\n            errorMessage: _gtxt(\"$$phrase$$_12\"),\r\n\t\t\twidth:        250\r\n        }, params);\r\n\r\n        if ($('#drawingBorderDialog' + name).length)\r\n            return;\r\n\r\n        let drawingObjs = [];\r\n\r\n        nsGmx.leafletMap.gmxDrawing.getFeatures().forEach(function(obj)\r\n        {\r\n            if (!_params.geomType || TYPE_CONVERT_DICT[obj.getType()] === _params.geomType.toLowerCase()) {\r\n                drawingObjs.push(obj);\r\n            }\r\n        })\r\n\r\n        if (!drawingObjs.length)\r\n            showErrorMessage(_params.errorMessage, true, _params.errorTitle);\r\n        else\r\n        {\r\n            window.gmxCore.loadModule('DrawingObjects').done(function(drawing) {\r\n                let canvas = _div();\r\n                let collection = new drawing.DrawingObjectCollection(nsGmx.leafletMap);\r\n\r\n                for (let i = 0; i < drawingObjs.length; i++)\r\n                {\r\n                    collection.Add(drawingObjs[i]);\r\n                }\r\n\r\n                new drawing.DrawingObjectList(nsGmx.leafletMap, canvas, collection, {\r\n                    allowDelete: false,\r\n                    editStyle: false,\r\n                    showButtons: false,\r\n                    click: function(drawingObject) {\r\n                        callback && callback(drawingObject);\r\n                        removeDialog(jDialog);\r\n                    }\r\n                });\r\n\r\n                let jDialog = nsGmx.Utils.showDialog(\r\n                        _params.title,\r\n                        _div([canvas], [['attr','id','drawingBorderDialog' + name],['dir','className','drawingObjectsCanvas']]),\r\n                        {\r\n                            width: _params.width,\r\n                            height: 180\r\n                        }\r\n                    )\r\n            })\r\n        }\r\n    },\r\n    /**\r\n     Создаёт виджет для управления видимостью (скрытия/показа) других элементов\r\n     Сам виджет представляет из себя изменяющуюся иконку с текстом заголовка рядом с ней\r\n     @class\r\n     @param {String} title - текст заголовка\r\n     @param {DOMElement} titleElem - элемент для размещения самого виджета\r\n     @param {DOMElement|Array[]} managedElems - элементы, видимостью которых будем\r\n     @param {Bool} isCollapsed - начальное состояние виджета\r\n    */\r\n    CollapsibleWidget: function(title, titleElem, managedElems, isCollapsed)\r\n    {\r\n        //let contentTr = _tr([_td([layerTagsParent], [['dir', 'colSpan', '2']])]);\r\n        let collapseTagIcon = $('<div/>').addClass('collabsible-icon');\r\n        let _isCollapsed = !!isCollapsed;\r\n\r\n        managedElems = managedElems || [];\r\n        if (!$.isArray(managedElems))\r\n            managedElems = [managedElems];\r\n\r\n        let updateElems = function()\r\n        {\r\n            for (let iE = 0; iE < managedElems.length; iE++)\r\n            $(managedElems[iE]).toggle(!_isCollapsed);\r\n        }\r\n\r\n        let updateView = function()\r\n        {\r\n            collapseTagIcon\r\n                .toggleClass('collabsible-icon-hidden', _isCollapsed)\r\n                .toggleClass('collabsible-icon-shown', !_isCollapsed);\r\n            updateElems();\r\n        }\r\n\r\n        updateView();\r\n\r\n        $(titleElem).empty().append(\r\n            collapseTagIcon,\r\n            $('<div/>').addClass('collabsible-title').text(title)\r\n        ).click(function()\r\n        {\r\n            _isCollapsed = !_isCollapsed;\r\n            updateView();\r\n        })\r\n\r\n        this.addManagedElements = function(elems)\r\n        {\r\n            managedElems = managedElems.concat(elems);\r\n            updateElems();\r\n        }\r\n\r\n        this.isCollapsed = function() { return _isCollapsed; };\r\n    },\r\n\r\n    /** Показывает аттрибутивную информацию объекта в виде таблички в отдельном диалоге */\r\n    showLayerInfo: function(layer, obj)\r\n    {\r\n        let trs = [];\r\n        let typeSpans = {};\r\n        for (let key in obj.properties)\r\n        {\r\n            let content = _div(),\r\n                contentText = String(obj.properties[key]);\r\n\r\n            if (contentText.indexOf(\"http://\") == 0 || contentText.indexOf(\"https://\") == 0 || contentText.indexOf(\"www.\") == 0)\r\n                contentText = \"<a href=\\\"\" + contentText + \"\\\" target=\\\"_blank\\\">\" + contentText + \"</a>\";\r\n\r\n            content.innerHTML = contentText;\r\n\r\n            let typeSpan = _span([_t(key)]);\r\n\r\n            typeSpans[key] = typeSpan;\r\n\r\n            trs.push(_tr([_td([typeSpan], [['css','width','30%']]), _td([content], [['css','width','70%']])]));\r\n        }\r\n\r\n        // let title = _span(null, [['dir','className','title'], ['css','cursor','default']]),\r\n        //     summary = _span(null, [['dir','className','summary']]),\r\n        let div;\r\n\r\n        if ($('#layerPropertiesInfo').length)\r\n        {\r\n            div = $('#layerPropertiesInfo')[0];\r\n\r\n            if (!trs.length && !layer.properties.Legend)\r\n            {\r\n                $(div.parentNode).dialog('close');\r\n\r\n                return;\r\n            }\r\n\r\n            $(div).empty();\r\n\r\n            _(div, [_table([_tbody(trs)], [['dir','className','vectorInfoParams']])]);\r\n\r\n            if (layer.properties.Legend)\r\n            {\r\n                let legend = _div();\r\n\r\n                legend.innerHTML = layer.properties.Legend;\r\n\r\n                _(div, [legend])\r\n            }\r\n\r\n            let dialogTitle = div.parentNode.parentNode.firstChild.firstChild;\r\n\r\n            $(dialogTitle).empty();\r\n\r\n            _(dialogTitle, [_t(_gtxt(\"Слой [value0]\", layer.properties.title))]);\r\n\r\n            $(div.parentNode).dialog('open');\r\n        }\r\n        else\r\n        {\r\n            if (!trs.length && !layer.properties.Legend)\r\n                return;\r\n\r\n            div = _div([_table([_tbody(trs)], [['dir','className','vectorInfoParams']])], [['attr','id','layerPropertiesInfo']]);\r\n\r\n            if (layer.properties.Legend)\r\n            {\r\n                let legend = _div();\r\n\r\n                legend.innerHTML = layer.properties.Legend;\r\n\r\n                _(div, [legend])\r\n            }\r\n\r\n            showDialog(_gtxt(\"Слой [value0]\", layer.properties.title), div, 360, 'auto', false, false, null, function(){return true});\r\n\r\n        }\r\n\r\n        //подстраиваем ширину\r\n        setTimeout(function()\r\n        {\r\n            let dialogDiv = $('#layerPropertiesInfo')[0].parentNode;\r\n            let width = $(div).find('.vectorInfoParams').width();\r\n            if (width > 340) {\r\n                $(dialogDiv).dialog('option', 'width', width + 18);\r\n            }\r\n        }, 100)\r\n\r\n        nsGmx.TagMetaInfo.loadFromServer(function(tagInfo)\r\n        {\r\n            for (let key in typeSpans)\r\n            {\r\n                if (tagInfo.isTag(key))\r\n                    $(typeSpans[key]).attr('title', tagInfo.getTagDescription(key));\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\ngmxCore.addModule('Controls', nsGmx.Controls);\r\n\r\n})(nsGmx.Utils._);\r\n","﻿import nsGmx from './nsGmx.js';\r\nimport {\r\n    _div,\r\n    _input,\r\n    _li,\r\n    _span,\r\n    _table,\r\n    _tbody,\r\n    _tr,\r\n    _td,    \r\n    _t,\r\n} from './utilities.js';\r\n\r\n(function()\r\n{\r\n    var getZoomValue = function(zoomControl)\r\n    {\r\n        var isNotValid = zoomControl.value == '' ||\r\n                    isNaN(Number(zoomControl.value)) ||\r\n                    Number(zoomControl.value) != Math.floor(Number(zoomControl.value)) ||\r\n                    Number(zoomControl.value) < 1;\r\n\r\n        if (isNotValid)\r\n        {\r\n            $(zoomControl).addClass(\"error\");\r\n            return null;\r\n        }\r\n        else\r\n        {\r\n            $(zoomControl).removeClass(\"error\");\r\n            return Number(zoomControl.value);\r\n        }\r\n    }\r\n\r\n    var checkZoom = function(minZoomInput, maxZoomInput)\r\n    {\r\n        var minVal = getZoomValue(minZoomInput);\r\n        var maxVal = getZoomValue(maxZoomInput);\r\n\r\n        if (minVal && maxVal && minVal > maxVal)\r\n        {\r\n            $(minZoomInput).addClass(\"error\");\r\n            $(maxZoomInput).addClass(\"error\");\r\n            return false;\r\n        }\r\n\r\n        return !!(minVal && maxVal);\r\n    }\r\n\r\n    /**\r\n     Контрол для задания максимального и минимального зумов слоя/стиля.\r\n     Выдаёт два 'li' элемента, которые клиент сам помещает куда-нибудь.\r\n     Генерит событие \"change\", когда изменились валидные значения зумов\r\n     @memberOf nsGmx\r\n     @class\r\n     @param minZoom {int} Начальный минимальный зум\r\n     @param maxZoom {int} Начальный максимальный зум\r\n    */\r\n    var ZoomPropertiesControl = function(minZoom, maxZoom)\r\n    {\r\n        var _this = this;\r\n        var minZoomInput = _input(null, [['dir','className','inputStyle'],['attr','paramName','MinZoom'],['css','width','30px'],['attr','value', minZoom || 1]]);\r\n        var maxZoomInput = _input(null, [['dir','className','inputStyle'],['attr','paramName','MaxZoom'],['css','width','30px'],['attr','value', maxZoom || 17]]);\r\n        checkZoom(minZoomInput, maxZoomInput);\r\n\r\n        var liMinZoom = _li([_div([_table([_tbody([_tr([_td([_span([_t(_gtxt(\"Мин. зум\"))],[['css','fontSize','12px']])],[['css','width','60px']]),_td([minZoomInput])])])])])]);\r\n\t\tvar liMaxZoom = _li([_div([_table([_tbody([_tr([_td([_span([_t(_gtxt(\"Макс. зум\"))],[['css','fontSize','12px']])],[['css','width','60px']]),_td([maxZoomInput])])])])])]);\r\n\r\n        minZoomInput.onkeyup = maxZoomInput.onkeyup = function()\r\n        {\r\n            if (checkZoom(minZoomInput, maxZoomInput))\r\n                $(_this).change();\r\n\r\n            return true;\r\n        }\r\n\r\n        this.getMinLi = function() { return liMinZoom; };\r\n\r\n        this.getMaxLi = function() { return liMaxZoom; };\r\n\r\n        /** Получить минимальный зум\r\n        */\r\n        this.getMinZoom = function() { return Number(minZoomInput.value) };\r\n\r\n        /** Получить максимальный зум\r\n        */\r\n        this.getMaxZoom = function() { return Number(maxZoomInput.value) };\r\n    }\r\n\r\n    nsGmx.ZoomPropertiesControl = ZoomPropertiesControl;\r\n})();\r\n","tinyMCE.init({\r\n\tmode : \"none\",\r\n\ttheme : \"advanced\",\r\n\tplugins: 'fullscreen',\r\n\tlanguage: 'ru',\r\n\tconvert_urls: false,\r\n\ttheme_advanced_buttons1: 'bold,italic,underline,|,justifyleft,justifycenter,justifyright,|,link,unlink,fullscreen,code',\r\n\ttheme_advanced_buttons2: '',\r\n\ttheme_advanced_buttons3: '',\r\n\ttheme_advanced_statusbar_location: 'none',\r\n\ttheme_advanced_toolbar_location: 'bottom',\r\n\ttheme_advanced_toolbar_align: 'center'\r\n});\r\n\r\nexport default tinyMCE;","﻿import nsGmx from './nsGmx.js';\r\nimport './ZoomPropertiesControl.js';\r\nimport {\r\n\t_checkbox,\r\n\t_div,\r\n\tgetOwnChildNumber,\r\n\thide,\r\n\t_img,\r\n\t_input,\r\n\tmakeLinkButton,\r\n\tmakeImageButton,\r\n\t_li,\r\n\tshowDialog,\r\n\t_span,\r\n\tstopEvent,\r\n\t_table,\r\n\t_tbody,\r\n\t_tr,\r\n\t_td,\r\n\t_t,\r\n\t_title,\r\n\t_textarea,\r\n\t_ul,\r\n} from './utilities.js';\r\nimport tinyMCE from './TinyMCEInit.js';\r\n\r\n//Создание интерфейса редактирования стилей слоя\r\n(function(_) {\r\n\r\n//явно прописывает все свойства балунов в стиле.\r\nvar applyBalloonDefaultStyle = function(style)\r\n{\r\n\t//слой только что создали - всё по умолчанию!\r\n\tif (typeof style.BalloonEnable === 'undefined')\r\n\t{\r\n\t\tstyle.BalloonEnable = true;\r\n\t\tstyle.DisableBalloonOnClick = false;\r\n\t\tstyle.DisableBalloonOnMouseMove = true;\r\n\t}\r\n\telse\r\n\t{\r\n\t\t//поддержка совместимости - если слой уже был, но новых параметров нет\r\n\t\tif (typeof style.DisableBalloonOnClick === 'undefined')\r\n\t\t\tstyle.DisableBalloonOnClick = false;\r\n\r\n\t\tif (typeof style.DisableBalloonOnMouseMove === 'undefined')\r\n\t\t\tstyle.DisableBalloonOnMouseMove = false;\r\n\t}\r\n\treturn style;\r\n}\r\n\r\nvar FillStyleControl = function(initStyle, params)\r\n{\r\n\tvar _params = $.extend({showSelectors: true}, params);\r\n\tvar _fillStyle = $.extend(true, {fill:\r\n\t\t{color: 0xFFFFFF,\r\n\t\t opacity: 50,\r\n\t\t image: \"\",\r\n\t\t pattern: {\r\n\t\t\twidth: 8,\r\n\t\t\tstep: 0,\r\n\t\t\tcolors: [0x000000,0xFFFFFF],\r\n\t\t\tstyle: 'diagonal1'\r\n\t\t}}}, initStyle).fill;\r\n\r\n\tvar _this = this;\r\n\tvar selectorDiv = $(\"<div/>\", {'class': \"fillStyleSelectorDiv\"});\r\n\r\n\tvar colorContainer = $(\"<div/>\");\r\n\tvar patternContainer = $(\"<div/>\");\r\n\tvar imagePatternContainer = $(\"<div/>\");\r\n\r\n\tvar colorIcon      = $(\"<img/>\", {src: 'img/styles/color.png',   title: _gtxt(\"Заливка цветом\")}).data('type', 'color');\r\n\tvar patternIcon    = $(\"<img/>\", {src: 'img/styles/pattern.png', title: _gtxt(\"Заливка штриховкой\")}).data('type', 'pattern');\r\n\tvar patternURLIcon = $(\"<img/>\", {src: 'img/styles/globe.gif',   title: _gtxt(\"Заливка рисунком\")}).data('type', 'bitmapPattern');\r\n\r\n\tvar controls = {\r\n\t\t\"color\":         {icon: colorIcon,      control: colorContainer},\r\n\t\t\"pattern\":       {icon: patternIcon,    control: patternContainer},\r\n\t\t\"bitmapPattern\": {icon: patternURLIcon, control: imagePatternContainer}\r\n\t};\r\n\r\n\tvar initFillStyle = initStyle.fill || {};\r\n\r\n\tvar activeFillType = null;\r\n\tif ('image' in initFillStyle)\r\n\t\tactiveFillType = 'bitmapPattern';\r\n\telse if ('pattern' in initFillStyle)\r\n\t\tactiveFillType = 'pattern';\r\n\telse //if ('color' in initFillStyle)\r\n\t\tactiveFillType = 'color';\r\n\r\n\tfor (var c in controls)\r\n\t\tif (c == activeFillType)\r\n\t\t\tcontrols[c].icon.addClass('selectedType');\r\n\t\telse\r\n\t\t\tcontrols[c].control.hide();\r\n\r\n\tvar selectorIconsDiv = $('<div/>')\r\n\t\t.append(colorIcon)\r\n\t\t.append(patternIcon)\r\n\t\t.append(patternURLIcon);\r\n\r\n\tselectorDiv.append($(\"<span/>\").text(_gtxt(\"Заливка\"))).append($(\"<br/>\"));\r\n\r\n\tif (_params.showSelectors)\r\n\t\tselectorDiv.append(selectorIconsDiv);\r\n\r\n\t$(\"img\", selectorDiv).click(function()\r\n\t{\r\n\t\tactiveFillType = $(this).data('type');\r\n\t\tfor (var k in controls)\r\n\t\t\tif (k === activeFillType)\r\n\t\t\t\t$(controls[k].control).show(500);\r\n\t\t\telse\r\n\t\t\t\t$(controls[k].control).hide(500);\r\n\r\n\t\t$(\"img\", selectorDiv).removeClass('selectedType');\r\n\t\t$(this).addClass('selectedType');\r\n\t\t$(_this).change();\r\n\t});\r\n\r\n\tvar fillColor = _fillStyle.color;\r\n\tvar fillOpacity = _fillStyle.opacity;\r\n\r\n\t//выбор цвета\r\n\tvar fillColorPicker = nsGmx.Controls.createColorPicker(fillColor,\r\n\t\tfunction (colpkr){\r\n\t\t\t$(colpkr).fadeIn(500);\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tfunction (colpkr){\r\n\t\t\t$(colpkr).fadeOut(500);\r\n\t\t\t$(_this).change();\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tfunction (hsb, hex) {\r\n\t\t\tfillColorPicker.style.backgroundColor = '#' + hex;\r\n\t\t\tfillColor = parseInt(\"0x\" + hex);\r\n\t\t\t$(_this).change();\r\n\t\t}),\r\n\tfillOpacitySlider = nsGmx.Controls.createSlider(fillOpacity,\r\n\t\tfunction(event, ui)\r\n\t\t{\r\n\t\t\tfillOpacity = ui.value;\r\n\t\t\t$(_this).change();\r\n\t\t});\r\n\r\n\tcolorContainer.append($(\"<table/>\").append($(\"<tr/>\")\r\n\t\t.append($(\"<td/>\").append(fillColorPicker))\r\n\t\t.append($(\"<td/>\", {'class': 'fillColorOpacity'}).append(fillOpacitySlider))\r\n\t));\r\n\r\n\tvar patternURL = new window.mapHelper.ImageInputControl(_fillStyle.image);\r\n\t$(patternURL).change(function()\r\n\t{\r\n\t\t$(_this).change();\r\n\t});\r\n\timagePatternContainer.append(patternURL.getControl());\r\n\r\n\t//выбор втроенных паттернов\r\n\tvar patternTypeIcons = [\r\n\t\t['horizontal', 'img/styles/horisontal.png'],\r\n\t\t['vertical',   'img/styles/vertical.png'  ],\r\n\t\t['diagonal1',  'img/styles/diagonal1.png' ],\r\n\t\t['diagonal2',  'img/styles/diagonal2.png' ],\r\n\t\t['circle',     'img/styles/circle.png'    ],\r\n\t\t['cross',      'img/styles/cross.png'     ]\r\n\t];\r\n\r\n\tvar patternStyleSelector = $(\"<div/>\", {id: \"patternStyleSelector\"});\r\n\tfor (var i = 0; i < patternTypeIcons.length; i++)\r\n\t{\r\n\t\tvar icon = $('<img/>', {src: patternTypeIcons[i][1]}).data(\"style\", patternTypeIcons[i][0]);\r\n\t\tpatternStyleSelector.append(icon);\r\n\t\tif (patternTypeIcons[i][0] === _fillStyle.pattern.style)\r\n\t\t\ticon.addClass('activePatternType');\r\n\t}\r\n\r\n\t$(\"img\", patternStyleSelector).click(function()\r\n\t{\r\n\t\t$(\"img\", patternStyleSelector).removeClass('activePatternType');\r\n\t\t$(this).addClass('activePatternType');\r\n\t\t_fillStyle.pattern.style = $(this).data(\"style\");\r\n\t\t$(_this).change();\r\n\t});\r\n\r\n\tvar patternOpacity = _fillStyle.opacity;\r\n\tvar patternOpacitySlider = nsGmx.Controls.createSlider( _fillStyle.opacity, function(event, ui)\r\n\t{\r\n\t\tpatternOpacity = ui.value;\r\n\t\t$(_this).change();\r\n\t});\r\n\t$(patternOpacitySlider).attr({id: \"patternOpacitySlider\"});\r\n\r\n\tvar patternOpacityContainer = $('<div/>', {'class': 'patternOpacityContainer'})\r\n\t\t.append($('<table/>').append($('<tr/>')\r\n\t\t\t.append($('<td/>').append($('<img/>', {src:'img/styles/pattern-opacity.PNG', 'class': 'opacityIcon'})))\r\n\t\t\t.append($('<td/>').append(patternOpacitySlider))\r\n\t\t));\r\n\r\n\tvar widthIcon = $(\"<img/>\", {src: 'img/styles/pattern-width.PNG'});\r\n\tvar stepIcon = $(\"<img/>\", {src: 'img/styles/pattern-step.PNG', 'class': 'stepIcon'});\r\n\r\n\tvar widthInput = $(\"<input/>\", {'class': 'widthInput', title: _gtxt(\"Ширина паттерна\")}).val(_fillStyle.pattern.width).change(function()\r\n\t{\r\n\t\t$(_this).change();\r\n\t});\r\n\r\n\tvar stepInput = $(\"<input/>\", {title: _gtxt(\"Ширина отступа\")}).val(_fillStyle.pattern.step).change(function()\r\n\t{\r\n\t\t$(_this).change();\r\n\t});\r\n\r\n\tvar widthStepInputs = $(\"<table/>\", {'class': \"widthStepTable\"}).append($(\"<tr/>\")\r\n\t\t.append($(\"<td/>\").append(widthIcon).append(widthInput))\r\n\t\t.append($(\"<td/>\").append(stepIcon).append(stepInput))\r\n\t);\r\n\r\n\tvar PatternColorControl = function(parentDiv, initColors)\r\n\t{\r\n\t\tvar _parentDiv = $(parentDiv);\r\n\t\tvar _colors = initColors;\r\n\t\tvar _this = this;\r\n\t\tvar _redraw = function()\r\n\t\t{\r\n\t\t\t_parentDiv.empty();\r\n\t\t\tvar table = $('<table/>', {'class': 'patternColorControl'});\r\n\t\t\tfor (var k = 0; k < _colors.length; k++)\r\n\t\t\t(function(k){\r\n\r\n\t\t\t\tif (_colors[k] === null) return;\r\n\r\n\t\t\t\tvar colorPicker = nsGmx.Controls.createColorPicker(_colors[k],\r\n\t\t\t\t\tfunction (colpkr){\r\n\t\t\t\t\t\t$(colpkr).fadeIn(500);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfunction (colpkr){\r\n\t\t\t\t\t\t$(colpkr).fadeOut(500);\r\n\t\t\t\t\t\t$(_this).change();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfunction (hsb, hex) {\r\n\t\t\t\t\t\tcolorPicker.style.backgroundColor = '#' + hex;\r\n\t\t\t\t\t\t_colors[k] = parseInt('0x' + hex);\r\n\t\t\t\t\t\t$(_this).change();\r\n\t\t\t\t\t});\r\n\t\t\t\tcolorPicker.style.width = '100%';\r\n\r\n\t\t\t\tvar deleteIcon = makeImageButton('img/close.png', 'img/close_orange.png');\r\n\t\t\t\t\tdeleteIcon.onclick = function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_colors[k] = null;\r\n\t\t\t\t\t\t_redraw();\r\n\t\t\t\t\t\t$(_this).change();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\ttable.append($(\"<tr/>\")\r\n\t\t\t\t\t.append($(\"<td/>\", {'class': 'patternColorPicker'}).append(colorPicker))\r\n\t\t\t\t\t.append($(\"<td/>\", {'class': 'patternColorDelete'}).append(deleteIcon))\r\n\t\t\t\t);\r\n\r\n\t\t\t})(k);\r\n\r\n\t\t\tvar addIcon = makeImageButton('img/zoom_plus.png', 'img/zoom_plus_a.png');\r\n\t\t\taddIcon.onclick = function()\r\n\t\t\t{\r\n\t\t\t\tvar initColor = 0x00FF00;\r\n\t\t\t\tfor (var c = 0; c < _colors.length; c++)\r\n\t\t\t\t\tif (_colors[c] !== null)\r\n\t\t\t\t\t\tinitColor = _colors[c];\r\n\r\n\t\t\t\t_colors.push(initColor);\r\n\t\t\t\t_redraw();\r\n\t\t\t\t$(_this).change();\r\n\t\t\t};\r\n\r\n\t\t\ttable.append($(\"<tr/>\")\r\n\t\t\t\t.append($(\"<td/>\", {'class': 'patternColorPicker'}))\r\n\t\t\t\t.append($(\"<td/>\").append(addIcon))\r\n\t\t\t);\r\n\r\n\t\t\t_parentDiv.append(table);\r\n\t\t}\r\n\r\n\t\t_redraw();\r\n\r\n\t\tthis.getColors = function()\r\n\t\t{\r\n\t\t\tvar res = [];\r\n\t\t\tfor (var c = 0; c < _colors.length; c++)\r\n\t\t\t\tif (_colors[c] !== null )\r\n\t\t\t\t\tres.push(_colors[c]);\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\r\n\tvar patternColorSelector = $(\"<div/>\");\r\n\tvar patternColorControl = new PatternColorControl(patternColorSelector, _fillStyle.pattern.colors);\r\n\t$(patternColorControl).change(function()\r\n\t{\r\n\t\t$(_this).change();\r\n\t});\r\n\r\n\tpatternContainer.append(patternStyleSelector).append(patternOpacityContainer).append(widthStepInputs).append(patternColorSelector);\r\n\r\n\tvar fillControlsDiv = $(\"<div/>\", {'class': 'fillStyleControls'}).append(colorContainer).append(imagePatternContainer).append(patternContainer);\r\n\r\n\t//public interface\r\n\tthis.getSelector = function()\r\n\t{\r\n\t\treturn selectorDiv;\r\n\t}\r\n\r\n\tthis.getControls = function()\r\n\t{\r\n\t\treturn fillControlsDiv;\r\n\t}\r\n\r\n\tthis.getFillStyle = function()\r\n\t{\r\n\t\tvar fillStyle = {};\r\n\t\tif (activeFillType === 'color')\r\n\t\t{\r\n\t\t\tfillStyle.color = fillColor;\r\n\t\t\tfillStyle.opacity = fillOpacity;\r\n\t\t}\r\n\t\telse if (activeFillType === 'bitmapPattern')\r\n\t\t{\r\n\t\t\tfillStyle.image = patternURL.value();\r\n\t\t}\r\n\t\telse if (activeFillType === 'pattern')\r\n\t\t{\r\n\t\t\tfillStyle.pattern = {\r\n\t\t\t\tstyle: _fillStyle.pattern.style,\r\n\t\t\t\twidth: parseInt(widthInput.val()),\r\n\t\t\t\tstep: parseInt(stepInput.val()),\r\n\t\t\t\tcolors: patternColorControl.getColors()\r\n\t\t\t};\r\n\t\t\tfillStyle.opacity = patternOpacity;\r\n\t\t}\r\n\r\n\t\treturn fillStyle;\r\n\t}\r\n\r\n\tthis.setVisibleSelectors = function(isVisible)\r\n\t{\r\n\t\tif (isVisible)\r\n\t\t\tselectorIconsDiv.show();\r\n\t\telse\r\n\t\t\tselectorIconsDiv.hide();\r\n\t}\r\n}\r\n\r\nvar createFilterEditorInner = function(filter, attrs, elemCanvas)\r\n{\r\n\tvar filterText = _textarea(null, [['dir','className','inputStyle'],['css','overflow','auto'],['css','width','250px'],['css','height','50px']]),\r\n\t\tsetFilter = function()\r\n\t\t{\r\n\t\t\tvar filterNum = getOwnChildNumber(filterText.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode),\r\n\t\t\t\tlayer = nsGmx.gmxMap.layersByID[elemCanvas.parentNode.gmxProperties.content.properties.name],\r\n\t\t\t\tfilter = layer.getStyle(filterNum);\r\n\r\n\t\t\tvar newStyle = $.extend(true, {}, filter);\r\n\r\n\t\t\tnewStyle.Filter = filterText.value;\r\n\t\t\tlayer.setStyle(newStyle, filterNum);\r\n\t\t}\r\n\r\n\tfilterText.value = filter;\r\n\r\n\tfilterText.onkeyup = function()\r\n\t{\r\n\t\tsetFilter();\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tvar mapName = elemCanvas.parentNode.gmxProperties.content.properties.mapName,\r\n\t\tlayerName = elemCanvas.parentNode.gmxProperties.content.properties.name,\r\n\t\tattrSuggestWidget = new nsGmx.AttrSuggestWidget([filterText], attrs || [], _mapHelper.attrValues[mapName][layerName], setFilter, ['attrs', 'operators']);\r\n\r\n\tvar suggestCanvas = attrSuggestWidget.el[0];\r\n\r\n\tvar div = _div([filterText, suggestCanvas],[['attr','filterTable',true]]);\r\n\r\n\tdiv.getFilter = function()\r\n\t{\r\n\t\treturn filterText.value;\r\n\t};\r\n\tdiv.setFilter = function()\r\n\t{\r\n\t\tsetFilter();\r\n\t};\r\n\r\n\treturn div;\r\n}\r\n\r\nvar createFilterEditor = function(filterParam, attrs, elemCanvas)\r\n{\r\n\tvar filter = (typeof filterParam == 'undefined') ? '' : filterParam,\r\n\t\tprops = elemCanvas.parentNode.gmxProperties.content.properties,\r\n\t\tmapName = props.mapName;\r\n\r\n\t_mapHelper.attrValues[mapName] = _mapHelper.attrValues[mapName] || {};\r\n\r\n\tif (!_mapHelper.attrValues[mapName][props.name])\r\n\t{\r\n\t\tvar div = _div([_t(_gtxt(\"Авторизуйтесь для редактирования фильтров\"))],[['css','padding','5px 0px 5px 5px'],['css','color','red']]);\r\n\r\n\t\tdiv.getFilter = function()\r\n\t\t{\r\n\t\t\treturn filter;\r\n\t\t};\r\n\t\tdiv.setFilter = function(){};\r\n\r\n\t\tdiv.setAttribute('filterTable', true);\r\n\r\n\t\treturn div;\r\n\t}\r\n\telse\r\n\t\treturn createFilterEditorInner(filter, attrs, elemCanvas);\r\n}\r\n\r\nvar _balloonEditorId = 0;\r\n\r\n//identityField - будем исключать из списка аттрибутов, показываемых в балуне, так как это внутренняя техническая информация\r\nvar createBalloonEditor = function(balloonParams, attrs, elemCanvas, identityField)\r\n{\r\n\tapplyBalloonDefaultStyle(balloonParams);\r\n\r\n\tvar layerName = elemCanvas.parentNode.gmxProperties.content.properties.name,\r\n\t\ttextareaID = 'ballooneditor' + layerName + (_balloonEditorId++),\r\n\t\tballoonText = _textarea(null, [\r\n\t\t\t['dir','className','inputStyle balloonEditor'],\r\n\t\t\t['css','overflow','auto'],\r\n\t\t\t['css','width','251px'],\r\n\t\t\t['css','height','80px'],\r\n\t\t\t['dir','id', textareaID]\r\n\t\t]),\r\n\t\tsetBalloon = function()\r\n\t\t{\r\n\t\t\tvar filterNum = getOwnChildNumber(balloonText.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode),\r\n\t\t\t\tlayer = nsGmx.gmxMap.layersByID[layerName],\r\n\t\t\t\tstyle = layer.getStyle(filterNum);\r\n\r\n\t\t\tvar newStyle = $.extend(true, {}, style, div.getBalloonState());\r\n\t\t\tlayer.setStyle(newStyle, filterNum);\r\n\t\t},\r\n\t\tdefaultBalloonText = function()\r\n\t\t{\r\n\t\t\tvar sortAttrs = attrs.slice(0),\r\n\t\t\t\ttext = \"\";\r\n\r\n\t\t\tfor (var i = 0; i < sortAttrs.length; ++i)\r\n\t\t\t{\r\n\t\t\t\tvar key = sortAttrs[i];\r\n\r\n\t\t\t\tif (key !== identityField)\r\n\t\t\t\t\ttext += \"<b>\" + key + \":</b> [\" + key + \"]<br />\" + br;\r\n\t\t\t}\r\n\r\n\t\t\ttext += \"<br />\" + br + \"[SUMMARY]\";\r\n\r\n\t\t\treturn text;\r\n\t\t},\r\n\t\tboxClick = _checkbox(!balloonParams.DisableBalloonOnClick && balloonParams.BalloonEnable, 'checkbox'),\r\n\t\tboxMove = _checkbox(!balloonParams.DisableBalloonOnMouseMove && balloonParams.BalloonEnable, 'checkbox'),\r\n\t\tbr = \"\\n\";\r\n\r\n\ttinyMCE.onAddEditor.add(function(mgr,ed) {\r\n\t\tif (ed.id === textareaID) {\r\n\t\t\ted.onKeyUp.add(setBalloon);\r\n\t\t\ted.onChange.add(setBalloon);\r\n\t\t\ted.onClick.add(function() {\r\n\t\t\t\t$(suggestWidget.el).fadeOut(300);\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t});\r\n\r\n\t// gmxCore.loadModule('TinyMCELoader', window.location.protocol + '//' + window.location.host + window.location.pathname.replace('index.html', '') + 'TinyMCELoader.js', function() {\r\n\t// \ttinyMCE.onAddEditor.add(function(mgr,ed) {\r\n\t// \t\tif (ed.id === textareaID) {\r\n\t// \t\t\ted.onKeyUp.add(setBalloon);\r\n\t// \t\t\ted.onChange.add(setBalloon);\r\n\t// \t\t\ted.onClick.add(function() {\r\n\t// \t\t\t\t$(suggestWidget.el).fadeOut(300);\r\n\t// \t\t\t});\r\n\r\n\t// \t\t}\r\n\t// \t});\r\n\t// })\r\n\r\n\tboxClick.className = 'box';\r\n\r\n\tboxClick.onclick = function()\r\n\t{\r\n\t\tsetBalloon();\r\n\t}\r\n\r\n\tboxMove.className = 'box';\r\n\r\n\tboxMove.onclick = function()\r\n\t{\r\n\t\tsetBalloon();\r\n\t}\r\n\r\n\tballoonText.value = (balloonParams.Balloon) ? balloonParams.Balloon : defaultBalloonText();\r\n\r\n\tvar suggestWidget = new nsGmx.SuggestWidget(attrs ? attrs : [], [balloonText], '[suggest]', setBalloon);\r\n\r\n\tvar divAttr = _div([_t(_gtxt(\"Атрибут >\")), suggestWidget.el], [['dir','className','suggest-link-container']]);\r\n\r\n\tdivAttr.onclick = function()\r\n\t{\r\n\t\tif (suggestWidget.el.style.display == 'none')\r\n\t\t\t$(suggestWidget.el).fadeIn(300);\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tvar setDefaultBalloonText = nsGmx.Utils.makeLinkButton(_gtxt('По умолчанию'));\r\n\r\n\tsetDefaultBalloonText.onclick = function() {\r\n\t\twindow.tinyMCE.get(textareaID).setContent(defaultBalloonText());\r\n\t\tsetBalloon();\r\n\t};\r\n\r\n\tvar suggestCanvas = _table([_tbody([\r\n\t\t_tr([_td([_div([divAttr],[['css','position','relative']])]),\r\n\t\t\t _td([_div([setDefaultBalloonText],[['css','float','right']])])\r\n\t\t ])])],[['css','margin','0px 3px'], ['css','width','249px']]);\r\n\r\n\tvar div = _div([_div([boxClick, _span([_t(_gtxt(\"Показывать при клике\"))],[['css','marginLeft','5px']])],[['css','margin','2px 0px 4px 3px']]),\r\n\t\t\t\t\t_div([boxMove, _span([_t(_gtxt(\"Показывать при наведении\"))],[['css','marginLeft','5px']])],[['css','margin','2px 0px 4px 3px']]),\r\n\t                balloonText, suggestCanvas],[['attr','balloonTable',true]]);\r\n\r\n\tdiv.getBalloon = function()\r\n\t{\r\n\t\tvar value = window.tinyMCE && window.tinyMCE.get(textareaID) ? window.tinyMCE.get(textareaID).getContent() : balloonText.value;\r\n\t\treturn value == defaultBalloonText() ? '' : value;\r\n\t};\r\n\r\n\tdiv.getBalloonEnable = function()\r\n\t{\r\n\t\treturn boxClick.checked || boxMove.checked;\r\n\t};\r\n\r\n\tdiv.getBalloonDisableOnClick = function()\r\n\t{\r\n\t\treturn boxClick.checked;\r\n\t};\r\n\r\n\tdiv.getDisableBalloonOnMouseMove = function()\r\n\t{\r\n\t\treturn boxMove.checked;\r\n\t};\r\n\r\n\tdiv.getBalloonState = function()\r\n\t{\r\n\t\tvar state = {\r\n\t\t\tBalloonEnable: boxClick.checked || boxMove.checked,\r\n\t\t\tDisableBalloonOnClick: !boxClick.checked,\r\n\t\t\tDisableBalloonOnMouseMove: !boxMove.checked\r\n\t\t}\r\n\r\n\t\tvar value = window.tinyMCE && window.tinyMCE.get(textareaID) ? window.tinyMCE.get(textareaID).getContent() : balloonText.value;\r\n\t\tif (value !== defaultBalloonText())\r\n\t\t\tstate.Balloon = value;\r\n\r\n\t\treturn state;\r\n\t}\r\n\r\n\treturn div;\r\n}\r\n\r\nvar _labelEditorId = 0;\r\n\r\nvar createFilter = function(layer, styleIndex, parentStyle, geometryType, attrs, elemCanvas, ulParent, treeviewFlag)\r\n{\r\n\tvar templateStyle = {};\r\n\r\n\t$.extend(true, templateStyle, _mapHelper.makeStyle(parentStyle));\r\n\r\n\tvar zoomPropertiesControl = new nsGmx.ZoomPropertiesControl(parentStyle.MinZoom, parentStyle.MaxZoom);\r\n\r\n\t// var filterInput = _textarea([_t(parentStyle.Filter || '')], [['dir','className','inputStyle'],['css','overflow','auto'],['css','margin','1px 0px'],['css','width','260px'],['css','height','40px']]),\r\n\tvar liMinZoom = zoomPropertiesControl.getMinLi(),\r\n\t\tliMaxZoom = zoomPropertiesControl.getMaxLi(),\r\n\t\tulfilterExpr = _ul([_li([_div()],[['css','paddingLeft','0px'],['css','background','none']])]),\r\n\t\tliLabel = _li([_div()],[['css','paddingLeft','0px'],['css','background','none']]),\r\n\t\tulLabel = _ul([liLabel]),\r\n\t\tliBalloon = _li([_div()],[['css','paddingLeft','0px'],['css','background','none']]),\r\n\t\tulBalloon = _ul([liBalloon]),\r\n\t\tliStyle = _li([_div()],[['css','paddingLeft','0px'],['css','background','none']]),\r\n\t\tulStyle = _ul([liStyle]),\r\n\t\t// liClusters = _li([_div()],[['css','paddingLeft','0px'],['css','background','none']]),\r\n\t\t// ulClusters = _ul([liClusters]),\r\n\t\t// clusterCheckbox,\r\n\t\tclusterControl;\r\n\r\n\t// currently we don't support clustring\r\n\t/*if (geometryType == 'point')\r\n\t{\r\n\t\tclusterControl = new nsGmx.ClusterParamsControl(liClusters, parentStyle.clusters);\r\n\t\t$(clusterControl).change(function()\r\n\t\t{\r\n\t\t\tvar filterNum = getOwnChildNumber(ulParent.parentNode.parentNode.parentNode),\r\n\t\t\t\t\tfilter = globalFlashMap.layers[elemCanvas.parentNode.gmxProperties.content.properties.name].filters[filterNum];\r\n\r\n\t\t\tif (clusterControl.isApplyCluster())\r\n\t\t\t{\r\n\t\t\t\tfilter.setClusters(clusterControl.getClusterStyle());\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tfilter.delClusters();\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tclusterCheckbox = _checkbox(clusterControl.isApplyCluster(), 'checkbox');\r\n\t\tclusterCheckbox.style.marginTop = '2px';\r\n\t\tclusterCheckbox.onchange = function()\r\n\t\t{\r\n\t\t\tclusterControl.applyClusters(this.checked);\r\n\t\t}\r\n\r\n\t\tif (!clusterControl.isApplyCluster())\r\n\t\t{\r\n\t\t\tulClusters.style.display = 'none';\r\n\t\t\tulClusters.className = 'hiddenTree';\r\n\t\t}\r\n\t}*/\r\n\r\n\t// zoom\r\n\t$(zoomPropertiesControl).change(function()\r\n\t{\r\n\t\tvar filterNum = getOwnChildNumber(ulParent.parentNode.parentNode.parentNode),\r\n\t\t\tlayer = nsGmx.gmxMap.layersByID[elemCanvas.parentNode.gmxProperties.content.properties.name],\r\n\t\t\tstyle = layer.getStyle(filterNum);\r\n\r\n\t\tvar newStyle = $.extend(true, {}, style, {\r\n\t\t\tMinZoom: this.getMinZoom(),\r\n\t\t\tMaxZoom: this.getMaxZoom()\r\n\t\t});\r\n\r\n\t\tlayer.setStyle(newStyle, filterNum);\r\n\t})\r\n\r\n\t// label\r\n\r\n\tvar fontSizeInput = _input(null, [['dir','className','inputStyle'],['attr','labelParamName','FontSize'],['css','width','26px'],['attr','value', templateStyle.label && templateStyle.label.size || '12']]),\r\n\t    xShiftInput = _input(null, [['dir','className','inputStyle'],['attr','labelParamName','XSfift'],['css','width','26px'],['attr','value', templateStyle.labelAnchor && templateStyle.labelAnchor[0] || '0']]),\r\n\t    yShiftInput = _input(null, [['dir','className','inputStyle'],['attr','labelParamName','FontSize'],['css','width','26px'],['attr','value', templateStyle.labelAnchor && -(templateStyle.labelAnchor[1]) || '0']]),\r\n\t\tcheckedLabelColor = (typeof templateStyle.label != 'undefined' && typeof templateStyle.label.color != 'undefined') ? templateStyle.label.color : 0x000000,\r\n\t\tcheckedLabelHaloColor = (typeof templateStyle.label != 'undefined' && typeof templateStyle.label.haloColor != 'undefined') ? templateStyle.label.haloColor : 0xFFFFFF,\r\n\t\tcheckedFontSize = (typeof templateStyle.label != 'undefined' && typeof templateStyle.label.size != 'undefined') ? templateStyle.label.size : 12,\r\n\t\tcheckedXShift = (typeof templateStyle.labelAnchor != 'undefined' && typeof templateStyle.labelAnchor[0]) ? templateStyle.labelAnchor[0] : 0,\r\n\t\tcheckedYShift = (typeof templateStyle.labelAnchor != 'undefined' && typeof templateStyle.labelAnchor[1]) ? templateStyle.labelAnchor[1] : 0,\r\n\t\tbackupLabel = {\r\n\t\t\tcolor: checkedLabelColor,\r\n\t\t\thaloColor: checkedLabelHaloColor,\r\n\t\t\tsize: checkedFontSize,\r\n\t\t\tdx: checkedXShift,\r\n\t\t\tdy: checkedYShift\r\n\t\t},\r\n\t\tlabelColor = nsGmx.Controls.createColorPicker(checkedLabelColor,\r\n\t\t\tfunction (colpkr){\r\n\t\t\t\t$(colpkr).fadeIn(500);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tfunction (colpkr){\r\n\t\t\t\t$(colpkr).fadeOut(500);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tfunction (hsb, hex) {\r\n\t\t\t\tlabelColor.style.backgroundColor = '#' + hex;\r\n\r\n\t\t\t\tif (typeof templateStyle.label == 'undefined') {\r\n\t\t\t\t\ttemplateStyle.label = backupLabel;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttemplateStyle.label.color = labelColor.hex = parseInt('0x' + hex);\r\n\t\t\t\tcheckedLabelColor = labelColor.hex = parseInt('0x' + hex);\r\n\r\n\t\t\t\tnsGmx.Utils.setMapObjectStyle(layer, styleIndex, templateStyle);\r\n\t\t\t}),\r\n\t\tlabelHaloColor = nsGmx.Controls.createColorPicker(checkedLabelHaloColor,\r\n\t\t\tfunction (colpkr){\r\n\t\t\t\t$(colpkr).fadeIn(500);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tfunction (colpkr){\r\n\t\t\t\t$(colpkr).fadeOut(500);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tfunction (hsb, hex) {\r\n\t\t\t\tlabelHaloColor.style.backgroundColor = '#' + hex;\r\n\r\n\t\t\t\tif (typeof templateStyle.label == 'undefined') {\r\n\t\t\t\t\ttemplateStyle.label = backupLabel;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttemplateStyle.label.haloColor = labelHaloColor.hex = parseInt('0x' + hex);\r\n\t\t\t\tcheckedLabelHaloColor = labelHaloColor.hex = parseInt('0x' + hex);\r\n\r\n\t\t\t\tnsGmx.Utils.setMapObjectStyle(layer, styleIndex, templateStyle);\r\n\t\t\t}),\r\n\t\t\tlayerName = elemCanvas.parentNode.gmxProperties.content.properties.name,\r\n\t\t\ttextareaID = 'labeleditor' + layerName + (_labelEditorId++),\r\n\t\t\tlabelText = _textarea(null, [\r\n\t\t\t\t['dir','className','inputStyle labelEditor'],\r\n\t\t\t\t['attr','placeholder', _gtxt(\"Пример выражения\")],\r\n\t\t\t\t['css','overflow','auto'],\r\n\t\t\t\t['css','width','251px'],\r\n\t\t\t\t['css','height','80px'],\r\n\t\t\t\t['dir','id', textareaID]\r\n\t\t\t]);\r\n\r\n\t_title(labelColor, _gtxt(\"Цвет шрифта\"));\r\n\t_title(labelHaloColor, _gtxt(\"Цвет обводки\"));\r\n\t_title(fontSizeInput, _gtxt(\"Размер шрифта\"));\r\n\t_title(xShiftInput, _gtxt(\"Смещение по x\"));\r\n\t_title(yShiftInput, _gtxt(\"Смещение по y\"));\r\n\r\n\t// при загрузке выставим в инпуты значения либо template, либо label\r\n\tif (templateStyle.labelTemplate) {\r\n\t\t$(labelText).val(templateStyle.labelTemplate);\r\n\t} else if (templateStyle.label && templateStyle.label.field) {\r\n\t\t$(labelText).val('[' + templateStyle.label.field + ']');\r\n\t}\r\n\r\n\tif (attrs) {\r\n\t\tvar keys = {};\r\n\t\tattrs.forEach(function(attr){\r\n\t\t\tkeys[attr] = true;\r\n\t\t});\r\n\t}\r\n\r\n  // при изменении значения текстового поля меняется labelTemplate\r\n  // если оно равно какому-либо атрибуту, он утанавливается в значение field\r\n  // если же как-то отличается, то перечень атрибутов устанавливается на '';\r\n  var updateLabelText = function() {\r\n\t\t// соберем все значения в квадратных скобках\r\n\t\tvar matches = this.value.match(/\\[([^\\]]+)\\]/ig);\r\n\t\tvar str = this.value;\r\n\t\tif (matches) {\r\n\t\t\tfor (var i = 0, len = matches.length; i < len; i++) {\r\n\t\t\t\tvar key1 = matches[i],\r\n\t\t\t\t\tkey = key1.substr(1, key1.length - 2);\r\n\t\t\t\t// отсеиваем случаи, когда в textArea содержится единственный [атрибут]\r\n\t\t\t\tif (matches.length === 1 && matches[0] === str && key in keys) {\r\n\t\t\t\t  // в label передается templateStyle.label.field\r\n\t\t\t\t  delete templateStyle.labelTemplate;\r\n\r\n\t\t\t\t  if (typeof templateStyle.label == 'undefined') {\r\n\t\t\t\t\t  templateStyle.label = backupLabel;\r\n\t\t\t\t\t  templateStyle.label.field = key;\r\n\t\t\t\t  }\telse {\r\n\t\t\t\t\t  templateStyle.label.field = key;\r\n\t\t\t\t  }\r\n\t\t\t\t  nsGmx.Utils.setMapObjectStyle(layer, styleIndex, templateStyle);\r\n\t\t\t\t  return;\r\n\t\t\t\t}\r\n\t\t\t\t// в других случаях в label передается templateStyle.labelTemplate\r\n\t\t\t\t// если внтутри квадратных скобок оказывается какой-то произвольный текст\r\n\t\t\t\tif (!(key in keys)) {\r\n\t\t\t\t\tstr = str.replace(key1, '');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!str) {\r\n\t\t\tif (!this.value) {\r\n\t\t\t\tdelete templateStyle.labelTemplate;\r\n\t\t\t\tdelete templateStyle.label;\r\n\t\t\t} else {\r\n\t\t\t\ttemplateStyle.labelTemplate = this.value;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (typeof templateStyle.label == 'undefined') {\r\n\t\t\t\ttemplateStyle.label = backupLabel;\r\n\t\t\t}\r\n\t\t\ttemplateStyle.labelTemplate = str;\r\n\t\t}\r\n\r\n\t\tnsGmx.Utils.setMapObjectStyle(layer, styleIndex, templateStyle);\r\n\t};\r\n\r\n\tlabelText.onkeyup = updateLabelText;\r\n\r\n\tfontSizeInput.onkeyup = function()\r\n\t{\r\n\t\tif (typeof templateStyle.label == 'undefined') {\r\n\t\t\ttemplateStyle.label = backupLabel;\r\n\t\t}\r\n\r\n\t\ttemplateStyle.label.size = Number(this.value);\r\n\t\tcheckedFontSize = Number(this.value);\r\n\r\n\t\tnsGmx.Utils.setMapObjectStyle(layer, styleIndex, templateStyle);\r\n\t}\r\n\r\n\txShiftInput.onkeyup = function()\r\n\t{\r\n\t\tif (typeof templateStyle.labelAnchor == 'undefined') {\r\n\t\t\ttemplateStyle.labelAnchor = [backupLabel.dx, backupLabel.dy];\r\n\t\t}\r\n\t\t\ttemplateStyle.labelAnchor[0] = Number(this.value);\r\n\t\t\tcheckedXShift = Number(this.value);\r\n\t\t\tnsGmx.Utils.setMapObjectStyle(layer, styleIndex, templateStyle);\r\n\t\t\tlayer.setStyle(templateStyle)\r\n\t}\r\n\r\n\tyShiftInput.onkeyup = function()\r\n\t{\r\n\t\tif (typeof templateStyle.labelAnchor == 'undefined') {\r\n\t\t\ttemplateStyle.labelAnchor = [backupLabel.dx, backupLabel.dy];\r\n\t\t}\r\n\t\t\ttemplateStyle.labelAnchor[1] = -(Number(this.value));\r\n\t\t\tcheckedYShift = -(Number(this.value));\r\n\t\t\tnsGmx.Utils.setMapObjectStyle(layer, styleIndex, templateStyle);\r\n\t}\r\n\r\n\tvar suggestWidget = new nsGmx.SuggestWidget(attrs ? attrs : [], [labelText], '[suggest]', updateLabelText.bind(labelText));\r\n\r\n\tvar divAttr = _div([_t(_gtxt(\"Атрибут >\")), suggestWidget.el], [['dir','className','suggest-link-container']]);\r\n\r\n\tdivAttr.onclick = function()\r\n\t{\r\n\t\tif (suggestWidget.el.style.display == 'none')\r\n\t\t\t$(suggestWidget.el).fadeIn(300);\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// var suggestCanvas = _table([_tbody([_tr([_td([_div([divAttr],[['css','position','relative']])])])])],[['css','margin','0px 3px']]);\r\n\r\n\t_(liLabel.lastChild, [_table([_tbody([\r\n\t  _tr([_td([_t(_gtxt(\"Цвет шрифта\"))], [['css','width','100px']]), _td([labelColor])]),\r\n\t  _tr([_td([_t(_gtxt(\"Цвет обводки\"))], [['css','width','100px']]), _td([labelHaloColor])]),\r\n\t  _tr([_td([_t(_gtxt(\"Размер шрифта\"))], [['css','width','100px']]), _td([fontSizeInput])]),\r\n\t  _tr([_td([_t(_gtxt(\"Смещение по x\"))], [['css','width','100px']]), _td([xShiftInput])]),\r\n\t  _tr([_td([_t(_gtxt(\"Смещение по y\"))], [['css','width','100px']]), _td([yShiftInput])]),\r\n\t  _tr([_td([labelText], [['attr', 'colspan', 4]])]),\r\n\t  _tr([_td([divAttr])])\r\n  ])])]);\r\n\r\n\tif (typeof templateStyle.label == 'undefined')\r\n\t{\r\n\t\tulLabel.style.display = 'none';\r\n\t\tulLabel.className = 'hiddenTree';\r\n\t}\r\n\r\n\t// filter\r\n\r\n\tvar filterEditor = createFilterEditor(parentStyle.Filter, attrs, elemCanvas);\r\n\r\n\t_(ulfilterExpr.lastChild.lastChild, [filterEditor]);\r\n\r\n\tif (typeof parentStyle.Filter == 'undefined' || filterEditor.childNodes.length == 1)\r\n\t{\r\n\t\tulfilterExpr.style.display = 'none';\r\n\t\tulfilterExpr.className = 'hiddenTree';\r\n\t}\r\n\r\n\t// balloon\r\n\tvar balloonEditor = createBalloonEditor(parentStyle, attrs, elemCanvas, elemCanvas.parentNode.gmxProperties.content.properties.identityField);\r\n\r\n\t_(liBalloon.lastChild, [balloonEditor]);\r\n\r\n\tif (typeof parentStyle.Balloon == 'undefined')\r\n\t{\r\n\t\tulBalloon.style.display = 'none';\r\n\t\tulBalloon.className = 'hiddenTree';\r\n\t}\r\n\r\n\tvar bindChangeEvent = function() {\r\n\t\t$(resObject).change(function()\r\n\t\t{\r\n\t\t\tnsGmx.Utils.setMapObjectStyle(layer, styleIndex, templateStyle);\r\n\t\t})\r\n\t}\r\n\r\n\t// common\r\n\tvar symbolsTitle = _div();\r\n\r\n\tif (nsGmx.AuthManager.isRole(nsGmx.ROLE_ADMIN)) {\r\n\t\tvar styleLibIcon = makeImageButton('img/stylelib-main.png', 'img/stylelib-main.png');\r\n\t\tstyleLibIcon.style.verticalAlign = 'middle';\r\n\t\tstyleLibIcon.style.marginLeft = '5px';\r\n\t\tstyleLibIcon.title = _gtxt('Библиотека стилей');\r\n\t\t_(symbolsTitle, [_span([_t(_gtxt(\"Символика\"))],[['css','fontSize','12px']]), styleLibIcon]);\r\n\t\tstyleLibIcon.onclick = function() {\r\n\t\t\tnsGmx.showStyleLibraryDialog('select', geometryType.toUpperCase()).done(function(activeStyleManager) {\r\n\t\t\t\t$(activeStyleManager).change(function() {\r\n\t\t\t\t\tvar styleFromLib = this.getActiveStyle();\r\n\r\n\t\t\t\t\tif (styleFromLib) {\r\n\t\t\t\t\t\ttemplateStyle = styleFromLib;\r\n\r\n\t\t\t\t\t\t$(liStyle.lastChild).empty();\r\n\t\t\t\t\t\tresObject = createStyleEditor(liStyle.lastChild, templateStyle, geometryType, isWindLayer);\r\n\t\t\t\t\t\tbindChangeEvent();\r\n\t\t\t\t\t\tnsGmx.Utils.setMapObjectStyle(layer, styleIndex, templateStyle);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\t} else {\r\n\t\t_(symbolsTitle, [_span([_t(_gtxt(\"Символика\"))],[['css','fontSize','12px']])]);\r\n\t}\r\n\r\n\t_(ulParent, [\r\n\t\tliMinZoom, liMaxZoom,\r\n\t\t_li([_div([_span([_t(_gtxt(\"Фильтр\"))],[['css','fontSize','12px']])]), ulfilterExpr]),\r\n\t\t_li([_div([_span([_t(_gtxt(\"Подпись\"))],[['css','fontSize','12px']])]), ulLabel]),\r\n\t\t_li([_div([_span([_t(_gtxt(\"Балун\"))],[['css','fontSize','12px']])]), ulBalloon]),\r\n\t\t_li([symbolsTitle, ulStyle])\r\n\t]);\r\n\r\n\t/*if (geometryType == 'point')\r\n\t{\r\n\t\t_(ulParent, [_li([\r\n\t\t\t_div([clusterCheckbox,\r\n\t\t\t_span([_t(_gtxt(\"Кластеризация\"))],[['css','fontSize','12px'], ['css', 'marginLeft', '4px']])]),\r\n\t\t\tulClusters\r\n\t\t])])\r\n\t}*/\r\n\r\n\tif (treeviewFlag)\r\n\t\t$(ulParent).treeview();\r\n\r\n\t// styles\r\n\r\n\tvar isWindLayer = typeof elemCanvas.parentNode.gmxProperties != 'undefined' &&\r\n\t\t\t\telemCanvas.parentNode.gmxProperties.content.properties.description &&\r\n\t\t\t\tString(elemCanvas.parentNode.gmxProperties.content.properties.description).toLowerCase().indexOf('карта ветра') == 0;\r\n\tvar resObject = createStyleEditor(liStyle.lastChild, templateStyle, geometryType, isWindLayer);\r\n\r\n\tbindChangeEvent();\r\n\r\n\tulParent.parentNode.parentNode.parentNode.getStyle = function()\r\n\t{\r\n\t\treturn templateStyle;\r\n\t}\r\n\r\n\tulParent.parentNode.parentNode.parentNode.getClusterStyle = function()\r\n\t{\r\n\t\treturn clusterControl && clusterControl.isApplyCluster() ? clusterControl.getClusterStyle() : null;\r\n\t}\r\n\r\n\tulParent.parentNode.parentNode.parentNode.removeColorPickers = function()\r\n\t{\r\n\t\t$(liStyle.lastChild).find(\".colorSelector\").each(function()\r\n\t\t{\r\n\t\t\t$('#' + $(this).data(\"colorpickerId\")).remove();\r\n\t\t})\r\n\r\n\t\t$('#' + $(labelColor).data(\"colorpickerId\")).remove();\r\n\t}\r\n}\r\n\r\nvar updateFilterMoveButtons = function(filter)\r\n{\r\n\tvar num = getOwnChildNumber(filter),\r\n\t\tupButton = $(filter).find(\"[filterMoveButton='up']\")[0],\r\n\t\tdownButton = $(filter).find(\"[filterMoveButton='down']\")[0],\r\n\t\tremoveButton = $(filter).find(\"[filterMoveButton='remove']\")[0];\r\n\r\n\tif (num == 0 || filter.parentNode.childNodes.length == 1)\r\n\t\tupButton.style.visibility = 'hidden';\r\n\telse\r\n\t\tupButton.style.visibility = 'visible';\r\n\r\n\tif (num == filter.parentNode.childNodes.length - 1)\r\n\t\tdownButton.style.visibility = 'hidden';\r\n\telse\r\n\t\tdownButton.style.visibility = 'visible';\r\n\r\n\tif (num == 0)\r\n\t\tremoveButton.style.visibility = 'hidden';\r\n\telse\r\n\t\tremoveButton.style.visibility = 'visible';\r\n}\r\n\r\nvar attachLoadingFilterEvent = function(filterCanvas, layer, styleIndex, parentStyle, geometryType, attrs, elemCanvas)\r\n{\r\n\t$(filterCanvas.firstChild.firstChild.firstChild).bind('click', function()\r\n\t{\r\n\t\tvar ulFilterParams = window._abstractTree.getChildsUl(filterCanvas.firstChild.firstChild);\r\n\r\n\t\tif (!ulFilterParams.loaded)\r\n\t\t{\r\n\t\t\tulFilterParams.loaded = true;\r\n\r\n\t\t\tcreateFilter(layer, styleIndex, parentStyle, geometryType, attrs, elemCanvas, ulFilterParams, true);\r\n\r\n\t\t\t_mapHelper.updateTinyMCE(filterCanvas);\r\n\t\t}\r\n\t})\r\n}\r\n\r\nvar createFilterHeader = function(filtersCanvas, elem, elemCanvas)\r\n{\r\n\tvar addButton =  makeLinkButton(_gtxt('Добавить стиль'));\r\n\taddButton.onclick = function()\r\n\t{\r\n\t\tif (!_layersTree.getLayerVisibility($(elemCanvas.parentNode).find('input[type=\"checkbox\"]')[0])) {\r\n\t\t\t_layersTree.treeModel.setNodeVisibility(elemCanvas.parentNode.gmxProperties, true);\r\n\t\t}\r\n\r\n\t\tvar lastStyle = elemCanvas.parentNode.gmxProperties.content.properties.styles[elemCanvas.parentNode.gmxProperties.content.properties.styles.length - 1],\r\n\t\t\tnewStyle = {},\r\n\t\t\tdefaultStyle = {\r\n\t\t\t\tfill: {\r\n\t\t\t\t\tcolor: 0x0FFFFFF,\r\n\t\t\t\t\topacity: 20\r\n\t\t\t\t},\r\n\t\t\t\toutline: {\r\n\t\t\t\t\tcolor: 255,\r\n\t\t\t\t\tthickness: 1\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tlayer = nsGmx.gmxMap.layersByID[elem.name];\r\n\r\n\t\tlastStyle = lastStyle || {};\r\n\r\n\t\t//копируем состояние балунов с последнего стиля\r\n\t\tnewStyle.Balloon = lastStyle.Balloon || '';\r\n\t\tnewStyle.BalloonEnable = !!lastStyle.BalloonEnable;\r\n\t\tnewStyle.DisableBalloonOnClick = !!lastStyle.DisableBalloonOnClick;\r\n\t\tnewStyle.DisableBalloonOnMouseMove = !!lastStyle.DisableBalloonOnMouseMove;\r\n\t\t//TODO: вернуть правильные начальные параметры\r\n\t\t//globalFlashMap.balloonClassObject.setBalloonFromParams(newFilter, newStyle);\r\n\r\n\t\tnewStyle.MinZoom = lastStyle.MinZoom || 1;\r\n\t\tnewStyle.MaxZoom = lastStyle.MaxZoom || 21;\r\n\r\n\t\tnewStyle.RenderStyle = defaultStyle;\r\n\r\n\t\tlayer.setStyles(layer.getStyles().concat(newStyle));\r\n\r\n\t\tvar filter = createLoadingFilter(layer, layer.getStyles().length - 1, newStyle, elem.GeometryType.toLowerCase(), elem.attributes, elemCanvas, false);\r\n\r\n\t\t_(filtersCanvas, [filter]);\r\n\r\n\t\tupdateFilterMoveButtons(filter)\r\n\t\tif (filtersCanvas.childNodes.length >= 2) {\r\n\t\t\tupdateFilterMoveButtons(filtersCanvas.childNodes[filtersCanvas.childNodes.length - 2])\r\n\t\t}\r\n\r\n\t\t$(filter.firstChild).treeview();\r\n\r\n\t\tattachLoadingFilterEvent(filter, layer, layer.getStyles().length - 1, newStyle, elem.GeometryType.toLowerCase(), elem.attributes, elemCanvas, false)\r\n\t}\r\n\r\n\taddButton.style.marginLeft = '10px';\r\n\r\n\treturn _div([addButton],[['css','height','20px'],['css','padding','5px']]);\r\n}\r\n\r\nvar swapFilters = function(div, firstNum, filterCanvas)\r\n{\r\n\tvar layerName = div.gmxProperties.content.properties.name,\r\n\t\tlayer = nsGmx.gmxMap.layersByID[layerName],\r\n\t\tfilters = layer.getStyles(),\r\n\t\tnewFilters = [];\r\n\r\n\tfor (var i = 0; i < filters.length; i++)\r\n\t{\r\n\t\tif (i < firstNum || i > firstNum + 1)\r\n\t\t\tnewFilters.push(filters[i])\r\n\t\telse if (i == firstNum)\r\n\t\t\tnewFilters.push(filters[i + 1])\r\n\t\telse if (i == firstNum + 1)\r\n\t\t\tnewFilters.push(filters[i - 1])\r\n\t}\r\n\r\n\tlayer.setStyles(newFilters);\r\n\r\n\t$(filterCanvas.childNodes[firstNum]).before(filterCanvas.childNodes[firstNum + 1]);\r\n\r\n\tupdateFilterMoveButtons(filterCanvas.childNodes[firstNum]);\r\n\tupdateFilterMoveButtons(filterCanvas.childNodes[firstNum + 1]);\r\n}\r\n\r\nvar createLoadingFilter = function(layer, styleIndex, parentStyle, geometryType, attrs, elemCanvas, openedFlag)\r\n{\r\n\tvar templateStyle = {},\r\n\t\tnameInput = _input(null, [['dir','className','inputStyle'],['attr','paramName','Name'],['css','width','210px'],['attr','value', parentStyle.Name || '']]),\r\n\t\tulFilterParams = _ul(),\r\n\t\tliFilter = _li([_div([nameInput]), ulFilterParams]),\r\n\t\tulFilter = _ul([liFilter]),\r\n\t\tfilterCanvas = _div([ulFilter],[['dir','className','filterCanvas']]);\r\n\r\n\t$.extend(true, templateStyle, _mapHelper.makeStyle(parentStyle));\r\n\r\n\t_title(nameInput, _gtxt(\"Имя фильтра\"));\r\n\r\n\tfilterCanvas.getStyle = function()\r\n\t{\r\n\t\treturn templateStyle;\r\n\t}\r\n\r\n\tfilterCanvas.getClusterStyle = function()\r\n\t{\r\n\t\treturn parentStyle.clusters;\r\n\t}\r\n\r\n\tfilterCanvas.getFilter = function()\r\n\t{\r\n\t\treturn parentStyle.Filter;\r\n\t}\r\n\r\n\tfilterCanvas.getBalloon = function()\r\n\t{\r\n\t\treturn parentStyle.Balloon;\r\n\t}\r\n\r\n\tfilterCanvas.getBalloonEnable = function()\r\n\t{\r\n\t\treturn (typeof parentStyle.BalloonEnable != 'undefined' ? parentStyle.BalloonEnable : true);\r\n\t};\r\n\r\n\tfilterCanvas.getBalloonDisableOnClick = function()\r\n\t{\r\n\t\treturn parentStyle.DisableBalloonOnClick;\r\n\t};\r\n\r\n\tfilterCanvas.getDisableBalloonOnMouseMove = function()\r\n\t{\r\n\t\treturn parentStyle.DisableBalloonOnMouseMove;\r\n\t};\r\n\r\n\tfilterCanvas.getBalloonState = function()\r\n\t{\r\n\t\tvar state = {\r\n\t\t\tBalloonEnable: !parentStyle.DisableBalloonOnMouseMove || !parentStyle.DisableBalloonOnClick,\r\n\t\t\tDisableBalloonOnClick: parentStyle.DisableBalloonOnClick,\r\n\t\t\tDisableBalloonOnMouseMove: parentStyle.DisableBalloonOnMouseMove,\r\n\t\t\tBalloon: parentStyle.Balloon\r\n\t\t}\r\n\r\n\t\treturn state;\r\n\t}\r\n\r\n\tfilterCanvas.addFilterParams = function(filterParams)\r\n\t{\r\n\t\tfilterParams.Name = nameInput.value;\r\n\t\tfilterParams.MinZoom = parentStyle.MinZoom;\r\n\t\tfilterParams.MaxZoom = parentStyle.MaxZoom;\r\n\t}\r\n\r\n\tfilterCanvas.removeColorPickers = function(){}\r\n\r\n\tif (!openedFlag)\r\n\t{\r\n\t\tulFilterParams.loaded = false;\r\n\r\n\t\tulFilterParams.style.display = 'none';\r\n\t\tulFilterParams.className = 'hiddenTree';\r\n\t}\r\n\telse\r\n\t{\r\n\t\tulFilterParams.loaded = true;\r\n\r\n\t\tcreateFilter(layer, styleIndex, parentStyle, geometryType, attrs, elemCanvas, ulFilterParams, false);\r\n\t}\r\n\r\n\tvar moveUp = makeImageButton('img/up.png', 'img/up_a.png'),\r\n\t\tmoveDown = makeImageButton('img/down.png', 'img/down_a.png');\r\n\r\n\tmoveUp.onclick = function()\r\n\t{\r\n\t\tthis.src = 'img/up.png';\r\n\r\n\t\tvar firstNum = getOwnChildNumber(this.parentNode.parentNode.parentNode.parentNode) - 1;\r\n\r\n\t\tswapFilters(elemCanvas.parentNode, firstNum, this.parentNode.parentNode.parentNode.parentNode.parentNode);\r\n\t}\r\n\r\n\tmoveDown.onclick = function()\r\n\t{\r\n\t\tthis.src = 'img/down.png';\r\n\r\n\t\tvar firstNum = getOwnChildNumber(this.parentNode.parentNode.parentNode.parentNode);\r\n\r\n\t\tswapFilters(elemCanvas.parentNode, firstNum, this.parentNode.parentNode.parentNode.parentNode.parentNode);\r\n\t}\r\n\r\n\tmoveUp.style.margin = '0px 1px -3px 2px';\r\n\tmoveDown.style.margin = '0px 1px -3px 2px';\r\n\r\n\tmoveUp.setAttribute('filterMoveButton','up');\r\n\tmoveDown.setAttribute('filterMoveButton','down');\r\n\r\n\t_title(moveUp, _gtxt(\"Переместить фильтр вверх\"));\r\n\t_title(moveDown, _gtxt(\"Переместить фильтр вниз\"));\r\n\r\n\t_(liFilter.firstChild, [moveDown, moveUp])\r\n\r\n\tvar remove = makeImageButton('img/closemin.png', 'img/close_orange.png')\r\n\tremove.onclick = function()\r\n\t{\r\n\t\tvar num = getOwnChildNumber(filterCanvas);\r\n\r\n\t\tvar filtersParent = filterCanvas.parentNode;\r\n\r\n\t\tfilterCanvas.removeNode(true);\r\n\r\n\t\tupdateFilterMoveButtons(filtersParent.childNodes[num - 1])\r\n\r\n\t\tvar styles = layer.getStyles().slice();\r\n\t\tstyles.splice(styleIndex, 1);\r\n\t\tlayer.setStyles(styles);\r\n\t}\r\n\r\n\tremove.setAttribute('filterMoveButton','remove');\r\n\r\n\tremove.style.width = '16px';\r\n\tremove.style.height = '16px';\r\n\r\n\tremove.style.margin = '0px 1px -3px 2px';\r\n\r\n\t_title(remove, _gtxt(\"Удалить фильтр\"))\r\n\r\n\t_(liFilter.firstChild, [remove])\r\n\r\n\treturn filterCanvas;\r\n}\r\n\r\nvar showStyle = function(elem)\r\n{\r\n\tvar div = $(elem).find(\"[fade]\")[0];\r\n\r\n\t$(div).fadeIn(300);\r\n}\r\n\r\nvar hideStyle = function(elem)\r\n{\r\n\tvar div = $(elem).find(\"[fade]\")[0];\r\n\r\n\t$(div).fadeOut(300);\r\n}\r\n\r\n//возвращает стили, которые в данный момент введены в DOM-элементе filterCanvas\r\n//использует структуру DOM-дерева\r\nvar updateStyles = function(filterCanvas)\r\n{\r\n\tvar styles = [];\r\n\r\n\tfor (var i = 0; i < filterCanvas.childNodes.length; i++)\r\n\t{\r\n\t\tvar filter = filterCanvas.childNodes[i],\r\n\t\t\tnewFilterStyle = {};\r\n\r\n\t\tif (!window._abstractTree.getChildsUl(filter.firstChild.firstChild).childNodes.length)\r\n\t\t\tfilter.addFilterParams(newFilterStyle);\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(filter).find(\"[paramName]\").each(function()\r\n\t\t\t{\r\n\t\t\t\tnewFilterStyle[this.getAttribute('paramName')] = this.value;\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tvar filterValueElem = $(filter).find(\"[filterTable]\").length > 0 ? $(filter).find(\"[filterTable]\")[0] : filter,\r\n\t\t\tfilterValue = filterValueElem.getFilter();\r\n\t\tif (filterValue != '' && filterValue != null)\r\n\t\t\tnewFilterStyle.Filter = filterValue;\r\n\r\n\t\tvar balloonValueElem = $(filter).find(\"[balloonTable]\").length > 0 ? $(filter).find(\"[balloonTable]\")[0] : filter;\r\n\t\t\t//var balloonValue = balloonValueElem.getBalloon();\r\n\r\n\t\t$.extend(newFilterStyle, balloonValueElem.getBalloonState());\r\n\r\n\t\tif (newFilterStyle.Filter == '')\r\n\t\t\tdelete newFilterStyle.Filter;\r\n\t\tif (newFilterStyle.Name == '')\r\n\t\t\tdelete newFilterStyle.Name;\r\n\r\n\t\tnewFilterStyle.MinZoom = Number(newFilterStyle.MinZoom);\r\n\t\tnewFilterStyle.MaxZoom = Number(newFilterStyle.MaxZoom);\r\n\r\n\t\tif (isNaN(newFilterStyle.MinZoom))\r\n\t\t\tnewFilterStyle.MinZoom = 1;\r\n\t\tif (isNaN(newFilterStyle.MinZoom))\r\n\t\t\tnewFilterStyle.MinZoom = 21;\r\n\r\n\t\tnewFilterStyle.RenderStyle = filter.getStyle();\r\n\r\n\t\tvar clusterStyle = filter.getClusterStyle();\r\n\t\tif (clusterStyle)\r\n\t\t\tnewFilterStyle.clusters = clusterStyle;\r\n\r\n\t\tstyles.push(newFilterStyle);\r\n\t}\r\n\r\n\treturn styles;\r\n}\r\n\r\nconst createStyleEditor = function(parent, templateStyle, geometryType, isWindLayer) {\r\n\tvar markerSizeParent = _tr(),\r\n\t\toutlineParent = _tr(),\r\n\t\tfillParent = _tr(),\r\n\t\ticonParent = _tr(),\r\n\t\toutlineTitleTds = [],\r\n\t\tfillTitleTds = [],\r\n\t\ticonTitleTds = [],\r\n\t\toutlineTds = [],\r\n\t\tfillTds = [],\r\n\t\ticonTds = [],\r\n\t\tinputUrl,\r\n\t\tfillToggle,\r\n\t\toutlineToggle,\r\n\t\ticonToggle,\r\n\t\tshowIcon,\r\n\t\tshowMarker,\r\n\t\t// hideIcon,\r\n\t\tangle,\r\n\t\tscale,\r\n\t\tresObject = {};\r\n\r\n\t_(parent, [_table([_tbody([outlineParent, markerSizeParent, fillParent, iconParent])])]);\r\n\r\n\tvar fillStyleControl = new FillStyleControl(templateStyle, {showSelectors: geometryType !== 'point'});\r\n\tfillStyleControl.setVisibleSelectors(typeof templateStyle.fill != 'undefined');\r\n\t$(fillStyleControl).change(function()\r\n\t{\r\n\t\tvar fillStyle = fillStyleControl.getFillStyle();\r\n\t\ttemplateStyle.fill = fillStyle;\r\n\t\t$(resObject).change();\r\n\t});\r\n\r\n\tshowIcon = function()\r\n\t{\r\n\t\thideStyle(outlineParent);\r\n\t\thideStyle(fillParent);\r\n\t\tfillStyleControl.setVisibleSelectors(false);\r\n\t\tfillParent.style.display = 'none';\r\n\t\tshowStyle(iconParent);\r\n\r\n\t\ttemplateStyle.marker = {};\r\n\t\ttemplateStyle.marker.image = inputUrl.value();\r\n\t\ttemplateStyle.marker.center = true;\r\n\r\n\t\tdelete templateStyle.outline;\r\n\t\tdelete templateStyle.fill;\r\n\r\n\t\tif (geometryType == \"point\")\r\n\t\t{\r\n\t\t\tif ( isWindLayer )\r\n\t\t\t{\r\n\t\t\t\tif (angle.value != '')\r\n\t\t\t\t\ttemplateStyle.marker.angle = angle.value;\r\n\r\n\t\t\t\tif (scale.value != '')\r\n\t\t\t\t\ttemplateStyle.marker.scale = scale.value;\r\n\r\n\t\t\t\ttemplateStyle.marker.color = $(iconParent).find(\".colorSelector\")[0].hex;\r\n\t\t\t}\r\n\t\t\thideStyle(markerSizeParent);\r\n\t\t\tmarkerSizeParent.style.display = 'none';\r\n\t\t}\r\n\r\n\t\tif (geometryType != \"linestring\")\r\n\t\t{\r\n\t\t\tfillToggle.disabled = true;\r\n\t\t}\r\n\r\n\t\t$(resObject).change();\r\n\t}\r\n\r\n\tshowMarker = function()\r\n\t{\r\n\t\tshowStyle(outlineParent);\r\n\t\tshowStyle(markerSizeParent);\r\n\t\tmarkerSizeParent.style.display = '';\r\n\t\thideStyle(iconParent);\r\n\r\n\t\tif (geometryType != \"linestring\")\r\n\t\t{\r\n\t\t\tfillParent.style.display = '';\r\n\t\t\tif (fillToggle.checked)\r\n\t\t\t{\r\n\t\t\t\tshowStyle(fillParent);\r\n\t\t\t\tfillStyleControl.setVisibleSelectors(true);\r\n\t\t\t}\r\n\r\n\t\t\tif (geometryType == \"point\")\r\n\t\t\t{\r\n\t\t\t\ttemplateStyle.marker = {};\r\n\t\t\t\ttemplateStyle.marker.size = Number($(markerSizeParent).find(\".inputStyle\").val());\r\n\t\t\t}\r\n\r\n\t\t\ttemplateStyle.fill = fillStyleControl.getFillStyle();\r\n\t\t\tfillToggle.disabled = false;\r\n\t\t}\r\n\r\n\t\tif (geometryType != \"point\" && typeof templateStyle.marker != 'undefined')\r\n\t\t\tdelete templateStyle.marker;\r\n\r\n\t\ttemplateStyle.outline = {};\r\n\t\ttemplateStyle.outline.thickness = Number($(outlineParent).find(\".inputStyle\")[0].value);\r\n\t\ttemplateStyle.outline.color = $(outlineParent).find(\".colorSelector\")[0].hex;\r\n\t\ttemplateStyle.outline.opacity = $($(outlineParent).find(\".ui-slider\")[0]).slider('option', 'value');\r\n\r\n\t\t$(resObject).change();\r\n\t}\r\n\r\n\toutlineToggle = _checkbox(geometryType == \"point\" && typeof templateStyle.marker != 'undefined' && typeof templateStyle.marker.image == 'undefined' || geometryType != \"point\" && (typeof templateStyle.marker == 'undefined' || typeof templateStyle.marker != 'undefined' && typeof templateStyle.marker.image == 'undefined'),'radio');\r\n\toutlineToggle.onclick = function()\r\n\t{\r\n\t\tshowMarker();\r\n\r\n\t\ticonToggle.checked = false;\r\n\t\tthis.checked = true;\r\n\t}\r\n\r\n\toutlineTitleTds.push(_td([outlineToggle],[['css','width','20px'],['css','height','24px']]));\r\n\toutlineTitleTds.push(_td([_t(_gtxt(\"Граница\"))],[['css','width','70px']]));\r\n\r\n\tvar outlineColor = nsGmx.Controls.createColorPicker((templateStyle.outline && typeof templateStyle.outline.color != 'undefined') ? templateStyle.outline.color : 0x0000FF,\r\n\t\tfunction (colpkr){\r\n\t\t\t$(colpkr).fadeIn(500);\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tfunction (colpkr){\r\n\t\t\t$(colpkr).fadeOut(500);\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tfunction (hsb, hex) {\r\n\t\t\toutlineColor.style.backgroundColor = '#' + hex;\r\n\r\n\t\t\ttemplateStyle.outline = templateStyle.outline || {};\r\n\t\t\ttemplateStyle.outline.color = outlineColor.hex = parseInt('0x' + hex);\r\n\r\n\t\t\t$(resObject).change();\r\n\t\t})\r\n\r\n\tif (templateStyle.outline && typeof templateStyle.outline.color != 'undefined')\r\n\t\toutlineColor.hex = templateStyle.outline.color;\r\n\telse\r\n\t\toutlineColor.hex = 0x0000FF;\r\n\r\n\toutlineTds.push(_td([outlineColor],[['css','width','40px']]));\r\n\r\n\tvar divSlider = nsGmx.Controls.createSlider((templateStyle.outline && typeof templateStyle.outline.opacity != 'undefined') ? templateStyle.outline.opacity : 100,\r\n\t\t\tfunction(event, ui)\r\n\t\t\t{\r\n\t\t\t\ttemplateStyle.outline = templateStyle.outline || {};\r\n\t\t\t\ttemplateStyle.outline.opacity = ui.value;\r\n\r\n\t\t\t\t$(resObject).change();\r\n\t\t\t})\r\n\r\n\toutlineTds.push(_td([divSlider],[['css','width','100px'],['css','padding','4px 5px 3px 5px']]));\r\n\r\n\tvar outlineThick = nsGmx.Controls.createInput((templateStyle.outline && typeof templateStyle.outline.thickness != 'undefined') ? templateStyle.outline.thickness : 2,\r\n\t\t\tfunction()\r\n\t\t\t{\r\n\t\t\t\ttemplateStyle.outline = templateStyle.outline || {};\r\n\t\t\t\ttemplateStyle.outline.thickness = Number(this.value);\r\n\r\n\t\t\t\t$(resObject).change();\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\r\n\t_title(outlineThick, _gtxt(\"Толщина линии\"));\r\n\r\n\toutlineTds.push(_td([outlineThick],[['css','width','30px']]));\r\n\r\n\tvar dashInput = _input(null, [['attr', 'value', templateStyle.outline && typeof templateStyle.outline.dashes != 'undefined' ? templateStyle.outline.dashes : ''],['dir','className','inputStyle'],['css','width','140px']]),\r\n\t\tdashSelect = nsGmx.Utils._select(null, [['dir','className','selectStyle'],['css','width','50px'],['css','fontSize','12px'],['css','fontWeight','bold']]),\r\n\t\tborderValues = {\r\n\t\t\t\t\"1\" : \"\",\r\n\t\t\t\t\"2\" : \"4,4\",\r\n\t\t\t\t\"3\" : \"2,2\",\r\n\t\t\t\t\"4\" : \"6,3,2,3\",\r\n\t\t\t\t\"5\" : \"6,3,2,3,2,3\",\r\n\t\t\t\t\"6\" : \"2,4\",\r\n\t\t\t\t\"7\" : \"6,6\",\r\n\t\t\t\t\"8\" : \"7,6,2,6\",\r\n\t\t\t\t\"9\" : \"8,4,8,4,2,4\"\r\n\t\t\t},\r\n\t\tdashSelector = _div(null,[['dir','className','colorSelector']]),\r\n\t\tdashTable = _table(null, [['css','position','absolute'],['css','left','-1px'],['css','top','-57px'],['css','zIndex',2]]),\r\n\t\tdashedTds = [],\r\n\t\tdashFunc = function()\r\n\t\t{\r\n\t\t\tvar arr = dashInput.value.split(\",\"),\r\n\t\t\t\tcorrect = true;\r\n\r\n\t\t\tif (arr.length % 2 == 0)\r\n\t\t\t{\r\n\t\t\t\tfor (var i = 0; i < arr.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tarr[i] = Number(arr[i]);\r\n\r\n\t\t\t\t\tif (isNaN(arr[i]) || arr[i] <= 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcorrect = false;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tcorrect = false;\r\n\r\n\t\t\ttemplateStyle.outline = templateStyle.outline || {};\r\n\t\t\tif (correct) {\r\n\t\t\t\ttemplateStyle.outline.dashes = arr;\r\n\t\t\t}\r\n\t\t\telse if (templateStyle.outline.dashes) {\r\n\t\t\t\tdelete templateStyle.outline.dashes;\r\n\t\t\t}\r\n\r\n\t\t\t$(resObject).change();\r\n\t\t};\r\n\r\n\tif (geometryType != \"point\")\r\n\t{\r\n\t\tvar dashTrs = []\r\n\t\tfor (var i = 1; i <= 7; i+=3)\r\n\t\t{\r\n\t\t\tvar dashTds = [];\r\n\t\t\tfor (var j = i; j <= i + 2; j++)\r\n\t\t\t{\r\n\t\t\t\tvar dashTd = _td([_img(null,[['attr','src','img/dash' + j + '.png']])],[['css','border','1px solid #000000'],['css','cursor','pointer']]);\r\n\r\n\t\t\t\t(function(j){\r\n\t\t\t\t\tdashTd.onclick = function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdashSelector.style.backgroundImage = 'url(img/dash' + j + '.png)';\r\n\r\n\t\t\t\t\t\tdashInput.value = borderValues[String(j)];\r\n\t\t\t\t\t\tdashFunc();\r\n\r\n\t\t\t\t\t\t$(dashTable).fadeOut(500);\r\n\r\n\t\t\t\t\t\tstopEvent(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t})(j)\r\n\r\n\t\t\t\tdashTds.push(dashTd)\r\n\t\t\t}\r\n\r\n\t\t\tdashTrs.push(_tr(dashTds))\r\n\t\t}\r\n\r\n\t\t_(dashTable, [_tbody(dashTrs)]);\r\n\r\n\t\t_(dashSelector, [dashTable]);\r\n\r\n\t\tdashSelector.onclick = function()\r\n\t\t{\r\n\t\t\t$(dashTable).fadeIn(500);\r\n\t\t}\r\n\r\n\t\tdashInput.onfocus = dashSelector.onblur = function()\r\n\t\t{\r\n\t\t\t$(dashTable).fadeOut(500);\r\n\t\t}\r\n\r\n\t\tdashTable.style.display = 'none';\r\n\r\n\t\tdashedTds.push(_td([dashSelector]));\r\n\t\tdashedTds.push(_td([dashInput],[['attr','colSpan',2]]));\r\n\r\n\t\tfor (var borderValue in borderValues)\r\n\t\t{\r\n\t\t\tif (borderValues[borderValue] == dashInput.value)\r\n\t\t\t{\r\n\t\t\t\tdashSelector.style.backgroundImage = 'url(img/dash' + borderValue + '.png)';\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tdashSelect.style.marginLeft = '2px';\r\n\r\n\t\tdashInput.onkeyup = function()\r\n\t\t{\r\n\t\t\tdashFunc();\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\telse\r\n\t\tdashedTds = [_td(),_td(),_td()]\r\n\r\n\tif (geometryType != \"linestring\")\r\n\t{\r\n\t\tfillToggle = _checkbox(typeof templateStyle.fill != 'undefined','checkbox');\r\n\t\tfillToggle.onclick = function()\r\n\t\t{\r\n\t\t\tfillStyleControl.setVisibleSelectors(this.checked);\r\n\t\t\tif (this.checked)\r\n\t\t\t{\r\n\t\t\t\t templateStyle.fill = fillStyleControl.getFillStyle();\r\n\t\t\t\tshowStyle(fillParent);\r\n\r\n\t\t\t\t$(resObject).change();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\thideStyle(fillParent);\r\n\r\n\t\t\t\tdelete templateStyle.fill;\r\n\r\n\t\t\t\t// if (elemCanvas.nodeName == 'DIV')\r\n\t\t\t\t\t// $(elemCanvas).find(\".fillIcon\")[0].style.backgroundColor = \"#FFFFFF\";\r\n\r\n\t\t\t\t$(resObject).change();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfillTitleTds.push(_td([fillToggle],[['css','width','20px'],['css','height','24px']]));\r\n\t\t//fillTitleTds.push(_td([_t(_gtxt(\"Заливка\"))],[['css','width','70px']]));\r\n\t\tfillTitleTds.push(_td([fillStyleControl.getSelector()[0]],[['css','width','70px']]));\r\n\r\n\t\tvar checkedFillColor = (typeof templateStyle.fill != 'undefined' && typeof templateStyle.fill.color != 'undefined') ? templateStyle.fill.color : 0xFFFFFF,\r\n\t\t\tcheckedFillOpacity = (typeof templateStyle.fill != 'undefined' && typeof templateStyle.fill.opacity != 'undefined') ? templateStyle.fill.opacity : 0,\r\n\t\t\tfillColor = nsGmx.Controls.createColorPicker(checkedFillColor,\r\n\t\t\t\tfunction (colpkr){\r\n\t\t\t\t\t$(colpkr).fadeIn(500);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tfunction (colpkr){\r\n\t\t\t\t\t$(colpkr).fadeOut(500);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tfunction (hsb, hex) {\r\n\t\t\t\t\tfillColor.style.backgroundColor = '#' + hex;\r\n\r\n\t\t\t\t\ttemplateStyle.fill.color = fillColor.hex = parseInt('0x' + hex);\r\n\r\n\t\t\t\t\t// if (elemCanvas.nodeName == 'DIV')\r\n\t\t\t\t\t\t// $(elemCanvas).find(\".fillIcon\")[0].style.backgroundColor = '#' + hex;\r\n\r\n\t\t\t\t\t$(resObject).change();\r\n\t\t\t\t}),\r\n\t\t\tfillSlider = nsGmx.Controls.createSlider(checkedFillOpacity,\r\n\t\t\t\tfunction(event, ui)\r\n\t\t\t\t{\r\n\t\t\t\t\ttemplateStyle.fill.opacity = ui.value;\r\n\r\n\t\t\t\t\t$(resObject).change();\r\n\t\t\t\t});\r\n\r\n\t\tfillColor.hex = checkedFillColor;\r\n\r\n\t\tfillTds.push(_td([fillColor],[['css','width','40px']]));\r\n\t\tfillTds.push(_td([fillSlider],[['css','width','100px'],['css','padding','4px 5px 3px 5px']]));\r\n\t}\r\n\r\n\ticonToggle = _checkbox(templateStyle.marker && typeof templateStyle.marker.image != 'undefined','radio');\r\n\ticonToggle.onclick = function()\r\n\t{\r\n\t\tshowIcon();\r\n\r\n\t\toutlineToggle.checked = false;\r\n\t\tthis.checked = true;\r\n\t}\r\n\r\n\ticonTitleTds.push(_td([iconToggle],[['css','width','20px'],['css','height','24px'],['attr','vAlign','top'],['css','paddingTop','5px']]));\r\n\ticonTitleTds.push(_td([_t(_gtxt(\"Маркер URL\"))],[['css','width','70px'],['attr','vAlign','top'],['css','paddingTop','5px']]));\r\n\r\n\tinputUrl = new window.mapHelper.ImageInputControl((typeof templateStyle.marker != 'undefined' && templateStyle.marker.image) ? templateStyle.marker.image : '');\r\n\t$(inputUrl).change(function()\r\n\t{\r\n\t\tif (inputUrl.value() != '')\r\n\t\t{\r\n\t\t\tshowIcon();\r\n\r\n\t\t\toutlineToggle.checked = false;\r\n\t\t\ticonToggle.checked = true;\r\n\t\t}\r\n\r\n\t\tif (typeof templateStyle.marker == 'undefined')\r\n\t\t\ttemplateStyle.marker = {};\r\n\r\n\t\ttemplateStyle.marker.image = inputUrl.value();\r\n\r\n\t\t$(resObject).change();\r\n\t});\r\n\r\n\tif (geometryType == \"point\")\r\n\t{\r\n\t\tvar markerSizeInput = nsGmx.Controls.createInput(templateStyle.marker && templateStyle.marker.size || 3,\r\n\t\t\tfunction()\r\n\t\t\t{\r\n\t\t\t\ttemplateStyle.marker = templateStyle.marker || {};\r\n\r\n\t\t\t\ttemplateStyle.marker.size = Number(this.value);\r\n\r\n\t\t\t\t$(resObject).change();\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t})\r\n\r\n\t\t_title(markerSizeInput, _gtxt(\"Размер точек\"));\r\n\r\n\t\tvar markerSizeTds = [_td(), _td([_t(_gtxt(\"Размер\"))]), _td([markerSizeInput], [['attr','fade',true]])];\r\n\t\t_(markerSizeParent, markerSizeTds, [['attr','fade',true]]);\r\n\r\n\t\tif ( isWindLayer )\r\n\t\t{\r\n\t\t\tvar markerColor = nsGmx.Controls.createColorPicker((templateStyle.marker && typeof templateStyle.marker.color != 'undefined') ? templateStyle.marker.color : 0xFF00FF,\r\n\t\t\t\tfunction (colpkr){\r\n\t\t\t\t\t$(colpkr).fadeIn(500);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tfunction (colpkr){\r\n\t\t\t\t\t$(colpkr).fadeOut(500);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tfunction (hsb, hex) {\r\n\t\t\t\t\tmarkerColor.style.backgroundColor = '#' + hex;\r\n\r\n\t\t\t\t\ttemplateStyle.marker = templateStyle.marker || {};\r\n\t\t\t\t\ttemplateStyle.marker.color = markerColor.hex = parseInt('0x' + hex);\r\n\r\n\t\t\t\t\t$(resObject).change();\r\n\t\t\t\t})\r\n\r\n\t\t\tif (templateStyle.marker && typeof templateStyle.marker.color != 'undefined')\r\n\t\t\t\tmarkerColor.hex = templateStyle.marker.color;\r\n\t\t\telse\r\n\t\t\t\tmarkerColor.hex = 0xFF00FF;\r\n\r\n\t\t\tscale = _input(null, [['dir','className','inputStyle'],['attr','value', (templateStyle.marker && templateStyle.marker.scale) ? templateStyle.marker.scale : ''],['css','width','68px']]);\r\n\r\n\t\t\tscale.onkeyup = function()\r\n\t\t\t{\r\n\t\t\t\ttemplateStyle.marker = templateStyle.marker || {};\r\n\t\t\t\tif (this.value != '')\r\n\t\t\t\t\ttemplateStyle.marker.scale = this.value;\r\n\t\t\t\telse\r\n\t\t\t\t\tdelete templateStyle.marker.scale;\r\n\r\n\t\t\t\t$(resObject).change();\r\n\t\t\t}\r\n\r\n\t\t\t_title(scale, _gtxt(\"Масштаб\"))\r\n\r\n\t\t\tangle = _input(null, [['dir','className','inputStyle'],['attr','value', (templateStyle.marker && templateStyle.marker.angle) ? templateStyle.marker.angle : ''],['css','width','68px']]);\r\n\r\n\t\t\tangle.onkeyup = function()\r\n\t\t\t{\r\n\t\t\t\ttemplateStyle.marker = templateStyle.marker || {};\r\n\t\t\t\tif (this.value != '')\r\n\t\t\t\t\ttemplateStyle.marker.angle = this.value;\r\n\t\t\t\telse\r\n\t\t\t\t\tdelete templateStyle.marker.angle;\r\n\r\n\t\t\t\t$(resObject).change();\r\n\t\t\t}\r\n\r\n\t\t\t_title(angle, _gtxt(\"Угол поворота\"))\r\n\r\n\t\t\ticonTds.push(_td([_table([_tbody([_tr([_td([inputUrl.getControl()], [['attr','colSpan',3]])]),\r\n\t\t\t\t\t\t\t\t\t\t\t\t_tr([_td([markerColor], [['css','paddingLeft','1px']]), _td([angle]), _td([scale], [['css','paddingRight','3px']])])])])]));\r\n\t\t}\r\n\t\telse\r\n\t\t\ticonTds.push(_td([inputUrl.getControl()]));\r\n\t}\r\n\telse if (geometryType == \"polygon\" || geometryType == \"linestring\")\r\n\t{\r\n\t//\thide(iconParent);\r\n\r\n\t\ticonTds.push(_td([inputUrl.getControl()]));\r\n\r\n\t\tif (geometryType == \"linestring\")\r\n\t\t\thide(fillParent);\r\n\t}\r\n\r\n\t_(outlineParent, outlineTitleTds.concat(_td([_div([_table([_tbody([_tr(outlineTds), _tr(dashedTds)])])],[['attr','fade',true]])])));\r\n\r\n\t//_(fillParent, fillTitleTds.concat(_td([_div([_table([_tbody([_tr(fillTds)])])],[['attr','fade',true]])])));\r\n\tvar topPadding = geometryType === \"point\" ? \"0px\" : \"10px\";\r\n\t fillTitleTds = fillTitleTds.concat(_td([fillStyleControl.getControls()[0]], [['attr','fade',true], ['css', 'paddingTop', topPadding]]));\r\n\t _(fillParent, fillTitleTds);\r\n\r\n\t_(iconParent, iconTitleTds.concat(_td([_div([_table([_tbody([_tr(iconTds)])])],[['attr','fade',true]])])));\r\n\r\n\tif (templateStyle.marker && typeof templateStyle.marker.image != 'undefined')\r\n\t{\r\n\t\t$(outlineParent).find(\"[fade]\")[0].style.display = 'none';\r\n\t\t$(fillParent).find(\"[fade]\")[0].style.display = 'none';\r\n\t\t$(iconParent).find(\"[fade]\")[0].style.display = '';\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$(outlineParent).find(\"[fade]\")[0].lastChild.style.display = '';\r\n\t\t$(fillParent).find(\"[fade]\")[0].style.display = '';\r\n\t\t$(iconParent).find(\"[fade]\")[0].style.display = 'none';\r\n\t}\r\n\r\n\tif (geometryType != \"linestring\" && typeof templateStyle.fill == 'undefined')\r\n\t\t$(fillParent).find(\"[fade]\")[0].style.display = 'none';\r\n\r\n\treturn resObject;\r\n}\r\n\r\nvar LayerStylesEditor = function(div, divStyles, openedStyleIndex) {\r\n\tvar elemProperties = div.gmxProperties.content.properties,\r\n\t\tparentIcon = $(div).children(\"[styleType]\")[0],\r\n\t\tfiltersCanvas = _div(null, [['css', 'marginLeft', '10px']]),\r\n\t\tfilterHeader = createFilterHeader(filtersCanvas, elemProperties, parentIcon),\r\n\t\tlayer = nsGmx.gmxMap.layersByID[elemProperties.name],\r\n\t\tlayerStyles = layer.getStyles();\r\n\r\n\tfor (let i = 0; i < layerStyles.length; i++)\r\n\t{\r\n\t\tlet filter = createLoadingFilter(layer, i, elemProperties.styles[i], elemProperties.GeometryType, elemProperties.attributes, parentIcon, (i == openedStyleIndex));\r\n\r\n\t\t_(filtersCanvas, [filter]);\r\n\r\n\t\t$(filter.firstChild).treeview();\r\n\r\n\t\tattachLoadingFilterEvent(filter, layer, i, elemProperties.styles[i], elemProperties.GeometryType, elemProperties.attributes, parentIcon)\r\n\t}\r\n\r\n\tfor (let i = 0; i < filtersCanvas.childNodes.length; i++)\r\n\t\tupdateFilterMoveButtons(filtersCanvas.childNodes[i])\r\n\r\n\t_(divStyles, [filterHeader, filtersCanvas]);\r\n\r\n\tthis.getUpdatedStyles = function() {\r\n\t\treturn updateStyles(filtersCanvas);\r\n\t}\r\n\r\n\tthis.removeColorPickers = function() {\r\n\t\tfor (let i = 0; i < filtersCanvas.childNodes.length; i++)\r\n\t\t\tfiltersCanvas.childNodes[i].removeColorPickers();\r\n\t}\r\n\r\n\tthis.getStyleCount = function() {\r\n\t\treturn filtersCanvas.childNodes.length;\r\n\t}\r\n\r\n\tthis.setAllFilters = function() {\r\n\t\t$(filtersCanvas).find(\"[filterTable]\").each(function()\r\n\t\t{\r\n\t\t\tthis.setFilter();\r\n\t\t})\r\n\t}\r\n}\r\n\r\nconst createStylesDialog = function(elem, treeView, openedStyleIndex) {\r\n\tvar div = $(_queryMapLayers.buildedTree).find(\"div[LayerID='\" + elem.LayerID + \"']\")[0],\r\n\t\telemProperties = div.gmxProperties.content.properties,\r\n\t\tmapName = elemProperties.mapName,\r\n\t\tlayerName = elemProperties.name;\r\n\r\n\tif (typeof window._mapHelper.layerStylesHash[layerName] !== 'undefined') {\r\n\t\treturn;\r\n\t}\r\n\r\n\twindow._mapHelper.layerStylesHash[layerName] = true;\r\n\r\n\tvar pos = nsGmx.Utils.getDialogPos(div, true, 390);\r\n\r\n\tvar updateFunc = function()\r\n\t{\r\n\t\tvar _styles = elemProperties.styles;\r\n\t\telemProperties.styles = styleEditor.getUpdatedStyles();\r\n\r\n\t\tfor (var i = 0; i < elemProperties.styles.length; i++) {\r\n\t\t\tif (_styles[i] && _styles[i]._MinZoom) {\r\n\t\t\t\telemProperties.styles[i]._MinZoom = _styles[i]._MinZoom;\r\n\t\t\t}\r\n\t\t}\r\n\t\ttreeView.findTreeElem(div).elem.content.properties = elemProperties;\r\n\t};\r\n\r\n\tvar attributesHash = {};\r\n\tfor (var i = 0; i < elemProperties.attributes.length; i++) {\r\n\t\tattributesHash[elemProperties.attributes[i]] = [];\r\n\t}\r\n\r\n\t_mapHelper.attrValues[mapName] = _mapHelper.attrValues[mapName] || {};\r\n\t_mapHelper.attrValues[mapName][layerName] = new nsGmx.LazyAttributeValuesProviderFromServer(attributesHash, layerName);\r\n\r\n\tvar closeFunc = function()\r\n\t{\r\n\t\tupdateFunc();\r\n\r\n\t\tvar newStyles = styleEditor.getUpdatedStyles(),\r\n\t\t\tmultiStyleParent = $(div).children('[multiStyle]')[0],\r\n\t\t\tparentIcon = $(div).children(\"[styleType]\")[0];\r\n\r\n\t\tdelete window._mapHelper.layerStylesHash[layerName];\r\n\r\n\t\tstyleEditor.removeColorPickers();\r\n\r\n\t\tvar multiFiltersFlag = (parentIcon.getAttribute('styleType') == 'multi' && styleEditor.getStyleCount() > 1), // было много стилей и осталось\r\n\t\t\tcolorIconFlag = (parentIcon.getAttribute('styleType') == 'color' && styleEditor.getStyleCount() == 1 &&\r\n\t\t\t\t\t\t\t(typeof newStyles[0].RenderStyle.marker != 'undefined') && (typeof newStyles[0].RenderStyle.marker.image == 'undefined')); // была не иконка и осталась\r\n\r\n\t\tif (!multiFiltersFlag && !colorIconFlag) {\r\n\t\t\tvar newIcon = _mapHelper.createStylesEditorIcon(newStyles, elemProperties.GeometryType.toLowerCase());\r\n\r\n\t\t\t$(parentIcon).empty().append(newIcon).attr('styleType', $(newIcon).attr('styleType'));\r\n\r\n\t\t}\r\n\r\n\t\t$(multiStyleParent).empty();\r\n\r\n\t\t_mapHelper.createMultiStyle(elemProperties, treeView, multiStyleParent);\r\n\r\n\t\t// gmxCore.loadModule('TinyMCELoader', 'http://' + window.location.host + window.location.pathname.replace('index.html', '') + 'TinyMCELoader.js', function() {\r\n\t\t// \t$('.balloonEditor', divDialog).each(function() {\r\n\t\t// \t\ttinyMCE.execCommand(\"mceRemoveControl\", true, $(this).attr('id'));\r\n\t\t// \t})\r\n\t\t// })\r\n\r\n\t\t$('.balloonEditor', divDialog).each(function() {\r\n\t\t\ttinyMCE.execCommand(\"mceRemoveControl\", true, $(this).attr('id'));\r\n\t\t});\r\n\r\n\t\treturn false;\r\n\t};\r\n\r\n\tif (div.gmxProperties.content.properties.styles.length == 1) {\r\n\t\topenedStyleIndex = 0;\r\n\t} else if (typeof openedStyleIndex === 'undefined') {\r\n\t\topenedStyleIndex = -1;\r\n\t}\r\n\r\n\tvar styleContainer = _div();\r\n\tvar styleEditor = new LayerStylesEditor(div, styleContainer, openedStyleIndex);\r\n\tstyleEditor.setAllFilters();\r\n\tvar divDialog = showDialog(_gtxt('Стили слоя [value0]', elem.title), styleContainer, 350, 470, pos.left, pos.top, null, function()\r\n\t{\r\n\t\tcloseFunc();\r\n\t\tdelete styleDialogs[elemProperties.name];\r\n\t});\r\n\r\n\tstyleDialogs[elemProperties.name] = {updateFunc: updateFunc};\r\n\r\n\tif (openedStyleIndex > 0)\r\n\t\tstyleContainer.parentNode.scrollTop = 58 + openedStyleIndex * 32;\r\n\r\n\t_mapHelper.updateTinyMCE(styleContainer);\r\n}\r\n\r\nvar styleDialogs = {};\r\nvar updateAllStyles = function() {\r\n\tfor (var name in styleDialogs) {\r\n\t\tstyleDialogs[name].updateFunc();\r\n\t}\r\n}\r\n\r\nwindow.gmxCore.addModule('LayerStylesEditor', {\r\n\t\tLayerStylesEditor: LayerStylesEditor,\r\n\t\tcreateStyleEditor: createStyleEditor,\r\n\t\tcreateStylesDialog: createStylesDialog,\r\n\t\tupdateAllStyles: updateAllStyles\r\n\t}\r\n)\r\n\r\n})(nsGmx.Utils._);\r\n","﻿/** Менеджер дополнительных данных карты. Данные собираются и используются набором сборщиков данных, каждый из которых имеет свой уникальный id.\r\n @class userObjectsManager\r\n @memberOf nsGmx \r\n*/\r\n\r\nimport nsGmx from './nsGmx.js';\r\n\r\nnsGmx.userObjectsManager = {\r\n    _data: {},\r\n    _collectors: {},\r\n    \r\n    /**\r\n     Устанавливает данные, которые потом могут быть использованы поставщиками данных\r\n\t @method\r\n    */\r\n    setData: function(data) {\r\n        this._data = data;\r\n    },\r\n    \r\n    /**\r\n     Возвращает собранные данные\r\n\t @method\r\n    */\r\n    getData: function() {\r\n        return this._data;\r\n    },\r\n    \r\n\t/**\r\n\t Собирает данные со всех сборщиков данных. Собранные данные доступны через метод getData\r\n\t @method\r\n\t*/\r\n    collect: function() {\r\n        for (var id in this._collectors) {\r\n            if ('collect' in this._collectors[id]) {\r\n                var data = this._collectors[id].collect();\r\n                if (data !== null) {\r\n                    this._data[id] = data;\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \r\n    /**\r\n\t Вызывает метод load() у всех поставщиков данных, для которых есть данные.\r\n     После вызова метода данные для данного загрузчика будут удалены (чтобы предотвратить множественную загрузку)\r\n\t @method\r\n\t*/\r\n    load: function(dataCollectorNames) {\r\n        var collectors = {};\r\n        \r\n        if (dataCollectorNames)\r\n        {\r\n            if (typeof dataCollectorNames === 'string')\r\n                dataCollectorNames = [dataCollectorNames];\r\n\r\n            for (var dc = 0; dc < dataCollectorNames.length; dc++)\r\n            {\r\n                var name = dataCollectorNames[dc];\r\n                if (name in this._collectors)\r\n                    collectors[name] = this._collectors[name];\r\n            }\r\n        }\r\n        else\r\n            collectors = this._collectors;\r\n        \r\n        for (var id in collectors) {\r\n            if (id in this._data && 'load' in collectors[id])\r\n            {\r\n                collectors[id].load(this._data[id]);\r\n                delete this._data[id];\r\n            }\r\n        }\r\n    },\r\n    \r\n    /**\r\n\t Добавляет новый сборщик данных. Если в момент добавления есть какие-нибудь данные для загрузчика, они будут ему сразу же переданы\r\n\t @method\r\n     @param collectorId {String} - уникальный идентификатор сборщика данных\r\n     @param collector {Object} - сборщик данных. Должен иметь следующие методы:<br/>\r\n         collect()->Object - возвращает собранные данные. Если данных нет, нужно вернуть null\r\n         load(data)->void - передаёт существующие данные загрузчику\r\n\t*/\r\n    addDataCollector: function( collectorId, collector ) {\r\n        this._collectors[collectorId] = collector;\r\n        if (collectorId in this._data && 'load' in collector)\r\n        {\r\n            collector.load(this._data[collectorId])\r\n            delete this._data[collectorId];\r\n        }\r\n    }\r\n}","//Отображение закладок карты в левой панели\r\nimport nsGmx from './nsGmx.js';\r\nimport { leftMenu } from './menu.js';\r\nimport {\r\n    _div,\r\n    getOwnChildNumber,\r\n    removeDialog,\r\n    showDialog,\r\n} from './utilities.js';\r\nimport './userObjects.js';\r\n\r\n//TODO: сделать глобально доступным\r\nnsGmx.Controls = nsGmx.Controls || {};\r\nnsGmx.Controls.LanguageSelector = function(container) {\r\n\r\n    var LANGUAGES = [\r\n            {lang: 'rus', title: 'rus'},\r\n            {lang: 'eng', title: 'eng'}\r\n        ],\r\n        lang = null,\r\n        _this = this;\r\n\r\n    var template = Handlebars.compile('<div class = \"language-container\">' +\r\n        '{{#langs}}' +\r\n            '<span data-lang = \"{{lang}}\" class=\"language-item\">{{title}}</span>' +\r\n        '{{/langs}}' +\r\n    '</div>');\r\n\r\n    $(container).empty().append($(template({langs: LANGUAGES})));\r\n\r\n    var update = function() {\r\n        var newLang = $(this).data('lang'),\r\n            prevLang = lang;\r\n\r\n        if (newLang !== prevLang) {\r\n            lang = newLang;\r\n            $(this).addClass('language-selected')\r\n                .siblings().removeClass('language-selected');\r\n            $(_this).trigger('change', [prevLang, newLang]);\r\n        }\r\n    }\r\n\r\n    $(container).find('span').click(update);\r\n    update.bind($(container).find('span')[0])();\r\n\r\n    this.getLang = function() {return lang;};\r\n}\r\n\r\nvar queryTabs = function()\r\n{\r\n    this.builded = false;\r\n\r\n    this.tabsCanvas = null;\r\n\r\n    this.tabs = [];\r\n}\r\n\r\nqueryTabs.prototype = new leftMenu();\r\n\r\nqueryTabs.prototype.load = function()\r\n{\r\n    if (!this.builded)\r\n    {\r\n        var _this = this;\r\n        this.tabsCanvas = _div(null, [['dir','className','tabsCanvas']])\r\n\r\n        this.workCanvas.appendChild(this.tabsCanvas);\r\n\r\n        for (var i = 0; i < this.tabs.length; i++)\r\n            this.draw(this.tabs[i]);\r\n\r\n        this.builded = true;\r\n\r\n        $(this.tabsCanvas).sortable({\r\n            axis: 'y',\r\n            tolerance: 'pointer',\r\n            containment: 'parent'\r\n        });\r\n        $(this.tabsCanvas).bind('sortupdate', function()\r\n        {\r\n            var orderedTabs = [];\r\n            $(_this.tabsCanvas).children().each(function()\r\n            {\r\n                orderedTabs.push(this.tabInfo);\r\n            })\r\n\r\n            _this.tabs = orderedTabs;\r\n        });\r\n\r\n        this.leftPanelItem.hide();\r\n    }\r\n}\r\n\r\nqueryTabs.prototype.add = function(tabInfo, tabIndex)\r\n{\r\n    var isNew = typeof tabIndex === 'undefined';\r\n    tabInfo = tabInfo || {\r\n        name_rus: '',\r\n        description_rus: '',\r\n        name_eng: '',\r\n        description_eng: ''\r\n    };\r\n\r\n    if (typeof tabInfo.name_rus === 'undefined') {\r\n        tabInfo.name_rus = tabInfo.name;\r\n    }\r\n\r\n    if (typeof tabInfo.description_rus === 'undefined') {\r\n        tabInfo.description_rus = tabInfo.description;\r\n    }\r\n\r\n    var uiTemplate = Handlebars.compile(\r\n        '<div class = \"addtabs-container\">' +\r\n            '<div class = \"addtabs-info\">{{i \"Название\"}}</div>' +\r\n            '<input class = \"addtabs-title-input inputStyle\" value=\"{{title}}\"><br>' +\r\n            '<div class = \"addtabs-info\">{{i \"Описание\"}}</div>' +\r\n            '<textarea class = \"addtabs-title-description inputStyle\">{{description}}</textarea><br>' +\r\n            '<button class = \"addtabs-create\">{{buttonTitle}}</button>' +\r\n            '<div class = \"addtabs-lang-placeholder\"></div>' +\r\n        '</div>');\r\n\r\n    var titleLoc = {rus: tabInfo.name_rus, eng: tabInfo.name_eng};\r\n    var descrLoc = {rus: tabInfo.description_rus, eng: tabInfo.description_eng};\r\n    var ui = $(uiTemplate({\r\n            title: titleLoc.rus,\r\n            description: descrLoc.rus,\r\n            buttonTitle: isNew ? _gtxt('Создать') : _gtxt('Изменить')\r\n        })),\r\n        titleInput = $('.addtabs-title-input', ui);\r\n\r\n    var updateDataLoc = function(lang) {\r\n        titleLoc[lang] = titleInput.val();\r\n        descrLoc[lang] = $('.addtabs-title-description', ui).val();\r\n    }\r\n\r\n    var langControl = new nsGmx.Controls.LanguageSelector(ui.find('.addtabs-lang-placeholder'));\r\n    $(langControl).change(function(event, prevLang, newLang) {\r\n        updateDataLoc(prevLang);\r\n        titleInput.val(titleLoc[newLang]);\r\n        $('.addtabs-title-description', ui).val(descrLoc[newLang]);\r\n    })\r\n\r\n    titleInput.keyup(function(e) {\r\n        $(this).toggleClass('error', this.value == '');\r\n\r\n        if (e.keyCode == 13)\r\n        {\r\n            createTab();\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    });\r\n\r\n    titleInput.focus();\r\n\r\n    var createTab = function() {\r\n            updateDataLoc(langControl.getLang());\r\n            var mapState = window._mapHelper.getMapState(),\r\n                tab = {\r\n                    name: titleLoc.rus || titleLoc.eng,\r\n                    description: descrLoc.rus || descrLoc.eng,\r\n\r\n                    name_rus: titleLoc.rus,\r\n                    description_rus: descrLoc.rus,\r\n                    name_eng: titleLoc.eng,\r\n                    description_eng: descrLoc.eng,\r\n\r\n                    state: mapState\r\n                };\r\n\r\n            if (isNew) {\r\n            _this.tabs.push(tab);\r\n            } else {\r\n                _this.tabs[tabIndex] = tab;\r\n            }\r\n            _this.draw(tab, tabIndex);\r\n\r\n            removeDialog(dialogDiv);\r\n        },\r\n        _this = this;\r\n\r\n    $('.addtabs-create', ui).click(createTab);\r\n\r\n    var dialogDiv = showDialog(_gtxt(\"Имя закладки\"), ui[0], 280, 230, false, false);\r\n}\r\n\r\nqueryTabs.prototype.draw = function (tabInfo, tabIndex)\r\n{\r\n    var selectValLoc = function(paramName) {\r\n        var lang = nsGmx.Translations.getLanguage();\r\n        return tabInfo[paramName + '_' + lang] || tabInfo[paramName];\r\n    }\r\n\r\n    var tmpl = Handlebars.compile('<div class=\"canvas\">' +\r\n        '<div class=\"buttonLink tabName\" title=\"{{description}}\">{{name}}</div>' +\r\n        '<div class=\"gmx-icon-edit\"></div>' +\r\n        '<div class=\"gmx-icon-close\"></div>' +\r\n    '</div>');\r\n\r\n    var canvas = $(tmpl({\r\n            name: selectValLoc('name'),\r\n            description: selectValLoc('description')\r\n        }))[0];\r\n    var _this = this;\r\n\r\n    canvas.tabInfo = tabInfo;\r\n\r\n    $('.tabName', canvas).click(this.show.bind(this, tabInfo.state));\r\n\r\n    $('.gmx-icon-close', canvas).click(function() {\r\n        var index = getOwnChildNumber(canvas);\r\n\r\n        _this.tabs.splice(index, 1);\r\n\r\n        canvas.removeNode(true);\r\n    })\r\n\r\n    $('.gmx-icon-edit', canvas).click(function() {\r\n        var index = getOwnChildNumber(canvas);\r\n        _this.add(_this.tabs[index], index);\r\n    }).toggle(_queryMapLayers.currentMapRights() === \"edit\");\r\n\r\n    if (typeof tabIndex === 'undefined') {\r\n        $(this.tabsCanvas).append(canvas);\r\n    } else {\r\n        $(this.tabsCanvas).find('.canvas').eq(tabIndex).replaceWith(canvas);\r\n    }\r\n}\r\n\r\nqueryTabs.prototype.show = function(state)\r\n{\r\n    var parsedState = {},\r\n        lmap = nsGmx.leafletMap,\r\n        gmxDrawing = lmap.gmxDrawing;\r\n\r\n    $.extend(true, parsedState, state);\r\n    var pos = parsedState.position;\r\n\r\n    lmap.setView(L.Projection.Mercator.unproject(L.point(pos.x, pos.y)), 17 - pos.z);\r\n\r\n    for (let i = 0; i < state.drawnObjects.length; i++)\r\n    {\r\n        parsedState.drawnObjects[i].geometry = L.gmxUtil.geometryToGeoJSON(state.drawnObjects[i].geometry, true);\r\n    }\r\n\r\n    lmap.gmxBaseLayersManager.setCurrentID(lmap.gmxBaseLayersManager.getIDByAlias(parsedState.mode));\r\n\r\n    //удаляем все фичи\r\n    gmxDrawing.getFeatures().slice(0).forEach(gmxDrawing.remove.bind(gmxDrawing));\r\n\r\n    for (let i = 0; i < parsedState.drawnObjects.length; i++)\r\n    {\r\n        //старый формат - число, новый - строка\r\n        var rawColor = parsedState.drawnObjects[i].color,\r\n            color = (typeof rawColor === 'number' ? '#' + L.gmxUtil.dec2hex(rawColor) : rawColor) || '#0000FF',\r\n            thickness = parsedState.drawnObjects[i].thickness || 2,\r\n            opacity = parsedState.drawnObjects[i].opacity || 80;\r\n\r\n        gmxDrawing.addGeoJSON(parsedState.drawnObjects[i].geometry, {\r\n            lineStyle: {\r\n                color: color,\r\n                weight: thickness,\r\n                opacity: opacity/100\r\n            }\r\n        });\r\n    }\r\n\r\n    _queryMapLayers.applyState(parsedState.condition, parsedState.mapStyles);\r\n\r\n    if (typeof parsedState.customParamsCollection !== 'undefined')\r\n        window._mapHelper.customParamsManager.loadParams(parsedState.customParamsCollection);\r\n\r\n    if (parsedState.openPopups) {\r\n        for (var l in parsedState.openPopups) {\r\n            var layer = nsGmx.gmxMap.layersByID[l];\r\n            if (layer && layer.addPopup) {\r\n                parsedState.openPopups[l].forEach(layer.addPopup.bind(layer));\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar _queryTabs = new queryTabs();\r\n\r\nnsGmx.userObjectsManager.addDataCollector('tabs', {\r\n    collect: function()\r\n    {\r\n        if (!_queryTabs.tabs.length)\r\n            return null;\r\n\r\n        var tabs = [];\r\n\r\n        for (var i = 0; i < _queryTabs.tabs.length; i++)\r\n        {\r\n            var tab = {};\r\n\r\n            $.extend(tab, _queryTabs.tabs[i]);\r\n\r\n            tabs.push(tab);\r\n        }\r\n\r\n        return tabs;\r\n    },\r\n    load: function(data)\r\n    {\r\n        if (!data || !data.length)\r\n            return;\r\n\r\n        $('#left_mapTabs').remove();\r\n\r\n        _queryTabs.builded = false;\r\n        _queryTabs.tabs = data;\r\n\r\n        window.mapHelp.tabs.load('mapTabs');\r\n    }\r\n})\r\n\r\nexport default _queryTabs;","import nsGmx from './nsGmx.js';\r\nimport {\r\n    _div,\r\n    _img,\r\n    _input,\r\n    inputError,\r\n    makeButton,\r\n    makeLinkButton, showErrorMessage,\r\n    _t,\r\n    _table,\r\n    _tbody,\r\n    _tr,\r\n    _td,\r\n} from './utilities.js';\r\nimport {leftMenu} from './menu.js';\r\n\r\n//Загрузка и отображение дополнительных карт в левой панели\r\n(function(_) {\r\n\r\nvar queryExternalMaps = function()\r\n{\r\n\tthis.maps = [];\r\n\tthis.loadedMaps = {};\r\n}\r\n\r\nqueryExternalMaps.prototype = new leftMenu();\r\n\r\nqueryExternalMaps.prototype.load = function()\r\n{\r\n\tif (!this.builded)\r\n\t{\r\n\t\tvar hostButton = _input(null, [['dir','className','inputStyle'],['css','width','200px']]),\r\n\t\t\tnameButton = _input(null, [['dir','className','inputStyle'],['css','width','200px']]),\r\n\t\t\tloadButton = makeButton(_gtxt(\"Загрузить\")),\r\n\t\t\taddMap = makeLinkButton(_gtxt(\"Добавить карту\")),\r\n\t\t\tparamsTable = _table([_tbody([_tr([_td([_t(_gtxt(\"Хост\"))],[['css','colSpan',2],['css','paddingTop','3px']])]),\r\n\t\t\t\t\t\t\t\t\t\t\t_tr([_td([hostButton]), _td()]),\r\n\t\t\t\t\t\t\t\t\t\t\t_tr([_td([_t(_gtxt(\"Имя\"))],[['css','colSpan',2]])]),\r\n\t\t\t\t\t\t\t\t\t\t\t_tr([_td([nameButton]), _td([loadButton])])])],[['css','margin','3px 0px 0px 10px']]),\r\n\t\t\t_this = this;\r\n\r\n\t\t_(this.workCanvas, [_div([addMap],[['css','margin','5px 0px 5px 10px']]), paramsTable]);\r\n\r\n\t\tparamsTable.style.display = 'none';\r\n\r\n\t\thostButton.value = window.serverBase;\r\n\r\n\t\taddMap.onclick = function()\r\n\t\t{\r\n\t\t\tif (paramsTable.style.display == 'none')\r\n\t\t\t\tparamsTable.style.display = '';\r\n\t\t\telse\r\n\t\t\t\tparamsTable.style.display = 'none';\r\n\t\t}\r\n\r\n\t\tloadButton.onclick = function()\r\n\t\t{\r\n\t\t\tif (hostButton.value == '')\r\n\t\t\t\tinputError(hostButton);\r\n\r\n\t\t\tif (nameButton.value == '')\r\n\t\t\t\tinputError(nameButton);\r\n\r\n\t\t\tif (hostButton.value == '' || nameButton.value == '')\r\n\t\t\t\treturn;\r\n\r\n\t\t\t_this.addMapElem(hostButton.value, nameButton.value);\r\n\r\n\t\t\tnameButton.value = '';\r\n\t\t}\r\n\r\n\t\tthis.mapsCanvas = _div(null,[['dir','className','drawingObjectsCanvas externalMapsCanvas'],['css','paddingLeft','0px'], ['attr', 'id', 'externalMapsCanvas']]);\r\n\r\n\t\t_(this.workCanvas, [this.mapsCanvas]);\r\n\r\n\t\tthis.builded = true;\r\n\r\n\t\tfor (var i = 0; i < this.maps.length; ++i)\r\n\t\t\tthis.addMapElem(this.maps[i].hostName, this.maps[i].mapName, true);\r\n\t}\r\n}\r\n\r\nqueryExternalMaps.prototype.addMapElem = function(hostName, mapName, silent)\r\n{\r\n    this.createWorkCanvas('externalMaps');\r\n    this.load();\r\n\r\n\tvar mapElem = _div(),\r\n\t\tdiv = _div(null, [['css','position','relative'],['css','margin','2px 0px 2px 14px']]),\r\n\t\tremove = $('<div class=\"gmx-icon-close\"></div>'),\r\n        mapInfo,\r\n        _this = this;\r\n\r\n    for (var i = 0; i < this.maps.length; i++) {\r\n        var map = this.maps[i];\r\n        if (map.hostName === hostName && map.mapName === mapName) {\r\n            if (map.container) {\r\n                return;\r\n            }\r\n            mapInfo = map;\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!mapInfo) {\r\n        mapInfo = {\r\n            hostName: hostName,\r\n            mapName: mapName\r\n        }\r\n        this.maps.push(mapInfo);\r\n    }\r\n\r\n    mapInfo.container = div\r\n\r\n\tdiv.hostName = hostName;\r\n\tdiv.mapName = mapName;\r\n\r\n\t_(div, [mapElem, remove[0]]);\r\n\t_(this.mapsCanvas, [div]);\r\n\r\n\tthis.addMap(hostName, mapName, mapElem, silent);\r\n\r\n\tremove.click(function()\r\n\t{\r\n\t\tdiv.removeNode(true);\r\n\r\n\t\tif (!mapElem.extLayersTree)\r\n\t\t\treturn;\r\n\r\n\t\tmapElem.extLayersTree.treeModel.forEachLayer(function(layer)\r\n\t\t{\r\n\t\t\tvar name = layer.properties.name;\r\n\r\n\t\t\tif (nsGmx.layersByID[name].external)\r\n\t\t\t\t_queryMapLayers.removeLayer(name);\r\n\t\t});\r\n\r\n        for (var i = 0; i < _this.maps.length; i++) {\r\n            var map = _this.maps[i];\r\n            if (map.hostName === hostName && map.mapName === mapName) {\r\n                _this.maps.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\t})\r\n}\r\n\r\nqueryExternalMaps.prototype.addMap = function(hostName, mapName, parent, silent)\r\n{\r\n\tvar loading = _div([_img(null, [['attr','src','img/progress.gif'],['css','marginRight','10px'],['css','width','16px'],['css','height','16px']]), _t(_gtxt('загрузка...'))], [['css','margin','3px 0px 3px 20px']]);\r\n\t// var _this = this;\r\n\r\n\t_(parent, [loading]);\r\n\r\n\tthis.loadMap(hostName, mapName, function(gmxMap)\r\n\t{\r\n\t\tif (gmxMap == null)\r\n\t\t{\r\n\t\t\tloading.parentNode.parentNode.removeNode(true);\r\n\r\n\t\t\tsilent || showErrorMessage(_gtxt(\"Невозможно загрузить карту [value0] с домена [value1]\", mapName, hostName), true);\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n        var extLayersTree = new window.layersTree({showVisibilityCheckbox: true, allowActive: false, allowDblClick: true});\r\n\r\n\t\tvar\ttree = extLayersTree.drawTree(gmxMap.rawTree, 2);\r\n\t\t$(tree).treeview();\r\n\t\textLayersTree.runLoadingFuncs();\r\n\r\n\t\tloading.removeNode(true);\r\n\t\t_(parent, [tree]);\r\n\r\n        //добавляем перетаскивание в основную карту только если доп. карта с того же домена\r\n        if ( hostName === _layersTree.treeModel.getMapProperties().hostName )\r\n            _queryMapLayers.addDraggable(parent);\r\n\r\n\t\tparent.extLayersTree = extLayersTree;\r\n\t});\r\n}\r\n\r\nqueryExternalMaps.prototype.loadMap = function(hostName, mapName, callback)\r\n{\r\n    var _this = this;\r\n\tL.gmx.loadMap(mapName, {\r\n        hostName: hostName,\r\n        leafletMap: nsGmx.leafletMap,\r\n        apiKey: window.apiKey,\r\n        srs: nsGmx.leafletMap.options.srs || '',\r\n        isGeneralized: window.mapOptions && 'isGeneralized' in window.mapOptions ? window.mapOptions.isGeneralized : true,\r\n        skipTiles: nsGmx.leafletMap.options.skipTiles || ''\r\n    }).then(function(gmxMap)\r\n\t{\r\n        for (let i = 0; i < gmxMap.layers.length; i++) {\r\n            let layer = gmxMap.layers[i];\r\n            let id = layer.getGmxProperties().name;\r\n\r\n            layer.external = true;\r\n\r\n            if (!(id in nsGmx.gmxMap.layersByID)) {\r\n                nsGmx.gmxMap.addLayer(layer);\r\n            }\r\n        }\r\n\r\n        if (gmxMap.properties.Copyright)\r\n        {\r\n            var copyrightLayer = {\r\n                options: {\r\n                    attribution: gmxMap.properties.Copyright\r\n                },\r\n                onAdd: function() {},\r\n                onRemove: function() {}\r\n            };\r\n\r\n            copyrightLayer.addTo(nsGmx.leafletMap);\r\n        }\r\n\r\n        gmxMap.properties.hostName = hostName;\r\n\r\n        callback(gmxMap);\r\n        $(_queryExternalMaps).triggerHandler('map_loaded', gmxMap);\r\n\r\n        for (let i = 0; i < _this.maps.length; i++) {\r\n            let map = _this.maps[i];\r\n            if (map.hostName === hostName && map.mapName === mapName) {\r\n                map.tree = gmxMap.layers;\r\n                break;\r\n            }\r\n        }\r\n\t},\r\n\tfunction()\r\n\t{\r\n\t\tcallback(null);\r\n\t\t$(_queryExternalMaps).triggerHandler('map_loaded', null);\r\n\t});\r\n}\r\n\r\nvar _queryExternalMaps = new queryExternalMaps();\r\nwindow._queryExternalMaps = _queryExternalMaps;\r\n\r\nnsGmx.userObjectsManager.addDataCollector('externalMaps', {\r\n    collect: function()\r\n    {\r\n        if (!_queryExternalMaps.workCanvas)\r\n            return;\r\n\r\n        var value = [];\r\n\r\n        $(_queryExternalMaps.workCanvas.lastChild).children(\"div\").each(function()\r\n        {\r\n            value.push({hostName:this.hostName, mapName:this.mapName})\r\n        })\r\n\r\n        if (!value.length)\r\n            return null;\r\n\r\n        return value;\r\n    },\r\n    load: function(data)\r\n    {\r\n        if (!data || !data.length)\r\n            return;\r\n\r\n        $('#left_externalMaps').remove();\r\n\r\n        _queryExternalMaps.builded = false;\r\n        _queryExternalMaps.maps = data;\r\n\r\n        window.mapHelp.externalMaps.load('externalMaps');\r\n    }\r\n});\r\n\r\n})(nsGmx.Utils._);\r\n","import nsGmx from './nsGmx.js';\r\nimport './translations.js';\r\nimport {leftMenu} from './menu.js';\r\nimport {  \r\n    _br,  \r\n    _div,\r\n    hide,\r\n    _img,\r\n    _input,\r\n    makeLinkButton,\r\n    show,    \r\n    showDialog,\r\n    showErrorMessage,\r\n    _span,\r\n    _t,\r\n    _table,\r\n    _tbody,    \r\n    _td,\r\n    _tr,\r\n\t_title,\t\r\n} from './utilities.js';\r\n\r\nconst _ = nsGmx.Utils._;\r\n\r\n/**\r\n* @namespace DrawingObjects\r\n* @description SDK для редактирования объектов на карте\r\n*/\r\nnsGmx.Translations.addText('rus', {\r\n    drawingObjects: {\r\n        editStyleTitle: 'Редактировать стиль',\r\n        removeObject: 'Удалить',\r\n        pointTitle: 'точка',\r\n        lineTitle: 'линия',\r\n        polygonTitle: 'многоугольник',\r\n        rectangleTitle: 'прямоугольник',\r\n        removeAll: 'Очистить',\r\n        downloadShp: 'shp',\r\n        downloadGeoJSON: 'geojson',\r\n        downloadGpx: 'gpx',\r\n        downloadCsv: 'csv',\r\n        downloadNameTitle: 'Введите имя файла для скачивания',\r\n        download: 'Скачать файл',\r\n        downloadRaster: 'Скачать фрагмент растра',\r\n        noRectangleError: 'Выберите область рамкой на карте',\r\n        noRasterError: 'К прямоугольнику не подходит ни одного растрового слоя',\r\n\r\n        edit: {\r\n            border: 'Граница',\r\n            color: 'Цвет',\r\n            transparency: 'Прозрачность',\r\n            lineWidth: 'Толщина линии',\r\n            description: 'Описание',\r\n            title: 'Редактирование стиля объекта'\r\n        }\r\n    }\r\n})\r\n\r\nnsGmx.Translations.addText('eng', {\r\n    drawingObjects: {\r\n        editStyleTitle: 'Edit style',\r\n        removeObject: 'Delete',\r\n        pointTitle: 'point',\r\n        lineTitle: 'line',\r\n        polygonTitle: 'polygon',\r\n        rectangleTitle: 'rectangle',\r\n        removeAll: 'Delete',\r\n        downloadShp: 'shp',\r\n        downloadGeoJSON: 'geojson',\r\n        downloadGpx: 'gpx',\r\n        downloadCsv: 'csv',\r\n        downloadNameTitle: 'Enter file name to download',\r\n        download: 'Download file',\r\n        downloadRaster: 'Download fragment of raster',\r\n        noRectangleError: 'Select region using frame',\r\n        noRasterError: 'No one raster layer fit the rectangle',\r\n\r\n        edit: {\r\n            border: 'Outline',\r\n            color: 'Color',\r\n            transparency: 'Transparency',\r\n            lineWidth: 'Line thickness',\r\n            description: 'Description',\r\n            title: 'Object style editing'\r\n        }\r\n    }\r\n});\r\n\r\nvar setDrawingFeatureStyle = function(drawingFeature, templateStyle) {\r\n    var color = '#' + L.gmxUtil.dec2hex(templateStyle.outline.color),\r\n        opacity = templateStyle.outline.opacity/100;\r\n    drawingFeature.setOptions({\r\n        lineStyle: {\r\n            color: color,\r\n            opacity: opacity,\r\n            weight: templateStyle.outline.thickness\r\n        },\r\n        pointStyle: {\r\n            color: color,\r\n            opacity: opacity\r\n        }\r\n    });\r\n}\r\n\r\nvar CreateDrawingStylesEditorIcon = function(style, type)\r\n{\r\n\tvar icon = nsGmx.Controls.createGeometryIcon(style, type);\r\n\r\n\t_title(icon, _gtxt('drawingObjects.editStyleTitle'));\r\n\r\n\treturn icon;\r\n}\r\n\r\nvar CreateDrawingStylesEditor = function(parentObject, style, elemCanvas)\r\n{\r\n\tvar templateStyle = {};\r\n    var jQueryDialog = null;\r\n\r\n\t$.extend(true, templateStyle, style);\r\n\r\n\telemCanvas.onclick = function()\r\n\t{\r\n        if (jQueryDialog) {\r\n            return;\r\n        }\r\n\t\tvar canvas = _div(null,[['css','marginTop','10px']]),\r\n\t\t\toutlineParent = _tr(),\r\n\t\t\toutlineTitleTds = [],\r\n\t\t\toutlineTds = [];\r\n\r\n\t\toutlineTitleTds.push(_td([_t(_gtxt('drawingObjects.edit.border'))],[['css','width','70px']]));\r\n\r\n\t\tvar outlineColor = nsGmx.Controls.createColorPicker(templateStyle.outline.color,\r\n\t\t\tfunction (colpkr){\r\n\t\t\t\t$(colpkr).fadeIn(500);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tfunction (colpkr){\r\n\t\t\t\t$(colpkr).fadeOut(500);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tfunction (hsb, hex) {\r\n\t\t\t\toutlineColor.style.backgroundColor = '#' + hex;\r\n\r\n\t\t\t\ttemplateStyle.outline.color = outlineColor.hex = parseInt('0x' + hex);\r\n\r\n\t\t\t\t$(elemCanvas).find(\".borderIcon\")[0].style.borderColor = '#' + hex;\r\n\r\n\t\t\t\tsetDrawingFeatureStyle(parentObject, templateStyle);\r\n\t\t\t});\r\n\r\n\t\toutlineColor.hex = templateStyle.outline.color;\r\n\r\n\t\t_title(outlineColor, _gtxt('drawingObjects.edit.color'));\r\n\r\n\t\toutlineTds.push(_td([outlineColor],[['css','width','40px']]));\r\n\r\n\t\tvar divSlider = nsGmx.Controls.createSlider(templateStyle.outline.opacity,\r\n\t\t\t\tfunction(event, ui)\r\n\t\t\t\t{\r\n\t\t\t\t\ttemplateStyle.outline.opacity = ui.value;\r\n\r\n                    setDrawingFeatureStyle(parentObject, templateStyle);\r\n\t\t\t\t})\r\n\r\n\t\t_title(divSlider, _gtxt('drawingObjects.edit.transparency'));\r\n\r\n\t\toutlineTds.push(_td([divSlider],[['css','width','100px'],['css','padding','4px 5px 3px 5px']]));\r\n\r\n\t\tvar outlineThick = nsGmx.Controls.createInput((templateStyle.outline && typeof templateStyle.outline.thickness != 'undefined') ? templateStyle.outline.thickness : 2,\r\n\t\t\t\tfunction()\r\n\t\t\t\t{\r\n\t\t\t\t\ttemplateStyle.outline.thickness = Number(this.value);\r\n\r\n                    setDrawingFeatureStyle(parentObject, templateStyle);\r\n\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}),\r\n\t\t\tcloseFunc = function()\r\n\t\t\t{\r\n\t\t\t\tvar newIcon = CreateDrawingStylesEditorIcon(templateStyle, parentObject.toGeoJSON().geometry.type.toLowerCase());\r\n\t\t\t\tCreateDrawingStylesEditor(parentObject, templateStyle, newIcon);\r\n\r\n\t\t\t\t$(elemCanvas).replaceWith(newIcon);\r\n\r\n\t\t\t\t$(canvas).find(\".colorSelector\").each(function()\r\n\t\t\t\t{\r\n\t\t\t\t\t$('#' + $(this).data(\"colorpickerId\")).remove();\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t_title(outlineThick, _gtxt('drawingObjects.edit.lineWidth'));\r\n\r\n\t\toutlineTds.push(_td([outlineThick],[['css','width','30px']]));\r\n\r\n\t\t_(outlineParent, outlineTitleTds.concat(_td([_div([_table([_tbody([_tr(outlineTds)])])],[['attr','fade',true]])])));\r\n\r\n\t\tvar text = _input(null, [['attr','value', parentObject.options.title || \"\"],['dir','className','inputStyle'],['css','width','180px']]);\r\n\t\t$(text).on('keyup', function(evt)\r\n\t\t{\r\n            if (evt.keyCode === 13)\r\n            {\r\n                $(jQueryDialog).dialog('destroy');\r\n                return;\r\n            }\r\n\r\n            parentObject.setOptions({title: this.value});\r\n\r\n\t\t\t$(parentObject).triggerHandler('onEdit', [parentObject]);\r\n\r\n\t\t\treturn true;\r\n\t\t})\r\n\r\n\t\t_(canvas, [_table([_tbody([_tr([_td([_t(_gtxt('drawingObjects.edit.description'))], [['css','width','70px']]), _td([text])])])]), _br(), _table([_tbody([outlineParent])])])\r\n\r\n\t\tvar pos = nsGmx.Utils.getDialogPos(elemCanvas, false, 80);\r\n\t\tjQueryDialog = showDialog(_gtxt('drawingObjects.edit.title'), canvas, 280, 130, pos.left, pos.top, false, closeFunc);\r\n\r\n        $(jQueryDialog).addClass('drawing-object-leaflet-id-' + parentObject._leaflet_id);\r\n\t}\r\n\r\n\telemCanvas.getStyle = function()\r\n\t{\r\n\t\treturn templateStyle;\r\n\t}\r\n}\r\n\r\n/** Конструктор\r\n @class Коллекция нарисованных объектов\r\n @memberOf DrawingObjects\r\n @param oInitMap Карта, из которой будут добавляться объекты в коллекцию\r\n*/\r\nvar DrawingObjectCollection = function() {\r\n\tvar _objects = []; //{item:, editID: , removeID: }\r\n\tvar _this = this;    \r\n\r\n\tvar onEdit = function(drawingObject) {\r\n\t\t/** Вызывается при изменении объекта в коллекции\r\n\t\t@name DrawingObjects.DrawingObjectCollection.onEdit\r\n\t\t@event\r\n\t\t@param {drawingObject} drawingObject изменённый объект*/\r\n\t\t$(_this).triggerHandler('onEdit', [drawingObject]);\r\n\t}\r\n\r\n\tvar onRemove = function(drawingObject) {\r\n\t\t_this.Remove(drawingObject);\r\n\t}\r\n\r\n\t/** Возвращает элемент по номеру\r\n\t@param {int} index № объекта в коллекции*/\r\n\tthis.Item = function(index){\r\n\t\treturn _objects[index].item;\r\n\t}\r\n\r\n\t/** Возвращает количество элементов в коллекции*/\r\n\tthis.Count = function(){\r\n\t\treturn _objects.length;\r\n\t}\r\n\r\n\t/** Добавляет объект в коллекцию\r\n\t@param {drawingObject} drawingObject Добавляемый объект*/\r\n\tthis.Add = function(drawingObject){\r\n\r\n        var editID = drawingObject.on('edit', function() {\r\n            onEdit(drawingObject);\r\n        });\r\n\r\n        var removeID = drawingObject.on('remove', function() {\r\n            onRemove(drawingObject);\r\n        });\r\n\r\n\t\t_objects.push({\r\n            item: drawingObject,\r\n            editID: editID,\r\n            removeID: removeID\r\n        });\r\n\r\n\t\t/** Вызывается при добавлении объекта в коллекцию\r\n\t\t@name DrawingObjects.DrawingObjectCollection.onAdd\r\n\t\t@event\r\n\t\t@param {drawingObject} drawingObject добавленный объект*/\r\n\t\t$(this).triggerHandler('onAdd', [drawingObject]);\r\n\t};\r\n\r\n\t/** Удаляет объект из коллекции\r\n\t@param {int} index индекс удаляемого объекта*/\r\n\tthis.RemoveAt = function(index){\t\t\r\n\t\t/** Вызывается при удалении объекта из коллекции\r\n\t\t@name DrawingObjects.DrawingObjectCollection.onRemove\r\n\t\t@event\r\n\t\t@param {int} index индекс удаляённого объекта*/\r\n\t\t$(this).triggerHandler('onRemove', [index]);\r\n\t};\r\n\r\n\t/** Удаляет объект из коллекции\r\n\t@param {drawingObject} drawingObject удаляемый объект*/\r\n\tthis.Remove = function(drawingObject){\r\n\t\tfor (var i=0; i<_objects.length; i++){\r\n\t\t\tif (_objects[i].item === drawingObject) this.RemoveAt(i);\r\n\t\t}\r\n\t}\r\n\r\n    /** Получить индекс объекта в коллекции. null, если объект не найден\r\n\t@param {drawingObject} drawingObject объект, индекс которого мы хотим найти*/\r\n\tthis.getIndex = function(drawingObject){\r\n\t\tfor (var i=0; i<_objects.length; i++){\r\n\t\t\tif (_objects[i].item === drawingObject) return i;\r\n\t\t}\r\n\r\n        return null;\r\n\t}\r\n}\r\n\r\n/** Конструктор\r\n @class Строка с описанием объекта и ссылкой на него\r\n @description К строке биндится контекстное меню типа \"DrawingObject\"\r\n @memberOf DrawingObjects\r\n @param {L.Map} oInitMap Карта Leaflet\r\n @param oInitContainer Объект, в котором находится контрол (div)\r\n @param drawingObject Объект для добавления на карту\r\n @param options дополнительные параметры\r\n @param {bool} [options.allowDelete=true] рисовать ли крестик удаления объекта\r\n @param {bool} [options.editStyle=true] нужна ли возможность редактировать стили\r\n @param {function(DrawingObject)} [options.click] ф-ция, которая будет вызвана при клике на объекте.\r\n        По умолчанию - центрирование карты на объекте.\r\n*/\r\nvar DrawingObjectInfoRow = function(oInitMap, oInitContainer, drawingObject, options) {\r\n    var defaultClickFunction = function(obj) {\r\n        var geom = obj.toGeoJSON().geometry;\r\n        var coords = geom.coordinates;\r\n\t\tif (geom.type == \"Point\") {\r\n            _map.setView([coords[1], coords[0]], Math.max(14, _map.getZoom()));\r\n        } else {\r\n            _map.fitBounds(drawingObject.getBounds());\r\n        }\r\n    }\r\n\r\n    var _options = $.extend({\r\n        allowDelete: true,\r\n        editStyle: true,\r\n        click: defaultClickFunction\r\n    }, options);\r\n\r\n\tvar _drawingObject = drawingObject;\r\n\tvar _this = this;\r\n\tvar _map = oInitMap;\r\n\r\n\tvar _canvas = _div(null, [['dir','className','drawingObjectsItemCanvas']]);\r\n\tvar _title = _span(null, [['dir','className','drawingObjectsItemTitle']]);\r\n\tvar _text = _span(null, [['dir','className', 'drawingObjectsItemTitle']]);\r\n\tvar _summary = _span(null, [['dir','className','summary']]);\r\n\r\n    if (_options.click) {\r\n        _canvas.onclick = function(e) {\r\n            if (e.target !== remove && (!_options.editStyle || e.target !== icon)) {\r\n                _options.click(_drawingObject);\r\n            }\r\n        };\r\n    }\r\n\r\n    var lineOptions = _drawingObject.options.lineStyle || L.GmxDrawing.utils.defaultStyles.lineStyle;\r\n\r\n\tvar icon = null;\r\n\r\n    var geom = _drawingObject.toGeoJSON().geometry;\r\n    if (_options.editStyle)\r\n    {\r\n        if (geom.type == \"Point\")\r\n        {\r\n            icon = _img(null, [['attr','src', (window.gmxJSHost || '') + 'img/flag_min.png'], ['dir', 'className', 'colorIcon']])\r\n        }\r\n        else\r\n        {\r\n            var regularDrawingStyle = {\r\n                outline: {\r\n                    color: parseInt('0x' + lineOptions.color.split('#')[1]),\r\n                    thickness: lineOptions.weight,\r\n                    opacity: lineOptions.opacity * 100\r\n                }\r\n            };\r\n\r\n            icon = CreateDrawingStylesEditorIcon(regularDrawingStyle, geom.type.toLowerCase());\r\n            CreateDrawingStylesEditor(_drawingObject, regularDrawingStyle, icon);\r\n        }\r\n    }\r\n    else\r\n        icon = _span(null, [['dir', 'className', geom.type + (L.gmxUtil.isRectangle(geom.coordinates) ? ' RECTANGLE' : '')]]);\r\n\r\n\tvar remove = _span();\r\n\r\n    if (_options.allowDelete)\r\n    {\r\n        remove.setAttribute('title', _gtxt('drawingObjects.removeObject'));\r\n        remove.className = 'gmx-icon-close';\r\n        remove.onclick = function(){\r\n            $(_this).triggerHandler('onRemove', [_drawingObject]);\r\n        }\r\n    }\r\n\r\n\t_(_canvas, [_span([icon, _title, _text, _summary], [['dir','className','drawingObjectsItem']]), remove]);\r\n\r\n\t_(oInitContainer, [_canvas])\r\n\r\n    this._mouseOverHandler = function() {\r\n        $(_canvas).addClass('drawingObjectsActiveItemCanvas');\r\n    };\r\n\r\n    this._mouseOutHandler = function() {\r\n        $(_canvas).removeClass('drawingObjectsActiveItemCanvas');\r\n    }\r\n\r\n    _drawingObject.on('mouseover', this._mouseOverHandler);\r\n    _drawingObject.on('mouseout', this._mouseOutHandler);\r\n\r\n\t/** Обновляет информацию о геометрии */\r\n\tthis.UpdateRow = function(){\r\n        var summary = _drawingObject.getSummary(),\r\n            text = _drawingObject.options.title,\r\n            type = _drawingObject.getType();\r\n\r\n\t\t$(_title).empty();\r\n\t\t$(_text).empty();\r\n\t\t$(_summary).empty();\r\n\r\n\t\tif (type === 'Point')\r\n\t\t{\r\n\t\t\t_(_title, [_t(_gtxt('drawingObjects.pointTitle'))]);\r\n\t\t\t_(_summary, [_t(\"(\" + summary + \")\")]);\r\n\t\t}\r\n\t\telse if (type === 'Polyline' || type === 'MultiPolyline')\r\n\t\t{\r\n\t\t\t_(_title, [_t(_gtxt('drawingObjects.lineTitle'))]);\r\n\t\t\t_(_summary, [_t(\"(\" + summary + \")\")]);\r\n\t\t}\r\n\t\telse if (type === 'Polygon' || type === 'MultiPolygon' || type === 'Rectangle')\r\n\t\t{\r\n\t\t\t_(_title, [_t(type === 'Rectangle' ? _gtxt('drawingObjects.rectangleTitle') : _gtxt('drawingObjects.polygonTitle'))]);\r\n\t\t\t_(_summary, [_t(\"(\" + summary + \")\")]);\r\n\t\t}\r\n\r\n\t\t_(_text, [_t(text ? text.replace(/<[^<>]*>/g, \" \") : \"\")])\r\n\r\n\t\tif (text)\r\n\t\t\t_title.style.display = 'none';\r\n\t\telse\r\n\t\t\t_title.style.display = '';\r\n\t}\r\n\r\n\t/** Удаляет строчку */\r\n\tthis.RemoveRow = function(){\r\n\r\n\t\tif (_canvas.parentNode)\r\n            _canvas.parentNode.removeChild(_canvas);\r\n\r\n        if (_drawingObject === null) return;\r\n\r\n        _drawingObject.off('edit', this.UpdateRow);\r\n        _drawingObject.off('remove', this.RemoveRow);\r\n        _drawingObject.off('mouseover', this._mouseOverHandler);\r\n        _drawingObject.off('mouseout', this._mouseOutHandler);\r\n\r\n        _drawingObject = null;\r\n\t}\r\n\r\n    /** Удаляет строчку */\r\n    this.getContainer = function() {return _canvas;};\r\n\r\n    if (nsGmx && nsGmx.ContextMenuController) {\r\n        nsGmx.ContextMenuController.bindMenuToElem(_title, 'DrawingObject', function(){return true; }, {obj: _drawingObject} );\r\n    }\r\n\r\n    this.getDrawingObject = function(){\r\n        return _drawingObject;\r\n    }\r\n\r\n    _drawingObject.on('edit', this.UpdateRow);\r\n    _drawingObject.on('remove', this.RemoveRow);\r\n\r\n\tthis.UpdateRow();\r\n}\r\n\r\n/** Конструктор\r\n @class Контрол для отображения коллекции пользовательских объектов\r\n @memberOf DrawingObjects\r\n @param oInitMap Карта\r\n @param {documentElement} oInitContainer Объект, в котором находится контрол (div)\r\n @param {DrawingObjects.DrawingObjectCollection} oInitDrawingObjectCollection Коллекция пользовательских объектов\r\n @param {Object} options Дополнительные параметры.Включает все доп. параметры DrawingObjectInfoRow\r\n @param {bool} [options.showButtons=true] показывать ли кнопки под списком\r\n @param {selectedIndex} [options.selectedIndex=null] индекс выбранного элемента\r\n*/\r\nvar DrawingObjectList = function(oInitMap, oInitContainer, oInitDrawingObjectCollection, options){\r\n    var _options = $.extend({showButtons: true, selectedIndex: null}, options);\r\n\tvar _this = this;\r\n\tvar _rows = [];\r\n\tvar _containers = [];\r\n\tvar _map = oInitMap;\r\n\tvar _collection = oInitDrawingObjectCollection;\t\r\n\tvar _divList = _div(null, [['dir', 'className', 'DrawingObjectList']]);\r\n\tvar _divButtons = _div();\r\n\r\n\t/** Добавляет объект в \"список объектов на карте\"\r\n\t@param {drawingObject} drawingObject добавляемый объект */\r\n\tvar add = function(drawingObject){\r\n\t\tvar divRow = _div();\r\n\t\t_(_divList, [divRow]);\r\n\t\tvar row = new DrawingObjectInfoRow(_map, divRow, drawingObject, options);\r\n\t\t_containers.push(divRow);\r\n\t\t_rows.push(row);\r\n\t\t$(row).bind('onRemove', function(){ drawingObject.remove(); } );\r\n\t\tif (_collection.Count() == 1 && _options.showButtons) show(_divButtons);\r\n\r\n        /** В списке мышь переместилась над объект\r\n\t\t@name DrawingObjects.DrawingObjectList.mouseover\r\n\t\t@event\r\n\t\t@param {drawingObject} drawingObject объект, над которым находится мышь*/\r\n\r\n        /** В списке мышь переместилась с объекта\r\n\t\t@name DrawingObjects.DrawingObjectList.mouseout\r\n\t\t@event\r\n\t\t@param {drawingObject} drawingObject объект, с которого переместилась мышь*/\r\n\r\n        $(divRow).bind({\r\n            mouseover: function() {\r\n                $(_this).triggerHandler('mouseover', [drawingObject]);\r\n            },\r\n            mouseout: function() {\r\n                $(_this).triggerHandler('mouseout', [drawingObject]);\r\n            }\r\n        });\r\n\t}\r\n\r\n\tvar onRemove = function(event, index){\r\n\t\tif (_collection.Count() == 0) hide(_divButtons);\r\n\t\tvar removedDiv = _containers.splice(index, 1)[0];\r\n\t\t_rows.splice(index, 1);\r\n\t\tremovedDiv.parentNode && removedDiv.parentNode.removeChild(removedDiv);\r\n\r\n        if (index === _selectedIndex) {\r\n            _selectedIndex = null;\r\n        } else if (index < _selectedIndex) {\r\n            _selectedIndex--;\r\n        }\r\n\t}\r\n\r\n\t$(_collection).bind('onRemove', onRemove);\r\n\t$(_collection).bind('onAdd', function(event, drawingObject){\r\n\t\tadd(drawingObject);\r\n\t});\r\n\r\n\tfor (var i=0; i<_collection.Count(); i++){ add(_collection.Item(i));}\r\n\r\n    /** Очищает список пользовательских объектов*/\r\n\tthis.Clear = function(){\r\n\t\twhile (_collection.Count()>0){\r\n\t\t\t_collection.Item(0).remove();\r\n\t\t}\r\n\r\n        _selectedIndex = null;\r\n\t}\r\n\r\n\t/** Возвращает div, в котором находится кнопка \"Очистить\" и который не виден при пустой коллекции */\r\n\tthis.GetDivButtons = function(){\r\n\t\treturn _divButtons;\r\n\t}\r\n\r\n    var delAll = makeLinkButton(_gtxt('drawingObjects.removeAll'));\r\n\tdelAll.onclick = this.Clear;\r\n\r\n\t_(_divButtons, [_div([delAll])]);\r\n\t_( oInitContainer, [_divList, _divButtons]);\r\n\r\n\tif (_collection.Count() == 0 || !_options.showButtons) hide(_divButtons);\r\n\r\n    var _selectedIndex = null;\r\n\r\n    /** Устанавливает выбранный элемент списка пользовательских объектов.\r\n        null - нет активного. Неправильные индексы игнорируются. К контейнеру выбранного элемента добавляется класс drawingObjectsSelectedItemCanvas\r\n    */\r\n    this.setSelection = function(selectedIndex) {\r\n        var isValidIndex = !!_rows[selectedIndex] || selectedIndex === null;\r\n        if (selectedIndex === _selectedIndex || !isValidIndex) {\r\n            return _selectedIndex;\r\n        }\r\n\r\n        if (_rows[_selectedIndex]) {\r\n            $(_rows[_selectedIndex].getContainer()).removeClass('drawingObjectsSelectedItemCanvas');\r\n        }\r\n\r\n        if (_rows[selectedIndex]) {\r\n            $(_rows[selectedIndex].getContainer()).addClass('drawingObjectsSelectedItemCanvas');\r\n        }\r\n\r\n        _selectedIndex = selectedIndex;\r\n\r\n        return _selectedIndex;\r\n    };\r\n\r\n    /** Возвращает индекс выбранного элемента списка пользовательских объектов, null - если нет выбранного*/\r\n    this.getSelection = function() {\r\n        return _selectedIndex;\r\n    }\r\n\r\n    this.setSelection(_options.selectedIndex);\r\n}\r\n\r\n/** Конструктор\r\n @memberOf DrawingObjects\r\n @class Встраивает список объектов на карте в геомиксер*/\r\nvar DrawingObjectGeomixer = function() {\r\n\tvar _this = this;\r\n\tvar oMap = null;\r\n    var gmxMap = null;\r\n\tvar oMenu = new leftMenu();\r\n\tvar oListDiv = _div(null, [['dir', 'className', 'DrawingObjectsLeftMenu']]);\r\n\tvar bVisible = false;\r\n    var oCollection = null;\r\n\r\n\t/** Вызывается при скрывании меню*/\r\n\tthis.Unload = function(){ bVisible = false; };\r\n\r\n\t/** Загружает меню*/\r\n\tthis.Load = function(){\r\n\t\tif (oMenu != null){\r\n\t\t\tvar alreadyLoaded = oMenu.createWorkCanvas(\"DrawingObjects\", this.Unload);\r\n\t\t\tif (!alreadyLoaded) _(oMenu.workCanvas, [oListDiv]);\r\n\t\t}\r\n\t\tbVisible = true;\r\n\t}\r\n\r\n\tvar fnAddToCollection = function(ev) {\r\n        var feature = ev.object;\r\n\t\tif (!nsGmx.DrawingObjectCustomControllers || !nsGmx.DrawingObjectCustomControllers.isHidden(feature)) {\r\n            oCollection.Add(feature);\r\n\r\n        }\r\n\t}\r\n\r\n\tvar checkDownloadVisibility = function(){\r\n\t\tvar isAnyRectangle = false,\r\n            isNonPolygon = false;\r\n\r\n\t\tfor (var i=0; i< oCollection.Count(); i++){\r\n            var feature = oCollection.Item(i);\r\n            var geom = feature.toGeoJSON().geometry;\r\n            isAnyRectangle = isAnyRectangle || L.gmxUtil.isRectangle(geom.coordinates);\r\n            isNonPolygon = isNonPolygon || geom.type !== 'Polygon';\r\n\t\t}\r\n\r\n        $(downloadContainer).toggle(oCollection.Count() > 0);\r\n        $(downloadRaster).toggle(gmxMap.properties.CanDownloadRasters && isAnyRectangle);\r\n        $(downloadGpx).toggle(isNonPolygon);\r\n\t}\r\n\r\n    var downloadFormat = null;\r\n\r\n\tvar downloadShp = makeLinkButton(_gtxt('drawingObjects.downloadShp'));\r\n\tdownloadShp.onclick = function(){\r\n        downloadFormat = 'Shape';\r\n        downloadNameContainer.toggle();\r\n\t}\r\n    downloadShp.style.margin = '0px 3px';\r\n\r\n\tvar downloadGeoJSON = makeLinkButton(_gtxt('drawingObjects.downloadGeoJSON'));\r\n\tdownloadGeoJSON.onclick = function(){\r\n        downloadFormat = 'GeoJSON';\r\n        downloadNameContainer.toggle();\r\n\t}\r\n    downloadGeoJSON.style.margin = '0px 3px';\r\n\r\n    var downloadGpx = makeLinkButton(_gtxt('drawingObjects.downloadGpx'));\r\n\tdownloadGpx.onclick = function(){\r\n        downloadFormat = 'gpx';\r\n        downloadNameContainer.toggle();\r\n\t}\r\n    downloadGpx.style.margin = '0px 3px';\r\n\r\n    var downloadCsv = makeLinkButton(_gtxt('drawingObjects.downloadCsv'));\r\n\tdownloadCsv.onclick = function(){\r\n        downloadFormat = 'csv_wkt';\r\n        downloadNameContainer.toggle();\r\n\t}\r\n    downloadCsv.style.margin = '0px 3px';\r\n\r\n    var downloadNameInput = $('<input/>', {title: _gtxt('drawingObjects.downloadNameTitle')}).val('markers').addClass('inputStyle');\r\n\r\n    downloadNameInput.keyup(function(e) {\r\n        if (e.keyCode == 13) {\r\n            downloadNameButton.click();\r\n        }\r\n    })\r\n\r\n    var downloadNameButton = $('<input/>', {type: 'button'}).val(_gtxt('drawingObjects.download')).addClass('btn').click(function() {\r\n        downloadMarkers(downloadNameInput.val(), downloadFormat);\r\n        downloadNameContainer.hide();\r\n        downloadFormat = null;\r\n    });\r\n    var downloadNameContainer = $('<div/>').append(downloadNameInput, downloadNameButton).hide();\r\n\r\n    var downloadRasterOptions = $(\r\n        '<div class=\"drawingObjectsDownloadRaster\">' +\r\n            '<label><input type=\"radio\" name=\"rasterFormat\" checked value=\"univers\">jpeg + georefernce</label>' +\r\n            '<label><input type=\"radio\" name=\"rasterFormat\" value=\"garmin\">kmz (Garmin Custom Maps)</label>' +\r\n            '<button id=\"downloadRaster\" class=\"btn\">' + _gtxt('drawingObjects.download') + '</button>' +\r\n        '</div>'\r\n    ).hide();\r\n\r\n    $('#downloadRaster', downloadRasterOptions).click(function() {\r\n        var checkInfo = checkRasterLayer();\r\n        if (checkInfo) {\r\n            var bounds = checkInfo.bounds,\r\n                layer = checkInfo.layer,\r\n                format = $('input:checked', downloadRasterOptions).val(),\r\n                temporalParam = \"\",\r\n                props = layer.getGmxProperties();\r\n\r\n            if (props.Temporal) {\r\n                var dateInterval = layer.getDateInterval();\r\n                if (dateInterval) {\r\n                    var dateBeginStr = nsGmx.Utils.convertFromServer('date', dateInterval.beginDate/1000),\r\n                        dateEndStr = nsGmx.Utils.convertFromServer('date', dateInterval.endDate/1000);\r\n\r\n                    temporalParam = \"&StartDate=\" + encodeURIComponent(dateBeginStr) + \"&EndDate=\" + encodeURIComponent(dateEndStr);\r\n                }\r\n            }\r\n\r\n            var truncate9 = function(x) { return (\"\" + x).substring(0, 9); };\r\n\r\n            window.location.href =\r\n                window.location.protocol + \"//\" + props.hostName + \"/DownloadLayer.ashx\" +\r\n                \"?t=\" + props.name +\r\n                \"&MinX=\" + truncate9(bounds.getWest()) +\r\n                \"&MinY=\" + truncate9(bounds.getSouth()) +\r\n                \"&MaxX=\" + truncate9(bounds.getEast()) +\r\n                \"&MaxY=\" + truncate9(bounds.getNorth()) +\r\n                \"&Format=\" + format +\r\n                temporalParam;\r\n        }\r\n    })\r\n\r\n\tvar downloadRaster = makeLinkButton(_gtxt('drawingObjects.downloadRaster'));\r\n\tdownloadRaster.onclick = function(){\r\n        if (downloadRasterOptions.find(':visible').length || checkRasterLayer()) {\r\n            downloadRasterOptions.toggle();\r\n        }\r\n\t}\r\n\r\n    var downloadContainer = _div();\r\n\r\n\t/** Встраивает список объектов на карте в геомиксер*/\r\n\tthis.Init = function(leafletMap, initGmxMap){\r\n\t\toMap = leafletMap;\r\n        gmxMap = initGmxMap;\r\n\t\toCollection = new DrawingObjectCollection(leafletMap);\r\n        $(oCollection).bind('onAdd', function (){\r\n            if (!bVisible) _this.Load();\r\n        });\r\n\r\n        $(oCollection).bind('onRemove', function (){\r\n            oCollection.Count() || oMenu.leftPanelItem.close();\r\n        });\r\n\r\n        var lmap = nsGmx.leafletMap,\r\n            gmxDrawing = lmap.gmxDrawing,\r\n            features = gmxDrawing.getFeatures();\r\n\r\n        features.map(function(ret){\r\n\t\t\tfnAddToCollection(ret);\r\n\t\t});\r\n\r\n        lmap.gmxDrawing.on('add', fnAddToCollection);\r\n\r\n        $(oCollection).bind('onRemove onAdd', checkDownloadVisibility);\r\n\r\n        var oDrawingObjectList = new DrawingObjectList(oMap, oListDiv, oCollection);\r\n        _(downloadContainer, [\r\n            _div([_span([_t(_gtxt('drawingObjects.download'))], [['css', 'fontSize', '12px']]), downloadShp, downloadGeoJSON, downloadGpx, downloadCsv]),\r\n            downloadNameContainer[0],\r\n            _div([downloadRaster]),\r\n            downloadRasterOptions[0]\r\n        ]);\r\n\t\t_(oDrawingObjectList.GetDivButtons(), [downloadContainer]);\r\n\r\n\t\tcheckDownloadVisibility();\r\n\t}\r\n\r\n\t/** Скачивает shp файл*/\r\n\tvar downloadMarkers = function(fileName, format) {\r\n        var geoms = [];\r\n\r\n\t\tfor (var i = 0; i < oCollection.Count(); i++) {\r\n            geoms.push(oCollection.Item(i).toGeoJSON());\r\n        }\r\n\r\n        nsGmx.Utils.downloadGeometry(geoms, {\r\n            fileName: fileName,\r\n            format: format\r\n        });\r\n\t}\r\n\r\n\t/** Скачивает растровые слои*/\r\n\tvar checkRasterLayer = function(){\r\n\t\tvar obj = false;\r\n\r\n\r\n\t\tfor (var i = 0; i < oCollection.Count(); i++){\r\n\t\t\tvar elem = oCollection.Item(i);\r\n\r\n\t\t\tif (elem.getType() == 'Rectangle') {\r\n\t\t\t\tobj = elem;\r\n            }\r\n\t\t}\r\n\r\n\t\tif (!obj)\r\n\t\t{\r\n\t\t\tshowErrorMessage(_gtxt('drawingObjects.noRectangleError'), true);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar bounds = obj.getBounds(),\r\n            center = bounds.getCenter(),\r\n\t\t\tlayer = false;\r\n\r\n\t\tvar testPolygon = function(polygon, latlng){\r\n\t\t\tvar testRing = function(ring, x, y)\r\n\t\t\t{\r\n\t\t\t\tvar isInside = false;\r\n\t\t\t\tfor (var j = 0; j < ring.length - 1; j++)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar x1 = ring[j][0],\r\n\t\t\t\t\t\ty1 = ring[j][1],\r\n\t\t\t\t\t\tx2 = ring[j + 1][0],\r\n\t\t\t\t\t\ty2 = ring[j + 1][1];\r\n\r\n\t\t\t\t\tif (((y1 >= y) != (y2 >= y)) && ((x1 + (x2 - x1)*(y - y1)/(y2 - y1)) > x))\r\n\t\t\t\t\t\tisInside = !isInside;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn isInside;\r\n\t\t\t}\r\n\r\n\t\t\tfor (var j = 0; j < polygon.length; j++)\r\n\t\t\t\tif (testRing(polygon[j], latlng.lng, latlng.lat) != (j == 0))\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n        for (var iLayerN = 0; iLayerN < gmxMap.layers.length; iLayerN++) {\r\n            var l = gmxMap.layers[iLayerN],\r\n                props = l.getGmxProperties(),\r\n                layerBounds = l.getBounds && l.getBounds(),\r\n                isProperType = props.type == \"Raster\" || props.IsRasterCatalog;\r\n\r\n            if (isProperType && oMap.hasLayer(l) && layerBounds && layerBounds.isValid() && layerBounds.contains(center)) {\r\n                var geom = l.getGeometry(),\r\n                    coords = geom.coordinates,\r\n                    bIsPolygonBad = false;\r\n\r\n                if (geom.type === \"Polygon\" && !testPolygon(coords, center)) {\r\n                    bIsPolygonBad = true;\r\n                } else if (geom.type == \"MultiPolygon\") {\r\n                    bIsPolygonBad = true;\r\n                    for (var k = 0; k < coords.length; k++)\r\n                        if (testPolygon(coords[k], center)){\r\n                            bIsPolygonBad = false;\r\n                            break;\r\n                        }\r\n                }\r\n\r\n                if (!bIsPolygonBad && l && (!layer || (props.MaxZoom > layer.getGmxProperties().MaxZoom))) {\r\n                    layer = l;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!layer) {\r\n            showErrorMessage(_gtxt('drawingObjects.noRasterError'), true);\r\n            return;\r\n        }\r\n\r\n        return {bounds: bounds, layer: layer};\r\n\t}\r\n}\r\n\r\nvar publicInterface = {\r\n\tDrawingObjectCollection: DrawingObjectCollection,\r\n\tDrawingObjectInfoRow: DrawingObjectInfoRow,\r\n\tDrawingObjectList: DrawingObjectList,\r\n\tDrawingObjectGeomixer: DrawingObjectGeomixer\r\n};\r\n\r\nwindow.gmxCore.addModule(\"DrawingObjects\", publicInterface);\r\n\r\nexport {\r\n    DrawingObjectCollection,\r\n\tDrawingObjectInfoRow,\r\n\tDrawingObjectList,\r\n\tDrawingObjectGeomixer\r\n};","﻿import nsGmx from './nsGmx.js';\r\nimport {\r\n    _a,\r\n    _br,\r\n    _div,\r\n    _form,\r\n    _input,    \r\n    inputError,\r\n    _li,\r\n    makeImageButton,\r\n    makeLinkButton,\r\n    parseResponse,\r\n    sendCrossDomainJSONRequest,\r\n    sendCrossDomainPostRequest,\r\n    showDialog,\r\n    showErrorMessage,\r\n    _t,\r\n    _table,\r\n    _tbody,\r\n    _textarea,\r\n    _td,\r\n    _tr,\r\n    _ul,\r\n} from './utilities.js';\r\n\r\nimport {DrawingObjectInfoRow} from './drawingObjects.js';\r\n\r\n//Диалог создания/редактирования мультислоя.\r\n(function(_){\r\n\r\n//params:\r\n//  properties - свойства слоя по умолчанию\r\n//  layers - список слоёв по умолчанию\r\nvar createMultiLayerEditorNew = function(layersTree, params)\r\n{\r\n    params = params || {};\r\n    doCreateMultiLayerEditor( params.properties || {}, params.layers || [], null, layersTree );\r\n}\r\n\r\n//получает с сервера информацию о мультислое и рисует диалог редактирования его настроек\r\nvar createMultiLayerEditorServer = function(elemProperties, div, layersTree)\r\n{\r\n    sendCrossDomainJSONRequest(window.serverBase + \"MultiLayer/GetMultiLayerFullInfo.ashx?MultiLayerID=\" + elemProperties.MultiLayerID, function(response)\r\n    {\r\n        if (!parseResponse(response))\r\n            return;\r\n            \r\n        var elemPropertiesFull = $.extend(true, response.Result.Properties, elemProperties);\r\n        doCreateMultiLayerEditor(elemPropertiesFull, response.Result.Layers, div, layersTree);\r\n    })\r\n}\r\n\r\nvar doCreateMultiLayerEditor = function(elemProperties, layers, div, layersTree)\r\n{\r\n    var isReadonly = div && _queryMapLayers.layerRights(div.gmxProperties.content.properties.name) !== 'edit';\r\n    \r\n    var commonLayersListDiv = _div(null, [['css', 'height', '100%'], ['css', 'width', '100%']]);\r\n    var selectedLayersDiv = _div(null, [['css', 'height', '100%'], ['css', 'margin', '10px 0px 0px 0px']]);\r\n    \r\n    var selectedLayersTable = new nsGmx.ScrollTable({height: div ? 255 : 280});\r\n        \r\n    if (!isReadonly) {\r\n        var suggestLayersControl = new nsGmx.LayerManagerControl(commonLayersListDiv, 'multilayers', {\r\n            fixType: ['raster', 'catalog'], \r\n            enableDragging: false,\r\n            onclick: function(context)\r\n            {\r\n                selectedLayersTable.getDataProvider().addOriginalItem(context.elem);\r\n                suggestLayersControl.disableLayers(context.elem.name);\r\n            }\r\n        });\r\n    }\r\n    \r\n    var uiSelectedRowTemplate = Handlebars.compile('<tr>' +\r\n        '<td><div class=\"gmx-icon-{{iconClass}}\"></div></td>' +\r\n        '<td><div class=\"multilayer-row-title-outer\"><div class=\"multilayer-row-title-inner\" title=\"{{title}}\">{{title}}</div></div></td>' +\r\n        '{{#unless isReadonly}}' +\r\n            '<td><div class=\"gmx-icon-downtriangle\"></div></td>' +\r\n            '<td><div class=\"gmx-icon-uptriangle\"></div></td>' +\r\n            '<td class=\"multilayer-row-td\"><div class=\"gmx-icon-recycle\"></div></td>' +\r\n        '{{/unless}}' +\r\n    '</tr>');\r\n        \r\n    selectedLayersTable.createTable(selectedLayersDiv, 'selectedLayersTables', 0, \r\n        isReadonly ? [_gtxt(\"Тип\"), _gtxt(\"Имя\")] : [_gtxt(\"Тип\"), _gtxt(\"Имя\"), \"\", \"\", \"\"],\r\n        isReadonly ? ['5%','95%'] : ['5%','80%', '5%', '5%', '5%'], \r\n        function(layer)\r\n        {\r\n            var ui = $(uiSelectedRowTemplate({\r\n                title: layer.title,\r\n                iconClass: layer.type == \"Vector\" ? 'vector' : 'raster',\r\n                isReadonly: isReadonly\r\n            }));\r\n\r\n            var _this = this;\r\n            ui.find('.gmx-icon-recycle').click(function()\r\n            {\r\n                _this.getDataProvider().filterOriginalItems(function(elem)\r\n                {\r\n                    return elem.LayerID != layer.LayerID;\r\n                })\r\n                \r\n                suggestLayersControl.enableLayers(layer.name);\r\n            });\r\n            \r\n            ui.find('.gmx-icon-downtriangle').click(function()\r\n            {\r\n                var vals = _this.getDataProvider().getOriginalItems();\r\n                for (var i = 0; i < vals.length-1; i++) {\r\n                    if (vals[i].LayerID === layer.LayerID) {\r\n                        vals.splice(i, 1);\r\n                        vals.splice(i+1, 0, layer);\r\n                        _this.getDataProvider().setOriginalItems(vals);\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n            \r\n            ui.find('.gmx-icon-uptriangle').click(function()\r\n            {\r\n                var vals = _this.getDataProvider().getOriginalItems();\r\n                for (var i = 1; i < vals.length; i++) {\r\n                    if (vals[i].LayerID === layer.LayerID) {\r\n                        vals.splice(i, 1);\r\n                        vals.splice(i-1, 0, layer);\r\n                        _this.getDataProvider().setOriginalItems(vals);\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n            \r\n            ui.children().each(function(i, elem) {\r\n                elem.style.width = _this._fields[i].width;\r\n            });\r\n            \r\n            return ui[0];\r\n        }, {});\r\n    \r\n    selectedLayersTable.getDataProvider().setOriginalItems(layers);    \r\n    \r\n    var propertiesDiv = _div(null, [['css', 'width', '100%'], ['css', 'height', '100%']]);\r\n    var shownProperties = [];\r\n    var title = _input(null,[['attr','fieldName','title'],['attr','value', elemProperties.title || ''],['dir','className','inputStyle'],['css','width','220px']])\r\n    var isCreatedDrawing = false;\r\n    title.onkeyup = function()\r\n    {\r\n        if (div)\r\n        {\r\n            var span = $(div).find(\".layer\")[0];\r\n        \r\n            $(span).empty();\r\n            \r\n            _(span, [_t(title.value)]);\r\n\r\n            div.gmxProperties.content.properties.title = title.value;\r\n            \r\n            layersTree.findTreeElem(div).elem.content.properties = div.gmxProperties.content.properties;\r\n        }\r\n        \r\n        return true;\r\n    }\r\n    var descr = _textarea(null,[['attr','fieldName','description'],['dir','className','inputStyle'],['css','width','220px'],['css','height','50px']]);\r\n    descr.value = elemProperties.description || '';\r\n    \r\n    descr.onkeyup = function()\r\n    {\r\n        if (div)\r\n        {\r\n            var span = $(div).find(\".layerDescription\")[0];\r\n        \r\n            $(span).empty();\r\n            \r\n            span.innerHTML = descr.value;\r\n\r\n            div.gmxProperties.content.properties.description = descr.value;\r\n            \r\n            layersTree.findTreeElem(div).elem.content.properties = div.gmxProperties.content.properties;\r\n        }\r\n        \r\n        return true;\r\n    }\r\n    \r\n    var borderContainer = _div(),\r\n        shpContainer = _div(null, [['css', 'display', 'none'], ['css', 'margin', '3px']]),\r\n        borderLink = makeImageButton(\"img/choose2.png\", \"img/choose2_a.png\"),\r\n        shpBorderLink = makeImageButton(\"img/choose2.png\", \"img/choose2_a.png\");\r\n    var borderTr = _tr([\r\n        _td([_t(_gtxt(\"Граница\")), borderLink, _br(), _t(_gtxt(\"Из файла\")), shpBorderLink], [['css','paddingLeft','5px'],['css','fontSize','12px']]), \r\n        _td([borderContainer, shpContainer])\r\n    ]);\r\n    \r\n    // var multiObj = null;\r\n    var fileInput = _input(null, [['attr', 'type', 'file'], ['attr', 'name', 'file'], ['attr', 'id', 'upload_shapefile']]);\r\n\tfileInput.onchange = function()\r\n\t{\r\n\t\tif (this.value === \"\") \r\n            return;\r\n            \r\n        nsGmx.Utils.parseShpFile(postForm).done(function(objs)\r\n        {\r\n            if (objs.length == 0)\r\n            {\r\n                showErrorMessage(_gtxt(\"Загруженный shp-файл пуст\"), true);\r\n                return;\r\n            }\r\n            \r\n            var joinedPolygon = nsGmx.Utils.joinPolygons(nsGmx._.pluck(objs, 'geometry'));\r\n            \r\n            if (!joinedPolygon) {\r\n                //TODO: ошибка\r\n            } else {\r\n                isCreatedDrawing = true;\r\n                bindPolygon(nsGmx.leafletMap.gmxDrawing.addGeoJSON(L.gmxUtil.geometryToGeoJSON(joinedPolygon))[0]);\r\n            }\r\n            \r\n            $(borderContainer).show();\r\n            $(shpContainer).hide();\r\n        })\r\n\t}\r\n\t\r\n\t//задаём одновременно и enctype и encoding для корректной работы в IE\r\n\tvar postForm = _form([fileInput], [['attr', 'method', 'POST'], ['attr', 'encoding', 'multipart/form-data'], ['attr', 'enctype', 'multipart/form-data'], ['attr', 'id', 'upload_shapefile_form']]);\r\n    $(shpContainer).append(postForm);\r\n    \r\n    var bindPolygon = function(polygon)\r\n    {\r\n        $(borderContainer).show();\r\n        $(shpContainer).hide();\r\n        \r\n        geometryInfoRow && geometryInfoRow.RemoveRow();\r\n        var InfoRow = DrawingObjectInfoRow;\r\n        geometryInfoRow = new InfoRow(\r\n            nsGmx.leafletMap, \r\n            borderContainer, \r\n            polygon, \r\n            { editStyle: false }\r\n        );\r\n        \r\n        $(geometryInfoRow).bind('onRemove', function()\r\n        {\r\n            if (isCreatedDrawing)\r\n                geometryInfoRow.getDrawingObject().remove();\r\n            else\r\n                geometryInfoRow.RemoveRow();\r\n            \r\n            isCreatedDrawing = false;\r\n            \r\n            geometryInfoRow = null;\r\n        })\r\n    }\r\n    \r\n    var geometryInfoRow = null;\r\n    borderLink.style.marginLeft = '3px';\r\n    shpBorderLink.style.marginLeft = '3px';\r\n    borderLink.onclick = function()\r\n    {\r\n        nsGmx.Controls.chooseDrawingBorderDialog( \r\n            '_MultilayerDialog', \r\n            bindPolygon, \r\n            {geomType: 'POLYGON', errorMessage: _gtxt(\"$$phrase$$_17\")} \r\n        );\r\n    }\r\n    \r\n    shpBorderLink.onclick = function()\r\n    {\r\n        $(borderContainer).hide();\r\n        $(shpContainer).show();\r\n    }\r\n    \r\n    if (elemProperties.UserBorder)\r\n    {\r\n        isCreatedDrawing = true;\r\n        bindPolygon(nsGmx.leafletMap.gmxDrawing.addGeoJSON(L.gmxUtil.geometryToGeoJSON(elemProperties.UserBorder, true))[0]);\r\n    }\r\n    \r\n    shownProperties.push({name: _gtxt(\"Имя\"), field: 'Title', elem: title});\r\n    shownProperties.push({name: _gtxt(\"Описание\"), field: 'Description', elem: descr});\r\n    div && shownProperties.push({name: _gtxt(\"ID\"), field: 'Name'});\r\n    \r\n    isReadonly || shownProperties.push({tr: borderTr});\r\n    \r\n    var trs = _mapHelper.createPropertiesTable(shownProperties, elemProperties, {leftWidth: 70});\r\n    _(propertiesDiv, [_table([_tbody(trs)],[['dir','className','propertiesTable']])]);\r\n    \r\n    var getUserBorder = function()\r\n    {\r\n        if (geometryInfoRow && geometryInfoRow.getDrawingObject()) {\r\n            return L.gmxUtil.geoJSONtoGeometry(geometryInfoRow.getDrawingObject().toGeoJSON().geometry, true);\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n    \r\n    var isCreate = div === null;\r\n    var saveButton;\r\n    \r\n    if (isReadonly) {\r\n        saveButton = _div([_t(_gtxt(\"Недостаточно прав для редактирования настроек слоя\"))],[['css','color','red']]);\r\n    } else {\r\n        saveButton = makeLinkButton(isCreate ? _gtxt(\"Создать\") : _gtxt(\"Изменить\"));\r\n        saveButton.onclick = function()\r\n        {\r\n            var errorElems = [];\r\n            \r\n            if (title.value === '') errorElems.push(title);\r\n            if (!selectedLayersTable.getDataProvider().getOriginalItems().length) errorElems.push(selectedLayersDiv);\r\n            \r\n            for (var i = 0; i < errorElems.length; i++)\r\n                inputError(errorElems[i], 2000);\r\n            \r\n            if (errorElems.length) return;\r\n            \r\n            var layers = [];\r\n            var selectedItems = selectedLayersTable.getDataProvider().getOriginalItems();\r\n            for (var l = 0; l < selectedItems.length; l++)\r\n                layers.push({LayerID: selectedItems[l].LayerID});\r\n                \r\n            var updateInfo = {\r\n                Properties: {\r\n                    MultiLayerID: elemProperties.MultiLayerID, \r\n                    Title: title.value, \r\n                    Description: descr.value, \r\n                    WMSAccess: false,\r\n                    UserBorder: getUserBorder()\r\n                },\r\n                Layers: layers, \r\n                LayersChanged: true\r\n            };\r\n            \r\n            var scriptName = isCreate ? \"Insert.ashx\" : \"Update.ashx\";\r\n            \r\n            sendCrossDomainPostRequest(window.serverBase + \"MultiLayer/\" + scriptName, {\r\n                    WrapStyle: 'window',\r\n                    MultiLayerInfo: JSON.stringify(updateInfo)\r\n                },\r\n                function(response)\r\n                {\r\n                    if ( !parseResponse(response) )\r\n                        return;\r\n                        \r\n                    var layerDiv = null;\r\n                    \r\n                    if (!isCreate)\r\n                    {\r\n                        layerDiv = $(_queryMapLayers.buildedTree).find(\"[MultiLayerID='\" + response.Result.properties.MultiLayerID + \"']\")[0];\r\n                    }\r\n                        \r\n                    var newLayerProperties = $.extend(true, response.Result.properties,\r\n                    {\r\n                        mapName:  layersTree.treeModel.getMapProperties().name,\r\n                        hostName: layersTree.treeModel.getMapProperties().hostName,\r\n                        visible:  isCreate ? true : layerDiv.gmxProperties.content.properties.visible,\r\n                        styles:   isCreate ? [{MinZoom: response.Result.properties.MinZoom, MaxZoom: response.Result.properties.MaxZoom}] : layerDiv.gmxProperties.content.properties.styles\r\n                    });\r\n\r\n                    var layerData = {type:'layer', content:{properties: newLayerProperties, geometry: response.Result.geometry}};\r\n                    \r\n                    if (!isCreate)\r\n                        _queryMapLayers.removeLayer(newLayerProperties.name);\r\n\r\n                    _layersTree.addLayersToMap(layerData);\r\n                    \r\n                    var divParent = $(_queryMapLayers.buildedTree.firstChild).children(\"div[MapID]\")[0];\r\n                    \r\n                    var li = _layersTree.getChildsList(layerData, divParent.gmxProperties, false, true);\r\n                    \r\n                    if (isCreate)\r\n                    {\r\n                        window._abstractTree.addNode(_queryMapLayers.buildedTree.firstChild, li);\r\n                        layersTree.addTreeElem(divParent, 0, layerData);\r\n                    }\r\n                    else\r\n                    {\r\n                        $(layerDiv.parentNode).replaceWith(li);\r\n                        _layersTree.findTreeElem($(li).children(\"div[MultiLayerID]\")[0]).elem = layerData;\r\n                    }\r\n                    \r\n                    geometryInfoRow && geometryInfoRow.getDrawingObject() && geometryInfoRow.getDrawingObject().remove();\r\n                    \r\n                    _queryMapLayers.addSwappable(li);\r\n                    _queryMapLayers.addDraggable(li);\r\n                    _layersTree.updateListType(li);\r\n                    \r\n                    $(jQueryDialog).dialog(\"destroy\");\r\n                    jQueryDialog.removeNode(true);\r\n                }\r\n            );\r\n        }\r\n    }\r\n    \r\n    var divProperties = _div();\r\n    _(divProperties, [_table([_tbody([\r\n        _tr([\r\n            _td([_table([_tbody([\r\n                _tr([_td([propertiesDiv])]),\r\n                _tr([_td([selectedLayersDiv])])\r\n            ])], [['css', 'width', '100%']])], [['css', 'verticalAlign', 'top'], ['css', 'width', '311px']]),\r\n            _td([commonLayersListDiv], [['css', 'paddingLeft', '10px']])]),\r\n        _tr([_td([saveButton], [['attr', 'colSpan', '2']])])\r\n    ])], [['css', 'width', '100%']])], [['attr','id','properties' + elemProperties.name]]);\r\n    \r\n    var dialogContainer;\r\n    if (!isCreate)\r\n    {\r\n        var divStyles = _div(null, [['attr','id','styles' + elemProperties.name]]);\r\n        \r\n        var zoomSource = elemProperties.styles && elemProperties.styles[0] || elemProperties;\r\n        var zoomPropertiesControl = new nsGmx.ZoomPropertiesControl(zoomSource.MinZoom, zoomSource.MaxZoom),\r\n            liMinZoom = zoomPropertiesControl.getMinLi(),\r\n            liMaxZoom = zoomPropertiesControl.getMaxLi();\r\n                \r\n        _(divStyles, [_ul([liMinZoom, liMaxZoom])]);\r\n                \r\n        $(zoomPropertiesControl).change(function()\r\n        {\r\n            nsGmx.gmxMap.layersByID[elemProperties.name].setZoomBounds(this.getMinZoom(), this.getMaxZoom());\r\n            \r\n            elemProperties.styles = elemProperties.styles || [];\r\n            elemProperties.styles[0] = elemProperties.styles[0] || {};\r\n            elemProperties.styles[0].MinZoom = zoomPropertiesControl.getMinZoom();\r\n            elemProperties.styles[0].MaxZoom = zoomPropertiesControl.getMaxZoom();\r\n            \r\n            _layersTree.findTreeElem(div).elem.content.properties = elemProperties;\r\n        });\r\n        \r\n        dialogContainer = _div([_ul([_li([_a([_t(_gtxt(\"Общие\"))],[['attr','href','#properties' + elemProperties.name]])]),\r\n                                 _li([_a([_t(_gtxt(\"Стили\"))],[['attr','href','#styles' + elemProperties.name]])])])]);\r\n                             \r\n        _(dialogContainer, [divProperties, divStyles]);\r\n        $(dialogContainer).tabs({active: 0});\r\n    }\r\n    else\r\n        dialogContainer = divProperties;\r\n        \r\n    var closeFunc = function()\r\n    {\r\n        if (geometryInfoRow && geometryInfoRow.getDrawingObject())\r\n        {\r\n            if (isCreatedDrawing)\r\n                 geometryInfoRow.getDrawingObject().remove();\r\n            else\r\n                geometryInfoRow.RemoveRow();\r\n                \r\n            isCreatedDrawing = false;\r\n        }\r\n    }\r\n    \r\n    if (isReadonly) {\r\n        $(dialogContainer).find('input, textarea').prop('disabled', true);\r\n    }\r\n    \r\n    var jQueryDialog = showDialog(_gtxt('Мультислой [value0]', elemProperties.title || ''), dialogContainer, isReadonly ? 340 : 900, 530, false, false, null, closeFunc);\r\n}\r\n\r\nwindow.gmxCore.addModule('MultiLayerEditor', {\r\n    createMultiLayerEditorServer: createMultiLayerEditorServer,\r\n    createMultiLayerEditorNew: createMultiLayerEditorNew\r\n})\r\n\r\n})(nsGmx.Utils._);","import nsGmx from './nsGmx.js';\r\nimport {leftMenu} from './menu.js';\r\nimport './drawingObjectsCustomControllers.js';\r\nimport './GroupEditor.js';\r\nimport {\r\n\tsendCrossDomainJSONRequest,\r\n\tsendCrossDomainPostRequest,\r\n\t_li,\r\n\tobjLength,\r\n\tcreateCookie,\r\n\tshowDialog,\r\n\tremoveDialog,\r\n\tparseColor,\r\n\tparseResponse,\r\n\t_table, _tbody, _tr, _td, _t, _input,\r\n\t_div, _span, _img, _a, _ul, _option,\r\n\tswitchSelect,\r\n\t_title\r\n} from './utilities.js';\r\nimport './Controls.js';\r\nimport './LayerStylesEditor.js';\r\nimport _queryTabs from './queryTabs.js';\r\nimport './queryExternalMaps.js';\r\nimport tinyMCE from './TinyMCEInit.js';\r\nimport './multiLayerEditor.js';\r\n\r\nconst _ = nsGmx.Utils._;\r\n\r\n/** Вспомогательные ф-ции ГеоМиксера\r\n@namespace _mapHelper\r\n*/\r\nnsGmx.mapHelper = {\r\n\r\n}\r\n\r\nvar mapHelp =\r\n{\r\n\tmapHelp: {},\r\n\tserviceHelp: {},\r\n\ttabs: {},\r\n\texternalMaps : {}\r\n}\r\n\r\nvar mapHelper = function()\r\n{\r\n\tthis.builded = false;\r\n    //this._treeView = false;\r\n\r\n\tthis.defaultStyles =\r\n\t{\r\n\t\t'point':{outline:{color:0x0000FF, thickness:1},marker:{size:8}, fill:{color:0xFFFFFF, opacity:20}},\r\n\t\t'linestring':{outline:{color:0x0000FF, thickness:1}},\r\n\t\t'polygon':{outline:{color:0x0000FF, thickness:1}, fill:{color:0xFFFFFF, opacity:20}}\r\n\t}\r\n\r\n\tthis.defaultPhotoIconStyles = {\r\n\t\t'point': {\r\n\t\t\tmarker: {\r\n\t\t\t\timage: 'api/img/camera18.png',\r\n\t\t\t\tcenter: true\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tthis.stylesDialogsHash = {};\r\n\tthis.drawingDialogsHash = {};\r\n\r\n\tthis.layerEditorsHash = {};\r\n\r\n\tthis.layerStylesHash = {};\r\n\r\n\tthis.attrValues = {};\r\n\r\n\tthis.customErrorsHash = {\r\n\t\t\"Unable to locate EXIF content\" : \"Unable to locate EXIF content\"\r\n\t}\r\n\r\n\t// контролирует пользовательские объекты, которые являются редактируемыми контурами растровых слоёв.\r\n\t// все такие объекты не будут сериализоваться\r\n\tthis.drawingBorders = (function()\r\n\t{\r\n\t\tvar _borders = {};\r\n\r\n\t\t//не будем сериализовать все пользовательские объекты, являющиеся контурами слоёв, так как это временные объекты\r\n\t\tnsGmx.DrawingObjectCustomControllers.addDelegate({\r\n\t\t\tisSerializable: function(obj)\r\n\t\t\t{\r\n\t\t\t\tfor (var name in _borders)\r\n\t\t\t\t\tif (_borders[name] === obj)\r\n\t\t\t\t\t\treturn false;\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn {\r\n\t\t\tset: function(name, obj)\r\n\t\t\t{\r\n                if (name in _borders) {\r\n                    _borders[name].drawingFeature.off('edit', _borders[name].editListener);\r\n                }\r\n                var editListener = function() {\r\n                    _borders[name].isChanged = true;\r\n                }\r\n\r\n                obj.on('edit', editListener);\r\n\r\n\t\t\t\t_borders[name] = {\r\n                    isChanged: !!_borders[name],\r\n                    drawingFeature: obj,\r\n                    editListener: editListener\r\n                }\r\n\t\t\t},\r\n\t\t\tget: function(name)\r\n\t\t\t{\r\n\t\t\t\treturn _borders[name] && _borders[name].drawingFeature;\r\n\t\t\t},\r\n\t\t\tlength: function()\r\n\t\t\t{\r\n\t\t\t\treturn objLength(_borders);\r\n\t\t\t},\r\n\r\n\t\t\t//callback(name, obj)\r\n\t\t\tforEach: function(callback)\r\n\t\t\t{\r\n\t\t\t\tfor (var name in _borders)\r\n\t\t\t\t\tcallback(name, _borders[name].drawingFeature);\r\n\t\t\t},\r\n\r\n            isChanged: function(name) {\r\n                return !!_borders[name] && _borders[name].isChanged;\r\n            },\r\n\r\n\t\t\tupdateBorder: function(name, span)\r\n\t\t\t{\r\n\t\t\t\tif (!_borders[name])\r\n\t\t\t\t\treturn;\r\n\r\n                var geom = _borders[name].drawingFeature.toGeoJSON().geometry,\r\n                    areaStr = L.gmxUtil.prettifyArea(L.gmxUtil.geoArea(geom, false));\r\n\r\n\t\t\t\tif (span)\r\n\t\t\t\t{\r\n\t\t\t\t\t_(span, [_t(areaStr)]);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!$('#drawingBorderDescr' + name).length)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t$('#drawingBorderDescr' + name).empty();\r\n\r\n\t\t\t\t_($('#drawingBorderDescr' + name)[0], [_t(areaStr)]);\r\n\t\t\t},\r\n\r\n\t\t\t//Удаляет объект из списка контуров слоя\r\n\t\t\t//?removeDrawring {bool, default: false} - удалять ли сам пользовательский объект\r\n\t\t\tremoveRoute: function(name, removeDrawing)\r\n\t\t\t{\r\n\t\t\t\tif (!(name in _borders))\r\n\t\t\t\t\treturn;\r\n\r\n                _borders[name].drawingFeature.off('edit', _borders[name].editListener);\r\n\r\n\t\t\t\tif (removeDrawing) {\r\n\t\t\t\t\tnsGmx.leafletMap.gmxDrawing.remove(_borders[name].drawingFeature);\r\n                }\r\n\r\n\t\t\t\tdelete _borders[name];\r\n\r\n\t\t\t\t$('#drawingBorderDescr' + name).empty();\r\n\t\t\t}\r\n\t\t}\r\n\t})();\r\n\r\n\tthis.unsavedChanges = false;\r\n\r\n}\r\n\r\nmapHelper.prototype = new leftMenu();\r\n\r\n/** Менеджер кастомных параметров карты.\r\n * Содержит набор провайдеров доп. параметров, которые могут сохранять и загружать данные из хранилища параметров\r\n * Данные загружаются один раз. Возможна асинхронная загрузка данных/добавление провайдеров.\r\n * Порядок вызова провайдеров не определён.\r\n *\r\n * @memberOf _mapHelper\r\n * @name customParamsManager\r\n */\r\nmapHelper.prototype.customParamsManager = (function()\r\n{\r\n\tvar _providers = [];\r\n\tvar _params = []; //хранит параметры, которые не были загружены провайдерами\r\n\r\n\tvar loadProviderState = function( provider )\r\n\t{\r\n\t\tif ( provider.name in _params && typeof provider.loadState !== 'undefined')\r\n\t\t{\r\n\t\t\tprovider.loadState( _params[ provider.name ] );\r\n\t\t\tdelete _params[ provider.name ];\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tsaveParams: function()\r\n\t\t{\r\n\t\t\tif ( !_providers.length ) return;\r\n\t\t\tvar params = {};\r\n\t\t\tfor (var p = 0; p < _providers.length; p++ )\r\n\t\t\t{\r\n\t\t\t\tif (typeof _providers[p].saveState !== 'undefined')\r\n                    params[_providers[p].name] = _providers[p].saveState();\r\n\t\t\t}\r\n\r\n\t\t\treturn params;\r\n\t\t},\r\n\t\tloadParams: function(params)\r\n\t\t{\r\n\t\t\t_params = params;\r\n\t\t\tfor (var p = 0; p < _providers.length; p++ )\r\n\t\t\t\tloadProviderState( _providers[p] );\r\n\t\t},\r\n\r\n\t\t//интерфейс провайдера: name, saveState(), loadState(state)\r\n\t\taddProvider: function(provider)\r\n\t\t{\r\n\t\t\t_providers.push( provider );\r\n\t\t\tloadProviderState( provider );\r\n\t\t},\r\n\r\n        isProvider: function(providerName) {\r\n            return !!nsGmx._.findWhere(_providers, {name: providerName});\r\n        },\r\n        removeProvider: function(providerName) {\r\n            _providers = nsGmx._.filter(_providers, function(provider) {\r\n                return provider.name !== providerName;\r\n            })\r\n        }\r\n\t}\r\n})();\r\n\r\nmapHelper.prototype.makeStyle = function(style)\r\n{\r\n    style = style || {};\r\n\tvar givenStyle = {};\r\n\r\n\tif (typeof style.RenderStyle != 'undefined')\r\n\t\tgivenStyle = style.RenderStyle;\r\n\telse if (style.outline || style.marker)\r\n\t\tgivenStyle = style;\r\n\telse\r\n\t{\r\n\t\tif (style.PointSize)\r\n\t\t\tgivenStyle.marker = { size: parseInt(style.PointSize) };\r\n\t\tif (style.Icon)\r\n\t\t{\r\n\t\t\tvar src = (style.Icon.indexOf(\"http://\") != -1) || (style.Icon.indexOf(\"https://\") != -1) ?\r\n\t\t\t\tstyle.Icon :\r\n\t\t\t\t(window.baseAddress + \"/\" + style.Icon);\r\n\t\t\tgivenStyle.marker = { image: src, center: true };\r\n\t\t}\r\n\t\tif (style.BorderColor || style.BorderWidth)\r\n\t\t\tgivenStyle.outline = {\r\n\t\t\t\tcolor: parseColor(style.BorderColor),\r\n\t\t\t\tthickness: parseInt(style.BorderWidth || \"1\")\r\n\t\t\t};\r\n\t\tif (style.FillColor)\r\n\t\t\tgivenStyle.fill = {\r\n\t\t\t\tcolor: parseColor(style.FillColor),\r\n\t\t\t\topacity: 100 - parseInt(style.Transparency || \"0\")\r\n\t\t\t};\r\n\r\n\t\tvar label = style.label || style.Label;\r\n\t\tif (label)\r\n\t\t\tgivenStyle.label = {\r\n\t\t\t\tfield: label.FieldName,\r\n\t\t\t\tcolor: parseColor(label.FontColor),\r\n\t\t\t\tsize: parseInt(label.FontSize || \"12\")\r\n\t\t\t};\r\n\t}\r\n\r\n\treturn givenStyle;\r\n}\r\n\r\nmapHelper.prototype.getMapStateAsPermalink = function(callback)\r\n{\r\n    // сохраняем состояние карты\r\n    var mapState = _mapHelper.getMapState();\r\n\r\n    // туда же сохраним созданные объекты\r\n    nsGmx.userObjectsManager.collect();\r\n    mapState.userObjects = JSON.stringify(nsGmx.userObjectsManager.getData());\r\n\r\n    nsGmx.Utils.TinyReference.create(mapState, true).then(callback);\r\n}\r\n\r\nmapHelper.prototype.reloadMap = function()\r\n{\r\n    if (!nsGmx.gmxMap) {\r\n        window.location.reload();\r\n    }\r\n\r\n    _mapHelper.getMapStateAsPermalink(function(permalinkID)\r\n    {\r\n        createCookie(\"TempPermalink\", permalinkID);\r\n        window.location.replace(window.location.href.split(\"?\")[0] + \"?permalink=\" + permalinkID + (window.defaultMapID == window.globalMapName ? \"\" : (\"&\" + window.globalMapName)));\r\n    })\r\n}\r\n\r\nmapHelper.prototype.updateUnloadEvent = function(flag)\r\n{\r\n\tif (typeof flag != 'undefined')\r\n\t\tthis.unsavedChanges = flag;\r\n\r\n\tif (this.unsavedChanges)\r\n\t{\r\n\t\twindow.onbeforeunload = function()\r\n\t\t{\r\n\t\t\treturn _gtxt(\"В дереве слоев остались несохраненные изменения!\");\r\n\t\t}\r\n\t}\r\n\telse\r\n\t\twindow.onbeforeunload = null;\r\n}\r\n\r\nmapHelper.prototype.setBalloon = function(filter, template)\r\n{\r\n\tfilter.enableHoverBalloon(function(o)\r\n\t{\r\n\t\treturn template.replace(/\\[([a-zA-Z0-9_а-яА-Я ]+)\\]/g, function()\r\n\t\t{\r\n\t\t\tvar key = arguments[1];\r\n\t\t\tif (key == \"SUMMARY\")\r\n\t\t\t\treturn o.getGeometrySummary();\r\n\t\t\telse\r\n\t\t\t\treturn o.properties[key];\r\n\t\t});\r\n\t});\r\n}\r\n\r\nmapHelper.prototype.updateMapStyles = function(newStyles, name)\r\n{\r\n    var layer = nsGmx.gmxMap.layersByID[name],\r\n        styles = newStyles.map(nsGmx.Utils.prepareGmxLayerStyle);\r\n\r\n    layer.setStyles(styles);\r\n}\r\n\r\n//TODO: remove isEditableStyles\r\nmapHelper.prototype.updateTreeStyles = function(newStyles, div, treeView, isEditableStyles)\r\n{\r\n    isEditableStyles = typeof isEditableStyles === 'undefined' || isEditableStyles;\r\n\r\n\tif (window.newStyles) {\r\n\t\tdiv.gmxProperties.content.properties.gmxStyles.styles = newStyles;\r\n\t} else {\r\n\t\tdiv.gmxProperties.content.properties.styles = newStyles;\r\n\t}\r\n\r\n\tvar multiStyleParent = $(div).children('[multiStyle]')[0];\r\n\r\n\tvar parentIcon = $(div).children(\"[styleType]\")[0],\r\n\t\tnewIcon = _mapHelper.createStylesEditorIcon(newStyles, div.gmxProperties.content.properties.GeometryType.toLowerCase(), {addTitle: isEditableStyles});\r\n\r\n\t$(parentIcon).empty().append(newIcon).attr('styleType', $(newIcon).attr('styleType'));\r\n\r\n\t$(multiStyleParent).empty();\r\n\r\n\t_mapHelper.createMultiStyle(div.gmxProperties.content.properties, treeView, multiStyleParent)\r\n}\r\n\r\nmapHelper.prototype.restoreTinyReference = function(id, callbackSuccess, errorCallback)\r\n{\r\n\twindow.suppressDefaultPermalink = true;\r\n    nsGmx.Utils.TinyReference.get(id).then(function(obj) {\r\n\t\tif (obj.position) {\r\n            var latLngPos = L.Projection.Mercator.unproject(obj.position);\r\n\t\t\tobj.position.x = latLngPos.lng;\r\n\t\t\tobj.position.y = latLngPos.lat;\r\n\t\t\tobj.position.z = 17 - obj.position.z;\r\n\t\t\tif (obj.drawnObjects) {\r\n\t\t\t\tfor (var i in obj.drawnObjects) {\r\n                    //эта двойная конвертация в действительности просто перевод координат из Меркатора в LatLng\r\n\t\t\t\t\tobj.drawnObjects[i].geometry = L.gmxUtil.geoJSONtoGeometry(L.gmxUtil.geometryToGeoJSON(obj.drawnObjects[i].geometry, true));\r\n\t\t\t\t}\r\n            }\r\n\t\t}\r\n        obj.originalReference = id;\r\n\t\tcallbackSuccess(obj);\r\n    }, errorCallback);\r\n}\r\n\r\nmapHelper.prototype.getMapState = function() {\r\n    var lmap = nsGmx.leafletMap;\r\n\r\n    if (!lmap) {\r\n        return {};\r\n    }\r\n\r\n    var drawnObjects = [],\r\n\t\tdrawings = lmap.gmxDrawing.saveState(),\r\n\t\tfeatures = drawings.featureCollection.features,\r\n        openPopups = {},\r\n        condition = {expanded:{}, visible:{}},\r\n\t\tLayersTreePermalinkParams = {},\r\n\t\tmercCenter = L.Projection.Mercator.project(lmap.getCenter());\r\n\r\n\t\tfor (var i = 0; i < features.length; i++) {\r\n\t\t\tif (features[i].properties.exportRect) {\r\n\t\t\t\tfeatures.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n    lmap.gmxDrawing.getFeatures().forEach(function(feature) {\r\n        if (!nsGmx.DrawingObjectCustomControllers.isSerializable(feature) || feature.options.exportRect) {\r\n            return;\r\n        }\r\n\r\n        let geoJSON = feature.toGeoJSON();\r\n\r\n        let elem = {\r\n            properties: geoJSON.properties,\r\n            geometry: L.gmxUtil.geoJSONtoGeometry(geoJSON, true)\r\n        };\r\n\r\n        if (elem.geometry.type !== \"POINT\") {\r\n            let style = feature.getOptions().lineStyle;\r\n\r\n            if (style) {\r\n                elem.thickness = style.weight || 2;\r\n                elem.color = style.color;\r\n                elem.opacity = (style.opacity || 0.8) * 100;\r\n            }\r\n        }\r\n\r\n        if (lmap.hasLayer(feature.getPopup())) {\r\n            elem.isBalloonVisible = true;\r\n        }\r\n\r\n        drawnObjects.push(elem);\r\n    });\r\n\r\n    for (let l in nsGmx.gmxMap.layersByID) {\r\n        let layer = nsGmx.gmxMap.layersByID[l];\r\n\r\n        if (layer.getPopups) {\r\n            let popups = layer.getPopups();\r\n            if (popups.length) {\r\n                openPopups[l] = popups;\r\n            }\r\n        }\r\n    }\r\n\r\n    this.findTreeElems(_layersTree.treeModel.getRawTree(), function(elem) {\r\n        let props = elem.content.properties;\r\n        if (elem.type == 'group') {\r\n            let groupId = props.GroupID;\r\n\r\n            if (!$(\"div[GroupID='\" + groupId + \"']\").length && !props.changedByViewer) {\r\n\t\t\t\treturn;\r\n\t\t\t}                \r\n\r\n            condition.visible[groupId] = props.visible;\r\n            condition.expanded[groupId] = props.expanded;\r\n\t\t}\r\n\t\telse if (props.changedByViewer) {\r\n\t\t\tcondition.visible[props.name] = props.visible;\r\n\t\t}        \r\n    });\r\n\r\n\t// layers tree permalink params (without server)\r\n\tthis.findTreeElems(_layersTree.treeModel.getRawTree(), function(elem) {\r\n\t\tlet props = elem.content.properties,\r\n\t\t\tid = elem.type == 'group' ? props.GroupID : props.LayerID;\r\n\r\n\t\tif (props.permalinkParams) {\r\n\t\t\tLayersTreePermalinkParams[id] = props.permalinkParams;\r\n\t\t}\r\n\t});\r\n\r\n\tlet dateIntervals = {};\r\n\r\n\tfor (let l in nsGmx.gmxMap.layersByID) {\r\n\t\tlet layer = nsGmx.gmxMap.layersByID[l],\r\n\t\t\tprops = layer.getGmxProperties(),\r\n\t\t\tisTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.setDateInterval);\r\n\r\n\t\tif (isTemporalLayer && layer.getDateInterval) {\r\n\t\t\tdateIntervals[props.LayerID] = layer.getDateInterval();\r\n\t\t}\r\n\t}\r\n\r\n    return {\r\n        mode: lmap.gmxBaseLayersManager.getCurrentID(),\r\n        mapName: window.globalMapName,\r\n        position: {\r\n            x: mercCenter.x,\r\n            y: mercCenter.y,\r\n            z: 17 - lmap.getZoom()\r\n        },\r\n        mapStyles: this.getMapStyles(),\r\n\t\tdrawings: drawings,\r\n\t\tdrawnObjects: drawnObjects,\r\n        isFullScreen: window.layersShown ? \"false\" : \"true\",\r\n        condition: condition,\r\n\t\tLayersTreePermalinkParams: LayersTreePermalinkParams,\r\n        language: window.language,\r\n\t\tcustomParamsCollection: this.customParamsManager.saveParams(),\r\n\t\tdateIntervals: dateIntervals,\r\n        openPopups: openPopups\r\n    }\r\n}\r\n\r\nmapHelper.prototype.getMapStyles = function()\r\n{\r\n\tlet styles = {};\r\n\r\n\tthis.findChilds(_layersTree.treeModel.getRawTree(), function(child)\r\n\t{\r\n\t\tif (child.content.properties.type == \"Vector\" && $(\"div[LayerID='\" + child.content.properties.LayerID + \"']\").length)\r\n\t\t\tstyles[child.content.properties.name] = child.content.properties.styles;\r\n\t}, true);\r\n\r\n\treturn styles;\r\n}\r\n\r\nmapHelper.prototype.showPermalink = function()\r\n{\r\n\tthis.createPermalink(function(id){\r\n        var url = window.location.protocol + \"//\" + window.location.host + window.location.pathname + \"?permalink=\" + id + (window.defaultMapID == window.globalMapName ? \"\" : (\"&\" + window.globalMapName));\r\n        var input = _input(null, [['dir','className','inputStyle inputFullWidth'],['attr','value', url]]);\r\n\r\n        showDialog(_gtxt(\"Ссылка на текущее состояние карты\"), _div([input]), 311, 80, false, false);\r\n\r\n        input.select();\r\n    });\r\n}\r\n\r\nmapHelper.prototype.createExportPermalink = function(params, callback)\r\n{\r\n\tvar mapState = $.extend(this.getMapState(), params),\r\n\t\tdef = nsGmx.Utils.TinyReference.create(mapState, false);\r\n    def.then(callback);\r\n\treturn def;\r\n}\r\n\r\nmapHelper.prototype.createPermalink = function(callback)\r\n{\r\n\tvar mapState = this.getMapState(),\r\n        def = nsGmx.Utils.TinyReference.create(mapState, false);\r\n\r\n    def.then(callback);\r\n    return def;\r\n}\r\n\r\nmapHelper.prototype.updateTinyMCE = function(container) {\r\n    // window.gmxCore.loadModule('TinyMCELoader', window.location + '//' + window.location.host + window.location.pathname.replace('index.html', '') + 'TinyMCELoader.js', function() {\r\n    //     $('.balloonEditor', container).each(function() {\r\n    //         var id = $(this).attr('id');\r\n    //         if (!tinyMCE.get(id)) {\r\n    //             tinyMCE.execCommand(\"mceAddControl\", true, id);\r\n    //         }\r\n    //     })\r\n\t// });\r\n\t$('.balloonEditor', container).each(function() {\r\n\t\tvar id = $(this).attr('id');\r\n\t\tif (!tinyMCE.get(id)) {\r\n\t\t\ttinyMCE.execCommand(\"mceAddControl\", true, id);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n//event: selected(url)\r\nmapHelper.ImageSelectionWidget = Backbone.View.extend({\r\n    tagName: 'span',\r\n    className: 'gmx-icon-choose',\r\n    events: {\r\n        'click': function() {\r\n            var imagesDir = nsGmx.AuthManager.getUserFolder() + 'images',\r\n                _this = this;\r\n            sendCrossDomainJSONRequest(window.serverBase + 'FileBrowser/CreateFolder.ashx?WrapStyle=func&FullName=' + encodeURIComponent(imagesDir), function(response) {\r\n                if (!parseResponse(response))\r\n                    return;\r\n\r\n                window._fileBrowser.createBrowser(_gtxt(\"Изображение\"), ['jpg', 'jpeg', 'png', 'gif', 'swf'], function(path) {\r\n                    var relativePath = path.substring(imagesDir.length);\r\n                    if (relativePath[0] == '\\\\') {\r\n                        relativePath = relativePath.substring(1);\r\n                    }\r\n\r\n                    var url = window.serverBase + \"GetImage.ashx?usr=\" + encodeURIComponent(nsGmx.AuthManager.getLogin()) + \"&img=\" + encodeURIComponent(relativePath);\r\n\r\n                    _this.trigger('selected', url);\r\n                }, {startDir: imagesDir, restrictDir: imagesDir});\r\n            });\r\n        }\r\n    }\r\n});\r\n\r\nmapHelper.ImageInputControl = function(initURL) {\r\n    var prevValue = initURL || '';\r\n    var inputUrl = _input(null, [['dir','className','inputStyle'],['attr','value', prevValue], ['css','width','170px']]);\r\n    _title(inputUrl, _gtxt('URL изображения'));\r\n\r\n    var _this = this;\r\n\r\n    var update = function() {\r\n        if (inputUrl.value != prevValue) {\r\n            prevValue = inputUrl.value;\r\n            $(_this).change();\r\n        }\r\n    }\r\n\r\n    var mainDiv = $('<div/>').append(inputUrl);\r\n    inputUrl.onkeyup = inputUrl.change = update;\r\n\r\n    if (nsGmx.AuthManager.canDoAction(nsGmx.ACTION_UPLOAD_FILES)) {\r\n        var imageSelectionWidget = new mapHelper.ImageSelectionWidget();\r\n        imageSelectionWidget.on('selected', function(url) {\r\n            inputUrl.value = url;\r\n            update();\r\n        });\r\n\r\n        mainDiv.append(imageSelectionWidget.el);\r\n    }\r\n\r\n    this.getControl = function()\r\n    {\r\n        return mainDiv[0];\r\n    }\r\n\r\n    this.value = function()\r\n    {\r\n        return inputUrl.value;\r\n    }\r\n}\r\n\r\n//params:\r\n//  * addTitle {bool, default: true}\r\nmapHelper.prototype.createStylesEditorIcon = function(parentStyles, type, params) {\r\n    var _params = $.extend({addTitle: true}, params);\r\n\tvar icon;\r\n\r\n\tif ($.isArray(parentStyles) && parentStyles.length > 1) {\r\n\t\ticon = _img(null, [['attr','src','img/misc.png'],['css','margin','0px 2px -3px 4px'],['css','cursor','pointer'],['attr','styleType','multi']]);\r\n\t} else {\r\n\t\tvar parentStyle = _mapHelper.makeStyle(parentStyles[0]);\r\n\t\tvar iconUrlProp = window.newStyles ? parentStyle.iconUrl : parentStyle.marker && parentStyle.marker.image;\r\n\t\tif (iconUrlProp) {\r\n\t\t\ticon = _img(null, [['dir','className','icon'],['attr','styleType','icon']]);\r\n\r\n\t\t\tvar fixFunc = function() {\r\n\t\t\t\tvar width = this.width,\r\n\t\t\t\t\theight = this.height,\r\n\t\t\t\t\tscale;\r\n\r\n\t\t\t\tif (width && height) {\r\n\t\t\t\t\tvar scaleX = 14.0 / width;\r\n\t\t\t\t\tvar scaleY = 14.0 / height\r\n\t\t\t\t\tscale = Math.min(scaleX, scaleY);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tscale = 1;\r\n\t\t\t\t\twidth = height = 14;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\ticon.style.width = Math.round(width * scale) + 'px';\r\n\t\t\t\t\ticon.style.height = Math.round(height * scale) + 'px';\r\n\t\t\t\t}, 10);\r\n\t\t\t}\r\n\r\n\t\t\ticon.onload = fixFunc;\r\n\t\t\ticon.src = iconUrlProp;\r\n\t\t} else {\r\n\t\t\ticon = nsGmx.Controls.createGeometryIcon(parentStyle, type);\r\n\t\t}\r\n\t}\r\n\r\n    if (_params.addTitle)\r\n        _title(icon, _gtxt(\"Редактировать стили\"));\r\n\r\n\ticon.geometryType = type;\r\n\r\n\treturn icon;\r\n}\r\n\r\nmapHelper.prototype.createLoadingLayerEditorProperties = function(div, parent, layerProperties, params) {\r\n\t// var elemProperties = div.gmxProperties.content.properties,\r\n\tvar elemProperties = typeof div === 'string' ? layerProperties : div.gmxProperties.content.properties,\r\n\t\tloading = _div([_img(null, [['attr','src','img/progress.gif'],['css','marginRight','10px']]), _t(_gtxt('загрузка...'))], [['css','margin','3px 0px 3px 20px']]),\r\n        type = elemProperties.type;\r\n\t\t// _this = this;\r\n\r\n    if (type == \"Vector\")\r\n    {\r\n        nsGmx.createLayerEditor(div, type, parent, layerProperties, params);\r\n\r\n        return;\r\n    }\r\n    else if (elemProperties.name) {\r\n\t\t_(parent, [loading]);\r\n\r\n\t\tsendCrossDomainJSONRequest(window.serverBase + \"Layer/GetLayerInfo.ashx?WrapStyle=func&LayerName=\" + elemProperties.name, function(response)\r\n\t\t{\r\n\t\t\tif (!parseResponse(response))\r\n\t\t\t\treturn;\r\n\r\n\t\t\tloading.removeNode(true);\r\n\r\n\t\t\tnsGmx.createLayerEditor(div, type, parent, response.Result, params)\r\n\t\t})\r\n\t}    \r\n}\r\n\r\nmapHelper.prototype.createNewLayer = function(type)\r\n{\r\n\tif ($('#new' + type + 'Layer').length)\r\n\t\treturn;\r\n\r\n\tvar parent = _div(null, [['attr','id','new' + type + 'Layer'], ['css', 'height', '100%']]),\r\n\t\theight = (type == 'Vector') ? 340 : 360;\r\n\r\n    if (type !== 'Multi')\r\n    {\r\n\t\tvar properties = {Title:'', Description: '', Date: '', TilePath: {Path:''}, ShapePath: {Path:''}};\r\n        var dialogDiv = showDialog(type != 'Vector' ? _gtxt('Создать растровый слой') : _gtxt('Создать векторный слой'), parent, 340, height, false, false);\r\n        nsGmx.createLayerEditor(false, type, parent, properties,\r\n            {\r\n                doneCallback: function()\r\n                {\r\n                    removeDialog(dialogDiv);\r\n                }\r\n            }\r\n        );\r\n    }\r\n    else\r\n    { //мультислой\r\n        // var _this = this;\r\n        nsGmx.createMultiLayerEditorNew( _layersTree );\r\n    }\r\n}\r\n\r\n// перенос clipLayer из маплетов карты\r\nmapHelper.prototype.clipLayer = function(layer, props)\r\n{\r\n\tvar sw = L.latLng([props.MinViewY, props.MinViewX]),\r\n\t\tnw = L.latLng([props.MaxViewY, props.MinViewX]),\r\n\t\tne = L.latLng([props.MaxViewY, props.MaxViewX]),\r\n\t\tse = L.latLng([props.MinViewY, props.MaxViewX]),\r\n\t\tclip = L.polygon([sw, nw, ne, se, sw]);\r\n\r\n\t    layer.addClipPolygon(clip);\r\n}\r\n\r\n// Формирует набор элементов tr используя контролы из shownProperties.\r\n// Параметры:\r\n// - shownProperties: массив со следующими свойствами:\r\n//   * tr - если есть это свойство, то оно помещается в tr, все остальные игнорируются\r\n//   * name - названия свойства, которое будет писаться в левой колонке\r\n//   * elem - если есть, то в правую колонку помещается этот элемент\r\n//   * field - если нет \"elem\", в правый столбец подставляется layerProperties[field]\r\n//   * trid - id для DOM элементов. Не применяется, если прямо указано tr\r\n//   * trclass - class для DOM элементов. Не применяется, если прямо указано tr\r\n// - layerProperties - просто хеш строк для подстановки в правую колонку\r\n// - style:\r\n//   * leftWidth - ширина левой колонки в пикселях\r\n//   * leftcolumnclass - class для td элементов первого столбца. Не применяется, если прямо указано tr\r\n//   * rightcolumnclass - class для td элементов второго столбца. Не применяется, если прямо указано tr\r\nmapHelper.prototype.createPropertiesTable = function(shownProperties, layerProperties, style)\r\n{\r\n\tvar _styles = $.extend({leftWidth: 100}, style);\r\n\tvar trs = [];\r\n\tfor (var i = 0; i < shownProperties.length; i++)\r\n\t{\r\n\t\tvar td;\r\n\t\tif (typeof shownProperties[i].tr !== 'undefined')\r\n\t\t{\r\n\t\t\ttrs.push(shownProperties[i].tr);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (typeof shownProperties[i].elem !== 'undefined')\r\n\t\t\ttd = _td([shownProperties[i].elem]);\r\n\t\telse\r\n\t\t\ttd = _td([_t(layerProperties[shownProperties[i].field] != null ? layerProperties[shownProperties[i].field] : '')],[['css','padding','0px 3px']]);\r\n\r\n        var tdTitle = _td([_t(shownProperties[i].name)],[['css','width', _styles.leftWidth + 'px']]);\r\n\r\n\t\tvar tr = _tr([tdTitle, td]);\r\n\r\n        _(tdTitle, [], [['dir', 'className', 'propertiesTable-title ' + (_styles.leftcolumnclass || '')]]);\r\n\r\n        if (_styles.rightcolumnclass)\r\n            _(td, [], [['dir', 'className', _styles.rightcolumnclass]]);\r\n\r\n        if (shownProperties[i].trid)\r\n            _(tr, [], [['attr', 'id', shownProperties[i].trid]]);\r\n\r\n        if (shownProperties[i].trclass)\r\n            _(tr, [], [['dir', 'className', shownProperties[i].trclass]]);\r\n\r\n\t\ttrs.push(tr);\r\n\t}\r\n\r\n\treturn trs;\r\n}\r\n\r\nmapHelper.prototype.createLayerEditor = function(div, treeView, selected)\r\n{\r\n\tvar elemProperties = typeof div === 'string' ? nsGmx.gmxMap.layersByID[div].getGmxProperties() : div.gmxProperties.content.properties,\r\n\t// var elemProperties = div.gmxProperties.content.properties,\r\n        layerName = elemProperties.name,\r\n\t\t_this = this;\r\n\r\n\tif (elemProperties.type == \"Vector\")\r\n\t{\r\n\t\tif (typeof this.layerEditorsHash[layerName] != 'undefined')\r\n\t\t{\r\n\t\t\tif (this.layerEditorsHash[layerName] != false) {\r\n                this.layerEditorsHash[layerName].selectTab(selected);\r\n            }\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.layerEditorsHash[layerName] = false;\r\n\r\n\t\tvar mapName = elemProperties.mapName,\r\n\t\t\tcreateTabs = function(layerProperties)\r\n\t\t\t{\r\n\t\t\t\tlet id = 'layertabs' + layerName,\r\n\t\t\t\t\tdivProperties = _div(null,[['attr','id','properties' + id], ['css', 'height', '100%']]),\r\n\t\t\t\t\t// tabMenu,\r\n                    additionalTabs = [];\r\n\r\n\t\t\t\t// let pos = nsGmx.Utils.getDialogPos(div, true, 390),\r\n\t\t\t\tlet pos = typeof(div) === 'string' ? {left: 410, top: 230} : nsGmx.Utils.getDialogPos(div, true, 390),\r\n                    updateFunc = function()\r\n                    {\r\n                    },\r\n\t\t\t\t\tcloseFunc = function()\r\n\t\t\t\t\t{\r\n                        updateFunc();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t_this.createLoadingLayerEditorProperties(div, divProperties, layerProperties, {\r\n                    doneCallback: function()\r\n                    {\r\n                        $(divDialog).dialog('close');\r\n                    },\r\n                    additionalTabs: additionalTabs,\r\n                    selected: selected,\r\n                    createdCallback: function(layerEditor) {\r\n                        _this.layerEditorsHash[layerName] = layerEditor;\r\n                        _this.layerEditorsHash[layerName].closeFunc = closeFunc;\r\n                        _this.layerEditorsHash[layerName].updateFunc = updateFunc;\r\n                    }\r\n                });\r\n\r\n\t\t\t\tlet divDialog = showDialog(_gtxt('Слой [value0]', elemProperties.title), divProperties, 350, 470, pos.left, pos.top, null, function()\r\n                {\r\n                    closeFunc();\r\n                    delete _this.layerEditorsHash[layerName];\r\n                });\r\n\r\n\t\t\t\t// при сохранении карты сбросим все временные стили в json карты\r\n\t\t\t\tdivProperties.closeFunc = closeFunc;\r\n\t\t\t\tdivProperties.updateFunc = updateFunc;\r\n\t\t\t};\r\n\r\n\t\tif (!this.attrValues[mapName])\r\n\t\t\tthis.attrValues[mapName] = {};\r\n\r\n\t\tsendCrossDomainJSONRequest(window.serverBase + \"Layer/GetLayerInfo.ashx?WrapStyle=func&NeedAttrValues=false&LayerName=\" + layerName, function(response)\r\n\t\t{\r\n\t\t\tif (!parseResponse(response))\r\n\t\t\t\treturn;\r\n\r\n            var columns = response.Result.Columns;\r\n            var attributesHash = {};\r\n\r\n            for (var i = 0; i < columns.length; i++) {\r\n                attributesHash[columns[i].Name] = [];\r\n            }\r\n\r\n\t\t\t_this.attrValues[mapName][layerName] = new nsGmx.LazyAttributeValuesProviderFromServer(attributesHash, layerName);\r\n\r\n\t\t\tcreateTabs(response.Result);\r\n\t\t})\r\n\t}\r\n\telse if (elemProperties.type == \"Raster\")\r\n\t{\r\n\t\tif (elemProperties.LayerID)\r\n\t\t{\r\n\t\t\tif (this.layerEditorsHash[layerName])\r\n\t\t\t\treturn;\r\n\r\n\t\t\tthis.layerEditorsHash[layerName] = true;\r\n\r\n\t\t\tlet id = 'layertabs' + layerName,\r\n\t\t\t\tdivProperties = _div(null,[['attr','id','properties' + id], ['css', 'height', '100%']]),\r\n\t\t\t\tdivStyles = _div(null,[['attr','id','styles' + id], ['css', 'height', '100%'], ['css', 'overflowY', 'auto']]);\r\n\r\n\t\t\tlet layer = nsGmx.gmxMap.layersByID[layerName],\r\n\t\t\t\tparentStyle = elemProperties.styles && elemProperties.styles[0] || elemProperties;\r\n\r\n            let zoomPropertiesControl = new nsGmx.ZoomPropertiesControl(parentStyle.MinZoom, parentStyle.MaxZoom),\r\n                liMinZoom = zoomPropertiesControl.getMinLi(),\r\n                liMaxZoom = zoomPropertiesControl.getMaxLi();\r\n\r\n            $(zoomPropertiesControl).change(function()\r\n            {\r\n                layer.setZoomBounds(this.getMinZoom(), this.getMaxZoom());\r\n            });\r\n\r\n\t\t\t_(divStyles, [_ul([liMinZoom, liMaxZoom])]);\r\n\r\n\t\t\tthis.createLoadingLayerEditorProperties(div, divProperties, null, {\r\n                doneCallback: function()\r\n                {\r\n                    $(divDialog).dialog('close');\r\n                },\r\n                additionalTabs: [{title: _gtxt(\"Стили\"), name: 'styles', container: divStyles}]\r\n\r\n            });\r\n\r\n\t\t\tlet pos = nsGmx.Utils.getDialogPos(div, true, 330),\r\n\t\t\t\tcloseFunc = function()\r\n\t\t\t\t{\r\n                    elemProperties.styles = elemProperties.styles || [];\r\n                    elemProperties.styles[0] = elemProperties.styles[0] || {};\r\n\r\n\t\t\t\t\telemProperties.styles[0].MinZoom = zoomPropertiesControl.getMinZoom();\r\n\t\t\t\t\telemProperties.styles[0].MaxZoom = zoomPropertiesControl.getMaxZoom();\r\n\r\n\t\t\t\t\tdelete _this.layerEditorsHash[layerName];\r\n\r\n\t\t\t\t\ttreeView.findTreeElem(div).elem.content.properties = elemProperties;\r\n\r\n\t\t\t\t\t_this.drawingBorders.removeRoute(layerName, true);\r\n\r\n\t\t\t\t\tif ($('#drawingBorderDialog' + layerName).length)\r\n\t\t\t\t\t\tremoveDialog($('#drawingBorderDialog' + layerName)[0].parentNode);\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t};\r\n\r\n\t\t\tlet divDialog = showDialog(_gtxt('Слой [value0]', elemProperties.title), divProperties, 330, 410, pos.left, pos.top, null, closeFunc);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n            nsGmx.createMultiLayerEditorServer(elemProperties, div, treeView);\r\n        }\r\n\t} else if (elemProperties.type == \"Virtual\"){\r\n\t\tlet id = 'layertabs' + layerName;\r\n        let divProperties = _div(null,[['attr','id','properties' + id], ['css', 'height', '100%']]);\r\n\r\n        this.createLoadingLayerEditorProperties(div, divProperties, null, {\r\n            doneCallback: function() {\r\n                $(divDialog).dialog('close');\r\n            }\r\n        });\r\n\r\n        // var closeFunc = function() {\r\n        //     delete _this.layerEditorsHash[layerName];\r\n        // };\r\n\r\n        let pos = nsGmx.Utils.getDialogPos(div, true, 330);\r\n\r\n        let divDialog = showDialog(_gtxt('Слой [value0]', elemProperties.title), divProperties, 330, 410, pos.left, pos.top, null);\r\n    }\r\n}\r\n\r\nmapHelper.prototype.createWFSStylesEditor = function(parentObject, style, geometryType, divCanvas)\r\n{\r\n\tvar _this = this,\r\n\t\ttemplateStyle = {};\r\n\r\n\t$.extend(true, templateStyle, style);\r\n\r\n    var elemCanvas = _mapHelper.createStylesEditorIcon([{MinZoom:1, MaxZoom: 21, RenderStyle: style.regularStyle}], geometryType);\r\n    var spanIcon = _span([elemCanvas]);\r\n\r\n\tspanIcon.onclick = function()\r\n\t{\r\n        var listenerId = parentObject.addListener('onSetStyle', function(style)\r\n            {\r\n                var newIcon = _this.createStylesEditorIcon([{MinZoom:1,MaxZoom:21,RenderStyle:style.regularStyle}], geometryType);\r\n                $(spanIcon).empty().append(newIcon).attr('styleType', $(newIcon).attr('styleType'));\r\n            });\r\n\r\n\t\tvar canvasStyles = _div(null,[['css','marginTop','10px']]),\r\n\t\t\tcanvasCharts = _div(null,[['css','marginTop','10px']]),\r\n\t\t\tcloseFunc = function()\r\n\t\t\t{\r\n\t\t\t\t$(canvasStyles).find(\".colorSelector\").each(function()\r\n\t\t\t\t{\r\n\t\t\t\t\t$('#' + $(this).data(\"colorpickerId\")).remove();\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar layerElemCanvas = $(divCanvas).find(\"[geometryType='\" + geometryType.toUpperCase() + \"']\")[0];\r\n\t\t\t\tlayerElemCanvas.graphDataType = $(canvasCharts).find(\"select\")[0].value;\r\n\t\t\t\tlayerElemCanvas.graphDataProperties = $(canvasCharts).find(\"input\")[0].value;\r\n\r\n                parentObject.removeMapStateListener('onSetStyle', listenerId);\r\n\t\t\t};\r\n\r\n\t\tvar id = 'wfstabs' + String(Math.random()).substring(2, 9),\r\n\t\t\ttabMenu = _div([_ul([_li([_a([_t(_gtxt(\"Стили\"))],[['attr','href','#styles' + id]])]),\r\n\t\t\t\t\t\t\t\t _li([_a([_t(_gtxt(\"Диаграммы\"))],[['attr','href','#graph' + id]])])])]),\r\n\t\t\tdivStyles = _div(null,[['attr','id','styles' + id]]),\r\n\t\t\tdivGraph = _div(null,[['attr','id','graph' + id]]);\r\n\r\n\t\t_(tabMenu, [divStyles, divGraph]);\r\n\r\n        window.gmxCore.loadModule('LayerStylesEditor').done(function(module) {\r\n            var resObject = module.createStyleEditor(canvasStyles, templateStyle, geometryType, false);\r\n\r\n            $(resObject).change(function()\r\n            {\r\n                nsGmx.Utils.setMapObjectStyle(parentObject, templateStyle);\r\n            })\r\n        });\r\n\r\n\t\tcanvasStyles.firstChild.style.marginLeft = '0px';\r\n\t\t_(divStyles, [canvasStyles]);\r\n\r\n\t\t_mapHelper.createChartsEditor(canvasCharts, $(divCanvas).find(\"[geometryType='\" + geometryType.toUpperCase() + \"']\")[0]);\r\n\t\tcanvasCharts.firstChild.style.marginLeft = '0px';\r\n\t\t_(divGraph, [canvasCharts]);\r\n\r\n\t\tvar pos = nsGmx.Utils.getDialogPos(spanIcon, false, 160);\r\n\t\tshowDialog(_gtxt('Редактирование стилей объекта'), tabMenu, 330, 180, pos.left, pos.top, false, closeFunc);\r\n\r\n\t\t$(tabMenu).tabs({active: 0});\r\n\t}\r\n\r\n\tspanIcon.getStyle = function()\r\n\t{\r\n\t\treturn templateStyle;\r\n\t}\r\n\r\n    return spanIcon;\r\n}\r\n\r\nmapHelper.prototype.createChartsEditor = function(parent, elemCanvas)\r\n{\r\n\tvar graphTypeSel = nsGmx.Utils._select([_option([_t(_gtxt(\"График по времени\"))], [['attr','value','func']]),\r\n\t\t\t\t\t\t\t\t_option([_t(_gtxt(\"Круговая\"))], [['attr','value','pie']])], [['dir','className','selectStyle'],['css','width','180px']]),\r\n\t\tpropertiesMask = _input(null, [['dir','className','inputStyle'],['css','width','180px']]);\r\n\r\n\tswitchSelect(graphTypeSel, elemCanvas.graphDataType);\r\n\tpropertiesMask.value = elemCanvas.graphDataProperties;\r\n\r\n\t_(parent, [_table([_tbody([_tr([_td([_t(_gtxt(\"Тип\"))], [['css','width','100px']]), _td([graphTypeSel])]),\r\n\t\t\t\t\t\t\t\t_tr([_td([_t(_gtxt(\"Маска атрибутов\"))]), _td([propertiesMask])])])])]);\r\n}\r\n\r\nmapHelper.prototype.createMultiStyle = function(elem, treeView, multiStyleParent, treeviewFlag, layerManagerFlag)\r\n{\r\n\tvar filters = window.newStyles ? elem.gmxStyles.styles : elem.styles;\r\n\r\n\tif (filters.length < 2)\r\n\t{\r\n\t\tmultiStyleParent.style.display = 'none';\r\n\r\n\t\treturn;\r\n\t}\r\n\r\n\tmultiStyleParent.style.display = '';\r\n\r\n\tvar ulFilters = _ul();\r\n\r\n\tfor (var i = 0; i < filters.length; i++) {\r\n\t\tvar checkbox = $('<input type=\"checkbox\" class=\"multistlye-visibility-checkbox\">'),\r\n\t\t// var eye = $('<span class=\"multistyle-visibility-icon\"><svg><use xlink:href=\"#transparency-eye\"></use></svg></span>'),\r\n\t\t\ticon = this.createStylesEditorIcon([filters[i]], elem.GeometryType.toLowerCase(), {addTitle: !layerManagerFlag}),\r\n\t\t\tname = filters[i].Name || filters[i].Filter || 'Без имени ' + (i + 1),\r\n            iconSpan = _span([icon]),\r\n\t\t\tli = _li([_div([$(checkbox)[0], iconSpan, _span([_t(name)],[['css','marginLeft','3px']])])]);\r\n\r\n        $(iconSpan).attr('styleType', $(icon).attr('styleType'));\r\n\t\t$(checkbox).prop('checked', filters[i].MinZoom !== 25);\r\n\r\n\t\tbindCheckboxHandler(checkbox, i);\r\n\r\n\t\tif (!layerManagerFlag) {\r\n\t\t\t(function(i) {\r\n\t\t\t\ticonSpan.onclick = function() {\r\n                    nsGmx.createStylesDialog(elem, treeView, i);\r\n\t\t\t\t\t//_mapHelper.createLayerEditor(multiStyleParent.parentNode, treeView, 'styles', i);\r\n\t\t\t\t}\r\n\t\t\t})(i);\r\n\t\t}\r\n\r\n\t\t_(ulFilters, [li])\r\n\t}\r\n\r\n\tfunction bindCheckboxHandler(checkbox, index) {\r\n\t\t$(checkbox).on('change', function (e) {\r\n\t\t\tvar styleVisibilityProps = {\r\n\t\t\t\telem: elem,\r\n\t\t\t\tstyleIndex: index,\r\n\t\t\t\tshow: e.target.checked\r\n\t\t\t};\r\n\r\n\t\t\t$(_layersTree).triggerHandler('styleVisibilityChange', [styleVisibilityProps]);\r\n\t\t})\r\n\t}\r\n\r\n\tulFilters.style.display = 'none';\r\n\tulFilters.className = 'hiddenTree';\r\n\r\n\t_(multiStyleParent, [_ul([_li([_div([_t(_gtxt(\"Стили слоя\"))]), ulFilters])])]);\r\n\r\n\tif (typeof treeviewFlag == 'undefined')\r\n        $(multiStyleParent.firstChild).treeview();\r\n}\r\n\r\nmapHelper.prototype.load = function()\r\n{\r\n\tvar _this = this;\r\n\r\n\tif (!this.builded)\r\n\t{\r\n\t\tvar fileName;\r\n\r\n\t\tif (typeof window.gmxViewerUI !== 'undefined' && typeof window.gmxViewerUI.usageFilePrefix !== 'undefined')\r\n\t\t\tfileName = window.gmxViewerUI.usageFilePrefix;\r\n\t\telse\r\n\t\t\tfileName = window.gmxJSHost ? window.gmxJSHost + \"usageHelp\" : \"usageHelp\";\r\n\r\n\t\tfileName += _gtxt(\"helpPostfix\");\r\n\r\n\t\t_mapHelper._loadHelpTextFromFile(fileName, function( text )\r\n\t\t{\r\n\t\t\tvar div = _div(null, [['dir','className','help']]);\r\n\t\t\tdiv.innerHTML = text;\r\n\t\t\t_(_this.workCanvas, [div]);\r\n\t\t});\r\n\r\n\t\tthis.builded = true;\r\n\t}\r\n}\r\n\r\nmapHelper.prototype._loadHelpTextFromFile = function( fileName, callback, num, data )\r\n{\r\n\tvar proceess = function( text ) {\r\n\t\tcallback(Handlebars.compile(text)({gmxVersion: num, gmxData: data}));\r\n\t}\r\n\r\n\tif (fileName.indexOf(\"http://\") !== 0 || fileName.indexOf(\"https://\") !== 0)\r\n\t\t$.ajax({url: fileName, success: proceess});\r\n\telse\r\n\t\tsendCrossDomainJSONRequest(window.serverBase + \"ApiSave.ashx?get=\" + encodeURIComponent(fileName), function(response)\r\n\t\t{\r\n\t\t\tproceess(response.Result);\r\n\t\t});\r\n}\r\n\r\nmapHelper.prototype.version = function()\r\n{\r\n    var div = $(\"<div class='gmx-about'></div>\");\r\n\r\n    var fileName;\r\n\r\n    if (typeof window.gmxViewerUI !== 'undefined' && typeof window.gmxViewerUI.helpFilePrefix !== 'undefined')\r\n        fileName = window.gmxViewerUI.helpFilePrefix;\r\n    else\r\n        fileName = window.gmxJSHost ? window.gmxJSHost + \"help\" : \"help\";\r\n\r\n    fileName += _gtxt(\"helpPostfix\");\r\n\r\n    _mapHelper._loadHelpTextFromFile( fileName, function(text)\r\n    {\r\n        div.html(text);\r\n        showDialog(_gtxt(\"О проекте\"), div[0], 500, 300, false, false);\r\n    }, window.nsGmx.GeomixerFrameworkVersion, '' );\r\n}\r\n\r\nmapHelper.prototype.print = function() {\r\n\tlet centerControl = nsGmx.leafletMap.gmxControlsManager.get('center'),\r\n\t\tmap = nsGmx.leafletMap,\r\n\t\ttoggleMode = function(isPreviewMode) {\r\n\t\t\tmap.gmxControlsManager.get('hide').setActive(!isPreviewMode);\r\n\t\t\twindow.printMode = isPreviewMode;\r\n\t\t\t$('#header, #leftMenu, #leftCollapser, #bottomContent, #tooltip, .ui-datepicker-div').toggleClass('print-preview-hide', isPreviewMode);\r\n\t\t\t$('#all').toggleClass('print-preview-all', isPreviewMode);\r\n\t\t\t$('.ui-dialog').toggle();\r\n\t\t\t$('.leaflet-gmx-iconSvg-hide').toggle();\r\n\t\t\t$('.leaflet-control-container').toggle();\r\n\t\t};\r\n\r\n    toggleMode(true);\r\n\tcenterControl.removeFrom ? centerControl.removeFrom(map) : centerControl.remove();\r\n\r\n    var ui = $(Handlebars.compile('<div class=\"print-ui\"><span class=\"print-ui-inner\">' +\r\n        '<button class=\"print-ui-close\">Закрыть</button>' +\r\n        '<button class=\"print-ui-print\">Печать</button>' +\r\n\t\t\t'<span class=\"layoutContainer\">' +\r\n\t\t\t\t'<label><input type=\"radio\" name=\"layout\" value=\"portrait\" checked=\"true\">' + _gtxt('портретная') + '</label>' +\r\n\t\t\t\t'<label><input type=\"radio\" name=\"layout\" value=\"layout\">' + _gtxt('альбомная') + '</label>' +\r\n\t\t\t'</span>' +\r\n\t\t'</span>' +\r\n\t\t'</div>')());\r\n\r\n\tvar BIG = 1150,\r\n\t\tSMALL = BIG / 1.4142\r\n\tvar layout = {\r\n\t\twidth: SMALL + 'px',\r\n\t\theight: BIG + 'px'\r\n\t};\r\n\r\n\tui.find('input[value=\"portrait\"]').click(function() {\r\n\t\tthis.checked = true;\r\n\t\tlayout.width = SMALL + 'px';\r\n\t\tlayout.height = BIG + 'px';\r\n\r\n\t\t$('#flash').css({\r\n\t\t\twidth: layout.width,\r\n\t\t\theight: layout.height\r\n\t\t});\r\n\r\n\t    map.invalidateSize();\r\n\t});\r\n\r\n\tui.find('input[value=\"layout\"]').click(function() {\r\n\t\tthis.checked = true;\r\n\t\tlayout.width = BIG + 'px';\r\n\t\tlayout.height = SMALL + 'px';\r\n\r\n\t\t$('#flash').css({\r\n\t\t\twidth: layout.width,\r\n\t\t\theight: layout.height\r\n\t\t});\r\n\r\n\t    map.invalidateSize();\r\n\t});\r\n\r\n\tui.find('.print-ui-print').click(function() {\r\n\t\twindow.print();\r\n\t})\r\n\r\n    ui.find('.print-ui-close').click(function() {\r\n        toggleMode(false);\r\n\t\tcenterControl.addTo(map);\r\n\r\n        $('#flash').css({\r\n            marginLeft: '0px',\r\n            marginTop: '0px'\r\n        });\r\n\r\n        window.resizeAll();\r\n        ui.remove();\r\n    });\r\n\r\n    $('body').append(ui);\r\n\r\n    $('#flash').css({\r\n\t\ttop: '0px',\r\n\t\tleft: '0px',\r\n\t\twidth: layout.width,\r\n\t\theight: layout.height\r\n\t});\r\n\r\n    map.invalidateSize();\r\n}\r\n\r\n// экспортный режим редактора\r\nmapHelper.prototype.exportMap = function(params) {\r\n\tvar map = nsGmx.leafletMap,\r\n\t\thide = map.gmxControlsManager.get('hide'),\r\n\t\tcenter = map.gmxControlsManager.get('center');\r\n\r\n\thide.setActive(false);\r\n\r\n\tcenter.removeFrom ? center.removeFrom(map) : center.remove();\r\n\r\n    window.exportMode = true;\r\n\r\n\tif (params.grid) {\r\n\t\tif (!nsGmx.gridManager.gridControl) {\r\n\t\t\tnsGmx.gridManager.setState({isActive: true});\r\n\t\t}\r\n\t\tvar grid = nsGmx.gridManager.gridControl;\r\n\r\n\t\tparams.exportBounds && grid.setFixBounds(L.latLngBounds(params.exportBounds._southWest, params.exportBounds._northEast));\r\n\r\n\t} else {\r\n\t\tnsGmx.gridManager.setState(false);\r\n\t}\r\n\r\n    $('#header, #leftMenu, #leftCollapser, #bottomContent, #tooltip, .ui-datepicker-div').toggleClass('print-preview-hide', true);\r\n\r\n    $('#all').toggleClass('print-preview-all', true);\r\n\r\n\tif (params.controls) {\r\n\t\t$('.gmx-slider-control').hide();\r\n\t\tvar cs = nsGmx.leafletMap.gmxControlsManager.getAll();\r\n\t\tfor (var key in cs) {\r\n\t\t\tif (!(key in params.controls)) {\r\n\t\t\t\tnsGmx.leafletMap.removeControl(cs[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\t$('.leaflet-control-container').hide();\r\n\t}\r\n\r\n    // $('#leftContent').mCustomScrollbar({live:\"off\"});\r\n\r\n\tvar exportCssParams = {\r\n\t\ttop: '0px',\r\n\t\tleft: '0px',\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t};\r\n\r\n\t$('#flash').css(exportCssParams);\r\n\tmap.invalidateSize();\r\n}\r\n\r\n//вызывает callback для всех слоёв поддерева treeElem. Параметры: callback(layerInfo, visibilityFlag)\r\nmapHelper.prototype.findChilds = function(treeElem, callback, flag)\r\n{\r\n\tvar childsArr = treeElem.content ? treeElem.content.children : treeElem.children;\r\n\tif (childsArr)\r\n\t{\r\n\t\tfor (var i = 0; i < childsArr.length; i++)\r\n\t\t{\r\n\t\t\tvar child = childsArr[i];\r\n\r\n\t\t\tif (child.type == 'group')\r\n\t\t\t\tthis.findChilds(child, callback, flag && child.content.properties.visible)\r\n\t\t\telse\r\n\t\t\t\tcallback(child, flag && child.content.properties.visible);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmapHelper.prototype.findTreeElems = function(treeElem, callback, flag)\r\n{\r\n\tvar childsArr = treeElem.content ? treeElem.content.children : treeElem.children;\r\n\r\n\tfor (var i = 0; i < childsArr.length; i++)\r\n\t{\r\n\t\tvar child = childsArr[i];\r\n\r\n\t\tif (child.type == 'group')\r\n\t\t{\r\n\t\t\tcallback(child, flag, treeElem.content ? treeElem.content.properties.list : treeElem.properties.list, i);\r\n\r\n\t\t\tthis.findTreeElems(child, callback, flag && child.content.properties.visible, treeElem.content ? treeElem.content.properties.list : treeElem.properties.list)\r\n\t\t}\r\n\t\telse\r\n\t\t\tcallback(child, flag, treeElem.content ? treeElem.content.properties.list : treeElem.properties.list, i);\r\n\t}\r\n}\r\n\r\n/**\r\n *  Модифицирует объекты внутри векторного слоя, отправляя изменения на сервер и информируя об этом API\r\n *\r\n * @memberOf _mapHelper\r\n * @name modifyObjectLayer\r\n * @function\r\n * @param {String} layerName Имя слоя\r\n * @param {Object[]} objs Массив описания объектов. Каждое описание представляет из себя объект:\r\n *\r\n *  * id {String} ID объекта слоя, над которым производятся изменения (только для модификации и удаления)\r\n *  * geometry Описание геометрии (вставка и изменение). GeoJSON\r\n *  * source: {rc: <name КР-источника>, rcobj: <id объекта внутри КР>}\r\n *  * properties Свойства объекта (вставка и изменение)\r\n *  * action {'delete'|'insert'|'update'} Производимое действие. Если не указано, то вычисляется следующим образом:\r\n *    * Если не указан id, то вставка\r\n *    * Если указан id, то модифицируем\r\n *    * Для удаления объекта нужно явно прописать параметр\r\n * @param {String} [crs='EPSG:3395'] Название системы координат геометрии объектов. Поддерживаются 3395, 4326, 3857\r\n * @return {jQuery.Deferred} Ресолвится в соответствии с ответом сервера\r\n*/\r\nmapHelper.prototype.modifyObjectLayer = function(layerName, objs, crs)\r\n{\r\n    var def = $.Deferred();\r\n\r\n    $.each(objs, function(i, obj)\r\n    {\r\n        obj.action = obj.action || (obj.id ? 'update' : 'insert');\r\n    });\r\n    var params = {\r\n        WrapStyle: 'window',\r\n        LayerName: layerName,\r\n        objects: JSON.stringify(objs)\r\n    };\r\n    if (crs) {\r\n        params.geometry_cs = crs;\r\n    }\r\n    sendCrossDomainPostRequest(window.serverBase + \"VectorLayer/ModifyVectorObjects.ashx\",\r\n        params\r\n        ,\r\n        function(addResponse)\r\n        {\r\n\t\t\tif (!parseResponse(addResponse))\r\n            {\r\n                def.reject();\r\n                return;\r\n            }\r\n\r\n            var mapLayer = nsGmx.gmxMap.layersByID[layerName];\r\n            if (mapLayer) {\r\n                L.gmx.layersVersion.chkVersion(mapLayer);\r\n            }\r\n\t\t\tdef.resolve();\r\n        }\r\n    )\r\n\r\n    return def.promise();\r\n}\r\n\r\n/** Запросить с сервера объекты векторного слоя\r\n * @memberOf _mapHelper\r\n * @name searchObjectLayer\r\n * @function\r\n * @param {String} layerName ID векторного слоя\r\n * @param {Object} options Параметры запроса\r\n * @param {String} [options.query] SQL-подобное выражение для выборки объектов\r\n * @param {Boolean} [options.includeGeometry=false] Возвращать ли геометрию с сервера или нет\r\n * @param {Object} [options.border=null] GeoJSON для ограничения выборки по геометрии\r\n * @param {Number} [options.page=0] номер страницы результатов (0 - результаты с самого первого)\r\n * @param {Number} [options.pagesize=100000] максимальное кол-во объектов в ответе\r\n * @return {jQuery.Deferred} Promise, который ресолвится массивом найденных объектов. Каждый объект имеет свойства properties и, возможно, geometry\r\n*/\r\nmapHelper.prototype.searchObjectLayer = function(layerName, options) {\r\n    options = options || {};\r\n\r\n    var def = $.Deferred();\r\n\r\n    var requestParams = {\r\n        WrapStyle: 'message',\r\n        layer: layerName\r\n    }\r\n\r\n    if (options.query) {\r\n        requestParams.query = options.query;\r\n    }\r\n\r\n    if (options.includeGeometry) {\r\n        requestParams.geometry = true;\r\n    }\r\n\r\n    if (options.border) {\r\n        requestParams.border = JSON.stringify(options.border);\r\n    }\r\n\r\n    requestParams.page = options.page || 0;\r\n    requestParams.pagesize = options.pagesize || 100000;\r\n\r\n    sendCrossDomainPostRequest(window.serverBase + \"VectorLayer/Search.ashx\", requestParams, function(response) {\r\n        if (!parseResponse(response)) {\r\n            def.reject(response);\r\n            return;\r\n        }\r\n        var values = response.Result.values;\r\n        var fields = response.Result.fields;\r\n        var objects = [];\r\n        for (var i = 0; i < values.length; i++) {\r\n            var obj = {properties: {}};\r\n\r\n            for (var p = 0; p < values[i].length; p++) {\r\n                if (fields[p] === 'geomixergeojson') {\r\n                    obj.geometry = values[i][p];\r\n                } else {\r\n                    obj.properties[fields[p]] = values[i][p];\r\n                }\r\n            }\r\n            objects.push(obj);\r\n        }\r\n\r\n        def.resolve(objects);\r\n    });\r\n\r\n    return def.promise();\r\n}\r\n\r\n/** Скачать векторный слой с сервера\r\n * @memberOf _mapHelper\r\n * @name downloadVectorLayer\r\n * @function\r\n * @param {Object} params Параметры запроса\r\n * @param {String} params.name ID векторного слоя, который нужно скачать\r\n * @param {String} params.host хост, с которого будем скачивать слой\r\n * @param {String} [params.format=Shape] В каком формате хотим получить (Shape, Tab, gpx, csv, csv_wkt, excel, kml или несколько через запятую)\r\n * @param {String} [params.query] SQL запрос для сохранения выборки данных вместо всех данных слоя\r\n * @param {Array} [params.columns] Атрибуты, которые нужно скачать. Массив объектов с ключами {Value, Alias}\r\n*/\r\nmapHelper.prototype.downloadVectorLayer = function(params) {\r\n    var requestParams = {\r\n        t: params.name\r\n    };\r\n\r\n    if (params.format) {\r\n        requestParams.format = params.format;\r\n    }\r\n\r\n    if (params.query) {\r\n        requestParams.query = params.query;\r\n    }\r\n\r\n    if (params.columns) {\r\n        requestParams.columns = JSON.stringify(params.columns);\r\n    }\r\n\r\n    sendCrossDomainPostRequest(window.location.protocol + \"//\" + params.host + \"/\" + \"DownloadLayer.ashx\", requestParams);\r\n\r\n\r\n\t// if (window.FormData) {\r\n\t//\r\n\t// \tvar form = document.createElement(\"form\");\r\n\t// \tform.style.display = 'none';\r\n\t// \tform.setAttribute('enctype', 'multipart/form-data');\r\n\t// \tform.name = 'uploadFile';\r\n\t//\r\n\t// \tvar hiddenParamsDiv = document.createElement(\"div\");\r\n\t// \thiddenParamsDiv.style.display = 'none';\r\n\t//\r\n\t// \tfor (var paramName in requestParams) {\r\n\t// \t\tvar input = document.createElement(\"input\");\r\n\t// \t\tvar value = typeof requestParams[paramName] !== 'undefined' ? requestParams[paramName] : '';\r\n\t//\r\n\t// \t\tinput.setAttribute('type', 'hidden');\r\n\t// \t\tinput.setAttribute('name', paramName);\r\n\t// \t\tinput.setAttribute('value', value);\r\n\t//\r\n\t// \t\thiddenParamsDiv.appendChild(input)\r\n\t// \t}\r\n\t//\r\n\t//     form.appendChild(hiddenParamsDiv);\r\n\t//\r\n\t// \tvar formData = new FormData(form);\r\n\t//\r\n\t//\r\n\t// \tvar xhr = new XMLHttpRequest();\r\n\t// \t// :attachment; filename=\"suda_15062017_Sentinel_poly.zip\";\r\n\t// \txhr.open('POST', /*\"http://\" + /*params.host*/ window.serverBase + /*\"/\" + */\"DownloadLayer.ashx\");\r\n\t//\r\n\t// \t// xhr.setRequestHeader('Content-Disposition', 'attachment');\r\n\t// \txhr.onload = function () {\r\n\t// \t\tif (xhr.status === 200) {\r\n\t// \t\t\t// var blob = new Blob([xhr.response], {type: \"application/zip\"});\r\n\t// \t\t\tvar blob = xhr.response;\r\n\t// \t\t\tconsole.log(xhr);\r\n\t// \t\t\tconsole.log(blob);\r\n\t// \t\t\tsaveData(blob, params.name);\r\n\t// \t\t}\r\n\t// \t}\r\n\t//\r\n\t// \txhr.withCredentials = true;\r\n\t// \txhr.responseType = \"blob\";\r\n\t// \txhr.send(formData);\r\n\t//\r\n\t// \tfunction saveData(blob, name) {\r\n\t// \t\tvar url = window.URL.createObjectURL(blob),\r\n\t// \t\ta = document.createElement(\"a\");\r\n\t// \t\tconsole.log(url);\r\n\t// \t\tdocument.body.appendChild(a);\r\n\t// \t\ta.style = \"display: none\";\r\n\t// \t\ta.href = url;\r\n\t// \t\ta.download = name;\r\n\t// \t\t// a.click();\r\n\t// \t\twindow.URL.revokeObjectURL(url);\r\n\t// \t};\r\n\t// }\r\n}\r\n\r\nvar _mapHelper = new mapHelper();\r\nwindow._mapHelper = _mapHelper;\r\nwindow.mapHelper = mapHelper;\r\n\r\nmapHelp.mapHelp.load = function()\r\n{\r\n\tvar alreadyLoaded = _mapHelper.createWorkCanvas(arguments[0]);\r\n\r\n\tif (!alreadyLoaded)\r\n\t\t_mapHelper.load()\r\n}\r\n\r\nmapHelp.mapHelp.unload = function()\r\n{\r\n}\r\n\r\nmapHelp.serviceHelp.load = function()\r\n{\r\n\tvar alreadyLoaded = _serviceHelper.createWorkCanvas(arguments[0]);\r\n\r\n\tif (!alreadyLoaded)\r\n\t\t_serviceHelper.load()\r\n}\r\nmapHelp.serviceHelp.unload = function()\r\n{\r\n}\r\n\r\nvar serviceHelper = function()\r\n{\r\n\tthis.builded = false;\r\n}\r\n\r\nserviceHelper.prototype = new leftMenu();\r\n\r\nserviceHelper.prototype.load = function()\r\n{\r\n\tvar _this = this;\r\n\tif (!this.builded)\r\n\t{\r\n\t\tvar fileName;\r\n\r\n\t\tif (typeof window.gmxViewerUI !== 'undefined' && typeof window.gmxViewerUI.servicesFilePrefix !== 'undefined')\r\n\t\t\tfileName = window.gmxViewerUI.servicesFilePrefix;\r\n\t\telse\r\n\t\t\tfileName = window.gmxJSHost ? window.gmxJSHost + \"servicesHelp\" : \"servicesHelp\";\r\n\r\n\t\tfileName += _gtxt(\"helpPostfix\");\r\n\r\n\t\t_mapHelper._loadHelpTextFromFile(fileName, function( text )\r\n\t\t{\r\n\t\t\tvar div = _div(null, [['dir','className','help']]);\r\n\t\t\tdiv.innerHTML = text;\r\n\t\t\t_(_this.workCanvas, [div]);\r\n\t\t});\r\n\r\n\t\tthis.builded = true;\r\n\t}\r\n}\r\n\r\nvar _serviceHelper = new serviceHelper();\r\nwindow._serviceHelper = _serviceHelper;\r\n\r\nmapHelp.tabs.load = function()\r\n{\r\n\tvar alreadyLoaded = _queryTabs.createWorkCanvas(arguments[0]);\r\n\r\n\tif (!alreadyLoaded)\r\n\t\t_queryTabs.load()\r\n}\r\nmapHelp.tabs.unload = function()\r\n{\r\n}\r\n\r\nmapHelp.externalMaps.load = function()\r\n{\r\n\tvar alreadyLoaded = window._queryExternalMaps.createWorkCanvas(arguments[0]);\r\n\r\n\tif (!alreadyLoaded)\r\n\t\twindow._queryExternalMaps.load();\r\n}\r\nmapHelp.externalMaps.unload = function()\r\n{\r\n}\r\n\r\n//Динамически подгружаемые части вьюера\r\n\r\n//Редактирование мультислоя\r\nnsGmx.createMultiLayerEditorServer = window.gmxCore.createDeferredFunction('MultiLayerEditor', 'createMultiLayerEditorServer');\r\nnsGmx.createMultiLayerEditorNew = window.gmxCore.createDeferredFunction('MultiLayerEditor', 'createMultiLayerEditorNew');\r\n\r\n//Редактирование карты и группы\r\nnsGmx.addSubGroup = window.gmxCore.createDeferredFunction('GroupEditor', 'addSubGroup');\r\nnsGmx.createGroupEditor = window.gmxCore.createDeferredFunction('GroupEditor', 'createGroupEditor');\r\nnsGmx.createMapEditor = window.gmxCore.createDeferredFunction('GroupEditor', 'createMapEditor');\r\n\r\n//Редактирование свойств слоя\r\nnsGmx.createLayerEditor = window.gmxCore.createDeferredFunction('LayerEditor', 'createLayerEditor');\r\n\r\n//Редактирование стилей векторного слоя\r\nnsGmx.createStylesDialog = window.gmxCore.createDeferredFunction('LayerStylesEditor', 'createStylesDialog');\r\n\r\n//Библиотека стилей\r\nnsGmx.showStyleLibraryDialog = window.gmxCore.createDeferredFunction('StyleLibrary', 'showStyleLibraryDialog');\r\n\r\n\r\nexport {mapHelp, mapHelper, _mapHelper};","/** Менеджер аудетификационной информации системы. Умеет запрашивать у сервера текущий статус пользователя,\r\n хранит информацию о ролях и допустимых действиях пользователей с этой ролью.\r\n @memberOf nsGmx\r\n @class\r\n @name AuthManager\r\n*/\r\nimport nsGmx from './nsGmx.js';\r\nimport {\r\n    sendCrossDomainJSONRequest,\r\n    sendCrossDomainPostRequest,\r\n    parseResponse,\r\n} from './utilities.js';\r\n\r\n(function($)\r\n{\r\n    $.extend(nsGmx, {\r\n        ROLE_ADMIN        : 'admin',\r\n        ROLE_USER         : 'user',\r\n        ROLE_GUEST        : 'guest',\r\n        ROLE_UNAUTHORIZED : undefined,\r\n\r\n        ACTION_CREATE_LAYERS        : 'createData',      // Создавать новые слои (векторные и растровые)\r\n        ACTION_CREATE_MAP           : 'createMap',       // Cоздавать новые карты\r\n        ACTION_SAVE_MAP             : 'saveMap',         // Сохранять карту (нужны права редактирования на карту)\r\n        ACTION_CHANGE_MAP_TYPE      : 'changeType',      // Менять тип карты (публичная/открытая/закрытая и т.п.)\r\n        ACTION_SEE_OPEN_MAP_LIST    : 'openMap',         // Видеть список публичных карт\r\n        ACTION_SEE_PRIVATE_MAP_LIST : 'privateMap',      // Видеть спискок всех карт\r\n        ACTION_SEE_MAP_RIGHTS       : 'seeRights',       // Видеть и редактировать права пользователей (для объектов, владельцем которых является)\r\n        ACTION_SEE_FILE_STRUCTURE   : 'seeFiles',        // Видеть всю файловую структуру сервера, а не только свою дом. директорию\r\n        ACTION_SEE_ALL_USERS        : 'seeUsers',        // Видеть список всех пользователей\r\n        ACTION_SEE_USER_FULLNAME    : 'seeUserFullname', // Видеть полные имена и логины пользователей (а не только псевдонимы)\r\n        ACTION_UPLOAD_FILES         : 'uploadFiles'      // Загружать файлы на сервер через web-интерфейс\r\n    });\r\n\r\n    var _actions = {};\r\n    _actions[nsGmx.ROLE_ADMIN] = {};\r\n    _actions[nsGmx.ROLE_ADMIN][nsGmx.ACTION_CREATE_LAYERS       ] = true;\r\n    _actions[nsGmx.ROLE_ADMIN][nsGmx.ACTION_CREATE_MAP          ] = true;\r\n    _actions[nsGmx.ROLE_ADMIN][nsGmx.ACTION_SAVE_MAP            ] = true;\r\n    _actions[nsGmx.ROLE_ADMIN][nsGmx.ACTION_SEE_OPEN_MAP_LIST   ] = true;\r\n    _actions[nsGmx.ROLE_ADMIN][nsGmx.ACTION_SEE_PRIVATE_MAP_LIST] = true;\r\n    _actions[nsGmx.ROLE_ADMIN][nsGmx.ACTION_CHANGE_MAP_TYPE     ] = true;\r\n    _actions[nsGmx.ROLE_ADMIN][nsGmx.ACTION_SEE_MAP_RIGHTS      ] = true;\r\n    _actions[nsGmx.ROLE_ADMIN][nsGmx.ACTION_SEE_FILE_STRUCTURE  ] = true;\r\n    _actions[nsGmx.ROLE_ADMIN][nsGmx.ACTION_SEE_ALL_USERS       ] = true;\r\n    _actions[nsGmx.ROLE_ADMIN][nsGmx.ACTION_SEE_USER_FULLNAME   ] = true;\r\n    _actions[nsGmx.ROLE_ADMIN][nsGmx.ACTION_UPLOAD_FILES        ] = true;\r\n\r\n    _actions[nsGmx.ROLE_USER] = {};\r\n    _actions[nsGmx.ROLE_USER][nsGmx.ACTION_CREATE_LAYERS     ] = true;\r\n    _actions[nsGmx.ROLE_USER][nsGmx.ACTION_CREATE_MAP        ] = true;\r\n    _actions[nsGmx.ROLE_USER][nsGmx.ACTION_SAVE_MAP          ] = true;\r\n    _actions[nsGmx.ROLE_USER][nsGmx.ACTION_SEE_OPEN_MAP_LIST ] = true;\r\n    _actions[nsGmx.ROLE_USER][nsGmx.ACTION_SEE_MAP_RIGHTS    ] = true;\r\n    _actions[nsGmx.ROLE_USER][nsGmx.ACTION_UPLOAD_FILES      ] = true;\r\n\r\n    _actions[nsGmx.ROLE_GUEST] = {}\r\n    _actions[nsGmx.ROLE_GUEST][nsGmx.ACTION_SEE_OPEN_MAP_LIST ] = true;\r\n    _actions[nsGmx.ROLE_GUEST][nsGmx.ACTION_SAVE_MAP          ] = true;\r\n\r\n    nsGmx.AuthManager = new function()\r\n    {\r\n        var _userInfo = null;\r\n        var _this = this;\r\n\r\n        this.getLogin = function()\r\n        {\r\n            if (!_userInfo) return null;\r\n            return _userInfo.Login || null;\r\n        };\r\n\r\n        this.getNickname = function()\r\n        {\r\n            if (!_userInfo) return null;\r\n            return _userInfo.Nickname || null;\r\n        };\r\n\r\n        this.getFullname = function()\r\n        {\r\n            if (!_userInfo) return null;\r\n            return _userInfo.FullName || null;\r\n        };\r\n\r\n        this.getUserFolder = function()\r\n        {\r\n            if (!_userInfo) return null;\r\n            return _userInfo.Folder;\r\n        };\r\n\r\n        this.isRole = function(role)\r\n        {\r\n\r\n            return _userInfo && _userInfo.Role === role;\r\n        };\r\n\r\n        this.canDoAction = function(action)\r\n        {\r\n            return _userInfo && _userInfo.Role in _actions && action in _actions[_userInfo.Role];\r\n        };\r\n\r\n        this.isAccounts = function()\r\n        {\r\n            return _userInfo && _userInfo.IsAccounts;\r\n        };\r\n\r\n        this.isLogin = function()\r\n        {\r\n            return _userInfo && _userInfo.Login !== false && _userInfo.Role !== this.ROLE_UNAUTHORIZED;\r\n        };\r\n\r\n        this.setUserInfo = function(userInfo)\r\n        {\r\n            _userInfo = $.extend({}, {IsAccounts: false, Role: this.ROLE_UNAUTHORIZED}, userInfo);\r\n            $(this).triggerHandler('change');\r\n        };\r\n\r\n        this.checkUserInfo = function(callback, errorCallback)\r\n        {\r\n            //var isTokenUsed = false;\r\n            var _processResponse = function( response )\r\n            {\r\n                var resOk = parseResponse(response);\r\n\r\n                !resOk && errorCallback && errorCallback();\r\n\r\n                if (response.Result == null || !resOk)\r\n                {\r\n                    // юзер не авторизован\r\n                    _this.setUserInfo({Login: false});\r\n                }\r\n                else\r\n                {\r\n                    _this.setUserInfo(response.Result);\r\n                }\r\n\r\n                resOk && callback && callback();\r\n            }\r\n\r\n\r\n            for (let iProvider = 0; iProvider < checkProviders.length; iProvider++)\r\n            {\r\n                if (checkProviders[iProvider].canAuth())\r\n                {\r\n                    checkProviders[iProvider].doAuth(callback, errorCallback);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            sendCrossDomainJSONRequest(window.serverBase + 'User/GetUserInfo.ashx?WrapStyle=func', function(response) {\r\n                if (response.Status === 'ok' && !response.Result && window.mapsSite && window.gmxAuthServer) {\r\n                    let callbackPath = location.href.match(/(.*)\\//)[0] + 'oAuthCallback.html';\r\n                    nsGmx.Utils.login(callbackPath, window.serverBase + 'oAuth/', function(userInfo) {\r\n                        _processResponse({Status: 'ok', Result: userInfo || null});\r\n                    }, null, true);\r\n                } else {\r\n                    doAuthServerLogin(response.Result && response.Result.Token);\r\n                    _processResponse(response);\r\n                }\r\n            })\r\n        }\r\n\r\n        this.login = function(login, password, callback, errorCallback)\r\n        {\r\n            sendCrossDomainPostRequest(window.serverBase + \"Login.ashx\", {WrapStyle: 'message', login: login, pass: password}, function(response)\r\n            {\r\n                if (response.Status == 'ok' && response.Result)\r\n                {\r\n                    _this.setUserInfo(response.Result);\r\n\r\n                    doAuthServerLogin(response.Result && response.Result.Token);\r\n\r\n                    callback && callback();\r\n                }\r\n                else\r\n                {\r\n                    if (response.Status === 'auth' && ('Result' in response) && (typeof(response.Result) === 'object') && ('ExceptionType' in response.Result) && response.Result.ExceptionType.indexOf('System.ArgumentException') == 0)\r\n                    {\r\n                        errorCallback && errorCallback({emailWarning: true, message: response.Result.Message})\r\n                    }\r\n                    errorCallback && errorCallback({emailWarning: false});\r\n                }\r\n            });\r\n        }\r\n\r\n        this.logout = function(callback)\r\n        {\r\n            sendCrossDomainJSONRequest(window.serverBase + \"Logout.ashx?WrapStyle=func&WithoutRedirection=1\", function(response)\r\n            {\r\n                if (!parseResponse(response))\r\n                    return;\r\n\r\n                if (_this.isAccounts() && window.gmxAuthServer)\r\n                {\r\n                    sendCrossDomainJSONRequest(window.gmxAuthServer + \"Handler/Logout\", function()\r\n                    {\r\n                        //TODO: check result\r\n                        _this.setUserInfo({Login: false});\r\n                        callback && callback();\r\n                    }, 'callback');\r\n                }\r\n                else\r\n                {\r\n                    _this.setUserInfo({Login: false});\r\n                    callback && callback();\r\n                }\r\n            });\r\n        }\r\n\r\n        this.changePassword = function(oldPass, newPass, callback, errorCallback)\r\n        {\r\n            sendCrossDomainJSONRequest(window.serverBase + \"ChangePassword.ashx?WrapStyle=func&old=\" + encodeURIComponent(oldPass) + \"&new=\" + encodeURIComponent(newPass), function(response)\r\n            {\r\n                if (response.Status == 'ok' && response.Result)\r\n                    callback && callback();\r\n                else\r\n                {\r\n                    var msg = response.ErrorInfo && typeof response.ErrorInfo.ErrorMessage != 'undefined' ? response.ErrorInfo.ErrorMessage : null;\r\n                    errorCallback && errorCallback(msg);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    var checkProviders = [];\r\n\r\n    var doAuthServerLogin = function(token) {\r\n        if (token && window.mapsSite && window.gmxAuthServer) {\r\n            sendCrossDomainJSONRequest(window.gmxAuthServer + 'Handler/Me?token=' + encodeURIComponent(token), function() {\r\n                //console.log(response);\r\n            }, 'callback');\r\n        }\r\n    }\r\n\r\n    //canAuth() -> bool\r\n    //doAuth(callbackSuccess, callbackError)\r\n    nsGmx.AuthManager.addCheckUserMethod = function(provider)\r\n    {\r\n        checkProviders.push(provider);\r\n    }\r\n})(jQuery);\r\n","import nsGmx from '../nsGmx.js';\r\n\r\nnsGmx.GmxWidgetMixin = {\r\n    getContainer: function() {\r\n        return this.el || this._container;\r\n    },\r\n    appendTo: function(el) {\r\n        el = el[0] || el;\r\n        el.appendChild(this.getContainer());\r\n    },\r\n    show: function() {\r\n        var el = this.getContainer();\r\n        el.style.display = (this._previousStyleDisplayValue !== 'none' && this._previousStyleDisplayValue) || 'block';\r\n        delete this._previousStyleDisplayValue;\r\n    },\r\n    hide: function() {\r\n        var el = this.getContainer();\r\n        this._previousStyleDisplayValue = el.style.display;\r\n        el.style.display = 'none';\r\n    },\r\n    _terminateMouseEvents: function(el) {\r\n        el = el || this.getContainer();\r\n        L.DomEvent.disableClickPropagation(el);\r\n        el.addEventListener('mousewheel', L.DomEvent.stopPropagation);\r\n        el.addEventListener('mousemove', L.DomEvent.stopPropagation);\r\n    }\r\n}\r\n\r\nnsGmx.GmxWidget = Backbone.View.extend(nsGmx.GmxWidgetMixin);\r\n","import nsGmx from '../nsGmx.js';\r\nimport '../GmxWidget/GmxWidget.js';\r\nimport './dropdownMenuWidget.css';\r\nimport './dropdownWidget.css';\r\n\r\nnsGmx.Templates = nsGmx.Templates || {};\r\nnsGmx.Templates.DropdownMenuWidget = {};\r\nnsGmx.Templates.DropdownMenuWidget[\"dropdownMenuWidget\"] = \"<div class=\\\"dropdownMenuWidget ui-widget\\\">\\n\" +\r\n    \"    {{#each items}}\\n\" +\r\n    \"    <div class=\\\"dropdownMenuWidget-item{{#if className}} {{className}}{{/if}}\\\">\\n\" +\r\n    \"        <a\\n\" +\r\n    \"            {{#if id}}id=\\\"{{id}}\\\"{{/if}}\\n\" +\r\n    \"            {{#if link}}href=\\\"{{link}}\\\"{{else}}href=\\\"javascript:void(0)\\\"{{/if}}\\n\" +\r\n    \"            {{#if newWindow}}{{#if link}}target=\\\"_blank\\\"{{/if}}{{/if}}\\n\" +\r\n    \"            class=\\\"dropdownMenuWidget-itemAnchor{{#if newWindow}} dropdownMenuWidget-itemAnchor_newWindow{{/if}}\\\"\\n\" +\r\n    \"        >\\n\" +\r\n    \"            {{#if icon}}\\n\" +\r\n    \"                <img src=\\\"{{icon}}\\\" />\\n\" +\r\n    \"            {{/if}}\\n\" +\r\n    \"            {{#if fonticon}}\\n\" +\r\n    \"                <i class=\\\"{{fonticon}}\\\"></i>\\n\" +\r\n    \"            {{/if}}\\n\" +\r\n    \"            {{#if title}}\\n\" +\r\n    \"                <span>{{title}}</span>\\n\" +\r\n    \"                {{#if dropdown}}<i class=\\\"icon-angle-down\\\"></i>{{/if}}\\n\" +\r\n    \"            {{/if}}\\n\" +\r\n    \"        </a>\\n\" +\r\n    \"        {{#if dropdown}}\\n\" +\r\n    \"            <div class=\\\"dropdownMenuWidget-itemDropdown\\\">\\n\" +\r\n    \"                <ul class=\\\"dropdownMenuWidget-dropdownMenu\\\">\\n\" +\r\n    \"                    {{#each dropdown}}\\n\" +\r\n    \"                        <li class=\\\"dropdownMenuWidget-dropdownMenuItem{{#if className}} {{className}}{{/if}}\\\">\\n\" +\r\n    \"                            {{#if newWindow}}<div class=\\\"ui-icon ui-icon-newwin dropdownMenuWidget-dropdownMenuIcon\\\"></div>{{/if}}\\n\" +\r\n    \"                            <a\\n\" +\r\n    \"                                {{#if id}}id=\\\"{{id}}\\\"{{/if}}\\n\" +\r\n    \"                                {{#if link}}href=\\\"{{link}}\\\"{{else}}href=\\\"javascript:void(0)\\\"{{/if}}\\n\" +\r\n    \"                                {{#if newWindow}}{{#if link}}target=\\\"_blank\\\"{{/if}}{{/if}}\\n\" +\r\n    \"                                class=\\\"dropdownMenuWidget-dropdownItemAnchor{{#if newWindow}} dropdownMenuWidget-dropdownItemAnchor_newWindow{{/if}}\\\"\\n\" +\r\n    \"                            >\\n\" +\r\n    \"                                {{#if icon}}\\n\" +\r\n    \"                                    <img src=\\\"{{icon}}\\\" />\\n\" +\r\n    \"                                {{/if}}\\n\" +\r\n    \"                                {{#if title}}\\n\" +\r\n    \"                                    <span>{{title}}</span>\\n\" +\r\n    \"                                {{/if}}\\n\" +\r\n    \"                            </a>\\n\" +\r\n    \"                        </li>\\n\" +\r\n    \"                    {{/each}}\\n\" +\r\n    \"                </ul>\\n\" +\r\n    \"            </div>\\n\" +\r\n    \"        {{/if}}\\n\" +\r\n    \"    </div>\\n\" +\r\n    \"    {{/each}}\\n\" +\r\n    \"</div>\\n\" +\r\n    \"\";\r\nnsGmx.Templates.DropdownMenuWidget[\"anchor\"] = \"<a \\n\" +\r\n    \"    {{#if id}}id=\\\"{{id}}\\\"{{/if}}\\n\" +\r\n    \"    {{#if link}}href=\\\"{{link}}\\\"{{else}}href=\\\"javascript:void(0)\\\"{{/if}}\\n\" +\r\n    \"    {{#if newWindow}}target=\\\"_blank\\\" class=\\\"dropdownMenuWidget-anchor_newWindow\\\"{{/if}}\\n\" +\r\n    \">\\n\" +\r\n    \"    {{#if icon}}\\n\" +\r\n    \"        <img src=\\\"{{icon}}\\\" />\\n\" +\r\n    \"    {{/if}}\\n\" +\r\n    \"    {{#if title}}\\n\" +\r\n    \"        <span>{{title}}</span>\\n\" +\r\n    \"    {{/if}}\\n\" +\r\n    \"</a>\";\r\n\r\nnsGmx.PlainTextWidget = nsGmx.GmxWidget.extend({\r\n    initialize: function(txt) {\r\n        this.setText(txt);\r\n        this.$el.on('click', function () {\r\n            this.trigger('click')\r\n        }.bind(this));\r\n    },\r\n    getText: function () {\r\n        return this.$el.html();\r\n    },\r\n    setText: function (txt) {\r\n        this.$el.html(txt);\r\n    }\r\n});\r\n\r\n// <String>options.title\r\n// <String>options.className\r\n// <String>options.trigger (hover|click|manual)\r\n// <String>options.direction (down|up)\r\n// <Boolean>options.adjustWidth\r\n// <Boolean>options.showTopItem\r\nnsGmx.DropdownWidget = nsGmx.GmxWidget.extend({\r\n    className: 'dropdownWidget dropdownWidget-item',\r\n\r\n    options: {\r\n        title: '',\r\n        trigger: 'hover',\r\n        direction: 'down',\r\n        adjustWidth: true,\r\n        showTopItem: true,\r\n        titleClassName: ''\r\n    },\r\n\r\n    initialize: function(options) {\r\n        this.options = _.extend(this.options, options);\r\n        this.$titleContainer = $('<div>')\r\n            .addClass('dropdownWidget-dropdownTitle')\r\n            .addClass(options.titleClassName)\r\n            .html(this.options.title)\r\n            .appendTo(this.$el);\r\n        this.$dropdownContainer = $('<div>')\r\n            .addClass('dropdownWidget-dropdown')\r\n            .hide()\r\n            .appendTo(this.$el);\r\n        this.$dropdownTitle = $('<div>')\r\n            .addClass('dropdownWidget-item dropdownWidget-dropdownTitle')\r\n            .addClass(options.titleClassName)\r\n            .html(this.options.title)\r\n            .appendTo(this.$dropdownContainer);\r\n\r\n        if (!this.options.showTopItem) {\r\n            this.$dropdownTitle.hide();\r\n        }\r\n\r\n        if (this.options.trigger === 'hover') {\r\n            this.$dropdownTitle.addClass('ui-state-disabled');\r\n            this.$titleContainer.on('mouseover', function() {\r\n                this.expand();\r\n            }.bind(this));\r\n            this.$dropdownContainer.on('mouseleave', function() {\r\n                this.collapse();\r\n            }.bind(this));\r\n        } else if (this.options.trigger === 'click') {\r\n            this.$titleContainer.on('click', function() {\r\n                this.expand();\r\n            }.bind(this));\r\n            this.$dropdownTitle.on('click', function() {\r\n                this.collapse();\r\n            }.bind(this));\r\n        }\r\n\r\n        if (this.options.direction === 'up') {\r\n            this.$el.addClass('dropdownWidget_direction-up');\r\n        } else {\r\n            this.$el.addClass('dropdownWidget_direction-down');\r\n        }\r\n\r\n        this._items = {};\r\n    },\r\n\r\n    addItem: function(id, inst, position) {\r\n        this._items[id] = inst;\r\n        var $container = $('<div>')\r\n            .addClass('dropdownWidget-item dropdownWidget-dropdownItem')\r\n            .attr('data-id', id)\r\n            .attr('data-position', position)\r\n            .on('click', function(je) {\r\n                this.trigger('item', $(je.currentTarget).attr('data-id'));\r\n                this.trigger('item:' + $(je.currentTarget).attr('data-id'));\r\n                if (this.options.trigger === 'click') {\r\n                    this.collapse();\r\n                }\r\n            }.bind(this));\r\n        $container.append(inst.el);\r\n        this.$dropdownContainer.append($container);\r\n        this._sortItems()\r\n    },\r\n\r\n    setTitle: function(title) {\r\n        this.$titleContainer.html(title);\r\n        this.$dropdownTitle.html(title);\r\n    },\r\n\r\n    toggle: function() {\r\n        this._expanded ? this.collapse() : this.expand();\r\n        this._expanded = !this._expanded;\r\n    },\r\n\r\n    expand: function() {\r\n        this.$dropdownContainer.css('min-width', this.$el.width());\r\n        this.$dropdownContainer.show();\r\n        this.trigger('expand');\r\n    },\r\n\r\n    collapse: function() {\r\n        this.$dropdownContainer.hide();\r\n        this.trigger('collapse');\r\n    },\r\n\r\n    reset: function() {\r\n        this.collapse();\r\n    },\r\n\r\n    _sortItems: function() {\r\n        var containerEl = this.$dropdownContainer[0];\r\n        var items = Array.prototype.slice.call(containerEl.children);\r\n\r\n        var titleEl = items.splice(\r\n            items.indexOf($(containerEl).find('.dropdownWidget-dropdownTitle')[0]), 1\r\n        );\r\n\r\n        while (items.length) {\r\n            var maxPositionIndex = items.indexOf(_.max(items, function(el) {\r\n                return el.getAttribute('data-position') / 1;\r\n            }));\r\n            $(containerEl).prepend(items.splice(maxPositionIndex, 1)[0]);\r\n        }\r\n\r\n        if (this.options.direction === 'up') {\r\n            $(containerEl).append(titleEl);\r\n        } else {\r\n            $(containerEl).prepend(titleEl);\r\n        }\r\n    }\r\n});\r\n\r\nnsGmx.DropdownMenuWidget = (function() {\r\n    var DropdownMenuWidget = function(options) {\r\n        var h = Handlebars.create();\r\n        h.registerPartial('anchor', nsGmx.Templates.DropdownMenuWidget.anchor);\r\n        this._view = $(h.compile(nsGmx.Templates.DropdownMenuWidget.dropdownMenuWidget)({\r\n            items: options.items\r\n        }));\r\n        this._view.find('.dropdownMenuWidget-itemDropdown').hide();\r\n\r\n        // var mouseTimeout = options.mouseTimeout || 100;\r\n        this._view.find('.dropdownMenuWidget-item').each(function() {\r\n            var mouseIsOver = false;\r\n            $(this).on('mouseenter', function(je) {\r\n                mouseIsOver = true;\r\n                setTimeout(function() {\r\n                    if (mouseIsOver) {\r\n                        $(je.currentTarget).find('.dropdownMenuWidget-itemDropdown').show();\r\n                    }\r\n                }, 100);\r\n            });\r\n            $(this).on('mouseleave', function(je) {\r\n                mouseIsOver = false;\r\n                $(je.currentTarget).find('.dropdownMenuWidget-itemDropdown').hide();\r\n            });\r\n        });\r\n    };\r\n\r\n    DropdownMenuWidget.prototype.appendTo = function(placeholder) {\r\n        $(placeholder).append(this._view);\r\n    };\r\n\r\n    return DropdownMenuWidget;\r\n})();","import nsGmx from '../nsGmx.js';\r\nimport '../translations.js';\r\nimport './assets/styles.css';\r\nimport '../DropdownMenuWidget/dropdownMenuWidget.js';\r\n\r\nnsGmx.HeaderWidget = (function() {\r\n    'use strict';\r\n\r\n    var SocialShareWidget = function(socials) {\r\n        this._view = Handlebars.compile(nsGmx.Templates.HeaderWidget.socials)(socials);\r\n    };\r\n\r\n    SocialShareWidget.prototype.appendTo = function(placeholder) {\r\n        $(placeholder).append(this._view);\r\n    };\r\n\r\n    var HeaderWidget = function(options) {\r\n        var addDots = function(item) {\r\n            if (!item.icon && !item.className) {\r\n                item.className = item.className + ' headerWidget-menuDot';\r\n            }\r\n            return item;\r\n        };\r\n\r\n        var h = Handlebars.create();\r\n        this._view = $(h.compile(nsGmx.Templates.HeaderWidget.layout)(options));\r\n        if (nsGmx.DropdownMenuWidget) {\r\n            (new nsGmx.DropdownMenuWidget({\r\n                items: options.leftLinks && options.leftLinks.map(addDots)\r\n            })).appendTo(this._view.find('.headerWidget-leftLinksContainer'));\r\n            (new nsGmx.DropdownMenuWidget({\r\n                items: options.rightLinks && options.rightLinks.map(addDots)\r\n            })).appendTo(this._view.find('.headerWidget-rightLinksContainer'));\r\n        } else {\r\n            console.warn('DropdownMenuWidget not found');\r\n        }\r\n        (new SocialShareWidget(options.socials)).appendTo(this._view.find('.headerWidget-socialsContainer'));\r\n        this._view.find(\".headerWidget-authContainer\").hide();\r\n        this._view.find(\".headerWidget-menuContainer\").hide();\r\n        this._view.find(\".headerWidget-searchContainer\").hide();\r\n        this._view.find(\".headerWidget-languageContainer\").hide();\r\n        if (!options.socials) {\r\n            this._view.find(\".headerWidget-socialsContainer\").hide();\r\n        }\r\n    };\r\n\r\n    HeaderWidget.prototype.appendTo = function(placeholder) {\r\n        $(placeholder).append(this._view);\r\n    };\r\n\r\n    HeaderWidget.prototype.getAuthPlaceholder = function() {\r\n        return this._view.find(\".headerWidget-authContainer\").show();\r\n    };\r\n\r\n    HeaderWidget.prototype.getMenuPlaceholder = function() {\r\n        return this._view.find(\".headerWidget-menuContainer\").show();\r\n    };\r\n\r\n    HeaderWidget.prototype.getSearchPlaceholder = function() {\r\n        return this._view.find(\".headerWidget-searchContainer\").show();\r\n    };\r\n\r\n    HeaderWidget.prototype.getLanguagePlaceholder = function() {\r\n        return this._view.find(\".headerWidget-languageContainer\").show();\r\n    };\r\n\r\n    HeaderWidget.prototype.getSocialsPlaceholder = function() {\r\n        return this._view.find(\".headerWidget-socialsContainer\");\r\n    };\r\n\r\n    return HeaderWidget;\r\n})();\r\nnsGmx.Translations.addText('rus', {\r\n    header: {\r\n        'langRu': 'Ru',\r\n        'langEn': 'En'\r\n    }\r\n});\r\n\r\nnsGmx.Translations.addText('eng', {\r\n    header: {\r\n        'langRu': 'Ru',\r\n        'langEn': 'En'\r\n    }\r\n});\r\nnsGmx.Templates = nsGmx.Templates || {};\r\nnsGmx.Templates.HeaderWidget = {};\r\nnsGmx.Templates.HeaderWidget[\"layout\"] = \"<div class=\\\"headerWidget\\\">\\n\" +\r\n    \"    <div class=\\\"headerWidget-left\\\">\\n\" +\r\n    \"        <div class=\\\"headerWidget-logoContainer\\\">\\n\" +\r\n    \"            <img class=\\\"headerWidget-logo\\\" src=\\\"{{logo}}\\\" />\\n\" +\r\n    \"        </div>\\n\" +\r\n    \"    </div>\\n\" +\r\n    \"    <div class=\\\"headerWidget-right\\\">\\n\" +\r\n    \"        <div class=\\\"headerWidget-bar headerWidget-controlsBar\\\">\\n\" +\r\n    \"            <div class=\\\"headerWidget-barTable headerWidget-controlsBarTable\\\">\\n\" +\r\n    \"                <div class=\\\"headerWidget-barCell headerWidget-menuContainer\\\"></div>\\n\" +\r\n    \"                <div class=\\\"headerWidget-barCell headerWidget-authContainer\\\"></div>\\n\" +\r\n    \"                <div class=\\\"headerWidget-barCell headerWidget-languageContainer\\\"></div>\\n\" +\r\n    \"            </div>\\n\" +\r\n    \"        </div>\\n\" +\r\n    \"    </div>\\n\" +\r\n    \"</div>\\n\" +\r\n    \"\";\r\nnsGmx.Templates.HeaderWidget[\"socials\"] = \"<div class=\\\"headerWidget-socialIcons\\\">\\n\" +\r\n    \"    {{#if vk}}\\n\" +\r\n    \"        <div class=\\\"headerWidget-socialIconCell\\\"><a href=\\\"{{vk}}\\\" target=\\\"_blank\\\"><i class=\\\"icon-vk\\\"></i></a></div>\\n\" +\r\n    \"    {{/if}}\\n\" +\r\n    \"    {{#if facebook}}\\n\" +\r\n    \"        <div class=\\\"headerWidget-socialIconCell\\\"><a href=\\\"{{facebook}}\\\" target=\\\"_blank\\\"><i class=\\\"icon-facebook\\\"></i></a></div>\\n\" +\r\n    \"    {{/if}}\\n\" +\r\n    \"    {{#if twitter}}\\n\" +\r\n    \"        <div class=\\\"headerWidget-socialIconCell\\\"><a href=\\\"{{twitter}}\\\" target=\\\"_blank\\\"><i class=\\\"icon-twitter\\\"></i></a></div>\\n\" +\r\n    \"    {{/if}}\\n\" +\r\n    \"</div>\";","import nsGmx from '../nsGmx.js';\r\nimport './assets/styles.css';\r\n\r\nnsGmx.LanguageWidget = (function() {\r\n    \r\n    var LanguageWidget = function() {\r\n        this._view = $(Handlebars.compile(nsGmx.Templates.LanguageWidget.layout)({\r\n            eng: nsGmx.Translations.getLanguage() === 'eng',\r\n            rus: nsGmx.Translations.getLanguage() === 'rus'\r\n        }));\r\n\r\n        if (nsGmx.Translations.getLanguage() !== 'eng') {\r\n            this._view.find('.languageWidget-item_eng').click(function() {\r\n                nsGmx.Translations.updateLanguageCookies('eng');\r\n                // присвоение url не работает, если есть #\r\n                window.location.reload(false);\r\n            });\r\n        }\r\n\r\n        if (nsGmx.Translations.getLanguage() !== 'rus') {\r\n            this._view.find('.languageWidget-item_rus').click(function() {\r\n                nsGmx.Translations.updateLanguageCookies('rus');\r\n                window.location.reload(false);\r\n            });\r\n        }\r\n    };\r\n\r\n    LanguageWidget.prototype.appendTo = function(placeholder) {\r\n        $(placeholder).append(this._view);\r\n    };\r\n\r\n    return LanguageWidget;\r\n})();\r\n\r\nnsGmx.Templates = nsGmx.Templates || {};nsGmx.Templates.LanguageWidget = {};\r\nnsGmx.Templates.LanguageWidget[\"layout\"] = \"<div class=\\\"languageWidget ui-widget\\\">\\n\" +\r\n    \"    <div class=\\\"languageWidget-item languageWidget-item_rus\\\"><span class=\\\"{{^rus}}link languageWidget-link{{/rus}}{{#rus}}languageWidget-disabled{{/rus}}\\\">Ru</span></div>\\n\" +\r\n    \"    <div class=\\\"languageWidget-item languageWidget-item_eng\\\"><span class=\\\"{{^eng}}link languageWidget-link{{/eng}}{{#eng}}languageWidget-disabled{{/eng}}\\\">En</span></div>\\n\" +\r\n    \"</div>\";","function each(o, cb) {\r\n    for (var p in o) {\r\n        if (o.hasOwnProperty(p)) {\r\n            cb(o[p], p, o);\r\n        }\r\n    }\r\n}\r\n\r\nfunction find(ar, cb) {\r\n    if (ar.length) {\r\n        for (var i = 0; i < ar.length; i++) {\r\n            if (cb(ar[i])) {\r\n                return ar[i];\r\n            }\r\n        }\r\n    } else {\r\n        for (var p in ar) {\r\n            if (ar.hasOwnProperty(p) && cb(ar[p])) {\r\n                return ar[p];\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction first(o) {\r\n    for (var p in o) {\r\n        if (o.hasOwnProperty(p)) {\r\n            return o[p];\r\n        }\r\n    }\r\n}\r\n\r\nfunction length(o) {\r\n    var length = 0;\r\n    for (var p in o) {\r\n        if (o.hasOwnProperty(p)) {\r\n            length++;\r\n        }\r\n    }\r\n    return length;\r\n}\r\n\r\nfunction prepend(parent, el) {\r\n    if (parent.children.length) {\r\n        parent.insertBefore(el, parent.children[0]);\r\n    } else {\r\n        parent.appendChild(el);\r\n    }\r\n}\r\n\r\nvar IconLayers = L.Control.extend({\r\n\r\n    includes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n    _getActiveLayer: function() {\r\n        if (this._activeLayerId) {\r\n            return this._layers[this._activeLayerId];\r\n        } else if (length(this._layers)) {\r\n            return first(this._layers);\r\n        } else {\r\n            return null;\r\n        }\r\n    },\r\n    _getPreviousLayer: function() {\r\n        var activeLayer = this._getActiveLayer();\r\n        if (!activeLayer) {\r\n            return null;\r\n        } else if (this._previousLayerId) {\r\n            return this._layers[this._previousLayerId];\r\n        } else {\r\n            return find(this._layers, function(l) {\r\n                return l.id !== activeLayer.id;\r\n            }.bind(this)) || null;\r\n        }\r\n    },\r\n    _getInactiveLayers: function() {\r\n        var ar = [];\r\n        var activeLayerId = this._getActiveLayer() ? this._getActiveLayer().id : null;\r\n        var previousLayerId = this._getPreviousLayer() ? this._getPreviousLayer().id : null;\r\n        each(this._layers, function(l) {\r\n            if ((l.id !== activeLayerId) && (l.id !== previousLayerId)) {\r\n                ar.push(l);\r\n            }\r\n        });\r\n        return ar;\r\n    },\r\n    _arrangeLayers: function() {\r\n        var behaviors = {};\r\n        behaviors.previous = function() {\r\n            var layers = this._getInactiveLayers();\r\n            if (this._getActiveLayer()) {\r\n                layers.unshift(this._getActiveLayer());\r\n            }\r\n            if (this._getPreviousLayer()) {\r\n                layers.unshift(this._getPreviousLayer());\r\n            }\r\n            return layers;\r\n        };\r\n        return behaviors[this.options.behavior].apply(this, arguments);\r\n    },\r\n    _getLayerCellByLayerId: function(id) {\r\n        var els = this._container.getElementsByClassName('leaflet-iconLayers-layerCell');\r\n        for (var i = 0; i < els.length; i++) {\r\n            if (els[i].getAttribute('data-layerid') == id) {\r\n                return els[i];\r\n            }\r\n        }\r\n    },\r\n    _createLayerElement: function(layerObj) {\r\n        var el = L.DomUtil.create('div', 'leaflet-iconLayers-layer');\r\n        if (layerObj.title) {\r\n            var titleContainerEl = L.DomUtil.create('div', 'leaflet-iconLayers-layerTitleContainer');\r\n            var titleEl = L.DomUtil.create('div', 'leaflet-iconLayers-layerTitle');\r\n            var checkIconEl = L.DomUtil.create('div', 'leaflet-iconLayers-layerCheckIcon');\r\n            titleEl.innerHTML = layerObj.title;\r\n            titleContainerEl.appendChild(titleEl);\r\n            el.appendChild(titleContainerEl);\r\n            el.appendChild(checkIconEl);\r\n        }\r\n        if (layerObj.icon) {\r\n            el.setAttribute('style', 'background-image: url(\\'' + layerObj.icon + '\\')');\r\n        }\r\n        return el;\r\n    },\r\n    _createLayerElements: function() {\r\n        var currentRow, layerCell;\r\n        var layers = this._arrangeLayers();\r\n        var activeLayerId = this._getActiveLayer() && this._getActiveLayer().id;\r\n\r\n        for (var i = 0; i < layers.length; i++) {\r\n            if (i % this.options.maxLayersInRow === 0) {\r\n                currentRow = L.DomUtil.create('div', 'leaflet-iconLayers-layersRow');\r\n                if (this.options.position.indexOf('bottom') === -1) {\r\n                    this._container.appendChild(currentRow);\r\n                } else {\r\n                    prepend(this._container, currentRow);\r\n                }\r\n            }\r\n            layerCell = L.DomUtil.create('div', 'leaflet-iconLayers-layerCell');\r\n            layerCell.setAttribute('data-layerid', layers[i].id);\r\n            if (i !== 0) {\r\n                L.DomUtil.addClass(layerCell, 'leaflet-iconLayers-layerCell_hidden');\r\n            }\r\n            if (layers[i].id === activeLayerId) {\r\n                L.DomUtil.addClass(layerCell, 'leaflet-iconLayers-layerCell_active');\r\n            }\r\n            if (this._expandDirection === 'left') {\r\n                L.DomUtil.addClass(layerCell, 'leaflet-iconLayers-layerCell_expandLeft');\r\n            } else {\r\n                L.DomUtil.addClass(layerCell, 'leaflet-iconLayers-layerCell_expandRight');\r\n            }\r\n            layerCell.appendChild(this._createLayerElement(layers[i]));\r\n\r\n            if (this.options.position.indexOf('right') === -1) {\r\n                currentRow.appendChild(layerCell);\r\n            } else {\r\n                prepend(currentRow, layerCell);\r\n            }\r\n        }\r\n    },\r\n    _onLayerClick: function(e) {\r\n        e.stopPropagation();\r\n        var layerId = e.currentTarget.getAttribute('data-layerid');\r\n        var layer = this._layers[layerId];\r\n        this.setActiveLayer(layer.layer);\r\n        this.expand();\r\n    },\r\n    _attachEvents: function() {\r\n        each(this._layers, function(l) {\r\n            var e = this._getLayerCellByLayerId(l.id);\r\n            if (e) {\r\n                e.addEventListener('click', this._onLayerClick.bind(this));\r\n            }\r\n        }.bind(this));\r\n        var layersRowCollection = this._container.getElementsByClassName('leaflet-iconLayers-layersRow');\r\n\r\n        var onMouseEnter = function(e) {\r\n            e.stopPropagation();\r\n            this.expand();\r\n        }.bind(this);\r\n\r\n        var onMouseLeave = function(e) {\r\n            e.stopPropagation();\r\n            this.collapse();\r\n        }.bind(this);\r\n\r\n        var stopPropagation = function(e) {\r\n            e.stopPropagation();\r\n        };\r\n\r\n        //TODO Don't make functions within a loop.\r\n        for (var i = 0; i < layersRowCollection.length; i++) {\r\n            var el = layersRowCollection[i];\r\n            el.addEventListener('mouseenter', onMouseEnter);\r\n            el.addEventListener('mouseleave', onMouseLeave);\r\n            el.addEventListener('mousemove', stopPropagation);\r\n        }\r\n    },\r\n    _render: function() {\r\n        this._container.innerHTML = '';\r\n        this._createLayerElements();\r\n        this._attachEvents();\r\n    },\r\n    _switchMapLayers: function() {\r\n        if (!this._map) {\r\n            return;\r\n        }\r\n        var activeLayer = this._getActiveLayer();\r\n        var previousLayer = this._getPreviousLayer();\r\n        if (previousLayer) {\r\n            this._map.removeLayer(previousLayer.layer);\r\n        } else {\r\n            each(this._layers, function(layerObject) {\r\n                var layer = layerObject.layer;\r\n                this._map.removeLayer(layer);\r\n            }.bind(this));\r\n        }\r\n        if (activeLayer) {\r\n            this._map.addLayer(activeLayer.layer);\r\n        }\r\n    },\r\n    options: {\r\n        position: 'bottomleft', // one of expanding directions depends on this\r\n        behavior: 'previous', // may be 'previous', 'expanded' or 'first'\r\n        expand: 'horizontal', // or 'vertical'\r\n        autoZIndex: true, // from L.Control.Layers\r\n        maxLayersInRow: 5,\r\n        manageLayers: true\r\n    },\r\n    initialize: function(layers, options) {\r\n        if (!L.Util.isArray(arguments[0])) {\r\n            // first argument is options\r\n            options = layers;\r\n            layers = [];\r\n        }\r\n        L.setOptions(this, options);\r\n        this._expandDirection = (this.options.position.indexOf('left') != -1) ? 'right' : 'left';\r\n        if (this.options.manageLayers) {\r\n            this.on('activelayerchange', this._switchMapLayers, this);\r\n        }\r\n        this.setLayers(layers);\r\n    },\r\n    onAdd: function(map) {\r\n        this._container = L.DomUtil.create('div', 'leaflet-iconLayers');\r\n        L.DomUtil.addClass(this._container, 'leaflet-iconLayers_' + this.options.position);\r\n        this._render();\r\n        map.on('click', this.collapse, this);\r\n        if (this.options.manageLayers) {\r\n            this._switchMapLayers();\r\n        }\r\n        return this._container;\r\n    },\r\n    onRemove: function(map) {\r\n        map.off('click', this.collapse, this);\r\n    },\r\n    setLayers: function(layers) {\r\n        this._layers = {};\r\n        layers.map(function(layer) {\r\n            var id = L.stamp(layer.layer);\r\n            this._layers[id] = L.extend(layer, {\r\n                id: id\r\n            });\r\n        }.bind(this));\r\n        if (this._container) {\r\n            this._render();\r\n        }\r\n    },\r\n    setActiveLayer: function(layer) {\r\n        var l = layer && this._layers[L.stamp(layer)];\r\n        if (!l || l.id === this._activeLayerId) {\r\n            return;\r\n        }\r\n        this._previousLayerId = this._activeLayerId;\r\n        this._activeLayerId = l.id;\r\n        if (this._container) {\r\n            this._render();\r\n        }\r\n        this.fire('activelayerchange', {\r\n            layer: layer\r\n        });\r\n    },\r\n    expand: function() {\r\n        this._arrangeLayers().slice(1).map(function(l) {\r\n            var el = this._getLayerCellByLayerId(l.id);\r\n            L.DomUtil.removeClass(el, 'leaflet-iconLayers-layerCell_hidden');\r\n        }.bind(this));\r\n    },\r\n    collapse: function() {\r\n        this._arrangeLayers().slice(1).map(function(l) {\r\n            var el = this._getLayerCellByLayerId(l.id);\r\n            L.DomUtil.addClass(el, 'leaflet-iconLayers-layerCell_hidden');\r\n        }.bind(this));\r\n    }\r\n});\r\n\r\n// var iconLayers = function(layers, options) {\r\n//     return new IconLayers(layers, options);\r\n// };\r\n\r\n// iconLayers.Constructor = IconLayers;\r\n\r\n// window.L.control.iconLayers = iconLayers;\r\n// window.L.Control.IconLayers = window.L.control.iconLayers.Constructor;\r\n\r\nwindow.L.Control.IconLayers = IconLayers;\r\n\r\nexport default IconLayers;","/* ========================================================================\r\n * Bootstrap: tooltip.js v3.3.1\r\n * http://getbootstrap.com/javascript/#tooltip\r\n * Inspired by the original jQuery.tipsy by Jason Frame\r\n * ========================================================================\r\n * Copyright 2011-2014 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n(function ($) {\r\n  'use strict';\r\n\r\n  // TOOLTIP PUBLIC CLASS DEFINITION\r\n  // ===============================\r\n\r\n  var Tooltip = function (element, options) {\r\n    this.type       =\r\n    this.options    =\r\n    this.enabled    =\r\n    this.timeout    =\r\n    this.hoverState =\r\n    this.$element   = null\r\n\r\n    this.init('tooltip', element, options)\r\n  }\r\n\r\n  Tooltip.VERSION  = '3.3.1'\r\n\r\n  Tooltip.TRANSITION_DURATION = 150\r\n\r\n  Tooltip.DEFAULTS = {\r\n    animation: true,\r\n    placement: 'top',\r\n    selector: false,\r\n    template: '<div class=\"tooltip\" role=\"tooltip\"><div class=\"tooltip-arrow\"></div><div class=\"tooltip-inner\"></div></div>',\r\n    trigger: 'hover focus',\r\n    title: '',\r\n    delay: 0,\r\n    html: false,\r\n    container: false,\r\n    viewport: {\r\n      selector: 'body',\r\n      padding: 0\r\n    }\r\n  }\r\n\r\n  Tooltip.prototype.init = function (type, element, options) {\r\n    this.enabled   = true\r\n    this.type      = type\r\n    this.$element  = $(element)\r\n    this.options   = this.getOptions(options)\r\n    this.$viewport = this.options.viewport && $(this.options.viewport.selector || this.options.viewport)\r\n\r\n    var triggers = this.options.trigger.split(' ')\r\n\r\n    for (var i = triggers.length; i--;) {\r\n      var trigger = triggers[i]\r\n\r\n      if (trigger == 'click') {\r\n        this.$element.on('click.' + this.type, this.options.selector, $.proxy(this.toggle, this))\r\n      } else if (trigger != 'manual') {\r\n        var eventIn  = trigger == 'hover' ? 'mouseenter' : 'focusin'\r\n        var eventOut = trigger == 'hover' ? 'mouseleave' : 'focusout'\r\n\r\n        this.$element.on(eventIn  + '.' + this.type, this.options.selector, $.proxy(this.enter, this))\r\n        this.$element.on(eventOut + '.' + this.type, this.options.selector, $.proxy(this.leave, this))\r\n      }\r\n    }\r\n\r\n    this.options.selector ?\r\n      (this._options = $.extend({}, this.options, { trigger: 'manual', selector: '' })) :\r\n      this.fixTitle()\r\n  }\r\n\r\n  Tooltip.prototype.getDefaults = function () {\r\n    return Tooltip.DEFAULTS\r\n  }\r\n\r\n  Tooltip.prototype.getOptions = function (options) {\r\n    options = $.extend({}, this.getDefaults(), this.$element.data(), options)\r\n\r\n    if (options.delay && typeof options.delay == 'number') {\r\n      options.delay = {\r\n        show: options.delay,\r\n        hide: options.delay\r\n      }\r\n    }\r\n\r\n    return options\r\n  }\r\n\r\n  Tooltip.prototype.getDelegateOptions = function () {\r\n    var options  = {}\r\n    var defaults = this.getDefaults()\r\n\r\n    this._options && $.each(this._options, function (key, value) {\r\n      if (defaults[key] != value) options[key] = value\r\n    })\r\n\r\n    return options\r\n  }\r\n\r\n  Tooltip.prototype.enter = function (obj) {\r\n    var self = obj instanceof this.constructor ?\r\n      obj : $(obj.currentTarget).data('bs.' + this.type)\r\n\r\n    if (self && self.$tip && self.$tip.is(':visible')) {\r\n      self.hoverState = 'in'\r\n      return\r\n    }\r\n\r\n    if (!self) {\r\n      self = new this.constructor(obj.currentTarget, this.getDelegateOptions())\r\n      $(obj.currentTarget).data('bs.' + this.type, self)\r\n    }\r\n\r\n    clearTimeout(self.timeout)\r\n\r\n    self.hoverState = 'in'\r\n\r\n    if (!self.options.delay || !self.options.delay.show) return self.show()\r\n\r\n    self.timeout = setTimeout(function () {\r\n      if (self.hoverState == 'in') self.show()\r\n    }, self.options.delay.show)\r\n  }\r\n\r\n  Tooltip.prototype.leave = function (obj) {\r\n    var self = obj instanceof this.constructor ?\r\n      obj : $(obj.currentTarget).data('bs.' + this.type)\r\n\r\n    if (!self) {\r\n      self = new this.constructor(obj.currentTarget, this.getDelegateOptions())\r\n      $(obj.currentTarget).data('bs.' + this.type, self)\r\n    }\r\n\r\n    clearTimeout(self.timeout)\r\n\r\n    self.hoverState = 'out'\r\n\r\n    if (!self.options.delay || !self.options.delay.hide) return self.hide()\r\n\r\n    self.timeout = setTimeout(function () {\r\n      if (self.hoverState == 'out') self.hide()\r\n    }, self.options.delay.hide)\r\n  }\r\n\r\n  Tooltip.prototype.show = function () {\r\n    var that = this;\r\n    if (this.hasContent() && this.enabled) {\r\n      this._toBeShown = true;\r\n      this._preloadImages().then(function() {\r\n        if (that._toBeShown) {\r\n          that.doShow();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  Tooltip.prototype._preloadImages = function() {\r\n    var that = this;\r\n    \r\n    var $images = $('<div>').html(that.getContent()).find('img');\r\n    var srcs = Array.prototype.slice.apply($images).map(function(el) {\r\n      return el.src;\r\n    });\r\n\r\n    var promises = srcs.map(function(src) {\r\n      return $.Deferred(function(def) {\r\n        var img = new Image();\r\n        img.addEventListener('load', function() {\r\n          def.resolve();\r\n        });\r\n        img.addEventListener('error', function() {\r\n          def.reject();\r\n        });\r\n        img.src = src;\r\n      }).promise();\r\n    });\r\n\r\n    return $.when.apply(null, promises);\r\n  }\r\n\r\n  Tooltip.prototype.doShow = function () {\r\n      var e = $.Event('show.bs.' + this.type)\r\n\r\n      this.$element.trigger(e)\r\n\r\n      var inDom = $.contains(this.$element[0].ownerDocument.documentElement, this.$element[0])\r\n      if (e.isDefaultPrevented() || !inDom) return\r\n      var that = this\r\n\r\n      var $tip = this.tip()\r\n\r\n      var tipId = this.getUID(this.type)\r\n\r\n      this.setContent()\r\n\r\n      $tip.attr('id', tipId)\r\n      this.$element.attr('aria-describedby', tipId)\r\n\r\n      if (this.options.animation) $tip.addClass('fade')\r\n\r\n      var placement = typeof this.options.placement == 'function' ?\r\n        this.options.placement.call(this, $tip[0], this.$element[0]) :\r\n        this.options.placement\r\n\r\n      var autoToken = /\\s?auto?\\s?/i\r\n      var autoPlace = autoToken.test(placement)\r\n      if (autoPlace) placement = placement.replace(autoToken, '') || 'top'\r\n\r\n      $tip\r\n        .detach()\r\n        .css({ top: 0, left: 0, display: 'block' })\r\n        .addClass(placement)\r\n        .data('bs.' + this.type, this)\r\n\r\n      this.options.container ? $tip.appendTo(this.options.container) : $tip.insertAfter(this.$element)\r\n\r\n      var pos          = this.getPosition()\r\n      var actualWidth  = $tip[0].offsetWidth\r\n      var actualHeight = $tip[0].offsetHeight\r\n\r\n      if (autoPlace) {\r\n        var orgPlacement = placement\r\n        var $container   = this.options.container ? $(this.options.container) : this.$element.parent()\r\n        var containerDim = this.getPosition($container)\r\n\r\n        placement = placement == 'bottom' && pos.bottom + actualHeight > containerDim.bottom ? 'top'    :\r\n                    placement == 'top'    && pos.top    - actualHeight < containerDim.top    ? 'bottom' :\r\n                    placement == 'right'  && pos.right  + actualWidth  > containerDim.width  ? 'left'   :\r\n                    placement == 'left'   && pos.left   - actualWidth  < containerDim.left   ? 'right'  :\r\n                    placement\r\n\r\n        $tip\r\n          .removeClass(orgPlacement)\r\n          .addClass(placement)\r\n      }\r\n\r\n      var calculatedOffset = this.getCalculatedOffset(placement, pos, actualWidth, actualHeight)\r\n\r\n      this.applyPlacement(calculatedOffset, placement)\r\n\r\n      var complete = function () {\r\n        var prevHoverState = that.hoverState\r\n        that.$element.trigger('shown.bs.' + that.type)\r\n        that.hoverState = null\r\n\r\n        if (prevHoverState == 'out') that.leave(that)\r\n      }\r\n\r\n      $.support.transition && this.$tip.hasClass('fade') ?\r\n        $tip\r\n          .one('bsTransitionEnd', complete)\r\n          .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :\r\n        complete()\r\n  }\r\n\r\n  Tooltip.prototype.applyPlacement = function (offset, placement) {\r\n    var $tip   = this.tip()\r\n    var width  = $tip[0].offsetWidth\r\n    var height = $tip[0].offsetHeight\r\n\r\n    // manually read margins because getBoundingClientRect includes difference\r\n    var marginTop = parseInt($tip.css('margin-top'), 10)\r\n    var marginLeft = parseInt($tip.css('margin-left'), 10)\r\n\r\n    // we must check for NaN for ie 8/9\r\n    if (isNaN(marginTop))  marginTop  = 0\r\n    if (isNaN(marginLeft)) marginLeft = 0\r\n\r\n    offset.top  = offset.top  + marginTop\r\n    offset.left = offset.left + marginLeft\r\n\r\n    // $.fn.offset doesn't round pixel values\r\n    // so we use setOffset directly with our own function B-0\r\n    $.offset.setOffset($tip[0], $.extend({\r\n      using: function (props) {\r\n        $tip.css({\r\n          top: Math.round(props.top),\r\n          left: Math.round(props.left)\r\n        })\r\n      }\r\n    }, offset), 0)\r\n\r\n    $tip.addClass('in')\r\n\r\n    // check to see if placing tip in new offset caused the tip to resize itself\r\n    var actualWidth  = $tip[0].offsetWidth\r\n    var actualHeight = $tip[0].offsetHeight\r\n\r\n    if (placement == 'top' && actualHeight != height) {\r\n      offset.top = offset.top + height - actualHeight\r\n    }\r\n\r\n    var delta = this.getViewportAdjustedDelta(placement, offset, actualWidth, actualHeight)\r\n\r\n    if (delta.left) offset.left += delta.left\r\n    else offset.top += delta.top\r\n\r\n    var isVertical          = /top|bottom/.test(placement)\r\n    var arrowDelta          = isVertical ? delta.left * 2 - width + actualWidth : delta.top * 2 - height + actualHeight\r\n    var arrowOffsetPosition = isVertical ? 'offsetWidth' : 'offsetHeight'\r\n\r\n    $tip.offset(offset)\r\n    this.replaceArrow(arrowDelta, $tip[0][arrowOffsetPosition], isVertical)\r\n  }\r\n\r\n  Tooltip.prototype.replaceArrow = function (delta, dimension, isHorizontal) {\r\n    this.arrow()\r\n      .css(isHorizontal ? 'left' : 'top', 50 * (1 - delta / dimension) + '%')\r\n      .css(isHorizontal ? 'top' : 'left', '')\r\n  }\r\n\r\n  Tooltip.prototype.setContent = function () {\r\n    var $tip  = this.tip()\r\n    var title = this.getTitle()\r\n\r\n    $tip.find('.tooltip-inner')[this.options.html ? 'html' : 'text'](title)\r\n    $tip.removeClass('fade in top bottom left right')\r\n  }\r\n\r\n  Tooltip.prototype.hide = function (callback) {\r\n    var that = this\r\n    var $tip = this.tip()\r\n    var e    = $.Event('hide.bs.' + this.type)\r\n\r\n    this._toBeShown = false;\r\n\r\n    function complete() {\r\n      if (that.hoverState != 'in') $tip.detach()\r\n      that.$element\r\n        .removeAttr('aria-describedby')\r\n        .trigger('hidden.bs.' + that.type)\r\n      callback && callback()\r\n    }\r\n\r\n    this.$element.trigger(e)\r\n\r\n    if (e.isDefaultPrevented()) return\r\n\r\n    $tip.removeClass('in')\r\n\r\n    $.support.transition && this.$tip.hasClass('fade') ?\r\n      $tip\r\n        .one('bsTransitionEnd', complete)\r\n        .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :\r\n      complete()\r\n\r\n    this.hoverState = null\r\n\r\n    return this\r\n  }\r\n\r\n  Tooltip.prototype.fixTitle = function () {\r\n    var $e = this.$element\r\n    if ($e.attr('title') || typeof ($e.attr('data-original-title')) != 'string') {\r\n      $e.attr('data-original-title', $e.attr('title') || '').attr('title', '')\r\n    }\r\n  }\r\n\r\n  Tooltip.prototype.hasContent = function () {\r\n    return this.getTitle()\r\n  }\r\n\r\n  Tooltip.prototype.getPosition = function ($element) {\r\n    $element   = $element || this.$element\r\n\r\n    var el     = $element[0]\r\n    var isBody = el.tagName == 'BODY'\r\n\r\n    var elRect    = el.getBoundingClientRect()\r\n    if (elRect.width == null) {\r\n      // width and height are missing in IE8, so compute them manually; see https://github.com/twbs/bootstrap/issues/14093\r\n      elRect = $.extend({}, elRect, { width: elRect.right - elRect.left, height: elRect.bottom - elRect.top })\r\n    }\r\n    var elOffset  = isBody ? { top: 0, left: 0 } : $element.offset()\r\n    var scroll    = { scroll: isBody ? document.documentElement.scrollTop || document.body.scrollTop : $element.scrollTop() }\r\n    var outerDims = isBody ? { width: $(window).width(), height: $(window).height() } : null\r\n\r\n    return $.extend({}, elRect, scroll, outerDims, elOffset)\r\n  }\r\n\r\n  Tooltip.prototype.getCalculatedOffset = function (placement, pos, actualWidth, actualHeight) {\r\n    return placement == 'bottom' ? { top: pos.top + pos.height,   left: pos.left + pos.width / 2 - actualWidth / 2  } :\r\n           placement == 'top'    ? { top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2  } :\r\n           placement == 'left'   ? { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth } :\r\n        /* placement == 'right' */ { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width   }\r\n\r\n  }\r\n\r\n  Tooltip.prototype.getViewportAdjustedDelta = function (placement, pos, actualWidth, actualHeight) {\r\n    var delta = { top: 0, left: 0 }\r\n    if (!this.$viewport) return delta\r\n\r\n    var viewportPadding = this.options.viewport && this.options.viewport.padding || 0\r\n    var viewportDimensions = this.getPosition(this.$viewport)\r\n\r\n    if (/right|left/.test(placement)) {\r\n      var topEdgeOffset    = pos.top - viewportPadding - viewportDimensions.scroll\r\n      var bottomEdgeOffset = pos.top + viewportPadding - viewportDimensions.scroll + actualHeight\r\n      if (topEdgeOffset < viewportDimensions.top) { // top overflow\r\n        delta.top = viewportDimensions.top - topEdgeOffset\r\n      } else if (bottomEdgeOffset > viewportDimensions.top + viewportDimensions.height) { // bottom overflow\r\n        delta.top = viewportDimensions.top + viewportDimensions.height - bottomEdgeOffset\r\n      }\r\n    } else {\r\n      var leftEdgeOffset  = pos.left - viewportPadding\r\n      var rightEdgeOffset = pos.left + viewportPadding + actualWidth\r\n      if (leftEdgeOffset < viewportDimensions.left) { // left overflow\r\n        delta.left = viewportDimensions.left - leftEdgeOffset\r\n      } else if (rightEdgeOffset > viewportDimensions.width) { // right overflow\r\n        delta.left = viewportDimensions.left + viewportDimensions.width - rightEdgeOffset\r\n      }\r\n    }\r\n\r\n    return delta\r\n  }\r\n\r\n  Tooltip.prototype.getTitle = function () {\r\n    var title\r\n    var $e = this.$element\r\n    var o  = this.options\r\n\r\n    title = $e.attr('data-original-title')\r\n      || (typeof o.title == 'function' ? o.title.call($e[0]) :  o.title)\r\n\r\n    return title\r\n  }\r\n\r\n  Tooltip.prototype.getUID = function (prefix) {\r\n    do prefix += ~~(Math.random() * 1000000)\r\n    while (document.getElementById(prefix))\r\n    return prefix\r\n  }\r\n\r\n  Tooltip.prototype.tip = function () {\r\n    return (this.$tip = this.$tip || $(this.options.template))\r\n  }\r\n\r\n  Tooltip.prototype.arrow = function () {\r\n    return (this.$arrow = this.$arrow || this.tip().find('.tooltip-arrow'))\r\n  }\r\n\r\n  Tooltip.prototype.enable = function () {\r\n    this.enabled = true\r\n  }\r\n\r\n  Tooltip.prototype.disable = function () {\r\n    this.enabled = false\r\n  }\r\n\r\n  Tooltip.prototype.toggleEnabled = function () {\r\n    this.enabled = !this.enabled\r\n  }\r\n\r\n  Tooltip.prototype.toggle = function (e) {\r\n    var self = this\r\n    if (e) {\r\n      self = $(e.currentTarget).data('bs.' + this.type)\r\n      if (!self) {\r\n        self = new this.constructor(e.currentTarget, this.getDelegateOptions())\r\n        $(e.currentTarget).data('bs.' + this.type, self)\r\n      }\r\n    }\r\n\r\n    self.tip().hasClass('in') ? self.leave(self) : self.enter(self)\r\n  }\r\n\r\n  Tooltip.prototype.destroy = function () {\r\n    var that = this\r\n    clearTimeout(this.timeout)\r\n    this.hide(function () {\r\n      that.$element.off('.' + that.type).removeData('bs.' + that.type)\r\n    })\r\n  }\r\n\r\n\r\n  // TOOLTIP PLUGIN DEFINITION\r\n  // =========================\r\n\r\n  function Plugin(option) {\r\n    return this.each(function () {\r\n      var $this    = $(this);\r\n      var data     = $this.data('bs.tooltip');\r\n      var options  = typeof option == 'object' && option;\r\n      var selector = options && options.selector;\r\n\r\n      if (!data && option == 'destroy') return;\r\n      if (selector) {\r\n        if (!data) $this.data('bs.tooltip', (data = {}));\r\n        if (!data[selector]) data[selector] = new Tooltip(this, options);\r\n      } else if (!data) $this.data('bs.tooltip', (data = new Tooltip(this, options)));\r\n      \r\n      if (typeof option == 'string') data[option]();\r\n    })\r\n  }\r\n\r\n  var old = $.fn.tooltip\r\n\r\n  $.fn.tooltip             = Plugin\r\n  $.fn.tooltip.Constructor = Tooltip\r\n\r\n\r\n  // TOOLTIP NO CONFLICT\r\n  // ===================\r\n\r\n  $.fn.tooltip.noConflict = function () {\r\n    $.fn.tooltip = old\r\n    return this\r\n  }\r\n\r\n})(jQuery);\r\n\r\n/* ========================================================================\r\n * Bootstrap: popover.js v3.3.1\r\n * http://getbootstrap.com/javascript/#popovers\r\n * ========================================================================\r\n * Copyright 2011-2014 Twitter, Inc.\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * ======================================================================== */\r\n\r\n\r\n(function ($) {\r\n  'use strict';\r\n\r\n  // POPOVER PUBLIC CLASS DEFINITION\r\n  // ===============================\r\n\r\n  var Popover = function (element, options) {\r\n    this.init('popover', element, options)\r\n  }\r\n\r\n  if (!$.fn.tooltip) throw new Error('Popover requires tooltip.js')\r\n\r\n  Popover.VERSION  = '3.3.1'\r\n\r\n  Popover.DEFAULTS = $.extend({}, $.fn.tooltip.Constructor.DEFAULTS, {\r\n    placement: 'right',\r\n    trigger: 'click',\r\n    content: '',\r\n    template: '<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-title\"></h3><div class=\"popover-content\"></div></div>'\r\n  })\r\n\r\n\r\n  // NOTE: POPOVER EXTENDS tooltip.js\r\n  // ================================\r\n\r\n  Popover.prototype = $.extend({}, $.fn.tooltip.Constructor.prototype)\r\n\r\n  Popover.prototype.constructor = Popover\r\n\r\n  Popover.prototype.getDefaults = function () {\r\n    return Popover.DEFAULTS\r\n  }\r\n\r\n  Popover.prototype.setContent = function () {\r\n    var $tip    = this.tip()\r\n    var title   = this.getTitle()\r\n    var content = this.getContent()\r\n\r\n    $tip.find('.popover-title')[this.options.html ? 'html' : 'text'](title)\r\n    $tip.find('.popover-content').children().detach().end()[ // we use append for html objects to maintain js events\r\n      this.options.html ? (typeof content == 'string' ? 'html' : 'append') : 'text'\r\n    ](content)\r\n\r\n    $tip.removeClass('fade top bottom left right in')\r\n\r\n    // IE8 doesn't accept hiding via the `:empty` pseudo selector, we have to do\r\n    // this manually by checking the contents.\r\n    if (!$tip.find('.popover-title').html()) $tip.find('.popover-title').hide()\r\n  }\r\n\r\n  Popover.prototype.hasContent = function () {\r\n    return this.getTitle() || this.getContent()\r\n  }\r\n\r\n  Popover.prototype.getContent = function () {\r\n    var $e = this.$element\r\n    var o  = this.options\r\n\r\n    return $e.attr('data-content')\r\n      || (typeof o.content == 'function' ?\r\n            o.content.call($e[0]) :\r\n            o.content)\r\n  }\r\n\r\n  Popover.prototype.arrow = function () {\r\n    return (this.$arrow = this.$arrow || this.tip().find('.arrow'))\r\n  }\r\n\r\n  Popover.prototype.tip = function () {\r\n    if (!this.$tip) this.$tip = $(this.options.template)\r\n    return this.$tip\r\n  }\r\n\r\n\r\n  // POPOVER PLUGIN DEFINITION\r\n  // =========================\r\n\r\n  function Plugin(option) {\r\n    return this.each(function () {\r\n      var $this    = $(this)\r\n      var data     = $this.data('bs.popover')\r\n      var options  = typeof option == 'object' && option\r\n      var selector = options && options.selector\r\n\r\n      if (!data && option == 'destroy') return\r\n      if (selector) {\r\n        if (!data) $this.data('bs.popover', (data = {}))\r\n        if (!data[selector]) data[selector] = new Popover(this, options)\r\n      } else if (!data) $this.data('bs.popover', (data = new Popover(this, options)))\r\n      \r\n      if (typeof option == 'string') data[option]()\r\n    })\r\n  }\r\n\r\n  var old = $.fn.popover\r\n\r\n  $.fn.popover             = Plugin\r\n  $.fn.popover.Constructor = Popover\r\n\r\n\r\n  // POPOVER NO CONFLICT\r\n  // ===================\r\n\r\n  $.fn.popover.noConflict = function () {\r\n    $.fn.popover = old\r\n    return this\r\n  }\r\n\r\n})(jQuery);\r\n","import nsGmx from '../nsGmx.js';\r\nimport '../translations.js';\r\nimport './gmxIconLayers.css';\r\nimport '../IconLayers/iconLayers.css';\r\nimport '../IconLayers/iconLayers.js';\r\nimport '../Popover/popover.css';\r\nimport '../Popover/popover.js';\r\n\r\nnsGmx.Translations.addText('rus', {\r\n    gmxIconLayers: {\r\n        zoominpls: 'Приблизьте карту, чтобы активировать слой',\r\n        zoomoutpls: 'Отдалите карту, чтобы активировать слой'\r\n    }\r\n});\r\n\r\nnsGmx.Translations.addText('eng', {\r\n    gmxIconLayers: {\r\n        zoominpls: 'Zoom in to enable layer',\r\n        zoomoutpls: 'Zoom out to enable layer'\r\n    }\r\n});\r\n\r\nwindow.L.Control.GmxIconLayers = window.L.Control.IconLayers.extend({\r\n    _updateLayers: function() {\r\n        var lang = nsGmx.Translations.getLanguage();\r\n        lang = lang || 'rus';\r\n        var blm = this._baseLayersManager;\r\n        var layers = blm.getActiveIDs().map(function(id) {\r\n            var layer = blm.get(id);\r\n            if (!layer) {\r\n                return null;\r\n            } else {\r\n                return {\r\n                    layer: layer,\r\n                    icon: layer.options.icon,\r\n                    title: layer.options[lang]\r\n                }\r\n            }\r\n        }).filter(function(e) {\r\n            return e;\r\n        });\r\n\r\n        this.setLayers(layers);\r\n        this.setActiveLayer(\r\n            blm.get(\r\n                blm.getCurrentID()\r\n            )\r\n        );\r\n\r\n        this._updateDisabledLayers();\r\n    },\r\n    _updateDisabledLayers: function() {\r\n        this._disabledLayerIds = this._map ? this._baseLayersManager.getActiveIDs().map(function(id) {\r\n            return this._baseLayersManager.get(id);\r\n        }.bind(this)).filter(function(l) {\r\n            return !!l && (this._map.getZoom() < l.options.minZoom || this._map.getZoom() > l.options.maxZoom);\r\n        }.bind(this)).map(function(l) {\r\n            return L.stamp(l) + '';\r\n        }) : [];\r\n        this._updateDisabledLayersStyle();\r\n    },\r\n    _updateDisabledLayersStyle: function() {\r\n        var els = this._container ? this._container.getElementsByClassName('leaflet-iconLayers-layerCell') : [];\r\n\r\n        Array.prototype.slice.call(els).map(function(el) {\r\n            var elId = el.getAttribute('data-layerid');\r\n            if (this._disabledLayerIds.indexOf(elId) + 1) {\r\n                L.DomUtil.addClass(el, 'leaflet-iconLayers-layerCell_disabled');\r\n            } else {\r\n                L.DomUtil.removeClass(el, 'leaflet-iconLayers-layerCell_disabled');\r\n            }\r\n        }.bind(this));\r\n    },\r\n    _updatePopoversContent: function() {\r\n        var els = this._container ? this._container.getElementsByClassName('leaflet-iconLayers-layerCell') : [];\r\n\r\n        var defaultTemplate = (new $.fn.popover.Constructor()).getDefaults().template;\r\n\r\n        function createPopover(el, text) {\r\n            $(el).popover({\r\n                viewport: {\r\n                    selector: this._map && this._map.getContainer(),\r\n                    padding: 10\r\n                },\r\n                container: this._map && this._map.getContainer(),\r\n                content: text,\r\n                trigger: 'manual',\r\n                placement: this.options.position.indexOf('bottom') != -1 ? 'top' : 'bottom',\r\n                html: true,\r\n                template: $(defaultTemplate).css('pointer-events', 'none')[0].outerHTML\r\n            });\r\n            if (el.mouseIsOver) {\r\n                $(el).popover('show');\r\n            }\r\n        }\r\n\r\n        Array.prototype.slice.call(els).map(function(el) {\r\n            var elId = el.getAttribute('data-layerid');\r\n            var layerEl = el.getElementsByClassName('leaflet-iconLayers-layer')[0];\r\n            var layer = this._layers[elId].layer;\r\n            if (layer.options.maxZoom && this._map && this._map.getZoom() > layer.options.maxZoom) {\r\n                $(layerEl).popover('destroy');\r\n                createPopover.call(this, layerEl, nsGmx.Translations.getText('gmxIconLayers.zoomoutpls'));\r\n            } else if (layer.options.minZoom && this._map && this._map.getZoom() < layer.options.minZoom) {\r\n                $(layerEl).popover('destroy');\r\n                createPopover.call(this, layerEl, nsGmx.Translations.getText('gmxIconLayers.zoominpls'));\r\n            } else if (layer.options.description) {\r\n                $(layerEl).popover('destroy');\r\n                createPopover.call(this, layerEl, layer.options.description);\r\n            } else {\r\n                $(layerEl).popover('destroy');\r\n            }\r\n        }.bind(this));\r\n    },\r\n    _createLayerElement: function(layerObj) {        \r\n        var el = L.Control.IconLayers.prototype._createLayerElement.call(this, layerObj);\r\n        var shutterEl = L.DomUtil.create('div', 'leaflet-iconLayers-layerShutter');\r\n        $(el).prepend(shutterEl);\r\n        el.addEventListener('mouseover', function(e) {\r\n            e.currentTarget.mouseIsOver = true;\r\n            $(e.currentTarget).popover('show');\r\n        });\r\n        el.addEventListener('mouseout', function(e) {\r\n            e.currentTarget.mouseIsOver = false;\r\n            $(e.currentTarget).popover('hide');\r\n        });\r\n        return el;\r\n    },\r\n    _render: function() {\r\n        L.Control.IconLayers.prototype._render.apply(this, arguments);\r\n        this._updateDisabledLayers();\r\n        this._updatePopoversContent();\r\n    },\r\n    _onLayerClick: function(e) {\r\n        e.stopPropagation();\r\n        $(e.currentTarget).find('.leaflet-iconLayers-layer').popover('hide')\r\n        var layerId = e.currentTarget.getAttribute('data-layerid');\r\n        if (this._disabledLayerIds.indexOf(layerId) === -1) {\r\n            var layer = this._layers[layerId];\r\n            this.setActiveLayer(layer.layer);\r\n        }\r\n        this.expand();\r\n    },\r\n    initialize: function(gmxBaseLayersManager, options) {\r\n        L.Control.IconLayers.prototype.initialize.call(this, [], L.extend(options || {}, {\r\n            manageLayers: false\r\n        }));\r\n\r\n        this._baseLayersManager = gmxBaseLayersManager;\r\n        this._updateLayers();\r\n\r\n        this.on('activelayerchange', function(le) {\r\n            this._baseLayersManager.setCurrentID(le.layer.id);\r\n        }.bind(this));\r\n\r\n        this._baseLayersManager.on('baselayeradd', this._updateLayers.bind(this));\r\n        this._baseLayersManager.on('baselayerremove', this._updateLayers.bind(this));\r\n        this._baseLayersManager.on('baselayeractiveids', this._updateLayers.bind(this));\r\n        this._baseLayersManager.on('baselayerchange', this._updateLayers.bind(this));\r\n        this._baseLayersManager.on('baselayerlayerschange', this._updateLayers.bind(this));\r\n    },\r\n    onAdd: function() {\r\n        var container = L.Control.IconLayers.prototype.onAdd.apply(this, arguments);\r\n        this._map.on('zoomend', function() {\r\n            this._updateDisabledLayers();\r\n            this._updatePopoversContent();\r\n        }.bind(this));\r\n        return container;\r\n    }\r\n});\r\n","import nsGmx from '../nsGmx.js';\r\n\r\nvar DateInterval = Backbone.Model.extend({\r\n    initialize: function() {\r\n        if (!('dateBegin' in this.attributes) && !('dateEnd' in this.attributes)) {\r\n            this.set(DateInterval.getUTCDayBoundary());\r\n        }\r\n    },\r\n\r\n    saveState: function() {\r\n        return {\r\n            version: '1.1.0',\r\n            dateBegin: +this.attributes.dateBegin,\r\n            dateEnd: +this.attributes.dateEnd\r\n        }\r\n    },\r\n\r\n    loadState: function(state) {\r\n        if (!state.version || state.version === '1.1.0' || state.version === '1.0.0') {\r\n            this.set({\r\n                dateBegin: new Date(state.dateBegin),\r\n                dateEnd: new Date(state.dateEnd)\r\n            })\r\n        } else {\r\n            throw 'Unknown state version';\r\n        }\r\n    }\r\n}, {\r\n    //number of milliseconds in one day\r\n    MS_IN_DAY: 24*3600*1000,\r\n\r\n    //set time to UTC midnight\r\n    toMidnight: function(date) {\r\n        return new Date(date - date % DateInterval.MS_IN_DAY);\r\n    },\r\n\r\n    getUTCDayBoundary: function(date) {\r\n        date = date || new Date();\r\n\r\n        var midnight = DateInterval.toMidnight(date);\r\n        return {\r\n            dateBegin: midnight,\r\n            dateEnd: new Date(midnight.valueOf() + DateInterval.MS_IN_DAY)\r\n        }\r\n    },\r\n\r\n    // 24+n interval\r\n    defaultFireDateInterval: function() {\r\n        var now = new Date(),\r\n            lastMidnight = DateInterval.toMidnight(now),\r\n            dateEnd = new Date((now - 1) - (now - 1) % (3600*1000) + 3600*1000), //round to the nearest hour greater then 'now'\r\n            isTooSmall = dateEnd - lastMidnight < 12*3600*1000,\r\n            dateBegin = new Date(isTooSmall ? (lastMidnight - nsGmx.DateInterval.MS_IN_DAY) : lastMidnight.valueOf());\r\n\r\n        return {\r\n            dateBegin: dateBegin,\r\n            dateEnd: dateEnd\r\n        }\r\n    }\r\n})\r\n\r\nnsGmx.DateInterval = DateInterval;","import nsGmx from '../nsGmx.js';\r\nimport './CalendarWidget.css';\r\nimport '../GmxWidget/GmxWidget.js';\r\nimport '../CommonCalendarWidget/CommonCalendarWidget.css';\r\n\r\nnsGmx.Templates = nsGmx.Templates || {};\r\nnsGmx.Templates.CalendarWidget = {};\r\nnsGmx.Templates.CalendarWidget[\"CalendarWidget\"] = \"<table>\\n\" +\r\n    \"    <tr>\\n\" +\r\n    \"        <td><div class = \\\"CalendarWidget-iconScrollLeft ui-helper-noselect icon-left-open\\\"></div></td>\\n\" +\r\n    \"        <td class = \\\"CalendarWidget-inputCell\\\"><input class = \\\"gmx-input-text CalendarWidget-dateBegin\\\"></td>\\n\" +\r\n    \"        <td class = \\\"CalendarWidget-inputCell CalendarWidget-onlyMaxVersion\\\"><input class = \\\"gmx-input-text CalendarWidget-dateEnd\\\"></td>\\n\" +\r\n    \"        <td><div class = \\\"CalendarWidget-iconScrollRight ui-helper-noselect icon-right-open\\\" ></div></td>\\n\" +\r\n    \"        <td><div class = \\\"CalendarWidget-iconMore {{moreIconClass}}\\\" title = \\\"{{moreIconTitle}}\\\"></div></td>\\n\" +\r\n    \"        <td><div class = \\\"CalendarWidget-forecast\\\" hidden>{{forecast}}</div></td>\\n\" +\r\n    \"    </tr><tr>\\n\" +\r\n    \"        <td></td>\\n\" +\r\n    \"        <td class = \\\"CalendarWidget-dateBeginInfo\\\"></td>\\n\" +\r\n    \"        <td class = \\\"CalendarWidget-dateEndInfo\\\"></td>\\n\" +\r\n    \"        <td></td>\\n\" +\r\n    \"        <td></td>\\n\" +\r\n    \"    </tr>\\n\" +\r\n    \"</table>\\n\" +\r\n    \"<div class=\\\"CalendarWidget-footer\\\"></div>\\n\" +\r\n    \"\";\r\n\r\n(function($){\r\n\r\n'use strict';\r\n\r\nvar _gtxt = nsGmx.Translations.getText.bind(nsGmx.Translations),\r\n    toMidnight = nsGmx.DateInterval.toMidnight;\r\n\r\n/** Параметры календаря\r\n * @typedef nsGmx.CalendarWidget~Parameters\r\n * @property {nsGmx.DateInterval} dateInterval Временной интервал, который нужно менять\r\n * @property {Date} [dateMin] минимальная граничная дата для календарей, null - без ограничений\r\n * @property {Date} [dateMax] максимальная граничная дата для календарей, null - без ограничений\r\n * @property {String} [dateFormat='dd.mm.yy'] формат даты\r\n * @property {bool} [minimized=true] показывать ли минимизированный или развёрнутый виджет в начале\r\n * @property {bool} [showSwitcher=true] показывать ли иконку для разворачивания/сворачивания периода\r\n * @property {Date} [dateBegin=<текущая дата>] начальная дата интервала\r\n * @property {Date} [dateEnd=<текущая дата>] конечная дата интервала\r\n * @property {String|DOMNode} [container] куда добавлять календарик\r\n * @property {String} [buttonImage] URL иконки для активации календариков\r\n */\r\n\r\n/** Контрол для задания диапазона дат. Даты календарика всегда в UTC, а не в текущем поясе.\r\n @description Виджет для выбора интервала дат. Пользователь при помощи datepicker'ов выбирает два дня (год, месяц, число),\r\n              затем выбранные значения при помощи ф-ции `_updateModel()` переводятся в интервал дат ({@link nsGmx.DateInterval}).\r\n              Так же виджет реагирует на изменения модели (с использованием ф-ции `_updateWidget()`)\r\n @alias nsGmx.CalendarWidget\r\n @extends nsGmx.GmxWidget\r\n @class\r\n @param {nsGmx.CalendarWidget~Parameters} options Параметры календаря\r\n*/\r\nvar Calendar = nsGmx.GmxWidget.extend({\r\n    tagName: 'div',\r\n    className: 'CalendarWidget ui-widget',\r\n    template: Handlebars.compile(nsGmx.Templates.CalendarWidget.CalendarWidget),\r\n\r\n    events: {\r\n        'click .CalendarWidget-iconMore': 'toggleMode',\r\n        'click .CalendarWidget-iconScrollLeft': function() {\r\n            this._shiftDates(-1);\r\n        },\r\n        'click .CalendarWidget-iconScrollRight': function() {\r\n            this._shiftDates(1);\r\n        }\r\n    },\r\n\r\n    initialize: function(options) {\r\n        options = $.extend({\r\n            minimized: true,\r\n            showSwitcher: true,\r\n            dateMax: null,\r\n            dateMin: null,\r\n            dateFormat: 'dd.mm.yy',\r\n            name: null\r\n        }, options);\r\n\r\n        this._dateMin = options.dateMin;\r\n        this._dateMax = options.dateMax;\r\n\r\n        this._dateInterval = options.dateInterval;\r\n\r\n        this.$el.html(this.template({\r\n            moreIconClass: options.minimized ? 'icon-calendar' : 'icon-calendar-empty',\r\n            moreIconTitle: options.minimized ? _gtxt('CalendarWidget.ExtendedViewTitle') : _gtxt('CalendarWidget.MinimalViewTitle'),\r\n            forecast: _gtxt('CalendarWidget.forecast')\r\n        }));\r\n\r\n        this._moreIcon = this.$('.CalendarWidget-iconMore')\r\n            .toggle(!!options.showSwitcher);\r\n\r\n        this._dateBegin = this.$('.CalendarWidget-dateBegin');\r\n        this._dateEnd = this.$('.CalendarWidget-dateEnd');\r\n        this._dateInputs = this._dateBegin.add(this._dateEnd);\r\n\r\n        this._dateInputs.datepicker({\r\n            onSelect: function(dateText, inst){\r\n                this._selectFunc(inst.input);\r\n                this._updateModel();\r\n            }.bind(this),\r\n            showAnim: 'fadeIn',\r\n            changeMonth: true,\r\n            changeYear: true,\r\n            minDate: this._dateMin ? Calendar.toUTC(this._dateMin) : null,\r\n            maxDate: this._dateMax ? Calendar.toUTC(this._dateMax) : null,\r\n            dateFormat: options.dateFormat,\r\n            defaultDate: Calendar.toUTC(this._dateMax || new Date()),\r\n            showOn: options.buttonImage ? 'both' : 'focus',\r\n            buttonImageOnly: true\r\n        });\r\n\r\n        //устанавливаем опцию после того, как добавили календарик в canvas\r\n        if (options.buttonImage) {\r\n            this._dateInputs.datepicker('option', 'buttonImage', options.buttonImage);\r\n        }\r\n\r\n        this.$('.CalendarWidget-onlyMaxVersion').toggle(!options.minimized);\r\n\r\n        options.dateBegin && this._dateBegin.datepicker('setDate', Calendar.toUTC(options.dateBegin));\r\n        options.dateEnd && this._dateEnd.datepicker('setDate', Calendar.toUTC(options.dateEnd));\r\n\r\n        if (options.container) {\r\n            if (typeof options.container === 'string')\r\n                $('#' + options.container).append(this.$el);\r\n            else\r\n                $(options.container).append(this.$el);\r\n        }\r\n\r\n        this.setMode(options.minimized ? Calendar.SIMPLE_MODE : Calendar.ADVANCED_MODE);\r\n\r\n        this._updateWidget();\r\n\r\n        this._dateInterval.on('change', this._updateWidget, this);\r\n\r\n        //for backward compatibility\r\n        this.canvas = this.$el;\r\n    },\r\n\r\n    _shiftDates: function(delta) {\r\n        var dateBegin = this.getDateBegin(),\r\n            dateEnd = this.getDateEnd();\r\n\r\n        if (!dateBegin || !dateEnd) {\r\n            return;\r\n        }\r\n\r\n        var shift = (dateEnd - dateBegin + nsGmx.DateInterval.MS_IN_DAY) * delta,\r\n            newDateBegin = new Date(dateBegin.valueOf() + shift),\r\n            newDateEnd = new Date(dateEnd.valueOf() + shift);\r\n\r\n        if ((!this._dateMin || toMidnight(this._dateMin) <= toMidnight(newDateBegin)) &&\r\n            (!this._dateMax || toMidnight(this._dateMax) >= toMidnight(newDateEnd)))\r\n        {\r\n            this._dateBegin.datepicker('setDate', Calendar.toUTC(newDateBegin));\r\n            this._dateEnd.datepicker('setDate', Calendar.toUTC(newDateEnd));\r\n\r\n            this._updateModel();\r\n        }\r\n    },\r\n\r\n    _selectFunc: function(activeInput) {\r\n        var begin = this._dateBegin.datepicker('getDate');\r\n        var end   = this._dateEnd.datepicker('getDate');\r\n\r\n        if (end && begin && begin > end) {\r\n            var dateToFix = activeInput[0] == this._dateEnd[0] ? this._dateBegin : this._dateEnd;\r\n            dateToFix.datepicker('setDate', $(activeInput[0]).datepicker('getDate'));\r\n        } else if (this._curMode === Calendar.SIMPLE_MODE) {\r\n            //либо установлена только одна дата, либо две, но отличающиеся\r\n            if (!begin != !end || begin && begin.valueOf() !== end.valueOf()) {\r\n                this._dateEnd.datepicker('setDate', this._dateBegin.datepicker('getDate'));\r\n            }\r\n        }\r\n    },\r\n\r\n    _updateModel: function() {\r\n        var dateBegin = this.getDateBegin(),\r\n            dateEnd = this.getDateEnd();\r\n\r\n        this._dateInterval.set({\r\n            dateBegin: dateBegin ? toMidnight(dateBegin) : null,\r\n            dateEnd: dateEnd ? toMidnight(dateEnd.valueOf() + nsGmx.DateInterval.MS_IN_DAY) : null\r\n        });\r\n    },\r\n\r\n    _updateWidget: function() {\r\n        var dateBegin = this._dateInterval.get('dateBegin'),\r\n            dateEnd = this._dateInterval.get('dateEnd'),\r\n            dayms = nsGmx.DateInterval.MS_IN_DAY;\r\n\r\n        if (!dateBegin || !dateEnd) {\r\n            return;\r\n        }\r\n\r\n        var isValid = !(dateBegin % dayms) && !(dateEnd % dayms);\r\n\r\n        var newDateBegin = Calendar.toUTC(dateBegin),\r\n            newDateEnd;\r\n        if (isValid) {\r\n            newDateEnd = Calendar.toUTC(new Date(dateEnd - dayms));\r\n            if (dateEnd - dateBegin > dayms) {\r\n                this.setMode(Calendar.ADVANCED_MODE);\r\n            }\r\n        } else {\r\n            newDateEnd = Calendar.toUTC(dateEnd);\r\n            this.setMode(Calendar.ADVANCED_MODE);\r\n        }\r\n\r\n        //если мы сюда пришли после выбора интервала в самом виджете, вызов setDate сохраняет фокус на input-поле\r\n        //возможно, это какая-то проблема jQueryUI.datepicker'ов.\r\n        //чтобы этого избежать, явно проверяем, нужно ли изменять дату\r\n        var prevDateBegin = this._dateBegin.datepicker('getDate'),\r\n            prevDateEnd = this._dateEnd.datepicker('getDate');\r\n\r\n        if (!prevDateBegin || prevDateBegin.valueOf() !== newDateBegin.valueOf()) {\r\n            this._dateBegin.datepicker('setDate', newDateBegin);\r\n        }\r\n\r\n        if (!prevDateEnd || prevDateEnd.valueOf() !== newDateEnd.valueOf()) {\r\n            this._dateEnd.datepicker('setDate', newDateEnd);\r\n        }\r\n    },\r\n\r\n    //public interface\r\n\r\n    /** Закрыть все открытые datepicker'ы.\r\n     * @return {nsGmx.CalendarWidget} this\r\n     */\r\n    reset: function() {\r\n        this._dateInputs.datepicker('hide');\r\n        return this;\r\n    },\r\n\r\n    /** Сериализация состояния виджета\r\n     * @return {Object} Сериализованное состояние\r\n     */\r\n    saveState: function() {\r\n        return {\r\n            version: '1.1.0',\r\n            vismode: this.getMode()\r\n        }\r\n    },\r\n\r\n    /** Восстановить состояние виджета по сериализованным данным\r\n     * @param {Object} data Сериализованное состояние календарика\r\n     */\r\n    loadState: function( data ) {\r\n        this.setMode(data.vismode);\r\n    },\r\n\r\n    /** Получить начальную дату\r\n     * @return {Date} начальная дата\r\n     */\r\n    getDateBegin: function() {\r\n        return Calendar.fromUTC(this._dateBegin.datepicker('getDate'));\r\n    },\r\n\r\n    /** Получить конечную дату\r\n     * @return {Date} конечная дата\r\n     */\r\n    getDateEnd: function() {\r\n        return Calendar.fromUTC(this._dateEnd.datepicker('getDate'));\r\n    },\r\n\r\n    /** Получить верхнюю границу возможных дат периода\r\n     * @return {Date} верхняя граница возможных периодов\r\n     */\r\n    getDateMax: function() {\r\n        return this._dateMax;\r\n    },\r\n\r\n    /** Получить нижнуюю границу возможных дат периода\r\n     * @return {Date} нижняя граница возможных периодов\r\n     */\r\n    getDateMin: function() {\r\n        return this._dateMin;\r\n    },\r\n\r\n    /** Установить нижнуюю границу возможных дат периода\r\n     * @param {Date} dateMin нижняя граница возможных периодов\r\n     */\r\n    setDateMin: function(dateMin) {\r\n        this._dateMin = dateMin;\r\n        this._dateInputs.datepicker('option', 'minDate', dateMin ? Calendar.toUTC(dateMin) : null);\r\n    },\r\n\r\n    /** Установить верхнюю границу возможных дат периода\r\n     * @param {Date} dateMax верхняя граница возможных периодов\r\n     */\r\n    setDateMax: function(dateMax) {\r\n        var titleContainer = this.$('.CalendarWidget-forecast');\r\n\r\n        this._dateMax = dateMax;\r\n        if (dateMax) {\r\n            var utcDate = Calendar.toUTC(dateMax);\r\n            this._dateInputs.datepicker('option', 'maxDate', utcDate);\r\n\r\n            if (dateMax > new Date()) {\r\n                $(titleContainer).attr('title', _gtxt('CalendarWidget.tooltip') + ' ' +\r\n                ('0' + dateMax.getDate()).slice(-2) + '.' +\r\n                ('0' + (dateMax.getMonth() + 1)).slice(-2) + '.' +\r\n                dateMax.getFullYear());\r\n                $(titleContainer).show();\r\n            } else {\r\n                $(titleContainer).hide();\r\n            }\r\n\r\n        } else {\r\n            this._dateInputs.datepicker('option', 'maxDate', null);\r\n        }\r\n    },\r\n\r\n    setSwitcherVisibility: function(isVisible) {\r\n        this._moreIcon && this._moreIcon.toggle(isVisible);\r\n    },\r\n\r\n    getDateInterval: function() {\r\n        return this._dateInterval;\r\n    },\r\n\r\n    getMode: function() {\r\n        return this._curMode;\r\n    },\r\n\r\n    setMode: function(mode) {\r\n        if (this._curMode === mode) {\r\n            return this;\r\n        }\r\n\r\n        this.reset();\r\n\r\n        this._curMode = mode;\r\n        var isSimple = mode === Calendar.SIMPLE_MODE;\r\n\r\n        this.$('.CalendarWidget-onlyMaxVersion').toggle(!isSimple);\r\n\r\n        this._moreIcon\r\n            .toggleClass('icon-calendar', isSimple)\r\n            .toggleClass('icon-calendar-empty', !isSimple)\r\n            .attr('title', isSimple ? _gtxt('CalendarWidget.ExtendedViewTitle') : _gtxt('CalendarWidget.MinimalViewTitle'));\r\n\r\n\r\n        var dateBegin = this._dateBegin.datepicker('getDate'),\r\n            dateEnd = this._dateEnd.datepicker('getDate');\r\n\r\n        if (isSimple && dateBegin && dateEnd && dateBegin.valueOf() !== dateEnd.valueOf()) {\r\n            this._selectFunc(this._dateEnd);\r\n            this._updateModel();\r\n        }\r\n\r\n        this.trigger('modechange');\r\n\r\n        return this;\r\n    },\r\n\r\n    toggleMode: function() {\r\n        this.setMode(this._curMode === Calendar.SIMPLE_MODE ? Calendar.ADVANCED_MODE : Calendar.SIMPLE_MODE );\r\n    }\r\n}, {\r\n    /* static methods */\r\n    fromUTC: function(date) {\r\n        if (!date) return null;\r\n        var timeOffset = date.getTimezoneOffset()*60*1000;\r\n        return new Date(date.valueOf() - timeOffset);\r\n    },\r\n    toUTC: function(date) {\r\n        if (!date) return null;\r\n        var timeOffset = date.getTimezoneOffset()*60*1000;\r\n        return new Date(date.valueOf() + timeOffset);\r\n    },\r\n    SIMPLE_MODE: 1,\r\n    ADVANCED_MODE: 2\r\n});\r\n\r\nnsGmx.CalendarWidget = Calendar;\r\n\r\n})(jQuery);\r\n\r\nnsGmx.Translations.addText(\"rus\", { CalendarWidget: {\r\n    ExtendedViewTitle: \"Выбор периода\",\r\n    MinimalViewTitle:  \"Свернуть\",\r\n    UTC:               \"Всемирное координированное время\",\r\n    forecast:           \"прогноз\",\r\n    tooltip:            \"доступны прогнозные данные до\"\r\n}});\r\n\r\nnsGmx.Translations.addText(\"eng\", { CalendarWidget: {\r\n    ExtendedViewTitle: \"Period selection\",\r\n    MinimalViewTitle:  \"Minimize\",\r\n    UTC:               \"Coordinated Universal Time\",\r\n    forecast:           \"forecast\",\r\n    tooltip:            \"forecast data is available up to\"\r\n}});\r\n\r\n/** Контрол для задания диапазона дат с логикой работы, взятой с сайта fires.ru.\r\n @description Основное отличае в логине формировании интервала на основе выбранных в календариках дат.\r\n              Работает так же, как и обычный виджет ({@link nsGmx.CalendarWidget}) за исключением ситуации, когда dateEnd попадает в текущие UTC сутки.\r\n              В этом случае, dateEnd устанавливается равном началу следующего часа. Далее, если длина выбранного интервала меньше 12 часов, начало интервала смещается на сутки назад.\r\n              Кроме формирования интервала, этот виджет показывает пользователю дополнительную информацию о выбранном интервале.\r\n @alias nsGmx.FireCalendarWidget\r\n @class\r\n @param {nsGmx.CalendarWidget~Parameters} params Параметры календаря\r\n*/\r\n\r\n(function($){\r\n\r\n'use strict';\r\n\r\nvar toMidnight = nsGmx.DateInterval.toMidnight;\r\n\r\nnsGmx.Translations.addText(\"rus\", { FireCalendarWidget: {\r\n    timeTitlePrefix : 'За ',\r\n    timeTitleLastPrefix : 'За последние ',\r\n    timeTitlePostfix : 'ч (UTC)'\r\n}});\r\n\r\nnsGmx.Translations.addText(\"eng\", { FireCalendarWidget: {\r\n    timeTitlePrefix : 'For ',\r\n    timeTitleLastPrefix : 'For last ',\r\n    timeTitlePostfix : 'h (UTC)'\r\n}});\r\n\r\n\r\nfunction f(n) {\r\n    return n < 10 ? '0' + n : n;\r\n}\r\n\r\nfunction getStr (hours, minutes) {\r\n    return f(hours) + \":\" + f(minutes); /*+ \":\" + f(time.seconds)*/\r\n}\r\n\r\nvar FireCalendarWidget = nsGmx.CalendarWidget.extend({\r\n    initialize: function(options) {\r\n        options = $.extend({\r\n            dateMax: new Date()\r\n        }, options);\r\n\r\n        nsGmx.CalendarWidget.prototype.initialize.call(this, options);\r\n\r\n        this._dateInterval.on('change', this._updateInfo, this);\r\n        this.on('modechange', this._updateInfo, this);\r\n        this.on('modechange', this._updateModel, this);\r\n        this._updateInfo();\r\n    },\r\n\r\n    _updateModel: function() {\r\n        var dateBegin = this.getDateBegin(),\r\n            origDateEnd = this.getDateEnd(),\r\n            now = new Date(),\r\n            lastMidnight = toMidnight(now),\r\n            dateEnd;\r\n\r\n        if (lastMidnight <= origDateEnd) {\r\n            //last day\r\n            dateEnd = new Date((now - 1) - (now - 1) % (3600*1000) + 3600*1000); //round to the nearest hour greater then 'now'\r\n\r\n            if (dateEnd - toMidnight(dateBegin) < 12*3600*1000 && this.getMode() === nsGmx.CalendarWidget.SIMPLE_MODE) {\r\n                dateBegin = new Date(dateBegin - nsGmx.DateInterval.MS_IN_DAY);\r\n            }\r\n        } else {\r\n            //previous days\r\n            dateEnd = new Date(origDateEnd.valueOf() + nsGmx.DateInterval.MS_IN_DAY);\r\n        }\r\n\r\n        this._dateInterval.set({\r\n            dateBegin: toMidnight(dateBegin),\r\n            dateEnd: dateEnd\r\n        });\r\n    },\r\n\r\n    _updateWidget: function() {\r\n        var dateBegin = +this._dateInterval.get('dateBegin'),\r\n            dateEnd = +this._dateInterval.get('dateEnd');\r\n\r\n        if (!dateBegin || !dateEnd) {\r\n            return;\r\n        }\r\n\r\n        var currentDayMode = toMidnight(new Date()) < dateEnd;\r\n\r\n        if (currentDayMode && this.getMode() === nsGmx.CalendarWidget.SIMPLE_MODE && dateEnd - dateBegin < 2 * nsGmx.DateInterval.MS_IN_DAY) {\r\n            this._dateBegin.datepicker(\"setDate\", nsGmx.CalendarWidget.toUTC(new Date()));\r\n            this._dateEnd.datepicker(\"setDate\", nsGmx.CalendarWidget.toUTC(new Date()));\r\n        } else if (nsGmx.CalendarWidget1) {\r\n            nsGmx.CalendarWidget1.prototype._updateWidget.call(this);\r\n        } else {\r\n            nsGmx.CalendarWidget.prototype._updateWidget.call(this);\r\n        }\r\n    },\r\n\r\n    _updateInfo: function() {\r\n        var isSimpleMode = this.getMode() === nsGmx.CalendarWidget.SIMPLE_MODE;\r\n\r\n        this.$('.CalendarWidget-footer').toggle(isSimpleMode);\r\n        this.$('.CalendarWidget-dateBeginInfo, .CalendarWidget-dateEndInfo').toggle(!isSimpleMode);\r\n\r\n        var dateBegin = this._dateInterval.get('dateBegin'),\r\n            dateEnd = this._dateInterval.get('dateEnd');\r\n\r\n        if (!dateBegin || !dateEnd) {\r\n            return;\r\n        }\r\n\r\n        var hours = Math.ceil((dateEnd - dateBegin)/3600000);\r\n\r\n        if (isSimpleMode) {\r\n            var hoursStr = hours > 24 ? \"24+\" + (hours-24) : hours;\r\n            var prefix = hours === 24 ? _gtxt(\"FireCalendarWidget.timeTitlePrefix\") : _gtxt(\"FireCalendarWidget.timeTitleLastPrefix\");\r\n\r\n            this.$('.CalendarWidget-footer').html(prefix + hoursStr + _gtxt(\"FireCalendarWidget.timeTitlePostfix\"));\r\n        } else {\r\n            var dateEndToShow = (hours % 24) === 0 ? new Date(+dateEnd - 1) : dateEnd; //hack to show 23:59 instead of 00:00\r\n            this.$('.CalendarWidget-dateBeginInfo').text(getStr(dateBegin.getUTCHours(), dateBegin.getUTCMinutes()) + \" (UTC)\").attr('title', _gtxt('CalendarWidget.UTC'));\r\n            this.$('.CalendarWidget-dateEndInfo'  ).text(getStr(dateEndToShow.getUTCHours(), dateEndToShow.getUTCMinutes()) + \" (UTC)\").attr('title', _gtxt('CalendarWidget.UTC'));\r\n\r\n        }\r\n    }\r\n}, {\r\n    defaultFireDateInterval: function() {\r\n        var now = new Date(),\r\n            lastMidnight = toMidnight(now),\r\n            dateEnd = new Date((now - 1) - (now - 1) % (3600*1000) + 3600*1000), //round to the nearest hour greater then 'now'\r\n            isTooSmall = dateEnd - lastMidnight < 12*3600*1000,\r\n            dateBegin = new Date(isTooSmall ? (lastMidnight - nsGmx.DateInterval.MS_IN_DAY) : lastMidnight.valueOf());\r\n\r\n        return {\r\n            dateBegin: dateBegin,\r\n            dateEnd: dateEnd\r\n        }\r\n    }\r\n});\r\n\r\nnsGmx.FireCalendarWidget = FireCalendarWidget;\r\n\r\n})(jQuery);","import nsGmx from '../nsGmx.js';\r\nimport './CalendarWidget.css';\r\n\r\n(function($){\r\n\r\n'use strict';\r\n\r\nvar _gtxt = nsGmx.Translations.getText.bind(nsGmx.Translations),\r\n    toMidnight = nsGmx.DateInterval.toMidnight;\r\n\r\n\r\n    nsGmx.Translations.addText(\"rus\", { CalendarWidget: {\r\n        ShowIconTitle:     \"Выбрать дату\",\r\n        createDateInterval: \"Задать интервал\",\r\n        resetDateInterval:  \"Сбросить интервал\",\r\n        selectDateInterval: \"Применить\",\r\n        hour:               \"ч.\",\r\n        from: \"с\",\r\n        to: \"до\"\r\n    }});\r\n\r\n    nsGmx.Translations.addText(\"eng\", { CalendarWidget: {\r\n        ShowIconTitle:     \"Select date\",\r\n        createDateInterval: \"Create date interval\",\r\n        resetDateInterval:  \"Reset date interval\",\r\n        selectDateInterval: \"Select date interval\",\r\n        hour:               \"h.\",\r\n        from: \"from\",\r\n        to: \"to\"\r\n    }});\r\n\r\n    var template = '' +\r\n        '<div>' +\r\n            '<div class = \"CalendarWidget-row CalendarWidget-dates\">' +\r\n                // dates block\r\n                '<span class = \"CalendarWidget-iconScrollLeft icon-left-open\"></span>' +\r\n                '<span class = \"CalendarWidget-dates-outside\">' +\r\n                    '<span class = \"CalendarWidget-inputCell CalendarWidget-inputCell-inputBegin\">' +\r\n                    '<input class = \"CalendarWidget-dateBegin\">' +\r\n                    '</span>' +\r\n                    '<span class = \"CalendarWidget-inputCell CalendarWidget-inputCell-inputMiddle\">-</span>' +\r\n                    '<span class = \"CalendarWidget-inputCell CalendarWidget-inputCell-inputEnd\">' +\r\n                    '<input class = \"CalendarWidget-dateEnd\">' +\r\n                    '</span>' +\r\n                '</span>' +\r\n                '<span class = \"CalendarWidget-iconScrollRight ui-helper-noselect icon-right-open\"></span>' +\r\n                // space between dates and time\r\n                '<span class = \"CalendarWidget-space\"></span>' +\r\n                // times block\r\n                '<span class = \"CalendarWidget-timeicon\"><img src=\"img/time-icon-01.svg\"></img></span>' +\r\n                '<span class = \"CalendarWidget-inputCell CalendarWidget-inputCell-inputTimeBegin\"><input class = \"CalendarWidget-timeInput CalendarWidget-timeBegin\" value={{hourBegin}} ></span>' +\r\n                '<span class = \"CalendarWidget-inputCell CalendarWidget-inputCell-inputMiddle CalendarWidget-inputCell-inputTimeMiddle\">-</span>' +\r\n                '<span class = \"CalendarWidget-inputCell CalendarWidget-inputCell-inputTimeEnd\"><input class = \"CalendarWidget-timeInput CalendarWidget-timeEnd\" value={{hourEnd}}></span>' +\r\n            '</div>' +\r\n        '</div>';\r\n\r\n/** Параметры календаря\r\n * @typedef nsGmx.CalendarWidget~Parameters\r\n * @property {nsGmx.DateInterval} dateInterval Временной интервал, который нужно менять\r\n * @property {Date} [dateMin] минимальная граничная дата для календарей, null - без ограничений\r\n * @property {Date} [dateMax] максимальная граничная дата для календарей, null - без ограничений\r\n * @property {String} [dateFormat='dd.mm.yy'] формат даты\r\n * @property {bool} [minimized=true] показывать ли минимизированный или развёрнутый виджет в начале\r\n * @property {bool} [showSwitcher=true] показывать ли иконку для разворачивания/сворачивания периода\r\n * @property {Date} [dateBegin=<текущая дата>] начальная дата интервала\r\n * @property {Date} [dateEnd=<текущая дата>] конечная дата интервала\r\n * @property {String|DOMNode} [container] куда добавлять календарик\r\n * @property {String} [buttonImage] URL иконки для активации календариков\r\n */\r\n\r\n/** Контрол для задания диапазона дат. Даты календарика всегда в UTC, а не в текущем поясе.\r\n @description Виджет для выбора интервала дат. Пользователь при помощи datepicker'ов выбирает два дня (год, месяц, число),\r\n              затем выбранные значения при помощи ф-ции `_updateModel()` переводятся в интервал дат ({@link nsGmx.DateInterval}).\r\n              Так же виджет реагирует на изменения модели (с использованием ф-ции `_updateWidget()`)\r\n @alias nsGmx.CalendarWidget\r\n @extends nsGmx.GmxWidget\r\n @class\r\n @param {nsGmx.CalendarWidget~Parameters} options Параметры календаря\r\n*/\r\n\r\nvar CalendarModel = window.Backbone.Model.extend({\r\n    defaults: {\r\n        dailyFilter: true\r\n    }\r\n});\r\nvar Calendar1 = window.Backbone.View.extend({\r\n    tagName: 'div',\r\n    model: new CalendarModel(),\r\n    className: 'CalendarWidget ui-widget',\r\n    template: Handlebars.compile(template),\r\n    events: {\r\n        'click .CalendarWidget-dates-outside .CalendarWidget-inputCell': function (e) {\r\n            e.stopPropagation();\r\n            this.showCalendar(e);\r\n            $(e.target).focus();\r\n        },\r\n        'keydown .CalendarWidget-dateBegin': function (e) {\r\n            this.manuallyChangeDateInterval(e, 'begin');\r\n        },\r\n        'keydown .CalendarWidget-dateEnd': function (e) {\r\n            this.manuallyChangeDateInterval(e, 'end');\r\n        },\r\n        'click .CalendarWidget-iconScrollLeft': function () {\r\n            this._shiftDates(-1);\r\n        },\r\n        'click .CalendarWidget-iconScrollRight': function () {\r\n            this._shiftDates(1);\r\n        },\r\n        'keydown .CalendarWidget-inputCell-inputTimeBegin': function (e) {\r\n            this.jumpByArrow(e, 'left');\r\n        },\r\n        'keydown .CalendarWidget-inputCell-inputTimeEnd': function (e) {\r\n            this.jumpByArrow(e, 'right');\r\n        }\r\n    },\r\n\r\n    initialize: function(options) {\r\n        var _this = this;\r\n        options = $.extend({\r\n            minimized: true,\r\n            showSwitcher: true,\r\n            dateMax: null,\r\n            dateMin: null,\r\n            dateFormat: 'dd.mm.yy',\r\n            name: null\r\n        }, options);\r\n\r\n        this._dateMin = options.dateMin;\r\n        this._dateMax = options.dateMax;\r\n        this._dateInterval = options.dateInterval;\r\n        this._opened = false;\r\n\r\n        $.datepicker.setDefaults({\r\n\r\n            onSelect: function(dateText, inst){\r\n                this._selectFunc(inst.input);\r\n            }.bind(this),\r\n            minDate: this._dateMin ? Calendar1.toUTC(this._dateMin) : null,\r\n            maxDate: this._dateMax ? Calendar1.toUTC(this._dateMax) : null,\r\n            changeMonth: true,\r\n            changeYear: true,\r\n            dateFormat: 'dd.mm.yy',\r\n            defaultDate: Calendar1.toUTC(this._dateMax || new Date()),\r\n            buttonImageOnly: true,\r\n            constrainInput: true\r\n        });\r\n\r\n        this.calendarTemplates = {\r\n            beginTemplate: Handlebars.compile('' +\r\n                '<div class=\"outside-calendar-container\">' +\r\n                    '<div class=\"begin-outside-calendar\">' +\r\n                    '</div>' +\r\n                    '<div class=\"time-container begin-time-container\">' +\r\n                    '</div>' +\r\n                    '<div class=\"time-placeholder begin-time-placeholder\" hidden>' +\r\n                    '</div>' +\r\n                        '<span class=\"calendar-button createdateinterval-button\">' +\r\n                        '{{i \"CalendarWidget.createDateInterval\"}}'+\r\n                        '</span>' +\r\n                        '<span class=\"calendar-button resetdateinterval-button\" hidden>' +\r\n                            '{{i \"CalendarWidget.resetDateInterval\"}}'+\r\n                        '</span>' +\r\n                '</div>'\r\n            ),\r\n            endTemplate: Handlebars.compile('' +\r\n                '<div class=\"outside-calendar-container\">' +\r\n                    '<div class=\"end-outside-calendar\">' +\r\n                    '</div>' +\r\n                    '<div class=\"time-container end-time-container\">' +\r\n                    '</div>' +\r\n                    '<div class=\"time-placeholder end-time-placeholder\" hidden>' +\r\n                    '</div>' +\r\n                    '<span class=\"calendar-button selectdateinterval-button disabled\">' +\r\n                        '{{i \"CalendarWidget.selectDateInterval\"}}'+\r\n                    '</span>' +\r\n                '</div>'\r\n            )\r\n        };\r\n\r\n        var dateBegin = this._dateInterval.get('dateBegin'),\r\n            dateEnd = this._dateInterval.get('dateEnd'),\r\n            hourBegin = Calendar1.getTime(dateBegin, 'begin'),\r\n            hourEnd = Calendar1.getTime(dateEnd, 'end');\r\n\r\n        this.$el.html(this.template({\r\n            showCalendarIconClass:'icon-calendar-empty',\r\n            showCalendarIconTitle: _gtxt('CalendarWidget.ShowIconTitle'),\r\n            hourBegin: hourBegin,\r\n            hourEnd: hourEnd\r\n        }));\r\n\r\n        // если есть контейнер, куда прикреплять виджет календаря\r\n        if (options.container) {\r\n            if (typeof options.container === 'string')\r\n                $('#' + options.container).append(this.$el);\r\n            else\r\n                $(options.container).append(this.$el);\r\n        }\r\n\r\n        this._updateWidget();\r\n\r\n        this._dateInterval.on('change', this._updateWidget, this);\r\n        this.listenTo(this.model, 'change:dailyFilter', this.enableDailyFilter);\r\n\r\n        $('#leftMenu').on('click', function (e) {\r\n            if (e.target.className !== 'CalendarWidget-show-calendar-icon icon-calendar-empty' &&\r\n                e.target.className !== 'layers-before' &&\r\n                !(e.target.className instanceof SVGAnimatedString) &&\r\n                e.target.className.indexOf('CalendarWidget-timeInput') === -1 &&\r\n                e.target.className !== 'calendar-container'\r\n            ) {\r\n                $(\".calendar-outside .ui-dialog-titlebar-close\").trigger('click');\r\n                _this._opened = false;\r\n            }\r\n        })\r\n\r\n        this.$('.CalendarWidget-timeInput').on('blur', this._selectTime.bind(this));\r\n\r\n        //for backward compatibility\r\n        this.canvas = this.$el;\r\n    },\r\n\r\n    manuallyChangeDateInterval: function (e, type) {\r\n        if (e.keyCode !== 13) return;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        var value = $(e.target).val(),\r\n            beginInput = this.$('.CalendarWidget-dateBegin')[0],\r\n            endInput = this.$('.CalendarWidget-dateEnd')[0],\r\n            dayms = nsGmx.DateInterval.MS_IN_DAY,\r\n            dateBegin = this._dateInterval.get('dateBegin'),\r\n            dateEnd = this._dateInterval.get('dateEnd'),\r\n            // endMidnight = (dateEnd.valueOf() === toMidnight(dateEnd).valueOf()),\r\n            oneDayPeriod, parsed;\r\n\r\n        try {\r\n            parsed = $.datepicker.parseDate('dd.mm.yy', value);\r\n        } catch (e) {\r\n            return;\r\n        }\r\n\r\n        // handle errors and too large values\r\n        if (!parsed || parsed < this._dateMin || parsed > this._dateMax) { return; }\r\n\r\n        parsed = nsGmx.CalendarWidget1.fromUTC(parsed);\r\n\r\n        oneDayPeriod = (parsed.valueOf() === dateBegin.valueOf());\r\n        oneDayPeriod ? this.setMode(Calendar1.SIMPLE_MODE) : this.setMode(Calendar1.ADVANCED_MODE);\r\n\r\n        if (type === 'begin') {\r\n            this._dateBegin.datepicker('setDate', parsed);\r\n            if (parsed > new Date(dateEnd.valueOf() - dayms)) {\r\n                this._dateEnd.datepicker('setDate', parsed);\r\n                $(endInput).val(e.target.value);\r\n                this._selectFunc(endInput);\r\n            }\r\n            this._dateInterval.set({\r\n                dateBegin: new Date(parsed.valueOf()),\r\n                dateEnd: new Date(parsed.valueOf() + dayms)\r\n            });\r\n        } else {\r\n            this._dateEnd.datepicker('setDate', parsed);\r\n            if (parsed < dateBegin) {\r\n                this._dateBegin.datepicker('setDate', parsed);\r\n                $(beginInput).val(e.target.value);\r\n                this._selectFunc(beginInput);\r\n                this._dateInterval.set({\r\n                    dateBegin: new Date(parsed.valueOf()),\r\n                    dateEnd: new Date(parsed.valueOf() + dayms)\r\n                });\r\n            } else if (parsed > dateBegin) {\r\n                this._dateInterval.set({\r\n                    dateEnd: new Date(parsed.valueOf() + dayms)\r\n                });\r\n            }\r\n        }\r\n\r\n        this._selectFunc(e.target);\r\n        this.showCalendar(e);\r\n    },\r\n\r\n    enableDailyFilter: function () {\r\n        var dailyFilter = this.model.get('dailyFilter'),\r\n            timeBeginValue = this.$('.CalendarWidget-timeBegin').val(),\r\n            timeEndValue = this.$('.CalendarWidget-timeEnd').val();\r\n\r\n        if (dailyFilter) {\r\n            if (Number(timeBeginValue) >= Number(timeEndValue)) {\r\n                this.$('.CalendarWidget-timeBegin').addClass('error');\r\n                this.$('.CalendarWidget-inputCell-inputTimeMiddle').addClass('error');\r\n                this.$('.CalendarWidget-timeEnd').addClass('error');\r\n            } else {\r\n                this.$('.CalendarWidget-timeBegin').removeClass('error');\r\n                this.$('.CalendarWidget-inputCell-inputTimeMiddle').removeClass('error');\r\n                this.$('.CalendarWidget-timeEnd').removeClass('error');\r\n            }\r\n        } else {\r\n            this.$('.CalendarWidget-timeBegin').removeClass('error');\r\n            this.$('.CalendarWidget-inputCell-inputTimeMiddle').removeClass('error');\r\n            this.$('.CalendarWidget-timeEnd').removeClass('error');\r\n        }\r\n        this.$('.CalendarWidget-timeBegin').trigger('blur');\r\n        this.$('.CalendarWidget-timeEnd').trigger('blur');\r\n    },\r\n\r\n    _selectTime: function (e) {\r\n        var match = this._checkValue(e.target.value);\r\n\r\n        if (!match) {\r\n            this.$('.CalendarWidget-timeBegin').addClass('error');\r\n            this.$('.CalendarWidget-inputCell-inputTimeMiddle').addClass('error');\r\n            this.$('.CalendarWidget-timeEnd').addClass('error');\r\n            return;\r\n        }\r\n\r\n        // $(e.target).removeClass('error');\r\n\r\n        // var isBegin = $(e.target).hasClass('CalendarWidget-timeBegin'),\r\n        //     dayms = nsGmx.DateInterval.MS_IN_DAY,\r\n        var dailyFilter = this.model.get('dailyFilter'),\r\n            timeBeginValue = this.$('.CalendarWidget-timeBegin').val(),\r\n            timeEndValue = this.$('.CalendarWidget-timeEnd').val(),\r\n            msBeginInputValue = Calendar1.convertTimeValueToMs(timeBeginValue),\r\n            msEndInputValue = Calendar1.convertTimeValueToMs(timeEndValue),\r\n            dateBegin = this._dateInterval.get('dateBegin'),\r\n            dateEnd = this._dateInterval.get('dateEnd'),\r\n            hourBegin = Calendar1.getTime(dateBegin, 'begin'),\r\n            hourEnd = Calendar1.getTime(dateEnd, 'end'),\r\n            msBegin = Calendar1.convertTimeValueToMs(hourBegin),\r\n            msEnd = Calendar1.convertTimeValueToMs(hourEnd),\r\n            newDateBegin = new Date(dateBegin.valueOf() + (msBeginInputValue - msBegin)),\r\n            newDateEnd = new Date(dateEnd.valueOf() + (msEndInputValue - msEnd));\r\n\r\n            if (dailyFilter && Number(timeBeginValue) >= Number(timeEndValue)) {\r\n                this.$('.CalendarWidget-timeBegin').addClass('error');\r\n                this.$('.CalendarWidget-inputCell-inputTimeMiddle').addClass('error');\r\n                this.$('.CalendarWidget-timeEnd').addClass('error');\r\n                return;\r\n            }\r\n\r\n            if (newDateBegin.valueOf() >= newDateEnd.valueOf()) {\r\n                this.$('.CalendarWidget-timeBegin').addClass('error');\r\n                this.$('.CalendarWidget-inputCell-inputTimeMiddle').addClass('error');\r\n                this.$('.CalendarWidget-timeEnd').addClass('error');\r\n                return;\r\n            } else {\r\n                this.$('.CalendarWidget-timeBegin').removeClass('error');\r\n                this.$('.CalendarWidget-inputCell-inputTimeMiddle').removeClass('error');\r\n                this.$('.CalendarWidget-timeEnd').removeClass('error');\r\n            }\r\n\r\n        this._dateInterval.set({\r\n            dateBegin: newDateBegin,\r\n            dateEnd: newDateEnd\r\n        });\r\n    },\r\n\r\n    _checkValue: function (value) {\r\n        var hours = [\r\n                '00', '01', '02', '03', '04', '05', '06', '07', '08', '09',\r\n                '10', '11', '12', '13', '14', '15', '16', '17', '18', '19',\r\n                '20', '21', '22', '23', '24'\r\n             ],\r\n             match = false;\r\n\r\n        for (var i = 0; i < hours.length; i++) {\r\n            if (value === hours[i]) {\r\n                match = true;\r\n            }\r\n        }\r\n\r\n        return match;\r\n    },\r\n\r\n    showCalendar: function () {\r\n        var _this = this,\r\n            // beginInput = this.$('.CalendarWidget-dateBegin')[0],\r\n            // endInput = this.$('.CalendarWidget-dateEnd')[0],\r\n            dateBegin = this._dateInterval.get('dateBegin'),\r\n            dateEnd = this._dateInterval.get('dateEnd'),\r\n            dayms = nsGmx.DateInterval.MS_IN_DAY,\r\n            oneDayPeriod = (dateEnd.valueOf() - dateBegin.valueOf() === dayms),\r\n            endMidnight = (dateEnd.valueOf() === toMidnight(dateEnd).valueOf());\r\n\r\n        this.beginCalendar = $(this.calendarTemplates.beginTemplate({oneDayPeriod: oneDayPeriod}));\r\n        this.endCalendar = $(this.calendarTemplates.endTemplate({}));\r\n\r\n        var createIntervalButton = $('.createdateinterval-button', this.beginCalendar),\r\n            resetIntervalButton = $('.resetdateinterval-button', this.beginCalendar),\r\n            selectIntervalButton = $('.selectdateinterval-button', this.endCalendar),\r\n            beginDialogOptions = {\r\n                dialogClass: \"calendar-outside begin-calendar\",\r\n                draggable: false,\r\n                resizable: false,\r\n                width: 224.8,\r\n                height: 280,\r\n                position: [372, 105],\r\n                resizeFunc: function () {\r\n                    return false;\r\n                },\r\n                closeFunc: function () {\r\n                    _this._dateBegin.datepicker(\"destroy\");\r\n                },\r\n            },\r\n            endDialogOptions = {\r\n                dialogClass: \"calendar-outside end-calendar\",\r\n                draggable: false,\r\n                resizable: false,\r\n                width: 224.8,\r\n                height: 280,\r\n                position: [610, 105],\r\n                resizeFunc: function () {\r\n                    return false;\r\n                },\r\n                closeFunc: function () {\r\n                    _this._dateEnd.datepicker(\"destroy\");\r\n                }\r\n            };\r\n\r\n        if (this._opened) {\r\n            $(\".calendar-outside .ui-dialog-titlebar-close\").trigger('click');\r\n            this._opened = false;\r\n        }\r\n\r\n        oneDayPeriod ? this.setMode(Calendar1.SIMPLE_MODE) : this.setMode(Calendar1.ADVANCED_MODE);\r\n\r\n        this._dateBegin = $('.begin-outside-calendar', this.beginCalendar);\r\n        this._dateEnd = $('.end-outside-calendar', this.endCalendar);\r\n\r\n        this._dateInputs = this._dateBegin.add(this._dateEnd);\r\n\r\n        this._dateInputs.datepicker();\r\n\r\n        this._dateInputs.datepicker('option', 'minDate', Calendar1.toUTC(this._dateMin));\r\n        this._dateInputs.datepicker('option', 'maxDate', Calendar1.toUTC(this._dateMax));\r\n\r\n        this._dateBegin.datepicker('setDate', Calendar1.toUTC(dateBegin));\r\n        this._dateEnd.datepicker('setDate', oneDayPeriod || endMidnight ? Calendar1.toUTC(new Date(dateEnd.valueOf() - dayms)) : Calendar1.toUTC(dateEnd));\r\n\r\n        $(this.beginCalendar).dialog(beginDialogOptions);\r\n        this._opened = true;\r\n\r\n        if (this.getMode() === Calendar1.ADVANCED_MODE) {\r\n            $(createIntervalButton).toggle(false);\r\n            $(resetIntervalButton).toggle(true);\r\n            $(this.endCalendar).dialog(endDialogOptions);\r\n            this._opened = true;\r\n        }\r\n\r\n        // кнопки в первом календаре\r\n        $(createIntervalButton).on('click', function () {\r\n            // var begin = _this._dateInterval.get('dateBegin'),\r\n            //     end = _this._dateInterval.get('dateEnd');\r\n\r\n            _this.setMode(Calendar1.ADVANCED_MODE);\r\n            $(_this.endCalendar).dialog(endDialogOptions);\r\n            _this._opened = true;\r\n\r\n            $(this).toggle(false);\r\n            $(resetIntervalButton).toggle(true);\r\n        })\r\n\r\n        $(resetIntervalButton).on('click', function () {\r\n            var dateBegin = toMidnight(_this._dateInterval.get('dateBegin'));\r\n            _this.setMode(Calendar1.SIMPLE_MODE);\r\n            _this._dateBegin.datepicker('setDate', Calendar1.toUTC(dateBegin));\r\n            _this._dateEnd.datepicker('setDate', Calendar1.toUTC(dateBegin));\r\n            $(\".calendar-outside.end-calendar .ui-dialog-titlebar-close\").trigger('click');\r\n            _this._opened = false;\r\n\r\n            $(this).toggle(false);\r\n            $(createIntervalButton).toggle(true);\r\n            _this._dateInterval.set({\r\n                dateBegin: dateBegin,\r\n                dateEnd: new Date(dateBegin.valueOf() + dayms)\r\n            })\r\n        })\r\n\r\n        // кнопка во втором календаре\r\n        $(selectIntervalButton).on('click', function () {\r\n            _this._updateModel();\r\n            _this.setActive(true);\r\n            _this._enableCreateIntervalButton();\r\n            $(\".calendar-outside .ui-dialog-titlebar-close\").trigger('click');\r\n            _this._opened = false;\r\n        })\r\n    },\r\n\r\n    _enableCreateIntervalButton: function (e) {\r\n        // var dayms = nsGmx.DateInterval.MS_IN_DAY,\r\n        var selectIntervalButton = $('.selectdateinterval-button'),\r\n            dateBegin = this._dateInterval.get('dateBegin'),\r\n            dateEnd = this._dateInterval.get('dateEnd'),\r\n            beginTimeValue = Calendar1.convertTimeValueToMs(e && e.target === $('CalendarWidget-timeBegin', this)[0] ? $(e.target).val() : $('.CalendarWidget-timeBegin').val()),\r\n            endTimeValue = Calendar1.convertTimeValueToMs(e && e.target === $('CalendarWidget-timeEnd', this)[0] ? $(e.target).val() : $('.CalendarWidget-timeEnd').val()),\r\n            calendarDateBegin = this.getDateBegin(),\r\n            calendarDateEnd = this.getDateEnd(),\r\n            newDateBegin = new Date(calendarDateBegin.valueOf() + beginTimeValue),\r\n            newDateEnd = new Date(calendarDateEnd.valueOf() + endTimeValue);\r\n\r\n        // если даты в итоге не поменялись или вторая дата больше первой\r\n        if ((newDateBegin.valueOf() === dateBegin.valueOf() && newDateEnd.valueOf() === dateEnd.valueOf()) ||\r\n            newDateBegin.valueOf() >= newDateEnd.valueOf()) {\r\n                $(selectIntervalButton).addClass('disabled');\r\n        } else {\r\n            $(selectIntervalButton).removeClass('disabled');\r\n        }\r\n    },\r\n\r\n    _shiftDates: function(delta) {\r\n        var dateBegin = this._dateInterval.get('dateBegin'),\r\n            dateEnd = this._dateInterval.get('dateEnd'),\r\n            dayms = nsGmx.DateInterval.MS_IN_DAY,\r\n            dailyFilter = this.model.get('dailyFilter'),\r\n            shift;\r\n\r\n        if (!dateBegin || !dateEnd) {\r\n            return;\r\n        }\r\n\r\n        if (dailyFilter) {\r\n            var diff = (toMidnight(dateEnd) - toMidnight(dateBegin));\r\n            shift = diff ? diff * delta : dayms * delta;\r\n        } else {\r\n            shift = (dateEnd - dateBegin) * delta;\r\n        }\r\n\r\n        var newDateBegin = new Date(dateBegin.valueOf() + shift),\r\n            newDateEnd = new Date(dateEnd.valueOf() + shift);\r\n\r\n        if ((!this._dateMin || toMidnight(this._dateMin) <= toMidnight(newDateBegin)) &&\r\n            (!this._dateMax || toMidnight(this._dateMax) >= toMidnight(newDateEnd)))\r\n        {\r\n            this._dateInterval.set({\r\n                dateBegin: newDateBegin ? newDateBegin : null,\r\n                dateEnd: newDateEnd ? newDateEnd : null\r\n            });\r\n        }\r\n    },\r\n\r\n    _selectFunc: function(activeInput) {\r\n        var begin = this.getDateBegin(),\r\n            end = this.getDateEnd();\r\n            // dayms = nsGmx.DateInterval.MS_IN_DAY,\r\n            // selectIntervalButton = $('.selectdateinterval-button');\r\n\r\n        if (end && begin && begin > end) {\r\n            var dateToFix = activeInput[0] == this._dateEnd[0] ? this._dateBegin : this._dateEnd;\r\n\r\n            dateToFix.datepicker('setDate', $(activeInput[0]).datepicker('getDate'));\r\n        }\r\n        if (this._curMode === Calendar1.SIMPLE_MODE) {\r\n            if (!begin != !end || begin && begin.valueOf() !== end.valueOf()) {\r\n                this._dateEnd.datepicker('setDate', this._dateBegin.datepicker('getDate'));\r\n            }\r\n            this._dateInterval.set({\r\n                dateBegin: begin ? begin : null,\r\n                dateEnd: end ? new Date(begin.valueOf() + nsGmx.DateInterval.MS_IN_DAY) : null\r\n            });\r\n        } else if (this._curMode === Calendar1.ADVANCED_MODE) {\r\n            this._enableCreateIntervalButton();\r\n        }\r\n    },\r\n\r\n    _updateModel: function() {\r\n        // получаем значения с дейтпикеров и переводим их в локальное время\r\n        var dateBegin = this.getDateBegin(),\r\n            dateEnd = this.getDateEnd(),\r\n            // значение часов\r\n            beginTimeValue = Calendar1.convertTimeValueToMs($('.CalendarWidget-timeBegin').val()),\r\n            endTimeValue = Calendar1.convertTimeValueToMs($('.CalendarWidget-timeEnd').val());\r\n            //var  dayms = nsGmx.DateInterval.MS_IN_DAY;\r\n            // если второй день захвачен полностью\r\n            //var fullDay = endTimeValue === dayms;\r\n\r\n        // добавим время к часам (в локальном времени)\r\n        dateBegin = new Date(dateBegin.valueOf() + beginTimeValue);\r\n        dateEnd = new Date(dateEnd.valueOf() + endTimeValue);\r\n\r\n        this._dateInterval.set({\r\n            dateBegin: dateBegin ? dateBegin : null,\r\n            dateEnd: dateEnd ? dateEnd : null\r\n        });\r\n    },\r\n\r\n    _updateWidget: function() {\r\n        var dateBegin = this._dateInterval.get('dateBegin'),\r\n            dateEnd = this._dateInterval.get('dateEnd'),\r\n            hourBegin = Calendar1.getTime(dateBegin, 'begin'),\r\n            hourEnd = Calendar1.getTime(dateEnd, 'end'),\r\n            beginInput = this.$('.CalendarWidget-dateBegin')[0],\r\n            endInput = this.$('.CalendarWidget-dateEnd')[0],\r\n            timeBegin = this.$('.CalendarWidget-timeBegin')[0],\r\n            timeEnd = this.$('.CalendarWidget-timeEnd')[0],\r\n            dayms = nsGmx.DateInterval.MS_IN_DAY,\r\n            newDateEnd;\r\n\r\n        if (!dateBegin || !dateEnd) {\r\n            return;\r\n        }\r\n\r\n        var newDateBegin = Calendar1.toUTC(dateBegin);\r\n            newDateEnd = Calendar1.toUTC(new Date(dateEnd));\r\n\r\n        // если календарь показывает ровно один день,\r\n        // прибавляем 24 часа к первой дате, чтобы получить сутки\r\n        if (dateEnd.valueOf() === toMidnight(dateEnd).valueOf()) {\r\n            newDateEnd = Calendar1.toUTC(new Date(dateEnd - dayms));\r\n        }\r\n\r\n        $(beginInput).val(Calendar1.formatDate(newDateBegin));\r\n        $(endInput).val(Calendar1.formatDate(newDateEnd));\r\n\r\n        $(timeBegin).val(Calendar1.prefixTimeValue(hourBegin));\r\n        $(timeEnd).val(Calendar1.prefixTimeValue(hourEnd));\r\n\r\n        this.enableDailyFilter && this.enableDailyFilter();\r\n    },\r\n\r\n    setActive: function (value) {\r\n        var active = this.active;\r\n        if (value !== active) {\r\n            this.active = value;\r\n        }\r\n\r\n        if (this.active) {\r\n            this.$el.removeClass('gmx-disabled')\r\n        } else {\r\n            this.$el.addClass('gmx-disabled')\r\n        }\r\n    },\r\n\r\n    jumpByArrow: function (e, type) {\r\n        var target = type === 'left' ? this.$('.CalendarWidget-inputCell-inputTimeBegin').find('input') : this.$('.CalendarWidget-inputCell-inputTimeEnd').find('input'),\r\n            source = type === 'left' ? this.$('.CalendarWidget-inputCell-inputTimeEnd').find('input') : this.$('.CalendarWidget-inputCell-inputTimeBegin').find('input'),\r\n            sourceElem = $(source).get(0),\r\n            strEnd;\r\n\r\n        switch (type) {\r\n            case 'left':\r\n                if (e.key === 'ArrowRight' && e.target.value.length === e.target.selectionEnd) {\r\n                    $(target).blur();\r\n                    $(source).focus();\r\n\r\n                    strEnd = sourceElem.value.length || 0;\r\n\r\n                    setTimeout(function () {\r\n                        sourceElem.setSelectionRange(strEnd, strEnd);\r\n                    }, 0);\r\n                }\r\n                break;\r\n            case 'right':\r\n                if (e.key === 'ArrowLeft' && e.target.selectionStart === 0) {\r\n                    $(target).blur();\r\n                    $(source).focus();\r\n\r\n                    strEnd = sourceElem.value.length || 0;\r\n\r\n                    setTimeout(function () {\r\n                        sourceElem.setSelectionRange(strEnd, strEnd);\r\n                    }, 0);\r\n                }\r\n                break;\r\n            default: return;\r\n        }\r\n    },\r\n\r\n    //public interface\r\n\r\n    /** Закрыть все открытые datepicker'ы.\r\n     * @return {nsGmx.CalendarWidget} this\r\n     */\r\n    reset: function() {\r\n        this._dateInputs.datepicker('hide');\r\n        return this;\r\n    },\r\n\r\n    /** Сериализация состояния виджета\r\n     * @return {Object} Сериализованное состояние\r\n     */\r\n    saveState: function() {\r\n        return {\r\n            version: '1.1.0',\r\n            vismode: this.getMode()\r\n        }\r\n    },\r\n\r\n    /** Восстановить состояние виджета по сериализованным данным\r\n     * @param {Object} data Сериализованное состояние календарика\r\n     */\r\n    loadState: function( data ) {\r\n        this.setMode(data.vismode);\r\n    },\r\n\r\n    /** Получить начальную дату\r\n     * @return {Date} начальная дата\r\n     */\r\n    getDateBegin: function() {\r\n        return this._dateBegin ? Calendar1.fromUTC(this._dateBegin.datepicker('getDate')) : this.getDateInterval().get('dateBegin');\r\n    },\r\n\r\n    /** Получить конечную дату\r\n     * @return {Date} конечная дата\r\n     */\r\n    getDateEnd: function() {\r\n        return this._dateEnd ? Calendar1.fromUTC(this._dateEnd.datepicker('getDate')) : this.getDateInterval().get('dateEnd');\r\n    },\r\n\r\n    /** Получить верхнюю границу возможных дат периода\r\n     * @return {Date} верхняя граница возможных периодов\r\n     */\r\n    getDateMax: function() {\r\n        return this._dateMax;\r\n    },\r\n\r\n    /** Получить нижнуюю границу возможных дат периода\r\n     * @return {Date} нижняя граница возможных периодов\r\n     */\r\n    getDateMin: function() {\r\n        return this._dateMin;\r\n    },\r\n\r\n    /** Установить нижнуюю границу возможных дат периода\r\n     * @param {Date} dateMin нижняя граница возможных периодов\r\n     */\r\n    setDateMin: function(dateMin) {\r\n        this._dateMin = dateMin;\r\n        this._dateInputs.datepicker('option', 'minDate', dateMin ? Calendar1.toUTC(dateMin) : null);\r\n    },\r\n\r\n    /** Установить верхнюю границу возможных дат периода\r\n     * @param {Date} dateMax верхняя граница возможных периодов\r\n     */\r\n    setDateMax: function(dateMax) {\r\n        // var titleContainer = this.$('.CalendarWidget-forecast');\r\n\r\n        this._dateMax = dateMax;\r\n        if (dateMax) {\r\n            var utcDate = Calendar1.toUTC(dateMax);\r\n            if (this._dateInputs) {\r\n                this._dateInputs.datepicker('option', 'maxDate', utcDate);\r\n            }\r\n\r\n            if (dateMax > new Date()) {\r\n            //     $(titleContainer).attr('title', _gtxt('CalendarWidget.tooltip') + ' ' +\r\n            //     ('0' + dateMax.getDate()).slice(-2) + '-' +\r\n            //     ('0' + (dateMax.getMonth() + 1)).slice(-2) + '-' +\r\n            //     dateMax.getFullYear());\r\n            //     $(titleContainer).show();\r\n            // } else {\r\n            //     $(titleContainer).hide();\r\n            }\r\n\r\n        }\r\n        else if (this._dateInputs) {\r\n            this._dateInputs.datepicker('option', 'maxDate', null);\r\n        }\r\n        \r\n    },\r\n\r\n    setSwitcherVisibility: function(isVisible) {\r\n        this._showCalendarIcon && this._showCalendarIcon.toggle(isVisible);\r\n    },\r\n\r\n    getDateInterval: function() {\r\n        return this._dateInterval;\r\n    },\r\n\r\n    getMode: function() {\r\n        return this._curMode;\r\n    },\r\n\r\n    setMode: function(mode) {\r\n        if (this._curMode === mode) {\r\n            return this;\r\n        }\r\n\r\n        this._curMode = mode;\r\n    }\r\n\r\n}, {\r\n    /* static methods */\r\n\r\n    // date показывает в utc\r\n    // нужно вычесть отрицательную разницу\r\n    // utc 13:00\r\n    // 13:00 - (-3 часа) = 16:00\r\n    // locale 16:00\r\n    // return locale date\r\n    fromUTC: function(date) {\r\n        if (!date) return null;\r\n        var timeOffset = date.getTimezoneOffset()*60*1000;\r\n        return new Date(date.valueOf() - timeOffset);\r\n    },\r\n    toUTC: function(date) {\r\n        if (!date) return null;\r\n        var timeOffset = date.getTimezoneOffset()*60*1000;\r\n        return new Date(date.valueOf() + timeOffset);\r\n    },\r\n    formatDate: function(date) {\r\n        var d = new Date(date),\r\n        month = '' + (d.getMonth() + 1),\r\n        day = '' + d.getDate(),\r\n        year = d.getFullYear();\r\n\r\n        if (month.length < 2) month = '0' + month;\r\n        if (day.length < 2) day = '0' + day;\r\n\r\n        return [day, month, year].join('.');\r\n    },\r\n    convertTimeValueToMs: function (value) {\r\n        var ms = Number(value)*1000*3600;\r\n        return ms;\r\n    },\r\n    getTime: function (date, position) {\r\n        var dayms = nsGmx.DateInterval.MS_IN_DAY,\r\n            offset, hours;\r\n\r\n        if (position === 'begin') {\r\n            offset = date.valueOf() - toMidnight(date).valueOf();\r\n        } else if (date.valueOf() === toMidnight(date).valueOf()) {\r\n            offset = dayms;\r\n        } else {\r\n            offset = date.valueOf() - toMidnight(date).valueOf();\r\n        }        \r\n\r\n        hours = offset/(3600*1000);\r\n\r\n        return hours;\r\n    },\r\n\r\n    prefixTimeValue: function (value) {\r\n        value = Number(value);\r\n        return value < 10 ? '0' + value : String(value);\r\n    },\r\n    SIMPLE_MODE: 1,\r\n    ADVANCED_MODE: 2\r\n});\r\n\r\nnsGmx.CalendarWidget1 = Calendar1;\r\n\r\n})(jQuery);\r\n","// COMMON CalendarWidget\nimport nsGmx from '../nsGmx.js';\nimport '../translations.js';\nimport '../DateInterval/DateInterval.js';\nimport '../CalendarWidget/CalendarWidget.js';\nimport '../CalendarWidget-new/CalendarWidget.js';\nimport './CommonCalendarWidget.css';\n\n(function($){\n\n    nsGmx.Translations.addText(\"rus\", { CommonCalendarWidget: {\n        Timeline:    \"Таймлайн\",\n        select: \"Выберите мультивременной слой\",\n        sync: \"Единый интервал для слоев\",\n        daily: \"посуточно\",\n        on: \"Включить синхронизацию слоев\",\n        off: \"Выключить синхронизацию слоев\",\n        all: \"Интервал для всех слоев\"\n    }});\n\n    nsGmx.Translations.addText(\"eng\", { CommonCalendarWidget: {\n        Timeline:     \"Timeline\",\n        select: \"Select temporal layer\",\n        sync: \"Single date interval\",\n        daily: \"daily\",\n        on: \"Layers sync on\",\n        off: \"Layers sync off\",\n        all: \"Интервал для всех слоев\"\n    }});\n\n    var toMidnight = nsGmx.DateInterval.toMidnight,\n        dayms = nsGmx.DateInterval.MS_IN_DAY;\n\n    var calendarWidgetTemplate = '' +\n        '<div class=\"commoncalendar-container\">' +\n            '<div class=\"calendar-layers-container\">' +\n                '<div class=\"calendar-container\">' +\n                    '<div class=\"calendar-widget-container\"></div>' +\n                '</div>' +\n            '</div>' +\n            '<div class=\"sync-switch-container switch-container\">' +\n                '<label class=\"sync-switch switch\">' +\n                    '<input type=\"checkbox\"' +\n                    '{{#if synchronyzed}}checked{{/if}}' +\n                    '>' +\n                    '<div class=\"sync-switch-slider switch-slider round\"></div>' +\n                '</label>' +\n                '<span class=\"sync-switch-slider-description\">{{i \"CommonCalendarWidget.sync\"}}</span>' +\n                '<label class=\"daily-switch\">' +\n                    '<input type=\"checkbox\"' +\n                    '{{#if dailyFilter}}checked{{/if}}' +\n                    '>' +\n                    '{{i \"CommonCalendarWidget.daily\"}}' +\n                '</label>' +\n            '</div>' +\n            '<div class=\"unsync-layers-container\" style=\"display: none\">' +\n                '<select class=\"layersList\">' +\n                    '{{#each this.layers}}' +\n                    '<option value=\"{{this.layer}}\"' +\n                        '{{#if this.current}} selected=\"selected\"{{/if}}>' +\n                        '{{this.layer}}' +\n                    '</option>' +\n                    '{{/each}}' +\n                '</select>' +\n            '</div>' +\n        '</div>' ;\n\n    var CommonCalendarModel = Backbone.Model.extend({\n        defaults: {\n            active: true,\n            currentLayer: null,\n            calendar: null,\n            isAppended: false,\n            unbindedTemporalLayers: {},\n            dailyFiltersHash: {},\n            dailyFilter: true,\n            synchronyzed: true\n        }\n    });\n\n    var CommonCalendar = Backbone.View.extend({\n        tagName: 'div',\n        model: new CommonCalendarModel(),\n        className: 'CommonCalendarWidget ui-widget',\n        template: Handlebars.compile(calendarWidgetTemplate),\n        events: {\n            'change .sync-switch': 'toggleSync',\n            'change .daily-switch': 'toggleDailyFilter',\n            'change .layersList': 'changeCurrentLayer'\n        },\n        initialize: function () {\n            var _this = this;\n\n            this.$el.html(this.template({\n                synchronyzed: _this.model.get('synchronyzed'),\n                layers: _this.model.get('visibleTemporalLayers'),\n                dailyFilter: _this.model.get('dailyFilter')\n            }));\n\n            //for backward compatibility\n            this.canvas = this.$el;\n            this.dateInterval = new nsGmx.DateInterval();\n\n            this.listenTo(this.model, 'change:synchronyzed', this.updateSync);\n            this.listenTo(this.model, 'change:dailyFilter', (function () {\n                this.handleFiltersHash();\n                this.applyDailyFilter();\n            }).bind(this));\n\n            this.dateInterval.on('change', function () {\n                _this.updateVisibleTemporalLayers(nsGmx.gmxMap.layers);\n                if (_this.model.get('dailyFilter')) {\n                    _this.applyDailyFilter();\n                }\n            });\n\n            this._fillFiltersHash();\n        },\n\n        _fillFiltersHash: function(layers) {\n            layers = layers || nsGmx.gmxMap.layers;\n\n            var dailyFiltersHash = {};\n\n            for (var i = 0; i < layers.length; i++) {\n                var layer = layers[i],\n                    props = layer.getGmxProperties(),\n                    layerID = props.LayerID,\n                    isTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.getDateInterval);\n\n                if (isTemporalLayer) {\n                    dailyFiltersHash[layerID] = true;\n                }\n\n                this.model.set('dailyFiltersHash', dailyFiltersHash);\n            }\n        },\n\n        _clearFiltersHash: function (layers) {\n            layers = layers || nsGmx.gmxMap.layers;\n\n            var dailyFiltersHash = {};\n\n            for (var i = 0; i < layers.length; i++) {\n                var layer = layers[i],\n                    props = layer.getGmxProperties(),\n                    layerID = props.LayerID,\n                    isTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.getDateInterval);\n\n                if (isTemporalLayer) {\n                    dailyFiltersHash[layerID] = false;\n                }\n\n                this.model.set('dailyFiltersHash', dailyFiltersHash);\n            }\n        },\n\n        setDateInterval: function (dateBegin, dateEnd, layer) {\n            if (layer) {\n                this.setCurrentLayer(layer);\n            }\n\n            var oldBegin = this.dateInterval.get('dateBegin').valueOf(),\n                oldEnd = this.dateInterval.get('dateEnd').valueOf();\n\n            if (oldBegin === dateBegin.valueOf() && oldEnd === dateEnd.valueOf()) {\n                this.updateTemporalLayers();\n\n                this.updateVisibleTemporalLayers(nsGmx.gmxMap.layers);\n                if (this.model.get('dailyFilter')) {\n                    this.applyDailyFilter();\n                }\n                this.trigger('change:dateInterval');\n            } else {\n                this.dateInterval.set({\n                    dateBegin: dateBegin,\n                    dateEnd: dateEnd\n                });\n            }\n\n            if (this.dateInterval.get('dailyFilter')) {\n                this.applyDailyFilter();\n            }\n        },\n\n        setCurrentLayer: function (layer) {\n            var props = layer.getGmxProperties();\n\n            this.model.set('currentLayer', props.LayerID);\n        },\n\n        changeCurrentLayer: function (e) {\n            var _this = this,\n                layerID = e.target.value;\n\n            _this.model.set('currentLayer', layerID);\n        },\n\n        log: function () {\n            var f = function(list) {\n                var layers = nsGmx.gmxMap.layers;\n\n                for (var i = 0; i < layers.length; i++) {\n\t               var layer = layers[i],\n                        props = layer.getGmxProperties(),\n                        t = props.title,\n                        isTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.getDateInterval),\n                        int = layer.getDateInterval();\n\n                    if (isTemporalLayer && int) {\n                        var b = int.beginDate.toString(),\n                            e = int.endDate.toString();\n                        list.push({\n                            title: t,\n                            beginDate: b,\n                            endDate: e\n                        });\n                    }\n\t            }\n\t               console.table(list);\n            };\n            f([]);\n        },\n\n        getDateInterval: function () {\n            return this.dateInterval;\n        },\n\n        get: function() {\n            var attrs = this.model.toJSON(),\n                _this = this,\n                calendar;\n\n            if (!attrs.calendar) {\n                calendar = new nsGmx.CalendarWidget1({\n                    minimized: false,\n                    dateMin: new Date(2000, 1, 1),\n                    dateMax: new Date(Date.now() + dayms) > _this.dateInterval.get('dateEnd') ? new Date(Date.now() + dayms) : _this.dateInterval.get('dateEnd'),\n                    dateInterval: _this.dateInterval\n                });\n\n                this.dateInterval.on('change', this.updateTemporalLayers.bind(this, null));\n\n                this.model.set('calendar', calendar);\n            this.updateTemporalLayers();\n            }\n\n            return this.model.get('calendar');\n        },\n\n        replaceCalendarWidget: function(newCalendar) {\n            this._calendar = newCalendar;\n\n            //заменим виджет перед деревом слоёв\n            if (this._isAppended) {\n                var doChange = function() {\n                    var calendarDiv = $('<div class=\"commoncalendar-container\"></div>').append(newCalendar.canvas);\n                    // special for steppe project\n                    if (nsGmx.gmxMap.properties.MapID === '0786A7383DF74C3484C55AFC3580412D') {\n                        _queryMapLayers.getContainerAfter().find('.commoncalendar-container').replaceWith(calendarDiv);\n                    } else {\n                        _queryMapLayers.getContainerBefore().find('.commoncalendar-container').replaceWith(calendarDiv);\n                    }\n                }\n                //явная проверка, так как хочется быть максимально синхронными в этом методе\n                if (_queryMapLayers.loadDeferred.state() === 'resolved') {\n                    doChange();\n                } else {\n                    _queryMapLayers.loadDeferred.then(doChange);\n                }\n            }\n        },\n\n        show: function() {\n            var calendarDiv = this.$('.calendar-widget-container'),\n                calendarCanvas = this.get().canvas;\n\n            $(_queryMapLayers.getContainerBefore()).append(calendarCanvas[0]);\n\n            var doAdd = function() {\n                calendarDiv.append(calendarCanvas);\n\n                var commonCanvas = this.canvas;\n\n                // special for steppe Project\n                if (nsGmx.gmxMap.properties.MapID === '0786A7383DF74C3484C55AFC3580412D') {\n                    _queryMapLayers.getContainerAfter().append(commonCanvas);\n                } else {\n                    _queryMapLayers.getContainerBefore().append(commonCanvas);\n                }\n                this.model.set('isAppended', true);\n            }.bind(this);\n\n            if (!this.model.get('isAppended')) {\n                //явная проверка, так как хочется быть максимально синхронными в этом методе\n                if (_queryMapLayers.loadDeferred.state() === 'resolved') {\n                    doAdd();\n                } else {\n                    _queryMapLayers.loadDeferred.then(doAdd);\n                }\n            }\n\n            return this;\n        },\n\n        hide: function() {\n            var attrs = this.model.toJSON();\n            attrs._isAppended && $(this.get().canvas).hide();\n            this.model.set('isAppended', true);\n\n            return this;\n        },\n\n        bindLayer: function (layerName) {\n            var attrs = this.model.toJSON(),\n                unbindedTemporalLayers = attrs.unbindedTemporalLayers,\n                clone = {};\n\n            // clone object\n            for (var variable in unbindedTemporalLayers) {\n                if (unbindedTemporalLayers.hasOwnProperty(variable)) {\n                    clone[variable] = unbindedTemporalLayers[variable];\n                }\n            }\n\n            delete clone[layerName];\n\n            this.model.set('unbindedTemporalLayers', clone);\n            this.updateTemporalLayers();\n        },\n\n        unbindLayer: function (layerName) {\n            var attrs = this.model.toJSON(),\n                layer = nsGmx.gmxMap.layersByID[layerName];\n            if (!layer) {\n                return;\n            }\n            \n            var unbindedTemporalLayers = attrs.unbindedTemporalLayers,\n                clone = {};\n\n            layer.removeLayerFilter({ id: 'dailyFilter' });\n            // clone object\n            for (var variable in unbindedTemporalLayers) {\n                if (unbindedTemporalLayers.hasOwnProperty(variable)) {\n                    clone[variable] = unbindedTemporalLayers[variable];\n                }\n            }\n\n            clone[layerName] = true;\n            this.model.set('unbindedTemporalLayers', clone);\n            this.updateTemporalLayers([layer]);\n        },\n\n        _updateOneLayer: function(layer, dateBegin, dateEnd) {\n            var props = layer.getGmxProperties();\n            if (props.maxShownPeriod) {\n                var msecPeriod = props.maxShownPeriod*24*3600*1000;\n                var newDateBegin = new Date( Math.max(dateBegin.valueOf(), dateEnd.valueOf() - msecPeriod));\n                layer.setDateInterval(newDateBegin, dateEnd);\n            } else {\n                layer.setDateInterval(dateBegin, dateEnd);\n            }\n        },\n\n        updateTemporalLayers: function(layers) {\n            layers = layers || nsGmx.gmxMap.layers;\n\n            var attrs = this.model.toJSON(),\n                synchronyzed = attrs.synchronyzed,\n                dateBegin = this.dateInterval.get('dateBegin'),\n                dateEnd = this.dateInterval.get('dateEnd'),\n                currentLayer = attrs.currentLayer,\n                layersMaxDates = [],\n                maxDate = null,\n                localeDate;\n\n            if (!attrs.calendar) {return;}\n\n            if (synchronyzed) {\n                for (var i = 0, len = layers.length; i < len; i++) {\n                    var layer = layers[i],\n                    props = layer.getGmxProperties(),\n                    isTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.setDateInterval);\n\n                    if (isTemporalLayer && !(props.name in attrs.unbindedTemporalLayers)) {\n                        if (props.DateEnd) {\n                            if (typeof props.DateEnd === \"string\") {\n                                localeDate = $.datepicker.parseDate('dd.mm.yy', props.DateEnd);\n                            } else if (typeof props.DateEnd === \"number\") {\n                                localeDate = new Date(props.DateEnd);\n                            }\n\n                            layersMaxDates.push(localeDate);\n                        }\n\n                        this._updateOneLayer(layer, dateBegin, dateEnd);\n                    }\n                }\n            } else if (currentLayer && !(currentLayer in attrs.unbindedTemporalLayers)) {\n                currentLayer = nsGmx.gmxMap.layersByID[currentLayer];\n                this._updateOneLayer(currentLayer, dateBegin, dateEnd);\n            } else {\n                return;\n            }            \n\n            if (layersMaxDates.length > 0) {\n                layersMaxDates.sort(function(a, b) {\n                    return b - a;\n                });\n\n                maxDate = new Date(layersMaxDates[0]);\n\n                if (maxDate > attrs.calendar.getDateMax()) {\n                    attrs.calendar.setDateMax(nsGmx.CalendarWidget.fromUTC(new Date(maxDate.valueOf() + dayms)));\n                }\n\n                this.model.set('calendar', attrs.calendar);\n            }\n        },\n\n        onDateIntervalChanged: function (e) {\n            var attrs = this.model.toJSON(),\n                currentLayer = attrs.currentLayer,\n                layer = e.target,\n                props,                \n                dateInterval, dateBegin, dateEnd;\n\n            if (!currentLayer) {\n                return;\n            }\n\n            props = layer.getGmxProperties();\n            var layerID = props.LayerID;\n\n            if (layerID in attrs.unbindedTemporalLayers) {\n                return;\n            }\n\n            if (layerID === currentLayer) {\n                if (props.maxShownPeriod) { return; }\n                dateInterval = layer.getDateInterval();\n                dateBegin = dateInterval.beginDate;\n                dateEnd = dateInterval.endDate;\n\n                this.setDateInterval(dateBegin, dateEnd, layer);\n            }\n        },\n\n        updateVisibleTemporalLayers: function (layers) {\n            var _this = this,\n                attrs = this.model.toJSON(),\n                currentLayer = attrs.currentLayer,\n                layersList = this.$('.layersList'),\n                temporalLayers = [],                \n                str = '';\n\n            $.widget( \"ui.temporallayersmenu\", $.ui.selectmenu, {\n                _renderItem: function(ul, item) {\n                    var li = $( \"<li>\" );\n\n                    if ( item.value ) {\n                        var l = nsGmx.gmxMap.layersByID[item.value],\n                            props = l.getGmxProperties(),\n                            di = l.getDateInterval && l.getDateInterval(),\n                            dateBegin, dateEnd,\n                            hourBegin, hourEnd,\n                            newDateBegin, newDateEnd,\n                            str = '';\n\n                        if (di) {\n                            var now = new Date(),\n                                dateBeginToMidnight = new Date(now - now % dayms);\n\n                            // dateBegin = di.beginDate;\n                            // dateEnd = di.endDate);\n                            dateBegin = di.beginDate || dateBeginToMidnight;\n                            dateEnd = di.endDate || new Date(dateBeginToMidnight.valueOf() + dayms);\n                            hourBegin = nsGmx.CalendarWidget1.prefixTimeValue(nsGmx.CalendarWidget1.getTime(dateBegin, 'begin'));\n                            hourEnd = nsGmx.CalendarWidget1.prefixTimeValue(nsGmx.CalendarWidget1.getTime(dateEnd, 'end'));\n                            newDateBegin = nsGmx.CalendarWidget1.toUTC(dateBegin);\n                            newDateEnd = nsGmx.CalendarWidget1.toUTC(dateEnd);\n\n                            // если календарь показывает ровно один день,\n                            // прибавляем 24 часа к первой дате, чтобы получить сутки\n                            if (dateEnd.valueOf() === toMidnight(dateEnd).valueOf()) {\n                                newDateEnd = nsGmx.CalendarWidget1.toUTC(new Date(dateEnd - dayms));\n                            }\n\n                            str = '<span class=\\'layerslist-title\\'>' +  props.title + '</span>' + ' ' +\n                                  '<span class=\\'layerslist-dates-times\\'>' + nsGmx.CalendarWidget1.formatDate(newDateBegin) + ' - ' + nsGmx.CalendarWidget1.formatDate(newDateEnd) +\n                                  ' | ' + hourBegin + '-' + hourEnd + '</span>';\n\n                        }\n\n                        $(li).html(str);\n                        $(li).prop('layerID', item.value);\n\n                        return li.appendTo( ul );\n                    }\n                },\n                _renderMenu: function( ul, items ) {\n                    var that = this;\n                    $.each( items, function( index, item ) {\n                        that._renderItemData( ul, item );\n                    });\n                }\n            });\n\n            if ($(layersList).temporallayersmenu(\"instance\")) {\n                $(layersList).temporallayersmenu(\"destroy\");\n            }\n\n            for (let i = 0; i < layers.length; i++) {\n                let layer = layers[i];\n                if (layer.getGmxProperties) {\n                    let props = layer.getGmxProperties(),\n                        isVisible = props.visible,\n                        isTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.getDateInterval);\n\n                    if (isTemporalLayer && isVisible) {\n                        temporalLayers.push(layer);\n                    }\n                }\n            }\n\n            for (let i = 0; i < temporalLayers.length; i++) {\n                let layer = temporalLayers[i],\n                    props = layer.getGmxProperties(),\n                    layerID = props.LayerID;\n\n                str += '<option value=' + layerID + '>' + props.title + '</option>';\n            }\n\n            $(layersList).html(str);\n\n            if (currentLayer) {                \n\n                this.$('.layersList option').each(function () {\n                    if ($(this).val() === currentLayer) {\n                        $(this).prop(\"selected\", true);\n                    }\n                })\n\n            // установим текщим первый слой из списка\n            } else if (!currentLayer && temporalLayers.length) {\n                let props = temporalLayers[0].getGmxProperties(),\n                    layerID = props.LayerID;\n\n                this.$('.layersList option[value=\"' + layerID + '\"]').prop(\"selected\", true);\n            }\n\n            $(layersList).temporallayersmenu({\n                change: function (e) {\n                    let layerID = $(e.currentTarget).prop('layerID'),\n                        layer = nsGmx.gmxMap.layersByID[layerID],\n                        filters = layer._gmx.dataManager._filtersView,\n                        layerFilters = filters[layerID],\n                        dateBegin, dateEnd;\n\n                    var dateInterval = layer.getDateInterval();\n\n                    if (dateInterval.beginDate && dateInterval.endDate) {\n                        dateBegin = dateInterval.beginDate;\n                        dateEnd = dateInterval.endDate;\n                    } else {\n                        dateInterval = new nsGmx.DateInterval();\n                        dateBegin = dateInterval.get('dateBegin');\n                        dateEnd = dateInterval.get('dateEnd');\n                    }\n\n                    if (layerFilters) {\n                        if ('screen_dailyFilter' in layerFilters) {\n                            _this.$('.daily-switch input').prop(\"checked\", true);\n                        } else {\n                            _this.$('.daily-switch input').prop(\"checked\", false);\n                        }\n                    }\n\n                    _this.$('.layersList option[value=\"' + layerID + '\"]').prop(\"selected\", true);\n                    _this.setDateInterval(dateBegin, dateEnd, layer);\n\n                }\n            });\n        },\n\n        toggleSync: function () {\n            this.model.set('synchronyzed', !this.model.get('synchronyzed'));\n        },\n\n        setSyncMode: function (value) {\n            this.model.set('synchronyzed', Boolean(value));\n        },\n\n        updateSync: function () {\n            var _this = this,\n                layers = nsGmx.gmxMap.layers,\n                attrs = this.model.toJSON(),\n                synchronyzed = attrs.synchronyzed,\n                currentLayer = attrs.currentLayer,\n                listContainer = this.$('.unsync-layers-container'),                \n                dateBegin, dateEnd;\n\n            if (synchronyzed) {\n                dateBegin = _this.dateInterval.get('dateBegin');\n                dateEnd = _this.dateInterval.get('dateEnd');\n                _this.setDateInterval(dateBegin, dateEnd);\n                this.model.set('currentLayer', null);\n                this.model.set('currentLayer', null);\n                this.$('.sync-switch input').prop(\"checked\", true);\n                $(listContainer).hide();\n            }\n            else if (currentLayer) {\n                return;\n            } \n            else {\n                var temporalLayers = [];\n\n                this.$('.sync-switch input').prop(\"checked\", false);\n                $(listContainer).show();\n                this.updateVisibleTemporalLayers(layers);\n\n                for (let i = 0; i < layers.length; i++) {\n                    let layer = layers[i];\n                    if (layer.getGmxProperties) {\n                        let props = layer.getGmxProperties(),\n                        isVisible = props.visible,\n                        isTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.getDateInterval);\n\n                        if (isTemporalLayer && isVisible) {\n                            temporalLayers.push(layer);\n                        }\n                    }\n                }\n                if (!temporalLayers.length) {\n                    this.model.set('currentLayer', null);\n                } else {\n                    let props = temporalLayers[0].getGmxProperties(),\n                    layerID = props.LayerID;\n                    this.model.set('currentLayer', layerID);\n                }\n            }\n            \n        },\n\n        toggleDailyFilter: function () {\n            var attrs = this.model.toJSON(),\n                calendar = attrs.calendar;\n\n            calendar.model.set('dailyFilter', !this.model.get('dailyFilter'));\n            this.model.set('dailyFilter', !this.model.get('dailyFilter'));\n        },\n\n        setDailyFilter: function (active) {\n            var attrs = this.model.toJSON(),\n                calendar = attrs.calendar;\n\n            calendar.model.set('dailyFilter', active);\n            this.model.set('dailyFilter', active);\n        },\n\n        handleFiltersHash: function () {\n            var attrs = this.model.toJSON(),                \n                currentLayer = attrs.currentLayer,                \n                dailyFilter = attrs.dailyFilter,\n                dailyFiltersHash = attrs.dailyFiltersHash;\n\n            if (dailyFilter) {\n                if (currentLayer) {\n                    dailyFiltersHash[currentLayer] = true;\n                } else {\n                    this._fillFiltersHash();\n                }\n            } else if (currentLayer) {\n                dailyFiltersHash[currentLayer] = false;\n            } else {\n                this._clearFiltersHash();\n            }            \n        },\n\n        applyDailyFilter: function (layers) {\n            var temporalLayers = layers || nsGmx.gmxMap.layers,\n                _this = this,\n                attrs = this.model.toJSON(),\n                dailyFilter = attrs.dailyFilter,\n                dailyFiltersHash = attrs.dailyFiltersHash,\n                synchronyzed = attrs.synchronyzed,\n                currentLayer = attrs.currentLayer,\n                dateInterval = this.dateInterval,                \n                dateBegin = this.dateInterval.get('dateBegin'),\n                dateEnd = this.dateInterval.get('dateEnd'),\n                hourBegin = Number(nsGmx.CalendarWidget1.getTime(dateBegin, 'begin')) * 1000 * 3600,\n                hourEnd = Number(nsGmx.CalendarWidget1.getTime(dateEnd, 'end')) * 1000 * 3600;\n\n            if (synchronyzed) {\n                temporalLayers = nsGmx.gmxMap.layers;\n            }\n\n            if (!synchronyzed && !currentLayer) {\n                return;\n            }\n\n            for (let i = 0; i < temporalLayers.length; i++) {\n                let l = temporalLayers[i],\n                    p = l.getGmxProperties && l.getGmxProperties(),\n                    layerName;\n\n                if (!p) {\n                    continue;\n                }\n\n                layerName = p.name;\n\n                if (layerName in attrs.unbindedTemporalLayers) {\n                    continue;\n                }\n\n                (function (x) {\n                var layer = temporalLayers[x];\n\n                if (layer.getGmxProperties) {\n                        let props = layer.getGmxProperties(),\n                            isTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.getDateInterval);\n\n                        if (isTemporalLayer && layer.getDataManager) {\n\n                            if (layer.getGmxProperties().name === '509762F05B0044D8A7CCC9D3C2383365') {\n                                // debugger;\n                            }\n\n                            if (!synchronyzed && layer.getDateInterval()) {\n                                dateInterval = layer.getDateInterval();\n                                if (dateInterval.beginDate && dateInterval.endDate) {\n                                    dateBegin = dateInterval.beginDate;\n                                    dateEnd = dateInterval.endDate;\n                                    hourBegin = Number(nsGmx.CalendarWidget1.getTime(dateBegin, 'begin')) * 1000 * 3600;\n                                    hourEnd = Number(nsGmx.CalendarWidget1.getTime(dateEnd, 'end')) * 1000 * 3600;\n                                }\n                            }\n\n                            var dm = layer.getDataManager(),\n                                dmOpt = dm.options,\n                                fullDays,\n                                intervals = [],\n                                tmpKeyNum;\n\n                            if (dmOpt.Temporal) {\n                                tmpKeyNum = dm.tileAttributeIndexes[dmOpt.TemporalColumnName];\n                            }\n\n                            if (hourEnd < dayms) {\n                                fullDays = toMidnight(dateEnd).valueOf() - toMidnight(dateBegin).valueOf() + dayms;\n                            } else if (hourEnd === dayms) {\n                                fullDays = toMidnight(dateEnd).valueOf() - toMidnight(dateBegin).valueOf();\n                            }\n\n                            for (let i = 0; i < fullDays; i+= dayms) {\n                                intervals.push({\n                                    begin: toMidnight(dateBegin).valueOf() + hourBegin + i,\n                                    end: toMidnight(dateBegin).valueOf() + hourEnd + i\n                                });\n                            }\n\n                            if (dailyFilter && dailyFiltersHash[props.LayerID]) {\n                                layer.addLayerFilter(function (item) {\n                                    var itemDate = item.properties[tmpKeyNum] * 1000,\n                                        inside = false;\n                                    for (let j = 0; j < intervals.length; j++) {\n                                        if (intervals[j].begin <= itemDate && itemDate <= intervals[j].end) {\n                                            inside = true;\n                                            break;\n                                        }\n                                    }\n                                    //\n                                    // if (inside) {\n                                    //     console.log(layer.getGmxProperties().title + ' / ' + 'loaded');\n                                    // } else {\n                                    //     console.log(layer.getGmxProperties().title + ' / ' + 'filtered');\n                                    // }\n                                    return inside;\n                                }, {id: 'dailyFilter'});\n\n                                _this.$('.daily-switch input').prop(\"checked\", true);\n\n                            } else {\n                                layer.removeLayerFilter({id: 'dailyFilter'});\n                                _this.$('.daily-switch input').prop(\"checked\", false);\n                            }\n                        }\n                    }\n                }(i));\n            }\n        }\n    });\n\n    nsGmx.CommonCalendarWidget = CommonCalendar;\n\n})(jQuery);\n","import nsGmx from './nsGmx.js';\r\n\r\n/** \r\n* Контроллёр глобального буфера обмена\r\n* @memberOf nsGmx\r\n* @class Синглетон. Позволяет хранить массивы объектов разного типа. Тип объектов - строка. В рамках одного типа объекты упорядочены.\r\n*/\r\nnsGmx.ClipboardController = (function()\r\n{\r\n    var _clipboard = {};\r\n    return {\r\n        addItem: function(type, item)\r\n        {\r\n            _clipboard[type] = _clipboard[type] || [];\r\n            _clipboard[type].push(item);\r\n        },\r\n        \r\n        popItem: function(type)\r\n        {\r\n            if (typeof _clipboard[type] === 'undefined' || _clipboard[type].length == 0) return null;\r\n            return _clipboard[type].pop();\r\n        },\r\n        \r\n        //количество объектов данного типа\r\n        getCount: function(type)\r\n        {\r\n            if ( typeof _clipboard[type] === 'undefined' ) \r\n                return 0;\r\n            \r\n            return _clipboard[type].length;\r\n        },\r\n        \r\n        //получить объект типа type с индексом index. Если index < 0, то индексация с конца (-1 - последний элемент)\r\n        get: function(type, index)\r\n        {\r\n            if ( typeof _clipboard[type] === 'undefined' ) return null;\r\n            \r\n            if (index < 0) index += _clipboard[type].length;\r\n            \r\n            if (index < 0 || _clipboard[type].length <= index )\r\n                return null;\r\n                \r\n            return _clipboard[type][index];\r\n        }\r\n    }\r\n})();","﻿import nsGmx from './nsGmx.js';\r\nimport {\r\n    parseResponse,\r\n    sendCrossDomainJSONRequest,\r\n    sendCrossDomainPostRequest,\r\n} from './utilities.js';\r\n\r\nvar UPDATE_INTERVAL = 2000;\r\n\r\nvar sendGmxRequest = function(requestType, url, params) {\r\n    var def = $.Deferred();\r\n    \r\n    var processResponse = function(response) {\r\n        if (!response.Result || !response.Result.TaskID) {\r\n            if (response.Status === 'ok' && !response.ErrorInfo) {\r\n                def.resolve(response);\r\n            } else {\r\n                parseResponse(response);\r\n                def.reject(response);\r\n            }\r\n            return;\r\n        }\r\n        \r\n        def.notify(response.Result);\r\n        \r\n        var taskID = response.Result.TaskID;\r\n        \r\n        var interval = setInterval(function(){\r\n            sendCrossDomainJSONRequest(window.serverBase + \"AsyncTask.ashx?WrapStyle=func&TaskID=\" + taskID, \r\n                function(response)\r\n                {\r\n                    var res = response.Result;\r\n                    if (response.Status !== 'ok' || res.ErrorInfo)\r\n                    {\r\n                        res.Status = 'error';\r\n                        parseResponse(res);\r\n                        clearInterval(interval);\r\n                        def.reject(res);\r\n                    }\r\n                    else if (res.Completed)\r\n                    {\r\n                        clearInterval(interval);\r\n                        def.resolve(res);\r\n                    }\r\n                    else\r\n                    {\r\n                        def.notify(res);\r\n                    }\r\n                }, null, \r\n                function() {\r\n                    clearInterval(interval);\r\n                    def.reject();\r\n                }\r\n            );\r\n        }, UPDATE_INTERVAL);\r\n    }\r\n    \r\n    if (requestType === 'get') {\r\n    \r\n        params = params || {};\r\n    \r\n        var paramStrItems = [];\r\n        \r\n        for (var p in params) {\r\n            paramStrItems.push(p + '=' + encodeURIComponent(params[p]));\r\n        }\r\n        \r\n        var sepSym = url.indexOf('?') == -1 ? '?' : '&';\r\n        \r\n        \r\n        sendCrossDomainJSONRequest(\r\n            url + sepSym + paramStrItems.join('&'), \r\n            processResponse, null, def.reject.bind(def)\r\n        );\r\n    } else if (requestType === 'post') {\r\n        var localParams = $.extend({WrapStyle: 'message'}, params);\r\n        sendCrossDomainPostRequest(url, localParams, processResponse);\r\n    } else {\r\n        throw 'Wrong request type';\r\n    }\r\n    \r\n    return def.promise();\r\n};\r\n\r\nnsGmx.asyncTaskManager = {\r\n    sendGmxJSONPRequest: sendGmxRequest.bind(null, 'get'),\r\n    sendGmxPostRequest: sendGmxRequest.bind(null, 'post')\r\n};","import nsGmx from '../nsGmx.js';\r\n\r\nnsGmx.AttrTable = nsGmx.AttrTable || {};\r\n\r\nimport {DrawingObjectInfoRow} from '../drawingObjects.js';\r\n\r\n(function() {\r\n\r\n// events: queryChange, columnsChange\r\nvar DefaultSearchParamsManager = function() {\r\n    this._activeColumns = null;\r\n    this._queryTextarea = null; // textArea in search panel\r\n    this._searchValue = '';     // value of this._queryTextarea\r\n    this._valueTextarea = null; // upper textArea in update panel\r\n    this._setValue = '';        // value of this._queryTextarea\r\n    this._updateQueryTextarea = null; // lower textArea in update panel\r\n    this._setUpdateQueryValue = '';   // value of this._updateQueryTextarea\r\n    this._container = null;\r\n\r\n    /* SEARCH INSIDE POLYGON */\r\n    this._geometryInfoRow = null;\r\n};\r\n\r\nDefaultSearchParamsManager.prototype.drawSearchUI = function(container, attributesTable) {\r\n    var info = attributesTable.getLayerInfo(),\r\n        // paramsWidth = 320,\r\n        _this = this;\r\n\r\n    this._container = container;\r\n\r\n    /* HIDE BUTTON */\r\n    var hideButtonContainer = document.createElement('div'),\r\n        hideButton = nsGmx.Utils.makeLinkButton(_gtxt('Скрыть'));\r\n\r\n    $(hideButton).addClass('attr-table-hide-button');\r\n    $(hideButtonContainer).addClass('attr-table-hide-button-container');\r\n    $(hideButtonContainer).append(hideButton);\r\n\r\n    hideButton.onclick = function() {\r\n        var tableTd = container.nextSibling,\r\n            originalButton = $(tableTd).find('.attr-table-find-button');\r\n\r\n        if ($(originalButton).hasClass('gmx-disabled')) {\r\n            $(originalButton).removeClass('gmx-disabled');\r\n        }\r\n        container.style.display = 'none';\r\n        attributesTable.resizeFunc();\r\n    };\r\n\r\n    var middleContainer = document.createElement('div');\r\n    $(middleContainer).addClass('attr-table-middle-container');\r\n\r\n    /* SEARCH INSIDE POLYGON */\r\n\r\n    var geomUIContainer = this.drawGeomUI();\r\n\r\n    /*SQL TEXTAREA*/\r\n    this._queryTextarea = nsGmx.Utils._textarea(null, [['dir', 'className', 'inputStyle'], ['dir', 'className', 'attr-table-query-area'], ['css', 'overflow', 'auto'], ['css', 'width', '300px']]);\r\n    this._queryTextarea.placeholder = '\"field1\" = 1 AND \"field2\" = \\'value\\'';\r\n    this._queryTextarea.value = _this._searchValue;\r\n    this._queryTextarea.oninput = function(e) {_this._searchValue = e.target.value};\r\n\r\n    var attrNames = [info.identityField].concat(info.attributes, [window._gtxt('gmx_geometry')]);\r\n    var attrHash = {};\r\n    for (var a = 0; a < attrNames.length; a++) {\r\n        attrHash[attrNames[a]] = [];\r\n    }\r\n\r\n    var attrProvider = new nsGmx.LazyAttributeValuesProviderFromServer(attrHash, info.name);\r\n\r\n    var suggestionCallback = function () {\r\n        $(_this._queryTextarea).trigger('input');\r\n    }\r\n\r\n    var attrSuggestWidget = new nsGmx.AttrSuggestWidget([this._queryTextarea], attrNames, attrProvider, null, ['attrs', 'operators', 'functions']);\r\n\r\n    var suggestCanvas = attrSuggestWidget.el[0];\r\n\r\n    $(suggestCanvas).css('margin-right', '9px');\r\n\r\n    suggestionCallback = function () {\r\n        $(this.currentTextArea).trigger('input');\r\n    }\r\n\r\n    attrSuggestWidget.setCallback(suggestionCallback);\r\n\r\n    container.onclick = function(evt) {\r\n        if (evt.target === container) {\r\n            $(suggestCanvas).find('.suggest-helper').fadeOut(100);\r\n            return true;\r\n        }\r\n    };\r\n\r\n    /*CLEAN/SEARCH BUTTONS*/\r\n    var buttonsContainer = document.createElement('div'),\r\n        searchButton = nsGmx.Utils.makeLinkButton(_gtxt('Найти')),\r\n        cleanButton = nsGmx.Utils.makeLinkButton(_gtxt('Очистить'));\r\n\r\n    $(buttonsContainer).addClass('clean-search-buttons-container');\r\n    $(buttonsContainer).append(searchButton);\r\n\r\n    searchButton.onclick = function() {\r\n\r\n        $(_this).trigger('queryChange');\r\n    };\r\n\r\n    $(searchButton).addClass('search-button');\r\n    $(cleanButton).addClass('clean-button');\r\n\r\n    cleanButton.onclick = function() {\r\n        _this._queryTextarea.value = '';\r\n        _this._geometryInfoRow && _this._geometryInfoRow.RemoveRow();\r\n        _this._geometryInfoRow = null;\r\n        _this._searchValue = _this._queryTextarea.value;\r\n        $(_this).trigger('queryChange');\r\n    };\r\n\r\n    /*COMPILE*/\r\n    $(container).append(hideButtonContainer);\r\n    $(container).append(middleContainer);\r\n    nsGmx.Utils._(middleContainer, [nsGmx.Utils._div([nsGmx.Utils._span([nsGmx.Utils._t(_gtxt('WHERE'))], [['css', 'fontSize', '12px'], ['css', 'margin', '7px 0px 3px 1px']]), cleanButton, this._queryTextarea, suggestCanvas], [['dir', 'className', 'attr-query-container'], ['attr', 'filterTable', true]])]);\r\n    $(middleContainer).append(geomUIContainer);\r\n    $(container).append(buttonsContainer);\r\n};\r\n\r\nDefaultSearchParamsManager.prototype.drawUpdateUI = function(container, attributesTable) {\r\n    var info = attributesTable.getLayerInfo(),\r\n        // paramsWidth = 320,\r\n        _this = this;\r\n\r\n    this.currentColumnName = \"\";\r\n    this._container = container;\r\n\r\n    var geomUIContainer = this.drawGeomUI();\r\n\r\n    /* HIDE BUTTON */\r\n    var hideButtonContainer = document.createElement('div'),\r\n        hideButton = nsGmx.Utils.makeLinkButton(_gtxt('Скрыть'));\r\n\r\n    $(hideButton).addClass('attr-table-hide-button');\r\n    $(hideButtonContainer).addClass('attr-table-hide-button-container');\r\n    $(hideButtonContainer).append(hideButton);\r\n\r\n    hideButton.onclick = function() {\r\n        var tableTd = container.nextSibling,\r\n            originalButton = $(tableTd).find('.attr-table-find-button');\r\n\r\n        if ($(originalButton).hasClass('gmx-disabled')) {\r\n            $(originalButton).removeClass('gmx-disabled');\r\n        }\r\n        container.style.display = 'none';\r\n        attributesTable.resizeFunc();\r\n    };\r\n\r\n    var middleContainer = document.createElement('div');\r\n    $(middleContainer).addClass('attr-table-middle-container');\r\n\r\n    /* SELECT COLUMN */\r\n    var selectColumnContainer = document.createElement('div'),\r\n        attrsTemplate = Handlebars.compile('<select class=\"attrs-select selectStyle\">' +\r\n                            '{{#each this.attrs}}' +\r\n                                '<option value=\"{{this}}\">' +\r\n                                    '{{this}}' +\r\n                                '</option>' +\r\n                            '{{/each}}' +\r\n                        '</select>'),\r\n        attrsUI = $(attrsTemplate({\r\n            attrs: ['---' + window._gtxt(\"Выберите колонку\").toLowerCase() + '---'].concat(info.attributes)\r\n        }))[0];\r\n        hideButton = nsGmx.Utils.makeLinkButton(_gtxt('Скрыть'));\r\n\r\n    $(selectColumnContainer).append(window._gtxt(\"Обновить колонку\"));\r\n    $(selectColumnContainer).append(attrsUI);\r\n\r\n    attrsUI.onchange = function (e) {\r\n        _this.currentColumnName = e.target.value;\r\n    }\r\n\r\n    /* VALUE TEXTAREA */\r\n    this._valueTextarea = nsGmx.Utils._textarea(null, [['dir', 'className', 'inputStyle'], ['dir', 'className', 'attr-table-query-area'], ['css', 'overflow', 'auto'], ['css', 'margin-top', '3px'], ['css', 'width', '300px'], ['css', 'height', '80px']]);\r\n    this._valueTextarea.placeholder = '\"field1\" = 1 AND \"field2\" = \\'value\\'';\r\n    this._valueTextarea.value = _this._setValue;\r\n    this._valueTextarea.oninput = function(e) {_this._setValue = e.target.value};\r\n\r\n    /* UPDATE QUERY TEXTAREA */\r\n    this._updateQueryTextarea = nsGmx.Utils._textarea(null, [['dir', 'className', 'inputStyle'], ['dir', 'className', 'attr-table-query-area'], ['css', 'overflow', 'auto'], ['css', 'margin-top', '3px'], ['css', 'width', '300px'], ['css', 'height', '80px']]);\r\n    this._updateQueryTextarea.placeholder = '\"field1\" = 1 AND \"field2\" = \\'value\\'';\r\n    this._updateQueryTextarea.value = _this._setUpdateQueryValue;\r\n\r\n    this._updateQueryTextarea.oninput = function(e) {_this._setUpdateQueryValue = e.target.value};\r\n\r\n    var attrNames = [info.identityField].concat(info.attributes, [window._gtxt('gmx_geometry')]);\r\n    var attrHash = {};\r\n    for (var a = 0; a < attrNames.length; a++) {\r\n        attrHash[attrNames[a]] = [];\r\n    }\r\n\r\n    var attrProvider = new nsGmx.LazyAttributeValuesProviderFromServer(attrHash, info.name);\r\n\r\n    var attrSuggestWidget = new nsGmx.AttrSuggestWidget([this._valueTextarea, this._updateQueryTextarea], attrNames, attrProvider, null, ['attrs', 'operators', 'functions']);\r\n    var suggestCanvas = attrSuggestWidget.el[0];\r\n    $(suggestCanvas).css('margin-right', '9px');\r\n\r\n\r\n    var suggestionCallback = function () {\r\n        $(this.currentTextArea).trigger('input');\r\n    }\r\n\r\n    attrSuggestWidget.setCallback(suggestionCallback);\r\n\r\n    this._valueTextarea.onfocus = function(e) {attrSuggestWidget.setActiveTextArea(e.target)};\r\n    this._updateQueryTextarea.onfocus = function(e) {attrSuggestWidget.setActiveTextArea(e.target)};\r\n\r\n\r\n    container.onclick = function(evt) {\r\n        if (evt.target === container) {\r\n            $(suggestCanvas).find('.suggest-helper').fadeOut(100);\r\n            return true;\r\n        }\r\n    };\r\n\r\n    /*STATUS BAR*/\r\n\r\n    var statusBar = $(Handlebars.compile(\r\n        '<div class=\"column-update-spinholder\">' +\r\n            '<span class=\"spinHolder\" style=\"display:none\">' +\r\n                '<img src=\"img/progress.gif\"/>' +\r\n                '<span class=\"spinMessage\"></span>' +\r\n                '</span>' +\r\n            '<span class=\"spinErrorMessage\" style=\"display:none\"></span>' +\r\n        '</div>')({}))[0];\r\n\r\n    /*APPLY BUTTON*/\r\n    var applyButtonContainer = document.createElement('div'),\r\n        applyButton = nsGmx.Utils.makeLinkButton(_gtxt('Применить'));\r\n\r\n    $(applyButtonContainer).addClass('apply-button-container');\r\n    $(applyButtonContainer).append(applyButton);\r\n\r\n    applyButton.onclick = function() {\r\n\r\n        var spinHolder = $(statusBar).find('.spinHolder');\r\n        var spinErrorMessage = $(statusBar).find('.spinErrorMessage');\r\n\r\n        $(spinErrorMessage).hide();\r\n\r\n        if (!_this.currentColumnName || _this.currentColumnName === '---' + window._gtxt(\"Выберите колонку\").toLowerCase() + '---') {\r\n\r\n            $(spinErrorMessage).html(window._gtxt('Выберите колонку'));\r\n            $(spinErrorMessage).show();\r\n            return;\r\n        }\r\n\r\n        $(spinHolder).show();\r\n\r\n        var updateQuery = _this._valueTextarea && _this._valueTextarea.value ? _this._valueTextarea.value : '';\r\n        var whereQuery = _this._updateQueryTextarea && _this._updateQueryTextarea.value ? _this._updateQueryTextarea.value : '';\r\n\r\n        whereQuery = _this.addGeomQuery(whereQuery);\r\n\r\n        var url = window.serverBase + 'VectorLayer/QueryScalar?sql=' +\r\n            'UPDATE ' + '\"' + attributesTable.layerName + '\"' +\r\n            'SET ' +  '\"' + _this.currentColumnName + '\"' + '=' + updateQuery + (whereQuery ? ('WHERE ' + whereQuery) : \"\");\r\n\r\n        fetch(url, {\r\n             method: 'POST',\r\n             credentials: 'include',\r\n             mode: 'cors'\r\n          }).then(toJson)\r\n          .then(resCallback)\r\n          .catch(catchErr);\r\n\r\n         function toJson(res) {\r\n             return res.text();\r\n         }\r\n\r\n        function resCallback(res) {\r\n            var json;            \r\n\r\n            $(spinHolder).hide();\r\n            res = res.substring(1, res.length-1);\r\n            json = JSON.parse(res);            \r\n\r\n            if (json.Status === 'error') {\r\n                throw new Error(json.ErrorInfo.ErrorMessage);\r\n            }\r\n\r\n            $(attributesTable._serverDataProvider).change();\r\n        }\r\n\r\n        function catchErr() {\r\n            $(spinHolder).hide();\r\n            $(spinErrorMessage).html(window._gtxt('Ошибка'));\r\n            $(spinErrorMessage).show();\r\n        }\r\n    };\r\n\r\n    $(applyButton).addClass('apply-button');\r\n\r\n    /*COMPILE*/\r\n    $(container).append(hideButtonContainer);\r\n    $(container).append(middleContainer);\r\n    $(middleContainer).append(selectColumnContainer);\r\n    $(middleContainer).append(selectColumnContainer);\r\n    nsGmx.Utils._(middleContainer, [nsGmx.Utils._div([nsGmx.Utils._span([nsGmx.Utils._t(_gtxt('VALUE'))], [['css', 'fontSize', '12px'], ['css', 'margin', '4px 0px 3px 1px'], ['css', 'display', 'inline-block']]), this._valueTextarea], [['dir', 'className', 'attr-query-container'], ['attr', 'filterTable', true]])]);\r\n    nsGmx.Utils._(middleContainer, [nsGmx.Utils._div([nsGmx.Utils._span([nsGmx.Utils._t(_gtxt('WHERE'))], [['css', 'fontSize', '12px'], ['css', 'margin', '4px 0px 3px 1px'], ['css', 'display', 'inline-block']]), this._updateQueryTextarea, suggestCanvas], [['dir', 'className', 'attr-query-container'], ['attr', 'filterTable', true]])]);\r\n    $(middleContainer).append(geomUIContainer);\r\n    $(middleContainer).append(statusBar);\r\n    $(container).append(applyButtonContainer);\r\n}\r\n\r\nDefaultSearchParamsManager.prototype.getQuery = function() {\r\n    var query = this._queryTextarea && this._queryTextarea.value,\r\n        drawingObject = this._geometryInfoRow && this._geometryInfoRow.getDrawingObject(),\r\n        geom = drawingObject && drawingObject.toGeoJSON().geometry,\r\n        geomStr = geom ? 'intersects([geomixergeojson], GeometryFromGeoJson(\\'' + JSON.stringify(geom) + '\\', 4326))' : '',\r\n        resQuery = (query && geomStr) ? '(' + query + ') AND ' + geomStr : (query || geomStr);\r\n    return resQuery;\r\n};\r\n\r\nDefaultSearchParamsManager.prototype.addGeomQuery = function(query) {\r\n    var drawingObject = this._geometryInfoRow && this._geometryInfoRow.getDrawingObject(),\r\n        geom = drawingObject && drawingObject.toGeoJSON().geometry,\r\n        geomStr = geom ? 'intersects([geomixergeojson], GeometryFromGeoJson(\\'' + JSON.stringify(geom) + '\\', 4326))' : '',\r\n        resQuery = (query && geomStr) ? '(' + query + ') AND ' + geomStr : (query || geomStr);\r\n    return resQuery;\r\n};\r\n\r\nDefaultSearchParamsManager.prototype.drawGeomUI = function() {\r\n    var geomUIContainer = document.createElement('div');\r\n    var geomUI = $(Handlebars.compile('<span>' +\r\n        '<span class=\"attr-table-geomtitle\">{{i \"Искать по пересечению с объектом\"}}</span>' +\r\n        '<span class=\"gmx-icon-choose\"></span>' +\r\n        '<span class=\"attr-table-geom-placeholder\"></span>' +\r\n    '</span>')());\r\n\r\n    $(geomUIContainer).addClass('attr-table-geometry-container');\r\n    $(geomUIContainer).append(geomUI);\r\n\r\n    geomUI.find('.gmx-icon-choose').click(onGeometrySelectButtonClick);\r\n\r\n\r\n    var _this = this;\r\n\r\n    function onGeometrySelectButtonClick() {\r\n        nsGmx.Controls.chooseDrawingBorderDialog(\r\n            'attrTable',\r\n            function(drawingObject) {\r\n                _this._geometryInfoRow && _this._geometryInfoRow.RemoveRow();\r\n                var InfoRow = DrawingObjectInfoRow;\r\n                _this._geometryInfoRow = new InfoRow(\r\n                    nsGmx.leafletMap,\r\n                    geomUI.find('.attr-table-geom-placeholder')[0],\r\n                    drawingObject,\r\n                    {\r\n                        editStyle: false,\r\n                        allowDelete: true\r\n                    }\r\n                );\r\n\r\n                $(_this._geometryInfoRow).on('onRemove', function() {\r\n                    _this._geometryInfoRow && _this._geometryInfoRow.RemoveRow();\r\n                    _this._geometryInfoRow = null;\r\n                });\r\n            },\r\n            {geomType: null}\r\n        );\r\n    }\r\n\r\n    return geomUIContainer;\r\n}\r\n\r\nDefaultSearchParamsManager.prototype.getActiveColumns = function() {\r\n    return this._activeColumns;\r\n};\r\n\r\nDefaultSearchParamsManager.prototype.resize = function() {};\r\n\r\nnsGmx.AttrTable.DefaultSearchParamsManager = DefaultSearchParamsManager;\r\n\r\n})();","import nsGmx from '../nsGmx.js';\r\nimport {sendCrossDomainPostRequest} from '../utilities.js';\r\n\r\nnsGmx.AttrTable = nsGmx.AttrTable || {};\r\n\r\n(function() {\r\n\r\n/** Провайдер данных для {@link nsGmx.ScrollTable}. Получает данные от сервера в формате ГеоМиксера\r\n* @alias nsGmx.AttrTable.ServerDataProvider\r\n* @class\r\n* @extends nsGmx.ScrollTable.IDataProvider\r\n*/\r\nvar ServerDataProvider = function(params)\r\n{\r\n    var _params = $.extend({\r\n            defaultSortParam: 'ogc_fid',\r\n            titleToParams: {}\r\n        }, params);\r\n    var _countURL = null,\r\n        _dataURL = null,\r\n        _countParams = null,\r\n        _dataParams = null;\r\n\r\n    var _lastCountResult;\r\n\r\n    //IDataProvider interface\r\n    this.getCount = function(callback)\r\n    {\r\n        if (!_countURL)\r\n        {\r\n            callback();\r\n            return;\r\n        }\r\n\r\n        sendCrossDomainPostRequest(_countURL, _countParams, function(response)\r\n        {\r\n            if (!window.parseResponse(response))\r\n            {\r\n                callback();\r\n                return;\r\n            }\r\n            _lastCountResult = response.Result;\r\n            callback(response.Result);\r\n        });\r\n    };\r\n\r\n    this.getItems = function(page, pageSize, sortParam, sortDec, callback)\r\n    {\r\n        if (!_dataURL)\r\n        {\r\n            callback();\r\n            return;\r\n        }\r\n\r\n        var explicitSortParam = (sortParam || sortParam === '') ? (_params.titleToParams[sortParam] || sortParam) : _params.defaultSortParam;\r\n\r\n        var params = $.extend({\r\n            page: page,\r\n            pagesize: pageSize,\r\n            orderby: explicitSortParam,\r\n            orderdirection: sortDec ? 'DESC' : 'ASC'\r\n        }, _dataParams);\r\n\r\n        sendCrossDomainPostRequest(_dataURL, params, function(response)\r\n        {\r\n            if (!window.parseResponse(response))\r\n            {\r\n                callback();\r\n                return;\r\n            }\r\n\r\n            var fieldsSet = {};\r\n\r\n            if (response.Result.fields)\r\n            {\r\n                for (var f = 0; f < response.Result.fields.length; f++) {\r\n                    fieldsSet[response.Result.fields[f]] = {index: f, type: response.Result.types[f]};\r\n\t\t\t\t}\r\n            }\r\n\r\n            var res = [];\r\n            for (var i = 0; i < response.Result.values.length; i++) {\r\n                res.push({\r\n                    fields: fieldsSet,\r\n                    values: response.Result.values[i]\r\n                });\r\n\t\t\t}\r\n\r\n            callback(res);\r\n        });\r\n    };\r\n\r\n    /** Задать endpoint для получения от сервера данных об объекта и их количестве\r\n     * @param {String} countURL URL скрипта для запроса общего количества объектов\r\n     * @param {Object} countParams Параметры запроса для количеством объектов\r\n     * @param {String} dataURL URL скрипта для запроса самих объектов\r\n     * @param {Object} dataParams Параметры запроса самих объектов. К этим параметрам будут добавлены параметры для текущей страницы в формате запросов ГеоМиксера\r\n    */\r\n    this.setRequests = function(countURL, countParams, dataURL, dataParams)\r\n    {\r\n        _countURL = countURL;\r\n        _countParams = countParams || {};\r\n        _countParams.WrapStyle = 'message';\r\n\r\n        _dataURL = dataURL;\r\n        _dataParams = dataParams || {};\r\n        _dataParams.WrapStyle = 'message';\r\n\r\n        $(this).change();\r\n    };\r\n\r\n    this.serverChanged = function()\r\n    {\r\n        $(this).change();\r\n    };\r\n\r\n    this.getLastCountResult = function() {\r\n        return _lastCountResult;\r\n    };\r\n};\r\n\r\nnsGmx.AttrTable.ServerDataProvider = ServerDataProvider;\r\n\r\n})();\r\n","import nsGmx from '../nsGmx.js';\r\nimport {sendCrossDomainPostRequest} from '../utilities.js';\r\n\r\nnsGmx.AttrTable = nsGmx.AttrTable || {};\r\n\r\n(function() {\r\n\r\nvar template = Handlebars.compile('<div class=\"attrs-table-square-popover\">' +\r\n    '<div class=\"attrs-table-square-toomuch\">Слишком много объектов</div>' +\r\n    '<div class=\"attrs-table-square-process\">Подсчитываем...</div>' +\r\n    '<div class=\"attrs-table-square-result\">Площадь: ' +\r\n        '<span class=\"attrs-table-square\"></span>' +\r\n    '</div>' +\r\n'</div>');\r\n\r\nnsGmx.AttrTable.SquareCalc = function(container, layerName, dataProvider, searchParamsManager) {\r\n    var popoverUI = $(template());\r\n\r\n    popoverUI.find('.attrs-table-square-toomuch').hide();\r\n    popoverUI.find('.attrs-table-square-result').hide();\r\n\r\n    $(container).popover({\r\n        content: popoverUI[0],\r\n        placement: 'left',\r\n        html: true\r\n    });\r\n\r\n    $(container).on('shown.bs.popover', function() {\r\n        if (dataProvider.getLastCountResult() > 10000) {\r\n            popoverUI.find('.attrs-table-square-toomuch').show();\r\n            popoverUI.find('.attrs-table-square-process').hide();\r\n            popoverUI.find('.attrs-table-square-result').hide();\r\n            return;\r\n        } else {\r\n            popoverUI.find('.attrs-table-square-toomuch').hide();\r\n            popoverUI.find('.attrs-table-square-process').show();\r\n            popoverUI.find('.attrs-table-square-result').hide();\r\n        }\r\n\r\n        sendCrossDomainPostRequest(window.serverBase + 'VectorLayer/Search.ashx', {\r\n            layer: layerName,\r\n            query: searchParamsManager.getQuery(),\r\n            columns: '[{value: \"[GeomixerGeoJson]\"}]',\r\n            WrapStyle: 'message'\r\n        }, function(response) {\r\n            if (!window.parseResponse(response)) {\r\n                return;\r\n            }\r\n\r\n            popoverUI.find('.attrs-table-square-process').hide();\r\n            popoverUI.find('.attrs-table-square-result').show();\r\n\r\n            var items = response.Result.values;\r\n            var totalSquare = 0;\r\n            for (var g = 0; g < items.length; g++) {\r\n                totalSquare += L.gmxUtil.geoArea(items[g][0]);\r\n            }\r\n\r\n            popoverUI.find('.attrs-table-square').text(L.gmxUtil.prettifyArea(totalSquare));\r\n        });\r\n    });\r\n};\r\n\r\n})();","import nsGmx from '../nsGmx.js';\r\nimport {\r\n\tparseResponse,\r\n\tsendCrossDomainJSONRequest,\t\r\n} from '../utilities.js';\r\nimport './DefaultSearchParamsManager.js';\r\nimport './ServerDataProvider.js';\r\nimport './SquareCalculation.js';\r\nimport './AttrTable.css';\r\n\r\n(function() {\r\n\r\nnsGmx.AttrTable = nsGmx.AttrTable || {};\r\n\r\nvar attrsTable = function(layerName, layerTitle)\r\n{\r\n\tthis.layerName = layerName;\r\n\tthis.layerTitle = layerTitle || '';\r\n\r\n\tthis.filterData = null;\r\n\r\n\tthis.activeColumns = null;\r\n\r\n\tthis.resizeFunc = function() {};\r\n\r\n    this._updateVersionHandler = null;\r\n\r\n    this._isLayerOnMap = this.layerName in nsGmx.gmxMap.layersByID;\r\n\r\n    this.tableFields = {\r\n        fieldsAsArray: [],\r\n        fieldsAsHash: {},\r\n        titleToField: {},\r\n        init: function(fieldParams, info) {\r\n            var _this = this;\r\n            this.fieldsAsHash = {};\r\n            this.titleToField = {};\r\n            this.fieldsAsArray = [];\r\n            if (!fieldParams) {\r\n                this.fieldsAsArray = [info.identityField].concat(info.attributes);\r\n                this.fieldsAsArray.forEach(function(name) {\r\n                    _this.fieldsAsHash[name] = true;\r\n                    _this.titleToField[name] = name;\r\n                });\r\n            } else {\r\n                fieldParams.forEach(function(field) {\r\n                    _this.fieldsAsArray.push(field.title);\r\n                    _this.fieldsAsHash[field.title] = true;\r\n                    _this.titleToField[field.title] = field.name;\r\n                });\r\n            }\r\n        }\r\n    };\r\n};\r\n\r\nattrsTable.prototype.getLayerInfo = function()\r\n{\r\n    return this._layerInfo;\r\n};\r\n\r\nattrsTable.prototype.getInfo = function(origCanvas, outerSizeProvider, params)\r\n{\r\n\tif (!origCanvas && $('#attrsTableDialog' + this.layerName).length) {\r\n\t\treturn;\r\n\t}\r\n\r\n    origCanvas && $(origCanvas).empty();\r\n\r\n\tvar canvas = origCanvas || nsGmx.Utils._div(null, [['attr', 'id', 'attrsTableDialog' + this.layerName], ['css', 'overflow', 'hidden']]),\r\n\t\tloading = nsGmx.Utils._div([nsGmx.Utils._img(null, [['attr', 'src', 'img/progress.gif'], ['css', 'marginRight', '10px']]), nsGmx.Utils._t(_gtxt('загрузка...'))], [['css', 'margin', '3px 0px 3px 20px']]),\r\n\t\t_this = this;\r\n\r\n\tnsGmx.Utils._(canvas, [loading]);\r\n\r\n    if (!origCanvas)\r\n    {\r\n        outerSizeProvider = function() {\r\n            return {\r\n                width: canvas.parentNode.parentNode.offsetWidth,\r\n                height: canvas.parentNode.offsetHeight\r\n            };\r\n        };\r\n\r\n        nsGmx.Utils.showDialog(_gtxt('Таблица атрибутов слоя [value0]', this.layerTitle), canvas,\r\n            {\r\n                width: 820,\r\n                height: 520,\r\n                resizeFunc: function()\r\n                {\r\n                    this.resizeFunc.apply(this, arguments);\r\n                }.bind(this),\r\n                closeFunc: function()\r\n                {\r\n                    if (_this._updateVersionHandler !== null && _this._isLayerOnMap) {\r\n                        nsGmx.gmxMap.layersByID[_this.layerName].off('versionchange', _this._updateVersionHandler);\r\n                    }\r\n                },\r\n                setMinSize: false\r\n            }\r\n        );\r\n    }\r\n\r\n\tsendCrossDomainJSONRequest(window.serverBase + 'Layer/GetLayerJson.ashx?WrapStyle=func&LayerName=' + this.layerName, function(response)\r\n\t{\r\n\t\tif (!window.parseResponse(response)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tloading.removeNode(true);\r\n\r\n        _this._layerInfo = response.Result.properties;\r\n\r\n        _this._layerColumns = [\r\n            {Value: 'GeomIsEmpty([geomixergeojson])', Alias: '__GeomIsEmpty__'},\r\n            {Value: '[' + response.Result.properties.identityField + ']'}\r\n        ];\r\n\r\n        var attrs = response.Result.properties.attributes;\r\n        for (var k = 0; k < attrs.length; k++) {\r\n            _this._layerColumns.push({Value: '[' + attrs[k] + ']'});\r\n        }\r\n\r\n\t\t_this.drawDialog(response.Result.properties, canvas, outerSizeProvider, params);\r\n\t});\r\n};\r\n\r\nattrsTable.prototype._updateSearchString = function(query) {\r\n    this._serverDataProvider.setRequests(\r\n        window.serverBase + 'VectorLayer/Search.ashx', {layer: this.layerName, query: query, count: true},\r\n        window.serverBase + 'VectorLayer/Search.ashx', {layer: this.layerName, query: query, columns: JSON.stringify(this._layerColumns)}\r\n    );\r\n};\r\n\r\n/*\r\n* columnsList (extracted from searchParamsManager)\r\n*/\r\nattrsTable.prototype.createColumnsList = function(paramsManager) {\r\n\tvar \t\t\r\n\t \tinfo = this._layerInfo,\r\n\t \t_activeColumns_ = '_activeColumns_' + info.name,\r\n\t\t// paramsWidth = 300,\r\n\t\tcolumnsList = nsGmx.Utils._div(null, [['dir', 'className', 'attrsColumnsList'], ['css', 'overflowY', 'auto']]);//\r\n\r\n\tvar attrTitles = this.tableFields.fieldsAsArray;\r\n\t   if (!paramsManager._activeColumns) {\r\n\t\t\tparamsManager._activeColumns = {};\r\n\r\n\t\t\t\tfor (var i = 0; i < attrTitles.length; ++i) {\r\n\t\t\t\t   paramsManager._activeColumns[attrTitles[i]] = true;\r\n\t\t\t\t}\r\n\t   }\r\n\r\n\t   var presentColumns = false;\r\n\r\n\t   for (var key in paramsManager._activeColumns) {\r\n\t\t   if (paramsManager._activeColumns.hasOwnProperty(key)) {\r\n\t\t\t   if (paramsManager._activeColumns[key] === true) {\r\n\t\t\t\t   presentColumns = true;\r\n\t\t\t\t   break;\r\n\t\t\t   }\r\n\t\t   }\r\n\t   }\r\n\r\n\t   var showColumnsTemplate =\r\n\t\t   '<div class=\"attrs-table-show-columns-header\">' +\r\n\t\t\t   '<label title=\"{{name}}\" class=\"attrs-table-show-columns\">' +\r\n\t\t\t\t   '<input type=\"checkbox\" class=\"box attrs-table-show-columns-checkbox\" {{#active}}checked{{/active}}></input>' +\r\n\t\t\t\t   '{{name}}' +\r\n\t\t\t   '</label>' +\r\n\t\t   '</div>';\r\n\r\n\t   var selectColumnsUI = $(Handlebars.compile(showColumnsTemplate)({\r\n\t\t   active: presentColumns,\r\n\t\t   name: (window._gtxt('Колонки') + ':')\r\n\t   })).appendTo(columnsList);\r\n\r\n\t   var rowTemplate =\r\n\t\t   '<label title=\"{{name}}\" class=\"attrs-table-active-row\">' +\r\n\t\t\t   '<input type=\"checkbox\" class=\"box attrs-table-active-checkbox\" {{#active}}checked{{/active}}></input>' +\r\n\t\t\t   '{{name}}' +\r\n\t\t   '</label>';\r\n\r\n\t   attrTitles.forEach(function(columnName) {\r\n\t\t   var rowUI = $(Handlebars.compile(rowTemplate)({\r\n\t\t\t   active: paramsManager._activeColumns[columnName],\r\n\t\t\t   name: columnName\r\n\t\t   })).appendTo(columnsList);\r\n\r\n\t\t   $('input', rowUI).click(function() {\r\n\t\t\t   paramsManager._activeColumns[columnName] = this.checked;\r\n\t\t\t   $(paramsManager).trigger('columnsChange');\r\n\t\t\t\twindow.localStorage.setItem(_activeColumns_, JSON.stringify(paramsManager._activeColumns));\t// сохранение активных колонок\r\n\t\t   });\r\n\t   });\r\n\r\n\t   $('input', selectColumnsUI).click(function() {\r\n\t\t   var checked = this.checked;\r\n\t\t   for (var key in paramsManager._activeColumns) {\r\n\t\t\t   if (paramsManager._activeColumns.hasOwnProperty(key)) {\r\n\t\t\t\t   paramsManager._activeColumns[key] = checked;\r\n\t\t\t\t   $(paramsManager).trigger('columnsChange');\r\n\t\t\t\t   $('input', columnsList).each(function () {\r\n\t\t\t\t\t   $(this).prop('checked', checked);\r\n\t\t\t\t   });\r\n\t\t\t   }\r\n\t\t   }\r\n\t   });\r\n\r\n\t   // columnsList.onmouseleave = function () {\r\n\t\t//    this.style.display = 'none';\r\n\t   // }\r\n\t   return columnsList;\r\n};\r\n\r\nattrsTable.prototype.drawDialog = function(info, canvas, outerSizeProvider, params)\r\n{\r\n\tvar _this = this;\r\n\r\n    var _params = $.extend({\r\n        hideDownload: false,\r\n        hideActions: false,\r\n        hideRowActions: false,\r\n        hideSearchParams: false,\r\n        onClick: null,\r\n        searchParamsManager: new nsGmx.AttrTable.DefaultSearchParamsManager()\r\n        /*attributes: [] */\r\n    }, params);\r\n\t_params.searchParamsManager._activeColumns = JSON.parse(localStorage.getItem('_activeColumns_' + info.name));\t\t// чтение активных колонок\r\n\r\n\tvar paramsWidth = 300,\r\n\t\ttdParams = nsGmx.Utils._td(null, [['css', 'width', paramsWidth + 'px'], ['attr', 'vAlign', 'top']]),\r\n\t\t// tdTable = nsGmx.Utils._td(null, [['attr', 'vAlign', 'top']]),\r\n\t\tfindObjectsButton = nsGmx.Utils.makeLinkButton(_gtxt('Найти объекты')),\r\n\t\tupdateObjectsButton = nsGmx.Utils.makeLinkButton(_gtxt('Обновить объекты')),\r\n\t\taddObjectButton = nsGmx.Utils.makeLinkButton(_gtxt('Добавить объекты')),\r\n\t\tchangeFieldsListButton = nsGmx.Utils.makeLinkButton(_gtxt('Изменить колонки')),\r\n\t\toldCanvasWidth = false;\r\n\r\n    var downloadSection = $(Handlebars.compile('<div>' +\r\n        '<span class=\"buttonLink attrsDownloadLink\" data-format=\"Shape\">{{i \"Скачать shp\"}}</span>' +\r\n        '{{#unless isPolygon}}' +\r\n\t\t'<span class=\"buttonLink attrsDownloadLink\" data-format=\"gpx\">{{i \"Скачать gpx\"}}</span>' +\r\n\t\t'{{/unless}}' +\r\n        '<span class=\"buttonLink attrsDownloadLink\" data-format=\"csv\">{{i \"Скачать csv\"}}</span>' +\r\n        '<span class=\"buttonLink attrsDownloadLink\" data-format=\"geojson\">{{i \"Скачать geojson\"}}</span>' +\r\n        '<span class=\"buttonLink createLayerLink\">{{i \"Создать слой\"}}</span>' +\r\n\t\t'<span class=\"buttonLink copyObjectsLink\">{{i \"Копировать объекты\"}}</span>' +\r\n        '{{#if isPolygon}}<span class=\"buttonLink attrs-table-square-link\">{{i \"Рассчитать площадь\"}}</span>{{/if}}' +\r\n    '</div>')({\r\n        isPolygon: info.GeometryType === 'polygon'\r\n    }));\r\n\r\n\t$(findObjectsButton).addClass('attr-table-find-button');\r\n\t$(updateObjectsButton).addClass('attr-table-update-button');\r\n\t/*temp*/\r\n\t// $(updateObjectsButton).addClass('gmx-disabled');\r\n\t/*temp end*/\r\n\t$(addObjectButton).addClass('attr-table-add-button');\r\n\t$(changeFieldsListButton).addClass('attr-table-list-button');\r\n\r\n\tif (info.Access !== 'edit' && info.Access !== 'editrows') {\r\n\t\t$(updateObjectsButton).addClass('gmx-disabled');\r\n\t\t$(addObjectButton).addClass('gmx-disabled');\r\n\t\t$(changeFieldsListButton).addClass('gmx-disabled');\r\n\t}\r\n\r\n    downloadSection.find('.attrsDownloadLink').click(function() {\r\n        downloadLayer($(this).data('format'));\r\n    });\r\n\r\n\t// создание слоя из выборки (из атрибутивной таблицы)\r\n    downloadSection.find('.createLayerLink').click(function() {\r\n\t\tsendCrossDomainJSONRequest(window.serverBase + \"Layer/GetLayerInfo.ashx?WrapStyle=func&NeedAttrValues=false&LayerName=\" + info.name, function(response) {\r\n\t\t\tif (!parseResponse(response)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tcreateEditorFromSelection(response.Result);\r\n\r\n\t\t\tfunction createEditorFromSelection(props) {\r\n\t\t\t\tvar query = _params.searchParamsManager.getQuery(),\r\n\t\t\t\t\tactiveColumns = _params.searchParamsManager.getActiveColumns(),\r\n\t\t\t\t\tfilteredColumns = [];\r\n\r\n\t\t\t\t// get columns list from search filter\r\n\t\t\t\tprops.Columns.forEach(function(col) {\r\n\t\t\t\t\tif (col.Name in activeColumns && activeColumns[col.Name]) {\r\n\t\t\t\t\t\tfilteredColumns.push(col);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\tvar parent = nsGmx.Utils._div(null, [['attr','id','new' + 'Vector' + 'Layer'], ['css', 'height', '100%']]),\r\n\t\t\t\t\tproperties = {\r\n\t\t\t\t\t\tTitle:  props.Title + ' ' + _gtxt('копия'),\r\n\t\t\t\t\t\tCopyright: props.Copyright,\r\n\t\t\t\t\t\tDescription: props.Description,\r\n\t\t\t\t\t\tDate: props.Date,\r\n\t\t\t\t\t\tMetaProperties: props.MetaProperties,\r\n\t\t\t\t\t\tTilePath: {\r\n\t\t\t\t\t\t\tPath: ''\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tShapePath: props.ShapePath,\r\n\t\t\t\t\t\tColumns: filteredColumns,\r\n\t\t\t\t\t\tIsRasterCatalog: props.IsRasterCatalog,\r\n\t\t\t\t\t\tSourceType: \"file\",\r\n\t\t\t\t\t\tQuicklook: props.Quicklook\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdialogDiv = nsGmx.Utils.showDialog(_gtxt('Создать векторный слой'), parent, 340, 340, false, false),\r\n\t\t\t\t\tparams = {\r\n\t\t\t\t\t\tcopy: true,\r\n\t\t\t\t\t\tsourceLayerName: info.name,\r\n\t\t\t\t\t\tquery: query,\r\n\t\t\t\t\t\tdoneCallback: function() {\r\n\t\t\t\t\t\t\tnsGmx.Utils.removeDialog(dialogDiv);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\tnsGmx.createLayerEditor(false, 'Vector', parent, properties, params);\r\n\t\t\t}\r\n\t\t});\r\n    });\r\n\r\n\tdownloadSection.find('.copyObjectsLink').click(function() {\r\n\t\tvar copyLayerParams = {layerName: info.name, query: _params.searchParamsManager.getQuery()};\r\n\t\tnsGmx.ClipboardController.addItem('CopyObjects', copyLayerParams);\r\n\t\twindow.showErrorMessage(window._gtxt(\"Выберите правым кликом слой в левой панели и нажмите \\\"Вставить объекты\\\"\"), true, window._gtxt(\"Объекты скопированы\"));\r\n\t});\r\n\r\n    this.tableFields.init(_params.attributes, info);\r\n\r\n    this._serverDataProvider = new nsGmx.AttrTable.ServerDataProvider({titleToParams: $.extend(this.tableFields.titleToField, {'': '__GeomIsEmpty__'})});\r\n\r\n    var squareLink = downloadSection.find('.attrs-table-square-link');\r\n\r\n    new nsGmx.AttrTable.SquareCalc(squareLink, this.layerName, this._serverDataProvider, _params.searchParamsManager);\r\n\r\n    var hostName = window.serverBase.match(/^https?:\\/\\/(.*)\\/$/)[1];\r\n\r\n    this._updateSearchString('');\r\n\r\n\tvar searchParamsManager = _params.searchParamsManager;\r\n\t$(searchParamsManager).on({\r\n\t\tqueryChange: function() {\r\n\t\t\t_this.offset = 0;\r\n\t\t\t_this._updateSearchString(searchParamsManager.getQuery());\r\n\t\t},\r\n\t\tcolumnsChange: function() {\r\n\t\t\tvar columns = searchParamsManager.getActiveColumns ? searchParamsManager.getActiveColumns() : _this.tableFields.fieldsAsHash;\r\n\t\t\tfor (var k in columns) {\r\n\t\t\t\t_this.table2.activateField(k, columns[k]);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n    var downloadLayer = function(format) {\r\n        var activeColumns = searchParamsManager.getActiveColumns ? searchParamsManager.getActiveColumns() : _this.tableFields.fieldsAsHash,\r\n            columnsForServer = [];\r\n\r\n        for (var c in activeColumns) {\r\n            if (activeColumns[c]) {\r\n                columnsForServer.push({\r\n                    Value: '[' + _this.tableFields.titleToField[c] + ']',\r\n                    Alias: c\r\n                });\r\n            }\r\n        }\r\n\r\n        _mapHelper.downloadVectorLayer({\r\n            name: _this.layerName,\r\n            host: hostName,\r\n            format: format,\r\n            query: _params.searchParamsManager.getQuery(),\r\n            columns: columnsForServer\r\n        });\r\n    };\r\n\r\n\tfindObjectsButton.onclick = function() {\r\n\t\ttdParams.innerHTML = '';\r\n\r\n\t\toldCanvasWidth = outerSizeProvider().width;\r\n\r\n\t\tsearchParamsManager.drawSearchUI(tdParams, _this);\r\n\r\n\t\tif (tdParams.style.display === 'none') {\r\n\t\t\ttdParams.style.display = '';\r\n\t\t} else {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tresizeFunc();\r\n\t};\r\n\r\n   findObjectsButton.style.marginRight = '10px';\r\n\r\n   if (info.Access === 'edit' || info.Access === 'editrows') {\r\n\t   updateObjectsButton.onclick = function() {\r\n\t\t   if ($(findObjectsButton).hasClass('gmx-disabled')) {\r\n\t\t\t   $(findObjectsButton).removeClass('gmx-disabled');\r\n\t\t   }\r\n\r\n\t\t   tdParams.innerHTML = '';\r\n\r\n\t\t   oldCanvasWidth = outerSizeProvider().width;\r\n\r\n\t\t   searchParamsManager.drawUpdateUI(tdParams, _this);\r\n\r\n\t\t   if (tdParams.style.display === 'none') {\r\n\t\t\t   tdParams.style.display = '';\r\n\t\t   } else {\r\n\t\t\t   return;\r\n\t\t   }\r\n\r\n\t\t   resizeFunc();\r\n\t   };\r\n\t}\r\n\r\n   updateObjectsButton.style.marginRight = '10px';\r\n\r\n   if (info.Access === 'edit' || info.Access === 'editrows') {\r\n\t   addObjectButton.onclick = function() {\r\n\t    new nsGmx.EditObjectControl(_this.layerName);\r\n\t\t};\r\n\t}\r\n\r\n\taddObjectButton.style.marginRight = '10px';\r\n\r\n    if (_params.hideActions) {\r\n        $(addObjectButton).hide();\r\n\t}\r\n   if (info.Access === 'edit' || info.Access === 'editrows') {\r\n\t\tchangeFieldsListButton.onclick = function() {\r\n\t\t\tvar div;\r\n\t\t\tif (info.MultiLayerID) {\r\n\t\t\t\tdiv = $(_queryMapLayers.buildedTree).find(\"div[MultiLayerID='\" + info.MultiLayerID + \"']\")[0];\r\n\t\t\t} else {\r\n\t\t\t\tdiv = $(_queryMapLayers.buildedTree).find(\"div[LayerID='\" + info.name + \"']\")[0];\r\n\t\t\t}\r\n\t\t\t_mapHelper.createLayerEditor(div, false, 'attrs', div.gmxProperties.content.properties.styles.length > 1 ? -1 : 0);\r\n\t\t};\r\n\t}\r\n\r\n\tchangeFieldsListButton.style.marginRight = '10px';\r\n\r\n\ttdParams.style.display = 'none';\r\n\r\n\t// var name = 'attrsTable' + info.name;\r\n\r\n    var attrNames = this.tableFields.fieldsAsArray;\r\n    var fielsWidth = new Array(_params.hideRowActions ? attrNames.length : attrNames.length + 1).join('0').split('0');\r\n    var attrNamesHash = this.tableFields.fieldsAsHash;\r\n\r\n    _params.hideDownload && downloadSection.hide();\r\n\r\n    this.divTable2 = nsGmx.Utils._div(null, [['css', 'overflow', 'auto'], ['dir', 'className', 'attrsTableBody']]);\r\n\r\n\tvar columnsList = this.createColumnsList(_params.searchParamsManager);\r\n\tcolumnsList.style.display = 'none';\r\n\r\n    var selectAllItems = nsGmx.Utils._checkbox(false, 'checkbox'),\r\n\t\tselectedCount = nsGmx.Utils._span([], [['attr', 'class', 'selectedCount']]),\r\n\t\tselectedDelete = nsGmx.Utils.makeLinkButton(_gtxt('Удалить')),\r\n\t\tshowColumnsListButton = nsGmx.Utils.makeLinkButton(_gtxt('Показывать колонки')),\r\n\t\tselectedCopy = nsGmx.Utils.makeLinkButton(_gtxt('Скопировать')),\r\n\t\t// selectedDownload = nsGmx.Utils.makeLinkButton(_gtxt('Скачать')),\r\n\t\tselectedCont = nsGmx.Utils._span([\r\n\t\t\tnsGmx.Utils._t('Выбрано объектов:'),\r\n\t\t\tselectedCount,\r\n\t\t\tselectedDelete,\r\n\t\t\tselectedCopy,\r\n\t\t\t// selectedDownload\r\n\t\t], [['attr', 'class', 'hiddenCommands']]),\r\n\t\tgroupBox = nsGmx.Utils._div([\r\n\t\t\tselectAllItems,\r\n\t\t\tnsGmx.Utils._span([nsGmx.Utils._t('Выделить все на странице')], [['css', 'marginLeft', '5px'], ['css', 'verticalAlign', 'top']]),\r\n\t\t\tselectedCont,\r\n\t\t\tshowColumnsListButton,\r\n\t\t\tcolumnsList\r\n\t\t], [\r\n\t\t\t['attr', 'class', 'attrsSelectedCont']\r\n\t\t]);\r\n\r\n\tcanvas.onclick = function () {\r\n\t\tif ($(showColumnsListButton).hasClass('hide-columns-list-button')) {\r\n\t\t\t$(showColumnsListButton).toggleClass('hide-columns-list-button');\r\n\t\t\t$(showColumnsListButton).html(_gtxt('Показывать колонки'))\r\n\t\t}\r\n\r\n\t\t$(columnsList).hide();\r\n\t}\r\n\tcolumnsList.onclick = function (e) {\r\n\t\te.stopPropagation();\r\n\t}\r\n\r\n\tselectAllItems.onchange = function() {\r\n\t\tvar table2 = _this.table2;\r\n\t\ttable2.getVisibleItems().forEach(function(it) {\r\n\t\t\tvar id = it.values[1];\r\n\t\t\tif (selectAllItems.checked) { _this._selected[id] = true; }\r\n\t\t\telse  { delete _this._selected[id]; }\r\n\t\t});\r\n\t\tchkSelectedCount();\r\n\t\ttable2.repaint();\r\n\t};\r\n\tselectedCount.innerHTML = 0;\r\n    this._selected = {};\r\n\r\n\tselectedDelete.onclick = function() {\r\n\t\tvar remove = nsGmx.Utils.makeButton(_gtxt('Удалить'));\r\n\t\tremove.onclick = function() {\r\n            var arr = Object.keys(_this._selected).reduce(function(p, c) {\r\n                p.push({action: 'delete', id: c});\r\n                return p;\r\n            }, []);\r\n\t\t\t_mapHelper.modifyObjectLayer(_this.layerName, arr).done(function() {\r\n\t\t\t\tnsGmx.Utils.removeDialog(jDialog);\r\n\t\t\t\tclearSelected();\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tvar offset = $(selectedDelete).offset();\r\n\t\tvar jDialog = nsGmx.Utils.showDialog(_gtxt('Удалить отмеченные объекты?'), nsGmx.Utils._div([remove], [['css', 'textAlign', 'center']]), 280, 75, offset.left + 20, offset.top - 30);\r\n\t};\r\n\r\n\tselectedCopy.onclick = function() {\r\n\t\tvar list = '(' + Object.keys(_this._selected).join(',') + ')',\r\n\t\t\tcopyLayerParams = {\r\n\t\t\t\tlayerName: info.name,\r\n\t\t\t\tlist: list,\r\n\t\t\t\tquery: '[gmx_id] IN ' + list\r\n\t\t\t};\r\n\t\t\t\r\n\t\tnsGmx.ClipboardController.addItem('CopyObjects', copyLayerParams);\r\n\t\twindow.showErrorMessage(list, true, window._gtxt('Объекты скопированы'));\r\n\t};\r\n\r\n\t$(showColumnsListButton).addClass('show-columns-list-button');\r\n\r\n\tshowColumnsListButton.onclick = function(e) {\r\n\t\te.stopPropagation();\r\n\t\t$(this).toggleClass('hide-columns-list-button');\r\n\t\tif ($(this).hasClass('hide-columns-list-button')) {\r\n\t\t\t$(this).html(_gtxt('Скрыть колонки'));\r\n\t\t\t$(columnsList).show();\r\n\t\t} else {\r\n\t\t\t$(this).html(_gtxt('Показывать колонки'))\r\n\t\t\t$(columnsList).hide();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar manageSection = nsGmx.Utils._div([findObjectsButton, updateObjectsButton, addObjectButton, changeFieldsListButton], [['css', 'margin', '0px 0px 10px 1px']]);\r\n    var tdTable2 = nsGmx.Utils._td([manageSection, groupBox, this.divTable2, downloadSection[0]], [['attr', 'vAlign', 'top']]);\r\n    this.table2 = new nsGmx.ScrollTable({pagesCount: 10, limit: 20});\r\n\r\n\tthis.prevLimit = this.table2.limit;\r\n    var chkSelectedCount = function() {\r\n\t\tvar cnt = Object.keys(_this._selected).length;\r\n\t\tif (cnt) {\r\n\t\t\tL.DomUtil.removeClass(selectedCont, 'hiddenCommands');\r\n\t\t} else {\r\n\t\t\tL.DomUtil.addClass(selectedCont, 'hiddenCommands');\r\n\t\t}\r\n\t\tselectedCount.innerHTML = cnt;\r\n    };\r\n    var clearSelected = function() {\r\n\t\t_this._selected = {};\r\n\t\tchkSelectedCount();\r\n\t\tselectAllItems.checked = false;\r\n    };\r\n\r\n\tvar drawTableItem2 = function(elem, curIndex, activeHeaders)\r\n    {\r\n        var tds = [];\r\n\r\n        if (this.limit !== _this.prevLimit) {\r\n            _this.prevLimit = this.limit;\r\n\t\t\tclearSelected();\r\n\t\t}\r\n\r\n\t\tvar id = elem.values[elem.fields[info.identityField].index],\r\n\t\t\tshowButton = nsGmx.Utils.makeImageButton('img/enlarge-circle.svg', 'img/enlarge-circle.svg'),\r\n            editButton = nsGmx.Utils.makeImageButton('img/pen.svg'),\r\n            deleteItem = nsGmx.Utils._checkbox(_this._selected[id], 'checkbox'),\r\n            tdControl;\r\n\r\n        if (info.Access !== 'edit' && info.Access !== 'editrows') {\r\n            tdControl = nsGmx.Utils._td([nsGmx.Utils._div([showButton], [['css', 'width', '45px']])], [['css', 'width', '45px']]);\r\n        } else {\r\n            tdControl = nsGmx.Utils._td([nsGmx.Utils._div([deleteItem, showButton, editButton], [['css', 'width', '47px']])], [['css', 'width', '47px']]);\r\n        }\r\n\r\n        editButton.style.marginLeft = showButton.style.marginLeft = '5px';\r\n        editButton.style.width = '12px';\r\n\r\n        deleteItem.onchange = function() {\r\n\t\t\tif (deleteItem.checked) {\r\n\t\t\t\t_this._selected[id] = true;\r\n\t\t\t\t // console.log(_this._selected);\r\n\t\t\t } else {\r\n\t\t\t\tdelete _this._selected[id];\r\n\t\t\t\tselectAllItems.checked = false;\r\n\t\t\t}\r\n\t\t\tchkSelectedCount();\r\n        };\r\n\r\n        editButton.onclick = function()\r\n        {\r\n            var id = elem.values[elem.fields[info.identityField].index];\r\n            new nsGmx.EditObjectControl(_this.layerName, id);\r\n        };\r\n\r\n        showButton.onclick = function()\r\n        {\r\n            var id = elem.values[elem.fields[info.identityField].index];\r\n            sendCrossDomainJSONRequest(window.serverBase + 'VectorLayer/Search.ashx?WrapStyle=func&layer=' + _this.layerName + '&page=0&pagesize=1&geometry=true&query=' + encodeURIComponent('[' + info.identityField + ']=' + id), function(response) {\r\n                if (!window.parseResponse(response)) {\r\n                    return;\r\n\t\t\t\t}\r\n\t\t\t\tvar layer = nsGmx.gmxMap.layersByID[_this.layerName],\r\n\t\t\t\t\tprops = layer.getGmxProperties(),\r\n\t\t\t\t\tisTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.getDateInterval);\r\n\r\n                var columnNames = response.Result.fields;\r\n                var row = response.Result.values[0];\r\n                for (var i = 0; i < row.length; ++i)\r\n                {\r\n                    if (columnNames[i] === 'geomixergeojson' && row[i])\r\n                    {\r\n\r\n                        var fitBoundsOptions = layer ? {maxZoom: layer.options.maxZoom} : {};\r\n\r\n                        var geom = L.gmxUtil.geometryToGeoJSON(row[i], true);\r\n                        var bounds = L.gmxUtil.getGeometryBounds(geom);\r\n                        nsGmx.leafletMap.fitBounds([\r\n                            [bounds.min.y, bounds.min.x],\r\n                            [bounds.max.y, bounds.max.x]\r\n                        ], fitBoundsOptions);\r\n\r\n\t\t\t\t\t\tif (isTemporalLayer) {\r\n\t\t\t\t\t\t\tvar tempColumn = props.TemporalColumnName,\r\n\t\t\t\t\t\t\t\tindex = columnNames.indexOf(tempColumn),\r\n\t\t\t\t\t\t\t\tdayms = nsGmx.DateInterval.MS_IN_DAY,\r\n\t\t\t\t\t\t\t\tdateBegin, dateEnd,\r\n\t\t\t\t\t\t\t\tdatems;\r\n\r\n\t\t\t\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\t\t\t\tdatems = row[index] * 1000;\r\n\t\t\t\t\t\t\t\tdateBegin = nsGmx.DateInterval.toMidnight(new Date(datems));\r\n\t\t\t\t\t\t\t\tdateEnd = nsGmx.DateInterval.toMidnight(new Date(datems + dayms));\r\n\t\t\t\t\t\t\t\tnsGmx.widgets.commonCalendar.setDateInterval(dateBegin, dateEnd, layer);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n                    }\r\n                }\r\n            });\r\n        };\r\n\r\n        nsGmx.Utils._title(deleteItem, _gtxt('Удалить'));\r\n        nsGmx.Utils._title(editButton, _gtxt('Редактировать'));\r\n        nsGmx.Utils._title(showButton, _gtxt('Показать'));\r\n\r\n        $(showButton).toggle(!elem.values[elem.fields['__GeomIsEmpty__'].index]);\r\n\r\n        if (!_params.hideRowActions) {\r\n            tds.push(tdControl);\r\n\t\t}\r\n\r\n        for (var j = 0; j < activeHeaders.length; ++j)\r\n        {\r\n            if (activeHeaders[j] === '') {\r\n                continue;\r\n\t\t\t}\r\n\r\n            var fieldName = _this.tableFields.titleToField[activeHeaders[j]];\r\n\r\n            if (fieldName in elem.fields)\r\n            {\r\n                var valIndex = elem.fields[fieldName].index,\r\n                    td = nsGmx.Utils._td();\r\n\r\n                nsGmx.Utils._(td, [nsGmx.Utils._t(nsGmx.Utils.convertFromServer(elem.fields[fieldName].type, elem.values[valIndex]))]);\r\n\r\n                if (elem.fields[fieldName].type === 'integer') {\r\n                    td.style.textAlign = 'right';\r\n\t\t\t\t}\r\n\r\n                tds.push(td);\r\n            }\r\n            else\r\n            {\r\n                tds.push(nsGmx.Utils._td());\r\n            }\r\n        }\r\n\r\n        var tr = nsGmx.Utils._tr(tds);\r\n\r\n        if (curIndex % 2 !== 0) {\r\n            tr.className = 'odd';\r\n\t\t}\r\n\r\n        if (_params.onClick) {\r\n            tr.onclick = function()\r\n            {\r\n                _params.onClick(elem);\r\n            };\r\n            tr.style.cursor = 'pointer';\r\n        }\r\n\r\n        return tr;\r\n    };\r\n\r\n    var tableFields = _params.hideRowActions ? attrNames : [''].concat(attrNames);\r\n\r\n    this.table2.setDataProvider(this._serverDataProvider);\r\n    this.table2.createTable(this.divTable2, 'attrs', 0, tableFields, fielsWidth, drawTableItem2, $.extend(attrNamesHash, {'': true}), true);\r\n\r\n\tif (_params.searchParamsManager._activeColumns) {\r\n\t\tvar obj = _params.searchParamsManager._activeColumns;\r\n\t   for (var key in obj) {\r\n\t\t   this.table2.activateField(key, obj[key]);\r\n\t   }\r\n\t}\r\n\r\n\tnsGmx.Utils._(canvas, [nsGmx.Utils._table([nsGmx.Utils._tbody([nsGmx.Utils._tr([tdParams, tdTable2])])], ['css', 'width', '100%'])]);\r\n\r\n\tvar tbl = $(this.divTable2).find('#attrsTableParent')[0];\r\n\t// var ths = $(this).find('th');\r\n\r\n\tif (L.Browser.ie || L.Browser.gecko) {\r\n\t\tvar lastSTop = tbl.scrollTop;\r\n\t\ttbl.onscroll = function() {\r\n\t\t\tvar stop = this.scrollTop;\r\n\t\t\tvar ths = $(this).find('th');\r\n\t\t\tif (stop < lastSTop) {\r\n\t\t\t\t$(ths).each(function () {\r\n\t\t\t\t\t$(this).css('transitionDelay', '0s');\r\n\t\t\t\t\t$(this).css('transform', \"\");\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tlastSTop = stop;\r\n\t\t\tvar translate = \"translate(0,\"+stop+\"px)\";\r\n\r\n\t\t\t$(ths).each(function () {\r\n\t\t\t\t$(this).css('transitionDelay', '0.25s');\r\n\t\t\t\t$(this).css('transform', translate);\r\n\t\t\t})\r\n\t\t};\r\n\t} else {\r\n\t\ttbl.onscroll = function() {\r\n\t\t\tvar translate = \"translate(0,\"+(this.scrollTop)+\"px)\";\r\n\t\t\tvar ths = $(this).find('th');\r\n\t\t\t$(ths).each(function () {\r\n\t\t\t\t$(this).css('transform', translate);\r\n\t\t\t})\r\n\t\t};\r\n\t}\r\n\r\n\tvar resizeFunc = function()\r\n\t{\r\n\t\tvar dialogWidth = oldCanvasWidth || outerSizeProvider().width;\r\n\r\n\t\toldCanvasWidth = false;\r\n\r\n\t\tcanvas.childNodes[0].style.width = dialogWidth - 21 - 10 + 'px';\r\n\t\ttdTable2.style.width = dialogWidth - tdParams.offsetWidth - 21 - 10 + 'px';\r\n\t\t_this.divTable2.style.width = dialogWidth - tdParams.offsetWidth - 21 - 10 + 'px';\r\n\r\n        var dialogHeight = outerSizeProvider().height;\r\n\t\t_this.divTable2.style.height = dialogHeight -14 - 25 - 10 - 30 + 'px';\r\n\r\n        _this.table2.updateHeight(parseInt(_this.divTable2.style.height));\r\n        _params.searchParamsManager.resize && _params.searchParamsManager.resize({\r\n            width: tdParams.offsetWidth,\r\n            height: _this.divTable2.offsetHeight\r\n        });\r\n\t};\r\n\r\n\tthis.resizeFunc = resizeFunc;\r\n\r\n\tresizeFunc();\r\n\r\n    if (this._isLayerOnMap)\r\n    {\r\n        this._updateVersionHandler = function() {\r\n            _this._serverDataProvider.serverChanged();\r\n        };\r\n\r\n        nsGmx.gmxMap.layersByID[this.layerName].on('versionchange', this._updateVersionHandler);\r\n    }\r\n};\r\n\r\nvar attrsTableHash = function()\r\n{\r\n\tthis.hash = {};\r\n    this.hooks = [];\r\n    this._hookID = 0;\r\n};\r\n\r\nattrsTableHash.prototype.create = function(name, canvas, outerSizeProvider, params)\r\n{\r\n    params = params || {};\r\n    this.hooks.forEach(function(hookInfo) {\r\n        params = hookInfo.hook(params, name) || params;\r\n    });\r\n\r\n\tif (name in this.hash)\r\n\t{\r\n        this.hash[name].getInfo(canvas, outerSizeProvider, params);\r\n\t}\r\n\telse\r\n\t{\r\n        var title = nsGmx.gmxMap.layersByID[name] ? nsGmx.gmxMap.layersByID[name].getGmxProperties().title : '';\r\n        var newAttrsTable = new attrsTable(name, title);\r\n\t\tnewAttrsTable.getInfo(canvas, outerSizeProvider, params);\r\n\r\n\t\tthis.hash[name] = newAttrsTable;\r\n\t}\r\n\r\n    return this.hash[name];\r\n};\r\n\r\nattrsTableHash.prototype.addHook = function(paramsHook) {\r\n    var id = 'id' + this._hookID++;\r\n    this.hooks.push({id: id, hook: paramsHook});\r\n    return id;\r\n};\r\n\r\nattrsTableHash.prototype.removeHook = function(hookID) {\r\n    for (var i = 0; i < this.hooks.length; i++) {\r\n        if (this.hooks[i].id === hookID) {\r\n            this.hooks.splice(i, 1);\r\n            return;\r\n        }\r\n    }\r\n};\r\n\r\nwindow._attrsTableHash = new attrsTableHash();\r\n\r\n/** Менеджер поискового интерфейса таблицы атрибутов.\r\n    Используется в таблице атрибутов для задания кастомизированного интерфейса поиска объектов слоя.\r\n    Генерирует события queryChange и columnsChange\r\n  @typedef IAttrTableSearchManager\r\n  @memberOf nsGmx\r\n  @prop {function(container, attrTable)} render Ф-ция для отрисовки кастомизированного интерфейса в контейнере. Параметры: container, attrTable\r\n  @prop {function(): String} getQuery Получить SQL запрос за данными\r\n  @prop {function(): Object} getActiveColumns Получить хеш с описанием активности колонок (имя колонки -> true/false)\r\n  @prop {function(dims)} resize Ф-ция для реакции на изменения размера диалога. dims - целевые размеры контейнера (width, height)\r\n*/\r\n\r\n/** Показать таблицу атрибутов векторного слоя\r\n  @func createAttributesTable\r\n  @memberOf nsGmx\r\n  @param {String} layerName ID слоя\r\n  @param {DOMElement} canvas Контейнер, куда поместить таблицу атрибутов. Если не указано, будет создан новый диалог\r\n  @param {function} outerSizeProvider Ф-ция для определения текущих размеров контейнера. Должна возвращать объект с полями width и height. Применяется только если указан canvas.\r\n  @param {Object} params Дополнительные параметры\r\n  @param {Boolean} [params.hideDownload=false] Скрыть секцию с вариантами скачивания данных\r\n  @param {Boolean} [params.hideActions=false] Скрыть секцию с добавлением объекта\r\n  @param {Boolean} [params.hideRowActions=false] Скрыть столбец таблицы с действиями над отдельными объектами\r\n  @param {Boolean} [params.hideSearchParams=false] Скрыть секцию с параметрами поиска\r\n  @param {function} [params.onClick] Ф-ция, которая будет вызываться при клике на строчке таблицы. Первым параметром передаётся объект, по которому кликнули\r\n  @param {Array} [params.attributes] Массив, определяющий, какие атрибуты показывать. Каждый элемент - объект с полями \"name\" (исходное название атрибута) и title (как отображать в таблице).\r\n                 Если атрибута нет в массиве, он не будет показан в таблице. Если массив не указан, показываются все атрибуты\r\n  @param {nsGmx.IAttrTableSearchManager} [params.searchParamsManager] Менеджер UI для поиска в таблице атрибутов\r\n  @return Интерфейс для управления таблицей атрибутов\r\n*/\r\n\r\nnsGmx.createAttributesTable = window._attrsTableHash.create.bind(window._attrsTableHash);\r\n\r\n\r\n/** Добавить хук для изменения параметров при вызове таблицы атрибутов\r\n  @func addAttributesTableHook\r\n  @memberOf nsGmx\r\n  @param {function(params, layerName):Object} paramsHook Хук, который вызывается при каждом вызове диалога редактирования.\r\n         Первый параметр - параметры диалога (можно модифицировать), второй - ID слоя).\r\n  @return {String} ID добавленного хука\r\n*/\r\nnsGmx.addAttributesTableHook = function(paramsHook) {\r\n    return window._attrsTableHash.addHook(paramsHook);\r\n};\r\n\r\n/** Удаляет хук параметров\r\n  @func removeAttributesTableHook\r\n  @memberOf nsGmx\r\n  @param {String} hookID ID хука для удаления\r\n*/\r\nnsGmx.removeAttributesTableHook = function(hookID) {\r\n    window._attrsTableHash.removeHook(hookID);\r\n};\r\n\r\n})();\r\n","import nsGmx from '../nsGmx.js';\r\nimport {\r\n    attachEffects,\r\n    inputError,\r\n    parseResponse,\r\n    sendCrossDomainJSONRequest,\r\n    sendCrossDomainPostRequest,\r\n    showDialog,\r\n} from '../utilities.js';\r\nimport '../translations.js';\r\nimport './security.css';\r\n\r\n(function() {\r\n\r\n'use strict';\r\n\r\n// var SHARE_TYPES = ['public', 'private'];\r\n\r\nnsGmx.Translations.addText('rus', {security: {\r\n    ownerName: 'Владелец',\r\n    defAccess: 'Доступ для всех',\r\n    access: {\r\n        empty: ' ',\r\n        no: 'нет доступа',\r\n        view: 'просмотр',\r\n        linkview: 'просмотр по ссылке',\r\n        edit: 'редактирование',\r\n        editrows: 'редактирование объектов',\r\n        preview: 'предпросмотр'\r\n    },\r\n    share: {\r\n        'public': 'публичный',\r\n        'private': 'частный'\r\n    },\r\n    addHeaderLabel: 'Введите пользователя или группу',\r\n    addOkText: 'Добавить',\r\n    select: {\r\n        'selectedLayers': 'Выделено слоев для назначения прав: '\r\n    }\r\n}});\r\n\r\nnsGmx.Translations.addText('eng', {security: {\r\n    ownerName: 'Owner',\r\n    defAccess: 'Public access',\r\n    access: {\r\n        empty: ' ',\r\n        no: 'no access',\r\n        view: 'view only',\r\n        linkview: 'direct link view only',\r\n        edit: 'edit',\r\n        editrows: 'edit objects',\r\n        preview: 'preview'\r\n    },\r\n    share: {\r\n        'public': 'public',\r\n        'private': 'private'\r\n    },\r\n    addHeaderLabel: 'Enter user or group',\r\n    addOkText: 'Add',\r\n    select: {\r\n        'selectedLayers': 'Selected'\r\n    }\r\n}});\r\n\r\nvar usersHash = {};\r\n\r\nvar currentSelectedItem = null;\r\n\r\nvar autocompleteLabelTemplate = Handlebars.compile(\r\n    '<a class=\"security-autocomplete-item\">' +\r\n    '{{#if showIcon}}<span class=\"{{#if IsGroup}}security-group-icon{{else}}security-user-icon{{/if}}\"></span>{{/if}}' +\r\n        '<span>{{Nickname}}{{#if Login}}\\u00A0({{Login}}){{/if}}</span>' +\r\n    '</a>'\r\n);\r\n\r\n//на input вешается autocomplete со списком пользователей.\r\n//кроме того, по нажатию enter происходит генерация события enterpress\r\nvar wrapUserListInput = function(input, options) {\r\n    input.on('keydown', function(event) {\r\n        if (event.keyCode === 13) {\r\n            //setTimeout нужен чтобы autocomplete не дописывал выбранное значение в input после того, как мы его очистим\r\n            setTimeout(function() {\r\n                $(this).trigger('enterpress');\r\n            }.bind(this), 0);\r\n        }\r\n    });\r\n    input.autocomplete({\r\n        source: function(request, cbResponse) {\r\n            security.findUsers(request.term, {maxRecords: 7, type: options && options.type}).then(function(userInfos) {\r\n                cbResponse(userInfos.map(function(userInfo) {                    \r\n                    usersHash[userInfo.Nickname] = userInfo;\r\n                    return {login: userInfo.Login, value: userInfo.Nickname, label: '', isGroup: userInfo.IsGroup};\r\n                }));\r\n            }, cbResponse.bind(null, []));\r\n        },\r\n        select: function( event, ui ) {\r\n            currentSelectedItem = ui.item;\r\n        }\r\n    });\r\n\r\n    $(input).data(\"ui-autocomplete\")._renderItem = function(ul, item) {\r\n        // var isGroup = item.isGroup,\r\n        var userInfo = usersHash[item.value],\r\n            templateParams = $.extend({showIcon: options && options.showIcon}, userInfo);\r\n        return $('<li></li>')\r\n            .append($(autocompleteLabelTemplate(templateParams)))\r\n            .appendTo(ul);\r\n    }\r\n}\r\n\r\nvar SecurityOwnerWidget = function(securityInfo, container) {\r\n    var ui = $(SecurityOwnerWidget._template({\r\n        ownerName: securityInfo.Owner\r\n    })).appendTo(container);\r\n\r\n    $('.security-owner-cancel', ui).click(function() {\r\n        $('.changeOwnerLink', ui).click();\r\n    });\r\n\r\n    $('.changeOwnerLink', ui).click(function() {\r\n        $(this).toggle();\r\n        $('.security-owner-container', ui).toggle();\r\n        $('.security-owner-input', ui).val('').focus();\r\n    });\r\n\r\n    var ownerAddInput = $('.security-owner-input', ui);\r\n    ownerAddInput.on('enterpress', function() {\r\n        $('.security-owner-ok', ui).click();\r\n    });\r\n\r\n    wrapUserListInput(ownerAddInput, {type: 'User'});\r\n\r\n    $('.security-owner-ok', ui).click(function() {\r\n        var input = $('.security-owner-input', ui),\r\n            name = input.val();\r\n\r\n        var doChangeUser = function(user) {\r\n            $('.changeOwnerLink', ui).text(user.Nickname);\r\n            securityInfo.NewOwnerID = user.UserID;\r\n            $('.changeOwnerLink', ui).click();\r\n        }\r\n\r\n        if (name in usersHash) {\r\n            doChangeUser(usersHash[name]);\r\n        } else {\r\n            security.findUsers(name, {maxRecords: 1}).then(function(userInfos) {\r\n                if (userInfos[0] && userInfos[0].Nickname.toLowerCase() === name.toLowerCase()) {\r\n                    doChangeUser(userInfos[0]);\r\n                } else {\r\n                    inputError(input[0]);\r\n                }\r\n            }, inputError.bind(null, input[0]));\r\n        }\r\n    });\r\n}\r\n\r\nSecurityOwnerWidget._template = Handlebars.compile(\r\n    '<div class = security-owner>' +\r\n        '<span>{{i \"security.ownerName\"}}: </span>' +\r\n        '<span class=\"buttonLink changeOwnerLink security-owner-change\">{{ownerName}}</span>' +\r\n        '<div class=\"security-owner-container ui-front\" style=\"display:none\">' +\r\n            '<input class=\"security-owner-input inputStyle\">' +\r\n            '<button class=\"security-owner-ok\">Сменить</button>' +\r\n            '<button class=\"security-owner-cancel\">Отмена</button>' +\r\n        '</div>' +\r\n    '</div>');\r\n\r\n// @param {String[]} options.accessTypes массив прав доступа\r\nvar SecurityUserListWidget = function(securityInfo, container, options) {\r\n    var _this = this;\r\n\r\n    this.options = options;\r\n\r\n    var ui = $(SecurityUserListWidget._template()).appendTo(container);\r\n\r\n    var sortFuncs = {};\r\n\r\n    var genSortFunction = function(field)\r\n    {\r\n        return [\r\n            function(a,b){if (a[field] > b[field]) return 1; else if (a[field] < b[field]) return -1; else return 0},\r\n            function(a,b){if (a[field] < b[field]) return 1; else if (a[field] > b[field]) return -1; else return 0}\r\n        ];\r\n    }\r\n\r\n    sortFuncs[_gtxt('Псевдоним')]  = genSortFunction('Nickname');\r\n    sortFuncs[_gtxt('Полное имя')] = genSortFunction('FullName');\r\n    sortFuncs[_gtxt('Доступ')]     = genSortFunction('Access');\r\n\r\n    var fieldNames   = [_gtxt(\"Псевдоним\"), _gtxt(\"Полное имя\"), /*_gtxt(\"Роль\"),*/ _gtxt(\"Доступ\"), \"\"];\r\n    var fieldWidthes = ['35%', '35%', '25%','5%'];\r\n\r\n    this._securityTable = new nsGmx.ScrollTable({limit: 500, showFooter: false});\r\n    this.securityUsersProvider = new nsGmx.ScrollTable.StaticDataProvider();\r\n\r\n    this.securityUsersProvider.setSortFunctions(sortFuncs);\r\n    this._securityTable.setDataProvider(this.securityUsersProvider);\r\n    this._securityTable.createTable($('.access-table-placeholder', ui)[0], 'securityTable', 0, fieldNames, fieldWidthes, function(arg){\r\n        return SecurityUserListWidget._drawMapUsers.call(this, arg, _this);\r\n    }, sortFuncs);\r\n\r\n    var addInput = $('.security-add-input', ui);\r\n    addInput.on('enterpress', function() {\r\n        $('.security-add-ok', ui).click();\r\n    })\r\n    wrapUserListInput(addInput, {showIcon: true});\r\n\r\n    $('.security-add-ok', ui).click(function() {\r\n        var input = $('.security-add-input', ui),\r\n            name = input.val();\r\n\r\n        var isEmail = name.indexOf('@') !== -1,\r\n    \t\tsearchObj = isEmail ? {Login: name} : {Nickname: name};\r\n\r\n        var addedUsers = _this.securityUsersProvider.getOriginalItems();\r\n\r\n        if (currentSelectedItem) {\r\n            if (currentSelectedItem.isGroup) {\r\n                searchObj = {\r\n                    Nickname: currentSelectedItem.value\r\n                };\r\n            } else {\r\n                searchObj = {\r\n                    Login: currentSelectedItem.login,\r\n                    Nickname: currentSelectedItem.value\r\n                };\r\n            }\r\n        }\r\n\r\n        if (_.findWhere(addedUsers, searchObj)) {\r\n            inputError(input[0]);\r\n            return;\r\n        }\r\n\r\n        var doAddUser = function(user) {\r\n            _this._addMapUser(user);\r\n            input.val('').focus();\r\n            currentSelectedItem = null;\r\n        }\r\n\r\n        if (name in usersHash) {\r\n            doAddUser(usersHash[name]);\r\n        } else {\r\n            security.findUsers(name).then(function(userInfos) {\r\n                var curUserInfo;\r\n\r\n\t\t\t\tif (currentSelectedItem) {\r\n\t\t\t\t\tcurUserInfo = userInfos.filter(function (ui) {return ui.Login === searchObj.Login})\r\n\t\t\t\t\tif (curUserInfo[0]) doAddUser(curUserInfo[0]);\r\n\t\t\t\t} else {\r\n                    var isEmail = name.indexOf('@') !== -1;\r\n\r\n                    if (isEmail) {\r\n                        if (userInfos[0] && userInfos[0].Login.toLowerCase() === name.toLowerCase()) {\r\n                            doAddUser(userInfos[0]);\r\n                        } else {\r\n                            inputError(input[0]);\r\n                        }\r\n                    } else if (userInfos[0] && userInfos[0].Nickname.toLowerCase() === name.toLowerCase()) {\r\n                        doAddUser(userInfos[0]);\r\n                    } else {\r\n                        inputError(input[0]);\r\n                    }                    \r\n                }\r\n\r\n            }, inputError.bind(null, input[0]));\r\n        }\r\n    });\r\n\r\n    this.securityUsersProvider.setOriginalItems( securityInfo.Users );\r\n}\r\n\r\nSecurityUserListWidget.DEFAULT_ACCESS = 'view';\r\n\r\nSecurityUserListWidget.prototype._addMapUser = function(user) {\r\n    var existedUser = $.extend( {Access: SecurityUserListWidget.DEFAULT_ACCESS}, user );\r\n    this.securityUsersProvider.addOriginalItem(existedUser);\r\n}\r\n\r\nSecurityUserListWidget.prototype.updateHeight = function(height) {\r\n    this._securityTable.updateHeight(height);\r\n}\r\n\r\nSecurityUserListWidget._userRowTemplate = Handlebars.compile(\r\n    '<tr>' +\r\n        '<td class=\"security-row-nickname\">' +\r\n            '<span class=\"{{#if IsGroup}}security-group-icon{{else}}security-user-icon{{/if}}\"></span>' +\r\n            '<span title=\"{{Nickname}}\">{{Nickname}}</span>' +\r\n        '</td>' +\r\n        '<td><div class=\"security-row-fullname\" title=\"{{Fullname}}\">{{Fullname}}</div></td>' +\r\n        '<td><select class=\"selectStyle security-row-access\">{{#access}}' +\r\n            '<option value = \"{{value}}\"{{#if selected}} selected{{/if}}>{{title}}</option>' +\r\n        '{{/access}}</select></td>' +\r\n        '<td class=\"security-row-remove-cell\"><div class=\"gmx-icon-recycle\"></div></td>' +\r\n    '</tr>'\r\n);\r\n\r\nSecurityUserListWidget._drawMapUsers = function(user, securityScope)\r\n{\r\n    var ui = $(SecurityUserListWidget._userRowTemplate({\r\n        Nickname: user.Nickname,\r\n        Fullname: user[user.IsGroup ? 'Description' : 'FullName'],\r\n        IsGroup: user.IsGroup,\r\n        access: securityScope.options.accessTypes\r\n            .filter(function(type) {return type !== 'no';})\r\n            .map(function(type) {\r\n                return {\r\n                    title: _gtxt('security.access.' + type),\r\n                    value: type,\r\n                    selected: type === user.Access\r\n                }\r\n            })\r\n    }));\r\n\r\n    var tr = ui[0];\r\n\r\n    ui.find('.gmx-icon-recycle').click(function() {\r\n        // уберем пользователя из списка\r\n        securityScope.securityUsersProvider.filterOriginalItems(function(elem) {\r\n            return elem.UserID !== user.UserID;\r\n        });\r\n    });\r\n\r\n    ui.find('.security-row-access').change(function() {\r\n        user.Access = this.value;\r\n    });\r\n\r\n    for (var i = 0; i < tr.childNodes.length; i++)\r\n        tr.childNodes[i].style.width = this._fields[i].width;\r\n\r\n    attachEffects(tr, 'hover');\r\n\r\n    return tr;\r\n}\r\n\r\nSecurityUserListWidget._template = Handlebars.compile(\r\n    '<div class = \"security-userlist\">' +\r\n        '<div class=\"security-add-container ui-front\">' +\r\n            '<span class=\"security-access-label\">{{i \"security.addHeaderLabel\"}}: </span>' +\r\n            '<input class=\"security-add-input inputStyle\">' +\r\n            '<button class=\"security-add-ok\">{{i \"security.addOkText\"}}</button>' +\r\n        '</div>' +\r\n        '<div class=\"access-table-placeholder\"></div>' +\r\n    '</div>');\r\n\r\n\r\nvar security = function()\r\n{\r\n    this.mapTypeSel = null;\r\n    this.mapAccessSel = null;\r\n\r\n    this.defaultAccess = null;\r\n\r\n    this.getSecurityName = null;\r\n    this.updateSecurityName = null;\r\n\r\n    this.propertyValue = null;\r\n    this.title = null;\r\n}\r\n\r\nvar mapSecurity = function()\r\n{\r\n    this.getSecurityName = \"Map/GetSecurity.ashx\";\r\n    this.updateSecurityName = \"Map/UpdateSecurity.ashx\";\r\n\r\n    this.propertyName = \"MapID\";\r\n    this.dialogTitle = \"Редактирование прав доступа карты [value0]\";\r\n\r\n    this.accessTypes = ['no', 'view', 'linkview', 'edit'];\r\n}\r\n\r\nmapSecurity.prototype = new security();\r\nmapSecurity.prototype.constructor = mapSecurity;\r\n\r\nvar layerSecurity = function(layerName)\r\n{\r\n    var layer = nsGmx.gmxMap.layersByID[layerName],\r\n        props = layer.getGmxProperties && layer.getGmxProperties();\r\n\r\n    if (!props) {\r\n        return;\r\n    }\r\n\r\n    this.getSecurityName = \"Layer/GetSecurity.ashx\";\r\n    this.updateSecurityName = \"Layer/UpdateSecurity.ashx\";\r\n\r\n    this.propertyName = \"LayerID\";\r\n    this.dialogTitle = \"Редактирование прав доступа слоя [value0]\";\r\n\r\n    var layerType = props.type;\r\n\r\n    if (layerType === 'Raster') {\r\n        this.accessTypes = ['no', 'preview', 'view', 'edit'];\r\n    } else if (layerType === 'Vector') {\r\n        if (props.IsRasterCatalog) {\r\n            this.accessTypes = ['no', 'preview', 'view', 'editrows', 'edit'];\r\n        } else {\r\n            this.accessTypes = ['no', 'view', 'editrows', 'edit'];\r\n        }\r\n    }\r\n}\r\n\r\nlayerSecurity.prototype = new security();\r\nlayerSecurity.prototype.constructor = layerSecurity;\r\n\r\nvar multiLayerSecurity = function()\r\n{\r\n    this.getSecurityName = 'MultiLayer/GetSecurity.ashx';\r\n    this.updateSecurityName = 'MultiLayer/UpdateSecurity.ashx';\r\n\r\n    this.propertyName = 'MultiLayerID';\r\n    this.dialogTitle = 'Редактирование прав доступа слоя [value0]';\r\n\r\n    this.accessTypes = ['no', 'view', 'edit'];\r\n}\r\n\r\nmultiLayerSecurity.prototype = new security();\r\nmultiLayerSecurity.prototype.constructor = multiLayerSecurity;\r\n\r\nvar layersGroupSecurity = function()\r\n{\r\n    this.getSecurityName = 'Map/GetSecurity.ashx';\r\n    this.getGroupSecurityName = 'Layer/GetSecurity.ashx';\r\n    this.updateSecurityName = 'Layer/LayersGroupUpdateSecurity';\r\n\r\n    this.propertyName = 'MapID';\r\n    this.groupPropertyName = 'Layers';\r\n\r\n    this.mapLayers = [];\r\n    this.mapLayersSecurityArray = [];\r\n    this.selectedLayersSecurityArray = [];\r\n    this.originalItems = [];\r\n\r\n    this.dialogTitle = 'Редактирование прав доступа слоев карты [value0]';\r\n\r\n    this.accessTypes = ['no', 'view', 'edit'];\r\n}\r\n\r\nlayersGroupSecurity.prototype = new security();\r\nlayersGroupSecurity.prototype.constructor = layersGroupSecurity;\r\n\r\nsecurity.prototype.getSecurityFromServer = function(id) {\r\n    var def = $.Deferred();\r\n\r\n    sendCrossDomainJSONRequest(window.serverBase + this.getSecurityName + '?WrapStyle=func&IncludeAdmin=true&' + this.propertyName + '=' + id, function(response)\r\n    {\r\n        if (!parseResponse(response)) {\r\n            def.reject(response);\r\n            return;\r\n        }\r\n        def.resolve(response.Result);\r\n    })\r\n\r\n    return def;\r\n}\r\n\r\n// запрос security группы слоев\r\nsecurity.prototype.getGroupSecurityFromServer = function(postParams) {\r\n    var def = $.Deferred();\r\n\r\n    sendCrossDomainPostRequest(window.serverBase + this.getGroupSecurityName, postParams, function(response) {\r\n        if (!parseResponse(response)) {\r\n            def.reject(response);\r\n            return;\r\n        }\r\n        def.resolve(response.Result);\r\n    })\r\n\r\n    return def;\r\n}\r\n\r\nsecurity.prototype.getRights = function(value, title)\r\n{\r\n    // var _this = this;\r\n\r\n    this.propertyValue = value;\r\n    this.title = title;\r\n\r\n    this.getSecurityFromServer(value).then(this.createSecurityDialog.bind(this));\r\n}\r\n\r\n//ф-ция выделена из-за различий между диалогами прав слоёв и диалога состава группы\r\nsecurity.prototype.addCustomUI = function(ui, securityInfo) {\r\n    var defAccessTemplate = Handlebars.compile(\r\n        '<div class=\"security-def-access\">{{i \"security.defAccess\"}}: ' +\r\n            '<select class=\"security-defaccess-select selectStyle\">' +\r\n                '{{#defAccessTypes}}' +\r\n                    '<option value=\"{{value}}\"{{#isSelected}} selected{{/isSelected}}>{{title}}</option>' +\r\n                '{{/defAccessTypes}}' +\r\n            '</select>' +\r\n        '</div>'\r\n    );\r\n\r\n    $(defAccessTemplate({\r\n        defAccessTypes: this.accessTypes.map(function(type) {\r\n            return {\r\n                value: type,\r\n                title: _gtxt('security.access.' + type),\r\n                isSelected: type === securityInfo.SecurityInfo.DefAccess\r\n            };\r\n        })\r\n    })).appendTo(ui.find('.security-custom-ui'));\r\n}\r\n\r\n//ф-ция выделена из-за различий между диалогами прав слоёв и диалога состава группы\r\nsecurity.prototype.saveCustomParams = function() {\r\n    this._securityInfo.SecurityInfo.DefAccess = this._ui.find('.security-defaccess-select').val();\r\n}\r\n\r\nsecurity.prototype._save = function() {\r\n    var si = this._securityInfo;\r\n    si.SecurityInfo.Users = this.securityUserListWidget.securityUsersProvider.getOriginalItems();\r\n\r\n    nsGmx.widgets.notifications.startAction('securitySave');\r\n    var postParams = {WrapStyle: 'window'};\r\n\r\n    if (this.saveCustomParams()) {\r\n        return;\r\n    }\r\n\r\n    postParams.SecurityInfo = JSON.stringify(si.SecurityInfo);\r\n\r\n    postParams[this.propertyName] = this.propertyValue;\r\n    sendCrossDomainPostRequest(window.serverBase + this.updateSecurityName, postParams, function(response) {\r\n        if (!parseResponse(response)) {\r\n            nsGmx.widgets.notifications.stopAction('securitySave');\r\n            return;\r\n        }\r\n\r\n        nsGmx.widgets.notifications.stopAction('securitySave', 'success', _gtxt('Сохранено'));\r\n\r\n        $(this).trigger('savedone', si);\r\n    })\r\n}\r\n\r\nsecurity.prototype.createSecurityDialog = function(securityInfo, options)\r\n{\r\n    options = $.extend({showOwner: true}, options);\r\n    var _this = this;\r\n\r\n    this._securityInfo = securityInfo;\r\n\r\n    var uiTemplate = '<div id=\"securityDialog\" class=\"security-canvas\">' +\r\n        '<div class=\"security-header\">' +\r\n            '<button class=\"security-save\">{{i \"Сохранить\"}}</button>' +\r\n                '{{#if showOwner}}<div class=\"security-owner-placeholder\"></div>{{/if}}' +\r\n        '</div>' +\r\n\r\n        '<div class=\"security-custom-ui\"></div>' +\r\n\r\n        '<div class=\"security-userlist-placeholder\"></div>' +\r\n    '</div>';\r\n\r\n    var canvas = this._ui = $(Handlebars.compile(uiTemplate)({\r\n        showOwner: options.showOwner\r\n    }));\r\n\r\n    this.addCustomUI(canvas, securityInfo);\r\n\r\n    $('.security-save', canvas).click(function(){\r\n        _this._save();\r\n    });\r\n\r\n    if (options.showOwner) {\r\n        new SecurityOwnerWidget(securityInfo.SecurityInfo, $('.security-owner-placeholder', canvas));\r\n    }\r\n\r\n    this.securityUserListWidget = new SecurityUserListWidget(securityInfo.SecurityInfo, $('.security-userlist-placeholder', canvas), {accessTypes: this.accessTypes});\r\n\r\n    var resize = function()\r\n    {\r\n        var mapTableHeight;\r\n        // var dialogWidth = canvas[0].parentNode.parentNode.offsetWidth;\r\n\r\n        var nonTableHeight =\r\n            $('.security-header', canvas).height() +\r\n            $('.security-custom-ui', canvas).height() +\r\n            $('.security-add-container', canvas).height() + 15;\r\n\r\n        mapTableHeight = canvas[0].parentNode.offsetHeight - nonTableHeight - 10;\r\n\r\n        _this.securityUserListWidget.updateHeight(mapTableHeight);\r\n    }\r\n\r\n    this._dialogDiv = showDialog(_gtxt(this.dialogTitle, this.title), canvas[0], 571, 370, false, false, resize);\r\n\r\n    resize();\r\n}\r\n\r\n//делает запрос на сервер и возвращает список пользователей по запросу query\r\n//options = {maxRecords, type}; type: All / User / Group\r\nsecurity.findUsers = function(query, options) {\r\n    var def = new L.gmx.Deferred();\r\n    var maxRecordsParamStr = options && options.maxRecords ? '&maxRecords=' + options.maxRecords : '';\r\n    var typeParamStr = '&type=' + (options && options.type || 'All');\r\n    sendCrossDomainJSONRequest(window.serverBase + 'User/FindUser?query=' + encodeURIComponent(query) + maxRecordsParamStr + typeParamStr, function(response) {\r\n        if (!parseResponse(response)) {\r\n            def.reject(response);\r\n            return;\r\n        }\r\n\r\n        def.resolve(response.Result);\r\n    })\r\n\r\n    return def;\r\n}\r\n\r\n\r\nlayersGroupSecurity.prototype._save = function(originalItems) {\r\n    var _this = this;\r\n\r\n    if (!_this.selectedLayersSecurityArray.length) {\r\n        return;\r\n    }\r\n\r\n    var si = _this._securityInfo,\r\n        addedUsers = _this.securityUserListWidget.securityUsersProvider.getOriginalItems();\r\n\r\n    si.SecurityInfo = {\r\n        // Users: [],\r\n        UsersAdd: addedUsers,\r\n        UsersRemove: findRemovedUsers(originalItems, addedUsers)\r\n    };\r\n\r\n    nsGmx.widgets.notifications.startAction('securitySave');\r\n    var postParams = {WrapStyle: 'window'};\r\n\r\n    if (this.saveCustomParams()) {                                              // DefAccess: ''\r\n        return;\r\n    }\r\n\r\n    postParams.SecurityInfo = JSON.stringify(si.SecurityInfo);\r\n\r\n    postParams[this.groupPropertyName] = this.propertyValue;                    // Layers: {}\r\n\r\n    sendCrossDomainPostRequest(window.serverBase + this.updateSecurityName, postParams, function(response) {\r\n        if (!parseResponse(response)) {\r\n            nsGmx.widgets.notifications.stopAction('securitySave');\r\n            return;\r\n        }\r\n        originalItems = [];\r\n        for (var i = 0; i < addedUsers.length; i++) {\r\n            originalItems[i] = addedUsers[i];\r\n        }\r\n        // обновляем перечень общих пользователей\r\n        _this.originalItems = originalItems;\r\n\r\n        // обновляем права всех выделенных слоев\r\n        updateselectedLayersSecurity(_this.selectedLayersSecurityArray);\r\n\r\n        nsGmx.widgets.notifications.stopAction('securitySave', 'success', _gtxt('Сохранено'));\r\n        $(this).trigger('savedone', si);\r\n    })\r\n\r\n    // обновляет массив выделенных слоев с правами после нажатия кнопки \"сохранить\",\r\n    // затем обновляет массив всех слоев\r\n    function updateselectedLayersSecurity(array) {\r\n        var postParams = {\r\n            WrapStyle: 'window',\r\n            Layers: array.map(function(obj) {\r\n                return obj.ID;\r\n            })\r\n        };\r\n\r\n        _this.getGroupSecurityFromServer(postParams).then(updateSecurity);\r\n    }\r\n    // обновляет права на слои\r\n\r\n    function updateSecurity(res) {\r\n        var array = _this.selectedLayersSecurityArray;\r\n        for (var i = 0; i < array.length; i++) {\r\n            for (var j = 0; j < res.length; j++) {\r\n                if (array[i].ID === res[j].ID) {\r\n                    var options = {\r\n                        type: array[i].type,\r\n                        multiLayer: !!array[i].MultiLayerID\r\n                    }\r\n                    array.splice(i, 1, $.extend(res[j], options));\r\n                }\r\n            }\r\n        }\r\n\r\n        for (var k = 0; k < array.length; k++) {\r\n            for (var l = 0; l < _this.mapLayersSecurityArray.length; l++) {\r\n                if (array[k].ID === _this.mapLayersSecurityArray[l].ID) {\r\n                    _this.mapLayersSecurityArray.splice(l, 1, array[k])\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // возвращает массив удаленных пользователей\r\n    function findRemovedUsers(original, changed) {\r\n        return _.difference(original, changed);\r\n    }\r\n}\r\n\r\n// кастомный интерфейс - виджет группового редактирования слоев карты\r\nlayersGroupSecurity.prototype.createSecurityDialog = function(securityInfo, options)\r\n{\r\n    var _this = this,\r\n        selectedLayersSecurityArray = this.selectedLayersSecurityArray;\r\n\r\n    options = $.extend({showOwner: true}, options);\r\n    this._securityInfo = securityInfo;\r\n\r\n    var uiTemplate = '<div id=\"securityDialog\" class=\"security-canvas\">' +\r\n        '<div class=\"security-header\">' +\r\n            '<button class=\"security-save\">{{i \"Сохранить\"}}</button>' +\r\n                '{{#if showOwner}}<div class=\"security-owner-placeholder\"></div>{{/if}}' +\r\n        '</div>' +\r\n        '<div class=\"security-custom-ui\"></div>' +\r\n        '<div class=\"security-counter\"></div>' +\r\n        '<div class=\"security-default-access\"></div>' +\r\n\r\n        '<div class=\"security-userlist-placeholder\"></div>' +\r\n\r\n    '</div>';\r\n\r\n    var canvas = this._ui = $(Handlebars.compile(uiTemplate)({\r\n        showOwner: options.showOwner\r\n    }));\r\n\r\n    this.addCustomUI(canvas, resize);\r\n\r\n    $('.security-save', canvas).click(function(){\r\n        if (_this.groupPropertyName) {\r\n            _this.propertyValue = selectedLayersSecurityArray.map(function(item){\r\n                return item.ID;\r\n            });\r\n        }\r\n        _this._save(_this.originalItems);\r\n    });\r\n\r\n    if (options.showOwner) {\r\n        new SecurityOwnerWidget(securityInfo.SecurityInfo, $('.security-owner-placeholder', canvas));\r\n    }\r\n\r\n    this._dialogDiv = showDialog(_gtxt(this.dialogTitle, this.title), canvas[0], 571, 455, false, false, resize);\r\n    function resize()\r\n    {\r\n        var mapTableHeight,\r\n            nonTableHeight =\r\n            $('.security-header', canvas).height() +\r\n            $('.security-custom-ui', canvas).height() +\r\n            $('.security-counter', canvas).height() +\r\n            $('.security-default-access', canvas).height() +\r\n            $('.security-add-container', canvas).height() + 25;\r\n\r\n        mapTableHeight = canvas[0].parentNode.offsetHeight - nonTableHeight - 10;\r\n        if (_this.securityUserListWidget) {\r\n            _this.securityUserListWidget.updateHeight(mapTableHeight);\r\n        }\r\n    }\r\n\r\n    resize();\r\n}\r\n\r\n// кастомный интерфейс - отдельная функция - дерево слоев для виджета группового редактирования слоев\r\nlayersGroupSecurity.prototype.addCustomUI = function(ui, resizeFunc) {\r\n    var _this = this,\r\n        mapLayers = _this.mapLayers,\r\n        mapLayersSecurityArray = _this.mapLayersSecurityArray,\r\n        selectedLayersSecurityArray = _this.selectedLayersSecurityArray,\r\n        counter = 0,\r\n        actualCounter = {counter: counter},\r\n        countDiv = $('.security-counter', ui),\r\n        countTemplate = Handlebars.compile(\r\n            '<table class=\"security-count-table\">' +\r\n                '<tbody>' +\r\n                    '<tr>' +\r\n                        '<td>{{i \"security.select.selectedLayers\"}}</td>' +\r\n                        '<td>{{counter}}</td>' +\r\n                    '</tr>' +\r\n                '</tbody>' +\r\n            '</table>'\r\n        ),\r\n        templateSecurityInfo = {\r\n            Users: []\r\n        },\r\n        tree,\r\n        rawTree,\r\n        drawnTree,\r\n        defAccessDiv = $('.security-default-access', ui),\r\n        defAccessTemplate = Handlebars.compile(\r\n            '<div class=\"security-def-access\">{{i \"security.defAccess\"}}: ' +\r\n                '<select class=\"security-defaccess-select selectStyle\">' +\r\n                    '{{#defAccessTypes}}' +\r\n                        '<option value=\"{{value}}\"{{#isSelected}} selected{{/isSelected}}>{{title}}</option>' +\r\n                    '{{/defAccessTypes}}' +\r\n                '</select>' +\r\n            '</div>'\r\n        ),\r\n        userList = $('.security-userlist-placeholder', ui),\r\n        getMapLayersRights = function (callback) {\r\n            var postParams = {\r\n                WrapStyle: 'window',\r\n                Layers: mapLayers.map(function(layer){\r\n                    return layer.LayerID || layer.MultiLayerID;\r\n                })\r\n            };\r\n            _this.getGroupSecurityFromServer(postParams).then(callback);\r\n        },\r\n\r\n        // сохраняем права слоев карты\r\n        saveMapLayersRights = function (res) {\r\n            for (var i = 0; i < res.length; i++) {\r\n                for (var j = 0; j < mapLayers.length; j++) {\r\n                    if (res[i].ID === mapLayers[j].LayerID || res[i].ID === mapLayers[j].MultiLayerID) {\r\n                        var options = {\r\n                            type: mapLayers[j].type,\r\n                            multiLayer: !!mapLayers[j].MultiLayerID\r\n                        };\r\n                        mapLayersSecurityArray.push($.extend(res[i], options));\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n    // модификация исходного дерева - остаются только слои с правами на редактирование\r\n    rawTree = window._layersTree.treeModel.cloneRawTree(function(node) {\r\n        var props = node.content.properties;\r\n        props.visible = false;\r\n        if (node.type === 'layer') {\r\n            if (props.Access !== 'edit') {\r\n                return null;\r\n            }\r\n            mapLayers.push(props);\r\n            return node;\r\n        }\r\n        if (node.type === 'group') {\r\n            var children = node.content.children;\r\n            if (!children.length) {\r\n                return null;\r\n            }\r\n            return node;\r\n        }\r\n    });\r\n\r\n    // создание дерева слоев\r\n    tree = new window.layersTree({\r\n        showVisibilityCheckbox: true,\r\n        allowActive: true,\r\n        allowDblClick: false,\r\n        showStyle: false,\r\n\r\n        // обработка различных вариаций прав в группе слоев\r\n        // если выделен один слой, рисуются его права\r\n        // если у выделенных слоев есть юзеры с одинаковыми правами, то рисуются только эти юзеры\r\n        // если у выделенных слоев разные права, рисуется пустой диалог\r\n        // если у выделенных слоев разные дефолтные права, в выпадающий список выбора дефолтных прав проставляется пустое поле\r\n        visibilityFunc: function(props, isVisible) {\r\n            if (isVisible) {\r\n                counter++;\r\n                for (let i = 0; i < mapLayersSecurityArray.length; i++) {\r\n                    if (mapLayersSecurityArray[i].ID === props.LayerID || mapLayersSecurityArray[i].ID === props.MultiLayerID) {\r\n                        selectedLayersSecurityArray.push(mapLayersSecurityArray[i]);\r\n                    }\r\n                }\r\n                addLayer();\r\n            }\r\n\r\n            if (!isVisible) {\r\n                counter--;\r\n                for (let i = 0; i < selectedLayersSecurityArray.length; i++) {\r\n                    if (selectedLayersSecurityArray[i].ID === props.LayerID || selectedLayersSecurityArray[i].ID === props.MultiLayerID) {\r\n                        selectedLayersSecurityArray.splice(i, 1);\r\n                    }\r\n                }\r\n                removeLayer();\r\n            }\r\n\r\n            // показываем счетчик выделенных слоев под деревом\r\n            actualCounter.counter = counter;\r\n            $(countDiv).html(countTemplate(actualCounter));\r\n\r\n            // добавляет слой в дерево слоев\r\n            function addLayer() {\r\n                drawAccess();\r\n                resizeFunc();\r\n            }\r\n\r\n            // убирает слой из дерева слоев\r\n            function removeLayer() {\r\n                if (counter > 0 && selectedLayersSecurityArray.length) {\r\n                    drawAccess();\r\n                } else {\r\n                    $(defAccessDiv).empty();\r\n                        userList.empty();\r\n                }\r\n                resizeFunc();\r\n            }\r\n\r\n            // рисует оба виджета - доступа по умолчанию и списка пользователей для каждого слоя\r\n            function drawAccess() {\r\n                drawDefaultAccess(selectedLayersSecurityArray, defAccessDiv);\r\n                drawUsersList(selectedLayersSecurityArray, userList);\r\n            }\r\n\r\n            // рисует доступ по умолчанию\r\n            function drawDefaultAccess(array, container) {\r\n                var accessTypes,\r\n                    defTemplateJSON;\r\n\r\n                if (checkSameLayersType(array)) {\r\n                    accessTypes = getAccessTypes(array[0].type);\r\n                } else {\r\n                    accessTypes = ['no', 'preview', 'view', 'edit'];\r\n                }\r\n\r\n                defTemplateJSON = {\r\n                    defAccessTypes: accessTypes.map(function(type) {\r\n                        return {\r\n                            value: type,\r\n                            title: _gtxt('security.access.' + type),\r\n                            isSelected: undefined\r\n                        };\r\n                    })\r\n                };\r\n\r\n                $(container).empty();\r\n\r\n                // протавляем значение в выпадающем списке прав по умолчанию\r\n                if (checkSameDefaultAccess(array)) {\r\n                    var types = defTemplateJSON.defAccessTypes;\r\n                    for (var i = 0; i < types.length; i++) {\r\n                        if (types[i].value === array[0].SecurityInfo.DefAccess) {\r\n                            types[i].isSelected = true;\r\n                        }\r\n                    }\r\n                    $(defAccessTemplate(defTemplateJSON)).appendTo(ui.find('.security-default-access'));\r\n                } else {\r\n                    accessTypes.unshift('empty');\r\n                    defTemplateJSON = {\r\n                        defAccessTypes: accessTypes.map(function(type) {\r\n                            return {\r\n                                value: type,\r\n                                title: _gtxt('security.access.' + type),\r\n                                isSelected: type === 'empty'\r\n                            };\r\n                        })\r\n                    };\r\n                    $(defAccessTemplate(defTemplateJSON)).appendTo(ui.find('.security-default-access'));\r\n                }\r\n            }\r\n\r\n            // рисует список пользователей для каждого слоя\r\n            function drawUsersList(array, container) {\r\n                checkSameUsersAccess(array);\r\n                var accessTypes;\r\n\r\n                // запомним пересечения пользовательских прав для слоев,\r\n                // в случае удаления / добавления пользователей, последующее состояние будет сравниваться с этим\r\n                _this.originalItems = [];\r\n\r\n                if (templateSecurityInfo.Users.length) {\r\n                    accessTypes = getAccessTypes(array[0].type);\r\n\r\n                    for (var i = 0; i < templateSecurityInfo.Users.length; i++) {\r\n                        _this.originalItems.push(templateSecurityInfo.Users[i]);\r\n                    }\r\n                } else {\r\n                    accessTypes = ['no', 'preview', 'view', 'edit'];\r\n                }\r\n\r\n                container.empty();\r\n                _this.securityUserListWidget = new SecurityUserListWidget(templateSecurityInfo, container, {accessTypes: accessTypes});\r\n            }\r\n\r\n            // проверяет, совпадают ли дефолтные права для всех выделенных слоев\r\n            function checkSameDefaultAccess(array) {\r\n                var first = array[0].SecurityInfo.DefAccess;\r\n                return array.every(function(element) {\r\n                    return element.SecurityInfo.DefAccess === first;\r\n                });\r\n            }\r\n\r\n            // проверяет, совпадают ли отдельные права для всех выделенных слоев и создает массив пересечений\r\n            function checkSameUsersAccess(array) {\r\n                var userArray = array.map(function(obj){\r\n                    return obj.SecurityInfo.Users;\r\n                });\r\n\r\n                templateSecurityInfo.Users = findCommonUsers(userArray);\r\n\r\n                // нахождение одинаковых значений {пользователь: права} во всех слоях\r\n                function findCommonUsers(array) {\r\n                    var a = array.sort(sortArraysByLength),\r\n                        first = a[0];\r\n\r\n                    if (first.length) {\r\n                        for (var i = 1; i < a.length; i++) {\r\n                            first = first.filter(function (obj) {\r\n                                return a[i].find(function (obj2) {\r\n                                    return _.isEqual(obj, obj2)\r\n                                })\r\n                            })\r\n                        }\r\n                    } else {\r\n                        first = [];\r\n                    }\r\n                    return first;\r\n                }\r\n\r\n                // сортировка массивов пользователей по длине для оптимизации времени\r\n                function sortArraysByLength(a, b) {\r\n                    return a.length - b.length;\r\n                }\r\n            }\r\n\r\n            // проверяет, совпадают ли типы для всех выделенных слоев (вектор/растр)\r\n            function checkSameLayersType(array) {\r\n                var first = array[0].type;\r\n                return array.every(function(element) {\r\n                    return element.type === first;\r\n                });\r\n            }\r\n\r\n            function getAccessTypes(layerType) {\r\n                var accessTypes;\r\n                if (layerType === 'Raster') {\r\n                    accessTypes = ['no', 'preview', 'view', 'edit'];\r\n                } else if (layerType === 'Vector') {\r\n                    if (props.IsRasterCatalog) {\r\n                        accessTypes = ['no', 'preview', 'view', 'editrows', 'edit'];\r\n                    } else {\r\n                        accessTypes = ['no', 'view', 'editrows', 'edit'];\r\n                    }\r\n                }\r\n\r\n                return accessTypes;\r\n            }\r\n\r\n        }\r\n    });\r\n\r\n    drawnTree = tree.drawTree(rawTree, 2);\r\n\r\n    getMapLayersRights(saveMapLayersRights);\r\n\r\n    $(drawnTree).treeview().appendTo(ui.find('.security-custom-ui'));\r\n    $(countDiv).html(countTemplate(actualCounter));\r\n\r\n}\r\n\r\nnsGmx.mapSecurity = mapSecurity;\r\nnsGmx.security = security;\r\nnsGmx.layerSecurity = layerSecurity;\r\nnsGmx.multiLayerSecurity = multiLayerSecurity;\r\nnsGmx.layersGroupSecurity = layersGroupSecurity;\r\n\r\n})();\r\n","import nsGmx from './nsGmx.js';\r\nimport {_div, hidden, getOffsetRect, showErrorMessage, getWindowWidth, getWindowHeight, sendCrossDomainJSONRequest, parseResponse, visible} from './utilities.js';\r\nimport './ClipboardController.js';\r\nimport './AsyncTaskManager.js';\r\nimport './AttrTable/AttrTable.js';\r\nimport './Security/security.js';\r\n\r\n(function() {\r\n//Контроллёр контектных меню и соответствующие пункты всех меню...\r\n/**\r\n* Контроллёр контекстных меню.\r\n* @class\r\n* @name ContextMenuController\r\n* @memberOf nsGmx\r\n*\r\n* @description Позволяет добавлять элементы контектсного меню разного типа и привязывать меню к отдельным DOM элементам.\r\n* Возможно динамическое создание меню при клике на объекте. Элементам меню передаётся контекст,\r\n* указанный при привязке меню к элементу (он так же может создаваться в момент клика на элементе)\r\n* Каждый элемент меню - отдельный объект, они независимо добавляются в контроллер.\r\n* При создании меню определённого типа из этого набора выбираются нужные элементы.\r\n*/\r\nnsGmx.ContextMenuController = (function()\r\n{\r\n\tvar _menuItems = {};\r\n\tvar SUGGEST_TIMEOUT = 700;\r\n\r\n\t// Показывает контектное меню для конкретного элемента.\r\n\t// В Opera меню показывается при наведении на элемент в течении некоторого времени, во всех остальных браузерах - по правому клику.\r\n\t// Меню исчезает при потере фокуса\r\n\t// Параметры:\r\n\t// * elem {DOMElement} - элемент, на который навешивается меню\r\n\t// * menuFunc {Function, menuFunc()->DomElement} - функция, создающая меню\r\n\t// * checkFunc {Function, checkFunc()->Bool} - если возвращает false, то ничего не показывается...\r\n\tvar _context = function(elem, menuFunc, checkFunc)\r\n\t{\r\n        var menu = null;\r\n        elem.oncontextmenu = function(e)\r\n        {\r\n            if (typeof checkFunc != 'undefined' && !checkFunc())\r\n                return false;\r\n\r\n            if (menu && menu.parentNode)\r\n                menu.parentNode.removeChild(menu);\r\n\r\n            menu = menuFunc();\r\n            if (!menu) return false;\r\n\r\n            var contextMenu = _div([menu],[['dir','className','contextMenu'], ['attr','id','contextMenuCanvas']])\r\n\r\n            var evt = e || window.event;\r\n\r\n            hidden(contextMenu);\r\n            document.body.appendChild(contextMenu)\r\n\r\n            // определение координат курсора для ie\r\n            if (evt.pageX == null && evt.clientX != null )\r\n            {\r\n                var html = document.documentElement\r\n                var body = document.body\r\n\r\n                evt.pageX = evt.clientX + (html && html.scrollLeft || body && body.scrollLeft || 0) - (html.clientLeft || 0)\r\n                evt.pageY = evt.clientY + (html && html.scrollTop || body && body.scrollTop || 0) - (html.clientTop || 0)\r\n            }\r\n\r\n            if (evt.pageX + contextMenu.clientWidth < getWindowWidth())\r\n                contextMenu.style.left = evt.pageX - 5 + 'px';\r\n            else\r\n                contextMenu.style.left = evt.pageX - contextMenu.clientWidth + 5 + 'px';\r\n\r\n            if (evt.pageY + contextMenu.clientHeight < getWindowHeight())\r\n                contextMenu.style.top = evt.pageY - 5 + 'px';\r\n            else\r\n                contextMenu.style.top = evt.pageY - contextMenu.clientHeight + 5 + 'px';\r\n\r\n            visible(contextMenu)\r\n\r\n            var menuArea = contextMenu.getBoundingClientRect();\r\n\r\n            contextMenu.onmouseout = function(e)\r\n            {\r\n                var evt = e || window.event;\r\n\r\n                // определение координат курсора для ie\r\n                if (evt.pageX == null && evt.clientX != null )\r\n                {\r\n                    var html = document.documentElement\r\n                    var body = document.body\r\n\r\n                    evt.pageX = evt.clientX + (html && html.scrollLeft || body && body.scrollLeft || 0) - (html.clientLeft || 0)\r\n                    evt.pageY = evt.clientY + (html && html.scrollTop || body && body.scrollTop || 0) - (html.clientTop || 0)\r\n                }\r\n\r\n                if (evt.pageX <= menuArea.left || evt.pageX >= menuArea.right ||\r\n                    evt.clientY <= menuArea.top || evt.clientY >= menuArea.bottom)\r\n                {\r\n                    menu = null;\r\n                    contextMenu.removeNode(true);\r\n                }\r\n            }\r\n\r\n            return false;\r\n        }\r\n\t}\r\n\r\n\tvar _contextClose = function()\r\n\t{\r\n        $('#contextMenuCanvas').remove();\r\n\t}\r\n\r\n\tvar _generateMenuDiv = function(type, context)\r\n\t{\r\n        var uiTemplate = Handlebars.compile('<div>' +\r\n            '{{#menuItems}}' +\r\n                '{{#if separator}}<div class = \"contextMenuSeparator\"></div>{{/if}}' +\r\n                '<div class = \"contextMenuItem\" data-itemIndex=\"{{index}}\">{{title}}</div>' +\r\n            '{{/menuItems}}' +\r\n        '</div>');\r\n\r\n\t\tvar items = _menuItems[type],\r\n            visibleItems = [];\r\n\r\n\t\tfor (var e = 0; e < items.length; e++) {\r\n\t\t\tvar menuElem = items[e];\r\n            if (menuElem.isVisible && !menuElem.isVisible(context)) {\r\n                continue;\r\n            }\r\n\r\n            visibleItems.push({\r\n                index: e,\r\n                title: typeof menuElem.title === 'function' ? menuElem.title() : menuElem.title,\r\n                separator: menuElem.isSeparatorBefore && menuElem.isSeparatorBefore(context)\r\n            });\r\n        }\r\n\r\n        if (visibleItems.length) {\r\n            var ui = $(uiTemplate({menuItems: visibleItems}));\r\n            ui.find('.contextMenuItem').click(function() {\r\n                var itemIndex = Number($(this).data('itemindex'));\r\n                context.contentMenuArea = getOffsetRect(this);\r\n                context.contentMenuType = type;\r\n                _contextClose();\r\n                _menuItems[type][itemIndex].clickCallback(context);\r\n            });\r\n\r\n            return ui[0];\r\n        }\r\n\r\n        return null;\r\n\t}\r\n\r\n\t//public interface\r\n\treturn {\r\n\r\n\t\t/**\r\n\t\t * Добавляет новый пункт меню\r\n         * @memberOf nsGmx.ContextMenuController\r\n\t\t * @function\r\n\t\t * @param {nsGmx.ContextMenuController.IContextMenuElem} menuItem Элемент контекстного меню\r\n\t\t * @param {String | String[]} menuType Тип меню (например: \"Layer\", \"Map\", \"Group\"). Если массив, то данный элемент применяется в нескольких типах меню\r\n\t\t */\r\n\t\taddContextMenuElem: function(menuItem, menuType)\r\n\t\t{\r\n\t\t\tif (typeof menuType === 'string')\r\n\t\t\t\tmenuType = [menuType];\r\n\r\n\t\t\tfor (var i = 0; i < menuType.length; i++)\r\n\t\t\t{\r\n\t\t\t\t_menuItems[menuType[i]] = _menuItems[menuType[i]] || [];\r\n\t\t\t\t_menuItems[menuType[i]].push(menuItem);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Добавляет к DOM элементу контекстное меню\r\n\t\t * @function\r\n         * @memberOf nsGmx.ContextMenuController\r\n\t\t * @param {DOMElement} elem Целевой DOM-элемент\r\n\t\t * @param {String} type Тип меню\r\n\t\t * @param {function():Boolean} checkFunc Проверка, показывать ли сейчас меню. Если ф-ция возвращает false, меню не показывается\r\n\t\t * @param {Object|function(context):Object} context Контекст, который будет передан в элемент меню при клике на DOM-элементе.\r\n\t\t *        Если контект - ф-ция, она будет вызвана непосредственно при клике. В контекст при клике будут добавлены элементы contentMenuArea и contentMenuType.\r\n\t\t */\r\n\t\tbindMenuToElem: function(elem, type, checkFunc, context)\r\n\t\t{\r\n\t\t\t_context(elem, function()\r\n\t\t\t{\r\n\t\t\t\tif (typeof context === 'function')\r\n\t\t\t\t\tcontext = context(); //\r\n\r\n\t\t\t\treturn _generateMenuDiv(type, context);\r\n\t\t\t}, checkFunc, SUGGEST_TIMEOUT)\r\n\t\t}\r\n\t}\r\n})();\r\n\r\n\r\n/** Интерфейс для задания контекстного меню пользователей\r\n* @class\r\n* @name nsGmx.ContextMenuController.IContextMenuElem\r\n*/\r\n\r\n/** Нужно ли отображать данный пункт меню для данного элемента и типа дерева. Необязательная (по умолчанию отображается)\r\n@function\r\n@name isVisible\r\n@memberOf nsGmx.ContextMenuController.IContextMenuElem.prototype\r\n@param {Object} context - контекст, специфический для конкретного типа меню\r\n*/\r\n\r\n/** Нужно ли рисовать перед данным пунктом разделитель (гориз. черту). Необязательная (по умолчанию не рисуется)\r\n@function\r\n@name isSeparatorBefore\r\n@memberOf nsGmx.ContextMenuController.IContextMenuElem.prototype\r\n@param {Object} context - контекст, специфический для конкретного типа меню\r\n*/\r\n\r\n/** Вызывается при клике по соответствующему пункту меню\r\n* @function\r\n* @name clickCallback\r\n* @memberOf nsGmx.ContextMenuController.IContextMenuElem.prototype\r\n* @param {object} context - контекст, который был передан при привязке меню к DOM-элементу. В контекст будут добавлены поля:\r\n*\r\n*  * contentMenuArea {Object} - координаты верхнего левого угла пункта меню, на которое было нажатие. {left: int, top: int}. Если нужно привязаться к месту текущего клика\r\n*  * contentMenuType {String}- тип вызванного контекстного меню. Актуально, если элемент меню используется в нескольких типах меню.\r\n*/\r\n\r\n/** Строка или ф-ция, которую нужно отображать в контекстном меню. Если ф-ция, то она будет вызываться при каждом формировании меню и должна возвращать строку.\r\n@name title\r\n@memberOf nsGmx.ContextMenuController.IContextMenuElem.prototype\r\n*/\r\n\r\n\r\n//Все заголовки элементов меню заданы как ф-ции, так как на момент выполенения этого кода неизвестен выбранный язык системы\r\n\r\n///////////////////////////////////////////////////////////////////////////////\r\n/////////////////////////// Контекстное меню слоёв ////////////////////////////\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\n/*\r\nВ контексте типа \"Layer\" присутствуют следующие атрибуты:\r\n * layerManagerFlag {int} Тип дерева\r\n * elem Элемент (слой), для которого стротся меню\r\n * tree {layersTree} Текущее дерево, внутри которого находится слой\r\n*/\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Свойства\"); },\r\n\tisVisible: function(context)\r\n\t{\r\n\t\treturn !context.layerManagerFlag && nsGmx.AuthManager.isLogin();\r\n\t},\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tvar div;\r\n\t\tif (context.elem.MultiLayerID)\r\n\t\t\tdiv = $(_queryMapLayers.buildedTree).find(\"div[MultiLayerID='\" + context.elem.MultiLayerID + \"']\")[0];\r\n\t\telse\r\n\t\t\tdiv = $(_queryMapLayers.buildedTree).find(\"div[LayerID='\" + context.elem.name + \"']\")[0];\r\n\t\t_mapHelper.createLayerEditor(div, context.tree, 'main', div.gmxProperties.content.properties.styles.length > 1 ? -1 : 0);\r\n\t}\r\n}, 'Layer');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Стили\"); },\r\n\tisVisible: function(context)\r\n\t{\r\n\t\treturn !context.layerManagerFlag && context.elem.type === \"Vector\" && _queryMapLayers.currentMapRights() === \"edit\";\r\n\t},\r\n\tclickCallback: function(context)\r\n\t{\r\n        nsGmx.createStylesDialog(context.elem, context.tree);\r\n\t}\r\n}, 'Layer');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Таблица атрибутов\"); },\r\n\tisVisible: function(context)\r\n\t{\r\n\t\treturn !nsGmx.AuthManager.isRole(nsGmx.ROLE_UNAUTHORIZED) && !context.layerManagerFlag && (_queryMapLayers.currentMapRights() === \"edit\" || _queryMapLayers.layerRights(context.elem.name) == 'view' || _queryMapLayers.layerRights(context.elem.name) == 'edit' || _queryMapLayers.layerRights(context.elem.name) === 'editrows') && context.elem.type === \"Vector\";\r\n\t},\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tnsGmx.createAttributesTable(context.elem.name);\r\n\t}\r\n}, 'Layer');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Права доступа\"); },\r\n\tisVisible: function(context)\r\n\t{\r\n\t\treturn !context.layerManagerFlag &&\r\n\t\t\t\tnsGmx.AuthManager.canDoAction( nsGmx.ACTION_SEE_MAP_RIGHTS ) &&\r\n\t\t\t\t_queryMapLayers.layerRights(context.elem.name) === 'edit';\r\n\t},\r\n\tclickCallback: function(context) {\r\n\t\tif (context.elem.MultiLayerID) {\r\n            let securityDialog = new nsGmx.multiLayerSecurity();\r\n\t\t\tsecurityDialog.getRights(context.elem.MultiLayerID, context.elem.title);\r\n        } else {\r\n            let securityDialog = new nsGmx.layerSecurity(context.elem.name);\r\n\t\t\tsecurityDialog.getRights(context.elem.name, context.elem.title);\r\n        }\r\n\t}\r\n}, 'Layer');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Скачать\"); },\r\n\tisVisible: function(context)\r\n\t{\r\n\t\treturn !context.layerManagerFlag &&\r\n\t\t\t\t( _queryMapLayers.currentMapRights() === \"edit\" || (_queryMapLayers.currentMapRights() == \"view\" && nsGmx.AuthManager.isLogin() ) ) &&\r\n\t\t\t\tcontext.elem.type == \"Vector\" &&\r\n\t\t\t\tcontext.tree.treeModel.getMapProperties().CanDownloadVectors;\r\n\t},\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\t_mapHelper.downloadVectorLayer({\r\n            name: context.elem.name,\r\n            host: context.elem.hostName\r\n        });\r\n\t}\r\n}, 'Layer');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Удалить\"); },\r\n\tisVisible: function(context)\r\n\t{\r\n\t\treturn !context.layerManagerFlag && _queryMapLayers.currentMapRights() === \"edit\";\r\n\t},\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\t_queryMapLayers.removeLayer(context.elem.name)\r\n\r\n\t\tvar div;\r\n\r\n\t\tif (context.elem.MultiLayerID)\r\n\t\t\tdiv = $(_queryMapLayers.buildedTree).find(\"div[MultiLayerID='\" + context.elem.MultiLayerID + \"']\")[0];\r\n\t\telse\r\n\t\t\tdiv = $(_queryMapLayers.buildedTree).find(\"div[LayerID='\" + context.elem.name + \"']\")[0];\r\n\r\n\t\t\t\r\n\t\tvar\tnode = div.parentNode,\r\n\t\t\tparentTree = node.parentNode;\r\n\r\n\t\t_layersTree.removeTreeElem(div);\r\n\r\n\t\tnode.removeNode(true);\r\n\r\n\t\twindow._abstractTree.delNode(null, parentTree, parentTree.parentNode);\r\n\r\n\t\t_mapHelper.updateUnloadEvent(true);\r\n\t}\r\n}, 'Layer');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Добавить снимки\"); },\r\n\tisVisible: function(context)\r\n\t{\r\n        var layerRights = _queryMapLayers.layerRights(context.elem.name);\r\n\t\treturn !context.layerManagerFlag &&\r\n               (layerRights === 'edit' || layerRights === 'editrows') &&\r\n               context.elem.type == \"Vector\" &&\r\n               context.elem.IsRasterCatalog;\r\n\t},\r\n\tclickCallback: function(context)\r\n\t{\r\n        new nsGmx.RCAddLayerControl(nsGmx.gmxMap, context.elem.name);\r\n\t}\r\n}, 'Layer');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Копировать стиль\"); },\r\n\tisVisible: function(context)\r\n\t{\r\n\t\treturn context.elem.type == \"Vector\" &&\r\n\t\t       (context.layerManagerFlag || _queryMapLayers.currentMapRights() === \"edit\");\r\n\t},\r\n\tisSeparatorBefore: function(context)\r\n\t{\r\n\t\treturn !context.layerManagerFlag;\r\n\t},\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tvar rawTree = context.tree.treeModel,\r\n            elem;\r\n        if (context.elem.MultiLayerID)\r\n\t\t\telem = rawTree.findElem(\"MultiLayerID\", context.elem.MultiLayerID).elem;\r\n\t\telse\r\n\t\t\telem = rawTree.findElem(\"LayerID\", context.elem.name).elem;\r\n\r\n        nsGmx.ClipboardController.addItem('LayerStyle', {type: context.elem.GeometryType, style: elem.content.properties.styles});\r\n\t}\r\n}, 'Layer');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Создать копию слоя\"); },\r\n\tisVisible: function(context)\r\n\t{\r\n\t\treturn context.elem.type == \"Vector\" &&\r\n\t\t       (context.layerManagerFlag || _queryMapLayers.currentMapRights() === \"edit\");\r\n\t},\r\n\tisSeparatorBefore: function()\r\n\t{\r\n\t\treturn false;\r\n\t},\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tsendCrossDomainJSONRequest(window.serverBase + \"Layer/GetLayerInfo.ashx?WrapStyle=func&NeedAttrValues=false&LayerName=\" + context.elem.name, function(response) {\r\n\t\t\tif (!parseResponse(response)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tcreateEditorFromSelection(response.Result);\r\n\r\n\t\t\tfunction createEditorFromSelection(props) {\r\n\t\t\t\tvar query = '';\r\n\r\n\t\t\t\tvar parent = nsGmx.Utils._div(null, [['attr','id','new' + 'Vector' + 'Layer'], ['css', 'height', '100%']]),\r\n\t\t\t\t\tproperties = {\r\n\t\t\t\t\t\tTitle:  props.Title + ' ' + _gtxt('копия'),\r\n\t\t\t\t\t\tCopyright: props.Copyright,\r\n\t\t\t\t\t\tDescription: props.Description,\r\n\t\t\t\t\t\tDate: props.Date,\r\n\t\t\t\t\t\tMetaProperties: props.MetaProperties,\r\n\t\t\t\t\t\tTilePath: {\r\n\t\t\t\t\t\t\tPath: ''\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tShapePath: props.ShapePath,\r\n\t\t\t\t\t\tColumns: props.Columns,\r\n\t\t\t\t\t\tIsRasterCatalog: props.IsRasterCatalog,\r\n\t\t\t\t\t\tSourceType: \"sql\",\r\n\t\t\t\t\t\tQuicklook: props.Quicklook\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdialogDiv = nsGmx.Utils.showDialog(_gtxt('Создать векторный слой'), parent, 340, 340, false, false),\r\n\t\t\t\t\tparams = {\r\n\t\t\t\t\t\tcopy: true,\r\n\t\t\t\t\t\tsourceLayerName: context.elem.name,\r\n\t\t\t\t\t\tquery: query,\r\n\t\t\t\t\t\tdoneCallback: function() {\r\n\t\t\t\t\t\t\tnsGmx.Utils.removeDialog(dialogDiv);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\tnsGmx.createLayerEditor(false, 'Vector', parent, properties, params);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}, 'Layer');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Вставить объекты\"); },\r\n\tisVisible: function(context)\r\n\t{\r\n\t\treturn context.elem.type == \"Vector\" &&\r\n\t\t       (context.layerManagerFlag || _queryMapLayers.currentMapRights() === \"edit\");\r\n\t},\r\n\tisSeparatorBefore: function()\r\n\t{\r\n\t\treturn false;\r\n\t},\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tvar copyLayerParams = nsGmx.ClipboardController.get('CopyObjects', -1),\r\n\t\t\tcopyLayerName = copyLayerParams.layerName,\r\n\t\t\tcopyLayerQuery = copyLayerParams.query,\r\n\t\t\tlist = copyLayerParams.list || '';\r\n\r\n\t\tvar url = window.serverBase +\r\n\t\t\t\"VectorLayer/Append?LayerName=\" + context.elem.name +\r\n\t\t\t\"&FromLayer=\" + copyLayerName +\r\n\t\t\t\"&Query=\" + copyLayerQuery;\r\n\r\n\t\tvar  def = nsGmx.asyncTaskManager.sendGmxPostRequest(url);\r\n\r\n\t\tdef.done(function(){\r\n\t\t\tshowErrorMessage(list, true, window._gtxt('Объекты добавлены'));\r\n        }).fail(function(){\r\n\t\t\tshowErrorMessage(window._gtxt('Вставить объекты не удалось'), true);\r\n\t\t\t// console.log(taskInfo);\r\n        }).progress(function(){\r\n\t\t\t// console.log(taskInfo);\r\n        });\r\n\t}\r\n}, 'Layer');\r\n\r\nvar applyStyleContentMenuItem = {\r\n\ttitle: function() { return _gtxt(\"Применить стиль\"); },\r\n\tisVisible: function(context)\r\n\t{\r\n        if (context.layerManagerFlag ||\r\n            _queryMapLayers.currentMapRights() !== \"edit\" ||\r\n            nsGmx.ClipboardController.getCount('LayerStyle') === 0 )\r\n        {\r\n            return false;\r\n        }\r\n\r\n        if (context.contentMenuType === 'Layer') {\r\n            return context.elem.type == \"Vector\" &&\r\n                nsGmx.ClipboardController.get('LayerStyle', -1).type === context.elem.GeometryType;\r\n        } else { //группы\r\n            return true;\r\n        }\r\n\t},\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tvar\r\n            newStyles = nsGmx.ClipboardController.get('LayerStyle', -1).style,\r\n            stylesType = nsGmx.ClipboardController.get('LayerStyle', -1).type;\r\n\r\n\t\tif (context.contentMenuType === 'Layer') {\r\n            var div;\r\n            if (context.elem.MultiLayerID)\r\n                div = $(_queryMapLayers.buildedTree).find(\"div[MultiLayerID='\" + context.elem.MultiLayerID + \"']\")[0];\r\n            else\r\n                div = $(_queryMapLayers.buildedTree).find(\"div[LayerID='\" + context.elem.name + \"']\")[0];\r\n\r\n            div.gmxProperties.content.properties.styles = newStyles;\r\n\r\n            _mapHelper.updateMapStyles(newStyles, context.elem.name);\r\n\r\n            _mapHelper.updateTreeStyles(newStyles, div, context.tree, true);\r\n        } else { //группа\r\n            var tree = context.tree.treeModel,\r\n                node = tree.findElemByGmxProperties(context.div.gmxProperties).elem;\r\n\r\n            tree.forEachLayer(function(layerContent) {\r\n                if (layerContent.properties.type !== \"Vector\" || layerContent.properties.GeometryType !== stylesType){\r\n                    return;\r\n                }\r\n\r\n                layerContent.properties.styles = newStyles;\r\n                _mapHelper.updateMapStyles(newStyles, layerContent.properties.name);\r\n\r\n                var div = context.tree.findUITreeElem({content: layerContent});\r\n                if (div) {\r\n                    // div.gmxProperties.content.properties.styles = newStyles;\r\n                    _mapHelper.updateTreeStyles(newStyles, div, context.tree, true);\r\n                }\r\n            }, node);\r\n        }\r\n\t}\r\n};\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem(applyStyleContentMenuItem, 'Layer');\r\n\r\n///////////////////////////////////////////////////////////////////////////////\r\n/////////////////////////// Контекстное меню групп ////////////////////////////\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\n/*\r\nВ контексте типа \"Group\" присутствуют следующие атрибуты:\r\n * div {DOMElement} Элемент дерева, для которого стротся меню\r\n * tree {layersTree} Текущее дерево карты\r\n*/\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Свойства\"); },\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tnsGmx.createGroupEditor(context.div);\r\n\t}\r\n}, 'Group');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Добавить подгруппу\"); },\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tnsGmx.addSubGroup(context.div, context.tree);\r\n\t}\r\n}, 'Group');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Удалить\"); },\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tcontext.tree.removeGroup(context.div);\r\n\t\t_mapHelper.updateUnloadEvent(true);\r\n\t}\r\n}, 'Group');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem(applyStyleContentMenuItem, 'Group');\r\n///////////////////////////////////////////////////////////////////////////////\r\n/////////////////////////// Контекстное меню карты ////////////////////////////\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\n/*\r\nВ контексте типа \"Map\" присутствуют следующие атрибуты:\r\n * div {DOMElement} Элемент дерева, для которого стротся меню\r\n * tree {layersTree} Текущее дерево карты\r\n*/\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Свойства\"); },\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tnsGmx.createMapEditor(context.div);\r\n\t}\r\n}, 'Map');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Добавить подгруппу\"); },\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tnsGmx.addSubGroup(context.div, context.tree);\r\n\t}\r\n}, 'Map');\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Права доступа\"); },\r\n\tclickCallback: function(context)\r\n\t{\r\n        var securityDialog = new nsGmx.mapSecurity();\r\n\t\tsecurityDialog.getRights(context.tree.treeModel.getMapProperties().MapID, context.tree.treeModel.getMapProperties().title);\r\n\t},\r\n\tisVisible: function()\r\n\t{\r\n\t\treturn nsGmx.AuthManager.canDoAction(nsGmx.ACTION_SEE_MAP_RIGHTS) &&\r\n            (_queryMapLayers.currentMapRights() === \"edit\" || nsGmx.AuthManager.isRole(nsGmx.ROLE_ADMIN));\r\n\t}\r\n}, 'Map');\r\n\r\n//групповое редактирование слоев\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Права доступа к слоям\"); },\r\n\tisVisible: function(context)\r\n\t{\r\n\t\tvar treeModel = context.tree.treeModel,\r\n\t\t\tlayersFlag = false,\r\n\t\t\tlayersRights = false;\r\n\t\ttreeModel.forEachNode(function (node) {\r\n\t\t\tif (node.type !== 'group') {\r\n\t\t\t\tlayersFlag = true;\r\n\t\t\t\tif (_queryMapLayers.layerRights(node.content.properties.LayerID) === 'edit') {\r\n\t\t\t\t\tlayersRights = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn nsGmx.AuthManager.canDoAction( nsGmx.ACTION_SEE_MAP_RIGHTS ) &&\r\n\t\t\tlayersFlag &&\r\n\t\t\tlayersRights;\r\n\t},\r\n\tclickCallback: function() {\r\n        var securityDialog = new nsGmx.layersGroupSecurity(),\r\n\t\t\tprops = _layersTree.treeModel.getMapProperties();\r\n\t\tsecurityDialog.getRights(props.MapID, props.title);\r\n\r\n\t}\r\n}, 'Map');\r\n\r\n})();","import nsGmx from './nsGmx.js';\r\nnsGmx.GeomixerFrameworkVersion = '05.12.2018';","import nsGmx from './nsGmx.js';\r\nimport './version.js';\r\nimport '../css/table.css';\r\nimport {\r\n\tmakeImageButton,\r\n\tmakeLinkButton,\r\n\t_option,\r\n\tswitchSelect,\r\n\t_title,\r\n\t_table, _tbody, _thead, _tr, _th, _td, _t,\r\n\t_div, _span\r\n} from './utilities.js';\r\n\r\n(function($, _) {\r\n\r\nvar modulePath = \"\";\r\n\r\n//TODO: вынести переключалку страниц в отдельный модуль\r\nvar appendTranslations = function()\r\n{\r\n\t_translationsHash.addtext(\"rus\", {\r\n\t\t\"Следующие [value0] страниц\" : \"Следующие [value0] страниц\",\r\n\t\t\"Предыдущие [value0] страниц\" : \"Предыдущие [value0] страниц\",\r\n\t\t\"Первая страница\" : \"Первая страница\",\r\n\t\t\"Последняя страница\" : \"Последняя страница\"\r\n\t});\r\n\r\n\t_translationsHash.addtext(\"eng\", {\r\n\t\t\"Следующие [value0] страниц\" : \"Next [value0] pages\",\r\n\t\t\"Предыдущие [value0] страниц\" : \"Previous [value0] pages\",\r\n\t\t\"Первая страница\" : \"First page\",\r\n\t\t\"Последняя страница\" : \"Last page\"\r\n\t});\r\n}\r\n\r\n/** Интерфейс провайдера данных таблицы {@link nsGmx.ScrollTable}\r\n * @class nsGmx.ScrollTable.IDataProvider\r\n * @abstract\r\n */\r\n\r\n/** Получить общее количество объектов\r\n  @method nsGmx.ScrollTable.IDataProvider#getCount\r\n  @param {function(Number)} callback Ф-ция, которую нужно вызвать с общим количеством объектов\r\n*/\r\n\r\n/** Это событие должно генерироваться при любом изменении набора данных. Приведёт к перерисовке таблицы\r\n  @event nsGmx.ScrollTable.IDataProvider#change\r\n*/\r\n\r\n/** Получить массив объектов для отрисовки на странице\r\n  @method nsGmx.ScrollTable.IDataProvider#getItems\r\n  @param {Number} page Номер страницы (нумерация с нуля)\r\n  @param {Number} pageSize Размер страницы\r\n  @param {String} sortParam По какому атрибуту сортировать\r\n  @param {Boolean} sortDec Направление сортировки (true - по убыванию)\r\n  @param {function(Array)} callback Ф-ция, которую нужно вызвать с результирующим массивом объектов. Структура самих объектов определяется провайдером\r\n*/\r\n\r\n/** Получить массив объектов для отрисовки на страницы и общее количество данных за один запрос.\r\n\tАльтернатива раздельным запросам getItems() и getCount(). Можно реализовать либо эту ф-цию, либо две другие\r\n  @method nsGmx.ScrollTable.IDataProvider#getCountAndItems\r\n  @param {Number} page Номер страницы (нумерация с нуля)\r\n  @param {Number} pageSize Размер страницы\r\n  @param {String} sortParam По какому атрибуту сортировать\r\n  @param {Boolean} sortDec Направление сортировки (true - по убыванию)\r\n  @param {function(count:Number, objs:Object[])} callback Ф-ция, которую нужно вызвать с полученным результатом.\r\n\t\t Первый параметр - общее количество объектов, второй - массив объектов для данной страницы.\r\n*/\r\n\r\n/** Таблица с разбиением данных по страницам. Сильно кастомизируемый виджет. Поддерживает различные провайдеры данных и рендереры.\r\n * @class\r\n * @alias nsGmx.ScrollTable\r\n */\r\nvar scrollTable = function( params )\r\n{\r\n\t/** Перед перерисовкой данных\r\n\t * @event nsGmx.ScrollTable#beforeRedraw\r\n\t */\r\n\r\n\t/** После перерисовки данных\r\n\t * @event nsGmx.ScrollTable#redraw\r\n\t */\r\n\r\n\t/** Изменились параметры сортировки\r\n\t * @event nsGmx.ScrollTable#sortChange\r\n\t */\r\n\r\n\tthis._params = $.extend(\r\n\t{\r\n\t\tlimit: 50,\r\n\t\tpage: 0,\r\n\t\tpagesCount: 10,\r\n\t\theight: '',\r\n\t\tshowFooter: true\r\n\t}, params);\r\n\r\n\tthis.limit = this._params.limit;\r\n\tthis.pagesCount = this._params.pagesCount;\r\n\r\n\tthis.start = 0;\r\n\tthis.reportStart = 0;\r\n\r\n\tthis.drawFunc = null;\r\n\r\n\tthis._requestID = 0;\r\n\tthis._pageVals = [];\r\n\tthis._currValsCount = 0;\r\n\r\n\tthis._dataProvider = null;\r\n\r\n\t // Переход на предыдущую страницу\r\n\tthis.next = function()\r\n\t{\r\n\t\tvar _this = this,\r\n\t\t\tbutton = makeImageButton(modulePath + 'img/next.png', modulePath + 'img/next_a.png');\r\n\r\n\t\tbutton.style.marginBottom = '-7px';\r\n\r\n\t\tbutton.onclick = function()\r\n\t\t{\r\n\t\t\t_this.start += _this.pagesCount;\r\n\t\t\t_this.reportStart = _this.start * _this.limit;\r\n\r\n\t\t\t_this._drawPagesRow();\r\n\r\n\t\t\t_this.tableBody.scrollTop = 0;\r\n\t\t\t_this.tableParent.scrollTop = 0;\r\n\t\t}\r\n\r\n\t\t_title(button, _gtxt('Следующие [value0] страниц', _this.pagesCount));\r\n\r\n\t\treturn button;\r\n\t}\r\n\r\n\t// Переход на следующую страницу\r\n\tthis.previous = function()\r\n\t{\r\n\t\tvar _this = this,\r\n\t\t\tbutton = makeImageButton(modulePath + 'img/prev.png', modulePath + 'img/prev_a.png');\r\n\r\n\t\tbutton.style.marginBottom = '-7px';\r\n\r\n\t\tbutton.onclick = function()\r\n\t\t{\r\n\t\t\t_this.start -= _this.pagesCount;\r\n\t\t\t_this.reportStart = _this.start * _this.limit;\r\n\r\n\t\t\t_this._drawPagesRow();\r\n\r\n\t\t\t_this.tableBody.scrollTop = 0;\r\n\t\t\t_this.tableParent.scrollTop = 0;\r\n\t\t}\r\n\r\n\t\t_title(button, _gtxt('Предыдущие [value0] страниц', _this.pagesCount));\r\n\r\n\t\treturn button;\r\n\t}\r\n\r\n\t// Переход на первую страницу\r\n\tthis.first = function()\r\n\t{\r\n\t\tvar _this = this,\r\n\t\t\tbutton = makeImageButton(modulePath + 'img/first.png', modulePath + 'img/first_a.png');\r\n\r\n\t\tbutton.style.marginBottom = '-7px';\r\n\r\n\t\tbutton.onclick = function()\r\n\t\t{\r\n\t\t\t_this.start = 0;\r\n\t\t\t_this.reportStart = _this.start * _this.limit;\r\n\r\n\t\t\t_this._drawPagesRow();\r\n\r\n\t\t\t_this.tableBody.scrollTop = 0;\r\n\t\t\t_this.tableParent.scrollTop = 0;\r\n\t\t}\r\n\r\n\t\t_title(button, _gtxt('Первая страница'));\r\n\r\n\t\treturn button;\r\n\t}\r\n\r\n\t// Переход на последнюю страницу\r\n\tthis.last = function()\r\n\t{\r\n\t\tvar _this = this,\r\n\t\t\tbutton = makeImageButton(modulePath + 'img/last.png', modulePath + 'img/last_a.png');\r\n\r\n\t\tbutton.style.marginBottom = '-7px';\r\n\r\n\t\tbutton.onclick = function()\r\n\t\t{\r\n\t\t\t_this.start = Math.floor(_this._currValsCount / (_this.pagesCount * _this.limit)) * _this.pagesCount;\r\n\t\t\t_this.reportStart = Math.floor(_this._currValsCount / _this.limit) * _this.limit;\r\n\r\n\t\t\t_this._drawPagesRow();\r\n\r\n\t\t\t_this.tableBody.scrollTop = 0;\r\n\t\t\t_this.tableParent.scrollTop = 0;\r\n\t\t}\r\n\r\n\t\t_title(button, _gtxt('Последняя страница'));\r\n\r\n\t\treturn button;\r\n\t}\r\n\r\n\tvar _this = this;\r\n\tthis._status = {\r\n\t\t_state: false,\r\n\t\tstart: function() {\r\n\t\t\tthis._state = true;\r\n\t\t\tvar me = this;\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif (me._state) {\r\n\t\t\t\t\t$(_this.statusContainer).siblings().hide();\r\n\t\t\t\t\t$(_this.statusContainer).show();\r\n\t\t\t\t}\r\n\t\t\t}, 100);\r\n\t\t},\r\n\t\tstop: function() {\r\n\t\t\t$(_this.statusContainer).siblings().show();\r\n\t\t\t$(_this.statusContainer).hide();\r\n\t\t\tthis._state = false;\r\n\t\t}\r\n\t}\r\n\r\n\tthis.limitSel = nsGmx.Utils._select([_option([_t(\"10\")], [['attr','value',10]]),\r\n\t\t\t\t\t\t\t _option([_t(\"20\")], [['attr','value',20]]),\r\n\t\t\t\t\t\t\t _option([_t(\"50\")], [['attr','value',50]]),\r\n\t\t\t\t\t\t\t _option([_t(\"100\")], [['attr','value',100]]),\r\n\t\t\t\t\t\t\t _option([_t(\"200\")], [['attr','value',200]]),\r\n\t\t\t\t\t\t\t _option([_t(\"500\")], [['attr','value',500]])], [['dir','className','selectStyle floatRight'], ['css','width','60px']])\r\n}\r\n\r\n/** Установка провайдера данных\r\n @param {nsGmx.ScrollTable.IDataProvider} dataProvider Провайдер данных\r\n */\r\nscrollTable.prototype.setDataProvider = function( dataProvider )\r\n{\r\n\tthis._dataProvider = dataProvider;\r\n\tthis._drawTable();\r\n}\r\n\r\n/** Получить текущий провайдер данных\r\n @return {nsGmx.ScrollTable.IDataProvider} Текущий провайдер данных\r\n */\r\nscrollTable.prototype.getDataProvider = function()\r\n{\r\n\treturn this._dataProvider;\r\n}\r\n\r\n/** Изменить активность (видимость) колонки в таблице\r\n  @param {String} name имя колонки\r\n  @param {Boolean} isActive активность (видимость) колонки\r\n*/\r\nscrollTable.prototype.activateField = function(name, isActive)\r\n{\r\n\tfor (var f = 0; f < this._fields.length; f++)\r\n\t\tif (this._fields[f].title == name)\r\n\t\t{\r\n\t\t\tif (this._fields[f].isActive == isActive)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tthis._fields[f].isActive = isActive;\r\n\r\n\t\t\tthis._drawHeader();\r\n\t\t\tthis._drawRows();\r\n\t\t}\r\n}\r\n\r\nscrollTable.prototype._getActiveFields = function()\r\n{\r\n\tvar res = [];\r\n\tfor (var f = 0; f < this._fields.length; f++)\r\n\t\tif (this._fields[f].isActive)\r\n\t\t\tres.push(this._fields[f].title);\r\n\r\n\treturn res;\r\n}\r\n\r\nscrollTable.prototype._drawRows = function()\r\n{\r\n\tvar trs = [],\r\n\t\ttr;\r\n\r\n\t$(this).triggerHandler('beforeRedraw');\r\n\r\n\t$(this.tableBody).empty();\r\n\r\n\tvar activeFields = this._getActiveFields();\r\n\r\n\tfor (var i = 0; i < this._pageVals.length; i++)\r\n\t{\r\n\t\ttr = this.drawFunc(this._pageVals[i], i, activeFields);\r\n\t\ttr && trs.push(tr);\r\n\t}\r\n\r\n\t_(this.tableBody, trs);\r\n\r\n\tif (this._pageVals.length == 0)\r\n\t\t_(this.tableBody, [_tr(null,[['css','height','1px'],['attr','empty', true]])])\r\n\r\n\t$(this.tableCount).empty();\r\n\r\n\tthis.statusContainer = _div(null, [['dir', 'className', 'fileBrowser-progress'], ['css', 'display', 'none']]);\r\n\r\n\tif (this._currValsCount) {\r\n\t\tvar cntStr = this._currValsCount === 100001 ? 'более 100000' : this._currValsCount;\r\n\t\t_(this.tableCount, [_span([\r\n\t\t\t_t((this.reportStart + 1) + '-' + (Math.min(this.reportStart + this.limit, this._currValsCount))),\r\n\t\t\t_span([_t(' ')],[['css','margin','0px 3px']]),\r\n\t\t\t_t(\"(\" + cntStr + \")\")\r\n\t\t]), this.statusContainer]);\r\n\t}\r\n\telse {\r\n\t\t_(this.tableCount, [_span([_t(\"0-0\"), _span([_t(' ')],[['css','margin','0px 3px']]), _t(\"(0)\")]), this.statusContainer]);\r\n\t}\r\n\r\n\t$(this).triggerHandler('redraw');\r\n}\r\n\r\nscrollTable.prototype._drawPages = function(end)\r\n{\r\n\tvar _this = this;\r\n\tfor (var i = this.start + 1; i<= end; i++)\r\n\t{\r\n\t\t// текущий элемент\r\n\t\tif (i - 1 == this.reportStart/this.limit)\r\n\t\t{\r\n\t\t    var el = _span([_t(i.toString())]);\r\n\t\t\t_(_this.tablePages, [el]);\r\n\t\t\t$(el).addClass('page');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tvar link = makeLinkButton(i.toString());\r\n\r\n\t\t\tlink.setAttribute('page', i - 1);\r\n\t\t\tlink.style.margin = '0px 2px';\r\n\r\n\t\t\t_(_this.tablePages, [link]);\r\n\r\n\t\t\tlink.onclick = function()\r\n\t\t\t{\r\n\t\t\t\t_this.reportStart = this.getAttribute('page') * _this.limit;\r\n\r\n\t\t\t\t_this._drawPagesRow();\r\n\r\n\t\t\t\t// мозилла\r\n\t\t\t\t_this.tableBody.scrollTop = 0;\r\n\t\t\t\t// ие\r\n\t\t\t\t_this.tableParent.scrollTop = 0;\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n}\r\n\r\nscrollTable.prototype._updatePageData = function(callback)\r\n{\r\n\tvar _this = this;\r\n\r\n\tif (this._dataProvider.getCountAndItems)\r\n\t{\r\n\t\tvar requestID = this._requestID++;\r\n\t\tthis._status.start();\r\n\t\t_this._dataProvider.getCountAndItems(\r\n\t\t\t_this.reportStart / _this.limit,\r\n\t\t\t_this.limit,\r\n\t\t\t_this.currentSortType,\r\n\t\t\t_this.currentSortIndex[_this.currentSortType] == 1,\r\n\t\t\tfunction(count, values)\r\n\t\t\t{\r\n\t\t\t\tif (requestID !== _this._requestID - 1) {\r\n\t\t\t\t\t_this._status.stop();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_this._currValsCount = count;\r\n\r\n\t\t\t\t//если данных стало слишком мало, мы встанем на первую страницу и перезапросим данные ещё раз\r\n\t\t\t\tif (_this.reportStart > _this._currValsCount)\r\n\t\t\t\t{\r\n\t\t\t\t\trequestID = _this._requestID++;\r\n\r\n\t\t\t\t\t_this.start = _this.reportStart = 0; //на первую страницу\r\n\r\n\t\t\t\t\t_this._dataProvider.getCountAndItems(\r\n\t\t\t\t\t\t_this.reportStart / _this.limit,\r\n\t\t\t\t\t\t_this.limit,\r\n\t\t\t\t\t\t_this.currentSortType,\r\n\t\t\t\t\t\t_this.currentSortIndex[_this.currentSortType] == 1,\r\n\t\t\t\t\t\tfunction(count, values)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t_this._status.stop();\r\n\t\t\t\t\t\t\tif (requestID !== _this._requestID - 1)\r\n\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t_this._pageVals = values;\r\n\t\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t_this._status.stop();\r\n\t\t\t\t\t_this._pageVals = values;\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t)\r\n\t}\r\n\telse\r\n\t{\r\n\t\tthis._status.start();\r\n\t\tthis._dataProvider.getCount(function(count)\r\n\t\t{\r\n\t\t\t_this._currValsCount = count;\r\n\r\n\t\t\t//вообще-то при обновлении данных мы не изменяем текущей страницы\r\n\t\t\t//однако если данных стало слишком мало, то текущую страницу сохранить нельзя,\r\n\t\t\t//и мы переключимся на первую\r\n\t\t\tif (_this.reportStart >= _this._currValsCount)\r\n\t\t\t{\r\n\t\t\t\t_this.start = _this.reportStart = 0;\r\n\t\t\t}\r\n\r\n\t\t\t_this._dataProvider.getItems(\r\n\t\t\t\t_this.reportStart / _this.limit,\r\n\t\t\t\t_this.limit,\r\n\t\t\t\t_this.currentSortType,\r\n\t\t\t\t_this.currentSortIndex[_this.currentSortType] == 1,\r\n\t\t\t\tfunction(values)\r\n\t\t\t\t{\r\n\t\t\t\t\t_this._status.stop();\r\n\t\t\t\t\t_this._pageVals = values || [];\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t});\r\n\t}\r\n}\r\n\r\nscrollTable.prototype._drawPagesRow = function()\r\n{\r\n\tvar _this = this;\r\n\tthis._updatePageData(function()\r\n\t{\r\n\t\t// перерисовывем номера страниц\r\n\t\t$(_this.tablePages).empty();\r\n\r\n\t\tif (_this._currValsCount > _this.limit)\r\n\t\t{\r\n\t\t\tvar allPages = Math.ceil(_this._currValsCount / _this.limit);\r\n\r\n\t\t\tvar end = (_this.start + _this.pagesCount <= allPages) ? _this.start + _this.pagesCount : allPages;\r\n\r\n\t\t\tif (_this.start - _this.pagesCount >= 0)\r\n\t\t\t\t_(_this.tablePages,[_this.first(), _this.previous()]);\r\n\r\n\t\t\t_this._drawPages(end);\r\n\r\n\t\t\tif (end + 1 <= allPages)\r\n\t\t\t\t_(_this.tablePages,[_this.next(), _this.last()]);\r\n\t\t}\r\n\r\n\t\t_this._drawRows();\r\n\t})\r\n\r\n}\r\n\r\nscrollTable.prototype._drawHeader = function()\r\n{\r\n\tvar tds = [],\r\n\t\t_this = this;\r\n\r\n\tvar headerElemFactory = this._isWidthScroll ? _th : _td;\r\n\r\n\tthis._fields.forEach(function(field) {\r\n\t\tif (!field.isActive)\r\n\t\t\treturn;\r\n\r\n\t\tvar title = field.title,\r\n\t\t\tbutton;\r\n\r\n\t\tif (title != '' && field.isSortable)\r\n\t\t{\r\n\t\t\tbutton = makeLinkButton(title);\r\n\r\n\t\t\tbutton.sortType = title;\r\n\t\t}\r\n\t\telse\r\n\t\t\tbutton = _t(title)\r\n\r\n\t\tvar td = headerElemFactory([button], [['css','width',field.width]]);\r\n\r\n\t\tif (field.isSortable) {\r\n\t\t\t$(td).click(function() {\r\n\t\t\t\t_this.setSortParams(title, 1 - _this.currentSortIndex[title]);\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\ttds.push(td);\r\n\t})\r\n\r\n\t$(this._tableHeaderRow).empty();\r\n\t_(this._tableHeaderRow, tds);\r\n}\r\n\r\n//Если baseWidth == 0, таблица растягивается на весь контейнер по ширине\r\n\r\n/** Нарисовать таблицу\r\n* @param {Object} params\r\n* @param {DOMElement} params.parent Контейнер для помещения результата отрисовки\r\n* @param {String} params.name Уникальное имя таблицы\r\n* @param {Number} [params.baseWidth] Какой ширины должна быть таблица. Если не указано, будет занимать 100% контейнера\r\n* @param {String[]} params.fields массив имён колонок\r\n* @param {String[]} params.fieldsWidths массив с описанием ширины колонок. Описание даётся в терминах css\r\n* @param {function} params.drawFunc Ф-ция отрисовки одной строки таблицы. На вход - объект для отрисовки (полученный от провайдера). На выходе - \"tr\" элемент\r\n* @param {Object} [params.sortableFields] Хеш для указания возможности сортировки колонок (будет включена для всех ключей хеша)\r\n* @param {Boolean} [params.isWidthScroll] Трубется ли возможность прокрутки данных по горизонтали\r\n*/\r\nscrollTable.prototype.createTable = function(parent, name, baseWidth, fields, fieldsWidths, drawFunc, sortableFields, isWidthScroll)\r\n{\r\n\tvar params = null\r\n\t//передача параметров в виде структуры\r\n\tif (arguments.length === 1)\r\n\t{\r\n\t\tparams = $.extend(true, {\r\n\t\t\tsortableFields: {}\r\n\t\t}, parent);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tparams = {\r\n\t\t\tparent: parent,\r\n\t\t\tname: name,\r\n\t\t\tbaseWidth: baseWidth,\r\n\t\t\tfields: fields,\r\n\t\t\tfieldsWidths: fieldsWidths,\r\n\t\t\tdrawFunc: drawFunc,\r\n\t\t\tsortableFields: sortableFields,\r\n\t\t\tisWidthScroll: isWidthScroll\r\n\t\t}\r\n\t}\r\n\r\n\tname = params.name;\r\n\r\n\tvar _this = this;\r\n\tthis._isWidthScroll = params.isWidthScroll;\r\n\r\n\tthis._fields = [];\r\n\tfor (let f = 0; f < params.fields.length; f++)\r\n\t\tthis._fields.push({\r\n\t\t\ttitle: params.fields[f],\r\n\t\t\twidth: params.fieldsWidths[f],\r\n\t\t\tisSortable: params.fields[f] in params.sortableFields,\r\n\t\t\tisActive: true\r\n\t\t});\r\n\r\n\tthis.limitSel = switchSelect(this.limitSel,  this.limit)\r\n\r\n\tthis.limitSel.onchange = function()\r\n\t{\r\n\t\t_this.limit = Number(this.value);\r\n\r\n\t\t_this.start = 0;\r\n\t\t_this.reportStart = _this.start * _this.limit;\r\n\r\n\t\t_this._drawTable()\r\n\t}\r\n\r\n\tthis.tableCount = _div();\r\n\tthis.tableLimit = _div([this.limitSel]);\r\n\tthis.tablePages = _div(null,[['dir','className','tablePages']]);\r\n\r\n\tthis.tableBody = _tbody(null,[['attr','id',name + 'TableBody']]);\r\n\r\n\tthis._tableHeaderRow = _tr();\r\n\tif (this._isWidthScroll)\r\n\t{\r\n\t\tthis.tableHeader = _thead([this._tableHeaderRow], [['attr','id',name + 'TableHeader'], ['dir','className','tableHeader']]);\r\n\t}\r\n\t//как формировать фиксированный заголовок таблицы, зависит от того, будет ли у таблицы фиксированный размер или нет\r\n\t\t//TODO: убрать возможность задавать фиксированный размер\r\n\telse if ( params.baseWidth )\r\n\t\tthis.tableHeader = _tbody([this._tableHeaderRow],[['attr','id',name + 'TableHeader']]);\r\n\telse\r\n\t\tthis.tableHeader = _tbody([_tr([_td([_table([_tbody([this._tableHeaderRow])])]), _td(null, [['css', 'width', '20px']])])], [['attr','id',name + 'TableHeader']]);\r\n\r\n\tthis._drawHeader();\r\n\r\n\tif (this._isWidthScroll)\r\n\t{\r\n\t\tthis.tableParent = _div([_table([this.tableHeader, this.tableBody], [['css', 'width', '100%']])],\r\n\t\t\t\t\t\t\t\t[['attr','id',name + 'TableParent'],['dir','className','scrollTable'],['css','width', baseWidth ? baseWidth + 'px' : \"100%\"], ['css', 'height', this._params.height], ['css', 'overflow', 'auto']]);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tthis.tableParent = _div([\r\n\t\t\t\t\t\t\t\t_div([_table([this.tableHeader])],[['dir','className','tableHeader']]),\r\n\t\t\t\t\t\t\t\t_div([_table([this.tableBody])],[['dir','className','tableBody'],['css', 'height', this._params.height ? (this._params.height - 20) + 'px' : ''], ['css','width', params.baseWidth ? params.baseWidth + 20 + 'px' : \"100%\"]])\r\n\t\t\t\t\t\t\t],[['attr','id',name + 'TableParent'],['dir','className','scrollTable'], ['css', 'height', this._params.height ? this._params.height + 'px' : ''], ['css','width', params.baseWidth ? params.baseWidth + 'px' : \"100%\"]])\r\n\t}\r\n\r\n\t_(params.parent, [this.tableParent])\r\n\r\n\tif (this._params.showFooter)\r\n\t\t_(params.parent, [_table([_tbody([_tr([_td([this.tableCount], [['css','width','20%']]), _td([this.tablePages]), _td([this.tableLimit], [['css','width','20%']])])])], [['css','width','100%']])]);\r\n\r\n\tthis.drawFunc = params.drawFunc;\r\n\tthis.start = 0;         //Первый номер страницы, показываемый на экране (это не текущая страница!)\r\n\tthis.reportStart = 0;   //Первый номер элемента на текущей странице\r\n\r\n\tthis.currentSortType = null;\r\n\t// сортировка по умолчанию\r\n\tfor (let name in params.sortableFields)\r\n\t{\r\n\t\tthis.currentSortType = name;\r\n\r\n\t\tbreak;\r\n\t}\r\n\r\n\tthis.currentSortIndex = {};\r\n\tfor (let name in params.sortableFields)\r\n\t{\r\n\t\tthis.currentSortIndex[name] = 0;\r\n\t}\r\n\r\n\tif (!this._dataProvider)\r\n\t\tthis.setDataProvider(new scrollTable.StaticDataProvider());\r\n\r\n\t$(this._dataProvider).change(function()\r\n\t{\r\n\t\t_this._drawTable();\r\n\t});\r\n\tthis._drawTable();\r\n}\r\n\r\nscrollTable.prototype.updateHeight = function( height )\r\n{\r\n\tif (this._isWidthScroll)\r\n\t{\r\n\t\tthis.tableParent.style.height = (height - 40) + 'px';\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$(this.tableParent).find('.tableBody').height(height - 20);\r\n\t\t$(this.tableParent).height(height);\r\n\t}\r\n}\r\n\r\nscrollTable.prototype._drawTable = function()\r\n{\r\n\tif (!this.tableBody) return; //ещё не создана таблица\r\n\tthis._drawPagesRow();\r\n}\r\n\r\n/** Выбрать страницу для показа\r\n@param {Number} page Номер страницы (нумерация с нуля)\r\n*/\r\nscrollTable.prototype.setPage = function(iPage)\r\n{\r\n\tif (this.limit*iPage >= this._currValsCount || iPage < 0 || this.reportStart == iPage * this.limit)\r\n\t\treturn;\r\n\r\n\tthis.reportStart = iPage * this.limit;\r\n\tthis.start = Math.floor(iPage/this.pagesCount) * this.pagesCount;\r\n\r\n\tthis._drawPagesRow();\r\n\r\n\tthis.tableBody.scrollTop = 0;\r\n\tthis.tableParent.scrollTop = 0;\r\n}\r\n\r\n/** Получить массив объектов, которые нарисованы в данный момент\r\n @return {Array} массив объектов в формате провайдера данных\r\n*/\r\nscrollTable.prototype.getVisibleItems = function()\r\n{\r\n\treturn this._pageVals;\r\n}\r\n\r\n/** Задать параметры сортровки\r\n @param {String} sortType Имя колонки для сортировки\r\n @param {Boolean} sortDirection Направление сортровки (false - по возрастанию, true - по убыванию)\r\n*/\r\nscrollTable.prototype.setSortParams = function(sortType, sortDirection)\r\n{\r\n\tthis.currentSortType = sortType;\r\n\tthis.currentSortIndex[this.currentSortType] = sortDirection;\r\n\r\n\tthis.start = 0;\r\n\tthis.reportStart = this.start * this.limit;\r\n\r\n\tthis._drawTable()\r\n\r\n\t$(this).triggerHandler('sortChange');\r\n}\r\n\r\n/** Получить текущее направление сортировки.\r\n @return {Boolean} false - по возрастанию, true - по убыванию\r\n*/\r\nscrollTable.prototype.getSortDirection = function()\r\n{\r\n\treturn this.currentSortIndex[this.currentSortType] == 1\r\n}\r\n\r\n/** Получить по какой колонке происходит сортровка\r\n @return Имя колонки\r\n*/\r\nscrollTable.prototype.getSortType = function()\r\n{\r\n\treturn this.currentSortType;\r\n}\r\n\r\n/** Перерисовать текущую страницу без перезапроса данных у провайдера */\r\nscrollTable.prototype.repaint = function()\r\n{\r\n\tthis._drawRows();\r\n}\r\n\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\n/** Провайдер данных для {@link nsGmx.ScrollTable}.\r\n* Хранит статический массив данных, умеет их фильтровать и упорядочивать.\r\n* @class\r\n* @extends nsGmx.ScrollTable.IDataProvider\r\n*/\r\nscrollTable.StaticDataProvider = function( originalData )\r\n{\r\n\tvar _vals = originalData || []; //исходный список элементов\r\n\tvar _filteredVals = []; //список элементов после фильтрации. Валиден только если _isFiltered == true\r\n\r\n\tvar _isFiltered = false;\r\n\tvar _predicate = {}; //фильтры. Ф-ции predicate(name, value, items)->filteredItems\r\n\tvar _filterVals = {}; //значения фильтров\r\n\r\n\tvar _sortFunctions = {};\r\n\tvar _this = this;\r\n\r\n\tvar _filter = function()\r\n\t{\r\n\t\tif (_isFiltered) return;\r\n\r\n\t\t_filteredVals = _vals;\r\n\r\n\t\tfor (var filterElem in _filterVals)\r\n\t\t{\r\n\t\t\t_filteredVals = _predicate[filterElem](filterElem, _filterVals[filterElem], _filteredVals);\r\n\t\t}\r\n\r\n\t\t_isFiltered = true;\r\n\t}\r\n\r\n\tvar _update = function()\r\n\t{\r\n\t\t_isFiltered = false;\r\n\t\t$(_this).change();\r\n\t}\r\n\r\n\t/** синхронный вариант getCount() */\r\n\tthis.getCountDirect = function()\r\n\t{\r\n\t\t_filter();\r\n\t\treturn _filteredVals.length;\r\n\t}\r\n\r\n\t/** синхронный вариант getItems() */\r\n\tthis.getItemsDirect = function(page, pageSize, sortParam, sortDec)\r\n\t{\r\n\t\tvar nMin = page*pageSize;\r\n\t\tvar nMax = nMin + pageSize;\r\n\t\t_filter();\r\n\t\tvar sortDirIndex = sortDec ? 1 : 0;\r\n\t\tvar sortedVals;\r\n\r\n\t\tif (_sortFunctions[sortParam])\r\n\t\t{\r\n\t\t\tif (typeof _sortFunctions[sortParam] === 'function') //если нет ф-ции для сортировки в обратном порядке, инвертируем прямую ф-цию\r\n\t\t\t\tsortedVals = _filteredVals.sort(function(a, b) { return (1-2*sortDirIndex) * _sortFunctions[sortParam](a, b); });\r\n\t\t\telse\r\n\t\t\t\tsortedVals = _filteredVals.sort(_sortFunctions[sortParam][sortDirIndex]);\r\n\t\t}\r\n\t\telse\r\n\t\t\tsortedVals = _filteredVals;\r\n\r\n\t\tnMin = Math.min(Math.max(nMin, 0), sortedVals.length);\r\n\t\tnMax = Math.min(Math.max(nMax, 0), sortedVals.length);\r\n\t\treturn sortedVals.slice(nMin, nMax);\r\n\t}\r\n\r\n\t//IDataProvider interface\r\n\tthis.getCount = function(callback)\r\n\t{\r\n\t\tcallback(this.getCountDirect());\r\n\t}\r\n\r\n\tthis.getItems = function(page, pageSize, sortParam, sortDec, callback)\r\n\t{\r\n\t\tcallback(this.getItemsDirect(page, pageSize, sortParam, sortDec, callback));\r\n\t}\r\n\r\n\t/** задание исходных данных */\r\n\tthis.setOriginalItems = function(items)\r\n\t{\r\n\t\t_vals = items;\r\n\t\t_update();\r\n\t}\r\n\r\n\t/** получение исходных данных */\r\n\tthis.getOriginalItems = function()\r\n\t{\r\n\t\treturn _vals;\r\n\t}\r\n\r\n\t/** Фильтруем исходные данные\r\n\t* @param {function(val:Object):Boolean} filterFunction ф-ция для фильтрации. На вход принимает элемент массива данных, возвращает false, если элемент отфильтровывается, иначе true\r\n\t*/\r\n\tthis.filterOriginalItems = function(filterFunction)\r\n\t{\r\n\t\tvar newOrigData = [];\r\n\t\tfor (var i = 0; i < _vals.length; i++)\r\n\t\t\tif (filterFunction(_vals[i]))\r\n\t\t\t\tnewOrigData.push(_vals[i]);\r\n\r\n\t\t_vals = newOrigData;\r\n\t\t_update();\r\n\t}\r\n\r\n\t/** Добавляем новый элемент в исходные данные */\r\n\tthis.addOriginalItem = function(item)\r\n\t{\r\n\t\t_vals.push(item);\r\n\t\t_update();\r\n\t}\r\n\r\n\t/** Добавляем массив элементов в исходные данные */\r\n\tthis.addOriginalItems = function(itemArr)\r\n\t{\r\n\t\t_vals = _vals.concat(itemArr);\r\n\t\t_update();\r\n\t}\r\n\r\n\t//фильтрация\r\n\tthis.attachFilterEvents = function(inputField, fieldName, predicate)\r\n\t{\r\n\r\n\t\t_predicate[fieldName] = predicate;\r\n\r\n\t\t$(inputField).bind('keyup', function()\r\n\t\t{\r\n\t\t\tif (_filterVals[fieldName] !== this.value)\r\n\t\t\t{\r\n\t\t\t\t_filterVals[fieldName] = this.value;\r\n\t\t\t\t_update();\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t_filterVals[fieldName] = inputField.value;\r\n\t\t_update();\r\n\t}\r\n\r\n\t/** Добавить ф-цию фильтрации исходных данных\r\n\t\t@param {String} fieldName Имя фильтра\r\n\t\t@param {function} predicate Ф-ция фильтрации: predicate(name, value, items)->filteredItems\r\n\t*/\r\n\tthis.addFilter = function(fieldName, predicate)\r\n\t{\r\n\t\t_predicate[fieldName] = predicate;\r\n\t}\r\n\r\n\t/** Установить значение для фильтра\r\n\t\t@param {String} fieldName Имя фильтра\r\n\t\t@param {String} value Значение для фильтрации\r\n\t*/\r\n\tthis.setFilterValue = function(fieldName, value)\r\n\t{\r\n\t\t_filterVals[fieldName] = value;\r\n\t\t_update();\r\n\t}\r\n\r\n\tthis.attachSelectFilterEvents = function(selectField, fieldName, predicate)\r\n\t{\r\n\r\n\t\t_predicate[fieldName] = predicate;\r\n\r\n\t\tselectField.onchange = function()\r\n\t\t{\r\n\t\t\t_filterVals[fieldName] = this.value;\r\n\t\t\t_update();\r\n\t\t}\r\n\r\n\t\t_filterVals[fieldName] = selectField.value;\r\n\t\t_update();\r\n\t}\r\n\r\n\t/** Задать ф-ции сортировки\r\n\t @param {Object} sortFunctions Хеш из ф-ций {Имя столбца -> ф-ция или массив из двух ф-ций}.\r\n\t\tЕсли массив из двух ф-ций, то первая используется для сортировки по возрастанию, вторая - по убыванию.\r\n\t\tЕсли просто ф-ция, то по убыванию используется инвертная к ней.\r\n\t\tФормат ф-ции совпадает с ф-цией для sort().\r\n\t*/\r\n\tthis.setSortFunctions = function(sortFunctions)\r\n\t{\r\n\t\t_sortFunctions = sortFunctions;\r\n\t}\r\n};\r\n\r\n// простое стравнение по атрибутам объекта.\r\n// Использование: genAttrSort(func(a)->value), genAttrSort(attrName), genAttrSort(attrName1, attrName2)\r\nscrollTable.StaticDataProvider.genAttrSort = function(attrName1, attrName2)\r\n{\r\n\tif (typeof attrName1 === 'function')\r\n\t{\r\n\t\treturn function(a, b) {\r\n\t\t\tvar av = attrName1(a),\r\n\t\t\t\tbv = attrName1(b);\r\n\t\t\tif (av > bv)      return 1;\r\n\t\t\telse if (av < bv) return -1;\r\n\t\t\telse              return 0;\r\n\t\t}\r\n\t}\r\n\telse if (attrName2)\r\n\t{\r\n\t\treturn function(a, b) {\r\n\t\t\tvar av = a[attrName1][attrName2];\r\n\t\t\tvar bv = b[attrName1][attrName2];\r\n\t\t\tif (av > bv)      return 1;\r\n\t\t\telse if (av < bv) return -1;\r\n\t\t\telse              return 0;\r\n\t\t}\r\n\t} else {\r\n\t\treturn function(a, b) {\r\n\t\t\tvar av = a[attrName1];\r\n\t\t\tvar bv = b[attrName1];\r\n\t\t\tif (av > bv)      return 1;\r\n\t\t\telse if (av < bv) return -1;\r\n\t\t\telse              return 0;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// //если есть вьюер, добавляем для него переменные в глобальный namespace\r\n// if ('nsGmx' in window && 'GeomixerFramework' in window.nsGmx)\r\n// {\r\n\twindow.scrollTable = scrollTable; //Depricated - use nsGmx\r\n\twindow.nsGmx.ScrollTable = scrollTable;\r\n// }\r\n\r\nwindow.gmxCore.addModule(\"ScrollTableControl\",\r\n\t{\r\n\t\tScrollTable: scrollTable\r\n\t},\r\n\t{\r\n\t\trequire: ['translations', 'utilities'],\r\n\t\t// css: 'table.css',\r\n\t\tinit: function(module, path)\r\n\t\t{\r\n\t\t\tmodulePath = path || \"\";\r\n\t\t\tappendTranslations();\r\n\t\t}\r\n\t}\r\n);\r\n\r\n})(jQuery, nsGmx.Utils._);\r\n","﻿import nsGmx from './nsGmx.js';\r\nimport './contextMenuController.js';\r\nimport './ScrollTableControl.js';\r\nimport {\r\n    attachEffects,\r\n\t_tr, _td, _t,\r\n    _div,  _img,\r\n    _title,\r\n    makeImageButton,\r\n    makeLinkButton, parseResponse, \r\n    showDialog, showErrorMessage,\r\n    sendCrossDomainJSONRequest,\r\n} from './utilities.js';\r\n\r\n//рисует диалог со списком карт.\r\n//позволяет загрузить карту, просмотреть слои карты, перетащить слой в текущую карту\r\n(function(_){\r\n\r\nnsGmx.MapsManagerControl = function()\r\n{\r\n    var _this = this;\r\n    this._activeIndex = 0;\r\n    this._mapsTable = new nsGmx.ScrollTable();\r\n    this._canvas = _div(null, [['attr','id','mapsList']]);\r\n    this._mapPreview = null;\r\n    \r\n    $(this._canvas).append('<div class=\"gmx-icon-progress\"></div>');\r\n    \r\n    this._dialogDiv = showDialog(_gtxt(\"Список карт\"), this._canvas, 571, 360, 535, 130, this._resize.bind(this));\r\n    \r\n    sendCrossDomainJSONRequest(window.serverBase + \"Map/GetMaps.ashx?WrapStyle=func\", function(response)\r\n    {\r\n        $(_this._canvas).empty();\r\n        \r\n        if (!parseResponse(response))\r\n            return;\r\n\r\n        _this._drawMapsDialog(response.Result);\r\n    })\r\n    this._previewMapName = null;\r\n}\r\n\r\nnsGmx.MapsManagerControl.prototype._resize = function() {\r\n    var canvas = this._canvas,\r\n        mapsTable = this._mapsTable,\r\n        mapPreview = this._mapPreview;\r\n        \r\n    var dialogWidth = canvas.parentNode.parentNode.offsetWidth;\r\n    mapsTable.tableParent.style.width = dialogWidth - 15 - 21 + 'px';\r\n    mapsTable.tableBody.parentNode.parentNode.style.width = dialogWidth + 5 - 21 + 'px';\r\n    mapsTable.tableBody.parentNode.style.width = dialogWidth - 15 - 21 + 'px';\r\n\r\n    mapsTable.tablePages.parentNode.parentNode.parentNode.parentNode.style.width = dialogWidth - 12 - 21 + 'px';\r\n\r\n    mapsTable.tableParent.style.height = '200px';\r\n    mapsTable.tableBody.parentNode.parentNode.style.height = '170px';\r\n    \r\n    if (mapPreview) {\r\n        mapPreview.style.height = canvas.parentNode.offsetHeight - canvas.firstChild.offsetHeight - 250 + 'px';\r\n        mapPreview.style.width = dialogWidth + 5 - 21 + 'px';\r\n    }\r\n}\r\n\r\nnsGmx.MapsManagerControl.prototype._drawMapsDialog = function(mapsList)\r\n{\r\n    var searchUITemplate = Handlebars.compile(\r\n        '<div class=\"mapslist-search\">' +\r\n            '<table class=\"mapslist-search-table\"><tr>' +\r\n                '<td>' +\r\n                    '{{i \"Название\"}}<input class=\"inputStyle mapslist-search-name\">' +\r\n                '</td><td>' +\r\n                    '{{i \"Владелец\"}}<input class=\"inputStyle mapslist-search-owner\">' +\r\n                '</td>' +\r\n            '</tr></table>' +\r\n        '</div>');\r\n        \r\n    var searchCanvas = $(searchUITemplate())[0];\r\n\tvar canvas = this._canvas,\r\n\t\tname = 'maps',\r\n        mapsTable = this._mapsTable,\r\n\t\t_this = this;\r\n\t\r\n\tvar mapNameInput = $('.mapslist-search-name', searchCanvas)[0],\r\n        mapOwnerInput = $('.mapslist-search-owner', searchCanvas)[0];\r\n\t_(canvas, [searchCanvas]);\r\n\t\r\n\tvar tableParent = _div(),\r\n\t\tsortFuncs = {};\r\n\t\t\t\r\n\tvar sign = function(n1, n2) { return n1 < n2 ? -1 : (n1 > n2 ? 1 : 0) };\r\n\tvar sortFuncFactory = function(f1, f2) {\r\n\t\treturn [\r\n\t\t\tfunction(_a,_b){ return sign(f1(_a), f1(_b)) || sign(f2(_a), f2(_b)); },\r\n\t\t\tfunction(_b,_a){ return sign(f1(_a), f1(_b)) || sign(f2(_a), f2(_b)); }\r\n\t\t]\r\n\t}\r\n\t\r\n    var idFunc = function(_a){ return _a.Name; };\r\n    var titleFunc = function(_a){ return String(_a.Title).toLowerCase(); };\r\n    var ownerFunc = function(_a){ return String(_a.Owner).toLowerCase(); };\r\n    var dateFunc  = function(_a){ return _a.LastModificationDateTime; };\r\n    \r\n\tsortFuncs[_gtxt('Имя')]                 = sortFuncFactory(titleFunc, idFunc);\r\n\tsortFuncs[_gtxt('Владелец')]            = sortFuncFactory(ownerFunc, idFunc);\r\n\tsortFuncs[_gtxt('Последнее изменение')] = sortFuncFactory(dateFunc, idFunc);\r\n\t\r\n\tmapsTable.createTable(tableParent, name, 410, [\"\", _gtxt(\"Имя\"), _gtxt(\"Владелец\"), _gtxt(\"Последнее изменение\"), \"\"], ['5%', '55%', '15%', '15%', '5%'], function(map, i)\r\n    {\r\n        return _this._drawMaps.call(this, map, i, _this);\r\n    }, sortFuncs);\r\n    \r\n    mapsTable.getDataProvider().setSortFunctions(sortFuncs);\r\n\t\r\n\tvar inputPredicate = function(value, fieldValue)\r\n    {\r\n        return !!value && String(value).toLowerCase().indexOf(fieldValue) > -1;\r\n    };\r\n\r\n    $([mapNameInput, mapOwnerInput]).bind('keydown', function(event) {\r\n        var numItems = mapsTable.getVisibleItems().length;\r\n        \r\n        if (event.keyCode === 13) {\r\n            var firstItem = mapsTable.getVisibleItems()[_this._activeIndex];\r\n            firstItem && window.location.replace(window.location.href.split(/\\?|#/)[0] + \"?\" + firstItem.Name);\r\n        }\r\n        \r\n        if (event.keyCode === 38) {\r\n            _this._activeIndex = Math.max(0, Math.min(_this._activeIndex - 1, numItems - 1));\r\n            $(mapsTable.getDataProvider()).change();\r\n            event.preventDefault();\r\n        }\r\n        \r\n        if (event.keyCode === 40) {\r\n            _this._activeIndex = Math.max(0, Math.min(_this._activeIndex + 1, numItems - 1));\r\n            $(mapsTable.getDataProvider()).change();\r\n            event.preventDefault();\r\n        }\r\n    })\r\n    \r\n\tmapsTable.getDataProvider().attachFilterEvents(mapNameInput, 'Title', function(fieldName, fieldValue, vals)\r\n\t{\r\n\t\tif (fieldValue == \"\") {\r\n\t\t\treturn vals;\r\n        }\r\n        \r\n        fieldValue = fieldValue.toLowerCase();\r\n\t\t\r\n        return vals.filter(function(value) {\r\n            return inputPredicate(value[fieldName], fieldValue) || value['Name'].toLowerCase() === fieldValue;\r\n        });\r\n\t})\r\n\t\r\n\tmapsTable.getDataProvider().attachFilterEvents(mapOwnerInput, 'Owner', function(fieldName, fieldValue, vals)\r\n\t{\r\n\t\tif (fieldValue == \"\") {\r\n\t\t\treturn vals;\r\n        }\r\n        \r\n        fieldValue = fieldValue.toLowerCase();\r\n        \r\n        return vals.filter(function(value) {\r\n            return inputPredicate(value[fieldName], fieldValue);\r\n        });\r\n\t})\r\n\r\n\t_(canvas, [tableParent]);\r\n\t\r\n\tmapsTable.tableHeader.firstChild.childNodes[1].style.textAlign = 'left';\r\n\r\n\tthis._resize();\r\n\t\r\n\tmapsTable.getDataProvider().setOriginalItems(mapsList);\r\n\t\r\n\tmapNameInput.focus();\r\n}\r\n\r\nnsGmx.MapsManagerControl.prototype._drawMaps = function(map, mapIndex, mapsManager)\r\n{\r\n\tvar name = makeLinkButton(map.Title),\r\n        img_url = map.Name === mapsManager._previewMapName ? 'img/collapse-arrow-se.png' : 'img/collapse-arrow-right.gif',\r\n\t\tload = makeImageButton(img_url, img_url),\r\n\t\tremove = makeImageButton(\"img/recycle.png\", \"img/recycle_a.png\");\r\n\r\n\t_title(name, _gtxt(\"Загрузить\"));\r\n\t_title(load, _gtxt(\"Показать\"));\r\n\t_title(remove, _gtxt(\"Удалить\"));\r\n\t\r\n    name.className = name.className + ' maps-manager-mapname';\r\n\t\r\n\tname.onclick = function()\r\n\t{\r\n\t\twindow.location.replace(window.location.href.split(/\\?|#/)[0] + \"?\" + map.Name);\r\n\t}\r\n    \r\n    nsGmx.ContextMenuController.bindMenuToElem(name, 'MapListItem', function(){return true;},\r\n    {\r\n        name: map.Name\r\n\t});\r\n\t\r\n\tload.onclick = function()\r\n\t{\r\n\t\t$(mapsManager._mapPreview).empty();\r\n\t\t\r\n\t\tvar loading = _div([_img(null, [['attr','src','img/progress.gif'],['css','marginRight','10px']]), _t(_gtxt('загрузка...'))], [['css','margin','3px 0px 3px 20px']]);\r\n\t\t\r\n        if (!mapsManager._mapPreview) {\r\n            mapsManager._mapPreview = _div(null, [['css','marginTop','5px'],['css','borderTop','1px solid #216B9C'],['css','overflowY','auto']]);\r\n            $(mapsManager._canvas).append(mapsManager._mapPreview);\r\n            $(mapsManager._dialogDiv).dialog('option', 'height', 550);\r\n            $(mapsManager._dialogDiv).dialog('option', 'minHeight', 550);\r\n            mapsManager._resize();\r\n            \r\n        }\r\n\t\t_(mapsManager._mapPreview, [loading]);\r\n        \r\n\r\n\t\t// раз уж мы список получили с сервера, то и карты из этого списка точно нужно загружать с него же...\r\n\t\tmapsManager._loadMapJSON(window.serverBase, map.Name, mapsManager._mapPreview); \r\n\r\n        $(mapsManager._mapsTable.getDataProvider()).change();\r\n\t}\r\n\t\r\n\tremove.onclick = function()\r\n\t{\r\n\t\tif (map.Name == window.defaultMapID)\r\n\t\t{\r\n\t\t\tshowErrorMessage(_gtxt(\"$$phrase$$_14\"), true)\r\n\t\t\t\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (map.Name == window.globalMapName)\r\n\t\t{\r\n\t\t\tshowErrorMessage(_gtxt(\"$$phrase$$_15\"), true)\r\n\t\t\t\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (confirm(_gtxt(\"Вы действительно хотите удалить эту карту?\")))\r\n\t\t{\r\n\t\t\tvar loading = loading = _div([_img(null, [['attr','src','img/progress.gif']]), _t(_gtxt('удаление...'))], [['css','marginLeft','5px']]);\r\n\t\t\r\n\t\t\t$(remove.parentNode.parentNode).replaceWith(_tr([_td([loading], [['attr','colSpan', 5]])]))\r\n\t\t\t\r\n\t\t\tsendCrossDomainJSONRequest(window.serverBase + \"Map/Delete.ashx?WrapStyle=func&MapID=\" + map.MapID, function(response){mapsManager._deleteMapHandler(response, map.MapID)});\r\n\t\t}\r\n\t}\r\n\t\r\n\tvar date = new Date(map.LastModificationDateTime*1000);\r\n\tvar modificationDateString = $.datepicker.formatDate('dd.mm.yy', date); // + \" \" + date.getHours() + \":\" + date.getMinutes() + \":\" + date.getSeconds();\r\n\t\r\n\tvar tr = _tr([\r\n\t\t_td([load], [['css','textAlign','center']]), \r\n\t\t_td([name]), \r\n\t\t_td([_t(map.Owner)], [['css','textAlign','center'],['dir','className','invisible maps-manager-owner'], ['dir','title',map.Owner]]), \r\n\t\t_td([_t(modificationDateString)], [['css','textAlign','center'],['dir','className','invisible']]), \r\n\t\t_td([remove], [['css','textAlign','center']])\r\n\t]);\r\n\t\r\n\tfor (var i = 0; i < tr.childNodes.length; i++)\r\n\t\ttr.childNodes[i].style.width = this._fields[i].width;\r\n\t\r\n\tattachEffects(tr, 'hover');\r\n    \r\n    if (mapsManager._activeIndex === mapIndex) {\r\n        $(tr).addClass('maps-manager-active');\r\n    }\r\n\t\r\n\treturn tr;\r\n}\r\n\r\nnsGmx.MapsManagerControl.prototype._deleteMapHandler = function(response, id)\r\n{\r\n\tif (!parseResponse(response))\r\n\t\treturn;\r\n\t\r\n    var mapsTable = this._mapsTable;\r\n    \r\n\tif (response.Result == 'deleted')\r\n\t{\r\n        mapsTable.start = 0;\r\n\t\tmapsTable.reportStart = mapsTable.start * mapsTable.limit;\r\n        mapsTable.getDataProvider().filterOriginalItems(function(elem)\r\n\t\t{\r\n\t\t\treturn elem.MapID != id;\r\n\t\t});\r\n\t}\r\n\telse\r\n\t\tshowErrorMessage(_gtxt(\"Ошибка!\"), true, _gtxt(\"Слоя нет в базе\"))\r\n}\r\n\r\nnsGmx.MapsManagerControl.prototype._loadMapJSON = function(host, name, parent)\r\n{\r\n\t//loadMapJSON(host, name, function(layers)\r\n    this._previewMapName = name;\r\n    \r\n    var hostName = L.gmxUtil.normalizeHostname(host),\r\n        apiKey = window.mapsSite ? window.apiKey : null; //передаём apiKey только если не локальная версия ГеоМиксера\r\n    \r\n    L.gmx.gmxMapManager.getMap(hostName, apiKey, name, window.gmxSkipTiles).then(function(mapInfo) {\r\n        var previewLayersTree = new window.layersTree({showVisibilityCheckbox: true, allowActive: false, allowDblClick: false}),\r\n            ul = previewLayersTree.drawTree(mapInfo, 2);\r\n\r\n        $(ul).treeview();\r\n\r\n        //раскрываем группы по клику\r\n        $(ul).click(function(event) {\r\n            if ($(event.target).hasClass('groupLayer')) {\r\n                var clickDiv = $(event.target.parentNode.parentNode.parentNode).children(\"div.hitarea\");\r\n                clickDiv.length && $(clickDiv[0]).trigger('click');\r\n            }\r\n        })\r\n\t\t\r\n\t\t$(parent).empty();\r\n        \r\n        var hint = $('<div class=\"mapslist-hint\">' + _gtxt('maplist.hint') + '</div>');\r\n\r\n\t\t_(parent, [hint[0], ul]);\r\n\t\t\r\n\t\t_queryMapLayers.addDraggable(parent);\r\n\t})\r\n}\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n    title: function() { return \"Открыть в новом окне\"; },\r\n    clickCallback: function(context)\r\n    {\r\n        window.open(window.location.href.split(/\\?|#/)[0] + \"?\" + context.name, '_blank');\r\n    }\r\n}, 'MapListItem');\r\n\r\n})(nsGmx.Utils._);","﻿import nsGmx from '../nsGmx.js';\r\nimport {\r\n    inputError, showDialog,\r\n} from '../utilities.js';\r\nimport './PluginEditor.css';\r\nimport '../gmxcore.js';\r\n\r\n(function($){\r\n\r\n\"use strict\";\r\n\r\nwindow._translationsHash.addtext(\"rus\", {\r\n\"pluginsEditor.selectedTitle\" : \"Плагины карты\",\r\n\"pluginsEditor.availableTitle\" : \"Доступные плагины\",\r\n\"pluginsEditor.add\" : \"Добавить плагин\",\r\n\"pluginsEditor.paramsTitle\" : \"Параметры плагина\"\r\n});\r\n\r\nwindow._translationsHash.addtext(\"eng\", {\r\n\"pluginsEditor.selectedTitle\" : \"Map plugins\",\r\n\"pluginsEditor.availableTitle\" : \"Available plugins\",\r\n\"pluginsEditor.add\" : \"Add plugin\",\r\n\"pluginsEditor.paramsTitle\" : \"Parameter of plugin\"\r\n});\r\n\r\n\r\nvar MapPlugins = function()\r\n{\r\n    var _plugins = [];\r\n    var _params = {};\r\n\r\n    //вместо массива из одного элемента передаём сам элемент\r\n    var normalizeParams = function(params) {\r\n        var res = {};\r\n        for (var p in params) {\r\n            res[p] = params[p].length === 1 ? params[p][0] : params[p];\r\n        }\r\n\r\n        return res;\r\n    }\r\n\r\n    this.addPlugin = function(pluginName, pluginParams, onlyParams)\r\n    {\r\n        _params[pluginName] = pluginParams || _params[pluginName] || {};\r\n\r\n        if (!onlyParams && _plugins.indexOf(pluginName) === -1) {\r\n            _plugins.push(pluginName);\r\n        }\r\n\r\n        $(this).change();\r\n\r\n        return true;\r\n    }\r\n\r\n    this.each = function(callback) {\r\n        for (var p = 0; p < _plugins.length; p++) {\r\n            callback(_plugins[p], _params[_plugins[p]] || {});\r\n        }\r\n    }\r\n\r\n    this.remove = function(pluginName) {\r\n        var nameIndex = _plugins.indexOf(pluginName);\r\n        if (nameIndex !== -1) {\r\n            _plugins.splice(nameIndex, 1);\r\n            $(this).change();\r\n        }\r\n    }\r\n\r\n    this.isExist = function(pluginName)\r\n    {\r\n        return _plugins.indexOf(pluginName) !== -1;\r\n    }\r\n\r\n    this.getPluginParams = function(pluginName) {\r\n        return _params[pluginName];\r\n    }\r\n\r\n    this.setPluginParams = function(pluginName, pluginParams) {\r\n        _params[pluginName] = pluginParams;\r\n        $(this).change();\r\n    }\r\n\r\n    //обновляем используемость и параметры плагинов\r\n    this.updateGeomixerPlugins = function() {\r\n        for (let p = 0; p < _plugins.length; p++) {\r\n            let plugin = nsGmx.pluginsManager.getPluginByName(_plugins[p]),\r\n                lazyLoad = plugin && plugin.lazyLoad;\r\n\r\n            nsGmx.pluginsManager.setUsePlugin(_plugins[p], !lazyLoad);\r\n        }\r\n\r\n        for (let p in _params) {\r\n            nsGmx.pluginsManager.updateParams(p, normalizeParams(_params[p]));\r\n        }\r\n    }\r\n\r\n    this.load = function(data, version) {\r\n        if (version === 1) {\r\n            _plugins = data;\r\n            _params = {};\r\n        } else if (version === 2) {\r\n            _plugins = [];\r\n            _params = {};\r\n            for (var p = 0; p < data.length; p++) {\r\n                _plugins.push(data[p].name);\r\n                _params[data[p].name] = data[p].params;\r\n            }\r\n        } else if (version === 3) {\r\n            _plugins = data.plugins;\r\n\r\n            //поддержка ошибки, которая прокралась в базу...\r\n            if ($.isArray(data.params) && data.params.length === 0) {\r\n                _params = {};\r\n            } else {\r\n                _params = data.params;\r\n            }\r\n        }\r\n    }\r\n\r\n    this.save = function(version) {\r\n        if (version === 1) {\r\n            return _plugins;\r\n        } else if (version === 2) {\r\n            var res = [];\r\n            _plugins.forEach(function(name) {\r\n                res.push({name: name, params: _params[name]});\r\n            })\r\n            return res;\r\n        } else if (version === 3) {\r\n            return {\r\n                plugins: _plugins,\r\n                params: _params\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar GeomixerPluginsWidget = function(container, mapPlugins)\r\n{\r\n    var template = Handlebars.compile('<div class=\"pluginsEditor-allPlugins-container\">' +\r\n        '<div class=\"pluginEditor-widgetHeader\">{{i \"pluginsEditor.availableTitle\"}}</div>' +\r\n        '<div class=\"pluginEditor-treePlaceholder\"></div>' +\r\n        '<div class=\"pluginEditor-controls\">' +\r\n            '<input class=\"inputStyle inputFullWidth pluginEditor-pluginInput\"><br>' +\r\n            '<button class=\"pluginEditor-addButton\">{{i \"pluginsEditor.add\"}}</button>' +\r\n        '</div>' +\r\n    '</div>');\r\n\r\n    var lang = window.nsGmx.Translations.getLanguage();\r\n\r\n    var DEFAULT_GROUP_NAME = {\r\n        eng: 'Main',\r\n        rus: 'Основные'\r\n    };\r\n\r\n    var _allPluginGroups = {},\r\n        configGroups = window.gmxPluginGroups || [],\r\n        groupByPluginName = [],\r\n        groupOrder = {};\r\n\r\n    configGroups.forEach(function(group, index) {\r\n        groupOrder[group[lang]] = index;\r\n        group.plugins.forEach(function(plugin) {\r\n            groupByPluginName[plugin] = group[lang];\r\n        })\r\n    })\r\n\r\n    nsGmx.pluginsManager.forEachPlugin(function(plugin)\r\n    {\r\n        if ( plugin.pluginName && plugin.mapPlugin && (plugin.isPublic || nsGmx.AuthManager.isRole(nsGmx.ROLE_ADMIN)) )\r\n        {\r\n            var groupName = groupByPluginName[plugin.pluginName] || DEFAULT_GROUP_NAME[lang];\r\n            _allPluginGroups[groupName] = _allPluginGroups[groupName] || {groupName: groupName, plugins: []};\r\n            _allPluginGroups[groupName].plugins.push({name: plugin.pluginName, isPublic: plugin.isPublic});\r\n            //_allPlugins.push({name: plugin.pluginName, isPublic: plugin.isPublic});\r\n        }\r\n    })\r\n\r\n    //по алфавиту\r\n    for (var g in _allPluginGroups) {\r\n        _allPluginGroups[g].plugins.sort(function(a, b) {\r\n            return a.name > b.name ? 1 : -1;\r\n        })\r\n    }\r\n\r\n    var isListActive = false;\r\n    var update = function()\r\n    {\r\n        $(container).empty();\r\n\r\n        var filteredGroups = [];\r\n        for (var g in _allPluginGroups) {\r\n            var plugins = _allPluginGroups[g].plugins.filter(function(plugin) {return !mapPlugins.isExist(plugin.name);});\r\n            //если в группе нет плагинов, не показываем её\r\n            plugins.length && filteredGroups.push({\r\n                groupName: _allPluginGroups[g].groupName,\r\n                plugins: plugins\r\n            });\r\n        }\r\n\r\n        //сохраняем порядок, как в конфиге, default group - первой\r\n        filteredGroups.sort(function(a, b) {\r\n            return groupOrder[a.groupName] - groupOrder[b.groupName];\r\n        });\r\n\r\n        var pluginGroupTemplate = Handlebars.compile('<ul class=\"pluginEditor-pluginsTree ui-helper-noselect\">{{#groups}}' +\r\n            '<li>' +\r\n                '<div class=\"pluginEditor-groupTitle\">{{groupName}}</div>' +\r\n                '<ul>{{#plugins}}' +\r\n                    '<li class=\"pluginEditor-pluginItem ui-helper-noselect\" data-plugin-name=\"{{name}}\">{{name}}</li>' +\r\n                '{{/plugins}}</ul>' +\r\n            '</li>' +\r\n            '{{/groups}}</ul>');\r\n\r\n        var pluginsTree = $(pluginGroupTemplate({groups: filteredGroups}));\r\n\r\n        pluginsTree.find('.pluginEditor-pluginItem').click(function(e) {\r\n            isListActive = true;\r\n            // var pluginName = $(this).data('pluginName');\r\n\r\n            if (e.ctrlKey) {\r\n                $(this).toggleClass('pluginEditor-activePluginItem');\r\n            } else {\r\n                pluginsTree.find('.pluginEditor-pluginItem').removeClass('pluginEditor-activePluginItem');\r\n                $(this).addClass('pluginEditor-activePluginItem');\r\n            }\r\n        });\r\n\r\n        pluginsTree.find('.pluginEditor-groupTitle').click(function() {\r\n            $(this).siblings('.hitarea').click();\r\n        })\r\n\r\n        var ui = $(template());\r\n\r\n        ui.find('.pluginEditor-treePlaceholder').append(pluginsTree);\r\n\r\n        ui.find('.pluginEditor-pluginInput').bind('focus', function() {\r\n            isListActive = false;\r\n        });\r\n\r\n        ui.find('.pluginEditor-addButton').click(function() {\r\n            var selected = [];\r\n\r\n            if (isListActive) {\r\n                pluginsTree.find('.pluginEditor-activePluginItem').each(function(i, elem) {\r\n                    selected.push($(elem).data('pluginName'));\r\n                });\r\n            } else {\r\n                var pluginInput = ui.find('.pluginEditor-pluginInput');\r\n                if (nsGmx.pluginsManager.getPluginByName(pluginInput.val())) {\r\n                    selected.push(pluginInput.val());\r\n                } else {\r\n                    inputError(pluginInput[0]);\r\n                }\r\n            }\r\n\r\n            for (var sp = 0; sp < selected.length; sp++)\r\n                mapPlugins.addPlugin( selected[sp] );\r\n        });\r\n\r\n        ui.appendTo(container);\r\n\r\n        pluginsTree.treeview(/*{collapsed: true}*/);\r\n    }\r\n\r\n    $(mapPlugins).change(update);\r\n    update();\r\n}\r\n\r\nvar paramsWidgets = {};\r\n\r\nvar MapPluginParamsWidget = function(mapPlugins, pluginName) {\r\n\r\n    if (paramsWidgets[pluginName]) {\r\n        return;\r\n    }\r\n\r\n    var FakeTagMetaInfo = function()\r\n    {\r\n        this.isTag = function() { return true; }\r\n        this.getTagType = function() { return 'String'; }\r\n        this.getTagDescription = function() { return ''; }\r\n        this.getTagArray = function() { return []; }\r\n        this.getTagArrayExt = function() { return []; }\r\n    };\r\n    var fakeTagMetaInfo = new FakeTagMetaInfo();\r\n\r\n    var pluginParams =  mapPlugins.getPluginParams(pluginName);\r\n    var tagInitInfo = {};\r\n\r\n    for (var tagName in pluginParams) {\r\n        tagInitInfo[tagName] = {Value: pluginParams[tagName]};\r\n    }\r\n\r\n    var layerTags = new nsGmx.LayerTagsWithInfo(fakeTagMetaInfo, tagInitInfo);\r\n\r\n    var container = $('<div/>');\r\n\r\n    new nsGmx.LayerTagSearchControl(layerTags, container);\r\n\r\n    var updateParams = function() {\r\n        var newParams = {};\r\n        layerTags.eachValid(function(tagid, tag, value) {\r\n            newParams[tag] = newParams[tag] || [];\r\n            newParams[tag].push(value);\r\n        })\r\n\r\n        mapPlugins.setPluginParams(pluginName, newParams);\r\n    }\r\n\r\n    var dialogDiv = showDialog(\r\n            _gtxt('pluginsEditor.paramsTitle') + \" \" + pluginName,\r\n            container[0],\r\n            {\r\n                width: 320,\r\n                height: 200,\r\n                closeFunc: function() {\r\n                    updateParams();\r\n                    delete paramsWidgets[pluginName];\r\n                }\r\n            }\r\n        );\r\n\r\n    paramsWidgets[pluginName] = {\r\n        update: updateParams,\r\n        closeDialog: function() {\r\n            $(dialogDiv).dialog('close');\r\n        }\r\n    };\r\n\r\n}\r\n\r\nvar MapPluginsWidget = Backbone.View.extend({\r\n    template: Handlebars.compile(\r\n        '<div class=\"pluginEditor-widgetHeader\">{{i \"pluginsEditor.selectedTitle\"}}</div>' +\r\n        '<div class=\"pluginEditor-currentMapPlugins\">' +\r\n            '{{#plugins}}' +\r\n                '<div class=\"pluginEditor-widgetElem\">' +\r\n                    '{{#unless isCommon}}' +\r\n                        '<span class=\"pluginEditor-remove gmx-icon-close\" data-plugin-name=\"{{name}}\"></span>' +\r\n                    '{{/unless}}' +\r\n                    '<span class=\"pluginEditor-edit gmx-icon-edit\" data-plugin-name=\"{{name}}\"></span>' +\r\n                    '<span class=\"pluginEditor-title {{#if isCommon}} pluginEditor-commonPlugin{{/if}}\">{{name}}</span>' +\r\n                '</div>' +\r\n            '{{/plugins}}' +\r\n        '</div>'\r\n    ),\r\n\r\n    events: {\r\n        'click .gmx-icon-close': function(event) {\r\n            var pluginName = $(event.target).data('pluginName');\r\n            this._mapPlugins.remove(pluginName);\r\n        },\r\n\r\n        'click .gmx-icon-edit': function(event) {\r\n            var pluginName = $(event.target).data('pluginName');\r\n            new MapPluginParamsWidget(this._mapPlugins, pluginName);\r\n        }\r\n    },\r\n\r\n    initialize: function(options) {\r\n        this._mapPlugins = options.mapPlugins;\r\n        $(this._mapPlugins).change(this.render.bind(this));\r\n        this.render();\r\n    },\r\n\r\n    render: function() {\r\n        var mapPlugins = this._mapPlugins,\r\n            pluginsToShow = [];\r\n\r\n        nsGmx.pluginsManager.forEachPlugin(function(plugin) {\r\n            if ( plugin.pluginName && !plugin.mapPlugin && !mapPlugins.isExist(plugin.pluginName) ) {\r\n                pluginsToShow.push({\r\n                    name: plugin.pluginName,\r\n                    isCommon: true\r\n                });\r\n            }\r\n        });\r\n\r\n        mapPlugins.each(function(name) {\r\n            pluginsToShow.push({\r\n                name: name,\r\n                isCommon: false\r\n            });\r\n        });\r\n\r\n        pluginsToShow.sort(function(a, b) {\r\n            return a.isCommon != b.isCommon ? Number(b.isCommon) - Number(a.isCommon) : (a.name > b.name ? 1 : -1);\r\n        });\r\n\r\n        this.$el.empty().append(this.template({plugins: pluginsToShow}));\r\n    }\r\n});\r\n\r\nvar createPluginsEditor = function(container, mapPlugins)\r\n{\r\n    var widgetContainer = $('<div/>', {'class': 'pluginEditor-widgetContainer'});\r\n    var allPluginsContainer = $('<div/>', {'class': 'pluginEditor-allContainer'});\r\n    new MapPluginsWidget({\r\n        el: widgetContainer,\r\n        mapPlugins: mapPlugins\r\n    });\r\n    new GeomixerPluginsWidget(allPluginsContainer, mapPlugins);\r\n\r\n    $(container)\r\n        .append($('<table/>', {'class': 'pluginEditor-table'}).append($('<tr/>')\r\n            .append($('<td/>', {'class': 'pluginEditor-allTD'}).append(allPluginsContainer))\r\n            .append($('<td/>', {'class': 'pluginEditor-widgetTD'}).append(widgetContainer))\r\n        ));\r\n\r\n    return {\r\n        update: function() {\r\n            for (var name in paramsWidgets) {\r\n                paramsWidgets[name].update();\r\n            }\r\n        },\r\n        closeParamsDialogs: function() {\r\n            for (var name in paramsWidgets) {\r\n                paramsWidgets[name].closeDialog();\r\n            }\r\n        }\r\n    };\r\n}\r\n\r\nwindow.gmxCore.addModule('PluginsEditor', {\r\n    createPluginsEditor: createPluginsEditor,\r\n    MapPlugins: MapPlugins\r\n})\r\n\r\nnsGmx.createPluginsEditor = createPluginsEditor;\r\n_mapHelper.mapPlugins = new MapPlugins();\r\n\r\n//Cтарая версия информации о плагинах карты. Поддерживается для обратной совместимости (например, загрузка доп. карт)\r\n//Формат: {String[]} массив имён плагинов\r\nnsGmx.userObjectsManager.addDataCollector('mapPlugins', {\r\n    load: function(data)\r\n    {\r\n        if (data) {\r\n            _mapHelper.mapPlugins.load(data, 1);\r\n            _mapHelper.mapPlugins.updateGeomixerPlugins();\r\n        }\r\n    },\r\n    collect: function() {\r\n        return _mapHelper.mapPlugins.save(1);\r\n    }\r\n})\r\n\r\n//Вторая версия информации о плагинах карты.\r\n//Формат: [{name: pluginName1, params: {param: value, ...}}, ...]\r\nnsGmx.userObjectsManager.addDataCollector('mapPlugins_v2', {\r\n    load: function(data)\r\n    {\r\n        if (data) {\r\n            _mapHelper.mapPlugins.load(data, 2);\r\n            _mapHelper.mapPlugins.updateGeomixerPlugins();\r\n        }\r\n    },\r\n    collect: function()\r\n    {\r\n        return _mapHelper.mapPlugins.save(2);\r\n    }\r\n})\r\n\r\n//Третья версия информации о плагинах карты.\r\n//Формат: {plugins: [name1, ....], params: {name1: {param1: value1, ...}, ...}}\r\nnsGmx.userObjectsManager.addDataCollector('mapPlugins_v3', {\r\n    load: function(data)\r\n    {\r\n        if (data) {\r\n            _mapHelper.mapPlugins.load(data, 3);\r\n            _mapHelper.mapPlugins.updateGeomixerPlugins();\r\n        }\r\n    },\r\n    collect: function()\r\n    {\r\n        return _mapHelper.mapPlugins.save(3);\r\n    }\r\n})\r\n\r\n})(jQuery);\r\n","﻿import nsGmx from '../nsGmx.js';\r\nimport './NotificationWidget.css';\r\n\r\n(function() {    \r\n    window.nsGmx.widgets = window.nsGmx.widgets || {};\r\n    nsGmx.widgets.notifications = {\r\n        _container: null,\r\n        _actions: [],\r\n        _messagesToShow: [],\r\n        _messageTimer: null,\r\n        _currentStatusClass: '',\r\n        \r\n        startAction: function(actionId) {\r\n            this._initContainerLazy();\r\n            if (this._actions.indexOf(actionId) === -1) {\r\n                this._actions.push(actionId);\r\n                this._container.find('.notification-process').show();\r\n            }\r\n        },\r\n        \r\n        //supported statuses: success, failure, warning\r\n        stopAction: function(actionId, status, message, timeout) {\r\n            var index = this._actions.indexOf(actionId);\r\n            \r\n            if (index !== -1) {\r\n                this._actions.splice(index, 1);\r\n                this._container.find('.notification-process').toggle(this._actions.length);\r\n            }\r\n                \r\n            if (message) {\r\n                timeout = typeof timeout !== 'undefined' ? timeout : 1500;\r\n                this._messagesToShow.push({text: message, status: status, timeout: timeout});\r\n                this._checkMessages();\r\n            }\r\n        },\r\n        \r\n        _checkMessages: function() {\r\n            if (this._messageTimer || !this._messagesToShow.length) {\r\n                return;\r\n            }\r\n            \r\n            var msg = this._messagesToShow.shift();\r\n            var statusClass = 'notification-' + msg.status;\r\n            this._initContainerLazy();\r\n            this._container.find('.notification-message')\r\n                .show().text(msg.text)\r\n                .removeClass(this._currentStatusClass)\r\n                .addClass(statusClass);\r\n                \r\n            if (msg.timeout) {\r\n                this._messageTimer = setTimeout(function(){\r\n                    this._messageTimer = null;\r\n                    this._container.find('.notification-message').hide();\r\n                    this._checkMessages();\r\n                }.bind(this), msg.timeout);\r\n            }\r\n        },\r\n        \r\n        _initContainerLazy: function() {\r\n            if (this._container) {\r\n                return;\r\n            }\r\n            \r\n            this._container = $(Handlebars.compile(\r\n                '<div class=\"notification-container\">' +\r\n                    '<span class=\"notification-process\"></span>' +\r\n                    '<span class=\"notification-message\"></span>' +\r\n                '</div>')()).appendTo($('#flash'));\r\n                \r\n            this._container.find('.notification-message, .notification-process').hide();\r\n        }\r\n    }\r\n})();","﻿import nsGmx from './nsGmx.js';\r\nimport {\r\n    makeImageButton, parseResponse,\r\n    sendCrossDomainJSONRequest\r\n} from './utilities.js';\r\n\r\n(function()\r\n{\r\n    /**\r\n    Хранит информацию о тегах: типы и описание\r\n    @memberOf nsGmx\r\n    @class\r\n    @param {Object} initTagsInfo - описание тегов вида tagName: {Type: , Description: }\r\n    */\r\n    var TagMetaInfo = function(initTagsInfo)\r\n    {\r\n        var tags = initTagsInfo || {};\r\n\r\n        this.isTag = function(tag)\r\n        {\r\n            return tag in tags;\r\n        }\r\n\r\n        this.getTagType = function(tag)\r\n        {\r\n            return tag in tags ? tags[tag].Type : null;\r\n        }\r\n\r\n        this.getTagDescription = function(tag)\r\n        {\r\n            return tag in tags ? tags[tag].Description : null;\r\n        }\r\n\r\n        this.getTagArray = function()\r\n        {\r\n            var res = [];\r\n            for (var t in tags)\r\n                res.push(t);\r\n            return res;\r\n        }\r\n\r\n        this.getTagArrayExt = function()\r\n        {\r\n            var res = [];\r\n            for (var t in tags)\r\n                res.push( {name: t, type: tags[t].Type, desc: tags[t].Description} );\r\n\r\n            return res;\r\n        }\r\n    };\r\n\r\n    (function()\r\n    {\r\n        var def;\r\n\r\n        /** Загружает данные о доступных тегах с сервера\r\n        * @memberOf nsGmx.TagMetaInfo\r\n        * @name loadFromServer\r\n        * @function\r\n        * @param {function(tagInfo)} [callback] Ф-ция, которая будет вызвана после загрузки информации о типах.\r\n        * @return {jQuery.Deferred} Будет заресолвен после получения информации о типах\r\n        */\r\n        TagMetaInfo.loadFromServer = function(callback)\r\n        {\r\n            if (!def)\r\n            {\r\n                def = $.Deferred();\r\n                sendCrossDomainJSONRequest(window.serverBase + 'Layer/MetaKeys.ashx', function(response)\r\n                {\r\n                    if (!parseResponse(response))\r\n                    {\r\n                        def.resolve();\r\n                        return;\r\n                    }\r\n                    def.resolve(new TagMetaInfo(response.Result));\r\n                })\r\n            }\r\n            callback && def.done(callback);\r\n            return def;\r\n        }\r\n    })();\r\n\r\n    var extendClass = function(base, sub) {\r\n        function ctor() {}\r\n\r\n        ctor.prototype = base.prototype;\r\n        sub.prototype = new ctor();\r\n        sub.prototype.constructor = sub;\r\n    }\r\n\r\n    var LayerTags = function(initTags)\r\n    {\r\n        /** Вызывается при изменении набора тегов слоя\r\n            @name nsGmx.LayerTags.change\r\n            @event\r\n        */\r\n\r\n        this._uniqueID = 1;\r\n        this._tags = {};\r\n\r\n        for (var tag in initTags) {\r\n            var values = initTags[tag].Value;\r\n            if (!$.isArray(values)) {\r\n                values = [values];\r\n            }\r\n\r\n            for (var i = 0; i < values.length; i++) {\r\n                this.addNewTag(tag, values[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    LayerTags.prototype = {\r\n        _verificationFunctions: {\r\n            'Number': function(value)\r\n            {\r\n                return value.length && !isNaN(Number(value));\r\n            },\r\n            'String': function()\r\n            {\r\n                return true;\r\n            },\r\n            'Date': function(value)\r\n            {\r\n                try {\r\n                    $.datepicker.parseDate('dd.mm.yy', value);\r\n                    return true;\r\n                }\r\n                catch (e) {\r\n                    return false;\r\n                }\r\n            }\r\n        },\r\n\r\n        _isValidTypeValue: function(type, value)\r\n        {\r\n            return !(type in this._verificationFunctions) || this._verificationFunctions[type](value);\r\n        },\r\n\r\n        updateTag: function(id, tag, value, type)\r\n        {\r\n            var tags = this._tags;\r\n            if ( !(id in tags) ) return false;\r\n            if ( tags[id].tag !== tag || tags[id].value !== value || tags[id].type !== type)\r\n            {\r\n                tags[id] = {tag: tag, value: value, type: type};\r\n                $(this).change();\r\n            }\r\n\r\n            return true;\r\n        },\r\n\r\n        deleteTag: function(id)\r\n        {\r\n            if ( !(id in this._tags) ) return;\r\n\r\n            delete this._tags[id];\r\n            $(this).change();\r\n        },\r\n\r\n        each: function(callback)\r\n        {\r\n            var tags = this._tags;\r\n            for (var tagId in tags)\r\n                callback(tagId, tags[tagId].tag, tags[tagId].value, tags[tagId].type);\r\n        },\r\n\r\n        eachValid: function(callback, allowUnknownTags)\r\n        {\r\n            var tags = this._tags;\r\n            for (var tagId in tags)\r\n                if ((allowUnknownTags || this.isValidValue(tagId)) && !this.isEmptyTag(tagId))\r\n                    callback(tagId, tags[tagId].tag, tags[tagId].value, tags[tagId].type);\r\n        },\r\n\r\n        addNewTag: function(tag, value, type)\r\n        {\r\n            if (typeof value === 'undefined' || value === null) {\r\n                value = '';\r\n            }\r\n\r\n            var newId = 'id' + (++this._uniqueID);\r\n            this._tags[newId] = {tag: tag || '', value: value, type: type};\r\n            $(this).change();\r\n            return newId;\r\n        },\r\n\r\n        isTag: function(tagId)\r\n        {\r\n            return tagId in this._tags;\r\n        },\r\n\r\n        isEmptyTag: function(tagId)\r\n        {\r\n            var tags = this._tags;\r\n            return tagId in tags && tags[tagId].tag === '' && tags[tagId].value === '';\r\n        },\r\n\r\n        isValidValue: function(tagId)\r\n        {\r\n            var tags = this._tags;\r\n            return tagId in tags && this._isValidTypeValue(tags[tagId].type, tags[tagId].value);\r\n        },\r\n\r\n        getTag: function(tagId)\r\n        {\r\n            return this._tags[tagId];\r\n        },\r\n\r\n        getTagByName: function(tagName)\r\n        {\r\n            var tags = this._tags;\r\n            for (var tagId in tags)\r\n                if (tags[tagId].tag == tagName)\r\n                    return tags[tagId];\r\n        },\r\n\r\n        getTagIdByName: function(tagName)\r\n        {\r\n            var tags = this._tags;\r\n            for (var tagId in tags)\r\n                if (tags[tagId].tag == tagName)\r\n                    return tagId;\r\n        }\r\n    }\r\n\r\n    /**\r\n        Набор тегов (метаданных) слоя из определённого набора тегов\r\n        @memberOf nsGmx\r\n        @class\r\n        @param {nsGmx.TagMetaInfo} tagMetaInfo описание типов тегов\r\n        @param {Object} initTags теги для инициализации. Формат: {tagName: {Value: tagValue}, ...}. tagValue может быть массивом\r\n    */\r\n    var LayerTagsWithInfo = function(tagMetaInfo, initTags) {\r\n\r\n        // чтобы можно было расширять существующий объект LayerTags\r\n        if (this instanceof LayerTagsWithInfo) {\r\n            LayerTags.call(this, initTags);\r\n        }\r\n\r\n        this.getTagMetaInfo = function()\r\n        {\r\n            return tagMetaInfo;\r\n        }\r\n\r\n        this.isKnownTagname = function(tagname)\r\n        {\r\n            return tagMetaInfo.isTag(tagname);\r\n        }\r\n\r\n        this.addNewTag = function(tag, value, type)\r\n        {\r\n            type = type || tagMetaInfo.getTagType(tag) || '';\r\n            LayerTags.prototype.addNewTag.call(this, tag, value, type);\r\n        }\r\n\r\n        this.updateTag = function(id, tag, value) {\r\n            var type = tagMetaInfo.getTagType(tag);\r\n            LayerTags.prototype.updateTag.call(this, id, tag, value, type);\r\n        }\r\n    }\r\n\r\n    extendClass(LayerTags, LayerTagsWithInfo);\r\n\r\n    /**\r\n        Контрол для задания набора тегов (например, для слоя)\r\n        @memberOf nsGmx\r\n        @class\r\n    */\r\n    var LayerTagSearchControl = function(layerTags, container, params)\r\n    {\r\n        var _params = $.extend({\r\n            inputWidth: 130,\r\n            tagHeader: _gtxt('Параметр'),\r\n            valueHeader: _gtxt('Значение')\r\n        }, params )\r\n        var mainTable = $('<table/>', {'class': 'layertags-table'}).appendTo(container);\r\n        mainTable.append($('<tr/>')\r\n            .append($('<th/>').text(_params.tagHeader))\r\n            .append($('<th/>').text(_params.valueHeader))\r\n            .append($('<th/>'))\r\n        );\r\n\r\n        //добавляем к body элемент с id чтобы добавить к нему jQuery autocomplete и задать стили\r\n        //к текущему виджету добавить нельзя, так как он ещё не добавлен в общее дерево, а виджет ac требует глобального селектора\r\n        if ($('#layertagstable').length == 0)\r\n            $('body').append($('<div id=\"layertagstable\"></div>'));\r\n\r\n        var rows = {}; //ссылки на контролы для каждого элемента\r\n        var rowsVector = [];\r\n\r\n        //в зависимости от типа ввода (type), прикрепляет к valueInput виджет выбора даты, время или даты/время\r\n        var updateInput = function(valueInput, type)\r\n        {\r\n            if ( type == 'Date' )\r\n            {\r\n                $(valueInput).timepicker('destroy');\r\n                $(valueInput).datetimepicker('destroy');\r\n\r\n                $(valueInput).datepicker(\r\n                {\r\n                    onSelect: function() {\r\n                        $(this).change();\r\n                    },\r\n                    changeMonth: true,\r\n                    changeYear: true,\r\n                    dateFormat: \"dd.mm.yy\"\r\n                });\r\n\r\n            }\r\n            else if ( type == 'DateTime' )\r\n            {\r\n                $(valueInput).timepicker('destroy');\r\n                $(valueInput).datepicker('destroy');\r\n\r\n                $(valueInput).datetimepicker(\r\n                {\r\n                    changeMonth: true,\r\n                    changeYear: true,\r\n                    dateFormat: \"dd.mm.yy\",\r\n                    timeFormat: \"HH:mm:ss\",\r\n                    showSecond: true,\r\n                    timeOnly: false\r\n                }).addClass('layertags-datetimeinput');\r\n            }\r\n            else if ( type == \"Time\" )\r\n            {\r\n\r\n                $(valueInput).datepicker('destroy');\r\n                $(valueInput).datetimepicker('destroy');\r\n\r\n                $(valueInput).timepicker({\r\n                    timeOnly: true,\r\n                    timeFormat: \"HH:mm:ss\",\r\n                    showSecond: true\r\n                });\r\n            }\r\n            else\r\n            {\r\n                $(valueInput).timepicker('destroy');\r\n                $(valueInput).datetimepicker('destroy');\r\n                $(valueInput).datepicker('destroy');\r\n            }\r\n        }\r\n\r\n        var validateRow = function(row)\r\n        {\r\n            if ( !layerTags.isEmptyTag(row.id) && !layerTags.isKnownTagname(row.tag.val()) )\r\n                row.tag.addClass('error');\r\n            else\r\n                row.tag.removeClass('error');\r\n\r\n            if (!layerTags.isEmptyTag(row.id) && !layerTags.isValidValue(row.id) )\r\n                row.value.addClass('error');\r\n            else\r\n                row.value.removeClass('error');\r\n        }\r\n\r\n        var addNewRow = function(tagId, tag, value)\r\n        {\r\n            var tagInput = $('<input/>', {'class': 'inputStyle'}).val(tag).css('width', _params.inputWidth).autocomplete({\r\n                source: layerTags.getTagMetaInfo().getTagArrayExt(),\r\n                minLength: 0,\r\n                delay: 0,\r\n                appendTo: \"#layertagstable\",\r\n                select: function(event, ui)\r\n                {\r\n                    tagInput.val(ui.item.name);\r\n                    updateModel(ui.item.name, valueInput.val().trim());\r\n                    return false;\r\n                }\r\n            }).bind('click', function(){\r\n                $(tagInput).autocomplete(\"search\", \"\");\r\n            });\r\n\r\n            tagInput.data( \"ui-autocomplete\" )._renderItem = function( ul, item )\r\n            {\r\n                return $( \"<li/>\")\r\n                    .append($(\"<a/>\", {title: item.desc}).text(item.name))\r\n                    .appendTo( ul );\r\n            }\r\n\r\n            var valueInput = $('<input/>', {'class': 'inputStyle'}).val(value).css('width', _params.inputWidth);\r\n\r\n            var type = layerTags.getTagMetaInfo().getTagType(tag);\r\n            updateInput(valueInput, type);\r\n\r\n\r\n            var updateModel = function()\r\n            {\r\n                layerTags.updateTag(tagId, tagInput.val().trim(), valueInput.val().trim());\r\n            }\r\n\r\n            tagInput.bind('keyup change', updateModel);\r\n            valueInput.bind('keyup change', updateModel);\r\n\r\n            var deleteButton = makeImageButton('img/recycle.png', 'img/recycle_a.png');\r\n            deleteButton.onclick = function()\r\n            {\r\n                layerTags.deleteTag(tagId);\r\n            }\r\n\r\n            var tr = $('<tr/>')\r\n                .append($('<td/>').append(tagInput))\r\n                .append($('<td/>').append(valueInput))\r\n                .append($('<td/>', {'class': 'layertags-delete'}).append(deleteButton));\r\n\r\n            mainTable.append(tr);\r\n\r\n            rows[tagId] = {id: tagId, tr: tr, tag: tagInput, value: valueInput, type: type};\r\n            rowsVector.push(rows[tagId]);\r\n            validateRow(rows[tagId]);\r\n        }\r\n\r\n        var moveEmptyLayersToBottom = function()\r\n        {\r\n            var lastEmptyId = -1;\r\n            for (var irow = 0; irow < rowsVector.length; irow++)\r\n                if (layerTags.isEmptyTag(rowsVector[irow].id))\r\n                    lastEmptyId = irow;\r\n\r\n            if (lastEmptyId >= 0 && lastEmptyId < rowsVector.length)\r\n            {\r\n                var tr = rowsVector[lastEmptyId].tr;\r\n                $(tr).detach();\r\n                mainTable.append(tr);\r\n            }\r\n        }\r\n\r\n        $(layerTags).change(function()\r\n        {\r\n            var isAnyEmpty = false;\r\n            layerTags.each(function(tagId, tag, value)\r\n            {\r\n                if (tag == '' && value == '')\r\n                    isAnyEmpty = true;\r\n\r\n                if (!(tagId in rows))\r\n                    addNewRow(tagId, tag, value);\r\n                else\r\n                {\r\n                    if (rows[tagId].tag.val() !== tag)\r\n                        rows[tagId].tag.val(tag)\r\n\r\n                    if (rows[tagId].value.val() !== value)\r\n                        rows[tagId].value.val(value)\r\n\r\n\r\n                    var type = layerTags.getTagMetaInfo().getTagType(tag);\r\n                    if (rows[tagId].type !== type)\r\n                    {\r\n                        rows[tagId].type = type;\r\n                        updateInput(rows[tagId].value, type);\r\n                    }\r\n\r\n                    validateRow(rows[tagId]);\r\n                }\r\n            });\r\n\r\n            for (var tagId in rows)\r\n            {\r\n                if (!(layerTags.isTag(tagId)))\r\n                {\r\n                    rows[tagId].tr.remove();\r\n                    delete rows[tagId];\r\n                }\r\n            }\r\n\r\n            if (!isAnyEmpty)\r\n                layerTags.addNewTag();\r\n\r\n            moveEmptyLayersToBottom();\r\n        });\r\n\r\n        layerTags.addNewTag();\r\n    }\r\n\r\n    nsGmx.LayerTagSearchControl = LayerTagSearchControl;\r\n    nsGmx.LayerTags = LayerTags;\r\n    nsGmx.LayerTagsWithInfo = LayerTagsWithInfo;\r\n    nsGmx.TagMetaInfo = TagMetaInfo;\r\n})();\r\n","﻿//Управление показом списка слоёв и поиска по этому списку\r\nimport nsGmx from './nsGmx.js';\r\nimport './LayerTagsControl.js';\r\nimport {\r\n    attachEffects,        \r\n    _div,    \r\n    _img,\r\n    _input,    \r\n    makeImageButton,\r\n    _option,    \r\n    parseResponse,\r\n    sendCrossDomainJSONRequest,\r\n    showErrorMessage,\r\n    _span,\r\n    _t,\r\n    _table,\r\n    _tbody,\r\n    _title,\r\n    _tr,\r\n    _td,    \r\n} from './utilities.js';\r\n\r\n(function(_){\r\n\r\nvar LayersListProvider = function(filtersProvider)\r\n{\r\n    var _this = this;\r\n    $(filtersProvider).change(function()\r\n    {\r\n        $(_this).change();\r\n    });\r\n\r\n    var getQueryText = function()\r\n    {\r\n        var filterStrings = [];\r\n\r\n        if (filtersProvider.getTitle() !== '')\r\n            filterStrings.push(\"([Title] containsIC '\" + filtersProvider.getTitle() + \"' or [Name] = GetLayerName('\" + filtersProvider.getTitle() + \"'))\");\r\n\r\n        if (filtersProvider.getOwner() !== '')\r\n            filterStrings.push(\"[OwnerNickname] containsIC '\" + filtersProvider.getOwner() + \"'\");\r\n\r\n        var types = filtersProvider.getTypes();\r\n        var typeFilters = $.map(types, function(type) {\r\n            if (type === 'catalog')\r\n            {\r\n                return \"([LayerType]=LayerTypeCode('vector') AND [IsRasterCatalog]=true)\"\r\n            }\r\n            else if (type)\r\n            {\r\n                return \"[LayerType]=LayerTypeCode('\" + type + \"')\";\r\n            }\r\n        })\r\n\r\n        if (typeFilters.length > 0)\r\n            filterStrings.push('(' + typeFilters.join(' OR ') + ')');\r\n\r\n        var dateBegin = filtersProvider.getDateBegin();\r\n        var dateEnd = filtersProvider.getDateEnd();\r\n\r\n        dateBegin && filterStrings.push(\"[DateCreate] >= '\" + $.datepicker.formatDate('yy.mm.dd', dateBegin) + \"'\");\r\n        dateEnd   && filterStrings.push(\"[DateCreate] < '\"  + $.datepicker.formatDate('yy.mm.dd', dateEnd) + \"'\");\r\n\r\n        var layerTags = filtersProvider.getTags();\r\n\r\n        if (layerTags)\r\n        {\r\n            layerTags.each(function(id, tag, value)\r\n            {\r\n                if (tag)\r\n                {\r\n                    if (value !== '')\r\n                        filterStrings.push(\"[\" + tag + \"] containsIC '\" + value + \"'\");\r\n                    else\r\n                        filterStrings.push(\"PropertyExist('\" + tag + \"')\");\r\n                }\r\n            });\r\n        }\r\n\r\n        return '&query=' + encodeURIComponent(filterStrings.join(' AND '));\r\n    }\r\n\r\n    this.getCount = function(callback)\r\n    {\r\n        var query = getQueryText();\r\n        sendCrossDomainJSONRequest(window.serverBase + 'Layer/Search2.ashx?count=true' + query, function(response)\r\n        {\r\n            if (!parseResponse(response))\r\n            {\r\n                callback();\r\n                return;\r\n            }\r\n            callback(response.Result.count);\r\n        })\r\n    }\r\n\r\n    this.getItems = function(page, pageSize, sortParam, sortDec, callback)\r\n    {\r\n        this.getCountAndItems(page, pageSize, sortParam, sortDec, function(count, items)\r\n        {\r\n            callback(items);\r\n        })\r\n    }\r\n\r\n    this.getCountAndItems = function(page, pageSize, sortParam, sortDec, callback)\r\n    {\r\n        var sortParams = {};\r\n        sortParams[_gtxt(\"Имя\")] = \"title\";\r\n        sortParams[_gtxt(\"Дата создания\")] = \"datecreate\";\r\n        sortParams[_gtxt(\"Владелец\")] = \"ownernickname\";\r\n\r\n        var query = getQueryText();\r\n\r\n        sendCrossDomainJSONRequest(window.serverBase + 'Layer/Search2.ashx?page=' + page + '&pageSize=' + pageSize + \"&orderby=\" + sortParams[sortParam] + \" \" + (sortDec ? \"desc\" : \"\") + query, function(response)\r\n        {\r\n            if (!parseResponse(response))\r\n            {\r\n                callback();\r\n                return;\r\n            }\r\n\r\n            callback(response.Result.count, response.Result.layers);\r\n        })\r\n    }\r\n}\r\n\r\nvar drawLayers = function(layer, params)\r\n{\r\n\tvar _params = $.extend({onclick: function(){ removeLayerFromList(); }, enableDragging: true, disabled: false}, params);\r\n\tvar newLayerProperties = {properties:layer};\r\n\r\n    var mapProperties = _layersTree.treeModel.getMapProperties();\r\n\tnewLayerProperties.properties.mapName = mapProperties.name;\r\n\tnewLayerProperties.properties.hostName = mapProperties.hostName;\r\n\tnewLayerProperties.properties.visible = false;\r\n\r\n    // newLayerProperties.properties.type = newLayerProperties.properties.type === 1 ? 'Vector' : 'Raster';\r\n\r\n\tif (newLayerProperties.properties.type == 'Vector')\r\n\t\tnewLayerProperties.properties.styles = [{MinZoom:1, MaxZoom:20, RenderStyle:_mapHelper.defaultStyles[newLayerProperties.properties.GeometryType]}]\r\n\telse if (newLayerProperties.properties.type != 'Vector' && !newLayerProperties.properties.MultiLayerID)\r\n\t\tnewLayerProperties.properties.styles = [{MinZoom:newLayerProperties.properties.MinZoom, MaxZoom:20}];\r\n\r\n\tvar res = _layersTree.drawNode({type: 'layer', content:newLayerProperties}, false, 1),\r\n\t\ticon = res.firstChild.cloneNode(true),\r\n\t\tremove = makeImageButton(\"img/recycle.png\", \"img/recycle_a.png\"),\r\n\t\ttr,\r\n\t\ttdRemove = (layer.Access == 'edit') ? _td([remove], [['css','textAlign','center']]) : _td(),\r\n\t\tremoveLayerFromList = function()\r\n\t\t{\r\n\t\t\tvar active = $(_queryMapLayers.buildedTree).find(\".active\");\r\n\r\n            var gmxProperties = $(res).find(\"span[dragg]\")[0].parentNode.parentNode.gmxProperties;\r\n\t\t\tif (active.length && (active[0].parentNode.getAttribute('MapID') || active[0].parentNode.getAttribute('GroupID'))){\r\n                _layersTree.copyHandler(gmxProperties, active[0].parentNode, false, true)\r\n            } else {\r\n                _layersTree.copyHandler(gmxProperties, $(_queryMapLayers.buildedTree.firstChild).children(\"div[MapID]\")[0], false, true);\r\n            }\r\n            $(res).addClass('gmx-disabled');\r\n\t\t},\r\n\t\t_this = this;\r\n\r\n\t_title(remove, _gtxt(\"Удалить\"));\r\n\r\n\tres.firstChild.removeNode(true);\r\n\r\n\tremove.onclick = function()\r\n\t{\r\n\t\tif (confirm(_gtxt(\"Вы действительно хотите удалить этот слой?\")))\r\n\t\t{\r\n\t\t\tvar loading = loading = _div([_img(null, [['attr','src','img/progress.gif']]), _t('удаление...')], [['css','marginLeft','5px']]);\r\n\r\n\t\t\t$(remove.parentNode.parentNode).replaceWith(_tr([_td([loading], [['attr','colSpan', 5]])]))\r\n\r\n            var deleteLayerHandler = function(response)\r\n            {\r\n                if (!parseResponse(response))\r\n                    return;\r\n\r\n                if (response.Result == 'deleted')\r\n                    $(_this.getDataProvider()).change();\r\n                else\r\n                    showErrorMessage(_gtxt(\"Ошибка!\"), true, _gtxt(\"Слоя нет в базе\"));\r\n            }\r\n\r\n\t\t\tif (newLayerProperties.properties.MultiLayerID)\r\n\t\t\t\tsendCrossDomainJSONRequest(window.serverBase + \"MultiLayer/Delete.ashx?WrapStyle=func&MultiLayerID=\" + newLayerProperties.properties.MultiLayerID, deleteLayerHandler);\r\n\t\t\telse\r\n\t\t\t\tsendCrossDomainJSONRequest(window.serverBase + \"Layer/Delete.ashx?WrapStyle=func&LayerID=\" + newLayerProperties.properties.LayerID, deleteLayerHandler);\r\n\t\t}\r\n\t}\r\n\r\n\tvar span = $(res).find(\"span.layer\")[0];\r\n\r\n    if (_params.disabled)\r\n            $(span).addClass('invisible');\r\n\r\n\tif (!_params.disabled && _params.onclick)\r\n\t{\r\n\t\tspan.onclick = function()\r\n\t\t{\r\n\t\t\t_params.onclick({ elem: layer, scrollTable: _this });\r\n\t\t}\r\n\t}\r\n    else\r\n    {\r\n        span.onclick = null;\r\n        $(span).css('cursor', 'auto');\r\n    }\r\n\r\n    span.ondblclick = null;\r\n\r\n\tif (_params.enableDragging && !params.disabled)\r\n\t{\r\n\t\t$(res).find(\"span[dragg]\").draggable(\r\n\t\t{\r\n\t\t\thelper: function(ev)\r\n\t\t\t{\r\n\t\t\t\treturn _layersTree.dummyNode(ev.target)\r\n\t\t\t},\r\n\t\t\tcursorAt: { left: 5 , top: 10},\r\n\t\t\tcursor: 'move',\r\n\t\t\tdelay: 200,\r\n\t\t\tappendTo: document.body\r\n\t\t});\r\n\t}\r\n\r\n\tvar nameDivInternal = _div([res], [['css','position','absolute'], ['css','width','100%'],['css','padding',\"1px 0px\"], ['css','overflowX','hidden'],['css','whiteSpace','nowrap']]);\r\n\tvar nameDiv = _div([nameDivInternal], [['css', 'position', 'relative'], ['css', 'height', '100%']]);\r\n\r\n\ttr = _tr([_td(), _td([icon], [['css','textAlign','center']]), _td([nameDiv]), _td([_t(layer.date)], [['css','textAlign','center'],['dir','className','invisible']]),  _td([_t(layer.Owner)], [['css','textAlign','center'],['dir','className','invisible']]), tdRemove]);\r\n\r\n\tfor (var i = 0; i < tr.childNodes.length; i++)\r\n\t\ttr.childNodes[i].style.width = this._fields[i].width;\r\n\r\n\tattachEffects(tr, 'hover')\r\n\r\n\treturn tr;\r\n}\r\n\r\n/** Внутри контейнера помещает табличку со списком слоёв и контролами для фильтрации\r\n* @param {HTMLNode} parentDiv Куда помещать контрол\r\n* @param {String} name Уникальное имя этого инстанса\r\n* @param {object} params Параметры отображения списка:\r\n*\r\n*  * fixType {String | Vector} Какой тип слоёв показывать. 'vector', 'raster', 'multilayer', 'catalog' или ''. Если '', то добавится контрол с выбором типа слоя. Вектор\r\n*  * enableDragging {Boolean}\r\n*  * height {Integer} высота всего виджета. Если не указана, то будет применяться дефолтная высота (~460px)\r\n*  * onclick {function({ elem: , scrollTable: })}\r\n*/\r\nvar LayerManagerControl = function( parentDiv, name, params )\r\n{\r\n\tvar _params = $.extend({fixType: [], height: ''}, params);\r\n\r\n    if (typeof _params.fixType === 'string')\r\n        _params.fixType = [_params.fixType];\r\n\r\n\tvar canvas = _div(null, [['attr','id','layersList']]),\r\n\t\tsearchCanvas = _div(null, [['dir','className','layersSearchCanvas']]);\t\t\r\n\r\n\tvar layerName = _input(null, [['dir','className','inputStyle'],['css','width','185px']]),\r\n\t\tlayerOwner = _input(null, [['dir','className','inputStyle'],['css','width','185px']]);\r\n\r\n\tvar typeSel = nsGmx.Utils._select([_option([_t(_gtxt(\"Любой\"))], [['attr','value','']]),\r\n\t\t\t\t\t   _option([_t(_gtxt(\"Векторный\"))], [['attr','value','vector']]),\r\n\t\t\t\t\t   _option([_t(_gtxt(\"Растровый\"))], [['attr','value','raster']]),\r\n\t\t\t\t\t   _option([_t(_gtxt(\"Мультислой\"))], [['attr','value','multilayer']]),\r\n\t\t\t\t\t   _option([_t(_gtxt(\"Каталог растров\"))], [['attr','value','catalog']])], [['dir','className','selectStyle'], ['css','width','100px']]);\r\n\r\n    var calendar = new nsGmx.CalendarWidget({\r\n        minimized: false,\r\n        showSwitcher: false,\r\n        dateInterval: new nsGmx.DateInterval({dateBegin: null, dateEnd: null})\r\n    });\r\n    // calendar.init('layerManager', {\r\n        // minimized: false,\r\n        // showSwitcher: false,\r\n        // dateBegin: null,\r\n        // dateEnd: null\r\n    // });\r\n\r\n    var _disabledLayers = {};\r\n\r\n\t_(searchCanvas, [_div([_table([_tbody([_tr([_td([_span([_t(_gtxt(\"Название\"))],[['css','fontSize','12px']])]), _td([layerName])]),\r\n\t\t\t\t\t\t\t\t\t\t   _tr([_td([_span([_t(_gtxt(\"Владелец\"))],[['css','fontSize','12px']])]),_td([layerOwner])]),\r\n                                           _tr([_td([_span([_t(_gtxt(\"Период\"))],[['css','fontSize','12px']])]),_td([calendar.canvas[0]])]),\r\n\t\t\t\t\t\t\t\t\t\t   _tr([_td([_span([_t(_gtxt(\"Тип\"))],[['css','fontSize','12px']])]), _td([typeSel])])])])], [['css','marginBottom','10px']])]);\r\n\r\n    $.each(_params.fixType, function(i, type) {\r\n        if (type !== '')\r\n            $(\"tr:last\", searchCanvas).hide();\r\n    });\r\n\r\n\tvar tableParent = _div();\r\n\r\n    var sortColumns = {};\r\n    sortColumns[_gtxt('Имя')] = true;\r\n    sortColumns[_gtxt('Владелец')] = true;\r\n    sortColumns[_gtxt('Дата создания')] = true;\r\n\r\n    // Временно сервер не поддерживает сортировку по типу\r\n    // if (_params.fixType.length > 1 || _params.fixType[0] === '')\r\n        // sortColumns[_gtxt('Тип')] = true;\r\n\r\n    var tagsParent = _div(null, [['css', 'height', '100px'], ['css', 'overflow', 'auto']]);\r\n\r\n    _(canvas, [_table([_tbody([_tr([\r\n        _td([searchCanvas], [['css', 'width', '50%']]),\r\n        _td([tagsParent])\r\n    ])])], [['css', 'width', '100%']])]);\r\n\r\n    var LayersFilterParams = (function()\r\n    {\r\n        var prevLayerName, prevLayerOwner;\r\n\r\n        layerName.oninput = layerName.onkeyup = function()\r\n        {\r\n            if (this.value !== prevLayerName) {\r\n                prevLayerName = this.value;\r\n                $(pi).change();\r\n            }\r\n        }\r\n\r\n        layerOwner.oninput = layerOwner.onkeyup = function()\r\n        {\r\n            if (this.value !== prevLayerOwner) {\r\n                prevLayerOwner = this.value;\r\n                $(pi).change();\r\n            }\r\n        }\r\n\r\n        typeSel.onchange = function()\r\n        {\r\n            $(pi).change();\r\n        }\r\n\r\n        calendar.getDateInterval().on('change', function()\r\n        {\r\n            $(pi).change();\r\n        });\r\n\r\n        var _layerTags = null;\r\n\r\n        var pi = {\r\n            setTags: function(layerTags)\r\n            {\r\n                _layerTags = layerTags;\r\n                $(_layerTags).change(function()\r\n                {\r\n                    $(pi).change();\r\n                })\r\n            },\r\n            getTitle:     function() { return layerName.value; },\r\n            getOwner:     function() { return layerOwner.value; },\r\n            getDateBegin: function() { return calendar.getDateInterval().get('dateBegin'); },\r\n            getDateEnd:   function() { return calendar.getDateInterval().get('dateEnd'); },\r\n            getTags:      function() { return _layerTags; },\r\n            getTypes:     function() { return _params.fixType.length > 0 ? _params.fixType : [$(\"option:selected\", typeSel).val()]; }\r\n        }\r\n\r\n        return pi;\r\n    })();\r\n\r\n    nsGmx.TagMetaInfo.loadFromServer(function(tagsInfo)\r\n    {\r\n        var layerTags = new nsGmx.LayerTagsWithInfo(tagsInfo);\r\n        new nsGmx.LayerTagSearchControl(layerTags, tagsParent, {inputWidth: 115});\r\n        LayersFilterParams.setTags(layerTags);\r\n    });\r\n\r\n    var layersListProvider = new LayersListProvider(LayersFilterParams);\r\n    var layersTable = new nsGmx.ScrollTable({height: _params.height ? _params.height - 130 : ''});\r\n    layersTable.setDataProvider(layersListProvider);\r\n\r\n\tlayersTable.createTable(tableParent, name, 0,\r\n\t\t[\"\", _gtxt(\"Тип\"), _gtxt(\"Имя\"), _gtxt(\"Дата создания\"), _gtxt(\"Владелец\"), \"\"],\r\n\t\t['1%','5%','45%','24%','20%','5%'],\r\n\t\tfunction(layer)\r\n\t\t{\r\n            var curParams = $.extend( {}, _params, {disabled: layer.name in _disabledLayers } );\r\n\t\t\treturn drawLayers.apply(this, [layer, curParams]);\r\n\t\t},\r\n\t\tsortColumns\r\n\t);\r\n\r\n\t_(canvas, [tableParent]);\r\n\r\n\t$(parentDiv).empty().append(canvas);\r\n\r\n\tlayerName.focus();\r\n\r\n    this.getScrollTable = function()\r\n    {\r\n        return layersTable;\r\n    }\r\n\r\n    /** Деактивировать слои\r\n      @param layerNames {String|String[]} - массив имён слоёв (или просто имя), которые нужно сделать неактивными\r\n    */\r\n    this.disableLayers = function(layerNames)\r\n    {\r\n        if (!$.isArray(layerNames))\r\n            layerNames = [layerNames];\r\n\r\n        for (var k = 0; k < layerNames.length; k++)\r\n            _disabledLayers[layerNames[k]] = true;\r\n\r\n        layersTable.repaint();\r\n    }\r\n\r\n    /** Aктивировать слои\r\n      @param layerNames {String|String[]} - массив имён слоёв (или просто имя), которые нужно сделать активными\r\n    */\r\n    this.enableLayers = function(layerNames)\r\n    {\r\n        if (!$.isArray(layerNames))\r\n            layerNames = [layerNames];\r\n\r\n        for (var k = 0; k < layerNames.length; k++)\r\n            delete _disabledLayers[layerNames[k]];\r\n\r\n        layersTable.repaint();\r\n    }\r\n\r\n    this.resize = function(h) {\r\n        layersTable.updateHeight(h - 130);\r\n    }\r\n}\r\n\r\nnsGmx.LayerManagerControl = LayerManagerControl;\r\nnsGmx.drawLayers = drawLayers;\r\n\r\nwindow.gmxCore.addModule('LayersManagerControl', {\r\n    LayerManagerControl: LayerManagerControl,\r\n    drawLayers: drawLayers\r\n});\r\n\r\n})(nsGmx.Utils._);\r\n","import nsGmx from './nsGmx.js';\r\nimport {leftMenu} from './menu.js';\r\nimport {\r\n    _checkbox,\r\n    disableSelection,\r\n    _div,\r\n    equals,\r\n    hide,\r\n    _img,\r\n    inputError,\r\n    _li,\r\n    objLength,\r\n    parseResponse,\r\n    removeDialog,\r\n    sendCrossDomainJSONRequest,\r\n    sendCrossDomainPostRequest,\r\n    show,\r\n    showDialog,\r\n    showErrorMessage,\r\n    _span,\r\n    _t,\r\n    _table,\r\n    _title,\r\n    _ul,\r\n} from './utilities.js';\r\nimport './MapsManagerControl.js';\r\nimport './PluginsEditor/PluginsEditor.js';\r\nimport './NotificationWidget/NotificationWidget.js';\r\nimport './LayersManagerControl.js';\r\n\r\n(function(_) {\r\n\r\n    var mapLayers = {\r\n        mapLayers: {}\r\n    }\r\n\r\n    window.mapLayers = mapLayers;\r\n\r\n    var AbstractTree = function() {};\r\n\r\n    AbstractTree.prototype.makeSwapChild = function() {\r\n        var div = _div(null, [\r\n            ['attr', 'swap', true],\r\n            ['dir', 'className', 'swap'],\r\n            ['css', 'fontSize', '0px']\r\n        ]);\r\n\r\n        return div;\r\n    }\r\n\r\n    AbstractTree.prototype.getChildsUl = function(node) {\r\n        var ul = $(node).children(\"ul\");\r\n\r\n        if (ul.length > 0)\r\n            return ul[0];\r\n        else\r\n            return false;\r\n    }\r\n\r\n    AbstractTree.prototype.toggle = function(box) {\r\n        box.onclick = function() {\r\n            $(this.parentNode)\r\n                .find(\">.hitarea\")\r\n                .swapClass('collapsable-hitarea', 'expandable-hitarea')\r\n                .swapClass('lastCollapsable-hitarea', 'lastExpandable-hitarea')\r\n                .end()\r\n                .swapClass('collapsable', 'expandable')\r\n                .swapClass('lastCollapsable', 'lastExpandable')\r\n\r\n            if ($(this.parentNode).hasClass('expandable') || $(this.parentNode).hasClass('lastExpandable'))\r\n                hide(_abstractTree.getChildsUl(this.parentNode))\r\n            else\r\n                show(_abstractTree.getChildsUl(this.parentNode))\r\n        }\r\n    }\r\n    AbstractTree.prototype.addNode = function(node, newNodeCanvas) {\r\n        var childsUl = _abstractTree.getChildsUl(node);\r\n\r\n        if (childsUl)\r\n            childsUl.insertBefore(newNodeCanvas, childsUl.firstChild)\r\n        else {\r\n            // если первый потомок\r\n            var newSubTree = _ul([newNodeCanvas]);\r\n            //_(node, [newSubTree, this.makeSwapChild()]);\r\n            node.insertBefore(newSubTree, node.lastChild)\r\n\r\n            newSubTree.loaded = true;\r\n\r\n            var div = _div(null, [\r\n                ['dir', 'className', 'hitarea']\r\n            ]);\r\n\r\n            if ($(node).hasClass(\"last\")) {\r\n                $(div).addClass('lastCollapsable-hitarea collapsable-hitarea');\r\n                $(node).addClass('lastCollapsable');\r\n            } else {\r\n                $(div).addClass('collapsable-hitarea');\r\n                $(node).addClass('collapsable');\r\n            }\r\n\r\n            this.toggle(div);\r\n\r\n            node.insertBefore(div, node.firstChild);\r\n\r\n            _layersTree.addExpandedEvents(node);\r\n\r\n            if ($(newNodeCanvas).hasClass('collapsable')) {\r\n                $(newNodeCanvas).addClass('lastCollapsable')\r\n                $(newNodeCanvas).children('div.hitarea').addClass('lastCollapsable-hitarea')\r\n            }\r\n            if ($(newNodeCanvas).hasClass('expandable')) {\r\n                $(newNodeCanvas).addClass('lastExpandable')\r\n                $(newNodeCanvas).children('div.hitarea').addClass('lastExpandable-hitarea')\r\n            }\r\n            if (!$(newNodeCanvas).hasClass('lastCollapsable') && !$(newNodeCanvas).hasClass('lastExpandable'))\r\n                $(newNodeCanvas).addClass('last');\r\n        }\r\n\r\n        $(_abstractTree.getChildsUl(node)).children(\":not(li:last)\").each(function() {\r\n            $(this).removeClass('last').replaceClass('lastCollapsable', 'collapsable').replaceClass('lastExpandable', 'expandable');\r\n            $(this).children('div.lastCollapsable-hitarea').replaceClass('lastCollapsable-hitarea', 'collapsable-hitarea');\r\n            $(this).children('div.lastExpandable-hitarea').replaceClass('lastExpandable-hitarea', 'expandable-hitarea');\r\n        })\r\n    }\r\n    AbstractTree.prototype.delNode = function(node, parentTree, parent) {\r\n        if (parentTree.childNodes.length == 0) {\r\n            // потомков не осталось, удалим контейнеры\r\n            parentTree.removeNode(true);\r\n            parent.firstChild.removeNode(true);\r\n\r\n            // изменим дерево родителя\r\n            $(parent).removeClass(\"collapsable\")\r\n            $(parent).replaceClass(\"lastCollapsable\", \"last\")\r\n        }\r\n        // изменим дерево родителя\r\n        else if ($(parentTree).children(\"li:last\").hasClass(\"collapsable\")) {\r\n            $(parentTree).children(\"li:last\").addClass(\"lastCollapsable\");\r\n\r\n            $(parentTree).children(\"li:last\").each(function() {\r\n                $(this.firstChild).addClass(\"lastCollapsable-hitarea\");\r\n            })\r\n        }\r\n        else {\r\n            $(parentTree).children(\"li:last\").addClass(\"last\");\r\n        }\r\n\r\n    }\r\n\r\n    AbstractTree.prototype.swapNode = function(node, newNodeCanvas) {\r\n        $(node).after(newNodeCanvas)\r\n\r\n        $(node.parentNode).children(\":not(li:last)\").each(function() {\r\n            $(this).removeClass('last').replaceClass('lastCollapsable', 'collapsable').replaceClass('lastExpandable', 'expandable');\r\n            $(this).children('div.lastCollapsable-hitarea').replaceClass('lastCollapsable-hitarea', 'collapsable-hitarea');\r\n            $(this).children('div.lastExpandable-hitarea').replaceClass('lastExpandable-hitarea', 'expandable-hitarea');\r\n        })\r\n\r\n        // изменим дерево родителя\r\n        if ($(node.parentNode).children(\"li:last\").hasClass(\"collapsable\")) {\r\n            $(node.parentNode).children(\"li:last\").addClass(\"lastCollapsable\");\r\n\r\n            $(node.parentNode).children(\"li:last\").each(function() {\r\n                $(this.firstChild).addClass(\"lastCollapsable-hitarea\");\r\n            })\r\n        } else if ($(node.parentNode).children(\"li:last\").hasClass(\"expandable\")) {\r\n            $(node.parentNode).children(\"li:last\").addClass(\"lastExpandable\");\r\n\r\n            $(node.parentNode).children(\"li:last\").each(function() {\r\n                $(this.firstChild).addClass(\"lastExpandable-hitarea\");\r\n            })\r\n        } else\r\n            $(node.parentNode).children(\"li:last\").addClass(\"last\")\r\n    }\r\n\r\n    var _abstractTree = new AbstractTree();\r\n    window._abstractTree = _abstractTree;\r\n\r\n    //renderParams:\r\n    //  * showVisibilityCheckbox {Bool} - показывать или нет checkbox видимости\r\n    //  * allowActive {Bool} - возможен ли в дереве активный элемент\r\n    //  * allowDblClick {Bool} - переходить ли по двойному клику к видимому экстенту слоя/группы\r\n    //  * showStyle {Bool} - показывать ли иконку стилей\r\n    //  * visibilityFunc {function(layerProps, isVisible)} - ф-ция, которая будет выполнена при изменении видимости слоя.\r\n    //    По умолчанию устанавливает видимость соответствующего слоя в API\r\n    //\r\n    //события:\r\n    //  * layerVisibilityChange - при изменении видимости слоя (параметр - элемент дерева с изменившимся слоем)\r\n    //  * addTreeElem - добавили новый элемент дерева (параметр - новый элемент)\r\n    //  * activeNodeChange - изменили активную ноду дерева (парамер - div активной ноды)\r\n    //  * styleVisibilityChange - при изменении видимости стиля слоя\r\n    var layersTree = function(renderParams) {\r\n        this._renderParams = $.extend({\r\n            showVisibilityCheckbox: true,\r\n            allowActive: true,\r\n            allowDblClick: true,\r\n            showStyle: true,\r\n            visibilityFunc: function(props, isVisible) {\r\n                if (props.name in nsGmx.gmxMap.layersByID) {\r\n                    nsGmx.leafletMap[isVisible ? 'addLayer' : 'removeLayer'](nsGmx.gmxMap.layersByID[props.name]);\r\n                }\r\n            }\r\n        }, renderParams);\r\n\r\n        // тип узла\r\n        this.type = null;\r\n\r\n        // содержимое узла\r\n        this.content = null;\r\n\r\n        this.condition = { visible: {}, expanded: {} };\r\n\r\n        this.mapStyles = {};\r\n\r\n        this.groupLoadingFuncs = [];\r\n\r\n        this._treeCanvas = null; //контейнер отрисованного дерева слоёв\r\n\r\n        this._layerViewHooks = [];\r\n    }\r\n\r\n    layersTree.prototype.addLayerViewHook = function(hook) {\r\n        hook && this._layerViewHooks.push(hook);\r\n    }\r\n\r\n    layersTree.prototype._applyLayerViewHooks = function(div, layerProps) {\r\n        this._layerViewHooks.forEach(function(hook) {\r\n            hook(div, layerProps);\r\n        })\r\n    }\r\n\r\n    // layerManagerFlag == 0 для дерева слева\r\n    // layerManagerFlag == 1 для списка слоев\r\n    // layerManagerFlag == 2 для списка карт\r\n\r\n    layersTree.prototype.drawTree = function(tree, layerManagerFlag) {\r\n        var permalinkParams = this.LayersTreePermalinkParams;\r\n\r\n        if (permalinkParams) {\r\n            var tempTree = new nsGmx.LayersTree(tree);\r\n\r\n            tempTree.forEachNode(function(elem) {\r\n                var props = elem.content.properties,\r\n                    id = elem.type == 'group' ? props.GroupID : props.LayerID;\r\n\r\n                if (id in permalinkParams) {\r\n                    props.permalinkParams = permalinkParams[id];\r\n                }\r\n            });\r\n\r\n            tree = tempTree.getRawTree();\r\n        }\r\n\r\n        this._treeCanvas = _ul([this.getChildsList(tree, false, layerManagerFlag, true)], [\r\n            ['dir', 'className', 'filetree']\r\n        ]);\r\n        this.treeModel = new nsGmx.LayersTree(tree);\r\n        this._mapTree = tree; //Устарело: используйте this.treeModel для доступа к исходному дереву\r\n\r\n        this.treeModel.forEachLayer(function(layerContent) {\r\n            layerContent.properties.initVisible = layerContent.properties.visible;\r\n        });\r\n\r\n        var _this = this;\r\n        $(this.treeModel).on('nodeVisibilityChange', function(event, elem) {\r\n            var props = elem.content.properties;\r\n\r\n            _this.updateVisibilityUI(elem);\r\n            props.changedByViewer = true;\r\n\r\n            if (elem.type === 'layer') {\r\n                _this._renderParams.visibilityFunc(props, props.visible);\r\n                $(_this).triggerHandler('layerVisibilityChange', [elem]);\r\n            }\r\n        })\r\n\r\n        nsGmx.leafletMap.on('layeradd layerremove', function(event) {\r\n            if (event.layer.getGmxProperties) {\r\n                var name = event.layer.getGmxProperties().name;\r\n\r\n                //добавился именно слой из основной карты, а не просто с таким же ID\r\n                if (event.layer === nsGmx.gmxMap.layersByID[name]) {\r\n                    var searchRes = _this.treeModel.findElem('name', name);\r\n                    if (searchRes && (!layerManagerFlag || layerManagerFlag == 0)) {\r\n                        _this.treeModel.setNodeVisibility(searchRes.elem, nsGmx.leafletMap.hasLayer(event.layer));\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        return this._treeCanvas;\r\n    }\r\n\r\n    layersTree.prototype.getChildsList = function(elem, parentParams, layerManagerFlag, parentVisibility) {\r\n        // добавляем новый узел\r\n        let li = _li();\r\n\r\n\r\n        _(li, [this.drawNode(elem, parentParams, layerManagerFlag, parentVisibility)]);\r\n\r\n        if (elem.content && elem.content.children && elem.content.children.length > 0) {\r\n            let childsUl = _ul();\r\n\r\n            // initExpand - временное свойство, сохраняющее начальное состояние развёрнутости группы.\r\n            // В expanded будет храниться только текущее состояние (не сохраняется)\r\n            if (typeof elem.content.properties.initExpand == 'undefined')\r\n                elem.content.properties.initExpand = elem.content.properties.expanded;\r\n\r\n            if (!elem.content.properties.expanded) {\r\n                childsUl.style.display = 'none';\r\n                childsUl.className = 'hiddenTree';\r\n\r\n                if (!layerManagerFlag) {\r\n                    childsUl.loaded = false;\r\n\r\n                    this.addLoadingFunc(childsUl, elem, parentParams, layerManagerFlag);\r\n                } else {\r\n                    childsUl.loaded = true;\r\n\r\n                    let childs = [];\r\n\r\n                    for (let i = 0; i < elem.content.children.length; i++)\r\n                        childs.push(this.getChildsList(elem.content.children[i], elem.content.properties, layerManagerFlag, true));\r\n\r\n                    _(childsUl, childs)\r\n                }\r\n            } else {\r\n                childsUl.loaded = true;\r\n\r\n                let childs = [];\r\n\r\n                for (let i = 0; i < elem.content.children.length; i++)\r\n                    childs.push(this.getChildsList(elem.content.children[i], elem.content.properties, layerManagerFlag, parentVisibility && elem.content.properties.visible));\r\n\r\n                _(childsUl, childs)\r\n            }\r\n\r\n            _(li, [childsUl, _abstractTree.makeSwapChild()])\r\n        } else if (elem.children) {\r\n            if (elem.children.length > 0) {\r\n                let childs = [];\r\n\r\n                for (let i = 0; i < elem.children.length; i++)\r\n                    childs.push(this.getChildsList(elem.children[i], elem.properties, layerManagerFlag, true));\r\n\r\n                let childsUl = _ul(childs);\r\n\r\n                childsUl.loaded = true;\r\n\r\n                _(li, [childsUl])\r\n            }\r\n\r\n            _(li, [_div()])\r\n\r\n            li.root = true;\r\n        } else\r\n            _(li, [_abstractTree.makeSwapChild()])\r\n\r\n        // видимость слоя в дереве\r\n        if (!nsGmx.AuthManager.isRole(nsGmx.ROLE_ADMIN) &&\r\n            elem.type && elem.type == 'layer'\r\n            // && typeof invisibleLayers != 'undefined' && invisibleLayers[elem.content.properties.name]\r\n            )\r\n            li.style.display = 'none';\r\n\r\n        return li;\r\n    }\r\n\r\n    layersTree.prototype.addLoadingFunc = function(parentCanvas, elem, parentParams, layerManagerFlag) {\r\n        var func = function() {\r\n                $(parentCanvas.parentNode.firstChild).bind('click', function() {\r\n                    if (!parentCanvas.loaded) {\r\n                        parentCanvas.loaded = true;\r\n\r\n                        var childs = [],\r\n                            grId = $(parentCanvas.parentNode).children(\"div[GroupID]\");\r\n\r\n                        for (var i = 0; i < elem.content.children.length; i++) {\r\n                            childs.push(_this.getChildsList(elem.content.children[i], elem.content.properties, layerManagerFlag, _this.getLayerVisibility($(grId).find('input[type=\"checkbox\"]')[0] || $(grId).find('input[type=\"radio\"]')[0])));\r\n                        }\r\n\r\n                        _(parentCanvas, childs);\r\n\r\n                        if (_queryMapLayers.currentMapRights() == \"edit\") {\r\n                            _queryMapLayers.addDraggable(parentCanvas);\r\n\r\n                            if (!layerManagerFlag) {\r\n                                _queryMapLayers.addDroppable(parentCanvas);\r\n\r\n                                _queryMapLayers.addSwappable(parentCanvas);\r\n                            }\r\n                        }\r\n\r\n                        $(parentCanvas).treeview();\r\n\r\n                        _layersTree.addExpandedEvents(parentCanvas);\r\n\r\n                        _this.runLoadingFuncs();\r\n\r\n                        _queryMapLayers.applyState(_this.condition, _this.mapStyles, $(parentCanvas.parentNode).children(\"div[GroupID]\")[0]);\r\n                    }\r\n                })\r\n            },\r\n            _this = this;\r\n\r\n        this.groupLoadingFuncs.push(func);\r\n    }\r\n\r\n    layersTree.prototype.runLoadingFuncs = function() {\r\n        for (var i = 0; i < this.groupLoadingFuncs.length; i++)\r\n            this.groupLoadingFuncs[i]();\r\n\r\n        this.groupLoadingFuncs = [];\r\n    }\r\n\r\n    layersTree.prototype.addExpandedEvents = function(parent) {\r\n        var _this = this;\r\n        $(parent).find(\"div.hitarea\").each(function() {\r\n            if (!this.clickFunc) {\r\n                this.clickFunc = true;\r\n\r\n                var divClick = this;\r\n\r\n                if (divClick.parentNode.parentNode.parentNode.getAttribute(\"multiStyle\"))\r\n                    return;\r\n\r\n                $(divClick).bind('click', function() {\r\n                    var div = $(divClick.parentNode).children(\"div[MapID],div[GroupID],div[LayerID],div[MultiLayerID]\")[0],\r\n                        treeElem = _this.findTreeElem(div);\r\n\r\n                    if (!treeElem.parents.length)\r\n                        return;\r\n\r\n                    var flag = $(divClick).hasClass(\"expandable-hitarea\");\r\n                    treeElem.elem.content.properties.expanded = !flag;\r\n                })\r\n            }\r\n        });\r\n    }\r\n\r\n    layersTree.prototype.drawNode = function(elem, parentParams, layerManagerFlag, parentVisibility) {\r\n        var div;\r\n\r\n\r\n        if (elem.type == \"layer\") {\r\n            // var elemProperties = !layerManagerFlag ? nsGmx.gmxMap.layersByID[elem.content.properties.name].getGmxProperties(): elem.content.properties;\r\n\r\n            var elemProperties;\r\n            if (nsGmx.gmxMap.layersByID[elem.content.properties.name]) {\r\n                elemProperties = !layerManagerFlag ? nsGmx.gmxMap.layersByID[elem.content.properties.name].getGmxProperties() : elem.content.properties;\r\n            } else {\r\n                elemProperties = elem.content.properties;\r\n            }\r\n\r\n            var childs = this.drawLayer(elemProperties, parentParams, layerManagerFlag, parentVisibility);\r\n\r\n            if (typeof elem.content.properties.LayerID != 'undefined')\r\n                div = _div(childs, [\r\n                    ['attr', 'LayerID', elem.content.properties.LayerID]\r\n                ]);\r\n            else if (typeof elem.content.properties.MultiLayerID != 'undefined')\r\n                div = _div(childs, [\r\n                    ['attr', 'MultiLayerID', elem.content.properties.MultiLayerID]\r\n                ]);\r\n            else\r\n                div = _div(childs, [\r\n                    ['attr', 'LayerID', elem.content.properties.name]\r\n                ]);\r\n\r\n            div.gmxProperties = elem;\r\n            div.gmxProperties.content.properties = elemProperties;\r\n\r\n            this._applyLayerViewHooks(div, elemProperties);\r\n        } else {\r\n            if (elem.properties && elem.properties.MapID)\r\n                div = _div(this.drawHeaderGroupLayer(elem.properties, parentParams, layerManagerFlag), [\r\n                    ['attr', 'MapID', elem.properties.MapID]\r\n                ])\r\n            else\r\n                div = _div(this.drawGroupLayer(elem.content.properties, parentParams, layerManagerFlag, parentVisibility), [\r\n                    ['attr', 'GroupID', elem.content.properties.GroupID]\r\n                ])\r\n\r\n            div.gmxProperties = elem;\r\n        }\r\n\r\n        div.oncontextmenu = function() {\r\n            return false;\r\n        }\r\n\r\n        return div;\r\n    }\r\n\r\n    layersTree.prototype.setActive = function(span) {\r\n        $(this._treeCanvas).find(\".active\").removeClass(\"active\");\r\n\r\n        if (span) {\r\n            $(span.parentNode).addClass(\"active\");\r\n            $(this).triggerHandler(\"activeNodeChange\", [span.parentNode.parentNode]);\r\n        } else {\r\n            $(this).triggerHandler(\"activeNodeChange\", [null]);\r\n        }\r\n    }\r\n\r\n    layersTree.prototype.getActive = function() {\r\n        var activeDiv = $(this._treeCanvas).find(\".active\");\r\n        return activeDiv[0] ? activeDiv[0].parentNode : null;\r\n    }\r\n\r\n    layersTree.prototype.getMinLayerZoom = function(layer) {\r\n        if (!layer.getStyles) {\r\n            return 1;\r\n        }\r\n\r\n        var minLayerZoom = 20,\r\n            styles = layer.getStyles();\r\n\r\n        for (var i = 0; i < styles.length; i++) {\r\n            minLayerZoom = Math.min(minLayerZoom, styles[i].MinZoom);\r\n        }\r\n\r\n        return minLayerZoom;\r\n    }\r\n\r\n    layersTree.prototype.layerZoomToExtent = function(bounds) {\r\n        if (!bounds) return;\r\n\r\n        var lmap = nsGmx.leafletMap;\r\n        // var z = lmap.getBoundsZoom(bounds);\r\n\r\n        // if (minZoom !== 20) {\r\n            // z = Math.max(z, minZoom);\r\n        // }\r\n\r\n        // z = Math.min(lmap.getMaxZoom(), Math.max(lmap.getMinZoom(), z));\r\n        var currentZoom = lmap.getZoom();\r\n        var doubleClickZoom = lmap.getBoundsZoom(bounds);\r\n        var z = Math.min(Math.max(15, currentZoom), doubleClickZoom);\r\n\r\n        //анимация приводит к проблемам из-за бага https://github.com/Leaflet/Leaflet/issues/3249\r\n        //а указать явно zoom в fitBounds нельзя\r\n        //TODO: enable animation!\r\n        lmap.fitBounds(bounds, { animation: false, maxZoom: z });\r\n\r\n        //если вызывать setZoom всегда, карта начнёт глючить (бага Leaflet?)\r\n        // if (z !== lmap.getZoom()) {\r\n        //     lmap.setZoom(z);\r\n        // }\r\n    }\r\n\r\n    layersTree.prototype.drawLayer = function(elem, parentParams, layerManagerFlag, parentVisibility) {\r\n        var box,\r\n            _this = this;\r\n\r\n        if (this._renderParams.showVisibilityCheckbox) {\r\n            box = _checkbox(elem.visible, parentParams.list ? 'radio' : 'checkbox', parentParams.GroupID || parentParams.MapID);\r\n\r\n            box.className = 'box layers-visibility-checkbox';\r\n\r\n            box.setAttribute('box', 'layer');\r\n\r\n            box.onclick = function() {\r\n                _this.treeModel.setNodeVisibility(_this.findTreeElem(this.parentNode).elem, this.checked);\r\n            }\r\n        }\r\n\r\n        var span = _span([_t(elem.title)], [\r\n            ['dir', 'className', 'layer'],\r\n            ['attr', 'dragg', true]\r\n        ]);\r\n\r\n        var timer = null,\r\n            clickFunc = function() {\r\n                var treeNode = _this.findTreeElem(span.parentNode.parentNode).elem;\r\n                $(treeNode).triggerHandler('click', [treeNode]);\r\n\r\n                if (_this._renderParams.allowActive)\r\n                    _this.setActive(span);\r\n\r\n                if (_this._renderParams.showVisibilityCheckbox) {\r\n                    _this.treeModel.setNodeVisibility(treeNode, true);\r\n                }\r\n            },\r\n            dbclickFunc = function() {\r\n                var treeNode = _this.findTreeElem(span.parentNode.parentNode).elem;\r\n                var layer = nsGmx.gmxMap.layersByID[elem.name];\r\n                $(treeNode).triggerHandler('dblclick', [treeNode]);\r\n                if (treeNode.content.geometry && layer && layer.getBounds) {\r\n                    var minLayerZoom = _this.getMinLayerZoom(layer);\r\n                    _this.layerZoomToExtent(layer.getBounds(), minLayerZoom);\r\n                }\r\n            };\r\n\r\n        span.onclick = function() {\r\n            if (timer)\r\n                clearTimeout(timer);\r\n\r\n            timer = setTimeout(clickFunc, 200)\r\n        }\r\n\r\n        if (this._renderParams.allowDblClick) {\r\n            span.ondblclick = function() {\r\n                if (timer)\r\n                    clearTimeout(timer);\r\n\r\n                timer = null;\r\n\r\n                clickFunc();\r\n                dbclickFunc();\r\n            }\r\n        }\r\n\r\n        disableSelection(span);\r\n\r\n        var spanParent = _div([span], [\r\n                ['attr', 'titleDiv', true],\r\n                ['css', 'display', 'inline'],\r\n                ['css', 'position', 'relative'],\r\n                ['css', 'borderBottom', 'none'],\r\n                ['css', 'paddingRight', '3px']\r\n            ]),\r\n            spanDescr = _span(null, [\r\n                ['dir', 'className', 'layerDescription']\r\n            ]);\r\n\r\n        spanDescr.innerHTML = elem.description ? elem.description : '';\r\n\r\n        if (layerManagerFlag == 1) {\r\n        var imgIconSrc = (elem.type == \"Vector\") ? 'img/vector.png' : (typeof elem.MultiLayerID != 'undefined' ? 'img/multi.png' : 'img/rastr.png');\r\n        if (elem.type == \"Alias\") imgIconSrc = 'img/shortcut.png';\r\n            return [_img(null, [\r\n                ['attr', 'src', imgIconSrc],\r\n                ['css', 'marginLeft', '3px']\r\n            ]), spanParent, spanDescr];\r\n        }\r\n\r\n        if (this._renderParams.showVisibilityCheckbox && !elem.visible) {\r\n            $(spanParent).addClass(\"invisible\");\r\n        }\r\n\r\n        nsGmx.ContextMenuController.bindMenuToElem(spanParent, 'Layer', function() { return true; }, {\r\n            layerManagerFlag: layerManagerFlag,\r\n            elem: elem,\r\n            tree: this\r\n        });\r\n\r\n        var borderDescr = _span();\r\n\r\n        var count = 0;\r\n        var metaProps = {};\r\n        if (elem.MetaProperties) {\r\n            for (let key in elem.MetaProperties) {\r\n                var tagtype = elem.MetaProperties[key].Type;\r\n                metaProps[key] = nsGmx.Utils.convertFromServer(tagtype, elem.MetaProperties[key].Value);\r\n                count++;\r\n            }\r\n        }\r\n\r\n        if (count || elem.Legend) {\r\n            _(borderDescr, [_t('i')], [\r\n                ['dir', 'className', 'layerInfoButton']\r\n            ]);\r\n            borderDescr.onclick = function() {\r\n                nsGmx.Controls.showLayerInfo({ properties: elem }, { properties: metaProps });\r\n            }\r\n        }\r\n\r\n        if (elem.type == \"Vector\") {\r\n            let styles;\r\n\r\n            if (window.newStyles) {\r\n                if (elem.styles && !elem.gmxStyles) {\r\n                    elem.gmxStyles = L.gmx.StyleManager.decodeOldStyles(elem);\r\n                }\r\n                styles = elem.gmxStyles.styles;\r\n            } else {\r\n                styles = elem.styles;\r\n            }\r\n\r\n            let icon = _mapHelper.createStylesEditorIcon(styles, elem.GeometryType ? elem.GeometryType.toLowerCase() : 'polygon', { addTitle: !layerManagerFlag }),\r\n                multiStyleParent = _div(null, [\r\n                    ['attr', 'multiStyle', true]\r\n                ]),\r\n                timelineIcon,\r\n                iconSpan = _span([icon]);\r\n\r\n            if (styles.length === 1 && elem.name in nsGmx.gmxMap.layersByID) {\r\n                let layer = nsGmx.gmxMap.layersByID[elem.name];\r\n                layer.on('stylechange', function() {\r\n                    if (layer.getStyles().length === 1) {\r\n                        let style = L.gmxUtil.toServerStyle(layer.getStyles()[0].RenderStyle);\r\n                        let newIcon = _mapHelper.createStylesEditorIcon(\r\n                            [{ MinZoom: 1, MaxZoom: 21, RenderStyle: style }],\r\n                            elem.GeometryType ? elem.GeometryType.toLowerCase() : 'polygon', { addTitle: !layerManagerFlag }\r\n                        );\r\n                        $(iconSpan).empty().append(newIcon);\r\n                    }\r\n                });\r\n            }\r\n\r\n            $(iconSpan).attr('styleType', $(icon).attr('styleType'));\r\n\r\n            _mapHelper.createMultiStyle(elem, this, multiStyleParent, true, layerManagerFlag);\r\n\r\n            if (!layerManagerFlag) {\r\n                if (!parentVisibility || !elem.visible)\r\n                    $(multiStyleParent).addClass(\"invisible\")\r\n\r\n                iconSpan.onclick = function() {\r\n                    if (_queryMapLayers.currentMapRights() == \"edit\") {\r\n                        nsGmx.createStylesDialog(elem, _this);\r\n                    }\r\n                }\r\n\r\n                if (elem.name in nsGmx.gmxMap.layersByID) {\r\n                    let layer = nsGmx.gmxMap.layersByID[elem.name];\r\n\r\n                    if (layer.getGmxProperties) {\r\n                        let props = layer.getGmxProperties();\r\n\r\n                        if (props.Temporal && (props.IsRasterCatalog || (props.Quicklook && props.Quicklook !== 'null'))) {\r\n                            timelineIcon = this.CreateTimelineIcon(elem);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            let resElems = [spanParent, spanDescr, borderDescr];\r\n\r\n            if (this._renderParams.showStyle) {\r\n                resElems.push(multiStyleParent);\r\n                resElems.unshift(iconSpan);\r\n            }\r\n            this._renderParams.showVisibilityCheckbox && resElems.unshift(box);\r\n\r\n            if (timelineIcon) {\r\n                resElems.unshift(timelineIcon);\r\n            }\r\n            return resElems;\r\n        }\r\n        else if (this._renderParams.showVisibilityCheckbox) {\r\n            return [box, spanParent, spanDescr, borderDescr];\r\n        }\r\n        else {\r\n            return [spanParent, spanDescr, borderDescr];\r\n        }\r\n    }\r\n\r\n    layersTree.prototype.CreateTimelineIcon = function(elem) {\r\n        var conf = {\r\n            disabledSrc: 'img/timeline-icon-disabled.svg',\r\n            enabledSrc: 'img/timeline-icon-enabled.svg',\r\n            addTitle: window._gtxt('Добавить в таймлайн'),\r\n            removeTitle: window._gtxt('Удалить из таймлайна')\r\n        },\r\n        layerID = elem.name,\r\n        icon = nsGmx.Utils._img(null, [\r\n            ['attr', 'src', conf.disabledSrc],\r\n            ['dir','className', 'gmx-timeline-icon disabled'],\r\n            ['dir','title', conf.addTitle]\r\n        ]),\r\n        toggleIcon = function(flag) {\r\n            if (flag) {\r\n                icon.src = conf.enabledSrc;\r\n                icon.title = conf.addTitle;\r\n                icon.classList.remove('disabled');\r\n            } else {\r\n                icon.src = conf.disabledSrc;\r\n                icon.title = conf.removeTitle;\r\n                icon.classList.add('disabled');\r\n            }\r\n        };\r\n\r\n        // TODO: требуется замена jQuery    + не эффективно устанавливается множество хэндлеров\r\n        $(this).on('layerTimelineRemove', function(e, data) {\r\n            if (data.layerID === layerID) {\r\n                toggleIcon(false);\r\n            }\r\n        });\r\n\r\n        $(this).on('layerTimelineAdd', function(e, data) {\r\n            if (data.layerID === layerID) {\r\n                toggleIcon(true);\r\n            }\r\n        });\r\n\r\n        L.DomEvent\r\n            .on(icon, 'click', function() {\r\n                var disabled = icon.classList.contains('disabled'),\r\n                    tlc = nsGmx.timeLineControl,\r\n                    layer = nsGmx.gmxMap.layersByID[layerID];\r\n                if (disabled) {\r\n                    if (!tlc._map) { nsGmx.leafletMap.addControl(tlc); }\r\n                    tlc.addLayer(layer);\r\n                } else {\r\n                    tlc.removeLayer(layer);\r\n                }\r\n            }, this)\r\n        return icon;\r\n    }\r\n\r\n    layersTree.prototype.drawGroupLayer = function(elem, parentParams, layerManagerFlag, parentVisibility) {\r\n        var box,\r\n            _this = this;\r\n\r\n        if (this._renderParams.showVisibilityCheckbox) {\r\n            box = _checkbox(elem.visible, parentParams.list ? 'radio' : 'checkbox', parentParams.GroupID || parentParams.MapID);\r\n\r\n            box.className = 'box layers-visibility-checkbox';\r\n\r\n            box.setAttribute('box', 'group');\r\n\r\n            box.onclick = function() {\r\n                _this.treeModel.setNodeVisibility(_this.findTreeElem(this.parentNode).elem, this.checked);\r\n            }\r\n\r\n            if (typeof elem.ShowCheckbox !== 'undefined' && !elem.ShowCheckbox) {\r\n                box.isDummyCheckbox = true;\r\n                box.style.display = 'none';\r\n            }\r\n        }\r\n\r\n        var span = _span([_t(elem.title)], [\r\n            ['dir', 'className', 'groupLayer'],\r\n            ['attr', 'dragg', true]\r\n        ]);\r\n\r\n        var timer = null,\r\n            clickFunc = function() {\r\n                if (_this._renderParams.allowActive)\r\n                    _this.setActive(span);\r\n\r\n                if (_this._renderParams.showVisibilityCheckbox) {\r\n                    var div = span.parentNode.parentNode;\r\n\r\n                    if (div.gmxProperties.content.properties.ShowCheckbox) {\r\n                        _this.treeModel.setNodeVisibility(_this.findTreeElem(div).elem, true);\r\n                    }\r\n\r\n                    var clickDiv = $(div.parentNode).children(\"div.hitarea\");\r\n                    if (clickDiv.length)\r\n                        $(clickDiv[0]).trigger(\"click\");\r\n                }\r\n            },\r\n            dbclickFunc = function() {\r\n                var childsUl = _abstractTree.getChildsUl(span.parentNode.parentNode.parentNode);\r\n\r\n                if (childsUl) {\r\n                    var bounds = new L.LatLngBounds(),\r\n                        minLayerZoom = 20;\r\n\r\n                    _mapHelper.findChilds(_this.findTreeElem(span.parentNode.parentNode).elem, function(child) {\r\n                        if (child.type == 'layer' && (child.content.properties.LayerID || child.content.properties.MultiLayerID) && child.content.geometry) {\r\n                            var layer = nsGmx.gmxMap.layersByID[child.content.properties.name];\r\n                            bounds.extend(layer.getBounds());\r\n\r\n                            minLayerZoom = Math.min(minLayerZoom, _this.getMinLayerZoom(layer));\r\n                        }\r\n                    });\r\n\r\n                    _this.layerZoomToExtent(bounds, minLayerZoom);\r\n                }\r\n            };\r\n\r\n        span.onclick = function() {\r\n            if (timer)\r\n                clearTimeout(timer);\r\n\r\n            timer = setTimeout(clickFunc, 200)\r\n        }\r\n\r\n        if (this._renderParams.allowDblClick) {\r\n            span.ondblclick = function() {\r\n                if (timer)\r\n                    clearTimeout(timer);\r\n\r\n                timer = null;\r\n\r\n                clickFunc();\r\n                dbclickFunc();\r\n            }\r\n        }\r\n\r\n        disableSelection(span);\r\n\r\n        var spanParent = _div([span], [\r\n            ['attr', 'titleDiv', true],\r\n            ['css', 'display', 'inline'],\r\n            ['css', 'position', 'relative'],\r\n            ['css', 'borderBottom', 'none'],\r\n            ['css', 'paddingRight', '3px']\r\n        ]);\r\n\r\n        if (this._renderParams.showVisibilityCheckbox && (!parentVisibility || !elem.visible)) {\r\n            $(spanParent).addClass(\"invisible\");\r\n        }\r\n\r\n        if (!layerManagerFlag) {\r\n\r\n            nsGmx.ContextMenuController.bindMenuToElem(spanParent, 'Group', function() {\r\n                    return _queryMapLayers.currentMapRights() == \"edit\";\r\n                },\r\n                function() {\r\n                    return {\r\n                        div: spanParent.parentNode,\r\n                        tree: _this\r\n                    }\r\n                });\r\n        }\r\n\r\n        if (this._renderParams.showVisibilityCheckbox)\r\n            return [box, spanParent];\r\n        else\r\n            return [spanParent];\r\n    }\r\n    layersTree.prototype.drawHeaderGroupLayer = function(elem, parentParams, layerManagerFlag) {\r\n        var span = _span([_t(elem.title)], [\r\n                ['dir', 'className', 'groupLayer']\r\n            ]),\r\n            spanParent = _div([span], [\r\n                ['css', 'display', 'inline'],\r\n                ['css', 'position', 'relative'],\r\n                ['css', 'borderBottom', 'none'],\r\n                ['css', 'paddingRight', '3px']\r\n            ]),\r\n            _this = this;\r\n\r\n        if (this._renderParams.allowActive) {\r\n            span.onclick = function() {\r\n                _this.setActive(this);\r\n            }\r\n        }\r\n\r\n        if (!layerManagerFlag) {\r\n            nsGmx.ContextMenuController.bindMenuToElem(spanParent, 'Map', function() {\r\n                    return _queryMapLayers.currentMapRights() == \"edit\";\r\n                },\r\n                function() {\r\n                    return {\r\n                        div: spanParent.parentNode,\r\n                        tree: _this\r\n                    }\r\n                }\r\n            );\r\n        }\r\n\r\n        return [spanParent];\r\n    }\r\n\r\n    layersTree.prototype.removeGroup = function(div) {\r\n        var template = Handlebars.compile('<div class=\"removeGroup-container\">' +\r\n            '{{#if anyChildren}}' +\r\n            '<label><input type=\"checkbox\" checked class=\"removeGroup-layers\">{{i \"Включая вложенные слои\"}}</label><br>' +\r\n            '{{/if}}' +\r\n            '<button class=\"removeGroup-remove\">{{i \"Удалить\"}}</button>' +\r\n            '</div>');\r\n        var groupNode = _layersTree.treeModel.findElemByGmxProperties(div.gmxProperties).elem;\r\n\r\n        var ui = $(template({ anyChildren: groupNode.content.children.length > 0 })),\r\n            pos = nsGmx.Utils.getDialogPos(div, true, 90),\r\n            _this = this;\r\n\r\n        ui.find('.removeGroup-remove').click(function() {\r\n            var parentTree = div.parentNode.parentNode,\r\n                childsUl = _abstractTree.getChildsUl(div.parentNode);\r\n\r\n            if (ui.find('.removeGroup-layers').prop('checked')) {\r\n                _layersTree.treeModel.forEachLayer(function(layerContent) {\r\n                    _queryMapLayers.removeLayer(layerContent.properties.name);\r\n                }, groupNode);\r\n            } else {\r\n                //TODO: не работает, когда группа не раскрыта или раскрыта не полностью\r\n                var divDestination = $(parentTree.parentNode).children(\"div[MapID],div[GroupID]\")[0];\r\n\r\n                if (childsUl) {\r\n                    // переносим все слои наверх\r\n                    $(childsUl).find(\"div[LayerID],div[MultiLayerID]\").each(function() {\r\n                        var spanSource = $(this).find(\"span.layer\")[0];\r\n\r\n                        _this.moveHandler(spanSource, divDestination);\r\n                    })\r\n                }\r\n            }\r\n\r\n            _this.removeTreeElem(div);\r\n\r\n            div.parentNode.removeNode(true);\r\n\r\n            _abstractTree.delNode(null, parentTree, parentTree.parentNode)\r\n\r\n            $(dialogDiv).dialog('destroy');\r\n            dialogDiv.removeNode(true);\r\n\r\n            _mapHelper.updateUnloadEvent(true);\r\n\r\n            _this.updateZIndexes();\r\n        });\r\n\r\n        var title = _gtxt(\"Удаление группы [value0]\", div.gmxProperties.content.properties.title);\r\n        var dialogDiv = showDialog(title, ui[0], 250, 100, pos.left, pos.top);\r\n    }\r\n\r\n    //по элементу дерева слоёв ищет соответствующий элемент в DOM представлении\r\n    layersTree.prototype.findUITreeElem = function(elem) {\r\n        var props = elem.content.properties,\r\n            searchStr;\r\n\r\n        if (props.LayerID)\r\n            searchStr = \"div[LayerID='\" + props.LayerID + \"']\";\r\n        else if (props.MultiLayerID)\r\n            searchStr = \"div[MultiLayerID='\" + props.MultiLayerID + \"']\";\r\n        else if (props.GroupID)\r\n            searchStr = \"div[GroupID='\" + props.GroupID + \"']\";\r\n        else\r\n            searchStr = \"div[LayerID='\" + props.name + \"']\";\r\n\r\n        return $(this._treeCanvas).find(searchStr)[0];\r\n    }\r\n\r\n    layersTree.prototype.getLayerVisibility = function(box) {\r\n        if (!box.checked)\r\n            return false;\r\n\r\n        var el = box.parentNode.parentNode.parentNode;\r\n\r\n        while (!el.root) {\r\n            var group = $(el).children(\"[GroupID]\"),\r\n                chB = $(group).find('input[type=\"checkbox\"]')[0] || $(group).find('input[type=\"radio\"]')[0];\r\n\r\n            if (group.length > 0) {\r\n                if (!chB.checked)\r\n\r\n                    return false;\r\n            }\r\n\r\n            el = el.parentNode;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    //Устанавливает галочку в checkbox и нужный стиль DOM ноде дерева в зависимости от видимости\r\n    //ничего не трогает вне ноды и в самом дереве\r\n    layersTree.prototype.updateVisibilityUI = function(elem) {\r\n        var div = this.findUITreeElem(elem);\r\n        if (div) {\r\n            var isVisible = elem.content.properties.visible;\r\n            $(div).children(\"[titleDiv], [multiStyle]\").toggleClass(\"invisible\", !isVisible);\r\n            var checkbox = $(div).find('input[type=\"checkbox\"]')[0] || $(div).find('input[type=\"radio\"]')[0];\r\n            checkbox.checked = isVisible;\r\n        }\r\n    }\r\n\r\n    layersTree.prototype.dummyNode = function(node) {\r\n        var text = node.innerHTML;\r\n\r\n        if (text.length > 40) {\r\n            text = text.substring(0, 37) + '...';\r\n        }\r\n\r\n        return _div([_t(text)], [\r\n            ['dir', 'className', 'dragableDummy']\r\n        ]);\r\n    }\r\n\r\n    //проходится по всем слоям дерева и устанавливает им z-индексы в соответствии с их порядком в дереве\r\n    layersTree.prototype.updateZIndexes = function() {\r\n        var curZIndex = 0;\r\n\r\n        this.treeModel.forEachLayer(function(layerContent) {\r\n            var layer = nsGmx.gmxMap.layersByID[layerContent.properties.name];\r\n\r\n            var zIndex = curZIndex++;\r\n            layer.setZIndex && layer.setZIndex(zIndex);\r\n        })\r\n    }\r\n\r\n    layersTree.prototype.moveHandler = function(spanSource, divDestination) {\r\n        var node = divDestination.parentNode,\r\n            divSource = spanSource.parentNode.parentNode.parentNode,\r\n            parentTree = divSource.parentNode,\r\n            parentElem = this.findTreeElem($(divSource).children(\"div[GroupID],div[LayerID],div[MultiLayerID]\")[0]).parents[0];\r\n\r\n        this.removeTreeElem(spanSource.parentNode.parentNode);\r\n        this.addTreeElem(divDestination, 0, spanSource.parentNode.parentNode.gmxProperties);\r\n\r\n        // добавим новый узел\r\n        var childsUl = _abstractTree.getChildsUl(node);\r\n\r\n        if (childsUl) {\r\n            _abstractTree.addNode(node, divSource);\r\n\r\n            this.updateListType(divSource);\r\n\r\n            if (!childsUl.loaded)\r\n                divSource.removeNode(true)\r\n        } else {\r\n            _abstractTree.addNode(node, divSource);\r\n\r\n            this.updateListType(divSource);\r\n        }\r\n\r\n        parentElem && parentElem.content && this.treeModel.updateNodeVisibility(parentElem);\r\n\r\n        // удалим старый узел\r\n        _abstractTree.delNode(node, parentTree, parentTree.parentNode);\r\n\r\n        _mapHelper.updateUnloadEvent(true);\r\n\r\n        this.updateZIndexes();\r\n    }\r\n\r\n    layersTree.prototype.swapHandler = function(spanSource, divDestination) {\r\n        var node = divDestination.parentNode,\r\n            divSource = spanSource.parentNode.parentNode.parentNode,\r\n            parentTree = divSource.parentNode,\r\n            parentElem = this.findTreeElem($(divSource).children(\"div[GroupID],div[LayerID],div[MultiLayerID]\")[0]).parents[0];\r\n\r\n        if (node == divSource)\r\n            return;\r\n\r\n        this.removeTreeElem(spanSource.parentNode.parentNode);\r\n\r\n        var divElem = $(divDestination.parentNode).children(\"div[GroupID],div[LayerID],div[MultiLayerID]\")[0],\r\n            divParent = $(divDestination.parentNode.parentNode.parentNode).children(\"div[MapID],div[GroupID]\")[0],\r\n            index = this.findTreeElem(divElem).index;\r\n\r\n        this.addTreeElem(divParent, index + 1, spanSource.parentNode.parentNode.gmxProperties);\r\n\r\n        _abstractTree.swapNode(node, divSource);\r\n\r\n        this.updateListType(divSource);\r\n\r\n        parentElem && parentElem.content && this.treeModel.updateNodeVisibility(parentElem);\r\n\r\n        // удалим старый узел\r\n        _abstractTree.delNode(node, parentTree, parentTree.parentNode);\r\n\r\n        _mapHelper.updateUnloadEvent(true);\r\n\r\n        this.updateZIndexes();\r\n    }\r\n\r\n    layersTree.prototype.copyHandler = function(gmxProperties, divDestination, swapFlag, addToMap) {\r\n        var _this = this;\r\n        var isFromList = typeof gmxProperties.content.geometry === 'undefined';\r\n        var layerProperties = (gmxProperties.type !== 'layer' || !isFromList) ? gmxProperties : false,\r\n            copyFunc = function() {\r\n                if (addToMap) {\r\n                    if (!_this.addLayersToMap(layerProperties)) {\r\n                        return;\r\n                    }\r\n                }\r\n                else if (_this.treeModel.findElemByGmxProperties(gmxProperties)) {\r\n                    if (layerProperties.type === 'layer') {\r\n                        showErrorMessage(_gtxt(\"Слой '[value0]' уже есть в карте\", layerProperties.content.properties.title), true);\r\n                    }\r\n                    else {\r\n                        showErrorMessage(_gtxt(\"Группа '[value0]' уже есть в карте\", layerProperties.content.properties.title), true);\r\n                    }\r\n                    return;\r\n                }\r\n\r\n\r\n                var node = divDestination.parentNode,\r\n                    parentProperties = swapFlag ? $(divDestination.parentNode.parentNode.parentNode).children(\"div[GroupID],div[MapID]\")[0].gmxProperties : divDestination.gmxProperties,\r\n                    li;\r\n\r\n                if (swapFlag) {\r\n                    var parentDiv = $(divDestination.parentNode.parentNode.parentNode).children(\"div[GroupID],div[MapID]\")[0];\r\n\r\n                    li = _this.getChildsList(layerProperties, parentProperties, false, parentDiv.getAttribute('MapID') ? true : _this.getLayerVisibility($(parentDiv).find('input[type=\"checkbox\"]')[0] ? $(parentDiv).find('input[type=\"checkbox\"]')[0] : parentDiv.firstChild));\r\n                } else\r\n                    li = _this.getChildsList(layerProperties, parentProperties, false, _this.getLayerVisibility($(divDestination).find('input[type=\"checkbox\"]')[0] ? $(divDestination).find('input[type=\"checkbox\"]')[0] : divDestination.firstChild));\r\n\r\n                if (layerProperties.type == 'group') {\r\n                    // добавляем группу\r\n                    if (_abstractTree.getChildsUl(li)) {\r\n                        var div = _div(null, [\r\n                            ['dir', 'className', 'hitarea']\r\n                        ]);\r\n\r\n                        if (layerProperties.content.properties.expanded) {\r\n                            $(div).addClass('collapsable-hitarea');\r\n                            $(li).addClass('collapsable');\r\n                        } else {\r\n                            $(div).addClass('expandable-hitarea');\r\n                            $(li).addClass('expandable');\r\n                        }\r\n\r\n                        _abstractTree.toggle(div);\r\n\r\n                        li.insertBefore(div, li.firstChild);\r\n\r\n                        $(li).treeview();\r\n\r\n                        // если копируем из карты\r\n                        if (isFromList)\r\n                            _layersTree.runLoadingFuncs();\r\n                    }\r\n\r\n                    _queryMapLayers.addDraggable(li)\r\n\r\n                    _queryMapLayers.addDroppable(li);\r\n                } else {\r\n                    _queryMapLayers.addDraggable(li);\r\n\r\n                    if (layerProperties.type == 'layer' && layerProperties.content.properties.styles.length > 1)\r\n                        $(li).treeview();\r\n                }\r\n\r\n                _queryMapLayers.addSwappable(li);\r\n\r\n                if (swapFlag) {\r\n                    var divElem = $(divDestination.parentNode).children(\"div[GroupID],div[LayerID],div[MultiLayerID]\")[0],\r\n                        divParent = $(divDestination.parentNode.parentNode.parentNode).children(\"div[MapID],div[GroupID]\")[0],\r\n                        index = _this.findTreeElem(divElem).index;\r\n\r\n                    _this.addTreeElem(divParent, index + 1, layerProperties);\r\n\r\n                    _abstractTree.swapNode(node, li);\r\n\r\n                    _this.updateListType(li, true);\r\n                } else {\r\n                    _this.addTreeElem(divDestination, 0, layerProperties);\r\n\r\n                    var childsUl = _abstractTree.getChildsUl(node);\r\n\r\n                    _abstractTree.addNode(node, li);\r\n                    _this.updateListType(li, true);\r\n\r\n                    if (childsUl && !childsUl.loaded) {\r\n                        li.removeNode(true)\r\n                    }\r\n                }\r\n\r\n                _mapHelper.updateUnloadEvent(true);\r\n\r\n                _this.updateZIndexes();\r\n            };\r\n\r\n        if (!layerProperties) {\r\n            if (gmxProperties.content.properties.LayerID) {\r\n                sendCrossDomainJSONRequest(window.serverBase + \"Layer/GetLayerJson.ashx?WrapStyle=func&LayerName=\" + gmxProperties.content.properties.name + \"&srs=\" + (nsGmx.leafletMap.options.srs || \"3395\"), function(response) {\r\n                    if (!parseResponse(response))\r\n                        return;\r\n\r\n                    layerProperties = { type: 'layer', content: response.Result };\r\n\r\n                    if (layerProperties.content.properties.type == 'Vector')\r\n                        layerProperties.content.properties.styles = [{ MinZoom: 1, MaxZoom: 21, RenderStyle: layerProperties.content.properties.IsPhotoLayer ? _mapHelper.defaultPhotoIconStyles[layerProperties.content.properties.GeometryType] : _mapHelper.defaultStyles[layerProperties.content.properties.GeometryType] }]\r\n                    else if (layerProperties.content.properties.type != 'Vector' && !layerProperties.content.properties.MultiLayerID)\r\n                        layerProperties.content.properties.styles = [{ MinZoom: layerProperties.content.properties.MinZoom, MaxZoom: 21 }];\r\n\r\n                    layerProperties.content.properties.mapName = _this.treeModel.getMapProperties().name;\r\n                    layerProperties.content.properties.hostName = _this.treeModel.getMapProperties().hostName;\r\n                    layerProperties.content.properties.visible = true;\r\n\r\n                    copyFunc();\r\n                })\r\n            } else {\r\n                sendCrossDomainJSONRequest(window.serverBase + \"MultiLayer/GetMultiLayerJson.ashx?WrapStyle=func&MultiLayerID=\" + gmxProperties.content.properties.MultiLayerID, function(response) {\r\n                    if (!parseResponse(response))\r\n                        return;\r\n\r\n                    layerProperties = { type: 'layer', content: response.Result };\r\n\r\n                    layerProperties.content.properties.styles = [{ MinZoom: layerProperties.content.properties.MinZoom, MaxZoom: 20 }];\r\n\r\n                    layerProperties.content.properties.mapName = _this.treeModel.getMapProperties().name;\r\n                    layerProperties.content.properties.hostName = _this.treeModel.getMapProperties().hostName;\r\n                    layerProperties.content.properties.visible = true;\r\n\r\n                    copyFunc();\r\n                })\r\n            }\r\n        } else\r\n            copyFunc();\r\n    }\r\n\r\n    //не работает для мультислоёв\r\n    layersTree.prototype.addLayerToTree = function(layerName) {\r\n        var gmxProperties = {\r\n            type: 'layer',\r\n            content: {\r\n                properties: {\r\n                    LayerID: layerName,\r\n                    name: layerName\r\n                }\r\n            }\r\n        };\r\n\r\n        var targetDiv = $(_queryMapLayers.buildedTree.firstChild).children(\"div[MapID]\")[0];\r\n\r\n        this.copyHandler(gmxProperties, targetDiv, false, true);\r\n    }\r\n\r\n    layersTree.prototype.checkGroupForDuplicates = function(elements) {\r\n        var alreadyOnMap = false;\r\n        for (var i = 0; i < elements.length; i++) {\r\n            var elem = elements[i],\r\n                layer = elem.content,\r\n                name = layer.properties.name;\r\n\r\n            if (nsGmx.gmxMap.layersByID[name]) {\r\n                alreadyOnMap = nsGmx.gmxMap.layersByID[name].getGmxProperties().title;\r\n                break;\r\n            }\r\n        }\r\n        return alreadyOnMap;\r\n    }\r\n\r\n    //геометрия слоёв должна быть в координатах меркатора\r\n    layersTree.prototype.addLayersToMap = function(elem) {\r\n        var DEFAULT_VECTOR_LAYER_ZINDEXOFFSET = 2000000;\r\n\r\n        var layerOrder = nsGmx.gmxMap.rawTree.properties.LayerOrder,\r\n            currentZoom = nsGmx.leafletMap.getZoom();\r\n\r\n        if (typeof elem.content.properties.GroupID != 'undefined') {\r\n            var alreadyOnMap = this.checkGroupForDuplicates(elem.content.children);\r\n            if (alreadyOnMap) {\r\n                showErrorMessage(_gtxt(\"Слой '[value0]' уже есть в карте\", alreadyOnMap), true);\r\n                return false;\r\n            } else {\r\n                for (var i = 0; i < elem.content.children.length; i++) {\r\n                var res = this.addLayersToMap(elem.content.children[i]);\r\n\r\n                    if (!res)\r\n                        return false;\r\n                }\r\n            }\r\n        } else {\r\n            var layer = elem.content,\r\n                name = layer.properties.name;\r\n\r\n            // hack to avoid API defaults by initFromDescription;\r\n            var propsHostName = window.serverBase.replace(/https?:\\/\\//, '');\r\n            propsHostName = propsHostName.replace(/\\//g, '');\r\n\r\n            layer.properties.hostName = propsHostName;\r\n\r\n            if (!nsGmx.gmxMap.layersByID[name]) {\r\n                var visibility = typeof layer.properties.visible != 'undefined' ? layer.properties.visible : false,\r\n                    layerOnMap = L.gmx.createLayer(layer, {\r\n                        layerID: name,\r\n                        hostName: propsHostName,\r\n                        zIndexOffset: null,\r\n                        srs: nsGmx.leafletMap.options.srs || '',\r\n                        skipTiles: nsGmx.leafletMap.options.skipTiles || '',\r\n                        isGeneralized: window.mapOptions && 'isGeneralized' in window.mapOptions ? window.mapOptions.isGeneralized : true\r\n                    });\r\n\r\n                updateZIndex(layerOnMap);\r\n                nsGmx.gmxMap.addLayer(layerOnMap);\r\n\r\n                visibility && nsGmx.leafletMap.addLayer(layerOnMap);\r\n\r\n                layerOnMap.getGmxProperties().changedByViewer = true;\r\n\r\n                nsGmx.leafletMap.on('zoomend', function() {\r\n                    currentZoom = nsGmx.leafletMap.getZoom();\r\n\r\n                    for (var l = 0; l < nsGmx.gmxMap.layers.length; l++) {\r\n                        var layer = nsGmx.gmxMap.layers[l];\r\n\r\n                        updateZIndex(layer);\r\n                    }\r\n                });\r\n            } else {\r\n                showErrorMessage(_gtxt(\"Слой '[value0]' уже есть в карте\", nsGmx.gmxMap.layersByID[name].getGmxProperties().title), true);\r\n                return false;\r\n            }\r\n        }\r\n\r\n        function updateZIndex(layer) {\r\n            var props = layer.getGmxProperties();\r\n\r\n            switch (layerOrder) {\r\n                case 'VectorOnTop':\r\n                    if (props.type === 'Vector') {\r\n                        if (props.IsRasterCatalog) {\r\n                            var rcMinZoom = props.RCMinZoomForRasters;\r\n                            layer.setZIndexOffset(currentZoom < rcMinZoom ? DEFAULT_VECTOR_LAYER_ZINDEXOFFSET : 0);\r\n                        } else {\r\n                            layer.setZIndexOffset(DEFAULT_VECTOR_LAYER_ZINDEXOFFSET);\r\n                        }\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    layersTree.prototype.getParentParams = function(li) {\r\n        //при визуализации дерева в него добавляются новые элементы. Используем хак, чтобы понять, было отрисовано дерево или нет\r\n        var parentParams = li.parentNode.parentNode.childNodes[1].tagName == \"DIV\" ? li.parentNode.parentNode.childNodes[1].gmxProperties : li.parentNode.parentNode.childNodes[0].gmxProperties,\r\n            listFlag;\r\n\r\n        if (parentParams.content)\r\n            listFlag = parentParams.content.properties;\r\n        else\r\n            listFlag = parentParams.properties;\r\n\r\n        return listFlag;\r\n    }\r\n\r\n    layersTree.prototype.updateListType = function(li, skipVisible) {\r\n        //при визуализации дерева в него добавляются новые элементы. Используем хак, чтобы понять, было отрисовано дерево или нет\r\n        var parentParams = li.parentNode.parentNode.childNodes[1].tagName == \"DIV\" ? li.parentNode.parentNode.childNodes[1].gmxProperties : li.parentNode.parentNode.childNodes[0].gmxProperties,\r\n            listFlag;\r\n\r\n        if (parentParams.content)\r\n            listFlag = parentParams.content.properties.list;\r\n        else\r\n            listFlag = parentParams.properties.list;\r\n\r\n        var div = $(li).children(\"div[MapID],div[GroupID],div[LayerID],div[MultiLayerID]\")[0],\r\n            box = $(div).find('input[type=\"checkbox\"]')[0] || $(div).find('input[type=\"radio\"]')[0],\r\n            newBox = _checkbox(\r\n                box.checked,\r\n                listFlag ? 'radio' : 'checkbox',\r\n                parentParams.content ? parentParams.content.properties.GroupID : parentParams.properties.MapID\r\n            ),\r\n            _this = this;\r\n\r\n        newBox.className = 'box layers-visibility-checkbox';\r\n\r\n        if (box.getAttribute('box') == 'group')\r\n            newBox.setAttribute('box', 'group');\r\n\r\n        $(box).replaceWith(newBox);\r\n\r\n        newBox.onclick = function() {\r\n            _this.treeModel.setNodeVisibility(_this.findTreeElem(this.parentNode).elem, this.checked);\r\n        }\r\n\r\n        if (box.isDummyCheckbox) {\r\n            newBox.isDummyCheckbox = true;\r\n            newBox.style.display = 'none';\r\n        }\r\n\r\n        if (!skipVisible) {\r\n            var parentDiv = $(newBox.parentNode.parentNode.parentNode.parentNode).children(\"div[GroupID]\")[0];\r\n            parentDiv && this.treeModel.updateNodeVisibility(this.findTreeElem(parentDiv).elem, this.findTreeElem(newBox.parentNode).elem);\r\n        }\r\n\r\n        return newBox;\r\n    }\r\n\r\n    layersTree.prototype.removeTreeElem = function(div) {\r\n        var elem = this.findTreeElem(div);\r\n\r\n        if (typeof elem.parents[0].children != 'undefined')\r\n            elem.parents[0].children.splice(elem.index, 1);\r\n        else\r\n            elem.parents[0].content.children.splice(elem.index, 1);\r\n    }\r\n\r\n    layersTree.prototype.addTreeElem = function(div, index, elemProperties) {\r\n        var elem = this.findTreeElem(div);\r\n\r\n        if (typeof elem.elem.children != 'undefined')\r\n            elem.elem.children.splice(index, 0, elemProperties);\r\n        else\r\n            elem.elem.content.children.splice(index, 0, elemProperties);\r\n\r\n        $(this.treeModel.getRawTree()).triggerHandler('addTreeElem', [elemProperties]);\r\n    }\r\n\r\n    layersTree.prototype.findTreeElem = function(div) {\r\n        if (div.getAttribute(\"MapID\"))\r\n            return { elem: this.treeModel.getRawTree(), parents: [], index: false };\r\n        else if (div.getAttribute(\"GroupID\"))\r\n            return this.treeModel.findElem(\"GroupID\", div.getAttribute(\"GroupID\"));\r\n        else if (div.getAttribute(\"LayerID\"))\r\n            return this.treeModel.findElem(\"name\", div.getAttribute(\"LayerID\"));\r\n        else if (div.getAttribute(\"MultiLayerID\"))\r\n            return this.treeModel.findElem(\"name\", div.getAttribute(\"MultiLayerID\"));\r\n    }\r\n\r\n    //Дерево основной карты\r\n    var _layersTree = new layersTree({ showVisibilityCheckbox: true, allowActive: true, allowDblClick: true });\r\n\r\n    window.layersTree = layersTree;\r\n    window._layersTree = _layersTree;\r\n\r\n    //Виджет в левой панели для отображения основного дерева\r\n    var queryMapLayers = function() {\r\n        this.buildedTree = null;\r\n        this.builded = false;\r\n\r\n        this.buttonsCanvas = _div();\r\n\r\n        this.loadDeferred = $.Deferred();\r\n    }\r\n\r\n    queryMapLayers.prototype = new leftMenu();\r\n\r\n    queryMapLayers.prototype.addLayers = function(data, condition, mapStyles, LayersTreePermalinkParams) {\r\n        if (condition)\r\n            _layersTree.condition = condition;\r\n\r\n        if (mapStyles)\r\n            _layersTree.mapStyles = mapStyles;\r\n\r\n        if (LayersTreePermalinkParams)\r\n            _layersTree.LayersTreePermalinkParams = LayersTreePermalinkParams;\r\n\r\n        this.buildedTree = _layersTree.drawTree(data);\r\n    }\r\n\r\n    queryMapLayers.prototype.applyState = function(condition, mapLayersParam, div) {\r\n        if (!objLength(condition.visible) && !objLength(condition.expanded) && !objLength(mapLayersParam))\r\n            return;\r\n\r\n        var parentElem = typeof div == 'undefined' ? _layersTree.treeModel.getRawTree() : _layersTree.findTreeElem(div).elem,\r\n            visFlag = typeof div == 'undefined' ? true : _layersTree.getLayerVisibility($(div).find('input[type=\"checkbox\"]')[0] || $(div).find('input[type=\"radio\"]')[0]),\r\n            _this = this;\r\n\r\n        _mapHelper.findTreeElems(parentElem, function(elem) {\r\n            let props = elem.content.properties;\r\n            if (elem.type == 'group') {\r\n                let groupId = props.GroupID;\r\n\r\n                if (typeof condition.visible[groupId] != 'undefined' && props.visible != condition.visible[groupId]) {\r\n                    props.visible = condition.visible[groupId];\r\n\r\n                    let group = $(_this.buildedTree).find(\"div[GroupID='\" + groupId + \"']\");\r\n\r\n                    if (group.length) {\r\n                        let it = $(group).find('input[type=\"checkbox\"]')[0] || $(group).find('input[type=\"radio\"]')[0];\r\n                        if (it) it.checked = condition.visible[groupId];\r\n                    }\r\n                }\r\n\r\n                if (typeof condition.expanded[groupId] != 'undefined' && props.expanded != condition.expanded[groupId]) {\r\n                    props.expanded = condition.expanded[groupId];\r\n\r\n                    let group = $(_this.buildedTree).find(\"div[GroupID='\" + groupId + \"']\");\r\n\r\n                    if (group.length) {\r\n                        let clickDiv = $(group[0].parentNode).children(\"div.hitarea\");\r\n\r\n                        if (clickDiv.length)\r\n                            $(clickDiv[0]).trigger(\"click\");\r\n                    }\r\n                }\r\n            } else {\r\n                let name = props.name;\r\n                if (typeof condition.visible[name] != 'undefined') {\r\n                    _layersTree.treeModel.setNodeVisibility(elem, condition.visible[name]);\r\n                } else {\r\n                    _layersTree.treeModel.setNodeVisibility(elem, props.initVisible);\r\n                }\r\n\r\n                if (props.type == \"Vector\" && typeof mapLayersParam != 'undefined' && typeof mapLayersParam[name] != 'undefined' &&\r\n                    !_this.equalStyles(props.styles, mapLayersParam[name])) {\r\n                    // что-то менялось в стилях\r\n                    let newStyles = mapLayersParam[name],\r\n                        div = $(_this.buildedTree).find(\"div[LayerID='\" + props.LayerID + \"']\")[0];\r\n\r\n                    props.styles = newStyles;\r\n\r\n                    _mapHelper.updateMapStyles(newStyles, name);\r\n                    props.changedByViewer = true;\r\n\r\n                    div && _mapHelper.updateTreeStyles(newStyles, div, _layersTree, true);\r\n                }\r\n            }\r\n        }, visFlag)\r\n    }\r\n\r\n    queryMapLayers.prototype.equalStyles = function(style1, style2) {\r\n        if (style1.length != style2.length)\r\n            return false;\r\n\r\n        for (let i = 0; i < style1.length; i++)\r\n            if (!equals(style1[i], style2[i]))\r\n                return false;\r\n\r\n        return true;\r\n    }\r\n\r\n    queryMapLayers.prototype.getContainerBefore = function() {\r\n        if (!this.builded) return;\r\n\r\n        return $('.layers-before', this.workCanvas).show();\r\n    }\r\n\r\n    queryMapLayers.prototype.getContainerAfter = function() {\r\n        if (!this.builded) return;\r\n\r\n        return $('.layers-after', this.workCanvas).show();\r\n    }\r\n\r\n    queryMapLayers.prototype.load = function() {\r\n        if (this.buildedTree && !this.builded) {\r\n            var _this = this;\r\n\r\n            this.treeCanvas = _div(null, [\r\n                ['dir', 'className', 'layers-tree']\r\n            ]);\r\n\r\n            //Для обратной совместимости - есть много мапплетов карт, которые пытаются интегрироваться после первого table\r\n            //TODO: изнечтожить все такие мапплеты\r\n            _(this.workCanvas, [_table()]);\r\n\r\n            _(this.workCanvas, [\r\n                _div([\r\n                    //_table([_tbody([_tr([_td([_span([_t(_gtxt(\"Шкала прозрачности\"))],[['css','marginLeft','7px'],['css','color','#153069'],['css','fontSize','12px']])]), _td([this.rasterLayersSlider(_queryMapLayers.treeCanvas)])])])])\r\n                ], [\r\n                    ['dir', 'className', 'layers-before'],\r\n                    ['css', 'display', 'none']\r\n                ])\r\n            ]);\r\n\r\n            _(this.workCanvas, [this.treeCanvas]);\r\n\r\n            _(this.treeCanvas, [this.buildedTree]);\r\n\r\n            _(this.workCanvas, [\r\n                _div([\r\n                    //_table([_tbody([_tr([_td([_span([_t(_gtxt(\"Шкала прозрачности\"))],[['css','marginLeft','7px'],['css','color','#153069'],['css','fontSize','12px']])]), _td([this.rasterLayersSlider(_queryMapLayers.treeCanvas)])])])])\r\n                ], [\r\n                    ['dir', 'className', 'layers-after'],\r\n                    ['css', 'display', 'none']\r\n                ])\r\n            ]);\r\n\r\n            $(this.buildedTree).treeview();\r\n\r\n            _layersTree.runLoadingFuncs();\r\n\r\n            _layersTree.addExpandedEvents(this.buildedTree);\r\n\r\n            //при клике на любом пустом месте дерева слоёв снимаем выделение\r\n            $(this.treeCanvas).click(function(event) {\r\n                var t = $(event.target);\r\n                //все элементы, на которых можно кликнуть без снятия выделения\r\n                if (t.hasClass('hitarea') || t.hasClass('groupLayer') || t.attr('styletype') || t.parents('div[layerid],div[MultiLayerID]').length) {\r\n                    return;\r\n                }\r\n                _layersTree.setActive(null);\r\n            });\r\n\r\n            $(this.treeCanvas).droppable({\r\n                accept: \"span[dragg]\",\r\n                drop: function(ev, ui) {\r\n                    queryMapLayers._droppableHandler.bind($(_this.buildedTree).find('[mapid]')[0], ev, ui)();\r\n                }\r\n            })\r\n\r\n            this.applyState(_layersTree.condition, _layersTree.mapStyles);\r\n\r\n            this.builded = true;\r\n\r\n            $(this).triggerHandler('load');\r\n            this.loadDeferred.resolve();\r\n        }\r\n    }\r\n\r\n    queryMapLayers.prototype.applyOpacityToRasterLayers = function(opacity, parent) {\r\n\r\n        var active = $(parent).find(\".active\");\r\n\r\n        // слой\r\n        if (active[0] && (active[0].parentNode.getAttribute(\"LayerID\") || active[0].parentNode.getAttribute(\"MultiLayerID\"))) {\r\n            var props = active[0].parentNode.gmxProperties.content.properties,\r\n                layer = nsGmx.gmxMap.layersByID[props.name];\r\n\r\n            layer.setRasterOpacity && layer.setRasterOpacity(opacity / 100);\r\n\r\n            return;\r\n        }\r\n\r\n        if (active.length) {\r\n            // группа или карта\r\n            var treeElem = _layersTree.findTreeElem(active[0].parentNode);\r\n\r\n            _mapHelper.findChilds(treeElem.elem, function(child) {\r\n                var props = child.content.properties;\r\n                var layer = nsGmx.gmxMap.layersByID[props.name];\r\n                layer.setRasterOpacity && layer.setRasterOpacity(opacity / 100);\r\n            }, true);\r\n        } else {\r\n            // все растровые слои\r\n            var layers = nsGmx.gmxMap.layers;\r\n            for (var i = 0; i < layers.length; i++) {\r\n                layers[i].setRasterOpacity && layers[i].setRasterOpacity(opacity / 100);\r\n            }\r\n        }\r\n    }\r\n\r\n    queryMapLayers.prototype.rasterLayersSlider = function(parent) {\r\n        var slider = nsGmx.Controls.createSlider(100,\r\n                function(event, ui) {\r\n                    _queryMapLayers.applyOpacityToRasterLayers(ui.value, parent);\r\n                }),\r\n            elem = _div([slider], [\r\n                ['css', 'width', '120px']\r\n            ]);\r\n\r\n        slider.style.margin = '10px';\r\n        slider.style.backgroundColor = '#F4F4F4';\r\n\r\n        _title(slider, _gtxt(\"Прозрачность выбранного слоя/группы/карты\"));\r\n\r\n        return _div([elem], [\r\n            ['css', 'padding', '5px 0px 0px 15px']\r\n        ]);\r\n    }\r\n\r\n    queryMapLayers.prototype.currentMapRights = function() {\r\n        var mapProperties = _layersTree.treeModel && _layersTree.treeModel.getMapProperties();\r\n        return mapProperties ? mapProperties.Access : \"none\";\r\n    }\r\n\r\n    queryMapLayers.prototype.layerRights = function(name) {\r\n        var layer = nsGmx.gmxMap.layersByID[name];\r\n        return layer ? layer.getGmxProperties().Access : null;\r\n    }\r\n\r\n    queryMapLayers.prototype.addUserActions = function() {\r\n        if (this.currentMapRights() == \"edit\") {\r\n            this.addDraggable(this.treeCanvas);\r\n\r\n            this.addDroppable(this.treeCanvas);\r\n\r\n            this.addSwappable(this.treeCanvas);\r\n        }\r\n    }\r\n\r\n    queryMapLayers.prototype.removeUserActions = function() {\r\n        //  removeChilds(this.buttonsCanvas);\r\n\r\n        this.removeDraggable(this.treeCanvas);\r\n\r\n        this.removeDroppable(this.treeCanvas);\r\n\r\n        this.removeSwappable(this.treeCanvas);\r\n    }\r\n\r\n    queryMapLayers.prototype.addDraggable = function(parent) {\r\n        $(parent).find(\"span[dragg]\").draggable({\r\n            helper: function(ev) {\r\n                return _layersTree.dummyNode(ev.target)\r\n            },\r\n            cursorAt: { left: 5, top: 10 },\r\n            appendTo: document.body\r\n        });\r\n    }\r\n    queryMapLayers.prototype.removeDraggable = function(parent) {\r\n        $(parent).find(\"span[dragg]\").draggable('destroy');\r\n    }\r\n\r\n    queryMapLayers._droppableHandler = function(ev, ui) {\r\n        $('body').css(\"cursor\", '');\r\n\r\n        // удалим элемент, отображающий копирование\r\n        ui.helper[0].removeNode(true)\r\n\r\n        // уберем заведомо ложные варианты - сам в себя, копирование условий\r\n        if (this == ui.draggable[0].parentNode.parentNode) return;\r\n\r\n        var circle = false,\r\n            layerManager = false;\r\n\r\n        $(this).parents().each(function() {\r\n            if ($(this).prev().length > 0 && $(this).prev()[0] == ui.draggable[0].parentNode.parentNode)\r\n                circle = true;\r\n        })\r\n\r\n        if (circle) return;\r\n\r\n        var isFromExternalMaps = false;\r\n        $(ui.draggable[0].parentNode.parentNode).parents().each(function() {\r\n            if (this == $('#layersList')[0] || this == $('#mapsList')[0] || this == $('#externalMapsCanvas')[0])\r\n                layerManager = true;\r\n\r\n            if (this == $('#externalMapsCanvas')[0])\r\n                isFromExternalMaps = true;\r\n        })\r\n\r\n        if (!layerManager)\r\n            _layersTree.moveHandler(ui.draggable[0], this)\r\n        else\r\n            _layersTree.copyHandler(ui.draggable[0].parentNode.parentNode.gmxProperties, this, false, !isFromExternalMaps)\r\n    }\r\n\r\n    queryMapLayers.prototype.addDroppable = function(parent) {\r\n        $(parent).find(\"div[GroupID],div[MapID]\").droppable({\r\n            accept: \"span[dragg]\",\r\n            hoverClass: 'droppableHover',\r\n            greedy: true,\r\n            drop: queryMapLayers._droppableHandler\r\n        })\r\n\r\n        $(parent).find(\"div[LayerID],div[MultiLayerID]\").droppable({\r\n            accept: \"span[dragg]\",\r\n            greedy: true,\r\n            drop: function(ev, ui) {\r\n                var swapElem = $(this).next();\r\n                swapElem.removeClass('swap-droppableHover');\r\n                queryMapLayers._swapHandler.call(swapElem[0], ev, ui);\r\n            },\r\n            over: function() {\r\n                $(this).next().addClass('swap-droppableHover');\r\n            },\r\n            out: function() {\r\n                $(this).next().removeClass('swap-droppableHover');\r\n            }\r\n        })\r\n    }\r\n    queryMapLayers.prototype.removeDroppable = function(parent) {\r\n        $(parent).find(\"div[GroupID],div[MapID]\").droppable('destroy');\r\n    }\r\n\r\n    //статическая ф-ция\r\n    queryMapLayers._swapHandler = function(ev, ui) {\r\n        $('body').css(\"cursor\", '');\r\n\r\n        // удалим элемент, отображающий копирование\r\n        ui.helper[0].removeNode(true);\r\n\r\n        //проверим, не идёт ли копирование группы внутрь самой себя\r\n        var circle = false;\r\n\r\n        $(this).parents().each(function() {\r\n            if ($(this).prev().length > 0 && $(this).prev()[0] == ui.draggable[0].parentNode.parentNode)\r\n                circle = true;\r\n        })\r\n\r\n        if (circle) return;\r\n\r\n        var layerManager = false;\r\n\r\n        var isFromExternalMaps = false;\r\n        $(ui.draggable[0].parentNode.parentNode).parents().each(function() {\r\n            if (this == $('#layersList')[0] || this == $('#mapsList')[0] || this == $('#externalMapsCanvas')[0])\r\n                layerManager = true;\r\n\r\n            if (this == $('#externalMapsCanvas')[0])\r\n                isFromExternalMaps = true;\r\n        })\r\n\r\n        var gmxProperties = ui.draggable[0].parentNode.parentNode.gmxProperties;\r\n\r\n        if (!layerManager)\r\n            _layersTree.swapHandler(ui.draggable[0], this)\r\n        else\r\n            _layersTree.copyHandler(gmxProperties, this, true, !isFromExternalMaps)\r\n    }\r\n\r\n    queryMapLayers.prototype.addSwappable = function(parent) {\r\n        $(parent).find(\"div[swap]\").droppable({ accept: \"span[dragg]\", hoverClass: 'swap-droppableHover', greedy: true, drop: queryMapLayers._swapHandler })\r\n    }\r\n    queryMapLayers.prototype.removeSwappable = function(parent) {\r\n        $(parent).find(\"div[swap]\").droppable('destroy');\r\n    }\r\n\r\n    queryMapLayers.prototype.asyncCreateLayer = function(promise, title) {\r\n        var _this = this;\r\n\r\n        var taskDiv = _div(),\r\n            active = $(_this.buildedTree).find(\".active\")[0],\r\n            parentDiv;\r\n\r\n        if (active && (active.parentNode.getAttribute('MapID') || active.parentNode.getAttribute('GroupID')))\r\n            parentDiv = active.parentNode.parentNode;\r\n        else\r\n            parentDiv = _this.buildedTree.firstChild;\r\n\r\n        _abstractTree.addNode(parentDiv, _li([taskDiv, _div(null, [\r\n            ['css', 'height', '5px'],\r\n            ['css', 'fontSize', '0px']\r\n        ])]));\r\n\r\n        promise\r\n        .fail(function() {\r\n            var parentTree = taskDiv.parentNode.parentNode;\r\n            taskDiv.parentNode.removeNode(true);\r\n            _abstractTree.delNode(null, parentTree, parentTree.parentNode);\r\n        })\r\n        .done(function(taskInfo) {\r\n            if (!$.isArray(taskInfo.Result)) {\r\n                taskInfo.Result = [taskInfo.Result];\r\n            }\r\n\r\n            var parentDiv = $(taskDiv.parentNode.parentNode.parentNode).children(\"div[GroupID],div[MapID]\")[0],\r\n                parentProperties = parentDiv.gmxProperties;\r\n\r\n            var parentTree = taskDiv.parentNode.parentNode;\r\n            taskDiv.parentNode.removeNode(true);\r\n            _abstractTree.delNode(null, parentTree, parentTree.parentNode);\r\n\r\n            for (var l = 0; l < taskInfo.Result.length; l++) {\r\n                var newLayer = taskInfo.Result[l];\r\n                var newProps = newLayer.properties;\r\n\r\n                var mapProperties = _layersTree.treeModel.getMapProperties();\r\n                newProps.mapName = mapProperties.name;\r\n                newProps.hostName = mapProperties.hostName;\r\n                newProps.visible = true;\r\n\r\n                if (!newProps.styles) {\r\n                    if (newProps.type == 'Vector')\r\n                        newProps.styles = [{ MinZoom: 1, MaxZoom: 21, RenderStyle: newProps.IsPhotoLayer ? _mapHelper.defaultPhotoIconStyles[newProps.GeometryType] : _mapHelper.defaultStyles[newProps.GeometryType] }]\r\n                    else if (newProps.type != 'Vector' && !newProps.MultiLayerID)\r\n                        newProps.styles = [{ MinZoom: newProps.MinZoom, MaxZoom: 21 }];\r\n                }\r\n\r\n                var convertedCoords = newLayer.geometry ? L.gmxUtil.convertGeometry(newLayer.geometry, true) : null;\r\n\r\n                _layersTree.addLayersToMap({ content: { properties: newProps, geometry: newLayer.geometry } });\r\n\r\n                var li = _layersTree.getChildsList({\r\n                        type: 'layer',\r\n                        content: { properties: newProps, geometry: convertedCoords }\r\n                    },\r\n                    parentProperties,\r\n                    false,\r\n                    parentDiv.getAttribute('MapID') ? true : _layersTree.getLayerVisibility($(parentDiv).find('input[type=\"checkbox\"]')[0])\r\n                );\r\n\r\n                _abstractTree.addNode(parentDiv.parentNode, li);\r\n\r\n\r\n                let divParent = $(li.parentNode.parentNode).children(\"div[MapID],div[GroupID]\")[0];\r\n\r\n                _layersTree.addTreeElem(divParent, 0, { type: 'layer', content: { properties: newProps, geometry: convertedCoords } });\r\n\r\n                _queryMapLayers.addSwappable(li);\r\n\r\n                _queryMapLayers.addDraggable(li);\r\n\r\n                _layersTree.updateListType(li);\r\n            }\r\n\r\n            _mapHelper.updateUnloadEvent(true);\r\n            _layersTree.updateZIndexes();\r\n        }).progress(function(taskInfo) {\r\n            $(taskDiv).empty();\r\n            _(taskDiv, [_span([_t(title + ':')], [\r\n                ['css', 'color', '#153069'],\r\n                ['css', 'margin', '0px 3px']\r\n            ]), _t(taskInfo.Status)])\r\n        })\r\n    }\r\n\r\n    queryMapLayers.prototype.asyncUpdateLayer = function(promise, properties, recreateLayer) {\r\n        var layerDiv = $(_queryMapLayers.buildedTree).find(\"[LayerID='\" + properties.LayerID + \"']\")[0],\r\n            _this = this;\r\n\r\n        promise\r\n            .done(function(taskInfo) {\r\n                if (recreateLayer) {\r\n                    var newLayerProperties = taskInfo.Result.properties;\r\n\r\n                    var mapProperties = _layersTree.treeModel.getMapProperties();\r\n                    newLayerProperties.mapName = mapProperties.name;\r\n                    newLayerProperties.hostName = mapProperties.hostName;\r\n                    newLayerProperties.visible = layerDiv.gmxProperties.content.properties.visible;\r\n\r\n                    newLayerProperties.styles = layerDiv.gmxProperties.content.properties.styles;\r\n\r\n                    //var convertedCoords = from_merc_geometry(taskInfo.Result.geometry);\r\n                    var origGeometry = taskInfo.Result.geometry,\r\n                        convertedGeometry = origGeometry ? L.gmxUtil.geometryToGeoJSON(origGeometry, true) : null;\r\n\r\n                    _this.removeLayer(newLayerProperties.name);\r\n\r\n                    _layersTree.addLayersToMap({ content: { properties: newLayerProperties, geometry: origGeometry } });\r\n\r\n                    var parentProperties = $(_queryMapLayers.buildedTree.firstChild).children(\"div[MapID]\")[0].gmxProperties,\r\n                        li = _layersTree.getChildsList({ type: 'layer', content: { properties: newLayerProperties, geometry: convertedGeometry } }, parentProperties, false, _layersTree.getLayerVisibility($(layerDiv).find('input[type=\"checkbox\"]')[0] || $(layerDiv).find('input[type=\"radio\"]')[0]));\r\n\r\n                    $(li).find('[multiStyle]').treeview();\r\n\r\n                    $(layerDiv.parentNode).replaceWith(li);\r\n\r\n                    _layersTree.findTreeElem($(li).children(\"div[LayerID]\")[0]).elem = { type: 'layer', content: { properties: newLayerProperties, geometry: convertedGeometry } }\r\n\r\n                    _queryMapLayers.addSwappable(li);\r\n\r\n                    _queryMapLayers.addDraggable(li);\r\n\r\n                    _layersTree.updateListType(li);\r\n                    _layersTree.updateZIndexes();\r\n\r\n                    var checkedLayer = nsGmx.gmxMap.layersByID[newLayerProperties.name];\r\n                    if (checkedLayer) {\r\n                        L.gmx.layersVersion.chkVersion(checkedLayer);\r\n                    }\r\n                } else {\r\n                    $('#' + taskInfo.TaskID).remove();\r\n\r\n                    layerDiv.style.display = '';\r\n                }\r\n            }).fail(function(taskInfo) {\r\n                $('#' + taskInfo.TaskID).remove();\r\n                layerDiv.style.display = '';\r\n            }).progress(function(taskInfo) {\r\n                var taskDiv;\r\n\r\n                if (!$('#' + taskInfo.TaskID).length) {\r\n                    taskDiv = _div(null, [\r\n                        ['attr', 'id', taskInfo.TaskID]\r\n                    ]);\r\n\r\n                    layerDiv.style.display = 'none';\r\n\r\n                    $(layerDiv).before(taskDiv);\r\n                } else {\r\n                    taskDiv = $('#' + taskInfo.TaskID)[0];\r\n\r\n                    $(taskDiv).empty();\r\n                }\r\n\r\n                _(taskDiv, [_span([_t(properties.Title + ':')], [\r\n                    ['css', 'color', '#153069'],\r\n                    ['css', 'margin', '0px 3px']\r\n                ]), _t(taskInfo.Status)]);\r\n            })\r\n    }\r\n\r\n    queryMapLayers.prototype.asyncCopyLayer = function(promise, title) {\r\n        console.log('layer copied');\r\n\r\n        var _this = this;\r\n\r\n        var taskDiv = _div(),\r\n            active = $(_this.buildedTree).find(\".active\")[0],\r\n            parentDiv;\r\n\r\n        if (active && (active.parentNode.getAttribute('MapID') || active.parentNode.getAttribute('GroupID')))\r\n            parentDiv = active.parentNode.parentNode;\r\n        else\r\n            parentDiv = _this.buildedTree.firstChild;\r\n\r\n        _abstractTree.addNode(parentDiv, _li([taskDiv, _div(null, [\r\n            ['css', 'height', '5px'],\r\n            ['css', 'fontSize', '0px']\r\n        ])]));\r\n\r\n        promise.fail(function() {\r\n            console.log('failed');\r\n            var parentTree = taskDiv.parentNode.parentNode;\r\n            taskDiv.parentNode.removeNode(true);\r\n            _abstractTree.delNode(null, parentTree, parentTree.parentNode);\r\n        }).done(function(taskInfo) {\r\n            console.log('ok');\r\n            if (!$.isArray(taskInfo.Result)) {\r\n                taskInfo.Result = [taskInfo.Result];\r\n            }\r\n\r\n            var parentDiv = $(taskDiv.parentNode.parentNode.parentNode).children(\"div[GroupID],div[MapID]\")[0],\r\n                parentProperties = parentDiv.gmxProperties;\r\n\r\n            var parentTree = taskDiv.parentNode.parentNode;\r\n            taskDiv.parentNode.removeNode(true);\r\n            _abstractTree.delNode(null, parentTree, parentTree.parentNode);\r\n\r\n            for (var l = 0; l < taskInfo.Result.length; l++) {\r\n                var newLayer = taskInfo.Result[l];\r\n                var newProps = newLayer.properties;\r\n\r\n                var mapProperties = _layersTree.treeModel.getMapProperties();\r\n                newProps.mapName = mapProperties.name;\r\n                newProps.hostName = mapProperties.hostName;\r\n                newProps.visible = true;\r\n\r\n                if (!newProps.styles) {\r\n                    if (newProps.type == 'Vector')\r\n                        newProps.styles = [{ MinZoom: 1, MaxZoom: 21, RenderStyle: newProps.IsPhotoLayer ? _mapHelper.defaultPhotoIconStyles[newProps.GeometryType] : _mapHelper.defaultStyles[newProps.GeometryType] }]\r\n                    else if (newProps.type != 'Vector' && !newProps.MultiLayerID)\r\n                        newProps.styles = [{ MinZoom: newProps.MinZoom, MaxZoom: 21 }];\r\n                }\r\n\r\n                var convertedCoords = newLayer.geometry ? L.gmxUtil.convertGeometry(newLayer.geometry, true) : null;\r\n\r\n                _layersTree.addLayersToMap({ content: { properties: newProps, geometry: newLayer.geometry } });\r\n\r\n                var li = _layersTree.getChildsList({\r\n                        type: 'layer',\r\n                        content: { properties: newProps, geometry: convertedCoords }\r\n                    },\r\n                    parentProperties,\r\n                    false,\r\n                    parentDiv.getAttribute('MapID') ? true : _layersTree.getLayerVisibility($(parentDiv).find('input[type=\"checkbox\"]')[0])\r\n                );\r\n\r\n                _abstractTree.addNode(parentDiv.parentNode, li);\r\n\r\n                let divParent = $(li.parentNode.parentNode).children(\"div[MapID],div[GroupID]\")[0];\r\n\r\n                _layersTree.addTreeElem(divParent, 0, { type: 'layer', content: { properties: newProps, geometry: convertedCoords } });\r\n\r\n                _queryMapLayers.addSwappable(li);\r\n\r\n                _queryMapLayers.addDraggable(li);\r\n\r\n                _layersTree.updateListType(li);\r\n            }\r\n\r\n            _mapHelper.updateUnloadEvent(true);\r\n            _layersTree.updateZIndexes();\r\n        }).progress(function(taskInfo) {\r\n            console.log('progress');\r\n            $(taskDiv).empty();\r\n            _(taskDiv, [_span([_t(title + ':')], [\r\n                ['css', 'color', '#153069'],\r\n                ['css', 'margin', '0px 3px']\r\n            ]), _t(taskInfo.Status)])\r\n        }).always(function(taskInfo) {\r\n            console.log(taskInfo);\r\n        })\r\n    }\r\n\r\n    queryMapLayers.prototype.removeLayer = function(name) {\r\n        var layer = nsGmx.gmxMap.layersByID[name];\r\n        if (layer) {\r\n            nsGmx.leafletMap.removeLayer(layer);\r\n            nsGmx.gmxMap.removeLayer(layer);\r\n        }\r\n    }\r\n\r\n    queryMapLayers.prototype.getLayers = function() {\r\n        this.createLayersManager();\r\n    }\r\n\r\n    queryMapLayers.prototype.createLayersManager = function() {\r\n        var canvas = _div();\r\n        var layerManagerControl = new nsGmx.LayerManagerControl(canvas, 'layers');\r\n\r\n        var existLayers = [];\r\n        for (var i = 0; i < nsGmx.gmxMap.layers.length; i++)\r\n            existLayers.push(nsGmx.gmxMap.layers[i].getGmxProperties().name);\r\n\r\n        layerManagerControl.disableLayers(existLayers);\r\n\r\n        showDialog(_gtxt(\"Список слоев\"), canvas, 571, 485, 535, 130, function(size) {\r\n            layerManagerControl.resize(size.height - 55);\r\n        });\r\n    }\r\n\r\n    queryMapLayers.prototype.getMaps = function() {\r\n        if (!$('#mapsList').length)\r\n            new nsGmx.MapsManagerControl();\r\n    }\r\n\r\n    queryMapLayers.prototype.createMapDialog = function(title, buttonName, func, addLink) {\r\n        var uiTemplate = Handlebars.compile(\r\n            '<div class = \"createMap-container\">' +\r\n            '<input class = \"inputStyle inputFullWidth createMap-input\">' +\r\n            '<button class = \"createMap-button\">{{buttonName}}</button>' +\r\n            '</div>');\r\n\r\n        var ui = $(uiTemplate({ buttonName: buttonName })),\r\n            input = $('.createMap-input', ui)[0];\r\n\r\n        var tryCreateMap = function() {\r\n            input.focus();\r\n            if (input.value != '') {\r\n                removeDialog(dialogDiv);\r\n                func(input.value);\r\n            } else {\r\n                inputError(input);\r\n            }\r\n        }\r\n\r\n        $(input, ui).on('keydown', function(e) {\r\n            if (e.keyCode === 13) {\r\n                tryCreateMap();\r\n                return false;\r\n            }\r\n        })\r\n\r\n        $('.createMap-button', ui).click(tryCreateMap)\r\n\r\n        addLink && ui.append(addLink);\r\n\r\n        var dialogDiv = showDialog(title, ui[0], 280, 115 + (addLink ? 20 : 0), false, false);\r\n    }\r\n\r\n    queryMapLayers.prototype.createMap = function(name) {\r\n        sendCrossDomainJSONRequest(window.serverBase + 'Map/Insert.ashx?WrapStyle=func&Title=' + encodeURIComponent(name), function(response) {\r\n            if (!parseResponse(response))\r\n                return;\r\n\r\n            window.location.replace(window.location.href.split(/\\?|#/)[0] + \"?\" + response.Result);\r\n        })\r\n    };\r\n\r\n    (function() {\r\n\r\n        var saveMapInternal = function(scriptName, mapTitle, callback) {\r\n            var mapID = String($(_queryMapLayers.buildedTree).find(\"[MapID]\")[0].gmxProperties.properties.MapID),\r\n                saveTree = {};\r\n\r\n            window._mapEditorsHash && window._mapEditorsHash[mapID] && window._mapEditorsHash[mapID].update();\r\n\r\n            //обновим стили слоёв из всех незакрытых диалогов редактирования стилей\r\n            var mStyleEditor = window.gmxCore.getModule('LayerStylesEditor');\r\n            mStyleEditor && mStyleEditor.updateAllStyles();\r\n\r\n            nsGmx.userObjectsManager.collect();\r\n            $(_queryMapLayers.buildedTree).find(\"[MapID]\")[0].gmxProperties.properties.UserData = JSON.stringify(nsGmx.userObjectsManager.getData());\r\n\r\n            $.extend(true, saveTree, _layersTree.treeModel.getRawTree());\r\n\r\n            var attributesToSave = ['visible', 'styles', 'AllowSearch', 'TiledQuicklook', 'TiledQuicklookMinZoom', 'name', 'MapStructureID'];\r\n\r\n            saveTree.properties.BaseLayers = JSON.stringify(nsGmx.leafletMap.gmxBaseLayersManager.getActiveIDs());\r\n\r\n            //раскрываем все группы так, как записано в свойствах групп\r\n            _mapHelper.findTreeElems(saveTree, function(child) {\r\n                let props = child.content.properties;\r\n                if (child.type === \"group\") {\r\n                    props.expanded = typeof props.initExpand !== 'undefined' ? props.initExpand : false;\r\n                    delete props.initVisible;\r\n                    delete props.initExpand;\r\n                } else {\r\n                    let propsToSave = {};\r\n                    for (let i = 0; i < attributesToSave.length; i++) {\r\n                        let attrName = attributesToSave[i];\r\n                        if (attrName in props) {\r\n                            propsToSave[attrName] = props[attrName];\r\n                        }\r\n                    }\r\n\r\n                    let styles = props.styles || [];\r\n\r\n                    for (let s = 0; s < styles.length; s++) {\r\n                        delete styles[s].HoverStyle;\r\n                    }\r\n\r\n                    if (window.newStyles) {\r\n                        let keys = L.gmx.StyleManager.DEFAULT_STYLE_KEYS,\r\n                            stylesHash = {};\r\n\r\n                        for (let i = 0; i < keys.length; i++) {\r\n                            stylesHash[keys[i]] = true;\r\n                        }\r\n                        propsToSave.gmxStyles = props.gmxStyles;\r\n\r\n                        for (let s = 0; s < propsToSave.gmxStyles.styles.length; s++) {\r\n                            let st = propsToSave.gmxStyles.styles[s];\r\n                            delete st.HoverStyle;\r\n                            for (let key in st.RenderStyle) {\r\n                                if (!(key in stylesHash)) {\r\n                                    delete st.RenderStyle[key];\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    child.content.properties = propsToSave;\r\n                    delete child.content.geometry;\r\n                }\r\n            }, true);\r\n\r\n            let params = {\r\n                WrapStyle: 'window',\r\n                MapID: mapID,\r\n\r\n                MapJson: JSON.stringify(saveTree)\r\n            }\r\n\r\n            if (mapTitle)\r\n                params.Title = mapTitle;\r\n\r\n            sendCrossDomainPostRequest(window.serverBase + scriptName, params,\r\n                function(response) {\r\n                    if (!parseResponse(response))\r\n                        return;\r\n\r\n                    callback && callback(response.Result);\r\n\r\n                    _mapHelper.updateUnloadEvent(false);\r\n\r\n                    nsGmx.widgets.notifications.stopAction('saveMap', 'success', _gtxt(\"Сохранено\"));\r\n                }\r\n            )\r\n        }\r\n\r\n        queryMapLayers.prototype.saveMap = function() {\r\n            nsGmx.widgets.notifications.startAction('saveMap');\r\n            saveMapInternal(\"Map/SaveMap.ashx\", null);\r\n        }\r\n\r\n        queryMapLayers.prototype.saveMapAs = function(name) {\r\n            nsGmx.widgets.notifications.startAction('saveMap');\r\n            saveMapInternal(\"Map/SaveAs.ashx\", name);\r\n        }\r\n\r\n    })();\r\n\r\n    let _queryMapLayers = new queryMapLayers();\r\n    window._queryMapLayers = _queryMapLayers;\r\n\r\n    mapLayers.mapLayers.load = function() {\r\n        let alreadyLoaded = _queryMapLayers.createWorkCanvas('layers', {\r\n            path: null,\r\n            showCloseButton: false,\r\n            showMinimizeButton: false\r\n        });\r\n\r\n        if (!alreadyLoaded)\r\n            _queryMapLayers.load()\r\n    }\r\n    mapLayers.mapLayers.unload = function() {}\r\n\r\n})(nsGmx.Utils._);\r\n","import nsGmx from '../nsGmx.js';\r\nimport '../translations.js';\r\nimport './authWidget.css';\r\n\r\nnsGmx.Templates = nsGmx.Templates || {};\r\nnsGmx.Templates.AuthWidget = {};\r\nnsGmx.Templates.AuthWidget[\"authWidget\"] = \"{{#if userName}}\\n\" +\r\n    \"    <div class=\\\"authWidget_authorized\\\">\\n\" +\r\n    \"        <div class=\\\"authWidget-userPanel\\\">\\n\" +\r\n    \"            <div class=\\\"authWidget-userPanel-iconCell\\\">\\n\" +\r\n    \"                <div class=\\\"authWidget-userPanel-userIcon\\\"></div>\\n\" +\r\n    \"            </div>\\n\" +\r\n    \"            <div class=\\\"authWidget-userPanel-userMenuCell\\\"></div>\\n\" +\r\n    \"        </div>\\n\" +\r\n    \"    </div>\\n\" +\r\n    \"{{else}}\\n\" +\r\n    \"\\n\" +\r\n    \"    <div class=\\\"authWidget_unauthorized\\\">\\n\" +\r\n    \"        <div class=\\\"authWidget-userPanel\\\">\\n\" +\r\n    \"            <div class=\\\"authWidget-userPanel-iconCell\\\">\\n\" +\r\n    \"                <div class=\\\"authWidget-userPanel-userIcon\\\"></div>\\n\" +\r\n    \"            </div>\\n\" +\r\n    \"            <div class=\\\"authWidget-loginButton\\\">\\n\" +\r\n    \"                {{i 'auth.login'}}\\n\" +\r\n    \"            </div>\\n\" +\r\n    \"        </div>\\n\" +\r\n    \"    </div>\\n\" +\r\n    \"{{/if}}\\n\" +\r\n    \"\";\r\n\r\nnsGmx.AuthWidget = (function() {\r\n\r\n    // options.loginDialog\r\n    var AuthWidget = function(options) {\r\n        this._view = $('<div>');\r\n        this._view.addClass('authWidget ui-widget');\r\n        this._authManager = options.authManager;\r\n        this._userInfo = null;\r\n\r\n        this._options = $.extend({\r\n            showAccountLink: true,\r\n            accountLink: 'http://my.kosmosnimki.ru/Home/Settings/',\r\n            showMapLink: true,\r\n            changePassword: false\r\n                /* mapLink */\r\n        }, options);\r\n\r\n        this._authManager.getUserInfo().then(function(response) {\r\n            this._render({\r\n                login: response.Result && response.Result.Login,\r\n                userName: response.Result && (response.Result.FullName || response.Result.Nickname || response.Result.Login)\r\n            });\r\n            this._userInfo = response.Result;\r\n            $(this).trigger('ready');\r\n        }.bind(this)).fail(function(response) {\r\n            this._render(response);\r\n        }.bind(this));\r\n    };\r\n\r\n    AuthWidget.prototype._render = function(vm) {        \r\n\r\n        this._view.html(Handlebars.compile(nsGmx.Templates.AuthWidget.authWidget)(vm));\r\n\r\n        if (vm.userName) {\r\n            var dropdownItems = [];\r\n\r\n            if (this._options.showAccountLink) {\r\n                dropdownItems.push({\r\n                    title: nsGmx.Translations.getText('auth.myAccount'),\r\n                    link: this._options.accountLink,\r\n                    id: 'AuthWidgetAccountLink',\r\n                    newWindow: true\r\n                });\r\n            }\r\n\r\n            if (this._options.showMapLink) {\r\n                var defaultMapLink = 'http://maps.kosmosnimki.ru/api/index.html?' + encodeURIComponent('@' + vm.login);\r\n                dropdownItems.push({\r\n                    title: nsGmx.Translations.getText('auth.myMap'),\r\n                    link: this._options.mapLink || defaultMapLink,\r\n                    id: 'AuthWidgetMapLink',\r\n                    newWindow: true\r\n                });\r\n            }\r\n\r\n            if (this._options.changePassword) {\r\n                dropdownItems.push({\r\n                    title: nsGmx.Translations.getText('auth.changePassword'),\r\n                    className: 'authWidget-changePasswordButton'\r\n                });\r\n            }\r\n\r\n            if (this._options.isAdmin) {\r\n                dropdownItems.push({\r\n                    title: nsGmx.Translations.getText('Системные настройки'),\r\n                    link: window.serverBase + 'Administration/Actions.aspx',\r\n                    id: 'AuthWidgetAdminLink',\r\n                    newWindow: true\r\n                });\r\n\r\n                dropdownItems.push({\r\n                    title: nsGmx.Translations.getText('Управление группами'),\r\n                    link: 'javascript:void(0)',\r\n                    className: 'authWidget-usergroupMenuItem'\r\n                });\r\n            }\r\n\r\n            dropdownItems.push({\r\n                title: nsGmx.Translations.getText('auth.logout'),\r\n                className: 'authWidget-logoutButton'\r\n            })\r\n\r\n            var dropdownMenuWidget = new nsGmx.DropdownMenuWidget({\r\n                items: [{\r\n                    title: vm.userName,\r\n                    dropdown: dropdownItems\r\n                }]\r\n            });\r\n\r\n            dropdownMenuWidget.appendTo(this._view.find('.authWidget-userPanel-userMenuCell'));\r\n        }\r\n\r\n        this._view.find('.authWidget-usergroupMenuItem').click(function() {\r\n            if (this._options.callbacks && 'authWidget-usergroupMenuItem' in this._options.callbacks) {\r\n                this._options.callbacks['authWidget-usergroupMenuItem']();\r\n            } else {\r\n                return false;\r\n            }\r\n        }.bind(this));\r\n\r\n        this._view.find('.authWidget-changePasswordButton').click(function() {\r\n            var native = this._authManager.getNative();\r\n            native.changePasswordDialog();\r\n        }.bind(this));\r\n\r\n        this._view.find('.authWidget-loginButton').click(function() {\r\n            var $iframeContainer;\r\n            if (this._options.loginDialog) {\r\n                $iframeContainer = $('<div>').addClass('authWidget-iframeContainer');\r\n                var dialog = $iframeContainer.dialog({\r\n                    width: 500,\r\n                    height: 450,\r\n                    closeText: nsGmx.Translations.getText('auth.closeDialog'),\r\n                    close: function() {\r\n                        $(this).dialog('destroy');\r\n                    }\r\n                });\r\n                // HACK:\r\n                $(dialog).parent().find('button.ui-button').addClass('ui-icon').css('outline', 'none')\r\n            }\r\n\r\n            this._authManager.login({\r\n                iframeContainer: $iframeContainer && $iframeContainer[0]\r\n            });\r\n        }.bind(this));\r\n\r\n        this._view.find('.authWidget-logoutButton').click(function() {\r\n            this._authManager.logout().then(function(response) {\r\n                this._render(response);\r\n                this._userInfo = response.Result;\r\n                $(this).trigger('logout');\r\n            }.bind(this));\r\n        }.bind(this));\r\n    };\r\n\r\n    /** Получить информацию о пользователе, которую вернул AuthManager\r\n     * @return {Object}\r\n     */\r\n    AuthWidget.prototype.getUserInfo = function() {\r\n        return this._userInfo;\r\n    };\r\n\r\n    AuthWidget.prototype.on = function(eventName, callback) {\r\n        $(this).on(eventName, callback);\r\n    };\r\n\r\n    AuthWidget.prototype.appendTo = function(placeholder) {\r\n        placeholder.append(this._view);\r\n    };\r\n\r\n    return AuthWidget;\r\n})();\r\n\r\nnsGmx.Translations.addText('rus', {\r\n\tauth: {\r\n\t\t'login': 'Войти',\r\n\t\t'logout': 'Выйти',\r\n\t\t'myAccount': 'Личный кабинет',\r\n        'changePassword': 'Сменить пароль',\r\n\t\t'myMap': 'Личная карта',\r\n\t\t'closeDialog': 'Закрыть'\r\n\t}\r\n});\r\n\r\nnsGmx.Translations.addText('eng', {\r\n\tauth: {\r\n\t\t'login': 'Login',\r\n\t\t'logout': 'Logout',\r\n\t\t'myAccount': 'My account',\r\n        'changePassword': 'Change password',\r\n\t\t'myMap': 'My map',\r\n\t\t'closeDialog': 'Close'\r\n\t}\r\n});","/** Виджет для визуализации информации о текущем статусе пользователя.\r\n* Показывает кнопки Вход/Выход, имя пользователя. Позволяет отослать логин/пароль на сервер, сменить пароль.\r\n @memberOf nsGmx\r\n @class\r\n @name GeoMixerAuthWidget\r\n*/\r\nimport nsGmx from './nsGmx.js';\r\nimport {\r\n    _br,\r\n    _div,\r\n    _input,\r\n    inputError,\r\n    makeButton,\r\n    makeLinkButton,\r\n    showDialog,\r\n    showErrorMessage,\r\n    _span,\r\n    _t,\r\n    _table,\r\n    _td,\r\n    _tr,\r\n    _title,    \r\n} from './utilities.js';\r\n\r\n(function($, _)\r\n{\r\n    var _dialogCanvas = null;\r\n\r\n    function changePasswordDialog()\r\n    {\r\n        if ($('#changePasswordCanvas').length)\r\n            return;\r\n\r\n        var oldInput = _input(null, [['dir','className','inputStyle'],['css','width','160px'],['attr','type','password']]),\r\n            newInput = _input(null, [['dir','className','inputStyle'],['css','width','160px'],['attr','type','password']]),\r\n            confirmInput = _input(null, [['dir','className','inputStyle'],['css','width','160px'],['attr','type','password']]),\r\n            changeButton = makeButton(_gtxt(\"Изменить\")),\r\n            canvas = _div([_div([_span([_t(_gtxt(\"Старый пароль\"))]), _br(), oldInput, _br(),\r\n                                _span([_t(_gtxt(\"Новый пароль\"))]), _br(), newInput, _br(),\r\n                                _span([_t(_gtxt(\"Подтвердите пароль\"))]), _br(), confirmInput, _br()],[['css','textAlign','center']]),\r\n                           _div([changeButton],[['css','textAlign','center'],['css','margin','5px']])],[['attr','id','changePasswordCanvas']]),\r\n            checkPassw = function()\r\n            {\r\n                if (newInput.value != confirmInput.value)\r\n                {\r\n                    newInput.value = '';\r\n                    confirmInput.value = '';\r\n\r\n                    inputError([newInput, confirmInput], 2000);\r\n                    newInput.focus();\r\n\r\n                    return;\r\n                }\r\n\r\n                nsGmx.widgets.notifications.startAction('changePassword');\r\n                nsGmx.AuthManager.changePassword(oldInput.value, newInput.value, function()\r\n                {\r\n                    jQuery(canvas.parentNode).dialog(\"destroy\");\r\n                    canvas.parentNode.removeNode(true);\r\n\r\n                    nsGmx.widgets.notifications.stopAction('changePassword', 'success', _gtxt('Пароль изменён'));\r\n                }, function( message )\r\n                {\r\n                    message && showErrorMessage(message, true);\r\n                    nsGmx.widgets.notifications.stopAction('changePassword', 'failure');\r\n                })\r\n\r\n                oldInput.value = '';\r\n                newInput.value = '';\r\n                confirmInput.value = '';\r\n            };\r\n\r\n        showDialog(_gtxt(\"Изменение пароля\"), canvas, 200, 200, false, false);\r\n        canvas.parentNode.style.overflow = 'hidden';\r\n\r\n        oldInput.focus();\r\n\r\n        changeButton.onclick = function()\r\n        {\r\n            checkPassw();\r\n        }\r\n\r\n        $(confirmInput).on('keyup', function(e)\r\n        {\r\n            if (e.keyCode === 13)\r\n            {\r\n                checkPassw();\r\n\r\n                return false;\r\n            }\r\n\r\n            return true;\r\n        });\r\n    }\r\n\r\n    var loginDialogTemplate =\r\n        '<div>' +\r\n            '<div class = \"loginMainDiv\">' +\r\n                '<form>' +\r\n                    '<div>' +\r\n                        '<span class=\"loginLabel\">{{i \"Логин\"}}</span><br>' +\r\n                        '<input name=\"login\" class = \"inputStyle inputLogin\" placeholder = \"{{i \"адрес электронной почты\"}}\"><br>' +\r\n                    '</div>' +\r\n                    '<div>' +\r\n                        '<span class=\"loginLabel\">{{i \"Пароль\"}}</span><br>' +\r\n                        '<input name=\"password\" class = \"inputStyle inputPass\" type = \"password\" placeholder = \"{{i \"пароль\"}}\"><br>' +\r\n                    '</div>' +\r\n                    '<button class=\"loginButton\">{{i \"Вход\"}}</button>' +\r\n                '</form>' +\r\n            '</div>' +\r\n            '{{#isMapsSite}}' +\r\n            '<div class=\"loginLinks\">' +\r\n                '<span class = \"buttonLink registration\">{{i \"Регистрация\"}}</span><br>' +\r\n                '<span class = \"buttonLink passRecovery\">{{i \"Восстановление пароля\"}}</span>' +\r\n            '</div>' +\r\n            '{{/isMapsSite}}' +\r\n        '</div>';\r\n\r\n    nsGmx.GeoMixerAuthWidget = function( container, authManager, loginCallback, options )\r\n    {\r\n        var _container = container;\r\n        var _authManager = authManager;\r\n        var _this = this;\r\n\r\n        _this.changePasswordDialog = changePasswordDialog;\r\n\r\n        options = options || {};\r\n\r\n        var _createLogin = function()\r\n        {\r\n            var span = makeLinkButton(_gtxt('Вход'));\r\n\r\n            span.onclick = function()\r\n            {\r\n                _this.showLoginDialog( loginCallback );\r\n            }\r\n            _(_container, [_div([span], [['attr','id','log'],['dir','className','log']])]);\r\n        }\r\n\r\n        var _createLogout = function()\r\n        {\r\n            var logoutSpan = makeLinkButton(_gtxt('Выход'));\r\n\r\n            logoutSpan.onclick = function()\r\n            {\r\n                _authManager.logout(function()\r\n                {\r\n                    if (nsGmx.GeomixerFramework)\r\n                        _mapHelper.reloadMap();\r\n                    else\r\n                        window.location.replace(window.location.href.split(\"?\")[0] + (window.defaultMapID == window.globalMapName ? \"\" : (\"&\" + window.globalMapName)));\r\n                });\r\n            }\r\n\r\n            var userText = _authManager.getLogin();\r\n            if (_authManager.getFullname() !== null && _authManager.getFullname() !== '')\r\n                userText += ' (' + _authManager.getFullname() + ')';\r\n            var userSpan = _span([_t(userText)], [['css','cursor','pointer']]);\r\n\r\n            userSpan.onclick = function()\r\n            {\r\n                if ( _authManager.isAccounts() )\r\n                {\r\n                    if (window.gmxAuthServer)\r\n                        window.open(  window.gmxAuthServer + \"Account/ChangePassword\", '_blank');\r\n                }\r\n                else\r\n                    changePasswordDialog();\r\n            }\r\n\r\n            if ( _authManager.isAccounts() )\r\n                $(userSpan).css('color', '#5555FF');\r\n\r\n            _title(userSpan, _gtxt(\"Изменение пароля\"))\r\n\r\n            _(_container, [_table([_tr([\r\n                _td([_div([userSpan], [['attr','id','user'],['dir','className','user']])]),\r\n                _td([_div([logoutSpan], [['attr','id','log'],['dir','className','log']])])\r\n            ])])]);\r\n        }\r\n\r\n        var _update = function()\r\n        {\r\n            if ( window.gmxViewerUI && window.gmxViewerUI.hideLogin )\r\n                return;\r\n\r\n            $(_container).empty();\r\n\r\n            if (_authManager.isLogin())\r\n            {\r\n                _createLogout();\r\n            }\r\n            else\r\n            {\r\n                _createLogin();\r\n            }\r\n        }\r\n\r\n        $(_authManager).change(_update);\r\n        _update();\r\n\r\n        //Показывает диалог с вводом логина/пароля, посылает запрос на сервер.\r\n        this.showLoginDialog = function()\r\n        {\r\n            if (_dialogCanvas) {\r\n                return;\r\n            }\r\n\r\n            var isMapsSite = !!window.mapsSite;\r\n            var dialogHeight = isMapsSite ? 210 : 175;\r\n\r\n            var canvas = $(Handlebars.compile(loginDialogTemplate)({isMapsSite: isMapsSite})),\r\n                loginInput = canvas.find('.inputLogin')[0],\r\n                passwordInput = canvas.find('.inputPass')[0],\r\n                loginButton = canvas.find('.loginButton')[0];\r\n\r\n            var checkLogin = function(){\r\n                _authManager.login(loginInput.value, passwordInput.value, function()\r\n                    { //всё хорошо\r\n                        $(jQueryDialog).dialog(\"destroy\")\r\n                        jQueryDialog.removeNode(true);\r\n                        _dialogCanvas = null;\r\n                        loginCallback && loginCallback();\r\n                    }, function(err)\r\n                    { //ошибка\r\n                        if (err.emailWarning)\r\n                        {\r\n                            var errorDiv = $(\"<div/>\", {'class': 'EmailErrorMessage'}).text(err.message);\r\n                            $(loginButton).after(errorDiv);\r\n                            setTimeout(function(){\r\n                                errorDiv.hide(500, function(){ errorDiv.remove(); });\r\n                            }, 8000)\r\n                        }\r\n                        loginInput.value = '';\r\n                        passwordInput.value = '';\r\n                        inputError([loginInput, passwordInput], 2000);\r\n                        loginInput.focus();\r\n                    }\r\n                );\r\n            };\r\n\r\n            _dialogCanvas = canvas;\r\n\r\n            var jQueryDialog = showDialog(_gtxt(\"Пожалуйста, авторизуйтесь\"), canvas[0], 248, dialogHeight, false, false, null, function()\r\n            {\r\n                _dialogCanvas = null;\r\n            });\r\n\r\n            loginInput.focus();\r\n\r\n            loginButton.onclick = checkLogin;\r\n\r\n            canvas.find('form').submit(function(e) {\r\n                e.preventDefault();\r\n            })\r\n\r\n            canvas.find('.registration').click(options.registrationCallback || function(){\r\n                window.open(window.gmxAuthServer + 'Account/Registration', '_blank');\r\n            });\r\n\r\n            canvas.find('.passRecovery').click(function(){\r\n                window.open(window.gmxAuthServer + 'Account/Retrive', '_blank');\r\n            });\r\n\r\n            $(passwordInput).on('keyup', function(e)\r\n            {\r\n                if (e.keyCode === 13)\r\n                {\r\n                    checkLogin();\r\n\r\n                    return false;\r\n                }\r\n\r\n                return true;\r\n            });\r\n        }\r\n\r\n        this.getContainer = function()\r\n        {\r\n            return _container;\r\n        }\r\n    }\r\n\r\n    // Обратная совместимость. Проверка нужна из-за возможного конфликта с одноимённым классом из общих компонент\r\n    if (!nsGmx.AuthWidget) {\r\n        nsGmx.AuthWidget = nsGmx.GeoMixerAuthWidget;\r\n    }\r\n\r\n})(jQuery, nsGmx.Utils._);\r\n","'use strict';\r\n\r\nvar classCallCheck = function (instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError(\"Cannot call a class as a function\");\r\n  }\r\n};\r\n\r\nvar createClass = function () {\r\n  function defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n      var descriptor = props[i];\r\n      descriptor.enumerable = descriptor.enumerable || false;\r\n      descriptor.configurable = true;\r\n      if (\"value\" in descriptor) descriptor.writable = true;\r\n      Object.defineProperty(target, descriptor.key, descriptor);\r\n    }\r\n  }\r\n\r\n  return function (Constructor, protoProps, staticProps) {\r\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\r\n    if (staticProps) defineProperties(Constructor, staticProps);\r\n    return Constructor;\r\n  };\r\n}();\r\n\r\nvar EventTarget = function () {\r\n    function EventTarget() {\r\n        classCallCheck(this, EventTarget);\r\n\r\n        this.listeners = {};\r\n    }\r\n\r\n    createClass(EventTarget, [{\r\n        key: 'addEventListener',\r\n        value: function addEventListener(type, callback) {\r\n            if (!(type in this.listeners)) {\r\n                this.listeners[type] = [];\r\n            }\r\n            this.listeners[type].push(callback);\r\n        }\r\n    }, {\r\n        key: 'on',\r\n        value: function on(type, callback) {\r\n            this.addEventListener(type, callback);\r\n            return this;\r\n        }\r\n    }, {\r\n        key: 'removeEventListener',\r\n        value: function removeEventListener(type, callback) {\r\n            if (!(type in this.listeners)) {\r\n                return;\r\n            }\r\n            var stack = this.listeners[type];\r\n            for (var i = 0, l = stack.length; i < l; i++) {\r\n                if (stack[i] === callback) {\r\n                    stack.splice(i, 1);\r\n                    return this.removeEventListener(type, callback);\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: 'off',\r\n        value: function off(type, callback) {\r\n            this.removeEventListener(type, callback);\r\n            return this;\r\n        }\r\n    }, {\r\n        key: 'dispatchEvent',\r\n        value: function dispatchEvent(event) {\r\n            if (!(event.type in this.listeners)) {\r\n                return;\r\n            }\r\n            var stack = this.listeners[event.type];\r\n            Object.defineProperty(event, 'target', {\r\n                enumerable: false,\r\n                configurable: false,\r\n                writable: false,\r\n                value: this\r\n            });\r\n            for (var i = 0, l = stack.length; i < l; i++) {\r\n                stack[i].call(this, event);\r\n            }\r\n        }\r\n    }]);\r\n    return EventTarget;\r\n}();\r\n\r\nmodule.exports = EventTarget;\r\n","'use strict';\r\n\r\nObject.defineProperty(exports, '__esModule', { value: true });\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\r\n  return typeof obj;\r\n} : function (obj) {\r\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\r\n};\r\n\r\nvar copy = function copy(source) {\r\n    switch (typeof source === 'undefined' ? 'undefined' : _typeof(source)) {\r\n        case 'number':\r\n        case 'string':\r\n        case 'function':\r\n        default:\r\n            return source;\r\n        case 'object':\r\n            if (source === null) {\r\n                return null;\r\n            } else if (Array.isArray(source)) {\r\n                return source.map(function (item) {\r\n                    return copy(item);\r\n                });\r\n            } else if (source instanceof Date) {\r\n                return source;\r\n            } else {\r\n                return Object.keys(source).reduce(function (a, k) {\r\n                    a[k] = copy(source[k]);\r\n                    return a;\r\n                }, {});\r\n            }\r\n    }\r\n};\r\n\r\nvar extend = function extend(target, source) {\r\n    if (target === source) {\r\n        return target;\r\n    } else {\r\n        return Object.keys(source).reduce(function (a, k) {\r\n            var value = source[k];\r\n            if (_typeof(a[k]) === 'object' && k in a) {\r\n                a[k] = extend(a[k], value);\r\n            } else {\r\n                a[k] = copy(value);\r\n            }\r\n            return a;\r\n        }, copy(target));\r\n    }\r\n};\r\n\r\nexports.copy = copy;\r\nexports.extend = extend;\r\n//# sourceMappingURL=scanex-object-extensions.cjs.js.map\r\n","import EventTarget from 'scanex-event-target';\r\nimport { extend } from 'scanex-object-extensions';\r\n\r\nimport './IconSidebarWidget.css';\r\n\r\nclass IconSidebarWidget extends EventTarget {\r\n    constructor(container, options) {\r\n        super();\r\n        this._options = options;\r\n        this._options.position = this._options.position || 'left';\r\n        this._collapsedWidth = this._options.collapsedWidth || 40;\r\n        this._extendedWidth = this._options.extendedWidth || 400;\r\n\r\n        this._container = container;\r\n        this._container.classList.add('iconSidebarControl');\r\n        this._container.innerHTML = `<ul class=\"iconSidebarControl-tabs\"></ul><div class=\"iconSidebarControl-content\"></div>`;\r\n        this._container.classList.add (this._options.position.indexOf ('left') !== -1 ? 'iconSidebarControl-left' : 'iconSidebarControl-right');\r\n        this._tabsContainer = this._container.querySelector ('.iconSidebarControl-tabs');\r\n        this._panesContainer = this._container.querySelector ('.iconSidebarControl-content');\r\n\r\n        this._onTabClick = this._onTabClick.bind(this);\r\n\r\n        this._panes = {};\r\n    }\r\n\r\n    setPane (id, paneOptions) {\r\n        paneOptions = paneOptions || {};        \r\n        let defaultPaneOptions = { position: 0, enabled: true };\r\n        let activeTabId = this._activeTabId;\r\n\r\n        this._panes[id] = extend(extend (extend({}, defaultPaneOptions), this._panes[id] || {}), paneOptions);\r\n        if (!this._panes[id].enabled && this._activeTabId === id) {\r\n            this.close();\r\n        }\r\n        \r\n        this._renderTabs({ activeTabId });\r\n        return this._ensurePane(id);\r\n    }\r\n    enable  (id, enabled) {\r\n        let pane = this._panes[id];\r\n        if (pane) {\r\n            pane.enabled = enabled;\r\n        }\r\n    }\r\n    enabled (id) {\r\n        let pane = this._panes[id];\r\n        if (pane) {\r\n            return pane.enabled;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    open (paneId) {\r\n        if (this._isAnimating) {\r\n            return;\r\n        }\r\n\r\n        const pane = this._panes[paneId];\r\n        if (!pane || !pane.enabled) {\r\n            return;\r\n        }\r\n\r\n        this._activeTabId = paneId;\r\n\r\n        this._setTabActive(paneId, true);\r\n        this._setActiveClass(paneId);\r\n\r\n        if (this._isOpened) {\r\n\r\n\t\t\tlet event = document.createEvent('Event');\r\n\t\t\tevent.initEvent('opened', false, false);\r\n\t\t\tevent.detail =  {id: this._activeTabId};\r\n\t\t\tthis.dispatchEvent(event);\r\n\r\n            return;\r\n        }\r\n\r\n        this._isAnimating = true;\r\n\t\tthis._container.classList.add('iconSidebarControl_opened');\r\n\t\tthis._container.classList.add('iconSidebarControl_expanded');\r\n\r\n        this._isOpened = true;\r\n\r\n\t\tlet event = document.createEvent('Event');\r\n\t\tevent.initEvent('opening', false, false);\r\n\t\tthis.dispatchEvent(event);\r\n\r\n        setTimeout(() => {\r\n\r\n\t\t\tlet ev = document.createEvent('Event');\r\n\t\t\tev.initEvent('opened', false, false);\r\n\t\t\tev.detail =  {id: this._activeTabId};\r\n\t\t\tthis.dispatchEvent(ev);\r\n            this._isAnimating = false;\r\n\r\n        }, 250);\r\n    }\r\n\r\n    _setTabActive (paneId, flag) {\r\n        let tabs = this._tabsContainer.querySelectorAll('.iconSidebarControl-tab');\r\n        for (let i = 0; i < tabs.length; ++i) {\r\n            let id = tabs[i].getAttribute('data-tab-id');\r\n            let tab = tabs[i].querySelector('.tab-icon');\r\n            if (id === paneId) {\r\n                if (flag) {\r\n\t\t\t\t\ttab.classList.add ('tab-icon-active');\r\n\r\n                }\r\n                else {\r\n\t\t\t\t\ttab.classList.remove ('tab-icon-active');\r\n                }\r\n\r\n            } else {\r\n\t\t\t\ttab.classList.remove ('tab-icon-active');\r\n            }\r\n        }\r\n    }\r\n\r\n    close () {\r\n        if (this._isAnimating) {\r\n            return;\r\n        }\r\n        this._setTabActive(this._activeTabId, false);\r\n\t\tthis._container.classList.remove ('iconSidebarControl_opened');\r\n        this._isAnimating = true;\r\n        this._isOpened = false;\r\n\r\n\t\tlet event = document.createEvent('Event');\r\n\t\tevent.initEvent('closing', false, false);\r\n\t\tthis.dispatchEvent(event);\r\n\r\n        setTimeout(() => {\r\n            this._container.classList.remove ('iconSidebarControl_expanded');\r\n\r\n\t\t\tlet ev = document.createEvent('Event');\r\n\t\t\tev.detail = { id: this._activeTabId };\r\n\t\t\tev.initEvent('closed', false, false);\r\n\t\t\tthis.dispatchEvent(ev);\r\n\r\n            this._isAnimating = false;\r\n            this._setActiveClass('');\r\n            this._activeTabId = null;\r\n\r\n        }, 250);\r\n    }\r\n\r\n    getWidth () {\r\n        if (this._isOpened) {\r\n            return this._extendedWidth;\r\n        } else {\r\n            return this._collapsedWidth;\r\n        }\r\n    }\r\n\r\n    getActiveTabId () {\r\n        return this._activeTabId;\r\n    }\r\n\r\n    isOpened () {\r\n        return this._isOpened;\r\n    }\r\n\r\n    _ensurePane (id) {\r\n        for (let i = 0; i < this._panesContainer.childNodes.length; ++i) {\r\n            let node = this._panesContainer.childNodes[i];\r\n            if (node.getAttribute('data-pane-id') === id) {\r\n                return node;\r\n            }\r\n        }\r\n\t\tlet paneEl = document.createElement ('div');\r\n\t\tpaneEl.classList.add ('iconSidebarControl-pane');\r\n        paneEl.setAttribute('data-pane-id', id);\r\n        this._panesContainer.appendChild(paneEl);\r\n        return paneEl;\r\n    }\r\n\r\n    _setActiveClass (activeId) {\r\n        for (let i = 0; i < this._panesContainer.children.length; i++) {\r\n            let id = this._panesContainer.children[i].getAttribute('data-pane-id');\r\n            let pane = this._panesContainer.querySelector('[data-pane-id=' + id + ']');\r\n            if (id === activeId) {\r\n\t\t\t\tpane.classList.add ('iconSidebarControl-pane-active');\r\n            } else {\r\n\t\t\t\tpane.classList.remove ('iconSidebarControl-pane-active');\r\n            }\r\n        }\r\n    }\r\n\r\n    _onTabClick (e) {\r\n        let tabId = e.currentTarget.getAttribute('data-tab-id');\r\n        let pane = this._panes[tabId];\r\n        if (!pane || !pane.enabled) {\r\n            return;\r\n        }\r\n        if (!this._isOpened || this._activeTabId !== tabId) {\r\n            this._renderTabs({ activeTabId: tabId });\r\n            this.open(tabId);\r\n        } else {\r\n            this._renderTabs({});\r\n            this.close();\r\n        }\r\n    }\r\n\r\n    _renderTabs (options) {\r\n        const getFlag = (tabId, activeTabId, hoveredTabId, enabled)  => {\r\n            if (!enabled) {\r\n                return 'disabled';\r\n            } else if (hoveredTabId && tabId === hoveredTabId) {\r\n                return 'hover';\r\n            } else if (activeTabId && tabId === activeTabId) {\r\n                return 'active';\r\n            } else {\r\n                return 'default';\r\n            }\r\n        };\r\n\r\n        let activeTabId = options.activeTabId;\r\n        let hoveredTabId = options.hoveredTabId;\r\n        this._tabsContainer.innerHTML = '';\r\n        Object.keys(this._panes)\r\n\t\t.map(id => extend({ id }, this._panes[id]))\r\n\t\t.sort((a, b) => a.position - b.position)\r\n\t\t.forEach(options => {\r\n            const { id, createTab, enabled } = options;\r\n            if (!createTab) {\r\n                return;\r\n            }\r\n            let tabContainerEl = document.createElement ('li');\r\n            tabContainerEl.classList.add ('iconSidebarControl-tab');\r\n            tabContainerEl.setAttribute('data-tab-id', id);\r\n            let tabEl = createTab(getFlag(id, activeTabId, hoveredTabId, enabled));\r\n\t\t\ttabContainerEl.addEventListener ('click', this._onTabClick);\r\n            tabContainerEl.appendChild(tabEl);\r\n            this._tabsContainer.appendChild(tabContainerEl);\r\n        });\r\n    }\r\n}\r\n\r\nexport default IconSidebarWidget;\r\n","import nsGmx from './nsGmx.js';\r\n\r\n/** Узел дерева слоёв\r\n * @typedef nsGmx.LayersTree~Node\r\n * @property {String} type тип узла (`layer` или `group`)\r\n * @property {Object} content содержимое узла\r\n * @property {Object} [content.properties] свойства узла\r\n * @property {Object} [content.children] потомки узла\r\n*/\r\n\r\n/** Результат поиска узла в дереве слоёв\r\n * @typedef nsGmx.LayersTree~SearchResult\r\n * @property {nsGmx.LayersTree~Node} elem Найденный элемент\r\n * @property {nsGmx.LayersTree~Node[]} parents Массив родителей. Самый последний элемент массива - сама карта\r\n * @property {Number} index Индекс найденного элемента в своей группе\r\n*/\r\n\r\n/** Visitor при обходе слоёв дерева\r\n * @callback nsGmx.LayersTree~LayerVisitor\r\n * @param {Object} layerContent Содержимое узла слоя\r\n * @param {Boolean} isVisible Видимость слоя с учётом видимости всех родителей\r\n * @param {Number} nodeDepth Глубина слоя в дереве (начинается с 0)\r\n*/\r\n\r\n/** Visitor при обходе узлов дерева слоёв\r\n * @callback nsGmx.LayersTree~NodeVisitor\r\n * @param {nsGmx.LayersTree~Node} node Свойства узла\r\n * @param {Boolean} isVisible Видимость узла с учётом видимости всех родителей\r\n * @param {Number} nodeDepth Глубина узла в дереве (начинается с 0)\r\n*/\r\n\r\n/** Класс для работы с деревом слоёв\r\n * @class\r\n * @param {Object} tree Дерево слоёв в формате сервера\r\n*/\r\nnsGmx.LayersTree = function( tree )\r\n{\r\n    /** Изменилась видимость узла дерева. Если изменения касаются нескольких узлов, событие будет \r\n        генерироваться для каждого узла по отдельности. Кроме того, это же событие генерируется \r\n        на отдельных узлах дерева.\r\n     * @event nsGmx.LayersTree#nodeVisibilityChange\r\n     * @param {nsGmx.LayersTree~Node} node Узел, видимость которой изменилась\r\n     */\r\n    var _tree = tree;\r\n    var _this = this;\r\n    \r\n    var _findElem = function(elem, propName, propValue, parents)\r\n    {\r\n        var childs = typeof elem.children != 'undefined' ? elem.children : elem.content.children;\r\n        \r\n        for (var i = 0; i < childs.length; i++)\r\n        {\r\n            var props = childs[i].content.properties;\r\n            if (propName in props && props[propName] === propValue) {\r\n                return {elem:childs[i], parents: [elem].concat(parents || []), index: i};\r\n            }\r\n            \r\n            if (typeof childs[i].content.children != 'undefined')\r\n            {\r\n                var res = _findElem(childs[i], propName, propValue, [elem].concat(parents || []));\r\n                \r\n                if (res)\r\n                    return res;\r\n            }\r\n        }\r\n    }\r\n    \r\n    /** Получить исходное дерево слоёв\r\n    */\r\n    this.getRawTree = function() \r\n    {\r\n        return _tree;\r\n    }\r\n    \r\n    /** Получить свойства карты\r\n    */\r\n    this.getMapProperties = function() \r\n    {\r\n        return _tree.properties;\r\n    }\r\n    \r\n    /** Поиск узла дерева по значению одного из атрибутов. Ищет как папки, так и слои. Возвращает первый найденный результат\r\n     * @param {String} propName Имя атрибута\r\n     * @param {String} propValue Значение атрибута\r\n     * @return {nsGmx.LayersTree~SearchResult} Результат поиска. undefined если ничего не найденно\r\n    */\r\n    this.findElem = function(propName, propValue)\r\n    {\r\n        return _findElem(_tree, propName, propValue);\r\n    }\r\n    \r\n    this.findElemByGmxProperties = function(gmxProperties)\r\n    {\r\n        if (gmxProperties.type == 'group') //группа\r\n            return this.findElem(\"GroupID\", gmxProperties.content.properties.GroupID);\r\n        else\r\n            return this.findElem(\"name\", gmxProperties.content.properties.name);\r\n    }\r\n    \r\n    /** Итерирование по всем слоям группы дерева\r\n     * @param {nsGmx.LayersTree~LayerVisitor} callback Будет вызвана для каждого слоя внутри группы. Первый аргумент - свойства слоя, второй - видимость слоя\r\n     * @param {nsGmx.LayersTree~Node} [groupNode] Группа, внутри которой проводить поиск. Если не указана, будет проводиться поиск по всему дереву.\r\n     */\r\n    this.forEachLayer = function(callback, groupNode)\r\n    {\r\n        this.forEachNode(function(node, isVisible, nodeDepth) {\r\n            if (node.type === 'layer') {\r\n                callback(node.content, isVisible, nodeDepth);\r\n            }\r\n        }, groupNode)\r\n    }\r\n    \r\n    /** Итерирование по всем под-узлам узла дерева\r\n     * @param {nsGmx.LayersTree~NodeVisitor} callback Будет вызвана для каждого узла внутри группы. Первый аргумент - узел, второй - видимость узла\r\n     * @param {nsGmx.LayersTree~Node} [groupNode] Группа, внутри которой проводить поиск. Если не указана, будет проводиться поиск по всему дереву.\r\n     */\r\n    this.forEachNode = function(callback, groupNode)\r\n    {\r\n        var forEachNodeRec = function(o, isVisible, nodeDepth)\r\n        {\r\n            isVisible = isVisible && !!o.content.properties.visible;\r\n            \r\n            callback(o, isVisible, nodeDepth);\r\n            \r\n            if (o.type === 'group') {\r\n                var a = o.content.children;\r\n                for (var k = a.length - 1; k >= 0; k--)\r\n                    forEachNodeRec(a[k], isVisible, nodeDepth + 1);\r\n            }\r\n        }\r\n        \r\n        var layers = groupNode ? groupNode.content : _tree;\r\n        \r\n        for (var k = layers.children.length - 1; k >= 0; k--) {\r\n            forEachNodeRec(layers.children[k], true, 0);\r\n        }\r\n    }\r\n    \r\n    /** Клонирование дерева с возможностью его модификации\r\n     * @param {function(node):nsGmx.LayersTree~Node|null} filterFunc - ф-ция, которая может модифицировать узлы дерева. \r\n                Вызывается при клонировании очередного узла. Изменения данных можно делать in-place.\r\n                Для групп вызывается после обработки всех потомков. Если возвращает null, то узел удаляется\r\n     */\r\n    this.cloneRawTree = function(filterFunc) {\r\n        filterFunc = filterFunc || function(node) {return node;};\r\n        var forEachLayerRec = function(o)\r\n        {\r\n            if (o.type == \"layer\") {\r\n                return filterFunc($.extend(true, {}, o));\r\n            }\r\n            else if (o.type == \"group\") {\r\n                var a = o.content.children;\r\n                var newChildren = [];\r\n                for (let k = 0; k < a.length; k++) {\r\n                    var newNode = forEachLayerRec(a[k]);\r\n                    newNode && newChildren.push(newNode);\r\n                }\r\n                return filterFunc({\r\n                    type: 'group', \r\n                    content: {\r\n                        children: newChildren,\r\n                        properties: $.extend(true, {}, o.content.properties)\r\n                    }\r\n                })\r\n            }\r\n        }\r\n        \r\n        var newFirstLevelGroups = [];\r\n        for (let k = 0; k < _tree.children.length; k++) {\r\n            var newNode = forEachLayerRec(_tree.children[k]);\r\n            newNode && newFirstLevelGroups.push(newNode);\r\n        }\r\n        \r\n        return {\r\n            properties: $.extend(true, {}, _tree.properties),\r\n            children: newFirstLevelGroups\r\n        }\r\n    }\r\n    \r\n    //Методы управления видимостью слоёв в дереве\r\n    \r\n    //проходится по всему поддереву elem и устанавливает видимость isVisible всем узлам включая elem (учитывая ограничения на radio buttons)\r\n    var setSubtreeVisibility = function(elem, isVisible) {\r\n        var props = elem.content.properties;\r\n        if (props.visible != isVisible) {\r\n            props.visible = isVisible;\r\n            $(_this).triggerHandler('nodeVisibilityChange', [elem]);\r\n            $(elem).triggerHandler('nodeVisibilityChange', [elem]);\r\n            \r\n            if (elem.content.children) {\r\n                for (var c = 0; c < elem.content.children.length; c++) {\r\n                    var vis = isVisible && (!props.list || c == 0); //когда делаем видимой группу-список, виден только первый элемент группы\r\n                    setSubtreeVisibility(elem.content.children[c], vis);\r\n                }\r\n            }\r\n        }\r\n    }    \r\n    \r\n    /** Устанавливает видимость узла дерева и всех родительских элементов данного узла в зависимости от видимости его прямых потомков. Узел должен быть группой.\r\n     * При этом разруливаются конфликты с несколькими видимыми узлами в radio-группах.\r\n     * @param {nsGmx.LayersTree~Node} node Узел дерева, видимость которого нужно обновить\r\n     * @param {nsGmx.LayersTree~Node} triggerSubnode один их прямых потомков node, состояние которого должно остаться неизменным (важно для разруливания конфликтов в radio-групп)\r\n     * @param {nsGmx.LayersTree~Node[]} [parents] массив всех родителей, опционально\r\n     */\r\n    this.updateNodeVisibility = function(elem, triggerSubnode, parents) {\r\n        var props = elem.content.properties,\r\n            isList = props.list,\r\n            children = elem.content.children,\r\n            triggerNodeVisible = triggerSubnode ? triggerSubnode.content.properties.visible : false,\r\n            visibleNode = triggerNodeVisible ? triggerSubnode : null;\r\n        \r\n        var isVisible = false;\r\n        for (var c = 0; c < children.length; c++) {\r\n            var child = children[c];\r\n            var childVisible = child.content.properties.visible;\r\n            isVisible = isVisible || childVisible;\r\n            \r\n            if (childVisible && !visibleNode) {\r\n                visibleNode = child;\r\n            }\r\n            \r\n            if (isList && childVisible && child !== visibleNode) {\r\n                setSubtreeVisibility(child, false);\r\n            }\r\n        }\r\n        \r\n        if (isVisible !== props.visible) {\r\n            props.visible = isVisible;\r\n            \r\n            $(this).triggerHandler('nodeVisibilityChange', [elem]);\r\n            $(elem).triggerHandler('nodeVisibilityChange', [elem]);\r\n            \r\n            if (!parents) {\r\n                parents = this.findElemByGmxProperties(elem).parents;\r\n                parents.pop(); //последний элемент - карта; нас не интересует\r\n            }\r\n            var parent = parents.shift();\r\n            parent && this.updateNodeVisibility(parent, elem, parents);\r\n        }\r\n    }\r\n    \r\n    /** Задать видимость узла дерева. Будут сделаны все нужные изменения видимости как выше, \r\n     * так и ниже по дереву относительно этого узла.\r\n     * @param {nsGmx.LayersTree~Node} node Узел дерева, которому мы хотим задать видимость\r\n     * @param {Boolean} isVisible Видимость узла (true - виден)\r\n     */\r\n    this.setNodeVisibility = function(node, isVisible) {\r\n        if (node.content.properties.visible != isVisible) {\r\n            //устанавливаем видимость поддерева, которое начинается с этого элемента\r\n            setSubtreeVisibility(node, isVisible);\r\n            \r\n            //идём вверх по дереву до корня и меняем видимость родителей\r\n            var parentElem = _this.findElemByGmxProperties(node).parents[0];\r\n            parentElem && parentElem.content && this.updateNodeVisibility(parentElem, node);\r\n        }\r\n    }\r\n}","import nsGmx from '../nsGmx.js';\r\nimport '../translations.js';\r\nimport {leftMenu} from '../menu.js';\r\nimport {\r\n    attachEffects,    \r\n    getOffsetRect,\r\n    _img,\r\n    _input,\r\n    inputError,\r\n    _li,\r\n    makeButton,\r\n    makeLinkButton,\r\n    makeImageButton,\r\n    objLength,\r\n    showDialog,\r\n    _span,\r\n    _t,\r\n    _table,\r\n    _tbody,\r\n    _td,\r\n    _tr,\r\n    _title,\r\n} from '../utilities.js';\r\n\r\n$('#flash').droppable({\r\n    drop: function(event, ui) {\r\n        var obj = ui.draggable[0].gmxDrawingObject;\r\n\r\n        if (obj) {\r\n            var text = Functions.GetFullName(obj.TypeName, obj.ObjName);\r\n            nsGmx.leafletMap.gmxDrawing.addGeoJSON({\r\n                type: 'Feature',\r\n                geometry: L.gmxUtil.geometryToGeoJSON(obj.Geometry)\r\n            }, {text: text});\r\n        }\r\n    }\r\n})\r\n\r\nwindow._translationsHash.addtext(\"rus\", {\r\n    \"Текущее местоположение отображается только для России и Украины\": \"Текущее местоположение отображается только для России и Украины\",\r\n    \"Следующие [value0] страниц\": \"Следующие [value0] страниц\",\r\n    \"Следующие [value0] страницы\": \"Следующие [value0] страницы\",\r\n    \"Следующая страница\": \"Следующая страница\",\r\n    \"Следующая [value0] страница\": \"Следующая [value0] страница\",\r\n    \"Предыдущие [value0] страниц\" : \"Предыдущие [value0] страниц\",\r\n    \"Первая страница\" : \"Первая страница\",\r\n    \"Последняя страница\" : \"Последняя страница\"\r\n});\r\nwindow._translationsHash.addtext(\"eng\", {\r\n    \"Текущее местоположение отображается только для России и Украины\": \"Current location is shown only for Russia and Ukraine\",\r\n    \"Следующие [value0] страниц\": \"Next [value0] pages\",\r\n    \"Следующие [value0] страницы\": \"Next [value0] pages\",\r\n    \"Следующая страница\": \"Next page\",\r\n    \"Следующая [value0] страница\": \"Next [value0] pages\",\r\n    \"Предыдущие [value0] страниц\" : \"Previous [value0] pages\",\r\n    \"Первая страница\" : \"First page\",\r\n    \"Последняя страница\" : \"Last page\"\r\n});\r\n\r\nvar imagesHost = \"img\";\r\n\r\n/** Вспомогательные функции\r\n @namespace Functions\r\n @memberOf Search\r\n*/\r\nvar Functions = {\r\n\r\n\t/** Возвращает полное наименование объекта, состоящее из типа и наименования\r\n\t @static\r\n\t @param sType Наименование типа объекта\r\n\t @param sName Наименование объекта\r\n    */\r\n\tGetFullName: function(/** string */sType, /** string */sName){\r\n\t\tvar sFullName = \"\";\r\n\r\n\t\tif (sType==null || sType == \"государство\" || sType == \"г.\" || /[a-zA-Z]/.test(sName))\r\n\t\t\tsFullName = sName;\r\n\t\telse if ((sType.indexOf(\"район\") != -1) || (sType.indexOf(\"область\") != -1) || (sType.indexOf(\"край\") != -1))\r\n\t\t\tsFullName = sName + \" \" + sType;\r\n\t\telse\r\n\t\t\tsFullName = sType + \" \" + sName;\r\n\r\n\t\treturn sFullName;\r\n\t},\r\n\r\n\t/** Возвращает полный путь к объекту\r\n    * @memberOf Search.Functions\r\n    *\r\n\t* @param oFoundObject найденный объект\r\n\t* @param sObjectsSeparator разделитель между дочерним элементом и родителем в строке пути\r\n\t* @param bParentAfter признак того, что родительский элемент идет после дочернего\r\n\t* @param sObjNameField название свойства, из которого брать наименование\r\n    */\r\n\tGetPath: function(/*object*/ oFoundObject,/* string */ sObjectsSeparator, /* bool */ bParentAfter, /* string */ sObjNameField){\r\n\t\tif (sObjNameField == null) sObjNameField = \"ObjName\";\r\n\t\tif (oFoundObject == null) return \"\";\r\n\t\tvar oParentObj = oFoundObject.Parent;\r\n\t\tif (oParentObj != null && (oParentObj.ObjName == \"Российская Федерация\" || oParentObj.TypeName == \"административный округ\")) {\r\n\t\t\toParentObj = oParentObj.Parent;\r\n\t\t}\r\n\t\tvar sObjectName = (oFoundObject.CountryCode != 28000 && oFoundObject.CountryCode != 310000183) ? oFoundObject[sObjNameField] : this.GetFullName(oFoundObject.TypeName, oFoundObject[sObjNameField]);\r\n\t\tif (oParentObj != null && oParentObj[sObjNameField] != null && oParentObj[sObjNameField]){\r\n\t\t\tif (bParentAfter){\r\n\t\t\t\treturn sObjectName + sObjectsSeparator + this.GetPath(oParentObj, sObjectsSeparator,  bParentAfter, sObjNameField);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn this.GetPath(oParentObj, sObjectsSeparator,  bParentAfter, sObjNameField) + sObjectsSeparator + sObjectName;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn sObjectName;\r\n\t\t}\r\n\t},\r\n\r\n\t/** Возвращает строку, соединяющую переданные свойства\r\n\t @static\r\n\t @param oProps - Свойства\r\n\t @param sObjectsSeparator Разделитель 2х свойств в строке*/\r\n\tGetPropertiesString: function(/**object[]*/oProps,/**string*/ sPropSeparator){\r\n\t\tvar sResultString = \"\";\r\n\t\tif (oProps != null){\r\n\t\t\tfor (var sPropName in oProps){\r\n\t\t\t\tif (sResultString != \"\") sResultString += sPropSeparator;\r\n\t\t\t\tsResultString += sPropName + \": \" + oProps[sPropName];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn sResultString;\r\n\t}\r\n}\r\n\r\n\r\n/** Конструктор\r\n @class Предоставляет функции, отображающие найденные объекты на карте\r\n @memberof Search\r\n @param {L.Map} map карта, на которой будут рисоваться объекты\r\n @param {string} sInitImagesHost - строка пути к картинкам\r\n @param {bool} bInitAutoCenter - если true, карта будет центрироваться по 1ому найденному объекту*/\r\nvar ResultRenderer = function(map, sInitImagesHost, bInitAutoCenter){\r\n\tif (map == null)  throw \"ResultRenderer.Map is null\";\r\n\r\n\tvar sImagesHost = sInitImagesHost || \"http://maps.kosmosnimki.ru/api/img\";\r\n\tvar bAutoCenter = (bInitAutoCenter == null) || bInitAutoCenter;\r\n\r\n    this.arrContainer = [];\r\n\tvar counts = [];\r\n\r\n\t/** возвращает стили найденных объектов, используется только для точки*/\r\n\tvar getSearchIcon = function(iPosition) {\r\n        iPosition = Math.min(iPosition, 9);\r\n        return L.icon({\r\n            iconUrl: sImagesHost + \"/search/search_\" + (iPosition + 1).toString() + \".png\",\r\n            iconAnchor: [15, 38],\r\n            popupAnchor: [0, -28]\r\n        });\r\n\r\n\t\t// return [\r\n\t\t\t\t\t\t// { marker: { image: sImagesHost + \"/search/search_\" + (iPosition + 1).toString() + \".png\", dx: -14, dy: -38} },\r\n\t\t\t\t\t\t// { marker: { image: sImagesHost + \"/search/search_\" + (iPosition + 1).toString() + \"a.png\", dx: -14, dy: -38} }\r\n\t\t\t\t// ];\r\n\t}\r\n\r\n    var bindHoverPopup = function(layer, content) {\r\n        layer.bindPopup(content);\r\n    }\r\n\r\n\t/**Помещает объект на карту\r\n\t@param {MapObject} oContainer контейнер, содержащий в себе объекты текущей группы результатов поиска\r\n\t@param {MapObject} oFoundObject добавляемый объект\r\n\t@param {int} iPosition порядковый номер добавляемого объекта в группе\r\n\t@param {int} iCount общее количество объектов в группе\r\n    @return {Object} Нарисованные на карте объекты: хеш с полями center и boundary */\r\n\tvar DrawObject = function(oContainer, oFoundObject, iPosition, iCount){\r\n        var color = Math.round(0x22 + 0x99*iPosition/iCount);\r\n\t\tvar sDescr = \"<b>\" + Functions.GetFullName(oFoundObject.TypeName, oFoundObject.ObjName) + \"</b><br/>\" + Functions.GetPath(oFoundObject.Parent, \"<br/>\", true);\r\n\t\tif (oFoundObject.properties != null) sDescr += \"<br/>\" + Functions.GetPropertiesString(oFoundObject.properties, \"<br/>\");\r\n\r\n        sDescr = sDescr.replace(/;/g, \"<br/>\");\r\n\r\n\t\t// var fnBaloon = function(o) {\r\n\t\t// \treturn o.properties.Descr.replace(/;/g, \"<br/>\");\r\n\t\t// };\r\n\t\tvar centerMapElem,\r\n            boundaryMapElem;\r\n\t\t//Рисуем центр объекта\r\n\t\tif (oFoundObject.Geometry != null && (oFoundObject.Geometry.type).toUpperCase() == 'POINT') {\r\n            centerMapElem = L.marker([oFoundObject.Geometry.coordinates[1], oFoundObject.Geometry.coordinates[0]], {\r\n                icon: getSearchIcon(iPosition)\r\n            });\r\n            bindHoverPopup(centerMapElem, sDescr);\r\n            oContainer.addLayer(centerMapElem);\r\n\t\t}\r\n\t\telse if (oFoundObject.CntrLon != null && oFoundObject.CntrLat != null){\r\n            centerMapElem = L.marker([oFoundObject.CntrLat, oFoundObject.CntrLon], {\r\n                icon: getSearchIcon(iPosition)\r\n            });\r\n\r\n            bindHoverPopup(centerMapElem, sDescr);\r\n            oContainer.addLayer(centerMapElem);\r\n\t\t}\r\n\r\n\r\n\t\t//Рисуем контур объекта\r\n\t\tif (oFoundObject.Geometry != null && (oFoundObject.Geometry.type).toUpperCase() != 'POINT') {\r\n            boundaryMapElem = L.geoJson(L.gmxUtil.geometryToGeoJSON(oFoundObject.Geometry), {\r\n                style: function() {\r\n                    return\r\n                },\r\n                onEachFeature: function(feature, layer) {\r\n                    layer.setStyle({\r\n                        color: '#' + (0x1000000 + (color << 16) + (color << 8) + color).toString(16).substr(-6),\r\n                        weight: 3,\r\n                        opacity: 0.6,\r\n                        fill: false\r\n                    });\r\n\r\n                    bindHoverPopup(layer, sDescr)\r\n                }\r\n            });\r\n\r\n            oContainer.addLayer(boundaryMapElem);\r\n\t\t}\r\n\r\n        return {center: centerMapElem, boundary: boundaryMapElem};\r\n\t};\r\n\r\n\t/**Центрует карту по переданному объекту*/\r\n\tvar CenterObject = function(oFoundObject){\r\n\t\tif (!oFoundObject) return;\r\n\t\tvar iZoom = oFoundObject.TypeName == \"г.\" ? 9 : 15;\r\n        if (oFoundObject.Geometry == null) {\r\n\t\t    if (oFoundObject.MinLon != null && oFoundObject.MaxLon != null && oFoundObject.MinLat != null && oFoundObject.MaxLat != null\r\n                && oFoundObject.MaxLon - oFoundObject.MinLon < 1e-9 && oFoundObject.MaxLat - oFoundObject.MinLat < 1e-9)\r\n\t\t\t    map.setView([oFoundObject.CntrLat, oFoundObject.CntrLon], iZoom);\r\n\t\t    else\r\n\t\t\t    map.fitBounds([[oFoundObject.MinLat, oFoundObject.MinLon], [oFoundObject.MaxLat, oFoundObject.MaxLon]]);\r\n        }\r\n\t\telse if ((oFoundObject.Geometry.type).toUpperCase() == 'POINT') {\r\n            if (oFoundObject.MinLon != oFoundObject.MaxLon && oFoundObject.MinLat != oFoundObject.MaxLat) {\r\n                map.fitBounds([[oFoundObject.MinLat, oFoundObject.MinLon], [oFoundObject.MaxLat, oFoundObject.MaxLon]]);\r\n            } else {\r\n                var c = oFoundObject.Geometry.coordinates;\r\n                map.setView([c[1], c[0]], iZoom);\r\n            }\r\n        }\r\n        else {\r\n            var bounds = L.gmxUtil.getGeometryBounds(oFoundObject.Geometry);\r\n            //var oExtent = getBounds(oFoundObject.Geometry.coordinates);\r\n            map.fitBounds([[bounds.min.y, bounds.min.x], [bounds.max.y, bounds.max.x]]);\r\n        }\t\t\r\n\t};\r\n\r\n\t/**Центрует карту по переданному объекту\r\n\t@param {MapObject} oFoundObject объект, который нужно поместить в центр\r\n\t@returns {void}*/\r\n\tthis.CenterObject = function(oFoundObject){\r\n\t\tCenterObject(oFoundObject);\r\n\t}\r\n\r\n\t/** Рисует объекты на карте.\r\n\t@param {int} iDataSourceN № источника данных (группы результатов поиска)\r\n\t@param {Array} arrFoundObjects Массив объектов для отрисовки. Каждый объект имеет свойства\r\n\t@param {bool} [options.append=false] Добавить к существующим объектам для источника данных, а не удалять их\r\n\t@return {Array} Нарисованные на карте объекты: массив хешей с полями center и boundary\r\n    */\r\n\tthis.DrawObjects = function(iDataSourceN, arrFoundObjects, options){\r\n        options = $.extend({append: false}, options);\r\n\r\n        if (!options.append && this.arrContainer[iDataSourceN]) {\r\n            map.removeLayer(this.arrContainer[iDataSourceN]);\r\n            delete this.arrContainer[iDataSourceN];\r\n        }\r\n\r\n        if (!this.arrContainer[iDataSourceN]) {\r\n            this.arrContainer[iDataSourceN] = L.layerGroup();\r\n            counts[iDataSourceN] = 0;\r\n        }\r\n\r\n\t\t// iCount = arrFoundObjects.length;\r\n\r\n        var mapObjects = [];\r\n\r\n        counts[iDataSourceN] += arrFoundObjects.length;\r\n\r\n\t\t//Отрисовываем задом наперед, чтобы номер 1 был сверху от 10ого\r\n\t\tfor (var i = arrFoundObjects.length - 1; i >= 0; i--){\r\n\t\t\tmapObjects.unshift(DrawObject(this.arrContainer[iDataSourceN], arrFoundObjects[i], counts[iDataSourceN] + i - arrFoundObjects.length, counts[iDataSourceN]));\r\n\t\t}\r\n\r\n\t\tthis.arrContainer[iDataSourceN].addTo(map);\r\n\t\tif (bAutoCenter && iDataSourceN == 0) CenterObject(arrFoundObjects[0]);\r\n\r\n        return mapObjects;\r\n\t}\r\n};\r\n\r\n// /** Конструктор\r\n//  @class Предоставляет функции, отображающие найденные объекты на карте\r\n//  @memberof Search\r\n//  @param {object} oInitMap карта, на которой будут рисоваться объекты\r\n//  @param {function} fnSearchLocation = function({Geometry, callback})- функция поиска объектов по переданной геометрии*/\r\n// var LocationTitleRenderer = function(oInitMap, fnSearchLocation){\r\n// \tvar _this = this;\r\n// \tvar oMap = oInitMap;\r\n// \tvar dtLastSearch;\r\n\r\n// \t/**Добавляет объект в список найденных результатов*/\r\n// \tvar drawObject = function(oFoundObject, elemDiv)\r\n// \t{\r\n// \t\tif (oFoundObject.Parent != null) drawObject(oFoundObject.Parent, elemDiv, true);\r\n// \t\tvar\trealPath = oFoundObject.IsForeign ? oFoundObject.ObjName : Functions.GetFullName(oFoundObject.TypeName, oFoundObject.ObjName);\r\n\r\n// \t\tvar searchElemHeader = _span([_t(realPath)], [['dir', 'className', 'searchLocationPath']]);\r\n\r\n// \t\t/** Вызывается при клике на найденный объект в списке результатов поиска\r\n// \t\t@name Search.ResultList.onObjectClick\r\n// \t\t@event\r\n// \t\t@param {object} oFoundObject Найденный объект*/\r\n// \t\tsearchElemHeader.onclick = function(){$(_this).triggerHandler('onObjectClick', [oFoundObject]);};\r\n\r\n// \t\tif (oFoundObject.Parent != null) _(elemDiv, [_t(\"->\")]);\r\n// \t\t_(elemDiv, [searchElemHeader]);\r\n// \t}\r\n\r\n// \tvar setLocationTitleDiv = function(div, attr) {\r\n// \t\tif (dtLastSearch && Number(new Date()) - dtLastSearch < 300) return;\r\n// \t\tdtLastSearch = new Date();\r\n\r\n// \t\tvar locationTitleDiv = div;\r\n\r\n// \t\tfnSearchLocation({Geometry: attr['screenGeometry'], callback: function(arrResultDataSources){\r\n// \t\t\t$(locationTitleDiv).empty();\r\n// \t\t\tif (arrResultDataSources.length>0 && arrResultDataSources[0].SearchResult.length>0){\r\n// \t\t\t\tdrawObject(arrResultDataSources[0].SearchResult[0], locationTitleDiv);\r\n// \t\t\t}\r\n// \t\t\telse {\r\n// \t\t\t\t_(locationTitleDiv, [_t(_gtxt(\"Текущее местоположение отображается только для России и Украины\"))]);\r\n// \t\t\t}\r\n// \t\t}});\r\n// \t};\r\n\r\n// \tif (oMap.coordinates) oMap.coordinates.addCoordinatesFormat(setLocationTitleDiv);\r\n// }\r\n\r\nvar ResultList = function(oInitContainer, oRenderer, ImagesHost){\r\n\t/**Объект, в котором находится контрол (div)*/\r\n    // создается в начале searchLogic.showResult\r\n\tvar Container = oInitContainer;\r\n\tvar _this = this;\r\n\r\n\tvar sImagesHost = ImagesHost || \"http://maps.kosmosnimki.ru/api/img\";\r\n\r\n\tvar arrDisplayedObjects = []; //Объекты, которые отображаются на текущей странице\r\n\tvar iLimit = 10; //Максимальное количество результатов на странице\r\n\tvar iPagesCount = 7; //Количество прокручиваемых страниц при нажатии на двойные стрелки\r\n\tif (Container == null) throw \"ResultList.Container is null\";\r\n\r\n\tvar oResultCanvas;\r\n\tvar arrTotalResultSet = [];\r\n\r\n\tif (oResultCanvas == null)\r\n\t{\r\n\t\toResultCanvas = nsGmx.Utils._div(null, [['dir', 'className', 'searchResultCanvas']]);\r\n        Container.appendChild(oResultCanvas);\r\n\t}\r\n\tvar oLoading = nsGmx.Utils._div([_img(null, [['attr', 'src', sImagesHost + '/progress.gif'], ['dir', 'className', 'searchResultListLoadingImg']]), _t(_gtxt(\"загрузка...\"))], [['dir', 'className', 'searchResultListLoading']]);\r\n\tvar fnNotFound = function(){nsGmx.Utils._(oResultCanvas, [nsGmx.Utils._div([_t(_gtxt(\"Поиск не дал результатов\"))], [['dir', 'className', 'SearchResultListNotFound']])]);};\r\n\r\n\t/**Удаляет все найденные объекты из результатов поиска*/\r\n\tvar unload = function(){\r\n\t\tfor (let i = 0; i < arrDisplayedObjects.length; i++){\r\n\t\t\tSetDisplayedObjects(i, []);\r\n\t\t}\r\n\t\t$(oResultCanvas).empty();\r\n\t}\r\n    // /** Переход на следующие страницы*/\r\n    // var next = function(iDataSourceN, divChilds, divPages) {\r\n    //     var button = makeImageButton(sImagesHost + '/next.png', sImagesHost + '/next_a.png');\r\n\r\n    //     button.style.marginBottom = '-7px';\r\n\r\n    //     button.onclick = function() {\r\n\t// \t\tvar oDataSource = arrTotalResultSet[iDataSourceN];\r\n    //         oDataSource.start += iPagesCount;\r\n    //         oDataSource.reportStart = oDataSource.start * iLimit;\r\n\r\n    //         drawPagesRow(iDataSourceN, divChilds, divPages);\r\n    //     }\r\n\r\n    //     _title(button, _gtxt('Следующие [value0] страниц', iPagesCount));\r\n\r\n    //     return button;\r\n    // }\r\n\r\n    /** Переход на предыдущие страницы*/\r\n    var previous = function(iDataSourceN, divChilds, divPages) {\r\n        var button = makeImageButton(sImagesHost + '/prev.png', sImagesHost + '/prev_a.png');\r\n\r\n        button.style.marginBottom = '-7px';\r\n\r\n        button.onclick = function() {\r\n\t\t\tvar oDataSource = arrTotalResultSet[iDataSourceN];\r\n            oDataSource.start -= iPagesCount;\r\n            oDataSource.reportStart = oDataSource.start * iLimit;\r\n\r\n            drawPagesRow(iDataSourceN, divChilds, divPages);\r\n        }\r\n\r\n        _title(button, _gtxt('Предыдущие [value0] страниц', iPagesCount));\r\n\r\n        return button;\r\n    }\r\n\r\n    /** Переход на первую страницу*/\r\n    var first = function(iDataSourceN, divChilds, divPages) {        \r\n\t\tvar\tbutton = makeImageButton(sImagesHost + '/first.png', sImagesHost + '/first_a.png');\r\n\r\n        button.style.marginBottom = '-7px';\r\n\r\n        button.onclick = function() {\r\n\t\t\tvar oDataSource = arrTotalResultSet[iDataSourceN];\r\n            oDataSource.start = 0;\r\n            oDataSource.reportStart = oDataSource.start * iLimit;\r\n\r\n            drawPagesRow(iDataSourceN, divChilds, divPages);\r\n        }\r\n\r\n        _title(button, _gtxt('Первая страница'));\r\n\r\n        return button;\r\n    }\r\n\r\n    // /** Переход на последнюю страницу*/\r\n    // var last = function(iDataSourceN, divChilds, divPages) {\r\n    //     var _this = this,\r\n\t// \t\tbutton = makeImageButton(sImagesHost + '/last.png', sImagesHost + '/last_a.png');\r\n\r\n    //     button.style.marginBottom = '-7px';\r\n\r\n    //     button.onclick = function() {\r\n\t// \t\tvar oDataSource = arrTotalResultSet[iDataSourceN];\r\n    //         oDataSource.start = Math.floor((oDataSource.SearchResult.length - 1)/ (iPagesCount * iLimit)) * iPagesCount;\r\n    //         oDataSource.reportStart = Math.floor((oDataSource.SearchResult.length - 1)/ (iLimit)) * iLimit;\r\n\r\n    //         drawPagesRow(iDataSourceN, divChilds, divPages);\r\n    //     }\r\n\r\n    //     _title(button, _gtxt('Последняя страница'));\r\n\r\n    //     return button;\r\n    // }\r\n\r\n\t/**Добавляет объект в список найденных результатов*/\r\n\tvar drawObject = function(oFoundObject, elemDiv, bIsParent)\r\n\t{\r\n\t\tvar\trealPath = (oFoundObject.CountryCode != 28000 && oFoundObject.CountryCode != 310000183)  ? oFoundObject.ObjName : Functions.GetFullName(oFoundObject.TypeName, oFoundObject.ObjName);\r\n\t\tif (oFoundObject.Parent != null) realPath += \",\";\r\n\r\n\t\tvar searchElemHeader = _span([_t(realPath)], [['dir', 'className', bIsParent?'searchElemParent':'searchElem']]);\r\n\r\n\t\t/** Вызывается при клике на найденный объект в списке результатов поиска\r\n\t\t@name Search.ResultList.onObjectClick\r\n\t\t@event\r\n\t\t@param {object} oFoundObject Найденный объект*/\r\n\t\tsearchElemHeader.onclick = function(){$(_this).triggerHandler('onObjectClick', [oFoundObject]);};\r\n\r\n\t\tnsGmx.Utils._(elemDiv, [searchElemHeader]);\r\n\t\tif (oFoundObject.Parent != null) drawObject(oFoundObject.Parent, elemDiv, true);\r\n\t\tif (oFoundObject.properties != null) nsGmx.Utils._(elemDiv, [document.createTextNode(\" \" + Functions.GetPropertiesString(oFoundObject.properties, \"; \"))]);\r\n\t}\r\n\r\n\t/** Рисует строки списка*/\r\n\tvar drawRows = function(iDataSourceN, divChilds) {\r\n\t\tvar arrObjects = arrDisplayedObjects[iDataSourceN];\r\n\t\t$(divChilds).empty();\r\n\t\tvar tbody = _tbody();\r\n\t\tfor (var i = 0; i < arrObjects.length; i++) {\r\n\t\t\tvar elemTR = _tr(null, [['dir', 'className', 'SearchResultRow']]);\r\n\t\t\tvar elemTD = _td(null, [['dir', 'className', 'SearchResultText']]);\r\n\t\t\tnsGmx.Utils._(elemTR, [_td([_t((i+1).toString() + \".\")], [['dir', 'className','searchElemPosition']]), elemTD]);\r\n\t\t\tdrawObject(arrObjects[i], elemTD);\r\n\r\n\t\t\t// загрузка SHP Файла\r\n\t\t\tif (window.gmxGeoCodeShpDownload && arrObjects[i].Geometry != null) {\r\n\t\t\t    var shpFileLink = _span([_t(\".shp\")], [['dir', 'className', 'searchElem'], ['attr', 'title', 'скачать SHP-файл'], ['attr', 'number', i]]);\r\n\r\n\t\t\t    shpFileLink.onclick = function () {\r\n\t\t\t        var obj = arrObjects[$(this).attr('number')];\r\n\t\t\t        var objsToDownload = [obj];\r\n\t\t\t        $(_this).triggerHandler('onDownloadSHP', [obj.ObjCode, objsToDownload]);\r\n\t\t\t    };\r\n\t\t\t   nsGmx.Utils._(elemTD, [_t(\" \")]);\r\n\t\t\t   nsGmx.Utils._(elemTD, [shpFileLink]);\r\n\t\t\t}\r\n\r\n            elemTD.gmxDrawingObject = arrObjects[i];\r\n\r\n            $(elemTD).draggable({\r\n                scroll: false,\r\n                appendTo: document.body,\r\n                helper: 'clone',\r\n                distance: 10\r\n            });\r\n\r\n\t\t\tnsGmx.Utils._(tbody, [elemTR]);\r\n\t\t}\r\n\t\tnsGmx.Utils._(divChilds, [_table([tbody])]);\r\n\r\n\t}\r\n\r\n\t// /**рисует номера страниц списка\r\n\t// @param end - последний номер\r\n\t// @param iDataSourceN - номер источника данных\r\n\t// @param divChilds - раздел для элементов списка\r\n\t// @param divPages - раздел для номеров страниц списка*/\r\n\t// var drawPages = function(end, iDataSourceN, divChilds, divPages) {\r\n\t// \tvar oDataSource = arrTotalResultSet[iDataSourceN];\r\n\t// \tfor (var i = oDataSource.start + 1; i <= end; i++) {\r\n\t// \t\t// текущий элемент\r\n\t// \t\tif (i - 1 == oDataSource.reportStart / iLimit) {\r\n\t// \t\t\tvar el = _span([_t(i.toString())]);\r\n\t// \t\t\tnsGmx.Utils._(divPages, [el]);\r\n\t// \t\t\t$(el).addClass('page');\r\n\t// \t\t}\r\n\t// \t\telse {\r\n\t// \t\t\tvar link = makeLinkButton(i.toString());\r\n\r\n\t// \t\t\tlink.setAttribute('page', i - 1);\r\n\t// \t\t\tlink.style.margin = '0px 2px';\r\n\r\n\t// \t\t\tnsGmx.Utils._(divPages, [link]);\r\n\r\n\t// \t\t\tlink.onclick = function() {\r\n\t// \t\t\t\tarrTotalResultSet[iDataSourceN].reportStart = this.getAttribute('page') * iLimit;\r\n\r\n\t// \t\t\t\tdrawPagesRow(iDataSourceN, divChilds, divPages);\r\n\t// \t\t\t};\r\n\t// \t\t}\r\n\r\n\t// \t}\r\n\t// }\r\n\r\n\t/**Рисует одну из страниц списка\r\n\t@param iDataSourceN - номер источника данных\r\n\t@param divChilds - раздел для элементов списка\r\n\t@param divPages - раздел для номеров страниц списка*/\r\n\tvar drawPagesRow = function(iDataSourceN, divChilds, divPages) {\r\n\t\tvar oDataSource = arrTotalResultSet[iDataSourceN];\r\n\r\n\t\t// перерисовывем номера страниц\r\n\t\t$(divPages).empty();\r\n\r\n\t\t// var end = (oDataSource.start + iPagesCount <= oDataSource.allPages) ? oDataSource.start + iPagesCount : oDataSource.allPages;\r\n\r\n\t\tif (oDataSource.start - iPagesCount >= 0)\r\n\t\t\tnsGmx.Utils._(divPages, [first(iDataSourceN, divChilds, divPages), previous(iDataSourceN, divChilds, divPages)]);\r\n\r\n\t\t// drawPages(end, iDataSourceN, divChilds, divPages);\r\n\r\n\t\t// if (end + 1 <= oDataSource.allPages)\r\n\t\t// \tnsGmx.Utils._(divPages, [next(iDataSourceN, divChilds, divPages), last(iDataSourceN, divChilds, divPages)]);\r\n        var startFrom = oDataSource.reportStart * iLimit;\r\n\r\n\t\tSetDisplayedObjects(iDataSourceN, oDataSource.SearchResult.slice(startFrom, (startFrom + iLimit)));\r\n\t\tdrawRows(iDataSourceN, divChilds);\r\n\t}\r\n\r\n\t/**Рисует таблицу для результатов источника данных\r\n\t@param iDataSourceN - номер источника данных\r\n\t@param divChilds - раздел для элементов списка\r\n\t@param divPages - раздел для номеров страниц списка*/\r\n\tvar drawTable = function(iDataSourceN, divChilds, divPages) {\r\n\t\tvar oDataSource = arrTotalResultSet[iDataSourceN];\r\n\r\n\r\n\t\tif (oDataSource.SearchResult.length <= iLimit/* && iDataSourceN < oDataSource.SearchResult.length - 1*/) {\r\n\t\t\t$(divPages).empty();\r\n\t\t\tSetDisplayedObjects(iDataSourceN, oDataSource.SearchResult);\r\n\t\t\tdrawRows(iDataSourceN, divChilds);\r\n\t\t}\r\n\t\telse {\r\n\t\t\toDataSource.allPages = Math.ceil(oDataSource.SearchResult.length / iLimit);\r\n\t\t\tdrawPagesRow(iDataSourceN, divChilds, divPages);\r\n\t\t}\r\n\t}\r\n\r\n\t/**Обрабатывает событие нажатия на кнопку \"Скачать SHP-файл\"\r\n\t@param iDataSourceN - номер источника данных*/\r\n\tvar downloadMarkers = function(iDataSourceN) {\r\n\t\tvar oDataSource = arrTotalResultSet[iDataSourceN];\r\n\t\tvar canvas = nsGmx.Utils._div(),\r\n\t\t\tfilename = _input(null, [['dir', 'className', 'filename'], ['attr', 'value', oDataSource.name]]);\r\n\r\n\t\tvar downloadButton = makeButton(_gtxt(\"Скачать\"));\r\n\t\tdownloadButton.onclick = function() {\r\n\t\t\tif (filename.value == '') {\r\n\t\t\t\tinputError(filename, 2000);\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t/** Вызывается при необходимости осуществить загрузку SHP-файла с результатами поиска\r\n\t\t\t@name Search.ResultList.onDownloadSHP\r\n\t\t\t@event\r\n\t\t\t@param {string} filename Имя файла, которой необходимо будет сформировать\r\n\t\t\t@param {object[]} SearchResult Результаты поиска, которые необходимо сохранить в файл*/\r\n\t\t\t$(_this).triggerHandler('onDownloadSHP', [filename.value, oDataSource.SearchResult]);\r\n\r\n\t\t\t$(canvas.parentNode).dialog(\"destroy\").remove();\r\n\t\t}\r\n\r\n\t\tnsGmx.Utils._(canvas, [nsGmx.Utils._div([_t(_gtxt(\"Введите имя файла для скачивания\")), filename], [['dir', 'className', 'DownloadSHPButtonText']]), nsGmx.Utils._div([downloadButton], [['dir', 'className', 'DownloadSHPButton']])]);\r\n\r\n\t\tvar area = getOffsetRect(Container);\r\n\t\tshowDialog(_gtxt(\"Скачать shp-файл\"), canvas, 291, 120, 30, area.top + 10);\r\n\t}\r\n\r\n\t/**Отображает результаты поиска с источника данных\r\n\t@param iDataSourceN - номер источника данных*/\r\n\tvar drawSearchResult = function(iDataSourceN, options) {\r\n\t\tvar oDataSource = arrTotalResultSet[iDataSourceN];\r\n\r\n\t\tvar arrDataSourceList = oDataSource.SearchResult;\r\n\t\tvar header = oDataSource.name;\r\n\r\n\t\tvar divChilds = nsGmx.Utils._div(null, [['dir', 'className', 'SearchResultListChildsCanvas']]),\r\n\t\t\tdivPages = nsGmx.Utils._div(),\r\n\t\t\tliInner = _li([divChilds, divPages]),\r\n\t\t\tli;\r\n\t\tif (arrTotalResultSet.length == 1){\r\n\t\t\tli = nsGmx.Utils._ul([liInner]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tli = _li([nsGmx.Utils._div([_t(header), _span([_t(\"(\" + arrDataSourceList.length + \")\")])], [['dir', 'className', 'searchLayerHeader']]), nsGmx.Utils._ul([liInner])]);\r\n\t\t}\r\n\r\n\t\toDataSource.start = 0;\r\n\t\toDataSource.reportStart = options.page || 0;\r\n\t\toDataSource.allPages = 0;\r\n\r\n\t\tdrawTable(iDataSourceN, divChilds, divPages);\r\n\r\n\t\tif (oDataSource.CanDownloadVectors) {\r\n\t\t\tvar downloadVector = makeLinkButton(_gtxt(\"Скачать shp-файл\"));\r\n\r\n\t\t\tdownloadVector.onclick = function() {\r\n\t\t\t\tdownloadMarkers(iDataSourceN);\r\n\t\t\t}\r\n\r\n\t\t\tliInner.insertBefore(nsGmx.Utils._div([downloadVector], [['dir', 'className', 'SearchDownloadShpLink']]), liInner.firstChild);\r\n\t\t}\r\n\r\n\t\treturn li;\r\n\t}\r\n\r\n    var fnDisplayedObjectsChanged = function(event, iDataSourceN, arrFoundObjects){\r\n        oRenderer.DrawObjects(iDataSourceN, arrFoundObjects);\r\n        /** Вызывается при изменении отображаемого списка найденных объектов(ведь они отображаются не все)\r\n        @name Search.ResultListMap.onDisplayedObjectsChanged\r\n        @event\r\n        @param {int} iDataSourceN № источника данных(группы результатов поиска)\r\n        @param {object[]} arrDSDisplayedObjects Результаты поиска, которые необходимо отобразить в текущей группе*/\r\n        // $(_this).triggerHandler('onDisplayedObjectsChanged', [iDataSourceN, arrFoundObjects]);\r\n    }\r\n\r\n    var fnObjectClick = function(event, oFoundObject){\r\n        oRenderer.CenterObject(oFoundObject);\r\n\r\n        /** Вызывается при клике на найденный объект в списке результатов поиска\r\n        @name Search.ResultListMap.onObjectClick\r\n        @event\r\n        @param {object} oFoundObject Найденный объект*/\r\n        // $(oSearchResultDiv).triggerHandler('onObjectClick', [oFoundObject]);\r\n    }\r\n\r\n    var fnDownloadSHP = function(){\r\n        /** Вызывается при необходимости осуществить загрузку SHP-файла с результатами поиска\r\n        @name Search.ResultListMap.onDownloadSHP\r\n        @event\r\n        @param {string} filename Имя файла, которой необходимо будет сформировать\r\n        @param {object[]} SearchResult Результаты поиска, которые необходимо сохранить в файл*/\r\n        // $(oSearchResultDiv).triggerHandler('onDownloadSHP', [filename, arrObjectsToDownload]);\r\n    }\r\n\r\n\r\n    $(_this).bind('onDisplayedObjectsChanged', fnDisplayedObjectsChanged);\r\n    $(_this).bind('onObjectClick', fnObjectClick);\r\n    $(_this).bind('onDownloadSHP', fnDownloadSHP);\r\n\r\n\t/**Отображает результаты поиска в списке\r\n\t@param sTotalListName - заголовок итогового результата\r\n\t@param {Array.<Object>} arrTotalList. Массив объектов со следующими свойствами{name:DataSourceName, CanDownloadVectors:CanDownloadVectors, SearchResult:arrDataSourceList[oObjFound,...]}\r\n\t@returns {void}\r\n\t*/\r\n\tthis.ShowResult = function(sTotalListName, arrTotalList, options){\r\n\t\tarrTotalResultSet = arrTotalList;\r\n\t    $(oResultCanvas).empty();\r\n\t\tarrDisplayedObjects = [];\r\n\t\tif (!objLength(arrTotalResultSet)) {\r\n\t\t\tfnNotFound();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar foundSomething = false;\r\n\r\n\t\t\tfor (var i = 0; i < arrTotalResultSet.length; i++) {\r\n\t\t\t\tif (arrTotalResultSet[i].SearchResult.length > 0) {\r\n\t\t\t\t\tfoundSomething = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!foundSomething) {\r\n\t\t\t\tfnNotFound();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar ulSearch = nsGmx.Utils._ul();\r\n\r\n\t\tfor (var iDataSourceN  = 0; iDataSourceN < arrTotalResultSet.length; iDataSourceN++)\r\n\t\t\tnsGmx.Utils._(ulSearch, [drawSearchResult(iDataSourceN, options)]);\r\n\r\n\t\tif (arrTotalResultSet.length == 1){\r\n\t\t\tnsGmx.Utils._(oResultCanvas, [ulSearch]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tnsGmx.Utils._(oResultCanvas, [_li([nsGmx.Utils._div([_t(sTotalListName)], [['dir', 'className', 'SearchTotalHeader']]), ulSearch])]);\r\n\t\t}\r\n\r\n        if (typeof($.fn.treeview) === 'function') {\r\n            $(oResultCanvas).treeview();\r\n        }\r\n\r\n\t\t$(oResultCanvas).find(\".SearchResultListChildsCanvas\").each(function() {\r\n\t\t\tthis.parentNode.style.padding = '0px';\r\n\t\t\tthis.parentNode.style.background = 'none';\r\n\t\t})\r\n\t}\r\n\r\n\r\n    /**Создается переключатель страниц\r\n    @param results - набор результатов\r\n    @param onclick - обработчик нажатия переключателя страниц\r\n    @returns {void}*/\r\n    this.CreatePager = function (results, onclick) {\r\n\r\n        function makeNavigButton(pager, img, imga, id, title) {\r\n            var b = makeImageButton(sImagesHost + img, sImagesHost + imga);\r\n            b.style.marginBottom = '-7px';\r\n            $(b).attr('id', id)\r\n            nsGmx.Utils._title(b, title);\r\n            nsGmx.Utils._(pager, [b]);\r\n            return b;\r\n        }\r\n\r\n        var containerList = Container;\r\n        $('#respager').remove();\r\n        //var pager = nsGmx.Utils._div([_t('всего: ' + results[0].ResultsCount)], [[\"attr\", \"id\", \"respager\"]]);\r\n        var pager = nsGmx.Utils._div([_t('')], [[\"attr\", \"id\", \"respager\"]]);\r\n        nsGmx.Utils._(containerList, [pager]);\r\n\r\n        var pcount = results[0].SearchResult[0] ? Math.ceil(results[0].SearchResult[0].OneOf / iLimit) : 0;\r\n        if (pcount > 1) {\r\n            var first = makeNavigButton(pager, '/first.png', '/first_a.png', 'firstpage', _gtxt('Первая страница'));\r\n            $(first).bind('click', function () {\r\n                fnShowPage(0);\r\n            });\r\n            var prev = makeNavigButton(pager, '/prev.png', '/prev_a.png', 'prevpages', _gtxt('Предыдущие [value0] страниц', iPagesCount));\r\n            $(prev).bind('click', function () {\r\n                fnShowPage(parseInt($('#page1').text()) - iPagesCount - 1);\r\n            });\r\n            $(first).hide();\r\n            $(prev).hide();\r\n\r\n            for (var i = 0; i < iPagesCount && i < pcount; ++i) {\r\n                var pagelink = makeLinkButton(i + 1);\r\n                $(pagelink).attr('id', 'page' + (i + 1));\r\n                if (i == 0){\r\n                    $(pagelink).attr('class', 'page')\r\n                    attachEffects(pagelink, '');\r\n                }\r\n                $(pagelink).bind('click', onclick);\r\n                nsGmx.Utils._(pager, [pagelink, _t(' ')]);\r\n            }\r\n\r\n            var remains = pcount % iPagesCount;\r\n            var nextPages = pcount/iPagesCount<2 ? remains : iPagesCount\r\n            var nextButTitle = 'Следующие [value0] страниц';\r\n            if (nextPages == 1)\r\n                nextButTitle = 'Следующая страница';\r\n            if (nextPages % 10 == 1 && nextPages != 1 && nextPages != 11)\r\n                nextButTitle = 'Следующая [value0] страница';\r\n            if (1 < nextPages % 10 && nextPages % 10 < 5 && (nextPages<10 || nextPages > 20))\r\n                nextButTitle = 'Следующие [value0] страницы';\r\n            var next = makeNavigButton(pager, '/next.png', '/next_a.png', 'nextpages', _gtxt(nextButTitle, nextPages));\r\n            $(next).bind('click', function () {\r\n                fnShowPage(parseInt($('#page' + iPagesCount).text()));\r\n            });\r\n            var last = makeNavigButton(pager, '/last.png', '/last_a.png', 'lastpage', _gtxt('Последняя страница'));\r\n            $(last).bind('click', function () {\r\n                var lastindex = (remains == 0 ? iPagesCount : remains)\r\n                fnShowPage(pcount - lastindex, $('#page' + lastindex));\r\n            });\r\n\r\n            if (iPagesCount >= pcount) {\r\n                $(next).hide();\r\n                $(last).hide();\r\n            }\r\n        }\r\n\r\n        var fnShowPage = function (n, active) {\r\n            //alert(n + \"\\n\" + pcount);\r\n            for (var i = 0; i < iPagesCount; ++i) {//pcount\r\n                if (i + n < pcount) {\r\n                    $('#page' + (i + 1)).text(i + n + 1);\r\n                    $('#page' + (i + 1)).show();\r\n                }\r\n                else\r\n                    $('#page' + (i + 1)).hide();\r\n            }\r\n\r\n            if (n < iPagesCount) {\r\n                $('#prevpages').hide(); $('#firstpage').hide();\r\n            }\r\n            else {\r\n                $('#prevpages').show(); $('#firstpage').show();\r\n            }\r\n\r\n            if (n + iPagesCount < pcount) {\r\n                $('#nextpages').show(); $('#lastpage').show();\r\n                var rest = pcount - n - iPagesCount;\r\n                var nextPages = rest < iPagesCount ? rest : iPagesCount\r\n                var nextButTitle = 'Следующие [value0] страниц';\r\n                if (nextPages == 1)\r\n                    nextButTitle = 'Следующая страница';\r\n                if (nextPages % 10 == 1 && nextPages != 1 && nextPages != 11)\r\n                    nextButTitle = 'Следующая [value0] страница';\r\n                if (1 < nextPages % 10 && nextPages % 10 < 5 && (nextPages < 10 || nextPages > 20))\r\n                    nextButTitle = 'Следующие [value0] страницы';\r\n                $('#nextpages').attr('title', _gtxt(nextButTitle, nextPages));\r\n            }\r\n            else {\r\n                $('#nextpages').hide(); $('#lastpage').hide();\r\n            }\r\n\r\n            if (active == null) active = $('#prevpages~span')[0];\r\n            $(active).trigger('click');\r\n        }\r\n    }\r\n    /*----------------------------------------------------------*/\r\n\r\n\t/**Возвращает список объектов, которые отображаются на текущей странице во всех разделах*/\r\n\tthis.GetDisplayedObjects = function(){return arrDisplayedObjects; };\r\n\tvar SetDisplayedObjects = function(iDataSourceN, value) {\r\n\t\tarrDisplayedObjects[iDataSourceN] = value;\r\n\r\n\t\t/** Вызывается при изменении отображаемого списка найденных объектов(ведь они отображаются не все)\r\n\t\t@name Search.ResultList.onDisplayedObjectsChanged\r\n\t\t@event\r\n\t\t@param {int} iDataSourceN № источника данных(группы результатов поиска)\r\n\t\t@param {object[]} arrDSDisplayedObjects Результаты поиска, которые необходимо отобразить в текущей группе*/\r\n\t\t$(_this).triggerHandler('onDisplayedObjectsChanged',[iDataSourceN, arrDisplayedObjects[iDataSourceN]]);\r\n\t};\r\n\r\n\t/** Показывает режим загрузки\r\n\t@returns {void}*/\r\n\tthis.ShowLoading = function(){\r\n\t    $('#respager').remove();\r\n        $(oResultCanvas).empty();\r\n        // Container.appendChild(oResultCanvas);\r\n\t\tnsGmx.Utils._(oResultCanvas, [oLoading]);\r\n\t}\r\n\r\n\t/**Показывает сообщение об ошибке\r\n\t@returns {void}*/\r\n\tthis.ShowError = function(){\r\n\t\t$(oResultCanvas).empty();\r\n\t\tnsGmx.Utils._(oResultCanvas, [_t(\"Произошла ошибка\")]);\r\n\t}\r\n\r\n\t/**Очищает результаты поиска\r\n\t@returns {void}*/\r\n\tthis.Unload = function(){unload();};\r\n\t/** Возвращает контрол, в котором находится данный контрол*/\r\n\tthis.getContainer = function(){return Container;};\r\n};\r\n\r\nnsGmx.SearchLogic = function () {};\r\n\r\nnsGmx.SearchLogic.prototype = {\r\n    init: function (params) {\r\n        this.oMenu = params.oMenu || new leftMenu();\r\n        this.oRenderer = new ResultRenderer(nsGmx.leafletMap, imagesHost, true);\r\n        this.oSearchResultDiv = document.createElement('div');\r\n        this.searchByStringHooks = [];\r\n        \r\n        this.oSearchResultDiv.className = 'ddfdfdf';\r\n        this.oSearchResultDiv.title = window._gtxt('Изменить параметры поиска');\r\n\r\n        var fnBeforeSearch = function(){\r\n            /** Вызывается перед началом поиска\r\n            @name Search.SearchGeomixer.onBeforeSearch\r\n            @event */\r\n            $(this.oSearchResultDiv).triggerHandler('onBeforeSearch');\r\n            this.fnLoad();\r\n        }\r\n        var fnAfterSearch = function(){\r\n            /** Вызывается после окончания поиска\r\n            @name Search.SearchGeomixer.onAfterSearch\r\n            @event */\r\n            $(this.oSearchResultDiv).triggerHandler('onAfterSearch');\r\n        }\r\n        var onDisplayedObjectsChanged = function(event, iDataSourceN, arrFoundObjects){\r\n            /** Вызывается при изменении отображаемого списка найденных объектов(ведь они отображаются не все)\r\n            @name Search.SearchGeomixer.onDisplayedObjectsChanged\r\n            @event\r\n            @param {int} iDataSourceN № источника данных(группы результатов поиска)\r\n            @param {object[]} arrDSDisplayedObjects Результаты поиска, которые необходимо отобразить в текущей группе*/\r\n            $(this.oSearchResultDiv).triggerHandler('onDisplayedObjectsChanged', [iDataSourceN, arrFoundObjects]);\r\n        }\r\n        var onObjectClick = function(event, oFoundObject){\r\n            /** Вызывается при клике на найденный объект в списке результатов поиска\r\n            @name Search.SearchGeomixer.onObjectClick\r\n            @event\r\n            @param {object} oFoundObject Найденный объект*/\r\n            $(this.oSearchResultDiv).triggerHandler('onObjectClick', [oFoundObject]);\r\n        };\r\n        $(this.oSearchResultDiv).bind('onBeforeSearch', fnBeforeSearch);\r\n        $(this.oSearchResultDiv).bind('onAfterSearch', fnAfterSearch);\r\n        $(this.oSearchResultDiv).bind('onDisplayedObjectsChanged', onDisplayedObjectsChanged);\r\n        $(this.oSearchResultDiv).bind('onObjectClick', onObjectClick);\r\n\r\n        // coordinates search hook\r\n        this.addSearchByStringHook(function(searchString) {\r\n            var pos = L.gmxUtil.parseCoordinates(searchString);\r\n            if (pos) {\r\n                nsGmx.leafletMap.panTo(pos);\r\n\r\n                // Добавим иконку по умолчанию\r\n                // L.Icon.Default.imagePath = 'leaflet/images';\r\n                nsGmx.leafletMap.gmxDrawing.add(L.marker(pos, { draggable: true, title: searchString }));\r\n\r\n                // Либо задать свою иконку\r\n                // map.gmxDrawing.add(L.marker(pos, {\r\n                    // draggable: true, title: searchString,\r\n                    // icon: L.icon({ iconUrl: 'img/flag_blau1.png', iconAnchor: [6, 36] })\r\n                // }));\r\n\r\n                //map.moveTo(pos[0], pos[1], map.getZ());\r\n                //map.drawing.addObject({ type: \"POINT\", coordinates: pos }, { text: searchString });\r\n                return true;\r\n            }\r\n        })\r\n    },\r\n\r\n    fnLoad: function(){\r\n        if (this.oMenu != null){\r\n            var alreadyLoaded = this.oMenu.createWorkCanvas(\"search\", this.fnUnload.bind(this));\r\n            if (!alreadyLoaded) {\r\n                this.oMenu.workCanvas.appendChild(this.oSearchResultDiv);\r\n            }\r\n            $(this.oSearchResultDiv).empty();\r\n        }\r\n    },\r\n\r\n    fnUnload: function () {\r\n        if (this.lstResult) {\r\n            this.lstResult.Unload();\r\n        }\r\n    },\r\n\r\n    showResult: function (response) {\r\n        var _this = this;\r\n        var searchString = response.searchString || '';\r\n        if (searchString) {\r\n            for (var h = 0; h < this.searchByStringHooks.length; h++) {\r\n                if (this.searchByStringHooks[h].hook(searchString)) {\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        this.fnLoad();\r\n        this.lstResult = new ResultList(this.oSearchResultDiv, this.oRenderer, imagesHost);\r\n        this.lstResult.ShowLoading();\r\n        this.lstResult.ShowResult(searchString, response, {page: 0});\r\n        this.lstResult.CreatePager(response, function (e) {\r\n            var evt = e || window.event,\r\n                active = evt.srcElement || evt.target,\r\n                activePage = parseInt($(this).text()) - 1;\r\n\r\n            $('#prevpages~span:visible').attr('class', 'buttonLink');\r\n            for (var i = 0; i < $('#prevpages~span:visible').length; ++i) attachEffects($('#prevpages~span:visible')[i], 'buttonLinkHover');\r\n            $(active).attr('class', 'page');\r\n            attachEffects(active, '');\r\n\r\n            _this.lstResult.ShowResult(searchString, response, {page: activePage});\r\n        });\r\n    },\r\n\r\n    addSearchByStringHook: function (hook, priority) {\r\n        var _this = this;\r\n        this.searchByStringHooks.push({\r\n            hook: hook,\r\n            priority: priority || 0,\r\n            index: _this.searchByStringHooks.length\r\n        });\r\n\r\n        this.searchByStringHooks.sort(function(a, b) {\r\n            return b.priority - a.priority || a.index - b.index;\r\n        })\r\n    },\r\n\r\n    removeSearchByStringHook: function(hook) {\r\n        for (var h = 0; h < this.searchByStringHooks.length; h++) {\r\n            if (this.searchByStringHooks[h].hook === hook) {\r\n                this.searchByStringHooks.splice(h, 1);\r\n                return;\r\n            }\r\n        }\r\n    },\r\n\r\n    layersSearch: function (res) {        \r\n        if (!nsGmx.gmxMap){\r\n            return new Promise (function (resolve, reject) {\r\n                reject(res);\r\n            });            \r\n        }\r\n\r\n        var promisesArr = [];\r\n\r\n        var layersToSearch = [];\r\n        for (var i=0; i< nsGmx.gmxMap.layers.length; i++) {\r\n            //свойства мы берём из дерева слоёв, а не из API. Cвойство AllowSearch относится к карте и не поддерживаются API\r\n            var searchRes = window._layersTree.treeModel.findElem('name', nsGmx.gmxMap.layers[i].getGmxProperties().name);\r\n\r\n            if (searchRes) {\r\n                var props = searchRes.elem.content.properties;\r\n\r\n                if (props.type == \"Vector\" && props.AllowSearch) {\r\n                    layersToSearch.push(props);\r\n                }\r\n            }\r\n        }\r\n        var iRespCount = 0;\r\n\r\n        if (layersToSearch.length > 0) {\r\n            layersToSearch.forEach(function(props) {\r\n                var mapName = nsGmx.gmxMap.layersByID[props.name].options.mapID;\r\n                var url = window.serverBase + \"SearchObject/SearchVector.ashx\" +\r\n                    \"?LayerNames=\" + props.name +\r\n                    \"&MapName=\" + mapName +\r\n                    \"&SearchString=\" + encodeURIComponent(res.Result.searchString);\r\n\r\n                var promise = new Promise(function(resolve, reject) {\r\n                    var req = new XMLHttpRequest();\r\n                    req.withCredentials = true;\r\n                    req.open('GET', url);\r\n\r\n                    req.onload = function() {\r\n                if (req.status == 200) {\r\n                    var res = handleResponse(req.response, props);\r\n\r\n                    res.then(function (res2) {\r\n                        resolve(res2);\r\n                    });\r\n                } else {\r\n                      reject(Error(req.statusText));\r\n                    }\r\n                  };\r\n                  req.onerror = function() {\r\n                    reject(Error(\"Network Error\"));\r\n                  };\r\n\r\n                  req.send();\r\n                });\r\n\r\n                promisesArr.push(promise);\r\n            });\r\n\r\n            return Promise.all(promisesArr);\r\n        } else {\r\n            return new Promise(function(resolve) {\r\n                resolve(res);\r\n            })\r\n        }\r\n\r\n        function handleResponse(searchReq, layerProps) {\r\n            searchReq = typeof searchReq === 'string' ? JSON.parse(searchReq.substring(1, searchReq.length - 1)) : searchReq;\r\n            iRespCount++;\r\n            var arrLayerResult = [];\r\n            var arrResult = [];\r\n            var arrDisplayFields = null;\r\n            if (searchReq.Status == 'ok') {\r\n                for (var iServer = 0; iServer < searchReq.Result.length; iServer++)\r\n                {\r\n                    var limitSearchResults = typeof(window.LayerSearchLimit)==\"number\" ? window.LayerSearchLimit : 100;\r\n                    var req = searchReq.Result[iServer];\r\n                    for (var j = 0; j<limitSearchResults && j < req.SearchResult.length; j++)\r\n                    {\r\n                        var arrDisplayProperties = {};\r\n                        if (!arrDisplayFields) {\r\n                            arrDisplayProperties = req.SearchResult[j].properties;\r\n                        }\r\n                        else {\r\n                            for (var iProperty=0; iProperty<arrDisplayFields.length; iProperty++){\r\n                                var sPropName = arrDisplayFields[iProperty];\r\n                                if (sPropName in req.SearchResult[j].properties) {\r\n                                    arrDisplayProperties[sPropName] = req.SearchResult[j].properties[sPropName];\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        for (var p in arrDisplayProperties) {\r\n                            var type = layerProps.attrTypes[layerProps.attributes.indexOf(p)];\r\n                            arrDisplayProperties[p] = nsGmx.Utils.convertFromServer(type, arrDisplayProperties[p]);\r\n                        }\r\n\r\n                        arrLayerResult.push({\r\n                            ObjName: req.SearchResult[j].properties.NAME || req.SearchResult[j].properties.Name || req.SearchResult[j].properties.name || req.SearchResult[j].properties.text || req.SearchResult[j].properties[\"Название\"] || \"[объект]\",\r\n                            properties: arrDisplayProperties,\r\n                            Geometry: L.gmxUtil.convertGeometry(req.SearchResult[j].geometry, true)\r\n                        });\r\n                    }\r\n                }\r\n                if (arrLayerResult.length > 0) arrResult.push({name: layerProps.title, SearchResult: arrLayerResult, CanDownloadVectors: true});\r\n\r\n                if (iRespCount == layersToSearch.length){\r\n                    // return arrResult;\r\n                }\r\n                return Promise.resolve(arrResult);\r\n            } else {\r\n                return Promise.reject(searchReq);\r\n            }\r\n        }\r\n    }\r\n}\r\n","'use strict';\r\n\r\nObject.defineProperty(exports, '__esModule', { value: true });\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError(\"Cannot call a class as a function\");\r\n  }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n  for (var i = 0; i < props.length; i++) {\r\n    var descriptor = props[i];\r\n    descriptor.enumerable = descriptor.enumerable || false;\r\n    descriptor.configurable = true;\r\n    if (\"value\" in descriptor) descriptor.writable = true;\r\n    Object.defineProperty(target, descriptor.key, descriptor);\r\n  }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\r\n  if (staticProps) _defineProperties(Constructor, staticProps);\r\n  return Constructor;\r\n}\r\n\r\nfunction _inherits(subClass, superClass) {\r\n  if (typeof superClass !== \"function\" && superClass !== null) {\r\n    throw new TypeError(\"Super expression must either be null or a function\");\r\n  }\r\n\r\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\r\n    constructor: {\r\n      value: subClass,\r\n      writable: true,\r\n      configurable: true\r\n    }\r\n  });\r\n  if (superClass) _setPrototypeOf(subClass, superClass);\r\n}\r\n\r\nfunction _getPrototypeOf(o) {\r\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\r\n    return o.__proto__ || Object.getPrototypeOf(o);\r\n  };\r\n  return _getPrototypeOf(o);\r\n}\r\n\r\nfunction _setPrototypeOf(o, p) {\r\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\r\n    o.__proto__ = p;\r\n    return o;\r\n  };\r\n\r\n  return _setPrototypeOf(o, p);\r\n}\r\n\r\nfunction _assertThisInitialized(self) {\r\n  if (self === void 0) {\r\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\r\n  }\r\n\r\n  return self;\r\n}\r\n\r\nfunction _possibleConstructorReturn(self, call) {\r\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\r\n    return call;\r\n  }\r\n\r\n  return _assertThisInitialized(self);\r\n}\r\n\r\nfunction _slicedToArray(arr, i) {\r\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\r\n}\r\n\r\nfunction _arrayWithHoles(arr) {\r\n  if (Array.isArray(arr)) return arr;\r\n}\r\n\r\nfunction _iterableToArrayLimit(arr, i) {\r\n  var _arr = [];\r\n  var _n = true;\r\n  var _d = false;\r\n  var _e = undefined;\r\n\r\n  try {\r\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\r\n      _arr.push(_s.value);\r\n\r\n      if (i && _arr.length === i) break;\r\n    }\r\n  } catch (err) {\r\n    _d = true;\r\n    _e = err;\r\n  } finally {\r\n    try {\r\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\r\n    } finally {\r\n      if (_d) throw _e;\r\n    }\r\n  }\r\n\r\n  return _arr;\r\n}\r\n\r\nfunction _nonIterableRest() {\r\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\r\n}\r\n\r\nvar classCallCheck = function (instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError(\"Cannot call a class as a function\");\r\n  }\r\n};\r\n\r\nvar createClass = function () {\r\n  function defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n      var descriptor = props[i];\r\n      descriptor.enumerable = descriptor.enumerable || false;\r\n      descriptor.configurable = true;\r\n      if (\"value\" in descriptor) descriptor.writable = true;\r\n      Object.defineProperty(target, descriptor.key, descriptor);\r\n    }\r\n  }\r\n\r\n  return function (Constructor, protoProps, staticProps) {\r\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\r\n    if (staticProps) defineProperties(Constructor, staticProps);\r\n    return Constructor;\r\n  };\r\n}();\r\n\r\nvar EventTarget = function () {\r\n    function EventTarget() {\r\n        classCallCheck(this, EventTarget);\r\n\r\n        this.listeners = {};\r\n    }\r\n\r\n    createClass(EventTarget, [{\r\n        key: 'addEventListener',\r\n        value: function addEventListener(type, callback) {\r\n            if (!(type in this.listeners)) {\r\n                this.listeners[type] = [];\r\n            }\r\n            this.listeners[type].push(callback);\r\n        }\r\n    }, {\r\n        key: 'on',\r\n        value: function on(type, callback) {\r\n            this.addEventListener(type, callback);\r\n            return this;\r\n        }\r\n    }, {\r\n        key: 'removeEventListener',\r\n        value: function removeEventListener(type, callback) {\r\n            if (!(type in this.listeners)) {\r\n                return;\r\n            }\r\n            var stack = this.listeners[type];\r\n            for (var i = 0, l = stack.length; i < l; i++) {\r\n                if (stack[i] === callback) {\r\n                    stack.splice(i, 1);\r\n                    return this.removeEventListener(type, callback);\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: 'off',\r\n        value: function off(type, callback) {\r\n            this.removeEventListener(type, callback);\r\n            return this;\r\n        }\r\n    }, {\r\n        key: 'dispatchEvent',\r\n        value: function dispatchEvent(event) {\r\n            if (!(event.type in this.listeners)) {\r\n                return;\r\n            }\r\n            var stack = this.listeners[event.type];\r\n            Object.defineProperty(event, 'target', {\r\n                enumerable: false,\r\n                configurable: false,\r\n                writable: false,\r\n                value: this\r\n            });\r\n            for (var i = 0, l = stack.length; i < l; i++) {\r\n                stack[i].call(this, event);\r\n            }\r\n        }\r\n    }]);\r\n    return EventTarget;\r\n}();\r\n\r\nvar scanexEventTarget_cjs = EventTarget;\r\n\r\nvar ResultView =\r\n/*#__PURE__*/\r\nfunction (_EventTarget) {\r\n  _inherits(ResultView, _EventTarget);\r\n\r\n  function ResultView(_ref) {\r\n    var _this;\r\n\r\n    var input = _ref.input,\r\n        _ref$replaceInput = _ref.replaceInput,\r\n        replaceInput = _ref$replaceInput === void 0 ? false : _ref$replaceInput;\r\n\r\n    _classCallCheck(this, ResultView);\r\n\r\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ResultView).call(this));\r\n    _this._input = input;\r\n    _this.index = -1;\r\n    _this.count = 0;\r\n    _this._item = null;\r\n    _this._inputText = '';\r\n    _this._replaceInput = replaceInput;\r\n    _this._list = L.DomUtil.create('div');\r\n\r\n    _this._list.setAttribute('class', 'leaflet-ext-search-list noselect');\r\n\r\n    _this.allowNavigation = true;\r\n    _this._list.style.top = \"\".concat(_this._input.offsetTop + _this._input.offsetHeight + 2, \"px\");\r\n    _this._list.style.left = \"\".concat(_this._input.offsetLeft, \"px\");\r\n    _this._handleKey = _this._handleKey.bind(_assertThisInitialized(_this));\r\n\r\n    _this._input.addEventListener('keydown', _this._handleKey);\r\n\r\n    _this._handleInputClick = _this._handleInputClick.bind(_assertThisInitialized(_this));\r\n\r\n    _this._input.addEventListener('click', _this._handleInputClick);\r\n\r\n    _this._handleFocus = _this._handleFocus.bind(_assertThisInitialized(_this));\r\n\r\n    _this._input.addEventListener('focus', _this._handleFocus);\r\n\r\n    _this._list.addEventListener('keydown', _this._handleKey);\r\n\r\n    _this._handleWheel = _this._handleWheel.bind(_assertThisInitialized(_this));\r\n\r\n    _this._list.addEventListener('wheel', _this._handleWheel);\r\n\r\n    L.DomEvent.disableClickPropagation(_this._list).disableScrollPropagation(_this._list); // this._list.addEventListener('mousewheel', this._handleWheel.bind(this));\r\n    // this._list.addEventListener('MozMousePixelScroll', this._handleWheel.bind(this));       \r\n\r\n    _this._input.parentElement.appendChild(_this._list);\r\n\r\n    _this._handleChange = _this._handleChange.bind(_assertThisInitialized(_this));\r\n\r\n    _this._input.addEventListener('input', _this._handleChange);\r\n\r\n    return _this;\r\n  }\r\n\r\n  _createClass(ResultView, [{\r\n    key: \"_handleInputClick\",\r\n    value: function _handleInputClick(e) {\r\n      e.stopPropagation();\r\n    }\r\n  }, {\r\n    key: \"_handleFocus\",\r\n    value: function _handleFocus(e) {\r\n      if (this.index >= 0) {\r\n        var el = this._list.querySelector(\"[tabindex=\\\"\".concat(this.index, \"\\\"]\"));\r\n\r\n        L.DomUtil.removeClass(el, 'leaflet-ext-search-list-selected');\r\n      }\r\n\r\n      this.index = -1;\r\n      this._item = null;\r\n    }\r\n  }, {\r\n    key: \"_handleChange\",\r\n    value: function _handleChange(e) {\r\n      this._inputText = this._input.value;\r\n    }\r\n  }, {\r\n    key: \"_handleWheel\",\r\n    value: function _handleWheel(e) {\r\n      e.stopPropagation();\r\n    }\r\n  }, {\r\n    key: \"_handleKey\",\r\n    value: function _handleKey(e) {\r\n      if (this.listVisible()) {\r\n        switch (e.keyCode) {\r\n          // ArroLeft / ArrowRight\r\n          case 37:\r\n          case 39:\r\n            e.stopPropagation();\r\n            break;\r\n          // ArrowDown\r\n\r\n          case 40:\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            if (this.allowNavigation) {\r\n              if (this.index < 0) {\r\n                this.index = 0;\r\n              } else if (0 <= this.index && this.index < this.count - 1) {\r\n                var _el = this._list.querySelector(\"[tabindex=\\\"\".concat(this.index, \"\\\"]\"));\r\n\r\n                L.DomUtil.removeClass(_el, 'leaflet-ext-search-list-selected');\r\n                ++this.index;\r\n              } else {\r\n                var _el2 = this._list.querySelector(\"[tabindex=\\\"\".concat(this.index, \"\\\"]\"));\r\n\r\n                L.DomUtil.removeClass(_el2, 'leaflet-ext-search-list-selected');\r\n                this.index = this.count - 1;\r\n              }\r\n\r\n              var el = this._list.querySelector(\"[tabindex=\\\"\".concat(this.index, \"\\\"]\"));\r\n\r\n              L.DomUtil.addClass(el, 'leaflet-ext-search-list-selected');\r\n              this.selectItem(this.index);\r\n              el.focus();\r\n            }\r\n\r\n            break;\r\n          // ArrowUp\r\n\r\n          case 38:\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            if (this.allowNavigation) {\r\n              if (this.index > 0) {\r\n                var _el3 = this._list.querySelector(\"[tabindex=\\\"\".concat(this.index, \"\\\"]\"));\r\n\r\n                L.DomUtil.removeClass(_el3, 'leaflet-ext-search-list-selected');\r\n                --this.index;\r\n                _el3 = this._list.querySelector(\"[tabindex=\\\"\".concat(this.index, \"\\\"]\"));\r\n                L.DomUtil.addClass(_el3, 'leaflet-ext-search-list-selected');\r\n                this.selectItem(this.index);\r\n\r\n                _el3.focus();\r\n              } else if (this.index === 0) {\r\n                this._input.focus();\r\n\r\n                this._input.value = this._inputText;\r\n              }\r\n            }\r\n\r\n            break;\r\n          // Enter\r\n\r\n          case 13:\r\n            if (this.index < 0 && this._input.value) {\r\n              var text = this._input.value;\r\n\r\n              this._input.focus();\r\n\r\n              this._input.setSelectionRange(text.length, text.length);\r\n\r\n              this.hide();\r\n              var event = document.createEvent('Event');\r\n              event.initEvent('suggestions:confirm', false, false);\r\n              event.detail = text;\r\n              this.dispatchEvent(event);\r\n            } else {\r\n              this.complete(this.index);\r\n            }\r\n\r\n            break;\r\n          // Escape\r\n\r\n          case 27:\r\n            if (this.index < 0) {\r\n              this.hide();\r\n            }\r\n\r\n            this._input.focus();\r\n\r\n            this._input.value = this._inputText;\r\n            break;\r\n\r\n          default:\r\n            break;\r\n        }\r\n      } else {\r\n        if (e.keyCode === 13 && this._input.value) {\r\n          var _text = this._input.value;\r\n\r\n          this._input.setSelectionRange(_text.length, _text.length);\r\n\r\n          var _event = document.createEvent('Event');\r\n\r\n          _event.initEvent('suggestions:confirm', false, false);\r\n\r\n          _event.detail = _text;\r\n          this.dispatchEvent(_event);\r\n        } else if (e.keyCode === 27) {\r\n          this._input.value = '';\r\n          this.index = -1;\r\n\r\n          this._input.focus();\r\n        }\r\n      }\r\n    }\r\n  }, {\r\n    key: \"listVisible\",\r\n    value: function listVisible() {\r\n      return this.count > 0 && this._list.style.display !== 'none';\r\n    }\r\n  }, {\r\n    key: \"selectItem\",\r\n    value: function selectItem(i) {\r\n      this._item = this._items[i];\r\n      var text = this._item.name;\r\n\r\n      if (this._replaceInput) {\r\n        this._input.value = text;\r\n\r\n        this._input.setSelectionRange(text.length, text.length);\r\n      }\r\n    }\r\n  }, {\r\n    key: \"_handleClick\",\r\n    value: function _handleClick(i, e) {\r\n      e.preventDefault();\r\n      this.complete(i);\r\n    }\r\n  }, {\r\n    key: \"complete\",\r\n    value: function complete(i) {\r\n      var item = i >= 0 ? this._items[i] : this._item ? this._item : null;\r\n\r\n      if (item) {\r\n        this._item = item;\r\n        this.index = -1;\r\n        var text = item.name;\r\n\r\n        if (this._replaceInput) {\r\n          this._input.value = text;\r\n\r\n          this._input.setSelectionRange(text.length, text.length);\r\n        }\r\n\r\n        this._input.focus();\r\n\r\n        this.hide();\r\n        var event = document.createEvent('Event');\r\n        event.initEvent('suggestions:select', false, false);\r\n        event.detail = item;\r\n        this.dispatchEvent(event);\r\n      }\r\n    }\r\n  }, {\r\n    key: \"show\",\r\n    value: function show(items, highlight) {\r\n      if (items.length) {\r\n        this._item = null;\r\n        this.index = -1;\r\n        this._items = items;\r\n        var html = '<ul>' + this._items.filter(function (x) {\r\n          return x.name && x.name.length;\r\n        }).map(function (x, i) {\r\n          var name = \"<span class=\\\"leaflet-ext-search-list-item-normal\\\">\".concat(x.name, \"</span>\");\r\n\r\n          if (highlight && highlight.length) {\r\n            var start = x.name.toLowerCase().indexOf(highlight.toLowerCase());\r\n\r\n            if (start != -1) {\r\n              var head = x.name.substr(0, start);\r\n\r\n              if (head.length) {\r\n                head = \"<span class=\\\"leaflet-ext-search-list-item-normal\\\">\".concat(head, \"</span>\");\r\n              }\r\n\r\n              var tail = x.name.substr(start + highlight.length);\r\n\r\n              if (tail.length) {\r\n                tail = \"<span class=\\\"leaflet-ext-search-list-item-normal\\\">\".concat(tail, \"</span>\");\r\n              }\r\n\r\n              name = \"\".concat(head, \"<span class=\\\"leaflet-ext-search-list-item-highlight\\\">\").concat(highlight, \"</span>\").concat(tail);\r\n            }\r\n          }\r\n\r\n          return \"<li tabindex=\".concat(i, \">\").concat(name, \"</li>\");\r\n        }, []).join('') + '</ul>';\r\n        this._list.innerHTML = html;\r\n\r\n        var elements = this._list.querySelectorAll('li');\r\n\r\n        for (var i = 0; i < elements.length; ++i) {\r\n          elements[i].addEventListener('click', this._handleClick.bind(this, i));\r\n        }\r\n\r\n        this.count = elements.length;\r\n        this._list.style.display = 'block';\r\n      }\r\n    }\r\n  }, {\r\n    key: \"hide\",\r\n    value: function hide() {\r\n      this._list.style.display = 'none';\r\n    }\r\n  }]);\r\n\r\n  return ResultView;\r\n}(scanexEventTarget_cjs);\r\n\r\nfunction chain(tasks, state) {\r\n  return tasks.reduce(function (prev, next) {\r\n    return prev.then(next);\r\n  }, new Promise(function (resolve, reject) {\r\n    return resolve(state);\r\n  }));\r\n}\r\n\r\nvar SearchWidget =\r\n/*#__PURE__*/\r\nfunction (_EventTarget) {\r\n  _inherits(SearchWidget, _EventTarget);\r\n\r\n  function SearchWidget(container, _ref) {\r\n    var _this;\r\n\r\n    var placeHolder = _ref.placeHolder,\r\n        providers = _ref.providers,\r\n        _ref$suggestionTimeou = _ref.suggestionTimeout,\r\n        suggestionTimeout = _ref$suggestionTimeou === void 0 ? 1000 : _ref$suggestionTimeou,\r\n        _ref$suggestionLimit = _ref.suggestionLimit,\r\n        suggestionLimit = _ref$suggestionLimit === void 0 ? 10 : _ref$suggestionLimit,\r\n        _ref$fuzzySearchLimit = _ref.fuzzySearchLimit,\r\n        fuzzySearchLimit = _ref$fuzzySearchLimit === void 0 ? 1000 : _ref$fuzzySearchLimit,\r\n        _ref$retrieveManyOnEn = _ref.retrieveManyOnEnter,\r\n        retrieveManyOnEnter = _ref$retrieveManyOnEn === void 0 ? false : _ref$retrieveManyOnEn,\r\n        _ref$replaceInputOnEn = _ref.replaceInputOnEnter,\r\n        replaceInputOnEnter = _ref$replaceInputOnEn === void 0 ? false : _ref$replaceInputOnEn;\r\n\r\n    _classCallCheck(this, SearchWidget);\r\n\r\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SearchWidget).call(this));\r\n    _this._container = container;\r\n    _this._allowSuggestion = true;\r\n    _this._providers = providers;\r\n    _this._suggestionTimeout = suggestionTimeout;\r\n    _this._suggestionLimit = suggestionLimit;\r\n    _this._fuzzySearchLimit = fuzzySearchLimit;\r\n    _this._retrieveManyOnEnter = retrieveManyOnEnter;\r\n    _this._replaceInputOnEnter = replaceInputOnEnter;\r\n\r\n    _this._container.classList.add('leaflet-ext-search');\r\n\r\n    _this._container.innerHTML = \"<input type=\\\"text\\\" value=\\\"\\\" placeholder=\\\"\".concat(placeHolder, \"\\\" /><span class=\\\"leaflet-ext-search-button\\\"></span>\");\r\n    _this._input = _this._container.querySelector('input');\r\n    _this._handleChange = _this._handleChange.bind(_assertThisInitialized(_this));\r\n\r\n    _this._input.addEventListener('input', _this._handleChange);\r\n\r\n    _this._handleMouseMove = _this._handleMouseMove.bind(_assertThisInitialized(_this));\r\n\r\n    _this._input.addEventListener('mousemove', _this._handleMouseMove);\r\n\r\n    _this._input.addEventListener('dragstart', _this._handleMouseMove);\r\n\r\n    _this._input.addEventListener('drag', _this._handleMouseMove);\r\n\r\n    _this._handleSearch = _this._handleSearch.bind(_assertThisInitialized(_this));\r\n    _this._button = _this._container.querySelector('.leaflet-ext-search-button');\r\n\r\n    _this._button.addEventListener('click', _this._handleSearch);\r\n\r\n    _this.results = new ResultView({\r\n      input: _this._input,\r\n      replaceInput: _this._replaceInputOnEnter\r\n    });\r\n    _this._search = _this._search.bind(_assertThisInitialized(_this));\r\n    _this._selectItem = _this._selectItem.bind(_assertThisInitialized(_this));\r\n\r\n    _this.results.addEventListener('suggestions:confirm', function (e) {\r\n      var event = document.createEvent('Event');\r\n      event.initEvent('suggestions:confirm', false, false);\r\n      event.detail = e.detail;\r\n\r\n      _this.dispatchEvent(event);\r\n\r\n      _this._search(e);\r\n    });\r\n\r\n    _this.results.addEventListener('suggestions:select', _this._selectItem); // map.on ('click', this.results.hide.bind(this.results));\r\n    // map.on ('dragstart', this.results.hide.bind(this.results));\r\n\r\n\r\n    return _this;\r\n  }\r\n\r\n  _createClass(SearchWidget, [{\r\n    key: \"_suggest\",\r\n    value: function _suggest(text) {\r\n      var _this2 = this;\r\n\r\n      this.results.allowNavigation = false;\r\n\r\n      var tasks = this._providers.filter(function (provider) {\r\n        return provider.showSuggestion;\r\n      }).map(function (provider) {\r\n        return function (state) {\r\n          return new Promise(function (resolve) {\r\n            if (state.completed) {\r\n              resolve(state);\r\n            } else {\r\n              provider.find(text, _this2._suggestionLimit, false, false).then(function (response) {\r\n                state.completed = response.length > 0;\r\n                state.response = state.response.concat(response);\r\n                resolve(state);\r\n              })[\"catch\"](function (e) {\r\n                return console.log(e);\r\n              });\r\n            }\r\n          });\r\n        };\r\n      });\r\n\r\n      chain(tasks, {\r\n        completed: false,\r\n        response: []\r\n      }).then(function (state) {\r\n        _this2.results.show(state.response, text.trim());\r\n\r\n        _this2.results.allowNavigation = true;\r\n      });\r\n    }\r\n  }, {\r\n    key: \"_handleChange\",\r\n    value: function _handleChange(e) {\r\n      var _this3 = this;\r\n\r\n      if (this._input.value.length) {\r\n        if (this._allowSuggestion) {\r\n          this._allowSuggestion = false;\r\n          this._timer = setTimeout(function () {\r\n            clearTimeout(_this3._timer);\r\n            _this3._allowSuggestion = true;\r\n            var text = _this3._input.value;\r\n\r\n            _this3._suggest(text);\r\n          }, this._suggestionTimeout);\r\n        }\r\n      } else {\r\n        this.results.hide();\r\n      }\r\n    }\r\n  }, {\r\n    key: \"_handleMouseMove\",\r\n    value: function _handleMouseMove(e) {\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    }\r\n  }, {\r\n    key: \"_search\",\r\n    value: function _search(e) {\r\n      var _this4 = this;\r\n\r\n      var text = e.detail;\r\n\r\n      var tasks = this._providers.filter(function (provider) {\r\n        return provider.showOnEnter;\r\n      }).map(function (provider) {\r\n        return function (state) {\r\n          return new Promise(function (resolve) {\r\n            if (state.completed) {\r\n              resolve(state);\r\n            } else {\r\n              provider.find(text, _this4._retrieveManyOnEnter ? _this4._fuzzySearchLimit : 1, true, true).then(function (response) {\r\n                state.completed = response.length > 0;\r\n                state.response = state.response.concat(response);\r\n                resolve(state);\r\n              })[\"catch\"](function (e) {\r\n                console.log(e);\r\n                resolve(state);\r\n              });\r\n            }\r\n          });\r\n        };\r\n      });\r\n\r\n      chain(tasks, {\r\n        completed: false,\r\n        response: []\r\n      }).then(function (state) {// if(state.response.length > 0 && !this._retrieveManyOnEnter){\r\n        //     let item = state.response[0];\r\n        //     item.provider\r\n        //     .fetch(item.properties)\r\n        //     .then(response => {});                    \r\n        // }\r\n      });\r\n      this.results && this.results.hide();\r\n    }\r\n  }, {\r\n    key: \"_selectItem\",\r\n    value: function _selectItem(e) {\r\n      var item = e.detail;\r\n      return item.provider.fetch(item.properties);\r\n    }\r\n  }, {\r\n    key: \"_handleSearch\",\r\n    value: function _handleSearch(e) {\r\n      e.stopPropagation();\r\n\r\n      this._search({\r\n        detail: this._input.value\r\n      });\r\n    }\r\n  }, {\r\n    key: \"setText\",\r\n    value: function setText(text) {\r\n      this._input.value = text;\r\n    }\r\n  }, {\r\n    key: \"setPlaceHolder\",\r\n    value: function setPlaceHolder(value) {\r\n      this._input.placeholder = value;\r\n    }\r\n  }]);\r\n\r\n  return SearchWidget;\r\n}(scanexEventTarget_cjs);\r\n\r\nvar SearchControl = L.Control.extend({\r\n  includes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n  initialize: function initialize(options) {\r\n    L.setOptions(this, options);\r\n    this._allowSuggestion = true;\r\n    this.options.suggestionTimeout = this.options.suggestionTimeout || 1000;\r\n    this.options.suggestionLimit = this.options.suggestionLimit || 10;\r\n  },\r\n  onAdd: function onAdd(map) {\r\n    this._container = L.DomUtil.create('div', 'leaflet-ext-search');\r\n    this._widget = new SearchWidget(this._container, this.options);\r\n    map.on('click', this._widget.results.hide.bind(this._widget.results));\r\n    map.on('dragstart', this._widget.results.hide.bind(this._widget.results));\r\n    return this._container;\r\n  },\r\n  addTo: function addTo(map) {\r\n    L.Control.prototype.addTo.call(this, map);\r\n\r\n    if (this.options.addBefore) {\r\n      this.addBefore(this.options.addBefore);\r\n    }\r\n\r\n    return this;\r\n  },\r\n  addBefore: function addBefore(id) {\r\n    var parentNode = this._parent && this._parent._container;\r\n\r\n    if (!parentNode) {\r\n      parentNode = this._map && this._map._controlCorners[this.getPosition()];\r\n    }\r\n\r\n    if (!parentNode) {\r\n      this.options.addBefore = id;\r\n    } else {\r\n      for (var i = 0, len = parentNode.childNodes.length; i < len; i++) {\r\n        var it = parentNode.childNodes[i];\r\n\r\n        if (id === it._id) {\r\n          parentNode.insertBefore(this._container, it);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    return this;\r\n  },\r\n  setText: function setText(text) {\r\n    this._widget.setText(text);\r\n  },\r\n  setPlaceHolder: function setPlaceHolder(value) {\r\n    this._widget.setPlaceHolder(value);\r\n  }\r\n});\r\n\r\nvar OsmDataProvider =\r\n/*#__PURE__*/\r\nfunction (_EventTarget) {\r\n  _inherits(OsmDataProvider, _EventTarget);\r\n\r\n  function OsmDataProvider(_ref) {\r\n    var _this;\r\n\r\n    var serverBase = _ref.serverBase;\r\n\r\n    _classCallCheck(this, OsmDataProvider);\r\n\r\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(OsmDataProvider).call(this));\r\n    _this._serverBase = serverBase;\r\n    _this.showSuggestion = true;\r\n    _this.showOnSelect = true;\r\n    _this.showOnEnter = true;\r\n    _this.find = _this.find.bind(_assertThisInitialized(_this));\r\n    _this.fetch = _this.fetch.bind(_assertThisInitialized(_this));\r\n    _this._convertGeometry = _this._convertGeometry.bind(_assertThisInitialized(_this));\r\n    _this._key = window.KOSMOSNIMKI_SESSION_KEY == null || window.KOSMOSNIMKI_SESSION_KEY == 'INVALID' ? '' : \"&key=\".concat(window.KOSMOSNIMKI_SESSION_KEY);\r\n    return _this;\r\n  }\r\n\r\n  _createClass(OsmDataProvider, [{\r\n    key: \"_convertGeometry\",\r\n    value: function _convertGeometry(geometry) {\r\n      switch (geometry.type.toUpperCase()) {\r\n        case 'POINT':\r\n          geometry.type = 'Point';\r\n          break;\r\n\r\n        case 'POLYGON':\r\n          geometry.type = 'Polygon';\r\n          break;\r\n\r\n        case 'MULTIPOLYGON':\r\n          geometry.type = 'MultiPolygon';\r\n          break;\r\n\r\n        case 'LINESTRING':\r\n        case 'POLYLINE':\r\n          geometry.type = 'LineString';\r\n          break;\r\n\r\n        case 'MULTILINESTRING':\r\n          geometry.type = 'MultiLineString';\r\n          break;\r\n\r\n        default:\r\n          throw 'Unknown WKT type';\r\n      }\r\n\r\n      return geometry;\r\n    }\r\n  }, {\r\n    key: \"fetch\",\r\n    value: function (_fetch) {\r\n      function fetch(_x) {\r\n        return _fetch.apply(this, arguments);\r\n      }\r\n\r\n      fetch.toString = function () {\r\n        return _fetch.toString();\r\n      };\r\n\r\n      return fetch;\r\n    }(function (obj) {\r\n      var _this2 = this;\r\n\r\n      var query = \"WrapStyle=None&RequestType=ID&ID=\".concat(obj.ObjCode, \"&TypeCode=\").concat(obj.TypeCode, \"&UseOSM=1\");\r\n      var req = new Request(\"\".concat(this._serverBase, \"/SearchObject/SearchAddress.ashx?\").concat(query).concat(this._key));\r\n      var headers = new Headers();\r\n      headers.append('Content-Type', 'application/json');\r\n      var init = {\r\n        method: 'GET',\r\n        mode: 'cors',\r\n        credentials: 'include',\r\n        cache: 'default'\r\n      };\r\n      return new Promise(function (resolve, reject) {\r\n        fetch(req, init).then(function (response) {\r\n          return response.json();\r\n        }).then(function (json) {\r\n          if (json.Status === 'ok') {\r\n            var rs = json.Result.reduce(function (a, x) {\r\n              return a.concat(x.SearchResult);\r\n            }, []).map(function (x) {\r\n              var g = _this2._convertGeometry(x.Geometry);\r\n\r\n              var props = Object.keys(x).filter(function (k) {\r\n                return k !== 'Geometry';\r\n              }).reduce(function (a, k) {\r\n                a[k] = x[k];\r\n                return a;\r\n              }, {});\r\n              return {\r\n                feature: {\r\n                  type: 'Feature',\r\n                  geometry: g,\r\n                  properties: props\r\n                },\r\n                provider: _this2,\r\n                query: obj\r\n              };\r\n            });\r\n            var event = document.createEvent('Event');\r\n            event.initEvent('fetch', false, false);\r\n            event.detail = rs;\r\n\r\n            _this2.dispatchEvent(event);\r\n\r\n            resolve(rs);\r\n          } else {\r\n            reject(json);\r\n          }\r\n        })[\"catch\"](function (response) {\r\n          return reject(response);\r\n        });\r\n      });\r\n    })\r\n  }, {\r\n    key: \"find\",\r\n    value: function find(value, limit, strong, retrieveGeometry) {\r\n      var _this3 = this;\r\n\r\n      return new Promise(function (resolve, reject) {\r\n        if (value || value.trim()) {\r\n          var _strong = Boolean(strong) ? 1 : 0;\r\n\r\n          var _withoutGeometry = Boolean(retrieveGeometry) ? 0 : 1;\r\n\r\n          var query = \"WrapStyle=None&RequestType=SearchObject&IsStrongSearch=\".concat(_strong, \"&WithoutGeometry=\").concat(_withoutGeometry, \"&UseOSM=1&Limit=\").concat(limit, \"&SearchString=\").concat(encodeURIComponent(value));\r\n          var req = new Request(\"\".concat(_this3._serverBase, \"/SearchObject/SearchAddress.ashx?\").concat(query).concat(_this3._key));\r\n          var headers = new Headers();\r\n          headers.append('Content-Type', 'application/json');\r\n          var init = {\r\n            method: 'GET',\r\n            mode: 'cors',\r\n            credentials: 'include',\r\n            cache: 'default'\r\n          };\r\n          fetch(req, init).then(function (response) {\r\n            return response.json();\r\n          }).then(function (json) {\r\n            if (json.Status === 'ok') {\r\n              var rs = json.Result.reduce(function (a, x) {\r\n                return a.concat(x.SearchResult);\r\n              }, []).map(function (x) {\r\n                if (retrieveGeometry && x.Geometry) {\r\n                  var g = _this3._convertGeometry(x.Geometry);\r\n\r\n                  var props = Object.keys(x).filter(function (k) {\r\n                    return k !== 'Geometry';\r\n                  }).reduce(function (a, k) {\r\n                    a[k] = x[k];\r\n                    return a;\r\n                  }, {});\r\n                  return {\r\n                    name: x.ObjNameShort,\r\n                    feature: {\r\n                      type: 'Feature',\r\n                      geometry: g,\r\n                      properties: props\r\n                    },\r\n                    properties: props,\r\n                    provider: _this3,\r\n                    query: value\r\n                  };\r\n                } else {\r\n                  return {\r\n                    name: x.ObjNameShort,\r\n                    properties: x,\r\n                    provider: _this3,\r\n                    query: value\r\n                  };\r\n                }\r\n              });\r\n\r\n              if (strong && retrieveGeometry) {\r\n                var event = document.createEvent('Event');\r\n                event.initEvent('fetch', false, false);\r\n                event.detail = rs;\r\n\r\n                _this3.dispatchEvent(event);\r\n              }\r\n\r\n              resolve(rs);\r\n            } else {\r\n              reject(json);\r\n            }\r\n          })[\"catch\"](function (response) {\r\n            return reject(response);\r\n          });\r\n        } else {\r\n          reject('Empty string');\r\n        }\r\n      });\r\n    }\r\n  }]);\r\n\r\n  return OsmDataProvider;\r\n}(scanexEventTarget_cjs);\r\n\r\nvar CoordinatesDataProvider =\r\n/*#__PURE__*/\r\nfunction (_EventTarget) {\r\n  _inherits(CoordinatesDataProvider, _EventTarget);\r\n\r\n  function CoordinatesDataProvider() {\r\n    var _this;\r\n\r\n    _classCallCheck(this, CoordinatesDataProvider);\r\n\r\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CoordinatesDataProvider).call(this));\r\n    _this.showSuggestion = false;\r\n    _this.showOnSelect = false;\r\n    _this.showOnEnter = true;\r\n    _this.fetch = _this.fetch.bind(_assertThisInitialized(_this));\r\n    _this.find = _this.find.bind(_assertThisInitialized(_this));\r\n    _this.rxF = new RegExp('^\\\\s*\\\\-?(\\\\d+(\\\\.\\\\d+)?)(\\\\s+[N|S])?(,\\\\s*|\\\\s+)\\\\-?(\\\\d+(\\\\.\\\\d+)?)(\\\\s+[E|W])?');\r\n    _this.rxD = new RegExp(\"^\\\\s*(\\\\d{1,2})[\\\\s|\\\\u00b0](\\\\d{1,2})[\\\\s|\\\\u0027](\\\\d{1,2}\\\\.\\\\d+)\\\\u0022?(\\\\s+[N|S])?,?\\\\s+(\\\\d{1,2})[\\\\s|\\\\u00b0](\\\\d{1,2})[\\\\s|\\\\u0027](\\\\d{1,2}\\\\.\\\\d+)\\\\u0022?(\\\\s+[E|W])?\");\r\n    return _this;\r\n  }\r\n\r\n  _createClass(CoordinatesDataProvider, [{\r\n    key: \"_parseCoordinates\",\r\n    value: function _parseCoordinates(value) {\r\n      var m = this.rxD.exec(value);\r\n\r\n      if (Array.isArray(m) && m.length === 9) {\r\n        return this._parseDegrees([m[1], m[2], m[3], m[5], m[6], m[7]].map(function (x) {\r\n          return parseFloat(x);\r\n        }));\r\n      }\r\n\r\n      m = this.rxF.exec(value);\r\n\r\n      if (Array.isArray(m) && m.length === 8) {\r\n        return {\r\n          type: 'Point',\r\n          coordinates: [parseFloat(m[5]), parseFloat(m[1])]\r\n        };\r\n      }\r\n\r\n      return null;\r\n    }\r\n  }, {\r\n    key: \"_parseDegrees\",\r\n    value: function _parseDegrees(_ref) {\r\n      var _ref2 = _slicedToArray(_ref, 6),\r\n          latDeg = _ref2[0],\r\n          latMin = _ref2[1],\r\n          latSec = _ref2[2],\r\n          lngDeg = _ref2[3],\r\n          lngMin = _ref2[4],\r\n          lngSec = _ref2[5];\r\n\r\n      return {\r\n        type: 'Point',\r\n        coordinates: [lngDeg + lngMin / 60 + lngSec / 3600, latDeg + latMin / 60 + latSec / 3600]\r\n      };\r\n    }\r\n  }, {\r\n    key: \"fetch\",\r\n    value: function fetch(value) {\r\n      return new Promise(function (resolve) {\r\n        return resolve([]);\r\n      });\r\n    }\r\n  }, {\r\n    key: \"find\",\r\n    value: function find(value, limit, strong, retrieveGeometry) {\r\n      var _this2 = this;\r\n\r\n      var g = this._parseCoordinates(value);\r\n\r\n      return new Promise(function (resolve) {\r\n        var result = {\r\n          feature: {\r\n            type: 'Feature',\r\n            geometry: g,\r\n            properties: {}\r\n          },\r\n          provider: _this2,\r\n          query: value\r\n        };\r\n\r\n        if (g) {\r\n          var event = document.createEvent('Event');\r\n          event.initEvent('fetch', false, false);\r\n          event.detail = result;\r\n\r\n          _this2.dispatchEvent(event);\r\n        }\r\n\r\n        resolve(g ? [result] : []);\r\n      });\r\n    }\r\n  }]);\r\n\r\n  return CoordinatesDataProvider;\r\n}(scanexEventTarget_cjs);\r\n\r\nvar CadastreDataProvider =\r\n/*#__PURE__*/\r\nfunction (_EventTarget) {\r\n  _inherits(CadastreDataProvider, _EventTarget);\r\n\r\n  function CadastreDataProvider(_ref) {\r\n    var _this;\r\n\r\n    var serverBase = _ref.serverBase,\r\n        tolerance = _ref.tolerance;\r\n\r\n    _classCallCheck(this, CadastreDataProvider);\r\n\r\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CadastreDataProvider).call(this));\r\n    _this._serverBase = serverBase;\r\n    _this._tolerance = tolerance;\r\n    _this.showSuggestion = true;\r\n    _this.showOnSelect = false;\r\n    _this.showOnEnter = true;\r\n    _this._cadastreLayers = [{\r\n      id: 1,\r\n      title: 'Участок',\r\n      reg: /^\\d\\d:\\d+:\\d+:\\d+$/\r\n    }, {\r\n      id: 2,\r\n      title: 'Квартал',\r\n      reg: /^\\d\\d:\\d+:\\d+$/\r\n    }, {\r\n      id: 3,\r\n      title: 'Район',\r\n      reg: /^\\d\\d:\\d+$/\r\n    }, {\r\n      id: 4,\r\n      title: 'Округ',\r\n      reg: /^\\d\\d$/\r\n    }, {\r\n      id: 5,\r\n      title: 'ОКС',\r\n      reg: /^\\d\\d:\\d+:\\d+:\\d+:\\d+$/\r\n    }, {\r\n      id: 10,\r\n      title: 'ЗОУИТ',\r\n      reg: /^\\d+\\.\\d+\\.\\d+/ // ,\r\n      // {id: 7, title: 'Границы', \treg: /^\\w+$/},\r\n      // {id: 6, title: 'Тер.зоны', \treg: /^\\w+$/},\r\n      // {id: 12, title: 'Лес', \t\treg: /^\\w+$/},\r\n      // {id: 13, title: 'Красные линии', \t\treg: /^\\w+$/},\r\n      // {id: 15, title: 'СРЗУ', \treg: /^\\w+$/},\r\n      // {id: 16, title: 'ОЭЗ', \t\treg: /^\\w+$/},\r\n      // {id: 9, title: 'ГОК', \t\treg: /^\\w+$/},\r\n      // {id: 10, title: 'ЗОУИТ', \treg: /^\\w+$/}\r\n      // /[^\\d\\:]/g,\r\n      // /\\d\\d:\\d+$/,\r\n      // /\\d\\d:\\d+:\\d+$/,\r\n      // /\\d\\d:\\d+:\\d+:\\d+$/\r\n\r\n    }];\r\n    return _this;\r\n  }\r\n\r\n  _createClass(CadastreDataProvider, [{\r\n    key: \"getCadastreLayer\",\r\n    value: function getCadastreLayer(str, type) {\r\n      str = str.trim();\r\n\r\n      for (var i = 0, len = this._cadastreLayers.length; i < len; i++) {\r\n        var it = this._cadastreLayers[i];\r\n\r\n        if (it.id === type) {\r\n          return it;\r\n        }\r\n\r\n        if (it.reg.exec(str)) {\r\n          return it;\r\n        }\r\n      }\r\n\r\n      return this._cadastreLayers[0];\r\n    }\r\n  }, {\r\n    key: \"find\",\r\n    value: function find(value, limit, strong, retrieveGeometry) {\r\n      var _this2 = this;\r\n\r\n      var cadastreLayer = this.getCadastreLayer(value);\r\n      return new Promise(function (resolve) {\r\n        // let req = new Request(`${this._serverBase}/typeahead?limit=${limit}&skip=0&text=${value}&type=${cadastreLayer.id}`);\r\n        var req = new Request(\"\".concat(_this2._serverBase, \"/features/\").concat(cadastreLayer.id, \"?text=\").concat(value, \"&tolerance=\").concat(_this2._tolerance, \"&limit=\").concat(limit));\r\n        var headers = new Headers();\r\n        headers.append('Content-Type', 'application/json');\r\n        var init = {\r\n          method: 'GET',\r\n          mode: 'cors',\r\n          cache: 'default'\r\n        };\r\n        fetch(req, init).then(function (response) {\r\n          return response.json();\r\n        }).then(function (json) {\r\n          // if(json.status === 200){\r\n          var rs = json.features.map(function (x) {\r\n            return {\r\n              name: x.attrs.name || x.attrs.cn || x.attrs.id,\r\n              properties: x,\r\n              provider: _this2,\r\n              query: value\r\n            };\r\n          });\r\n          resolve(rs); // }\r\n          // else {\r\n          // resolve(json);\r\n          // }                                       \r\n        });\r\n      });\r\n    }\r\n  }, {\r\n    key: \"fetch\",\r\n    value: function (_fetch) {\r\n      function fetch(_x) {\r\n        return _fetch.apply(this, arguments);\r\n      }\r\n\r\n      fetch.toString = function () {\r\n        return _fetch.toString();\r\n      };\r\n\r\n      return fetch;\r\n    }(function (obj) {\r\n      var _this3 = this;\r\n\r\n      var text = obj.attrs.name || obj.attrs.cn || obj.attrs.id;\r\n      var cadastreLayer = this.getCadastreLayer(text, obj.type);\r\n      return new Promise(function (resolve) {\r\n        if (cadastreLayer) {\r\n          // let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?tolerance=${this._tolerance}&limit=1&text=${obj.value}`);\r\n          var req = new Request(\"\".concat(_this3._serverBase, \"/features/\").concat(cadastreLayer.id, \"?tolerance=\").concat(_this3._tolerance, \"&limit=1&text=\").concat(text));\r\n          var headers = new Headers();\r\n          headers.append('Content-Type', 'application/json');\r\n          var init = {\r\n            method: 'GET',\r\n            mode: 'cors',\r\n            cache: 'default'\r\n          };\r\n          fetch(req, init).then(function (response) {\r\n            return response.json();\r\n          }).then(function (json) {\r\n            if (json.status === 200) {\r\n              var event = document.createEvent('Event');\r\n              event.initEvent('fetch', false, false);\r\n              event.detail = json;\r\n\r\n              _this3.dispatchEvent(event);\r\n\r\n              var rs = json.features.map(function (x) {\r\n                return {\r\n                  name: x.attrs.name || x.attrs.cn || x.attrs.id,\r\n                  properties: x,\r\n                  provider: _this3,\r\n                  query: obj\r\n                };\r\n              });\r\n              resolve(rs);\r\n            } else {\r\n              resolve(json);\r\n            }\r\n          });\r\n        } else {\r\n          resolve([]);\r\n        }\r\n      });\r\n    })\r\n  }]);\r\n\r\n  return CadastreDataProvider;\r\n}(scanexEventTarget_cjs);\r\n\r\nexports.CadastreDataProvider = CadastreDataProvider;\r\nexports.CoordinatesDataProvider = CoordinatesDataProvider;\r\nexports.OsmDataProvider = OsmDataProvider;\r\nexports.SearchControl = SearchControl;\r\nexports.SearchWidget = SearchWidget;\r\n//# sourceMappingURL=main.js.map\r\n","import nsGmx from '../nsGmx.js';\r\nimport {OsmDataProvider} from 'leaflet-ext-search';\r\n\r\nnsGmx.OsmDataProvider = OsmDataProvider;\r\n\r\nnsGmx.searchProviders = {};\r\n\r\nnsGmx.searchProviders.Osm2DataProvider = function(options){\r\n    nsGmx.OsmDataProvider.call(this, options);\r\n};\r\n\r\nnsGmx.searchProviders.Osm2DataProvider.prototype = Object.create(nsGmx.OsmDataProvider.prototype);\r\nnsGmx.searchProviders.Osm2DataProvider.prototype.constructor = nsGmx.Osm2DataProvider;\r\n\r\nnsGmx.searchProviders.Osm2DataProvider.prototype.fetch = function (obj) {\r\n    var _this = this;\r\n\r\n    var query = 'WrapStyle=None&RequestType=ID&ID=' + obj.ObjCode + '&TypeCode=' + obj.TypeCode + '&UseOSM=1';\r\n    var req = new Request(this._serverBase + '/SearchObject/SearchAddress.ashx?' + query + this._key);\r\n    var headers = new Headers();\r\n    headers.append('Content-Type', 'application/json');\r\n    var init = {\r\n        method: 'GET',\r\n        mode: 'cors',\r\n        credentials: 'include',\r\n        cache: 'default'\r\n    };\r\n\r\n    return new Promise(function (resolve, reject) {\r\n        fetch(req, init).then(function (response) {\r\n            return response.json();\r\n        }).then(function (json) {\r\n            if (json.Status === 'ok') {\r\n                if (typeof _this._onFetch === 'function') {\r\n                    _this._onFetch(json.Result);\r\n                }\r\n                var event = document.createEvent('Event');\r\n                event.initEvent('fetch', false, false);\r\n                event.detail = json.Result;\r\n                _this.dispatchEvent(event);\r\n                resolve(json.Result);\r\n            } else {\r\n                reject(json.Result);\r\n            }\r\n        }).catch(function (response) {\r\n            return reject(response);\r\n        });\r\n    });\r\n};\r\n\r\nnsGmx.searchProviders.Osm2DataProvider.prototype.find = function (value, limit, strong, retrieveGeometry) {\r\n    var result;\r\n    var _this2 = this;\r\n    _this2.searchString = value;\r\n    var _strong = strong ? 1 : 0;\r\n    var _withoutGeometry = retrieveGeometry ? 0 : 1;\r\n    var query = 'WrapStyle=None&RequestType=SearchObject&IsStrongSearch=' + _strong + '&WithoutGeometry=' + _withoutGeometry + '&UseOSM=1&Limit=' + limit + '&SearchString=' + encodeURIComponent(value);\r\n    var req = new Request(this._serverBase + '/SearchObject/SearchAddress.ashx?' + query + this._key);\r\n    var headers = new Headers();\r\n    headers.append('Content-Type', 'application/json');\r\n    var init = {\r\n        method: 'GET',\r\n        mode: 'cors',\r\n        credentials: 'include',\r\n        cache: 'default'\r\n    };\r\n    return new Promise(function (resolve, reject) {\r\n        var initPromise;\r\n\r\n        if (!window.useInternalSearch) {\r\n            initPromise = fetch(req, init).then(function (response) {\r\n                return response.json();\r\n            });\r\n        } else {\r\n            initPromise = Promise.resolve({\r\n                Status: 'ok',\r\n                Result: []\r\n            });\r\n        }\r\n\r\n        initPromise.then(function (json) {\r\n            if (json.Status === 'ok') {\r\n                json.Result.searchString = _this2.searchString;\r\n                result = json;\r\n                return json;\r\n            } else {\r\n                reject(json.Result);\r\n            }\r\n        }).then(function (json1) {\r\n            return window.searchLogic && window.searchLogic.layersSearch(json1);\r\n        }).then(function (json2) {\r\n            var arr = [];\r\n\r\n            for (let i = 0; i < result.Result.length; i++) {\r\n                arr.push(result.Result[i]);\r\n            }\r\n\r\n            for (let i = 0; i < json2.length; i++) {\r\n                if (json2[i] && json2[i].length) {\r\n                    for (var j = 0; j < json2[i].length; j++) {\r\n                        arr.push(json2[i][j]);\r\n                    }\r\n                }\r\n            }\r\n\r\n            arr.searchString = result.Result.searchString;\r\n\r\n            return {\r\n                Status: result.Status,\r\n                Result: arr\r\n            }\r\n        }).then(function (json3) {\r\n            if (json3.Status === 'ok') {\r\n                var rs = json3.Result.reduce(function (a, x) {\r\n                    return a.concat(x.SearchResult);\r\n                }, []).map(function (x) {\r\n                    if (retrieveGeometry && x.Geometry) {\r\n                        var g = _this2._convertGeometry(x.Geometry);\r\n                        var props = Object.keys(x).filter(function (k) {\r\n                            return k !== 'Geometry';\r\n                        }).reduce(function (a, k) {\r\n                            a[k] = x[k];\r\n                            return a;\r\n                        }, {});\r\n                        return {\r\n                            name: x.ObjNameShort,\r\n                            feature: {\r\n                                type: 'Feature',\r\n                                geometry: g,\r\n                                properties: props\r\n                            },\r\n                            properties: props,\r\n                            provider: _this2,\r\n                            query: value\r\n                        };\r\n                    } else {\r\n                        return {\r\n                            name: x.ObjNameShort,\r\n                            properties: x,\r\n                            provider: _this2,\r\n                            query: value\r\n                        };\r\n                    }\r\n                });\r\n                if (strong && retrieveGeometry) {\r\n                    var event = document.createEvent('Event');\r\n                    event.initEvent('fetch', false, false);\r\n                    event.detail = json3.Result;\r\n                    _this2.dispatchEvent(event);\r\n                }\r\n                resolve(rs);\r\n            } else {\r\n                reject(json3);\r\n            }\r\n        });\r\n    });\r\n}\r\n","﻿import nsGmx from './nsGmx.js';\r\nimport {leftMenu} from './menu.js';\r\nimport {\r\n    _div,\r\n    _form,\r\n    hide,\r\n    _img,\r\n    _input,\r\n    show,\r\n    showErrorMessage,\r\n    _span,    \r\n    _t,    \r\n} from './utilities.js';\r\n\r\nwindow._translationsHash.addtext(\"rus\", {\r\n    \"loadShape.inputTitle\": \"Добавить shp-файл (в zip)\",\r\n    \"loadShape.loadDone\": \"Геометрия успешно загружена\",\r\n    \"loadShape.loadFail\": \"Ошибка загрузки геометрии\"\r\n});\r\n\t\t\t\t\t\t \r\nwindow._translationsHash.addtext(\"eng\", {\r\n    \"loadShape.inputTitle\": \"Add shp-file (zipped)\",\r\n    \"loadShape.loadDone\": \"Successfully loaded\",\r\n    \"loadShape.loadFail\": \"Error loading file\"\r\n});\r\n\r\nvar drawingObjects = \r\n{\r\n\tloadShp: {}\r\n}\r\n\r\nvar queryLoadShp = function()\r\n{\r\n\tthis.builded = false;\r\n\t\r\n\tthis.uploader = null;\r\n}\r\n\r\nqueryLoadShp.prototype = new leftMenu();\r\n\r\n//Старый вариант для IE9\r\n//просто удаляет все контролы и создаёт все их заново...\r\nqueryLoadShp.prototype._regenerateControl = function()\r\n{\r\n    var _this = this;\r\n    $(this.workCanvas).empty();\r\n\r\n    var fileInput = _input(null, [['attr', 'type', 'file'], ['attr', 'name', 'file'], ['attr', 'id', 'upload_shapefile']]);\r\n    fileInput.onchange = function()\r\n    {\r\n        if (this.value != \"\")\r\n            _this.upload();\r\n    }\r\n\r\n    //задаём одновременно и enctype и encoding для корректной работы в IE\r\n    this.postForm = _form([fileInput], [['attr', 'method', 'POST'], ['attr', 'encoding', 'multipart/form-data'], ['attr', 'enctype', 'multipart/form-data'], ['attr', 'id', 'upload_shapefile_form']]);\r\n\r\n    this.progress = _img(null,[['attr','src','img/progress.gif'],['css','display','none']])\r\n\r\n    this.inputControl = _div([_span([_t(_gtxt(\"loadShape.inputTitle\") + \":\")]), this.postForm]);\r\n\r\n    this.workCanvas.appendChild(_div([this.inputControl, this.progress], [['css','padding','10px 0px 5px 20px']]));\r\n}\r\n\r\nqueryLoadShp.prototype.load = function()\r\n{\r\n    if (!this.builded)\r\n    {\r\n        this._regenerateControl();\r\n        this.builded = true;\r\n    }\r\n}\r\n\r\nqueryLoadShp.prototype._showObjectsOnMap = function(objs){\r\n    if (objs.length == 0)\r\n    {\r\n        showErrorMessage(_gtxt(\"Загруженный shp-файл пуст\"), true);\r\n        return;\r\n    }\r\n    var lmap = nsGmx.leafletMap,\r\n        gmxDrawing = lmap.gmxDrawing,\r\n        latLngBounds = L.latLngBounds([]);\r\n    for (var i = 0; i < objs.length; i++) {\r\n        var it = objs[i],\r\n            geoJSON = L.gmxUtil.geometryToGeoJSON(it.geometry),\r\n            b = gmxDrawing.addGeoJSON(geoJSON, {fill: false, properties: it.properties})[0].getBounds();\r\n\r\n        latLngBounds.extend(b);\r\n    }\r\n    if (latLngBounds.isValid()) {\r\n        lmap.fitBounds(latLngBounds);\r\n    }\r\n}\r\n\r\n//files - массив File или WebForms\r\nqueryLoadShp.prototype.loadAndShowFiles = function(files) {\r\n    nsGmx.widgets.notifications.startAction('uploadShp');\r\n    \r\n    var def = $.when.apply($, [].slice.call(files).map(function(file) {\r\n        return nsGmx.Utils.parseShpFile(file);\r\n    }));\r\n    \r\n    def.then(function() {\r\n        this._showObjectsOnMap(_.flatten([].slice.call(arguments)));\r\n        nsGmx.widgets.notifications.stopAction('uploadShp', 'success', _gtxt('loadShape.loadDone'));\r\n    }.bind(this), function() {\r\n        nsGmx.widgets.notifications.stopAction('uploadShp', 'failure', _gtxt('loadShape.loadFail'));\r\n    });\r\n    \r\n    return def;\r\n}\r\n\r\n\r\n//Загружает файлы из поля \"file\"\r\nqueryLoadShp.prototype.upload = function()\r\n{\r\n\thide(this.inputControl);\r\n\tshow(this.progress);\r\n\r\n    this.loadAndShowFiles([this.postForm]).always(function() {\r\n        this.inputControl.removeChild(this.postForm);\r\n        this._regenerateControl();\r\n    }.bind(this));\r\n}\r\n\r\nvar _queryLoadShp = new queryLoadShp();\r\n\r\n\r\ndrawingObjects.loadShp.load = function() {\r\n    if ('File' in window) {\r\n        $('<input type=\"file\" multiple>').change(function(e) {\r\n            _queryLoadShp.loadAndShowFiles(e.target.files);\r\n        }).click();\r\n    } else { //IE9\r\n        var alreadyLoaded = _queryLoadShp.createWorkCanvas(arguments[0] || \"shp\");\r\n\r\n        if (!alreadyLoaded)\r\n            _queryLoadShp.load()\r\n    }\r\n}\r\n\r\ndrawingObjects.loadShp.unload = function()\r\n{\r\n}\r\n\r\nexport {drawingObjects, _queryLoadShp};","import nsGmx from './nsGmx.js';\r\nimport {leftMenu} from './menu.js';\r\nimport {\r\n    _checkbox,\r\n    _div,\r\n    hide,\r\n    _img,\r\n    _input,\r\n    inputError,\r\n    _li,\r\n    makeButton,\r\n    makeImageButton,\r\n    objLength,\r\n    _option,\r\n    parseResponse,\r\n    parseXML,\r\n    sendCrossDomainJSONRequest,\r\n    show,\r\n    _span,\r\n    strip,\r\n    _t,\r\n    _table,\r\n    _tbody,\r\n    _td,\r\n    _tr,\r\n    _ul,\r\n} from './utilities.js';\r\n\r\nconst _ = nsGmx.Utils._;\r\n\r\nvar wmsProjections = ['EPSG:3395', 'EPSG:4326', 'EPSG:41001'];  // типы проекций\r\n\r\nvar getTextContent = function(node) {\r\n    if (typeof node.textContent != 'undefined')\r\n        return node.textContent;\r\n\r\n    var data = '';\r\n    for (var i = 0; i < node.childNodes.length; i++)\r\n        data += node.childNodes[i].data;\r\n\r\n    return data;\r\n}\r\n\r\nvar getScale = function(z)\r\n{\r\n    return Math.pow(2, -z)*156543.033928041;\r\n}\r\n\r\n/** Формирует URL картинки, который можно использовать для получения WMS слоя для данного положения карты\r\n * @property {String} url - WMS ссылка.\r\n * @property {object} props - атрибуты.\r\n * @property {String} props.srs - тип проекции.\r\n * @property {String} props.version - версия.\r\n * @property {String} props.name - Идентификатор слоя.\r\n * @property {object} props.bbox - ограничение по bounds(в географических координатах).\r\n * @property {object} requestProperties - атрибуты формата результирующего image.\r\n * @property {String} requestProperties.format - тип (по умолчанию 'image/jpeg').\r\n * @property {String} requestProperties.transparent - прозрачность подложки ('TRUE'/'FALSE' по умолчанию 'FALSE').\r\n * @returns {object} - {url: String, bounds: {Extent}}. bounds в географических координатах.\r\n*/\r\nvar getWMSMapURL = function(url, props, requestProperties)\r\n{\r\n    var CRSParam = {'1.1.1': 'SRS', '1.3.0': 'CRS'};\r\n\r\n    requestProperties = requestProperties || {};\r\n\r\n    var lmap = nsGmx.leafletMap,\r\n        extend = lmap.getBounds();\r\n\r\n    var miny = Math.max(extend.getSouth(), -90);\r\n    var maxy = Math.min(extend.getNorth(), 90);\r\n    var minx = Math.max(extend.getWest(), -180);\r\n    var maxx = Math.min(extend.getEast(), 180);\r\n\r\n    if (props.bbox)\r\n    {\r\n        minx = Math.max(props.bbox.minx, minx);\r\n        miny = Math.max(props.bbox.miny, miny);\r\n        maxx = Math.min(props.bbox.maxx, maxx);\r\n        maxy = Math.min(props.bbox.maxy, maxy);\r\n\r\n        if (minx >= maxx || miny >= maxy)\r\n            return;\r\n    }\r\n\r\n    var mercMin = L.Projection.Mercator.project({lat: miny, lng: minx}),\r\n        mercMax = L.Projection.Mercator.project({lat: maxy, lng: maxx});\r\n\r\n    var scale = getScale(lmap.getZoom());\r\n    var w = Math.round((mercMax.x - mercMin.x)/scale);\r\n    var h = Math.round((mercMax.y - mercMin.y)/scale);\r\n\r\n    var isMerc = !(props.srs == wmsProjections[1]);\r\n\r\n    var st = url;\r\n    var format = requestProperties.format || 'image/jpeg';\r\n    var transparentParam = requestProperties.transparent ? 'TRUE' : 'FALSE';\r\n    var version = props.version || '1.1.1';\r\n    var isV130 = version === '1.3.0';\r\n\r\n    //st = st.replace(/Service=WMS[\\&]*/i, '');\r\n    //st = st.replace(/\\&$/, '');\r\n\r\n    st += (st.indexOf('?') == -1 ? '?':'&') + 'request=GetMap&Service=WMS';\r\n    st += \"&layers=\" + encodeURIComponent(props.name) +\r\n        \"&VERSION=\" + encodeURIComponent(version) +\r\n        \"&\" + CRSParam[version] + \"=\" + encodeURIComponent(props.srs) +\r\n        \"&styles=\" +\r\n        \"&width=\" + w +\r\n        \"&height=\" + h +\r\n        \"&bbox=\" + (isMerc ? mercMin.x : isV130 ? miny : minx) +\r\n             \",\" + (isMerc ? mercMin.y : isV130 ? minx : miny) +\r\n             \",\" + (isMerc ? mercMax.x : isV130 ? maxy : maxx) +\r\n             \",\" + (isMerc ? mercMax.y : isV130 ? maxx : maxy);\r\n\r\n    if (url.indexOf('format=') == -1) st += \"&format=\" + encodeURIComponent(format);\r\n    if (url.indexOf('transparent=') == -1) st += \"&transparent=\" + encodeURIComponent(transparentParam);\r\n\r\n    return {url: st, bounds: {minX: minx, maxX: maxx, minY: miny, maxY: maxy}};\r\n}\r\n\r\n/**\r\n * Возвращает описание WMS-слоёв от XML, которую вернул сервер на запрос GetCapabilities\r\n * @returns {Array} - массив объектов с описанием слоёв\r\n*/\r\nvar parseWMSCapabilities = function(response)\r\n{\r\n    var supportedVersions = {'1.1.1': true, '1.3.0': true};\r\n    var SRSTagName = {'1.1.1': 'SRS', '1.3.0': 'CRS'};\r\n    var BBOXTagName = {'1.1.1': 'LatLonBoundingBox', '1.3.0': 'EX_GeographicBoundingBox'};\r\n    var serviceLayers = [];\r\n    // var strResp = response.replace(/[\\t\\n\\r]/g, ' ');\r\n    //     strResp = strResp.replace(/\\s+/g, ' ');\r\n    var xml = parseXML(response),\r\n        mainTag = xml.getElementsByTagName('WMS_Capabilities')[0] || xml.getElementsByTagName('WMT_MS_Capabilities')[0],\r\n        version = mainTag.getAttribute('version'),\r\n        layersXML = xml.getElementsByTagName('Layer');\r\n\r\n    if (!(version in supportedVersions)) {\r\n        return [];\r\n    }\r\n\r\n    for (var i = 0; i < layersXML.length; i++)\r\n    {\r\n        var layer = {version: version},\r\n            name = layersXML[i].getElementsByTagName('Name'),\r\n            title = layersXML[i].getElementsByTagName('Title'),\r\n            bbox = layersXML[i].getElementsByTagName(BBOXTagName[version]),\r\n            srs = layersXML[i].getElementsByTagName(SRSTagName[version]);\r\n\r\n        if (srs.length)\r\n        {\r\n            layer.srs = null;\r\n            var supportedSrs = {};\r\n            for (var si = 0; si < srs.length; si++)\r\n            {\r\n                var srsName = strip(getTextContent(srs[si]));\r\n                supportedSrs[srsName] = true;\r\n            }\r\n\r\n            //порядок имеет значение!\r\n            for (var p = 0; p < wmsProjections.length; p++) {\r\n                if (wmsProjections[p] in supportedSrs) {\r\n                    layer.srs = wmsProjections[p];\r\n                    break;\r\n                }\r\n            }\r\n            if (!layer.srs) continue;\r\n        }\r\n        else {\r\n            layer.srs = wmsProjections[0];\r\n        }\r\n\r\n        if (name.length)\r\n            layer.name = getTextContent(name[0]);\r\n\r\n        if (bbox.length)\r\n        {\r\n            if (version == '1.1.1') {\r\n                layer.bbox =\r\n                {\r\n                    minx: Number(bbox[0].getAttribute('minx')),\r\n                    miny: Number(bbox[0].getAttribute('miny')),\r\n                    maxx: Number(bbox[0].getAttribute('maxx')),\r\n                    maxy: Number(bbox[0].getAttribute('maxy'))\r\n                };\r\n            } else {\r\n                layer.bbox =\r\n                {\r\n                    minx: Number(getTextContent(bbox[0].getElementsByTagName('westBoundLongitude')[0])),\r\n                    miny: Number(getTextContent(bbox[0].getElementsByTagName('southBoundLatitude')[0])),\r\n                    maxx: Number(getTextContent(bbox[0].getElementsByTagName('eastBoundLongitude')[0])),\r\n                    maxy: Number(getTextContent(bbox[0].getElementsByTagName('northBoundLatitude')[0]))\r\n                };\r\n            }\r\n        }\r\n\r\n        if (title.length)\r\n            layer.title = getTextContent(title[0]);\r\n\r\n        if (layer.name)\r\n            serviceLayers.push(layer);\r\n    }\r\n\r\n    return serviceLayers;\r\n}\r\n\r\nvar loadServerData = window.loadServerData =\r\n{\r\n    WFS:{},\r\n    WMS:{}\r\n}\r\n\r\n/* Порядок координат в WFS зависит от формата SRS (http://geoserver.org/display/GEOSDOC/2.+WFS+-+Web+Feature+Service)\r\n    * EPSG:xxxx: longitude/latitude (supported in WFS 1.1 requests too)\r\n    * http://www.opengis.net/gml/srs/epsg.xml#xxxx: longitude/latitude (supported in WFS 1.1 requests too)\r\n    * urn:x-ogc:def:crs:EPSG:xxxx: latitude/longitude\r\n*/\r\n\r\nvar wfsParser = function()\r\n{\r\n    this.gmlns = window.location.protocol + '//www.opengis.net/gml';\r\n    this.kmlns = window.location.protocol + '//earth.google.com/kml/2.0';\r\n\r\n    this.axisOrder = null;\r\n}\r\n\r\nwfsParser.prototype.elementsNS = function(node,uri,name)\r\n{\r\n    var elements=[];\r\n\r\n    if (node.getElementsByTagNameNS)\r\n        elements = node.getElementsByTagNameNS(uri,name);\r\n    else\r\n    {\r\n        var allNodes = node.getElementsByTagName(\"*\"),\r\n            potentialNode,\r\n            fullName;\r\n\r\n        for (var i = 0, len = allNodes.length; i < len ; ++i)\r\n        {\r\n            potentialNode = allNodes[i];\r\n            fullName = (potentialNode.prefix) ? (potentialNode.prefix + \":\" + name) : name;\r\n            if ((name == \"*\") || (fullName == potentialNode.nodeName))\r\n            {\r\n                if ( (uri == \"*\") || (uri == potentialNode.namespaceURI))\r\n                    elements.push(potentialNode);\r\n            }\r\n        }\r\n    }\r\n\r\n    return elements;\r\n}\r\n\r\nwfsParser.prototype.getChildValue = function(node, def)\r\n{\r\n    var value = def || \"\";\r\n    if (node)\r\n    {\r\n        for (var child = node.firstChild; child; child = child.nextSibling)\r\n        {\r\n            switch (child.nodeType)\r\n            {\r\n                case 3:\r\n                case 4: value += child.nodeValue;\r\n            }\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\nwfsParser.prototype.parse = function(response, srs)\r\n{\r\n    var geometries = [];\r\n    var strResp = response.replace(/[\\t\\n\\r]/g, ' ');\r\n        strResp = strResp.replace(/\\s+/g, ' ');\r\n    var xml = parseXML(strResp),\r\n        parsedNS = strResp.indexOf('<kml') > -1 ? this.kmlns : this.gmlns;\r\n\r\n    this.axisOrder = srs && srs.indexOf(\"urn:\") == 0 ? 'latlong' : 'longlat';\r\n\r\n    var order = [\"Polygon\",\"LineString\",\"Point\"];\r\n\r\n    for (var i = 0, len = order.length; i < len; ++i)\r\n    {\r\n        var type = order[i],\r\n            nodeList = this.elementsNS(xml.documentElement,parsedNS,type);\r\n\r\n        for (var j = 0; j < nodeList.length; ++j)\r\n        {\r\n            var geometry = this['parse' + type].apply(this,[nodeList[j]]);\r\n\r\n            if (geometry)\r\n                geometries.push(geometry);\r\n        }\r\n    }\r\n\r\n    return geometries;\r\n}\r\n\r\nwfsParser.prototype.parsePoint = function(node)\r\n{\r\n    var coordString,\r\n        coords=[],\r\n        nodeList = this.elementsNS(node,this.gmlns,\"pos\");\r\n\r\n    if (nodeList.length > 0)\r\n    {\r\n        coordString = strip(nodeList[0].firstChild.nodeValue);\r\n        coords = coordString.split(\" \");\r\n    }\r\n    if (coords.length == 0)\r\n    {\r\n        nodeList = this.elementsNS(node,this.gmlns,\"coordinates\");\r\n\r\n        if (nodeList.length > 0)\r\n        {\r\n            coordString = strip(nodeList[0].firstChild.nodeValue);\r\n            coords = coordString.split(\",\");\r\n        }\r\n    }\r\n    if (coords.length == 0)\r\n    {\r\n        nodeList = this.elementsNS(node,this.gmlns,\"coord\");\r\n\r\n        if (nodeList.length > 0)\r\n        {\r\n            var xList = this.elementsNS(nodeList[0],this.gmlns,\"X\"),\r\n                yList = this.elementsNS(nodeList[0],this.gmlns,\"Y\");\r\n\r\n            if (xList.length > 0 && yList.length > 0)\r\n                coords = [xList[0].firstChild.nodeValue, yList[0].firstChild.nodeValue];\r\n        }\r\n    }\r\n\r\n    return {feature:{}, geometry:{type: 'Point', coordinates: this.swapCoordinates([Number(coords[0]), Number(coords[1])])}}\r\n}\r\n\r\nwfsParser.prototype.parseLineString = function(node)\r\n{\r\n    var coordString,\r\n        coords = [],\r\n        points = [],\r\n        nodeList = this.elementsNS(node, this.gmlns, \"posList\");\r\n\r\n    if (nodeList.length > 0)\r\n    {\r\n        coordString = strip(this.getChildValue(nodeList[0]));\r\n        coords = coordString.split(\" \");\r\n\r\n        for (let i = 0; i < coords.length / 2; ++i)\r\n        {\r\n            let j = i * 2;\r\n\r\n\r\n\r\n            points.push(this.swapCoordinates([Number(coords[j]), Number(coords[j + 1])]));\r\n        }\r\n    }\r\n    if (coords.length == 0)\r\n    {\r\n        nodeList = this.elementsNS(node,this.gmlns,\"coordinates\");\r\n\r\n        if (nodeList.length > 0)\r\n        {\r\n            coordString = strip(this.getChildValue(nodeList[0]));\r\n            coordString = coordString.replace(/\\s*,\\s*/g,\",\");\r\n\r\n            var pointList = coordString.split(\" \");\r\n\r\n            for (let i = 0; i < pointList.length; ++i)\r\n            {\r\n                coords = pointList[i].split(\",\");\r\n\r\n                points.push(this.swapCoordinates([Number(coords[0]), Number(coords[1])]));\r\n            }\r\n        }\r\n    }\r\n\r\n    if (points.length != 0)\r\n    {\r\n        return {feature:{}, geometry:{type: 'LineString', coordinates: points}}\r\n    }\r\n    else\r\n        return false\r\n\r\n}\r\n\r\nwfsParser.prototype.parsePolygon = function(node)\r\n{\r\n    var nodeList = this.elementsNS(node,this.gmlns,\"LinearRing\"),\r\n        components = [];\r\n\r\n    if (nodeList.length > 0)\r\n    {\r\n        var ring;\r\n\r\n        for (var i = 0; i < nodeList.length; ++i)\r\n        {\r\n            ring = this.parseLineString.apply(this,[nodeList[i],true]);\r\n\r\n            if (ring)\r\n                components.push(ring.geometry.coordinates);\r\n        }\r\n    }\r\n\r\n    return {feature:{}, geometry:{type: 'Polygon', coordinates: components}}\r\n}\r\n\r\nwfsParser.prototype.swapCoordinates = function(arr)\r\n{\r\n    if (this.axisOrder == 'latlong')\r\n        return [arr[1], arr[0]]\r\n    else\r\n        return [arr[0], arr[1]];\r\n}\r\n\r\nvar _wfsParser = new wfsParser();\r\n\r\nvar jsonParser = function()\r\n{\r\n    this.axisOrder = null;\r\n}\r\n\r\njsonParser.prototype.parse = function(response, srs)\r\n{\r\n    var resp = JSON.parse(response),\r\n        geometries = [];\r\n\r\n    this.axisOrder = srs && srs.indexOf(\"urn:\") == 0 ? 'latlong' : 'longlat';\r\n\r\n    for (var i = 0; i < resp.features.length; i++)\r\n    {\r\n        if (resp.features[i].geometry.type.toLowerCase().indexOf('point') > -1)\r\n            this.parsePoint(resp.features[i], geometries);\r\n        else if (resp.features[i].geometry.type.toLowerCase().indexOf('linestring') > -1)\r\n            this.parseLineString(resp.features[i], geometries);\r\n        else if (resp.features[i].geometry.type.toLowerCase().indexOf('polygon') > -1)\r\n            this.parsePolygon(resp.features[i], geometries);\r\n    }\r\n\r\n    return geometries;\r\n}\r\n\r\njsonParser.prototype.parsePoint = function(feature, geometryArr)\r\n{\r\n    if (feature.geometry.type.toLowerCase().indexOf('multi') < 0)\r\n        geometryArr.push({feature: feature, geometry:{type: 'POINT', coordinates: this.swapCoordinates(feature.geometry.coordinates)}});\r\n    else\r\n    {\r\n        for (var i = 0; i < feature.geometry.coordinates.length; i++)\r\n            geometryArr.push({feature: feature, geometry:{type: 'POINT', coordinates: this.swapCoordinates(feature.geometry.coordinates[i])}})\r\n    }\r\n}\r\njsonParser.prototype.parseLineString = function(feature, geometryArr)\r\n{\r\n    if (feature.geometry.type.toLowerCase().indexOf('multi') < 0)\r\n    {\r\n        let newCoords = [];\r\n\r\n        for (let j = 0; j < feature.geometry.coordinates.length; j++)\r\n            newCoords.push(this.swapCoordinates(feature.geometry.coordinates[j]))\r\n\r\n        geometryArr.push({feature: feature, geometry:{type: 'LINESTRING', coordinates: newCoords}});\r\n    }\r\n    else\r\n    {\r\n        for (let i = 0; i < feature.geometry.coordinates.length; i++)\r\n        {\r\n            let newCoords = [];\r\n\r\n            for (let j = 0; j < feature.geometry.coordinates[i].length; j++)\r\n                newCoords.push(this.swapCoordinates(feature.geometry.coordinates[i][j]))\r\n\r\n            geometryArr.push({feature: feature, geometry:{type: 'LINESTRING', coordinates: newCoords}});\r\n        }\r\n    }\r\n}\r\njsonParser.prototype.parsePolygon = function(feature, geometryArr)\r\n{\r\n    if (feature.geometry.type.toLowerCase().indexOf('multi') < 0)\r\n    {\r\n        let newCoords = [];\r\n\r\n        let k = 0, j = 0;\r\n\r\n        for (k = 0; k < feature.geometry.coordinates.length; j++)\r\n        {\r\n            let newCoords2 = [];\r\n\r\n            for (j = 0; j < feature.geometry.coordinates[k].length; k++)\r\n                newCoords2.push(this.swapCoordinates(feature.geometry.coordinates[k][j]))\r\n\r\n            newCoords.push(newCoords2)\r\n        }\r\n\r\n        geometryArr.push({feature: feature, geometry:{type: 'POLYGON', coordinates: newCoords}});\r\n    }\r\n    else\r\n    {\r\n        for (let i = 0; i < feature.geometry.coordinates.length; i++)\r\n        {\r\n            let newCoords = [];\r\n\r\n            for (let k = 0; k < feature.geometry.coordinates[i].length; k++)\r\n            {\r\n                let newCoords2 = [];\r\n\r\n                for (let j = 0; j < feature.geometry.coordinates[i][k].length; j++)\r\n                    newCoords2.push(this.swapCoordinates(feature.geometry.coordinates[i][k][j]))\r\n\r\n                newCoords.push(newCoords2)\r\n            }\r\n\r\n            geometryArr.push({feature: feature, geometry:{type: 'POLYGON', coordinates: newCoords}});\r\n        }\r\n    }\r\n}\r\njsonParser.prototype.swapCoordinates = function(arr)\r\n{\r\n    if (this.axisOrder == 'latlong')\r\n        return [arr[1], arr[0]]\r\n    else\r\n        return [arr[0], arr[1]];\r\n}\r\n\r\nvar _jsonParser = new jsonParser();\r\n\r\nvar queryServerData = function()\r\n{\r\n    this.inputField = null;\r\n    this.parentCanvas = null;\r\n\r\n    this.wfsFormats = {};\r\n\r\n    this.oldBalloon = false;\r\n    this.oldBalloonIndex = -1;\r\n\r\n    this.proj = ['EPSG:4326','EPSG:3395','EPSG:41001'];\r\n\r\n    this.customParams = undefined;\r\n}\r\n\r\nqueryServerData.prototype = new leftMenu();\r\n\r\n/**\r\n    Загружает виджет для добавления/просмотра WMS/WFS слоёв\r\n @param protocol\r\n @param parseFunc\r\n @param drawFunc\r\n @param customParamsManager {object}- контролер дополнительных параметров. Имеет методы: <br/>\r\n        - init(targetDiv)->void Добавляет контрол к элементу targetDiv<br/>\r\n        - collect()->Object Возвращает выбранные пользователем объекты<br/>\r\n @param version {string} Версия протокола, которая будет использоваться\r\n*/\r\nqueryServerData.prototype.load = function(protocol, parseFunc, drawFunc, customParamsManager)\r\n{\r\n    window.convertCoords = function(coordsStr)\r\n    {\r\n        let res = [],\r\n            coordsPairs = strip(coordsStr).replace(/\\s+/,' ').split(' ');\r\n\r\n        if (coordsStr.indexOf(',') == -1)\r\n        {\r\n            for (let j = 0; j < Math.floor(coordsPairs.length / 2); j++)\r\n                res.push([Number(coordsPairs[2 * j + 1]), Number(coordsPairs[2 * j])])\r\n        }\r\n        else\r\n        {\r\n            for (let j = 0; j < coordsPairs.length; j++)\r\n            {\r\n                let parsedCoords = coordsPairs[j].split(',');\r\n\r\n                res.push([Number(parsedCoords[1]), Number(parsedCoords[0])])\r\n            }\r\n        }\r\n\r\n        return res;\r\n    }\r\n\r\n    window.parseGML = function(response, format, srs)\r\n    {\r\n        if (format == 'gml')\r\n            return _wfsParser.parse(response, srs);\r\n        else if (format == 'json')\r\n            return _jsonParser.parse(response, srs);\r\n        else\r\n            return [];\r\n    }\r\n\r\n    var inputField = _input(null, [['dir','className','inputStyle'],['css','width','200px']]);\r\n\r\n    this.parentCanvas = _div(null, [['dir','className','serverDataCanvas']]);\r\n\r\n    var goButton = makeButton(_gtxt(\"Загрузить\")),\r\n        _this = this;\r\n\r\n    var doGetCapabilities = function()\r\n    {\r\n        if (inputField.value != '')\r\n        {\r\n            if ( customParamsManager )\r\n                _this.customParams = customParamsManager.collect();\r\n\r\n            _this.getCapabilities(protocol, strip(inputField.value), parseFunc, drawFunc);\r\n\r\n            inputField.value = '';\r\n        }\r\n        else\r\n            inputError(inputField);\r\n    }\r\n\r\n    goButton.onclick = doGetCapabilities;\r\n\r\n    $(inputField).on('keydown', function(e)\r\n    {\r\n        if (e.keyCode === 13)\r\n        {\r\n            doGetCapabilities();\r\n            return false;\r\n        }\r\n    });\r\n\r\n    var canvas = _div([_div([_span([_t(_gtxt(\"URL сервера\"))])], [['css','marginBottom','3px']]),_table([_tbody([_tr([_td([inputField]),_td([goButton])])])], [['css','marginBottom','5px']])],[['css','margin','3px 0px 0px 10px']])\r\n\r\n    if (customParamsManager)\r\n    {\r\n        var customParamsDiv = _div();\r\n        $(canvas).append(customParamsDiv);\r\n        _this.customParams = customParamsManager.init(customParamsDiv);\r\n    }\r\n\r\n    _(this.workCanvas, [canvas, this.parentCanvas])\r\n}\r\n\r\nqueryServerData.prototype.getCapabilities = function(protocol, url, parseFunc, drawFunc, version)\r\n{\r\n    var loading = _div([_img(null, [['attr','src','img/progress.gif'],['css','marginRight','10px']]), _t(_gtxt('загрузка...'))], [['css','margin','3px 0px 3px 20px']]),\r\n        _this = this;\r\n\r\n    if (this.parentCanvas.childNodes.length == 0)\r\n        _(this.parentCanvas, [loading]);\r\n    else\r\n        this.parentCanvas.insertBefore(loading, this.parentCanvas.firstChild);\r\n\r\n    var capabilitiesUrl =\r\n            url.replace(/REQUEST=GetCapabilities[&]*/i, '')\r\n               .replace(new RegExp('SERVICE=' + protocol + '[&]', 'i'), '')\r\n               .replace(/&$/, '');\r\n\r\n    capabilitiesUrl += capabilitiesUrl.indexOf('?') !== -1 ? '&' : '?';\r\n    capabilitiesUrl += 'REQUEST=GetCapabilities&SERVICE=' + protocol;\r\n\r\n    if (version) {\r\n        capabilitiesUrl += '&VERSION=' + version;\r\n    }\r\n\r\n    sendCrossDomainJSONRequest(window.serverBase + \"ApiSave.ashx?get=\" + encodeURIComponent(capabilitiesUrl), function(response) {\r\n        if (!parseResponse(response)) return;\r\n\r\n        var servicelayers = parseFunc.call(_this, response.Result);\r\n\r\n        drawFunc.call(_this, servicelayers, url, loading, undefined, _this.customParams);\r\n    })\r\n}\r\n\r\nqueryServerData.prototype.parseWFSCapabilities = function(response)\r\n{\r\n    var serviceLayers = [],\r\n        // strResp = response.replace(/[\\t\\n\\r]/g, ' '),\r\n        // strResp = strResp.replace(/\\s+/g, ' '),\r\n        featuresXML = parseXML(response).getElementsByTagName('FeatureType');\r\n\r\n    for (var i = 0; i < featuresXML.length; i++)\r\n    {\r\n        var layer = {},\r\n            name = featuresXML[i].getElementsByTagName('Name'),\r\n            title = featuresXML[i].getElementsByTagName('Title'),\r\n            srs = featuresXML[i].getElementsByTagName('DefaultSRS');\r\n\r\n        if (name.length)\r\n            layer.name = getTextContent(name[0]);\r\n\r\n        if (title.length)\r\n            layer.title = getTextContent(title[0]);\r\n\r\n        if (srs.length)\r\n            layer.srs = getTextContent(srs[0]);\r\n\r\n        if (layer.name)\r\n            serviceLayers.push(layer);\r\n    }\r\n\r\n    return serviceLayers;\r\n}\r\n\r\nqueryServerData.prototype.loadGML = function(url, parentTreeCanvas, box, header, format, loadLayerParams, srs)\r\n{\r\n    var _this = this;\r\n\r\n    sendCrossDomainJSONRequest(window.serverBase + \"ApiSave.ashx?get=\" + encodeURIComponent(url), function(response)\r\n    {\r\n        if (!parseResponse(response)) return;\r\n        var geometries = window.parseGML(response.Result, format, srs);\r\n        _this.drawGML(geometries, url, parentTreeCanvas, box, header, loadLayerParams);\r\n    })\r\n}\r\n\r\nqueryServerData.prototype.saveGML = function(geometries)\r\n{\r\n    if (typeof geometries == 'undefined' || geometries == null)\r\n    {\r\n        geometries = [];\r\n\r\n        window.globalFlashMap.drawing.forEachObject(function(ret)\r\n        {\r\n            geometries.push(ret.geometry);\r\n        })\r\n    }\r\n\r\n    window.promptFunction(_gtxt('Введите имя gml-файла для скачивания:'), 'objects.gml', function(fileName)\r\n    {\r\n        window.globalFlashMap.saveObjects(geometries, nsGmx.Utils.translit(fileName));\r\n    });\r\n\r\n    return false;\r\n}\r\n\r\nqueryServerData.prototype.drawGML = function(geometries, url, parentTreeCanvas, box)\r\n{\r\n    var parent = {\r\n                    'Point': L.gmx.createLayer({properties: {}}).addTo(nsGmx.leafletMap),\r\n                    'LineString': L.gmx.createLayer({properties: {}}).addTo(nsGmx.leafletMap),\r\n                    'Polygon': L.gmx.createLayer({properties: {}}).addTo(nsGmx.leafletMap)\r\n                };\r\n        // var styles = {\r\n        //          'Point': typeof loadLayerParams != 'undefined' && loadLayerParams['point'] ? loadLayerParams['point'].RenderStyle : { marker: { size: 2 }, outline: { color: 0x0000ff, thickness: 1 } },\r\n        //          'LineString': typeof loadLayerParams != 'undefined' && loadLayerParams['linestring'] ? loadLayerParams['linestring'].RenderStyle : { outline: { color: 0x0000ff, thickness: 2 } },\r\n        //          'Polygon': typeof loadLayerParams != 'undefined' && loadLayerParams['polygon'] ? loadLayerParams['polygon'].RenderStyle : { outline: { color: 0x0000ff, thickness: 2, opacity: 100 }, fill: {color: 0xffffff, opacity: 20} }\r\n        //      };\r\n    // parent['POINT'].setStyle(styles['POINT']);\r\n    // parent['LINESTRING'].setStyle(styles['LINESTRING']);\r\n    // parent['POLYGON'].setStyle(styles['POLYGON']);\r\n\r\n    var geomsPresent = {},\r\n        bounds = L.gmxUtil.bounds(),\r\n        items = {'Point': [], 'LineString': [], 'Polygon': []};\r\n\r\n    for (var i = 0; i < geometries.length; i++)\r\n    {\r\n        //var elem = parent[geometries[i].geometry.type].addObject(geometries[i].geometry);\r\n        items[geometries[i].geometry.type].push([L.gmxUtil.geoJSONtoGeometry(geometries[i].geometry, true)]);\r\n        //parent[geometries[i].geometry.type].addItems();\r\n\r\n        /*if (objLength(geometries[i].feature) > 0)\r\n        {\r\n            (function(i)\r\n            {\r\n                elem.setHandler(\"onClick\", function(obj)\r\n                {\r\n                    var elemCanvas = $(divCanvas).find(\"[geometryType='\" + geometries[i].geometry.type + \"']\")[0];\r\n\r\n                    if (!elemCanvas.graphDataProperties ||\r\n                        !geometries[i].feature.properties)\r\n                        return;\r\n\r\n                    var balloonCanvas = _div();\r\n\r\n                    if (!_diagram.createBalloon(obj, balloonCanvas))\r\n                        return;\r\n\r\n                    if (_diagram.createDateTimeDiagramByAttrs(balloonCanvas, 500, 300, geometries[i].feature.properties, elemCanvas.graphDataProperties))\r\n                        _diagram.oldBalloon.resize();\r\n                })\r\n            })(i);\r\n        }*/\r\n\r\n        geomsPresent[geometries[i].geometry.type] = true;\r\n\r\n        bounds.extendArray(geometries[i].geometry.coordinates[0]);\r\n    }\r\n\r\n    parent['Point'].addData(items['Point']);\r\n    parent['LineString'].addData(items['LineString']);\r\n    parent['Polygon'].addData(items['Polygon']);\r\n\r\n    var divCanvas = _div(),\r\n        divChilds = _div(),\r\n        // spanHeader = _span([_t(url.length < 45 ? url : url.substr(0, 45) + '...')]),\r\n        _this = this;\r\n\r\n    var clickFunc = function(flag)\r\n    {\r\n        var lmap = nsGmx.leafletMap,\r\n            method = flag ? 'addLayer' : 'removeLayer';\r\n        lmap[method](parent['Point']);\r\n        lmap[method](parent['LineString']);\r\n        lmap[method](parent['Polygon']);\r\n\r\n        if (flag)\r\n            show(divChilds);\r\n        else\r\n            hide(divChilds);\r\n    }\r\n\r\n    parentTreeCanvas.loaded = function() // переопределим функцию загрузки слоя на центрирование\r\n    {\r\n        if (!box.checked)\r\n        {\r\n            clickFunc.call(_this, true);\r\n\r\n            box.checked = true;\r\n        }\r\n\r\n        //globalFlashMap.zoomToExtent(bounds.minX, bounds.minY, bounds.maxX, bounds.maxY);\r\n        nsGmx.leafletMap.fitBounds([[bounds.min.y, bounds.min.x], [bounds.max.y, bounds.max.x]]);\r\n    }\r\n\r\n    parentTreeCanvas.clear = function()\r\n    {\r\n        var lmap = nsGmx.leafletMap;\r\n        lmap.removeLayer(parent['Point']);\r\n        lmap.removeLayer(parent['LineString']);\r\n        lmap.removeLayer(parent['Polygon']);\r\n\r\n        divCanvas.removeNode(true);\r\n    }\r\n\r\n    box.onclick = function()\r\n    {\r\n        clickFunc.call(_this, this.checked);\r\n    }\r\n\r\n    $(parentTreeCanvas).empty();\r\n\r\n    if (parentTreeCanvas.childNodes.length == 0)\r\n        _(parentTreeCanvas, [divCanvas]);\r\n    else\r\n        parentTreeCanvas.insertBefore(divCanvas, parentTreeCanvas.firstChild);\r\n\r\n    _(divCanvas, [divChilds]);\r\n\r\n    // for (var type in geomsPresent)\r\n    // {\r\n        // var elemCanvas = _div(null, [['css','padding','2px'],['attr','geometryType', type]]),\r\n            // //icon = _mapHelper.createStylesEditorIcon([{MinZoom:1,MaxZoom:20,RenderStyle:styles[type]}], type.toLowerCase()),\r\n            // spanElem = _span(null, [['dir','className','layerfeature']]);\r\n\r\n        // if (type == 'Point')\r\n            // _(spanElem, [_t(_gtxt('точки'))]);\r\n        // else if (type == 'LineString')\r\n            // _(spanElem, [_t(_gtxt('линии'))]);\r\n        // else if (type == 'Polygon')\r\n            // _(spanElem, [_t(_gtxt('полигоны'))]);\r\n\r\n        // var icon;\r\n        // (function(type){\r\n            // icon = _mapHelper.createWFSStylesEditor(parent[type], styles[type], type.toLowerCase(), divCanvas)\r\n        // })(type);\r\n\r\n        // if (typeof loadLayerParams != 'undefined' && loadLayerParams[type.toLowerCase()])\r\n        // {\r\n            // var info = loadLayerParams[type.toLowerCase()];\r\n\r\n            // elemCanvas.graphDataType = info.graphDataType;\r\n            // elemCanvas.graphDataProperties = info.graphDataProperties;\r\n        // }\r\n        // else\r\n        // {\r\n            // elemCanvas.graphDataType = \"func\";\r\n            // elemCanvas.graphDataProperties = \"\";\r\n        // }\r\n\r\n        // _(elemCanvas, [icon, spanElem])\r\n        // _(divChilds, [elemCanvas]);\r\n\r\n    // }\r\n\r\n    //globalFlashMap.zoomToExtent(bounds.minX, bounds.minY, bounds.maxX, bounds.maxY);\r\n    nsGmx.leafletMap.fitBounds([[bounds.min.y, bounds.min.x], [bounds.max.y, bounds.max.x]]);\r\n\r\n    box.checked = true;\r\n}\r\n\r\n//loadParams - параметры для отдельных слоёв\r\n//serverParams - параметры сервера, которые были указаны пользователем.\r\nqueryServerData.prototype.drawWMS = function(serviceLayers, url, replaceElem, loadParams, serverParams)\r\n{\r\n    var ulCanvas = _ul(null, [['css','paddingBottom','5px'], ['attr','url',url]]),\r\n        ulChilds = _ul(),\r\n        remove = makeImageButton('img/closemin.png','img/close_orange.png'),\r\n\r\n        lmap = nsGmx.leafletMap;\r\n\r\n    $(replaceElem).replaceWith(ulCanvas)\r\n\r\n    $(ulCanvas).data('serverParams', serverParams);\r\n\r\n    remove.onclick = function()\r\n    {\r\n        for (var i = 0; i < ulChilds.childNodes.length; i++)\r\n        {\r\n            ulChilds.childNodes[i].firstChild.lastChild.clear && ulChilds.childNodes[i].firstChild.lastChild.clear();\r\n            lmap.removeLayer(ulChilds.childNodes[i].firstChild.lastChild.gmxObject);\r\n        }\r\n\r\n        this.parentNode.parentNode.parentNode.removeNode(true);\r\n    }\r\n\r\n    remove.className = 'remove';\r\n    remove.style.right = '0px';\r\n\r\n    _(ulCanvas, [_li([_div([_span([_t(url.length < 45 ? url : url.substr(0, 45) + '...')],[['dir','className','urlHeader']]), remove],[['css','position','relative']]), ulChilds])])\r\n\r\n    var clickFunc = function(layer, parent, flag)\r\n    {\r\n        if (!flag) {\r\n            lmap.removeLayer(parent);\r\n        } else {\r\n            updateFunc(layer, parent);\r\n            lmap.addLayer(parent);\r\n        }\r\n    }\r\n\r\n    var updateFunc = function(layer, parent)\r\n    {\r\n        var requestParams = {}\r\n        if (serverParams && serverParams.format)\r\n        {\r\n            requestParams.format = \"image/\" + serverParams.format;\r\n            requestParams.transparent = serverParams.format === 'png';\r\n        }\r\n\r\n        var res = getWMSMapURL(url, layer, requestParams);\r\n\r\n        if (res)\r\n        {\r\n            var b = res.bounds;\r\n            parent.clearLayers();\r\n            parent.addLayer(L.imageOverlay(window.serverBase + \"ImgSave.ashx?now=true&get=\" + encodeURIComponent(res.url), L.latLngBounds([[b.minY, b.minX], [b.maxY, b.maxX]])));\r\n        }\r\n    }\r\n\r\n    serviceLayers.forEach(function(layer)\r\n    {\r\n        var elemCanvas = _div(null, [['css','padding','2px']]),\r\n            box = _checkbox(false, 'checkbox'),\r\n            spanElem = _span([_t(layer.title)], [['css','cursor','pointer'],['dir','className','layerfeature']]),\r\n            parent = L.layerGroup().addTo(nsGmx.leafletMap);\r\n\r\n        spanElem.gmxObject = parent;\r\n\r\n        box.className = 'floatLeft';\r\n\r\n        spanElem.onclick = function()\r\n        {\r\n            if (!box.checked)\r\n                box.checked = true;\r\n\r\n            clickFunc(layer, parent, true);\r\n        }\r\n        box.onclick = function()\r\n        {\r\n            clickFunc(layer, parent, this.checked);\r\n        }\r\n        box.update = function()\r\n        {\r\n            updateFunc(layer, parent);\r\n        }\r\n\r\n        box.setAttribute('layerName', layer.name);\r\n\r\n        _(elemCanvas, [box, spanElem]);\r\n        _(ulChilds, [_li([elemCanvas])]);\r\n\r\n        if (typeof loadParams != 'undefined' && loadParams[layer.name])\r\n            $(spanElem).trigger(\"click\");\r\n    });\r\n\r\n    $(ulCanvas).treeview();\r\n\r\n    nsGmx.leafletMap.on('moveend', function()\r\n    {\r\n        var boxes = ulChilds.getElementsByTagName('input');\r\n\r\n        for (var i = 0; i < boxes.length; i++)\r\n        {\r\n            if (boxes[i].checked)\r\n                boxes[i].update();\r\n        }\r\n    })\r\n}\r\n\r\n//Добавляет контрол выбора формата запроса к WMS и возвращает его в параметре format (пример: \"png\", \"jpg\")\r\nqueryServerData.prototype.customWMSParamsManager = (function()\r\n{\r\n    var _targetDiv = null;\r\n    return {\r\n        init: function(targetDiv)\r\n        {\r\n            var select = nsGmx.Utils._select([_option([_t('png')]), _option([_t('jpeg')])], [['dir','className','selectStyle'], ['css', 'width', '60px']]);\r\n            _targetDiv = targetDiv;\r\n            _(_targetDiv, [_t(_gtxt('Формат изображения') + ': '), select]);\r\n            _targetDiv.style.marginBottom = '5px';\r\n        },\r\n        collect: function() {\r\n            return { format: $(\"option:selected\", _targetDiv).text() };\r\n        }\r\n    }\r\n})();\r\n\r\nqueryServerData.prototype.drawWFS = function(serviceLayers, url, replaceElem, loadParams)\r\n{\r\n    var ulCanvas = _ul(null, [['css','paddingBottom','5px'], ['attr','url',url]]),\r\n        ulChilds = _ul(),\r\n        divFormat = _div(),\r\n        remove = makeImageButton('img/closemin.png','img/close_orange.png'),\r\n        _this = this;\r\n\r\n    $(replaceElem).replaceWith(ulCanvas)\r\n\r\n    remove.onclick = function()\r\n    {\r\n        for (var i = 0; i < ulChilds.childNodes.length; i++)\r\n            ulChilds.childNodes[i].firstChild.lastChild.clear && ulChilds.childNodes[i].firstChild.lastChild.clear();\r\n\r\n        this.parentNode.parentNode.parentNode.removeNode(true);\r\n    }\r\n\r\n    remove.className = 'remove';\r\n    remove.style.right = '0px';\r\n\r\n    _(ulCanvas, [_li([_div([_span([_t(url.length < 45 ? url : url.substr(0, 45) + '...')],[['dir','className','urlHeader']]), divFormat, remove],[['css','position','relative']]), ulChilds])]);\r\n\r\n    var formatSelect = nsGmx.Utils._select([_option([_t(\"JSON\")], [['attr','value','json']]),\r\n                                _option([_t(\"GML / KML\")], [['attr','value','gml']])], [['dir','className','selectStyle'],['css','width','100px']]);\r\n\r\n    _(divFormat, [formatSelect]);\r\n\r\n    var clickFunc = function(layer, flag, elemCanvas, box, header, loadLayerParams)\r\n    {\r\n        if (flag) {\r\n            var newFormat = formatSelect.value;\r\n\r\n            // загружаем данные только один раз\r\n            if (!elemCanvas.loaded || elemCanvas.format != newFormat)\r\n            {\r\n                elemCanvas.clear && elemCanvas.clear();\r\n\r\n                var separator = url.indexOf('?') !== -1 ? '&' : '?';\r\n\r\n                var objUrl = url + separator + \"request=GetFeature&version=1.0.0&typeName=\" + layer.name;\r\n\r\n                if (formatSelect.value == 'json')\r\n                    objUrl += '&outputFormat=json'\r\n\r\n                _this.loadGML(objUrl, elemCanvas, box, header, newFormat, loadLayerParams, layer.srs);\r\n\r\n                elemCanvas.loaded = true;\r\n                elemCanvas.format = newFormat;\r\n\r\n                var loading = _div([_img(null, [['attr','src','img/progress.gif'],['css','marginRight','10px']]), _t(_gtxt('загрузка...'))], [['css','margin','3px 0px']]);\r\n\r\n                _(elemCanvas, [loading]);\r\n            }\r\n            else if (typeof elemCanvas.loaded == 'function') {\r\n                elemCanvas.loaded();\r\n            }\r\n        }\r\n    }\r\n\r\n    for (var i = 0; i < serviceLayers.length; i++)\r\n    {\r\n        var elemCanvas = _div(null, [['css','padding','2px']]),\r\n            box = _checkbox(false, 'checkbox'),\r\n            spanElem = _span([_t(serviceLayers[i].title != '' ? serviceLayers[i].title : serviceLayers[i].name)],[['css','cursor','pointer'],['dir','className','layerfeature']]),\r\n            elemChilds = _div(null, [['css','marginLeft','20px']]);\r\n\r\n        box.className = 'floatLeft';\r\n\r\n        box.setAttribute('layerName', serviceLayers[i].name);\r\n\r\n        (function(layer, parentTreeCanvas, box, header){\r\n            spanElem.onclick = function()\r\n            {\r\n                if (!box.checked)\r\n                    box.checked = true;\r\n\r\n                clickFunc.call(_this, layer, true, parentTreeCanvas, box, header);\r\n            }\r\n            box.onclick = function()\r\n            {\r\n                clickFunc.call(_this, layer, this.checked, parentTreeCanvas, box, header);\r\n            }\r\n        })(serviceLayers[i], elemChilds, box, spanElem);\r\n\r\n        _(elemCanvas, [box, _div([spanElem],[['css','display','inline']]), elemChilds])\r\n        _(ulChilds, [_li([elemCanvas])])\r\n\r\n        if (typeof loadParams != 'undefined' && loadParams[serviceLayers[i].name])\r\n        {\r\n            if (!box.checked)\r\n                box.checked = true;\r\n\r\n            formatSelect.value = loadParams[serviceLayers[i].name].format;\r\n            clickFunc.call(_this, serviceLayers[i], true, elemChilds, box, spanElem, loadParams[serviceLayers[i].name].info);\r\n        }\r\n    }\r\n\r\n    $(ulCanvas).treeview();\r\n}\r\n\r\n\r\nvar _queryServerDataWFS = new queryServerData(),\r\n    _queryServerDataWMS = new queryServerData();\r\n\r\nloadServerData.WFS.load = function()\r\n{\r\n    var alreadyLoaded = _queryServerDataWFS.createWorkCanvas(arguments[0]);\r\n\r\n    if (!alreadyLoaded)\r\n        _queryServerDataWFS.load('WFS', _queryServerDataWFS.parseWFSCapabilities, _queryServerDataWFS.drawWFS, null, '1.0.0');\r\n}\r\nloadServerData.WFS.unload = function()\r\n{\r\n//  removeChilds($$('leftContent'))\r\n}\r\n\r\nloadServerData.WMS.load = function()\r\n{\r\n    var alreadyLoaded = _queryServerDataWMS.createWorkCanvas(arguments[0]);\r\n\r\n    if (!alreadyLoaded)\r\n        _queryServerDataWMS.load('WMS', parseWMSCapabilities, _queryServerDataWMS.drawWMS, _queryServerDataWMS.customWMSParamsManager);\r\n}\r\nloadServerData.WMS.unload = function()\r\n{\r\n//  removeChilds($$('leftContent'))\r\n}\r\n\r\nnsGmx.userObjectsManager.addDataCollector('wms', {\r\n    collect: function()\r\n    {\r\n        if (!_queryServerDataWMS.workCanvas)\r\n            return null;\r\n\r\n        var value = {};\r\n\r\n        $(_queryServerDataWMS.workCanvas.lastChild).children(\"ul[url]\").each(function()\r\n        {\r\n            var url = this.getAttribute('url');\r\n            var serverParams = $(this).data('serverParams');\r\n\r\n            value[url] = {params: serverParams, layersVisibility: {}};\r\n\r\n            $(this).find(\"input[type='checkbox']\").each(function()\r\n            {\r\n                if (this.checked)\r\n                {\r\n                    value[url].layersVisibility[this.getAttribute('layerName')] = true;\r\n                }\r\n            })\r\n        })\r\n\r\n        if (!objLength(value))\r\n            return null;\r\n\r\n        return value;\r\n    },\r\n\r\n    load: function(data)\r\n    {\r\n        if (!data)\r\n            return;\r\n\r\n        $('#left_wms').remove();\r\n\r\n        _queryServerDataWMS.builded = false;\r\n\r\n        loadServerData.WMS.load('wms');\r\n\r\n        for (var url in data)\r\n        {\r\n            (function(loadParams)\r\n            {\r\n                //поддержка старого формата данных\r\n                if (!('layersVisibility' in loadParams))\r\n                {\r\n                    loadParams = {layersVisibility: loadParams};\r\n                }\r\n\r\n                _queryServerDataWMS.getCapabilities('WMS', url, parseWMSCapabilities, function(serviceLayers, url, replaceElem)\r\n                {\r\n                    _queryServerDataWMS.drawWMS(serviceLayers, url, replaceElem, loadParams.layersVisibility, loadParams.params);\r\n                })\r\n            })(data[url])\r\n        }\r\n    }\r\n})\r\n\r\nnsGmx.userObjectsManager.addDataCollector('wfs', {\r\n    collect: function()\r\n    {\r\n        if (!_queryServerDataWFS.workCanvas)\r\n            return null;\r\n\r\n        var value = {};\r\n\r\n        $(_queryServerDataWFS.workCanvas.lastChild).children(\"ul[url]\").each(function()\r\n        {\r\n            var url = this.getAttribute('url');\r\n\r\n            value[url] = {};\r\n\r\n            $(this).find(\"input[type='checkbox']\").each(function()\r\n            {\r\n                if (this.checked)\r\n                {\r\n                    var wfsLayerInfo = {};\r\n\r\n                    $(this.parentNode.lastChild).find(\".colorIcon\").each(function()\r\n                    {\r\n                        wfsLayerInfo[this.geometryType] = {RenderStyle: this.getStyle(), graphDataType: this.parentNode.graphDataType, graphDataProperties: this.parentNode.graphDataProperties}\r\n                    })\r\n\r\n                    value[url][this.getAttribute('layerName')] = {format: this.parentNode.lastChild.format, info: wfsLayerInfo};\r\n                }\r\n            })\r\n        })\r\n\r\n        if (!objLength(value))\r\n            return null;\r\n\r\n        return value;\r\n    },\r\n\r\n    load: function(data)\r\n    {\r\n        if (!data)\r\n            return;\r\n\r\n        $('#left_wfs').remove();\r\n\r\n        _queryServerDataWFS.builded = false;\r\n\r\n        loadServerData.WFS.load('wfs');\r\n\r\n        for (var url in data)\r\n        {\r\n            (function(loadParams)\r\n            {\r\n                _queryServerDataWFS.getCapabilities('WFS', url, _queryServerDataWFS.parseWFSCapabilities, function(serviceLayers, url, replaceElem)\r\n                {\r\n                    _queryServerDataWFS.drawWFS(serviceLayers, url, replaceElem, loadParams);\r\n                }, '1.0.0')\r\n            })(data[url])\r\n        }\r\n    }\r\n});\r\n\r\nexport {loadServerData};","﻿import nsGmx from './nsGmx.js';\r\n \r\n/**\r\n    Возвращает массив ссылок в верхнее левое мета-меню в формате HeaderWidget из CommonComponents.\r\n    Считывает информацию из window.gmxViewerUI.headerLinkItems в формате [{icon: iconPath, title: TITLE, href: HREF}, ...] (формат ГеоМиксера)\r\n    Если переменной нет, подставляет значения по умолчению (\"Карта пожаров\", \"Поиск снимков\", \"Платформа Геомиксер\")\r\n    @memberOf nsGmx\r\n*/\r\nnsGmx.addHeaderLinks = function()\r\n{\r\n    var isHeaderLinks = false;\r\n    if ( typeof window.headerLinks === 'boolean' ) isHeaderLinks = window.headerLinks; //совместимость с предыдущими версиями\r\n    if ( typeof window.gmxViewerUI !== 'undefined' && typeof window.gmxViewerUI.headerLinks !== 'undefined' )\r\n        isHeaderLinks = window.gmxViewerUI.headerLinks;\r\n\r\n    if (!isHeaderLinks) {\r\n        return [];\r\n    }\r\n\r\n    var items = (window.gmxViewerUI && window.gmxViewerUI.headerLinkItems) ||\r\n        [\r\n            {title: _gtxt(\"Карта пожаров\"), href: _gtxt(\"http://fires.ru\"), newWindow: true},\r\n            {title: _gtxt(\"Поиск снимков\"), href: _gtxt(\"https://search.kosmosnimki.ru\"), newWindow: true},\r\n            {title: _gtxt(\"Платформа Геомиксер\"), newWindow: true, id: 'HeaderLinkGeoMixer'}\r\n        ];\r\n\r\n    return $.extend(true, [], items).map(function(item, index) {\r\n        item.link = item.href;\r\n        return {\r\n            id: 'headerLinksItem' + index,\r\n            title: item.title,\r\n            func: function(){\r\n                if (item.link) {\r\n                    window.open(item.link, '_blank');\r\n                }\r\n            }.bind(item)\r\n        }\r\n    })\r\n}\r\n","import nsGmx from '../nsGmx.js';\r\nimport './TransparencySliderWidget.css';\r\n\r\nnsGmx.TransparencySliderWidget = function(container) {\r\n    var _this = this;\r\n    var ui = $(Handlebars.compile(\r\n\t\t'<div class=\"leaflet-gmx-iconSvg leaflet-gmx-iconSvg-transparency svgIcon leaflet-control gmx-transslider-toggle-icon\" title=\"{{i \"TransparencySliderWidget.title\"}}\"><svg role=\"img\" class=\"svgIcon\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#transparency\"></use></svg></div>' +\r\n        '<div class = \"gmx-transslider-container\"></div>' +\r\n        '<div class = \"leaflet-gmx-iconSvg leaflet-gmx-iconSvg-transparency-eye svgIcon leaflet-gmx-iconSvg-active leaflet-control gmx-transslider-onoff\" title=\"{{i \"TransparencySliderWidget.onOffTitle\"}}\"><svg role=\"img\" class=\"svgIcon gmx-transslider-hide\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#transparency-eye\"></use></svg><svg role=\"img\" class=\"svgIcon\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#transparency-eye-off\"></use></svg></div>'\r\n    )());\r\n    ui.appendTo(container);\r\n\r\n    var sliderContainer = container.find('.gmx-transslider-container');\r\n\r\n    this._isCollapsed = true;\r\n\r\n    container.find('.gmx-transslider-toggle-icon').click(function() {\r\n        this._isCollapsed = !this._isCollapsed;\r\n        sliderContainer.toggle(!this._isCollapsed);\r\n        container.find('.gmx-transslider-onoff').toggle(!this._isCollapsed);\r\n        container.find('.gmx-transslider-toggle-icon').toggleClass('leaflet-gmx-iconSvg-active', !this._isCollapsed);\r\n    }.bind(this));\r\n\r\n    var isOpaque = true;\r\n    var updateOnOffIcon = function(value) {\r\n        var isOpaqueNew = value === 1.0;\r\n        if (isOpaqueNew !== isOpaque) {\r\n            isOpaque = isOpaqueNew;\r\n            var arr = container.find('.gmx-transslider-onoff')[0].childNodes;\r\n\t\t\tif (isOpaque) {\r\n\t\t\t\tL.DomUtil.removeClass(arr[1], 'gmx-transslider-hide');\r\n\t\t\t\tL.DomUtil.addClass(arr[0], 'gmx-transslider-hide');\r\n\t\t\t} else {\r\n\t\t\t\tL.DomUtil.removeClass(arr[0], 'gmx-transslider-hide');\r\n\t\t\t\tL.DomUtil.addClass(arr[1], 'gmx-transslider-hide');\r\n\t\t\t}\r\n        }\r\n    }\r\n\r\n    sliderContainer.slider({\r\n        range: 'min',\r\n        min: 0.0,\r\n        max: 1.0,\r\n        step: 0.01,\r\n        value: 1.0,\r\n        change: function(event, ui) {\r\n            $(_this).triggerHandler(event, ui);\r\n            updateOnOffIcon(ui.value);\r\n        },\r\n        slide: function(event, ui) {\r\n            $(_this).triggerHandler(event, ui);\r\n            updateOnOffIcon(ui.value);\r\n        }\r\n    }).hide();\r\n\r\n    // fix map moving in IE\r\n    if (nsGmx.leafletMap) {\r\n        var dragging = nsGmx.leafletMap.dragging;\r\n        L.DomEvent\r\n            .on(sliderContainer[0], 'mouseover', dragging.disable, dragging)\r\n            .on(sliderContainer[0], 'mouseout', dragging.enable, dragging);\r\n    }\r\n\r\n    container.find('.gmx-transslider-onoff').click(function(){\r\n        var curValue = sliderContainer.slider('value');\r\n        sliderContainer.slider('value', curValue !== 1.0 ? 1.0 : 0.0);\r\n    }).hide();\r\n\r\n    container.on('mousedown click', function(event) {\r\n        event.stopPropagation();\r\n    });\r\n}\r\n\r\nnsGmx.TransparencySliderWidget.prototype.isCollapsed = function() {\r\n    return this._isCollapsed;\r\n};\r\n\r\nnsGmx.Translations.addText('rus', { TransparencySliderWidget: {\r\n    title: 'Прозрачность растровых слоёв',\r\n    onOffTitle: 'Показать/скрыть растры'\r\n}});\r\n                         \r\nnsGmx.Translations.addText(\"eng\", { TransparencySliderWidget: {\r\n    title: 'Raster layers transparency',\r\n    onOffTitle: 'Show/hide rasters'\r\n}});","import './gmxLayers2.css';\r\n\r\nL.Control.GmxLayers2 = L.Control.Layers.extend({\r\n    options: {\r\n        collapsed: true,\r\n        autoZIndex: false,\r\n        id: 'layers'\r\n    },\r\n\r\n    initialize: function (baseLayers, overlays, options) {\r\n        L.Control.Layers.prototype.initialize.call(this, baseLayers, overlays, options);\r\n    },\r\n    onAdd: function (map) {\r\n        L.Control.Layers.prototype.onAdd.call(this, map);\r\n        this.init = false;\r\n        this._initLayout();\r\n        this._update();\r\n\r\n        this._iconClick = function () {\r\n            if (this._iconContainer) {\r\n                this.setActive(!this.options.isActive);\r\n                this._update();\r\n                if (this.options.stateChange) { this.options.stateChange(this); }\r\n            }\r\n        };\r\n        var stop = L.DomEvent.stopPropagation;\r\n        L.DomEvent\r\n            .on(this._iconContainer, 'mousemove', stop)\r\n            .on(this._iconContainer, 'touchstart', stop)\r\n            .on(this._iconContainer, 'mousedown', stop)\r\n            .on(this._iconContainer, 'dblclick', stop)\r\n            .on(this._iconContainer, 'click', stop)\r\n            .on(this._iconContainer, 'click', this._iconClick, this);\r\n\r\n        return this._container;\r\n    },\r\n\r\n    _initLayout: function () {\r\n        var controlClassName = 'leaflet-control-layers2',\r\n            prefix = 'leaflet-gmx-iconSvg',\r\n            iconClassName =  prefix + ' ' + prefix + '-overlays svgIcon',\r\n            listClassName = 'leaflet-control-layers',\r\n            container = this._container = L.DomUtil.create('div', controlClassName),\r\n            iconContainer = this._iconContainer = L.DomUtil.create('div', iconClassName),\r\n            listContainer = this._listContainer = L.DomUtil.create('div', listClassName);\r\n\r\n        var openingDirection = this.options.direction || 'bottom';\r\n\r\n        L.DomUtil.addClass(listContainer, listClassName + '-' + openingDirection);\r\n        if (this.options.title) { this._iconContainer.title = this.options.title; }\r\n\r\n        this._prefix = prefix;\r\n\r\n        //Makes this work on IE10 Touch devices by stopping it from firing a mouseout event when the touch is released\r\n        container.setAttribute('aria-haspopup', true);\r\n\r\n        if (!L.Browser.touch) {\r\n            L.DomEvent\r\n                .disableClickPropagation(container)\r\n                .disableScrollPropagation(container);\r\n        } else {\r\n            L.DomEvent.on(container, 'click', L.DomEvent.stopPropagation);\r\n        }\r\n\r\n        var placeHolder = this._placeHolder = L.DomUtil.create('div', 'layers-placeholder');\r\n        placeHolder.innerHTML = this.options.placeHolder;\r\n\r\n        var form = this._form = L.DomUtil.create('form', listClassName + '-list');\r\n\r\n        if (this.options.collapsed) {\r\n\r\n          var useHref = '#' + 'overlays';\r\n          iconContainer.innerHTML = '<svg role=\"img\" class=\"svgIcon\">\\\r\n              <use xlink:href=\"' + useHref + '\"></use>\\\r\n            </svg>';\r\n\r\n            var link = this._layersLink = L.DomUtil.create('a', '', listContainer);\r\n            link.href = '#';\r\n            link.title = 'Layers';\r\n\r\n            if (L.Browser.touch) {\r\n                L.DomEvent\r\n                    .on(iconContainer, 'click', L.DomEvent.stop)\r\n                    .on(iconContainer, 'click', this._expand, this);\r\n            }\r\n            //Work around for Firefox android issue https://github.com/Leaflet/Leaflet/issues/2033\r\n            L.DomEvent.on(form, 'click', function () {\r\n                setTimeout(L.bind(this._onInputClick, this), 0);\r\n            }, this);\r\n\r\n            this._map.on('click', this._collapse, this);\r\n        } else {\r\n            this._expand();\r\n        }\r\n\r\n        this._baseLayersList = L.DomUtil.create('div', listClassName + '-base', form);\r\n        this._separator = L.DomUtil.create('div', listClassName + '-separator', form);\r\n        this._overlaysList = L.DomUtil.create('div', listClassName + '-overlays', form);\r\n\r\n        listContainer.appendChild(form);\r\n        listContainer.appendChild(placeHolder);\r\n        container.appendChild(iconContainer);\r\n        container.appendChild(listContainer);\r\n        if (!this.init) { container.style.display = 'none'; }\r\n    },\r\n\r\n    _addLayer: function (layer, name, overlay) {\r\n        if (Object.keys(this._layers).length === 0) {\r\n            this.init = true;\r\n        }\r\n\r\n        L.Control.Layers.prototype._addLayer.call(this, layer, name, overlay);\r\n    },\r\n\r\n    _addItemObject: function (obj) {\r\n        var label = this._addItem(obj);\r\n        if (obj.layer && obj.layer._gmx && obj.layer._gmx.layerID) {\r\n            label.className = '_' + obj.layer._gmx.layerID;\r\n        }\r\n    },\r\n\r\n    _addItem: function (obj) {\r\n        if (L.version === '0.7.7') {\r\n            let label = document.createElement('label'),\r\n            input,\r\n            checked = this._map.hasLayer(obj.layer);\r\n\r\n            if (obj.overlay) {\r\n                input = document.createElement('input');\r\n                input.type = 'checkbox';\r\n                input.className = 'leaflet-control-layers-selector';\r\n                input.defaultChecked = checked;\r\n            } else {\r\n                input = this._createRadioElement('leaflet-base-layers', checked);\r\n            }\r\n\r\n            input.layerId = L.stamp(obj.layer);\r\n\r\n            L.DomEvent.on(input, 'click', this._onInputClick, this);\r\n\r\n            let name = document.createElement('span');\r\n            name.innerHTML = ' ' + obj.name;\r\n\r\n            label.appendChild(input);\r\n            label.appendChild(name);\r\n\r\n            let container = obj.overlay ? this._overlaysList : this._baseLayersList;\r\n            container.appendChild(label);\r\n\r\n            return label;\r\n        } else {\r\n            let label = document.createElement('label'),\r\n                checked = this._map.hasLayer(obj.layer),\r\n                input;\r\n\r\n            if (obj.overlay) {\r\n                input = document.createElement('input');\r\n                input.type = 'checkbox';\r\n                input.className = 'leaflet-control-layers-selector';\r\n                input.defaultChecked = checked;\r\n            } else {\r\n                input = this._createRadioElement('leaflet-base-layers', checked);\r\n            }\r\n\r\n            let presentLayer, presentIndex;\r\n\r\n            for (let i = 0; i < this._layerControlInputs.length; i++) {\r\n                let inp = this._layerControlInputs[i];\r\n                if (inp.layerId === obj.layer._leaflet_id) {\r\n                    presentLayer = inp;\r\n                }\r\n            }\r\n\r\n            presentIndex =  this._layerControlInputs.indexOf(presentLayer);\r\n\r\n            if (presentLayer) {\r\n                this._layerControlInputs = [].concat(\r\n                    this._layerControlInputs.slice(0, presentIndex),\r\n                    input,\r\n                    this._layerControlInputs.slice(presentIndex + 1, this._layerControlInputs.length));\r\n            } else {\r\n                this._layerControlInputs.push(input);\r\n            }\r\n\r\n            input.layerId = L.Util.stamp(obj.layer);\r\n\r\n            L.DomEvent.on(input, 'click', this._onInputClick, this);\r\n\r\n            let name = document.createElement('span');\r\n            name.innerHTML = ' ' + obj.name;\r\n\r\n            // Helps from preventing layer control flicker when checkboxes are disabled\r\n            // https://github.com/Leaflet/Leaflet/issues/2771\r\n            let holder = document.createElement('div');\r\n\r\n            label.appendChild(holder);\r\n            holder.appendChild(input);\r\n            holder.appendChild(name);\r\n\r\n            let container = obj.overlay ? this._overlaysList : this._baseLayersList;\r\n            container.appendChild(label);\r\n\r\n            this._checkDisabledLayers();\r\n            return label;\r\n        }\r\n    },\r\n\r\n    _update: function () {\r\n        if (!this._listContainer) {\r\n            return;\r\n        }\r\n        var options = this.options;\r\n\r\n        if (this.init) {\r\n            this._container.style.display = '';\r\n            this.setActive(false);\r\n            this.init = false;\r\n        }\r\n\r\n        this._baseLayersList.innerHTML = '';\r\n        this._overlaysList.innerHTML = '';\r\n\r\n        var baseLayersPresent = false,\r\n            overlaysPresent = false,\r\n            obj;\r\n\r\n        for (let i in this._layers) {\r\n            obj = this._layers[i];\r\n            if (obj.overlay) {\r\n                this._addItemObject(obj);\r\n                overlaysPresent = true;\r\n            } else {\r\n                baseLayersPresent = true;\r\n            }\r\n        }\r\n\r\n        this._container.style.display = overlaysPresent ? '' : 'none';\r\n\r\n        this._separator.style.display = overlaysPresent && baseLayersPresent ? '' : 'none';\r\n        this._form.style.display = overlaysPresent || baseLayersPresent ? '' : 'none';\r\n        this._placeHolder.style.display = overlaysPresent || baseLayersPresent ? 'none' : '';\r\n\r\n        if (!options.isActive) {\r\n            this._form.style.display = 'none';\r\n            this._placeHolder.style.display = 'none';\r\n        }\r\n    },\r\n\r\n    _expand: function () {\r\n        L.DomUtil.addClass(this._listContainer, 'leaflet-control-layers-expanded');\r\n    },\r\n\r\n    _collapse: function () {\r\n        this._listContainer.className = this._listContainer.className.replace(' leaflet-control-layers-expanded', '');\r\n        this.setActive(false);\r\n    },\r\n\r\n    setActive: function (active) {\r\n        var options = this.options,\r\n            togglable = options.togglable || options.toggle;\r\n        if (togglable) {\r\n            let prefix = this._prefix,\r\n                className = prefix + '-' + options.id,\r\n                container = this._iconContainer;\r\n\r\n            options.isActive = active;\r\n            if (active) {\r\n                L.DomUtil.addClass(container, prefix + '-active');\r\n                L.DomUtil.addClass(container, className + '-active');\r\n                if (container.children.length) {\r\n                    L.DomUtil.addClass(container, prefix + '-externalImage-active');\r\n                }\r\n                if (options.styleActive) { this.setStyle(options.styleActive); }\r\n\r\n                L.DomUtil.addClass(this._listContainer, 'leaflet-control-layers-expanded');\r\n            } else {\r\n                L.DomUtil.removeClass(container, prefix + '-active');\r\n                L.DomUtil.removeClass(container, className + '-active');\r\n                if (container.children.length) {\r\n                    L.DomUtil.removeClass(container, prefix + '-externalImage-active');\r\n                }\r\n                if (options.style) { this.setStyle(options.style); }\r\n                L.DomUtil.removeClass(this._listContainer, 'leaflet-control-layers-expanded');\r\n            }\r\n            // ugly bug in IE\r\n            // IE appends 'extended' class to the parent!\r\n            if (L.DomUtil.hasClass(this._container, 'leaflet-control-layers-expanded')) {\r\n                L.DomUtil.removeClass(this._container, 'leaflet-control-layers-expanded')\r\n            }\r\n        }\r\n    },\r\n\r\n    addTo: function (map) {\r\n        // L.Control.prototype.addTo.call(this, map);\r\n        L.Control.GmxIcon.prototype.addTo.call(this, map);\r\n        if (this.options.addBefore) {\r\n            this.addBefore(this.options.addBefore);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    addBefore: function (id) {\r\n        var parentNode = this._parent && this._parent._container;\r\n        if (!parentNode) {\r\n            parentNode = this._map && this._map._controlCorners[this.getPosition()];\r\n        }\r\n        if (!parentNode) {\r\n            this.options.addBefore = id;\r\n        } else {\r\n            for (var i = 0, len = parentNode.childNodes.length; i < len; i++) {\r\n                var it = parentNode.childNodes[i];\r\n                if (id === it._id) {\r\n                    parentNode.insertBefore(this._container, it);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n});\r\n\r\nL.Control.gmxLayers2 = L.Control.GmxLayers2;\r\nL.control.gmxLayers2 = function (baseLayers, overlays, options) {\r\n  return new L.Control.GmxLayers2(baseLayers, overlays, options);\r\n};\r\n","'use strict';\r\n\r\nvar gmxMediaDescription = function gmxMediaDescription(descField, descData, storeDescFieldName, mode, mediaLayerName, mediaObjId, mediaLayer, dialogSettings) {\r\n  //Основные переменные\r\n  var editor,\r\n      mediaDescDialog = jQuery('<div class=\"mediaDesc-Div\"><img src=\"' + pluginPath + 'addit/media_img_load.gif\"></img></div>'),\r\n      mediaDescDialogTitle,\r\n      mediaDescTextArea = jQuery('<textarea name=\"mediaDescInput\" id=\"mediaDescInput\"></textarea>'),\r\n      exp1 = /(?:^|[^\"'])(\\b((https?|ftp):\\/\\/[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]))/gim,\r\n      exp2 = /(?:^|[^\"'https?:\\/\\/])(\\b((www.)[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]))/gim; //descData = descData.replace(exp1, '<a href=\"$1\" target=\"_blank\">$1</a>'); //Проверяем текст на наличие ссылок вида http/ftp и превращаем в URL.\r\n  //descData = descData.replace(exp2, '<a href=\"http://$1\" target=\"_blank\">$1</a>'); //Проверяем текст на наличие ссылок вида www и превращаем в URL.\r\n  //Основные функции диалога\r\n  //Исправление бага с окном добавления ссылок через CKEditor в модальном режиме диалога описания\r\n\r\n  $.widget(\"ui.dialog\", $.ui.dialog, {\r\n    //  jQuery UI - v1.10.2 - 2013-12-12\r\n    //  http://bugs.jqueryui.com/ticket/9087#comment:27 - bugfix\r\n    //  http://bugs.jqueryui.com/ticket/4727#comment:23 - bugfix\r\n    //  allowInteraction fix to accommodate windowed editors\r\n    _allowInteraction: function _allowInteraction(event) {\r\n      if (this._super(event)) {\r\n        return true;\r\n      } // address interaction issues with general iframes with the dialog\r\n\r\n\r\n      if (event.target.ownerDocument != this.document[0]) {\r\n        return true;\r\n      } // address interaction issues with dialog window\r\n\r\n\r\n      if ($(event.target).closest(\".cke_dialog\").length) {\r\n        return true;\r\n      } // address interaction issues with iframe based drop downs in IE\r\n\r\n\r\n      if ($(event.target).closest(\".cke\").length) {\r\n        return true;\r\n      }\r\n    },\r\n    // jQuery UI - v1.10.2 - 2013-10-28\r\n    //  http://dev.ckeditor.com/ticket/10269 - bugfix\r\n    //  moveToTop fix to accommodate windowed editors\r\n    _moveToTop: function _moveToTop(event, silent) {\r\n      if (!event || !this.options.modal) {\r\n        this._super(event, silent);\r\n      }\r\n    }\r\n  }); //Функция сохранения описание из Режима Чтения (данные записываются сразу в слой)\r\n\r\n  var saveDescfromReadMode = function saveDescfromReadMode() {\r\n    var newData = mediaDescTextArea.val();\r\n    var descriptionLength = newData.length;\r\n    var edata = editor.getData();\r\n    newData = edata.replace(/>/gim, '> ');\r\n    newData = newData.replace(exp1, ' <a href=\"$1\" target=\"_blank\">$1</a> ' + ' ');\r\n    newData = newData.replace(exp2, ' <a href=\"http://$1\" target=\"_blank\">$1</a> ' + ' ');\r\n\r\n    if (descriptionLength > 5000) {\r\n      var descriptionLengthDIFF = descriptionLength - 5000;\r\n      alert(_gtxt('mediaPlugin2.mediaDescDialogLimit.alert') + descriptionLengthDIFF + _gtxt('mediaPlugin2.mediaDescDialogSymbols.alert'));\r\n    } else {\r\n      _mapHelper.modifyObjectLayer(mediaLayerName, [{\r\n        id: mediaObjId,\r\n        properties: {\r\n          '_mediadescript_': newData\r\n        },\r\n        action: 'update'\r\n      }]).done(function () {\r\n        mediaDescDialog.dialog('close').remove();\r\n        new gmxMediaDescription(null, newData, null, 'read', mediaLayerName, mediaObjId, mediaLayer, dialogSettings); //После сохранения закрываем старое окно и открываем новое с описанием.\r\n      });\r\n    }\r\n  }; //Функция сохранения описание из Режима Чтения (Пользователь решает сохранять данные или нет)\r\n\r\n\r\n  var saveDescfromEditMode = function saveDescfromEditMode() {\r\n    var newdescData = mediaDescTextArea.val();\r\n    var descriptLength = newdescData.length;\r\n    var eddata = editor.getData();\r\n    newdescData = eddata.replace(/>/gim, '> ');\r\n    newdescData = newdescData.replace(exp1, ' <a href=\"$1\" target=\"_blank\">$1</a> ' + ' ');\r\n    newdescData = newdescData.replace(exp2, ' <a href=\"http://$1\" target=\"_blank\">$1</a> ' + ' ');\r\n\r\n    if (descriptLength > 5000) {\r\n      var descriptLengthDIFF = descriptLength - 5000;\r\n      alert(_gtxt('mediaPlugin2.mediaDescDialogLimit.alert') + descriptLengthDIFF + _gtxt('mediaPlugin2.mediaDescDialogSymbols.alert'));\r\n    } else {\r\n      descField.set(storeDescFieldName, newdescData);\r\n      mediaDescDialog.dialog('close').remove();\r\n    }\r\n  }; //Функция переключения в режим \"HTML\"\r\n\r\n\r\n  var editortoHTML = function editortoHTML(prevmode) {\r\n    for (var editorHTMLInstance in CKEDITOR.instances) {\r\n      var curHTMLInstance = editorHTMLInstance;\r\n      break;\r\n    }\r\n    $('#' + editor.id + '_top').hide();\r\n    editor.resize('100%', mediaDescDialog.height() - 5, true);\r\n    CKEDITOR.instances[curHTMLInstance].setMode('source');\r\n\r\n    if (prevmode == 'fromedit') {\r\n      mediaDescDialog.dialog({\r\n        buttons: [{\r\n          id: 'WYSIWYGMode',\r\n          text: _gtxt(\"mediaPlugin2.descDialogWYSIWYGButton.label\"),\r\n          click: function click() {\r\n            editortoWYSIWYG('fromedit');\r\n          }\r\n        }, {\r\n          id: 'saveDescData',\r\n          text: _gtxt('mediaPlugin2.descDialogEditSaveButton.label'),\r\n          click: saveDescfromEditMode\r\n        }]\r\n      });\r\n    } else if (prevmode == 'fromread') {\r\n      mediaDescDialog.dialog({\r\n        buttons: [{\r\n          id: 'WYSIWYGMode',\r\n          text: _gtxt(\"mediaPlugin2.descDialogWYSIWYGButton.label\"),\r\n          click: function click() {\r\n            editortoWYSIWYG('fromread');\r\n          }\r\n        }, {\r\n          id: 'saveDescData',\r\n          text: _gtxt(\"mediaPlugin2.descDialogSaveButton.label\"),\r\n          click: saveDescfromReadMode\r\n        }]\r\n      });\r\n    }\r\n  }; //Функция переключения в режим \"WYSIWYG\"\r\n\r\n\r\n  var editortoWYSIWYG = function editortoWYSIWYG(prevmode) {\r\n    for (var editorWYSIWYGInstance in CKEDITOR.instances) {\r\n      var curWYSIWYGInstance = editorWYSIWYGInstance;\r\n      break;\r\n    }\r\n    $('#' + editor.id + '_top').show();\r\n    editor.resize('100%', mediaDescDialog.height() - 50, true);\r\n    CKEDITOR.instances[curWYSIWYGInstance].setMode('wysiwyg');\r\n\r\n    if (prevmode == 'fromedit') {\r\n      mediaDescDialog.dialog({\r\n        buttons: [{\r\n          id: 'htmlMode',\r\n          text: 'HTML',\r\n          click: function click() {\r\n            editortoHTML('fromedit');\r\n          }\r\n        }, {\r\n          id: 'saveDescData',\r\n          text: _gtxt('mediaPlugin2.descDialogEditSaveButton.label'),\r\n          click: saveDescfromEditMode\r\n        }]\r\n      });\r\n    } else if (prevmode == 'fromread') {\r\n      mediaDescDialog.dialog({\r\n        buttons: [{\r\n          id: 'htmlMode',\r\n          text: 'HTML',\r\n          click: function click() {\r\n            editortoHTML('fromread');\r\n          }\r\n        }, {\r\n          id: 'saveDescData',\r\n          text: _gtxt(\"mediaPlugin2.descDialogSaveButton.label\"),\r\n          click: saveDescfromReadMode\r\n        }]\r\n      });\r\n    }\r\n  }; //Функция переключения из режима \"Чтение\" в режим \"Редактирование\"\r\n\r\n\r\n  var changeDescDialogMode = function changeDescDialogMode() {\r\n    mediaDescDialog.dialog('close');\r\n    descEditMode();\r\n    mediaDescDialog.dialog({\r\n      buttons: [{\r\n        id: 'htmlMode',\r\n        text: 'HTML',\r\n        click: function click() {\r\n          editortoHTML('fromread');\r\n        }\r\n      }, {\r\n        id: 'saveDescData',\r\n        text: _gtxt(\"mediaPlugin2.descDialogSaveButton.label\"),\r\n        click: saveDescfromReadMode\r\n      }]\r\n    });\r\n    mediaDescDialog.dialog('open');\r\n  }; //Режим \"Чтение\"\r\n\r\n\r\n  var descReadMode = function descReadMode() {\r\n    var isEditableLayer = function isEditableLayer(layer) {\r\n      var layerProps = layer.getGmxProperties();\r\n\r\n      var layerRights = _queryMapLayers.layerRights(layerProps.name);\r\n\r\n      return layerProps.type === 'Vector' && (layerRights == 'edit' || layerRights == 'editrows');\r\n    };\r\n\r\n    $(mediaDescDialog).on('click', '.imgMedia', function (e) {\r\n      var newwindowHref = $(this).find('img').attr('src');\r\n\r\n      if (newwindowHref) {\r\n        e.preventDefault();\r\n        window.open(newwindowHref, 'new' + e.screenX);\r\n      }\r\n    });\r\n    mediaDescDialog.dialog({\r\n      title: mediaDescDialogTitle,\r\n      width: 510,\r\n      height: dialogSettings.dialogDescHeight,\r\n      minHeight: dialogSettings.dialogDescHeight,\r\n      maxWidth: 510,\r\n      minWidth: 510,\r\n      modal: false,\r\n      autoOpen: false,\r\n      dialogClass: 'media-DescDialog',\r\n      close: function close() {\r\n        mediaDescDialog.dialog('close').remove();\r\n      }\r\n    });\r\n    mediaDescDialog.html('<div class=\"media-descDiv\">' + descData + '</div>');\r\n    mediaDescDialog.dialog('open');\r\n\r\n    if (isEditableLayer(mediaLayer)) {\r\n      mediaDescDialog.dialog({\r\n        buttons: [{\r\n          id: 'changeDescMode',\r\n          text: _gtxt(\"mediaPlugin2.descDialogEditButton.label\"),\r\n          click: changeDescDialogMode\r\n        }]\r\n      });\r\n    }\r\n  }; //Режим \"Редактирование\"\r\n\r\n\r\n  var descEditMode = function descEditMode() {\r\n    gmxCore.loadScript(pluginPath + 'ckeditor_4.4.1_custom/ckeditor/ckeditor.js');\r\n    gmxCore.loadScript(pluginPath + 'ckeditor_4.4.1_custom/ckeditor/adapters/jquery.js').done(function () {\r\n      var CKEDITOR_BASEPATH = gmxCore.getModulePath('ckeditor'); //CKEDITOR.config.enterMode = '2';\r\n\r\n      mediaDescTextArea.val(descData);\r\n      mediaDescTextArea.ckeditor();\r\n      CKEDITOR.on('instanceReady', function (ev) {\r\n        editor = ev.editor;\r\n        $('#' + editor.id + '_top').show();\r\n        editor.resize('100%', mediaDescDialog.height() - 65, true);\r\n        editor.on('doubleclick', function (evt) {\r\n          var element = evt.data.element;\r\n\r\n          if (element.is('img') && !element.data('cke-realelement') && !element.isReadOnly()) {\r\n            var targetSrc = element.getAttribute('src');\r\n            window.open(targetSrc, 'new' + e.screenX);\r\n          }\r\n        });\r\n        $('iframe').contents().click(function (e) {\r\n          if (typeof e.target.href != 'undefined' && e.ctrlKey == true) {\r\n            window.open(e.target.href, 'new' + e.screenX);\r\n          }\r\n        });\r\n      });\r\n      CKEDITOR.on('dialogDefinition', function (ev) {\r\n        var dialogName = ev.data.name;\r\n        var dialogDefinition = ev.data.definition;\r\n\r\n        if (dialogName == 'link') {\r\n          var informationTab = dialogDefinition.getContents('target');\r\n          var targetField = informationTab.get('linkTargetType');\r\n          targetField['default'] = '_blank';\r\n        }\r\n      });\r\n      mediaDescDialog.html(mediaDescTextArea);\r\n    });\r\n    mediaDescDialog.dialog({\r\n      //title: mediaDescDialogTitle,\r\n      width: 510,\r\n      height: dialogSettings.dialogDescHeight,\r\n      minHeight: dialogSettings.dialogDescHeight,\r\n      maxWidth: 510,\r\n      minWidth: 510,\r\n      modal: true,\r\n      resize: function resize() {\r\n        editor.resize('100%', mediaDescDialog.height() - 65, true);\r\n      },\r\n      resizeStop: function resizeStop() {\r\n        editor.resize('100%', mediaDescDialog.height() - 65, true);\r\n      },\r\n      drag: function drag() {\r\n        editor.resize('100%', mediaDescDialog.height() - 65, true);\r\n      },\r\n      dragStop: function dragStop() {\r\n        editor.resize('100%', mediaDescDialog.height() - 65, true);\r\n      },\r\n      autoOpen: false,\r\n      buttons: [{\r\n        id: 'htmlMode',\r\n        text: 'HTML',\r\n        click: function click() {\r\n          editortoHTML('fromedit');\r\n        }\r\n      }, {\r\n        id: 'saveDescData',\r\n        text: _gtxt('mediaPlugin2.descDialogEditSaveButton.label'),\r\n        click: saveDescfromEditMode\r\n      }],\r\n      dialogClass: 'media-DescDialog',\r\n      close: function close() {\r\n        mediaDescDialog.dialog('close').remove();\r\n      }\r\n    });\r\n    mediaDescDialog.dialog('open');\r\n  }; //Дополнительные условия\r\n\r\n\r\n  if (mode == 'read') {\r\n    //mediaDescDialogTitle = _gtxt('mediaPlugin2.mediaDescDialogTitleRead.label');\r\n    descReadMode();\r\n  } else if (mode == 'edit') {\r\n    //mediaDescDialogTitle = _gtxt('mediaPlugin2.mediaDescDialogTitleEdit.label');\r\n    descEditMode();\r\n  } else if (mode == 'baloon') {\r\n    /*mediaDescDialogTitle = _gtxt('mediaPlugin2.mediaDescDialogTitleEdit.label');*/\r\n    descReadMode();\r\n    changeDescDialogMode();\r\n  }\r\n};\r\n\r\n_translationsHash.addtext(\"rus\", {\r\n  mediaPlugin2: {\r\n    \"layerPropertiesTitle\": 'Добавить описание',\r\n    \"balloonDefaultTitle\": 'Медиа Описание',\r\n    \"descButton.label\": 'Редактировать',\r\n    \"descButton.help\": 'Редактировать медиа описание',\r\n    \"descSpan.label\": 'Описание',\r\n    \"descSpan.help\": 'Медиа описание',\r\n    \"descDialogEditButton.label\": 'Редактировать',\r\n    \"descDialogWYSIWYGButton.label\": 'Визуально',\r\n    \"descDialogSaveButton.label\": 'Сохранить',\r\n    \"descDialogEditSaveButton.label\": 'Готово',\r\n    \"descBalloonButton.label\": 'Описание',\r\n    \"descInBalloonButton.label\": 'Редактировать описание',\r\n    \"descDialogTitle.label\": 'Просмотр Медиа-Описания',\r\n    \"mediaDescDialogTitleEdit.label\": 'Редактировать описание',\r\n    \"mediaDescDialogTitleRead.label\": 'Чтение описания',\r\n    \"mediaDescDialogLimit.alert\": 'Количество символов в описании больше 5000.\\nУкоротите описание на ',\r\n    \"mediaDescDialogSymbols.alert\": ' символов',\r\n    \"mediaDescImgDialogError.alert\": 'Не удалось загрузить изображение.\\n Проверьте правильность ссылки',\r\n    \"WarningText\": 'Для хранения описаний требуется добавление нового поля к слою'\r\n  }\r\n});\r\n\r\n_translationsHash.addtext(\"eng\", {\r\n  mediaPlugin2: {\r\n    \"layerPropertiesTitle\": 'Add media description',\r\n    \"balloonDefaultTitle\": 'Media description',\r\n    \"descButton.label\": 'Edit',\r\n    \"descButton.help\": 'Edit media description',\r\n    \"descSpan.label\": 'Description',\r\n    \"descSpan.help\": 'Media Description',\r\n    \"descDialogEditButton.label\": 'Edit',\r\n    \"descDialogWYSIWYGButton.label\": 'WYSIWYG',\r\n    \"descDialogSaveButton.label\": 'Save',\r\n    \"descDialogEditSaveButton.label\": 'OK',\r\n    \"descBalloonButton.label\": 'Description',\r\n    \"descInBalloonButton.label\": 'Edit Description',\r\n    \"descDialogTitle.label\": 'Media-Description Viewer',\r\n    \"mediaDescDialogTitleEdit.label\": 'Edit Description',\r\n    \"mediaDescDialogTitleRead.label\": 'View Description',\r\n    \"mediaDescDialogLimit.alert\": 'Description length more then 5000 symbols.\\nDelete ',\r\n    \"mediaDescDialogSymbols.alert\": ' symbols',\r\n    \"mediaDescImgDialogError.alert\": 'Image load failure.\\n Check URL on error',\r\n    \"WarningText\": 'New attribute will be added to this layer to store descriptions'\r\n  }\r\n}); //Модифицирует описание слоя, добавляя или удаляя свойства, необходимые для хранения описания объектов.\r\n//Метатег удаляется и добавляется, а необходимый атриут только добавляется (никогда не удаляется)\r\n\r\n\r\nvar modifyLayerProperties = function modifyLayerProperties(layerProperties, isAddDescription) {\r\n  var metaProps = layerProperties.get('MetaProperties'),\r\n      tagId = metaProps.getTagIdByName(DESC_METATAG);\r\n\r\n  if (isAddDescription) {\r\n    tagId || metaProps.addNewTag(DESC_METATAG, DESC_DEFAULT_FIELD, 'String');\r\n    var columns = layerProperties.get('Columns').slice();\r\n\r\n    if (!_.findWhere(columns, {\r\n      Name: DESC_DEFAULT_FIELD\r\n    })) {\r\n      columns.push({\r\n        Name: DESC_DEFAULT_FIELD,\r\n        ColumnSimpleType: 'String'\r\n      });\r\n    }\r\n\r\n    layerProperties.set('Columns', columns);\r\n  } else {\r\n    metaProps.deleteTag(tagId);\r\n  }\r\n\r\n  layerProperties.set('MetaProperties', metaProps);\r\n};\r\n\r\nvar DESC_METATAG = 'mediaDescField',\r\n    DESC_DEFAULT_FIELD = '_mediadescript_',\r\n    DESC_INLINE_HOOK = 'mediainline';\r\nvar pluginPath = gmxCore.getModulePath('MediaPlugin2');\r\nvar publicInterface = {\r\n  pluginName: 'Media Plugin',\r\n  afterViewer: function afterViewer(mediaDescDialogSettings, map) {\r\n    mediaDescDialogSettings = $.extend({\r\n      dialogDescHeight: 450,\r\n      inBaloonDesc: false\r\n    }, mediaDescDialogSettings);\r\n\r\n    gmxCore.loadModule('LayerEditor').done(function () {\r\n      nsGmx.LayerEditor.addInitHook(function (layerEditor, layerProperties, parametres) {\r\n        var metaProps = layerProperties.get('MetaProperties'),\r\n            isMedia = metaProps.getTagByName(DESC_METATAG);\r\n\r\n        if (layerProperties.get('Type') !== 'Vector') {\r\n          return;\r\n        }\r\n\r\n        var uiTemplate = Handlebars.compile('<label class = \"media-props\">' + '<input type=\"checkbox\" id=\"media-props-checkbox\" {{#isMedia}}checked{{/isMedia}}>' + '{{i \"mediaPlugin2.layerPropertiesTitle\"}}' + '</label>');\r\n        $(layerEditor).on('premodify', function () {\r\n          modifyLayerProperties(layerProperties, $('#media-props-checkbox', ui).prop(\"checked\"));\r\n        });\r\n        var ui = $(uiTemplate({\r\n          isMedia: isMedia\r\n        }));\r\n        parametres.additionalUI = parametres.additionalUI || {};\r\n        parametres.additionalUI.advanced = parametres.additionalUI.advanced || [];\r\n        parametres.additionalUI.advanced.push(ui[0]);\r\n      });\r\n    });\r\n\r\n    var balloonHook = function balloonHook(layer, props, div, node, hooksCount) {\r\n      //Если есть описание в балуне, отдельной ссылки на описание не нужно\r\n      if (hooksCount[DESC_INLINE_HOOK]) {\r\n        return;\r\n      } // var layer = o.layer,\r\n\r\n\r\n      var layerProps = layer.getGmxProperties(),\r\n          layerName = layerProps.name,\r\n          metaTag = layerProps.MetaProperties && layerProps.MetaProperties[DESC_METATAG];\r\n\r\n      if (!metaTag) {\r\n        $(node).empty().append(props[DESC_DEFAULT_FIELD]);\r\n      } else if (props[metaTag.Value].length) {\r\n        var descBaloonButtonLabel = '<b><a href=\"\">{{i \"mediaPlugin2.descBalloonButton.label\"}}</a></b>',\r\n            mediaDescDialogMode = 'read';\r\n        var ui = $(Handlebars.compile(descBaloonButtonLabel)()).click(function (e) {\r\n          e.preventDefault();\r\n          var mediaObjectId = props[layerProps.identityField];\r\n          var descripText = props[metaTag.Value];\r\n          new gmxMediaDescription('', descripText, '', mediaDescDialogMode, layerName, mediaObjectId, layer, mediaDescDialogSettings);\r\n        });\r\n\r\n        if (node) {\r\n          $(node).empty().append(ui);\r\n        } else {\r\n          $(div).append($('<br/>'), ui);\r\n        }\r\n      }\r\n    };\r\n\r\n    var attachBalloonHook = function attachBalloonHook(layer) {\r\n      if (!layer.addPopupHook) {\r\n        //например, виртуальные слои могут не поддерживать popup hooks\r\n        return;\r\n      }\r\n\r\n      var props = layer.getGmxProperties();\r\n      var metaTag = props.MetaProperties && props.MetaProperties[DESC_METATAG];\r\n      layer.addPopupHook(metaTag ? metaTag.Value : DESC_DEFAULT_FIELD, function (properties, div, node, hooksCount) {\r\n        balloonHook(layer, properties, div, node, hooksCount);\r\n      }); //добавляем просмотр описания внутри балуна\r\n\r\n      layer.addPopupHook(DESC_INLINE_HOOK, function (properties, div, node) {\r\n        var metaTag = props.MetaProperties && props.MetaProperties[DESC_METATAG];\r\n\r\n        if (!node || !metaTag) {\r\n          return;\r\n        }\r\n\r\n        var html = properties[metaTag.Value];\r\n        $(node).html('<div class=\"media-inlineDescr media-descDiv\">' + html + '</div>');\r\n        $(node).on('click', '.imgMedia', function (e) {\r\n          e.preventDefault();\r\n          var contwindowHref = $(this).find('img').attr('src');\r\n          window.open(contwindowHref, 'new' + e.screenX);\r\n        });\r\n      });\r\n    };\r\n\r\n    nsGmx.gmxMap.layers.forEach(attachBalloonHook);\r\n\r\n    var paramHook = function paramHook(layerName, id, parametres) {\r\n      var layer = nsGmx.gmxMap.layersByID[layerName],\r\n          props = layer.getGmxProperties(),\r\n          fieldName = props.MetaProperties && props.MetaProperties[DESC_METATAG] && props.MetaProperties[DESC_METATAG].Value; //layer.bringToTopItem(id);\r\n\r\n      parametres = parametres || {};\r\n      parametres.fields = parametres.fields || [];\r\n\r\n      if (fieldName) {\r\n        var fieldDescription = _.findWhere(parametres.fields, {\r\n          name: fieldName\r\n        });\r\n\r\n        if (fieldDescription) {\r\n          fieldDescription.hide = true;\r\n        } else {\r\n          parametres.fields.push({\r\n            name: fieldName,\r\n            hide: true\r\n          });\r\n        }\r\n      }\r\n\r\n      parametres.afterPropertiesControl = function (EOCInteraction) {\r\n        var mediaGUI = $('<div class=\"media-Desc-GUI\"><span id=\"media-Desc-EditLabel\" title=\"' + _gtxt(\"mediaPlugin2.descSpan.help\") + '\">' + _gtxt(\"mediaPlugin2.descSpan.label\") + '</span><span id =\"mediaDesc-EditButton\" class=\"buttonLink\" title=\"' + _gtxt(\"mediaPlugin2.descButton.help\") + '\">' + _gtxt(\"mediaPlugin2.descButton.label\") + '</span></div>');\r\n        $('#mediaDesc-EditButton', mediaGUI).click(function () {\r\n          if (!fieldName) {\r\n            var ui = $(Handlebars.compile('<div>{{i \"mediaPlugin2.WarningText\"}}</div>')());\r\n            ui.dialog({\r\n              buttons: [{\r\n                id: 'warning-ok',\r\n                text: 'OK',\r\n                click: function click() {\r\n                  $(this).dialog(\"close\");\r\n                  gmxCore.loadModule('LayerProperties').then(function () {\r\n                    var layerProperties = new nsGmx.LayerProperties();\r\n                    layerProperties.initFromServer(layerName).then(function () {\r\n                      modifyLayerProperties(layerProperties, true);\r\n                      layerProperties.save().then(function () {\r\n                        L.gmx.layersVersion.chkVersion(layer, function () {\r\n                          fieldName = layer.getGmxProperties().MetaProperties[DESC_METATAG].Value;\r\n                          var fields = EOCInteraction.getAll();\r\n\r\n                          if (!fields[fieldName]) {\r\n                            EOCInteraction.add({\r\n                              name: fieldName,\r\n                              view: {\r\n                                _value: '',\r\n                                setValue: function setValue(value) {\r\n                                  this._value = value;\r\n                                },\r\n                                getValue: function getValue() {\r\n                                  return this._value;\r\n                                },\r\n                                checkValue: function checkValue() {\r\n                                  return true;\r\n                                }\r\n                              }\r\n                            });\r\n                          }\r\n\r\n                          var getdescData = EOCInteraction.get(fieldName) || '';\r\n                          new gmxMediaDescription(EOCInteraction, getdescData, fieldName, 'edit', null, null, null, mediaDescDialogSettings);\r\n                        });\r\n                      });\r\n                    });\r\n                  });\r\n                }\r\n              }, {\r\n                id: 'warning-cancel',\r\n                text: 'Cancel',\r\n                click: function click() {\r\n                  $(this).dialog(\"close\");\r\n                }\r\n              }]\r\n            });\r\n          } else {\r\n            var getdescData = EOCInteraction.get(fieldName);\r\n            new gmxMediaDescription(EOCInteraction, getdescData, fieldName, 'edit', null, null, null, mediaDescDialogSettings);\r\n          }\r\n        });\r\n        return mediaGUI[0];\r\n      };\r\n\r\n      return parametres;\r\n    };\r\n\r\n    nsGmx.EditObjectControl.addParamsHook(paramHook);\r\n  }\r\n};\r\ngmxCore.addModule(\"MediaPlugin2\", publicInterface, {// css: 'MediaPlugin2.css'\r\n});\r\n","import nsGmx from '../nsGmx';\r\nimport './EditObjectControl.css';\r\nimport {           \r\n    _div,\r\n\t_img,\r\n    _input,\r\n    inputError,\r\n    makeLinkButton,    \r\n    parseResponse,    \r\n    removeDialog,\r\n    sendCrossDomainJSONRequest,    \r\n    showDialog,\r\n    showErrorMessage,    \r\n    _span,\t\r\n    _t,    \r\n\t_table,\r\n    _tbody,    \r\n    _tr,\t\r\n\t_td,        \r\n} from '../utilities.js';\r\nimport '../gmxcore.js';\r\n\r\nconst _ = nsGmx.Utils._;\r\n\r\n//для отслеживания того, что не открыли диалог редактирования одного и того же объекта несколько раз\r\nvar EditObjectControlsManager = {\r\n    _editControls: [],\r\n    _paramsHooks: [],\r\n\r\n    find: function(layerName, oid)\r\n    {\r\n        for (var iD = 0; iD < this._editControls.length; iD++)\r\n            if ( layerName == this._editControls[iD].layer && oid == this._editControls[iD].oid )\r\n                return this._editControls[iD].control;\r\n    },\r\n\r\n    add: function(layerName, oid, control)\r\n    {\r\n        for (var iD = 0; iD < this._editControls.length; iD++)\r\n            if ( layerName == this._editControls[iD].layer && oid == this._editControls[iD].oid )\r\n            {\r\n                this._editControls[iD].control = control;\r\n                return;\r\n            }\r\n        this._editControls.push({ layer: layerName, oid: oid, control: control });\r\n    },\r\n\r\n    remove: function(layerName, oid)\r\n    {\r\n        for (var iD = 0; iD < this._editControls.length; iD++)\r\n            if ( layerName == this._editControls[iD].layer && oid == this._editControls[iD].oid )\r\n            {\r\n                this._editControls.splice(iD, 1);\r\n                return;\r\n            }\r\n    },\r\n\r\n    addParamsHook: function(paramsHook) {\r\n        this._paramsHooks.push(paramsHook);\r\n    },\r\n\r\n    applyParamsHook: function(layerName, objectId, params) {\r\n        for (var h = 0; h < this._paramsHooks.length; h++) {\r\n            params = this._paramsHooks[h](layerName, objectId, params);\r\n        }\r\n\r\n        return params;\r\n    }\r\n}\r\n\r\nvar getInputElement = function(type)\r\n{\r\n    var input = _input(null, [['dir','className','inputStyle edit-obj-input']]);\r\n\r\n    if (type == 'date')\r\n    {\r\n        $(input).datepicker({\r\n            changeMonth: true,\r\n            changeYear: true,\r\n            dateFormat: \"dd.mm.yy\"\r\n        });\r\n    }\r\n    else if ( type == 'datetime' )\r\n    {\r\n        $(input).datetimepicker(\r\n        {\r\n            changeMonth: true,\r\n            changeYear: true,\r\n            dateFormat: \"dd.mm.yy\",\r\n            timeFormat: \"HH:mm:ss\",\r\n            showSecond: true,\r\n            timeOnly: false\r\n        })\r\n    }\r\n    else if ( type == \"time\" )\r\n    {\r\n        $(input).timepicker({\r\n            timeOnly: true,\r\n            timeFormat: \"HH:mm:ss\",\r\n            showSecond: true\r\n        });\r\n    }\r\n\r\n    return input;\r\n}\r\n\r\n//Коллекция полей с информацией для создания диалога редактирования\r\nvar FieldsCollection = function() {\r\n    var _asArray = [];\r\n    var _asHash = {};\r\n\r\n    this.append = function(field) {\r\n        if (field.name && _asHash[field.name]) {\r\n            var origIndex = _asHash[field.name].origIndex;\r\n            $.extend(true, _asHash[field.name], field);\r\n            _asHash[field.name].origIndex = origIndex;\r\n        } else {\r\n            field.origIndex = _asArray.length;\r\n            _asArray.push(field);\r\n            if (field.name) {\r\n                _asHash[field.name] = field;\r\n            }\r\n        }\r\n    }\r\n\r\n    this.get = function(name) {\r\n        return _asHash[name];\r\n    }\r\n\r\n    this.each = function(callback) {\r\n        _asArray.forEach(callback);\r\n    }\r\n\r\n    this.updateValue = function(name) {\r\n        var field = _asHash[name];\r\n        if (field && field.view) {\r\n            field.value = field.view.getValue();\r\n        }\r\n        return field && field.value;\r\n    }\r\n\r\n    //Сначала isRequired, потом identityField, потом в порядке добавления\r\n    this.sort = function() {\r\n        _asArray = _asArray.sort(function(a, b) {\r\n            if (!!a.isRequired !== !!b.isRequired) {\r\n                return Number(!!b.isRequired) - Number(!!a.isRequired);\r\n            }\r\n\r\n            if (!!a.identityField !== !!b.identityField) {\r\n                return Number(!!b.identityField) - Number(!!a.identityField);\r\n            }\r\n\r\n            var userZIndexDelta = (a.index || 0) - (b.index || 0);\r\n            return userZIndexDelta || (a.origIndex - b.origIndex);\r\n        })\r\n    }\r\n}\r\n\r\n/** Объект, описывающий один атрибут слоя\r\n * @typedef {Object} nsGmx.EditObjectControl.FieldInfo\r\n * @property {String} name имя атрибута (обязательно)\r\n * @property {String|int} [value] значение атрибута в формате сервера\r\n * @property {bool} [constant=false] можно ли редактировать атрибут\r\n * @property {bool} [hide=false] совсем не показыавать этот атрибут\r\n * @property {String} [title=<совпадает с name>] что показывать вместо имени атрибута\r\n * @property {function(val):bool} [validate] ф-ция для валидации результата. На вход получает введённое пользователем значение\r\n*      (до преобразования в серверный формат), должна вернуть валидно ли это значение.\r\n * @property {String} [isRequired=false] является ли значение атрибута обязательным. Обязательные атрибуты показываются выше всех остальных и выделяются жирным шрифтом.\r\n * @property {Number} [index=0] индекс для сортировки. Влияет на порядок показа полей в диалоге. Больше - выше.\r\n*/\r\n\r\n/** Контрол, который показывает диалог редактирования существующего или добавления нового объекта в слой.\r\n*\r\n* @memberOf nsGmx\r\n* @class\r\n* @param {String}   layerName ID слоя\r\n* @param {Number}   objectId ID объекта (null для нового объекта)\r\n* @param {Object}   [params] Дополнительные параметры контрола\r\n* @param {gmxAPI.drawingObject} [params.drawingObject] Пользовательский объект для задании геометрии или null, если геометрия не задана\r\n* @param {function} [params.onGeometrySelection] Внешняя ф-ция для выбора геометрии объекта.\r\n         Сигнатура: function(callback), параметр callback(gmxAPI.drawingObject|geometry) должен быть вызван когда будет выбрана геометрия.\r\n* @param {HTMLNode} [params.geometryUI] HTML элемент, который нужно использовать вместо стандартных контролов для выбора геометрии (надпись + иконка)\r\n* @param {nsGmx.EditObjectControl.FieldInfo[]} [params.fields] массив с описанием характеристик атрибутов для редактирования . Должен содержать только атрибуты, которые есть в слое.\r\n* @param {bool} [params.allowDuplicates=<depends>] Разрешать ли несколько диалогов для редактирования/создания этого объекта.\r\n         По умолчанию для редактирования запрещено, а для создания нового разрешено.\r\n* @param {HTMLNode | function(nsGmx.EditObjectControl): HTMLNode} [params.afterPropertiesControl] HTML элемент, который нужно поместить после списка атрибутов или ф-ция, которая возвращает этот элемент\r\n*/\r\nvar EditObjectControl = function(layerName, objectId, params)\r\n{\r\n    /** Объект был изменён/добавлен\r\n     * @event nsGmx.EditObjectControl#modify\r\n     */\r\n\r\n    /** Генерируется перед изменением/добавлением объекта. Может быть использован для сохранения в свойствах объекта каких-то внешних данных.\r\n     * @event nsGmx.EditObjectControl#premodify\r\n     */\r\n\r\n    /** Закрытие диалога редактирования\r\n     * @event nsGmx.EditObjectControl#close\r\n     */\r\n\r\n    if (_queryMapLayers.layerRights(layerName) !== 'edit' && _queryMapLayers.layerRights(layerName) !== 'editrows') {\r\n        showErrorMessage(_gtxt('Недостаточно прав для редактирования объектов слоя'), true);\r\n        return;\r\n    }\r\n\r\n    var isNew = objectId == null;\r\n    var _params = $.extend({\r\n            drawingObject: null,\r\n            fields: [],\r\n            validate: {},\r\n            allowDuplicates: isNew,\r\n            afterPropertiesControl: _span()\r\n        }, params);\r\n\r\n    _params = EditObjectControlsManager.applyParamsHook(layerName, objectId, _params);\r\n\r\n    var _this = this;\r\n    if (!_params.allowDuplicates && EditObjectControlsManager.find(layerName, objectId))\r\n        return EditObjectControlsManager.find(layerName, objectId);\r\n\r\n    EditObjectControlsManager.add(layerName, objectId, this);\r\n\r\n    var lmap = nsGmx.leafletMap,\r\n        layersByID = nsGmx.gmxMap.layersByID;\r\n    var layer = layersByID[layerName];\r\n    var geometryInfoContainer = _div(null, [['css','color','#215570'], ['css','fontSize','12px']]);\r\n\r\n    var originalGeometry = null;\r\n    var drawingBorderDialog = null;\r\n    var identityField = layer._gmx.properties.identityField;\r\n\r\n    var geometryInfoRow = null;\r\n\r\n    var drawingObjectLeafletID = null;\r\n    var bindDrawingObject = function(obj)\r\n    {\r\n        geometryInfoRow && geometryInfoRow.RemoveRow();\r\n\r\n        if (!obj) return;\r\n\r\n        var InfoRow = window.gmxCore.getModule('DrawingObjects').DrawingObjectInfoRow;\r\n        geometryInfoRow = new InfoRow(\r\n            lmap,\r\n            geometryInfoContainer,\r\n            obj,\r\n            { editStyle: false, allowDelete: false }\r\n        );\r\n        drawingObjectLeafletID = obj._leaflet_id;\r\n    }\r\n\r\n    var objStyle = params && params.event ? params.event.gmx.target.currentStyle : null;\r\n    var bindGeometry = function(geom) {\r\n        if (geom) {\r\n            var geojson = new L.GeoJSON(geom),\r\n\t\t\t\tstyleParams = objStyle ? {\r\n                    pointStyle: {\r\n                        shape: 'box', color: objStyle.strokeStyle\r\n                    },\r\n                    lineStyle: {\r\n                        color: objStyle.strokeStyle\r\n                    }\r\n                } : {},\r\n                arr = lmap.gmxDrawing.addGeoJSON(geojson, styleParams);\r\n            for (var i = 0, len = arr.length; i < len; i++) {\r\n                bindDrawingObject(arr[i]);\r\n            }\r\n        }\r\n    };\r\n    \r\n    var fieldsCollection = new FieldsCollection();\r\n\r\n    var createDialog = function()\r\n    {\r\n        var createButton = makeLinkButton(isNew ? _gtxt(\"Создать\") : _gtxt(\"Изменить\")),\r\n            removeButton = makeLinkButton(_gtxt(\"Удалить\")),            \r\n            isSaving = false;\r\n\r\n        var canvas = _div(null, [['dir', 'className', 'edit-obj']]);\r\n\r\n        $(canvas).bind('dragover', function() {\r\n            return false;\r\n        });\r\n\r\n        $(canvas).bind('drop', function(e) {\r\n            var files = e.originalEvent.dataTransfer.files;\r\n            nsGmx.Utils.parseShpFile(files[0]).done(function(objs) {\r\n                bindGeometry(nsGmx.Utils.joinPolygons(nsGmx._.pluck(objs, 'geometry')));\r\n            });\r\n            return false;\r\n        });\r\n\r\n        removeButton.onclick = function()\r\n        {\r\n            _mapHelper.modifyObjectLayer(layerName, [{action: 'delete', id: objectId}]).done(function()\r\n            {\r\n                removeDialog(dialogDiv);\r\n                closeFunc();\r\n            })\r\n        }\r\n\r\n        removeButton.style.marginLeft = '10px';\r\n\r\n        isNew && $(removeButton).hide();\r\n\r\n        createButton.onclick = function()\r\n        {\r\n            if (isSaving) {\r\n                return;\r\n            }\r\n\r\n            $(_this).trigger('premodify');\r\n\r\n            var properties = {};\r\n            var anyErrors = false;\r\n\r\n            fieldsCollection.each(function(field) {\r\n                var name = field.name;\r\n                if (!name) {\r\n                    return;\r\n                }\r\n\r\n                var isValid = field.view.checkValue();\r\n                if (isValid) {\r\n                    properties[name] = fieldsCollection.updateValue(name);\r\n                }\r\n                anyErrors = anyErrors || !isValid;\r\n            })\r\n\r\n            if (anyErrors) return;\r\n\r\n            var obj = { properties: properties };\r\n\r\n            var selectedGeom = _this.getGeometry();\r\n\r\n            // if (!selectedGeom)\r\n            // {\r\n                // showErrorMessage(\"Геометрия для объекта не задана\", true, \"Геометрия для объекта не задана\");\r\n                // return;\r\n            // }\r\n\r\n            if (!isNew)\r\n            {\r\n                obj.id = objectId;\r\n\r\n                var curGeomString = JSON.stringify(selectedGeom);\r\n                var origGeomString = JSON.stringify(originalGeometry);\r\n\r\n                if (origGeomString !== curGeomString) {\r\n                    obj.geometry = selectedGeom;\r\n                }\r\n            }\r\n            else\r\n            {\r\n                obj.geometry = selectedGeom;\r\n            }\r\n\r\n            isSaving = true;\r\n\r\n            _mapHelper.modifyObjectLayer(layerName, [obj], 'EPSG:4326').done(function()\r\n            {\r\n                $(_this).trigger('modify');\r\n                removeDialog(dialogDiv);\r\n                closeFunc();\r\n            })\r\n        }\r\n\r\n        var resizeFunc = function()\r\n        {\r\n            if (!isNew && $(canvas).children(\"[loading]\").length)\r\n                return;\r\n\r\n            canvas.firstChild.style.height = canvas.parentNode.offsetHeight - 25 - 10 - 10 + 'px';\r\n        }\r\n\r\n        var closeFunc = function()\r\n        {\r\n            // search for opened styles editing dialog\r\n            if (drawingObjectLeafletID) {\r\n                var styleEditingDialog = $('.drawing-object-leaflet-id-' + drawingObjectLeafletID);\r\n            }\r\n\r\n            geometryInfoRow && geometryInfoRow.getDrawingObject() && nsGmx.leafletMap.gmxDrawing.remove(geometryInfoRow.getDrawingObject());\r\n\r\n            originalGeometry = null;\r\n\r\n            if (styleEditingDialog) {\r\n                removeDialog(styleEditingDialog);\r\n            }\r\n\r\n            if (drawingBorderDialog)\r\n                removeDialog(drawingBorderDialog);\r\n\r\n            EditObjectControlsManager.remove(layerName, objectId);\r\n\r\n            $(_this).trigger('close');\r\n        }\r\n\r\n        var drawAttrList = function(fields)\r\n        {\r\n            var trs = [],\r\n                firstInput;\r\n\r\n            //сначала идёт геометрия\r\n            var geomTitleTmpl = Handlebars.compile('<span>' +\r\n                '<span class=\"edit-obj-geomtitle\">{{i \"Геометрия\"}}</span>' +\r\n                '<span id = \"choose-geom\" class=\"gmx-icon-choose\"></span>' +\r\n            '</span>');\r\n\r\n            var geometryUI = _params.geometryUI || $(geomTitleTmpl())[0];\r\n            $('#choose-geom', geometryUI).click(function() {\r\n                if (_params.onGeometrySelection) {\r\n                    _params.onGeometrySelection(bindGeometry);\r\n                } else {\r\n                    nsGmx.Controls.chooseDrawingBorderDialog(\r\n                        'editObject',\r\n                        bindDrawingObject,\r\n                        { geomType: layer.getGmxProperties().GeometryType }\r\n                    );\r\n                }\r\n            })\r\n\r\n            trs.push(_tr([_td([geometryUI],[['css','height','20px']]), _td([geometryInfoContainer])]));\r\n\r\n            fields.sort();\r\n\r\n            //потом все остальные поля\r\n            fields.each(function(field) {\r\n                var td = _td();\r\n                if (field.constant)\r\n                {\r\n                    field.view = field.view || {\r\n                        getUI: function() {\r\n                            var span = _span(null,[['dir', 'className', 'edit-obj-constant-value']]);\r\n                            span.rowName = field.name;\r\n                            span.rowType = field.type;\r\n                            if ('value' in field) {\r\n                                _(span, [_t(nsGmx.Utils.convertFromServer(field.type, field.value))]);\r\n                            }\r\n                            return span;\r\n                        },\r\n                        getValue: function() {return field.value},\r\n                        setValue: function() {},\r\n                        checkValue: function() { return true; }\r\n                    }\r\n                }\r\n                else\r\n                {\r\n                    field.view = field.view || {\r\n                        getUI: function() {\r\n                            if (!this._input) {\r\n                                var input = this._input = getInputElement(field.type);\r\n                                input.rowName = field.name;\r\n                                input.rowType = field.type;\r\n\r\n                                firstInput = firstInput || input;\r\n\r\n                                if ('value' in field)\r\n                                    input.value = nsGmx.Utils.convertFromServer(field.type, field.value);\r\n                            }\r\n                            return this._input;\r\n                        },\r\n                        getValue: function() {\r\n                            return nsGmx.Utils.convertToServer(field.type, this._input.value);\r\n                        },\r\n                        setValue: function(value) {\r\n                            this._input.value = nsGmx.Utils.convertFromServer(field.type, value);\r\n                        },\r\n                        checkValue: function() {\r\n                            var validationFunc = field.validate || _params.validate[field.name];\r\n                            var isValid = !validationFunc || validationFunc(this._input.value);\r\n                            if (!isValid) {\r\n                                inputError(this._input);\r\n                            }\r\n                            return isValid;\r\n                        },\r\n                        _input: null\r\n                    }\r\n                }\r\n\r\n                _(td, [field.view.getUI(_this)]);\r\n\r\n                var fieldHeader = _span([_t(field.title || field.name)],[['css','fontSize','12px']]);\r\n                if (field.isRequired) {\r\n                    fieldHeader.style.fontWeight = 'bold';\r\n                }\r\n                var tr = _tr([_td([fieldHeader]), td], [['css', 'height', '22px']]);\r\n\r\n                field.hide && $(tr).hide();\r\n\r\n                trs.push(tr);\r\n            })\r\n\r\n            var afterPropUI = typeof _params.afterPropertiesControl === 'function' ? _params.afterPropertiesControl(_this) : _params.afterPropertiesControl;\r\n\r\n            _(canvas, [_div([_table([_tbody(trs)], [['dir', 'className', 'obj-edit-proptable']]), afterPropUI],[['dir', 'className', 'obj-edit-canvas'], ['css','overflow','auto']])]);\r\n\r\n            _(canvas, [_div([createButton, removeButton],[['css','margin','10px 0px'],['css','height','20px']])]);\r\n\r\n            firstInput && firstInput.focus();\r\n\r\n            resizeFunc();\r\n        }\r\nvar prop = layer._gmx.properties;\r\n\r\n        var dialogDiv = showDialog(isNew ? _gtxt(\"Создать объект слоя [value0]\", prop.title) : _gtxt(\"Редактировать объект слоя [value0]\", prop.title), canvas, 520, 300, false, false, resizeFunc, closeFunc);\r\n\r\n        if (!isNew)\r\n        {\r\n            var loading = _div([_img(null, [['attr','src','img/progress.gif'],['css','marginRight','10px']]), _t(_gtxt('загрузка...'))], [['css','margin','3px 0px 3px 20px'],['attr','loading',true]]);\r\n\r\n            _(canvas, [loading])\r\n\r\n            //получаем геометрию объекта\r\n            sendCrossDomainJSONRequest(window.serverBase + \"VectorLayer/Search.ashx?WrapStyle=func&layer=\" + layerName + \"&page=0&pagesize=1&orderby=\" + identityField + \"&geometry=true&query=[\" + identityField + \"]=\" + objectId, function(response)\r\n            {\r\n                if (!parseResponse(response))\r\n                    return;\r\n\r\n                $(canvas).children(\"[loading]\").remove();\r\n\r\n                var columnNames = response.Result.fields;                \r\n                var geometryRow = response.Result.values.length > 0 ? response.Result.values[0] : [];\r\n\t\t\t\t\r\n\t\t\t\tif (geometryRow.length > 0) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar types = response.Result.types;\r\n\t\t\t\t\tfor (var i = 0; i < geometryRow.length; ++i)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (columnNames[i] === 'geomixergeojson')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar geom = L.gmxUtil.geometryToGeoJSON(geometryRow[i], true);\r\n\t\t\t\t\t\t\tif (geom) {\r\n\t\t\t\t\t\t\t\tbindGeometry(geom);\r\n\t\t\t\t\t\t\t\toriginalGeometry = $.extend(true, {}, geom);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar field = {\r\n\t\t\t\t\t\t\t\tvalue: geometryRow[i],\r\n\t\t\t\t\t\t\t\ttype: types[i],\r\n\t\t\t\t\t\t\t\tname: columnNames[i],\r\n\t\t\t\t\t\t\t\tconstant: columnNames[i] === identityField,\r\n\t\t\t\t\t\t\t\tidentityField: columnNames[i] === identityField,\r\n\t\t\t\t\t\t\t\tisRequired: false\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\tfieldsCollection.append(field);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_params.fields.forEach(fieldsCollection.append);\r\n\r\n\t\t\t\t\tdrawAttrList(fieldsCollection);\r\n\t\t\t\t}\r\n                else {\r\n\t\t\t\t\tconsole.log('Geometry row is empty');\r\n\t\t\t\t\t$(dialogDiv).dialog('close');\r\n\t\t\t\t}\r\n\r\n                _this.initPromise.resolve();\r\n            })\r\n        }\r\n        else\r\n        {\r\n            for (var i = 0; i < prop.attributes.length; ++i)\r\n            {\r\n                fieldsCollection.append({type: prop.attrTypes[i], name: prop.attributes[i]})\r\n            }\r\n\r\n            _params.fields.forEach(fieldsCollection.append);\r\n\r\n            if (_params.drawingObject) {\r\n                bindDrawingObject(_params.drawingObject);\r\n            }\r\n\r\n            drawAttrList(fieldsCollection);\r\n\r\n            _this.initPromise.resolve();\r\n        }\r\n    }\r\n\r\n    /** Promise для отслеживания момента полной инициализации диалога. Только после полной инициализации можно полноценно пользоваться методами get/set\r\n      * @memberOf nsGmx.EditObjectControl.prototype\r\n      * @member {jQuery.Deferred} initPromise\r\n    */\r\n    this.initPromise = $.Deferred();\r\n\r\n    /** Получить текущее значение атрибута из контрола\r\n      @memberOf nsGmx.EditObjectControl.prototype\r\n      @param {String} fieldName Имя атрибута\r\n      @method get\r\n    */\r\n    this.get = function(fieldName) {\r\n        return fieldsCollection.updateValue(fieldName);\r\n    }\r\n\r\n    this.getAll = function() {\r\n        var res = {};\r\n        fieldsCollection.each(function(field) {\r\n            res[field.name] = fieldsCollection.updateValue(field.name);\r\n        })\r\n\r\n        return res;\r\n    }\r\n\r\n    /** Задать значение атрибута объекта из контрола\r\n      @memberOf nsGmx.EditObjectControl.prototype\r\n      @method set\r\n      @param {String} fieldName Имя атрибута\r\n      @param {String|Integer} value Значение в клиентском формате, который нужно установить для этого атрибута\r\n    */\r\n    this.set = function(fieldName, value) {\r\n        var field = fieldsCollection.get(fieldName);\r\n        if (field) {\r\n            field.view.setValue(value);\r\n        }\r\n    }\r\n\r\n    /** Задать геометрию для редактируемого объекта\r\n      @memberOf nsGmx.EditObjectControl.prototype\r\n      @method setGeometry\r\n      @param {gmxAPI.DrawingObject|geometry} geometry Геометрия в виде drawing объекта или просто описание геометрии\r\n    */\r\n    this.setGeometry = function(geometry) {\r\n        bindGeometry(geometry);\r\n    }\r\n\r\n    this.getGeometryObj = function() {\r\n        return geometryInfoRow ? geometryInfoRow.getDrawingObject() : null;\r\n    }\r\n\r\n    this.getGeometry = function() {\r\n        if (geometryInfoRow) {\r\n            var geom = geometryInfoRow.getDrawingObject();\r\n            var geojson = geom.toGeoJSON();\r\n            return geojson.geometry;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    this.getLayer = function() { return layer; };\r\n\r\n    this.add = function(field) {\r\n        fieldsCollection.append(field);\r\n    }\r\n\r\n    createDialog();\r\n}\r\n\r\nnsGmx.EditObjectControl = EditObjectControl;\r\n\r\n/** Добавить \"хук\" для модификации параметров при всех вызовах ф-ции {@link nsGmx.EditObjectControl}\r\n    @function\r\n    @param {function(Object): Object} {paramsHook} Ф-ция, которая принимает на вход параметры ф-ции {@link nsGmx.EditObjectControl}\r\n        и возвращает модифицируемые параметры (возможна замена in place)\r\n*/\r\nnsGmx.EditObjectControl.addParamsHook = EditObjectControlsManager.addParamsHook.bind(EditObjectControlsManager);\r\n","﻿import nsGmx from '../nsGmx.js';\r\nimport {\r\n    parseResponse,\r\n    removeDialog,\r\n    sendCrossDomainJSONRequest,\r\n    sendCrossDomainPostRequest,    \r\n} from '../utilities.js';\r\nimport './ProfilePlugin.css';\r\nimport '../gmxcore.js';\r\n\r\n(function ($) {\r\n    var mykosmosnimki = location.protocol + \"//my.kosmosnimki.ru\"; //\"http://localhost:56319\"; //\r\n\r\n    var initTranslations = function () {\r\n\r\n\r\n        _translationsHash.addtext(\"rus\", { ProfilePlugin: {\r\n\r\n            profile: \"Профиль\",\r\n            billing: \"Биллинг\",\r\n            developer: \"Разработчикам\",\r\n\r\n            firstName: \"Фамилия\",\r\n            lastName: \"Имя\",\r\n            email: \"Электронная почта\",\r\n            login: \"Псевдоним\",\r\n            fullName: \"Полное имя\",\r\n            phone: \"Телефон\",\r\n            company: \"Название организации\",\r\n            companyProfile: \"Вид деятельности организации\",\r\n            companyPosition: \"Должность\",\r\n            isCompany: \"Я выступаю от имени организации\",\r\n            subscribe: \"Я согласен получать сообщения по почте\",\r\n            saveChanges: \"Сохранить\",\r\n\r\n            used: \"используется\",\r\n            remain: \"осталось\",\r\n            fileStorage: \"Файлы\",\r\n            fileStorageUsed: \"Хранилище файлов используется\",\r\n            fileStorageRemain: \"Хранилище файлов осталось\",\r\n            vectorLayerStorage: \"Векторные данные\",\r\n            vectorLayerStorageUsed: \"Хранилище векторных слоев используется\",\r\n            vectorLayerStorageRemain: \"Хранилище векторных слоев осталось\",\r\n            subscription: \"Подписки (Live Alerts)\",\r\n            subscriptionUsed: \"Подписок (Live Alerts) имеется\",\r\n            subscriptionRemain: \"Подписок (Live Alerts) осталось\",\r\n            smsAvailable: \"Sms (Live Alerts) доступны\",\r\n\r\n            apiKeys: \"API-ключи\",\r\n            apiKeyInvite: \"Для получения ключей воспользуйтесь соответсвующими ссылками\",\r\n            apiKeyDomain: \"API-ключ на домен (вставка окна карты на сайт)\",//\"API-ключ для сайтов (вставка окна карты на сайт)\", //\"API-Ключ для домена (для сайтов)\",\r\n            apiKeyDomainCap: \"API-ключ на домен\",\r\n            apiKeyDirect: \"API-ключ для приложений (запросы к REST/OGC)\", //\"API-Ключ прямого доступа (для приложений)\",\r\n            apiKeyDirectCap: \"API-ключ для приложений\",\r\n            apiKeyList: \"Список API-ключей\",\r\n            apiKeyListCap: \"Список API-ключей\",\r\n            apiKeyDirectShort: \"Ключ для приложения\",\r\n            apiKeyFilter: \"API-ключ или домен\",\r\n            apiKeyFilterApply: \"Найти\",\r\n            apiKeyEnabled: \"активен\",\r\n            apiKeyDisabled: \"не активен\",\r\n            apiKeyCreated: \"получен\",\r\n\r\n            directKeyPurpose1: \"API-ключ для приложений используется для обращений к <a target='blank' class='hyperLink' href='https://geomixer.ru/docs/dev-manual/rest-api/get-started/'>REST-сервисам</a> для подключения данных в настольные и/или веб-приложения.\",\r\n            directKeyPurpose2: \"API-ключ для приложений НЕ может быть использован на публичных сайтах.\",\r\n            apiKeySite: \"Сайт:\",\r\n            apiKeyReadAgreement: \"Пожалуйста, ознакомьтесь с \",\r\n            apiKeyAgreement: \"я согласен с \",\r\n            apiKeyConditions: \"условиями использования\",\r\n            apiKeyGet: \"Получить ключ\",\r\n            apiKeyUrge: \"Необходимо принять условия использования\",\r\n            apiKeyAccept: \"Принять\",\r\n            apiKeyCancel: \"Отклонить\",\r\n            apiKeyReceive: \"Ваш новый ключ\",\r\n\r\n            ErrorApiKeySiteEmpty: \"Поле сайт не может быть пустым!\",\r\n            ErrorApiKeySiteInvalid: \"Введите корректный адрес вашего сайта! Например, http://kosmosnimki.ru\",\r\n            ErrorApiKeyConditionsNotAccepted: \"Для получения ключа необходимо согласиться с условиями использования!\",\r\n\r\n            clientRegistration: \"Регистрация oAuth клиента\",\r\n            appName: \"Название приложения\",\r\n            clientID: \"ID клиента (client_id)\",\r\n            clientSecret: \"oAuth ключ клиента (client_secret)\",\r\n            redirectUri: \"URI скрипта обратного вызова (redirect_uri)\",\r\n            registerClient: \"Получить новый ключ\",\r\n\r\n            password: \"Пароль\",\r\n            getNew: \"Изменить\",\r\n            cancelNew: \"Закрыть\",\r\n            passwordSaved: \"сохранен\",\r\n            passwordChanged: \"изменен\",\r\n            old: \"Старый пароль\",\r\n            newp: \"Новый пароль\",\r\n            repeat: \"Повтор пароля\",\r\n            submitp: \"Изменить\",\r\n\r\n            megabyte: \" мБ\",\r\n            yes: \"да\",\r\n            no: \"нет\",\r\n\r\n            ErrorNOT_AUTHORIZED: \"Пользователь не авторизован!\",\r\n            ErrorLoginEmpty: \"Требуется указать псевдоним!\",\r\n            ErrorLoginFormat: \"Неправильный псевдоним! Допустимый вариант \",\r\n            ErrorLoginExists: \"Псевдоним уже используется!\",\r\n            ErrorAppName: \"Не указано название приложения!\",\r\n            ErrorRedirectUri: \"Требуется действительный uri обратного вызыва!\",\r\n            ErrorOldPassword: \"Старый пароль указан неверно!\",\r\n            ErrorNewPassword: \"Пароль не может быть пустым!\",\r\n            ErrorNotMatch: \"Введённые пароли не совпадают!\",\r\n\r\n            ErrorCapchaRequired: \"Введите число!\",\r\n            ErrorWrongCapcha: \"Числа не совпадают!\",\r\n            ErrorEmailEmpty: \"Требуется указать email!\",\r\n            ErrorWrongEmail: \"Недопустимый адрес электронной почты!\",\r\n            ErrorEmailExists: \"Такой адрес электронной почты уже зарегистрирован!\",\r\n\r\n            dataUpdateSuccess: \"Изменения сохранены\",\r\n\r\n            registration: \"Регистрация\",\r\n            registrationPageAnnotation: \"Заполните поля формы\",\r\n            //registrationPageAnnotation: \"Заполните поля формы. Введите ваш адрес электронной почты, псевдоним, желаемый пароль и число с картинки. Можете указать фамилилию и имя.\",\r\n            capcha: \"Введите число\",\r\n            register: \"Зарегистрироваться\",\r\n            backOn: \"Повторить\",\r\n            loginPage: \"вход\",\r\n            close: \"Закрыть\"\r\n\r\n        }\r\n        });\r\n\r\n        _translationsHash.addtext(\"eng\", { ProfilePlugin: {\r\n            profile: \"Profile\",\r\n            billing: \"Billing\",\r\n            developer: \"Developer\",\r\n\r\n            firstName: \"First name\",\r\n            lastName: \"Last name\",\r\n            email: \"Email\",\r\n            login: \"Nickname\",\r\n            fullName: \"Full name\",\r\n            phone: \"Phone\",\r\n            company: \"Company\",\r\n            companyProfile: \"Type of company activity\",\r\n            companyPosition: \"Company position\",\r\n            isCompany: \"I am speaking on behalf of the organization\",\r\n            subscribe: \"I agree to receive updates and news by email\",\r\n            saveChanges: \"Save\",\r\n\r\n            used: \"used\",\r\n            remain: \"rest\",\r\n            fileStorage: \"Files\",\r\n            fileStorageUsed: \"File storage consumtion\",\r\n            fileStorageRemain: \"File storage remain\",\r\n            vectorLayerStorage: \"Vector data\",\r\n            vectorLayerStorageUsed: \"Vector storage consumption\",\r\n            vectorLayerStorageRemain: \"Vector storage remain\",\r\n            subscription: \"Subscriptions\",\r\n            subscriptionUsed: \"Subscription consumption\",\r\n            subscriptionRemain: \"Subscription remain\",\r\n            smsAvailable: \"Sms\",\r\n\r\n            apiKeys: \"API-keys\",\r\n            apiKeyInvite: \"To get a key use apropriate links below\",\r\n            apiKeyDomain: \"Domain API-key (for sites)\",\r\n            apiKeyDomainCap: \"Domain API-key\",\r\n            apiKeyDirect: \"Direct access API-key (for applications)\",\r\n            apiKeyDirectCap: \"Direct access API-key\",\r\n            apiKeyList: \"Issued API-keys list\",\r\n            apiKeyListCap: \"Issued API-keys list\",\r\n            apiKeyDirectShort: \"Direct access key\",\r\n            apiKeyFilter: \"Key or domain\",\r\n            apiKeyFilterApply: \"Search\",\r\n            apiKeyEnabled: \"enabled\",\r\n            apiKeyDisabled: \"disabled\",\r\n            apiKeyCreated: \"created\",\r\n\r\n            directKeyPurpose1: \"API-ключ для приложений используется для обращений к REST-сервисам (https://geomixer.ru/docs/dev-manual/rest-api/get-started/) для подключения данных в настольные и/или веб-приложения. API-ключ для приложений НЕ может быть использован на публичных сайтах.\",\r\n            directKeyPurpose2: \"Ключ прямого доступа не может быть использован на сайте.\",\r\n            apiKeySite: \"Site:\",\r\n            apiKeyReadAgreement: \"Пожалуйста, ознакомьтесь с \",\r\n            apiKeyAgreement: \"я согласен с \",\r\n            apiKeyConditions: \"условиями использования\",\r\n            apiKeyGet: \"Get the key\",\r\n            apiKeyUrge: \"Необходимо принять условия использования\",\r\n            apiKeyAccept: \"Accept\",\r\n            apiKeyCancel: \"Cancel\",\r\n            apiKeyReceive: \"Ваш новый ключ\",\r\n\r\n            ErrorApiKeySiteEmpty: \"Поле сайт не может быть пустым!\",\r\n            ErrorApiKeySiteInvalid: \"Введите корректный адрес вашего сайта! Например, http://kosmosnimki.ru\",\r\n            ErrorApiKeyConditionsNotAccepted: \"Для получения ключа необходимо согласиться с условиями использования!\",\r\n\r\n            clientRegistration: \"oAuth Client Registration\",\r\n            appName: \"Client Application\",\r\n            clientID: \"Client ID (client_id)\",\r\n            clientSecret: \"Client secret key (client_secret)\",\r\n            redirectUri: \"Redirect endpoint URI\",\r\n            registerClient: \"Issue new secret key\",\r\n\r\n            password: \"Password\",\r\n            getNew: \"change\",\r\n            cancelNew: \"close\",\r\n            passwordSaved: \"saved\",\r\n            passwordChanged: \"changed\",\r\n            old: \"Old password\",\r\n            newp: \"New password\",\r\n            repeat: \"Repeat\",\r\n            submitp: \"Change\",\r\n\r\n            megabyte: \" MB\",\r\n            yes: \"yes\",\r\n            no: \"no\",\r\n\r\n            ErrorNOT_AUTHORIZED: \"Authorization is required!\",\r\n            ErrorLoginEmpty: \"Nickname is required!\",\r\n            ErrorLoginFormat: \"Invalid nickname! Allowable nickname \",\r\n            ErrorLoginExists: \"Nickname duplicates!\",\r\n            ErrorAppName: \"Application name is required!\",\r\n            ErrorRedirectUri: \"Valid redirect uri is required!\",\r\n            ErrorOldPassword: \"Password is invalid!\",\r\n            ErrorNewPassword: \"Password is required!\",\r\n            ErrorNotMatch: \"Passwords does not match!\",\r\n\r\n            ErrorCapchaRequired: \"Input a number!\",\r\n            ErrorWrongCapcha: \"Number mismatch!\",\r\n            ErrorEmailEmpty: \"Email is required!\",\r\n            ErrorWrongEmail: \"Invalid email!\",\r\n            ErrorEmailExists: \"Email duplicates!\",\r\n\r\n            dataUpdateSuccess: \"Saved successfully\",\r\n\r\n            registration: \"Registration\",\r\n            registrationPageAnnotation: \"Please fill all fields\",\r\n            capcha: \"Input a number\",\r\n            register: \"Register\",\r\n            backOn: \"Back to\",\r\n            loginPage: \"Login\",\r\n            close: \"Close\"\r\n\r\n        }\r\n        });\r\n    }\r\n\r\n    var ppBackScreen = $(\"div.profilePanel\"),\r\n    ppMainParts;\r\n\r\n    var showProfile = function () {\r\n        if (!ppBackScreen.length) {\r\n            // Create\r\n            ppBackScreen = $('<div class=\"profilePanel\"><table width=\"100%\" height=\"100%\"><tr><td><img src=\"img/progress.gif\"></td></tr></table></div>').hide().appendTo('#all');\r\n            var ppFrame = $('<div class=\"profilePanel-content\"></div>');\r\n            var ppScrollableContainer = $('<div class=\"profilePanel-scrollable\"></div>');\r\n            var ppMenu = $('<div class=\"profilePanel-menu\"></div>');\r\n            var success = $('<div class=\"UpdateMessage\"><div class=\"success\">' + _gtxt('ProfilePlugin.dataUpdateSuccess') + '</div></div>');\r\n            var fail = $('<div class=\"UpdateMessage\"><div class=\"fail\">' + 'Error' + '</div></div>');\r\n\r\n            // Pages\r\n            var pageTemplate =\r\n                '<div class=\"page\">' +\r\n                    '{{#each items}}' +\r\n                        '{{#if form_caption}}' +\r\n                            '<div class=\"form-caption {{#if first}}first{{/if}}\">{{text}}</div>' +\r\n                        '{{/if}}' +\r\n                        '{{#if span}}' +\r\n                            '<div>{{text}}: <span {{#if id}}class=\"{{id}}\"{{/if}}></span></div>' +\r\n                        '{{/if}}' +\r\n                        '{{#if span_nl}}' +\r\n                            '<div>{{text}}:<br/><span {{#if id}}class=\"{{id}}\"{{/if}}></span></div>' +\r\n                        '{{/if}}' +\r\n                        '{{#if block}}' +\r\n                            '<div>' +\r\n                                '{{#content}}' +\r\n                                    '{{#if p}}<p>{{text}}</p>{{/if}}' +\r\n                                    '{{#if link_button}}<div {{#if id}}class=\"{{id}} link_button\"{{/if}}><span>{{text}}</span></div>{{/if}}' +\r\n                                '{{/content}}' +\r\n                            '</div>' +\r\n                        '{{/if}}' +\r\n                        '{{#if text_input}}' +\r\n                            '<div onclick=\"$(this).children().focus()\" class=\"editable\">{{text}}: <input {{#if id}}class=\"{{id}}\"{{/if}} type=\"text\" value=\"\"></div>' +\r\n                        '{{/if}}' +\r\n                        '{{#if text_area}}' +\r\n                            '<div onclick=\"$(this).children().focus()\" class=\"editable\">{{text}}: <textarea {{#if id}}class=\"{{id}}\"{{/if}}></textarea></div>' +\r\n                        '{{/if}}' +\r\n                        '{{#if error}}' +\r\n                            '<div class=\"ErrorSummary\">error</div>' +\r\n                        '{{/if}}' +\r\n                        '{{#if button_input}}' +\r\n                            '<div class=\"SubmitBlock\" {{#if width}}style=\"width:{{width}}\"{{/if}}>' +\r\n                            '<input type=\"button\" {{#if id}}class=\"{{id}}\"{{/if}} value=\"{{text}}\"/>' +\r\n                            '<img src=\"img/progress.gif\"></div>' +\r\n                        '{{/if}}' +\r\n\r\n                        '{{#if checkbox_group}}' +\r\n                            '<table>' +\r\n                            '{{#each checkbox_group}}' +\r\n                                '<tr><td><input type=\"checkbox\" class=\"{{id}}\" id=\"pp{{id}}\"></td><td><label for=\"pp{{id}}\">{{text}}</label></td></tr>' +\r\n                            '{{/each}}' +\r\n                            '</table>' +\r\n                        '{{/if}}' +\r\n                        '{{#if table}}' +\r\n                            '<table border=0 class=\"{{id}}\">' +\r\n                            '{{#columns}}' + '<tr><th>{{column1}}</th><th>{{column2}}</th><th>{{column3}}</th></tr>' + '{{/columns}}' +\r\n                            '{{#rows}}' + '<tr>{{#cells}}<td class=\"{{id}}\">{{text}}</td>{{/cells}}</tr>' + '{{/rows}}' +\r\n                            '</table>' +\r\n                        '{{/if}}' +\r\n                    '{{/each}}' +\r\n                '</div>';\r\n            var page1 = $(Handlebars.compile(pageTemplate)(\r\n            { id: \"page1\", items: [\r\n                { span: true, id: \"Email\", text: _gtxt('ProfilePlugin.email') },\r\n                { text_input: true, id: \"Login LoginEmpty LoginFormat LoginExists correct\", text: _gtxt('ProfilePlugin.login') },\r\n                { text_input: true, id: \"FullName correct\", text: _gtxt('ProfilePlugin.fullName') },\r\n                { text_input: true, id: \"Phone correct\", text: _gtxt('ProfilePlugin.phone') },\r\n                { text_input: true, id: \"Company correct\", text: _gtxt('ProfilePlugin.company') },\r\n                { text_input: true, id: \"CompanyProfile correct\", text: _gtxt('ProfilePlugin.companyProfile') },\r\n                { text_input: true, id: \"CompanyPosition correct\", text: _gtxt('ProfilePlugin.companyPosition') },\r\n                { checkbox_group: [\r\n                    { id: \"IsCompany\", text: _gtxt('ProfilePlugin.isCompany') },\r\n                    { id: \"Subscribe\", text: _gtxt('ProfilePlugin.subscribe') }\r\n                ]\r\n                },\r\n                { error: true },\r\n                { button_input: true, id: \"SaveChanges\", text: _gtxt('ProfilePlugin.saveChanges') }\r\n            ]\r\n            })).appendTo(ppFrame),\r\n            page2 = $(Handlebars.compile(pageTemplate)(\r\n            { id: \"page2\", items: [\r\n                { table: true, id: \"ResourceTable\",\r\n                    columns: [{ column1: \"\", column2: _gtxt('ProfilePlugin.used'), column3: _gtxt('ProfilePlugin.remain')}],\r\n                    rows: [\r\n                        { cells: [\r\n                        { id: \"FileStorage\", text: _gtxt('ProfilePlugin.fileStorage') },\r\n                        { id: \"FileStorageUsed value\", text: \"b1\" },\r\n                        { id: \"FileStorageRemain value\", text: \"c1\"}]\r\n                        },\r\n                        { cells: [\r\n                        { id: \"VectorLayerStorage\", text: _gtxt('ProfilePlugin.vectorLayerStorage') },\r\n                        { id: \"VectorLayerStorageUsed value\", text: \"b2\" },\r\n                        { id: \"VectorLayerStorageRemain value\", text: \"c2\"}]\r\n                        },\r\n                        { cells: [\r\n                        { id: \"Subscription\", text: _gtxt('ProfilePlugin.subscription') },\r\n                        { id: \"SubscriptionUsed value\", text: \"b3\" },\r\n                        { id: \"SubscriptionRemain value\", text: \"c3\"}]\r\n                        }\r\n                    ]\r\n\r\n                },\r\n                { span: true, id: \"SmsAvailable\", text: _gtxt('ProfilePlugin.smsAvailable') }\r\n            ]\r\n            })).appendTo(ppFrame),\r\n            page3 = $(Handlebars.compile(pageTemplate)(\r\n            { id: \"page3\", items: [\r\n                { form_caption: true, text: _gtxt('ProfilePlugin.apiKeys'), first: true },\r\n                { block: true, content: [{ link_button: true, text: _gtxt('ProfilePlugin.apiKeyList'), id: \"apiKeyList\"}] },\r\n                { block: true, content: [\r\n                     { p: true, text: _gtxt('ProfilePlugin.apiKeyInvite') },\r\n                     { link_button: true, text: _gtxt('ProfilePlugin.apiKeyDomain'), id: \"apiKeyDomain\" },\r\n                     { link_button: true, text: _gtxt('ProfilePlugin.apiKeyDirect'), id: \"apiKeyDirect\" }\r\n                ]\r\n                },\r\n                { form_caption: true, text: _gtxt('ProfilePlugin.clientRegistration') },\r\n                { text_input: true, id: \"AppName correct\", text: _gtxt('ProfilePlugin.appName') },\r\n                { span: true, id: \"ClientID\", text: _gtxt('ProfilePlugin.clientID') },\r\n                { span_nl: true, id: \"ClientSecret\", text: _gtxt('ProfilePlugin.clientSecret') },\r\n                { text_input: true, id: \"RedirectUri correct\", text: _gtxt('ProfilePlugin.redirectUri') },\r\n                { error: true },\r\n                { button_input: true, id: \"RegisterClient\", text: _gtxt('ProfilePlugin.registerClient'), width: '180px' }\r\n            ]\r\n            })).appendTo(ppFrame);\r\n\r\n            // Profile submit\r\n            var successmess_timeout;\r\n            page1.find('.SaveChanges').click(function () {\r\n                changePassForm.slideUp(\"fast\");\r\n                changePassControls.first().val(_gtxt('ProfilePlugin.getNew'));\r\n                success.hide();\r\n                var wait = $(this).next().css('visibility', 'visible');\r\n                clearTimeout(successmess_timeout);\r\n\r\n                sendCrossDomainPostRequest(mykosmosnimki + \"/Handler/Settings\", { WrapStyle: 'message',\r\n                    Login: page1.find('.Login').val().trim(),\r\n                    FullName: page1.find('.FullName').val().trim(),\r\n                    Phone: page1.find('.Phone').val().trim(),\r\n                    Company: page1.find('.Company').val().trim(),\r\n                    Profile: page1.find('.CompanyProfile').val().trim(),\r\n                    Position: page1.find('.CompanyPosition').val().trim(),\r\n                    IsCompany: page1.find('.IsCompany').is(\":checked\"),\r\n                    Subscribe: page1.find('.Subscribe').is(\":checked\")\r\n                    },\r\n                    function (response) {\r\n                        wait.css('visibility', 'hidden');\r\n                        if (response.Status.toLowerCase() == 'ok' && response.Result) {\r\n                            //page1.children('.ErrorSummary').text('error').css('visibility', 'hidden');\r\n                            page1.children('.ErrorSummary').hide();\r\n                            success.show();\r\n                            successmess_timeout = setTimeout(function () { success.hide(); }, 2000);\r\n                        }\r\n                        else if (response.Result.length > 0 && response.Result[0].Key)\r\n                            page1.trigger('onerror', [response.Result[0].Key, response.Result[0].Value.Errors[0].ErrorMessage]);\r\n                        else\r\n                            page1.trigger('onerror', response.Result.Message);                          \r\n                    });\r\n            });\r\n\r\n            // Register client submit\r\n            var newsecret_timeout;\r\n            page3.find('.RegisterClient').click(function () {\r\n\r\n                closeApiKeyDialog();\r\n                var wait = $(this).next().css('visibility', 'visible');\r\n                var client_secret = page3.find('.ClientSecret').removeClass('new');\r\n                clearTimeout(newsecret_timeout);\r\n\r\n                sendCrossDomainPostRequest(mykosmosnimki + \"/Handler/RegisterClient\", { WrapStyle: 'message',\r\n                    AppName: page3.find('.AppName').val(), RedirectUri: page3.find('.RedirectUri').val()\r\n                },\r\n                      function (response) {\r\n                          wait.css('visibility', 'hidden');\r\n                          if (response.Status.toLowerCase() == 'ok' && response.Result) {\r\n                              client_secret.addClass('new').text(response.Result.Key);\r\n                              newsecret_timeout = setTimeout(function () { client_secret.removeClass('new'); }, 2000);\r\n                              //page3.children('.ErrorSummary').css('visibility', 'hidden');\r\n                              page3.children('.ErrorSummary').hide();\r\n                          }\r\n                          else {\r\n                              page3.trigger('onerror', response.Result.Message);\r\n                          }\r\n                      });\r\n            });\r\n            var ppPages = ppFrame.find('div.page').hide();\r\n\r\n            // Change password form\r\n            var changePassControls = $(Handlebars.compile(\r\n            '<input style=\"width:80px; float:right; margin:6px 12px 0 0;\" type=\"button\" value=\"{{i \"ProfilePlugin.getNew\"}}\"/>' +\r\n            '<div style=\"border:none; font-weight:normal;margin:10px 0 10px 12px;\">{{i \"ProfilePlugin.password\"}} <span class=\"PasswordState\">{{i \"ProfilePlugin.passwordSaved\"}}</span></div>')())\r\n            .insertAfter(page1.find('.Email').parent()),\r\n            changePassForm = $(Handlebars.compile(\r\n            '<div class=\"newpass-form\">' +\r\n                '{{i \"ProfilePlugin.old\"}}: <input type=\"password\" class=\"OldPassword\" value=\"\"><br/>' +\r\n                '{{i \"ProfilePlugin.newp\"}}: <input type=\"password\" class=\"NewPassword NotMatch\" value=\"\"><br/>' +\r\n                '{{i \"ProfilePlugin.repeat\"}}: <input type=\"password\" class=\"PasswordRepeat NotMatch\" value=\"\"><br/>' +\r\n                '<div class=\"ErrorSummary\" style=\"padding-top:6px\"></div>\\\r\n                <div class=\"SubmitBlock\">\\\r\n                <input type=\"button\" class=\"ChangePassword\" value=\"{{i \"ProfilePlugin.submitp\"}}\"/>\\\r\n                <img src=\"img/progress.gif\"></div>' +\r\n\r\n            '</div>')()),\r\n            changePass_timeout;\r\n\r\n            changePassForm.insertAfter(changePassControls.last());\r\n            changePassForm.find('.ChangePassword').click(function () {\r\n                //clearPageErrors($(this));\r\n                //clearPageErrors(page1);\r\n                var wait = $(this).next().css('visibility', 'visible');\r\n                sendCrossDomainPostRequest(mykosmosnimki + \"/Handler/ChangePassword\", { WrapStyle: 'message',\r\n                    oldpassword: changePassForm.children('.OldPassword').val().trim(),\r\n                    password: changePassForm.children('.NewPassword').val().trim(),\r\n                    repeat: changePassForm.children('.PasswordRepeat').val().trim()\r\n                },\r\n                function (response) {\r\n                    wait.css('visibility', 'hidden');\r\n                    clearTimeout(changePass_timeout);\r\n                    if (response.Status.toLowerCase() == 'ok' && response.Result) {\r\n                        var state = changePassForm.hide().prev().find('.PasswordState').text(_gtxt('ProfilePlugin.passwordChanged')).addClass('changed');\r\n                        changePassControls.first().val(_gtxt('ProfilePlugin.getNew'));\r\n                        changePass_timeout = setTimeout(function () {\r\n                            state.fadeOut(\"slow\", function () {\r\n                                $(this).text(_gtxt('ProfilePlugin.passwordSaved')).removeClass('changed');\r\n                            }).fadeIn(\"slow\");\r\n                        }, 2000);\r\n                    }\r\n                    else\r\n                        changePassForm.trigger('onerror', response.Result.Message);\r\n                });\r\n            });\r\n\r\n            changePassControls.first().click(function () {\r\n                if (changePassForm.is(':visible')) {\r\n                    changePassForm.slideUp(\"fast\");\r\n                    $(this).val(_gtxt('ProfilePlugin.getNew'));\r\n                } else {\r\n                    changePassForm.slideDown(\"fast\");\r\n                    $(this).val(_gtxt('ProfilePlugin.cancelNew'));\r\n                    changePassForm.trigger('onrender');\r\n                }\r\n            });\r\n\r\n            // API-keys dialogs\r\n            var closeApiKeyDialog = function () {\r\n                var akd = $('.apiKeyDialog');\r\n                if (akd.length > 0) {\r\n                    // akd.find('.licence').mCustomScrollbar(\"destroy\");\r\n                    // akd.find('.list').mCustomScrollbar(\"destroy\");\r\n                    removeDialog($('.apiKeyDialog').parent()[0]);\r\n                }\r\n            },\r\n            showApiKeyDialog = function (dtype) {\r\n                //if ($('.apiKeyDialog').length > 0) {\r\n                //  return;\r\n                //}\r\n\r\n                closeApiKeyDialog();\r\n                clearPageErrors($('.page:visible'));\r\n\r\n                if (dtype == 'List') {\r\n                    let startW = 556, startH = 340,\r\n                        akDialog = $('<div class=\"apiKeyDialog\"></div>'),\r\n                        wait = $('<div style=\"position:absolute; top:120px; left:270px\"><img src=\"img/progress.gif\"></div>');\r\n                    akDialog.append(wait);\r\n                    window.showDialog(_gtxt('ProfilePlugin.apiKey' + dtype + 'Cap'), akDialog[0], startW, startH)\r\n                    .style.overflow = 'hidden';\r\n\r\n                    akDialog.parent().on(\"dialogresizestart\", function () {\r\n                        //startW = ui.size.width;\r\n                        //startH = ui.size.height;\r\n                    })\r\n                    .on(\"dialogresize\", function (event, ui) {\r\n                        var list = akDialog.find('.list');\r\n                        list.height(list.height() + ui.size.height - startH);\r\n                        //startW = ui.size.width;\r\n                        startH = ui.size.height;\r\n                    });\r\n                    sendCrossDomainJSONRequest(mykosmosnimki + \"/handler/apikeys?wrapstyle=func\", function (response) {\r\n                         if (parseResponse(response) || response.Status == 'OK') {\r\n                             wait.remove();\r\n                             if (response.Result && response.Result.length > 0) {\r\n                                var list = $('<div class=\"list\"></div>'),\r\n\t\t\t\t\t\t\t\tapiKeyActivation = function(){\r\n\t\t\t\t\t\t\t\t\tvar checkboxes = $('input[type=\"checkbox\"]', list)\r\n\t\t\t\t\t\t\t\t\t.click(function(){\r\n\t\t\t\t\t\t\t\t\t\tcheckboxes.prop('disabled', true);\r\n\t\t\t\t\t\t\t\t\t\tvar progress = $('<span>&nbsp;</span><img src=\"img/progress.gif\">')\r\n\t\t\t\t\t\t\t\t\t\tvar checkbox = $(this);\r\n\t\t\t\t\t\t\t\t\t\tcheckbox.parent().append(progress)\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tsendCrossDomainPostRequest(mykosmosnimki + \"/Handler/ActivateKey\", { \r\n\t\t\t\t\t\t\t\t\t\t\tWrapStyle: 'message',\r\n\t\t\t\t\t\t\t\t\t\t\tApikey: checkbox.val()\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tfunction (apiKeyResp) {\r\n\t\t\t\t\t\t\t\t\t\t\tcheckboxes.prop('disabled', false);\r\n\t\t\t\t\t\t\t\t\t\t\tprogress.remove();\r\n\t\t\t\t\t\t\t\t\t\t\tif (apiKeyResp.Status.toLowerCase() == 'ok') {\r\n\t\t\t\t\t\t\t\t\t\t\t\tfor (var i = 0; i < response.Result.length; ++i)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (response.Result[i].Apikey==apiKeyResp.Result.Apikey){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tresponse.Result[i].IsActive = apiKeyResp.Result.IsActive;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(response);\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t},\r\n                                createTbl = function (filter) {\r\n                                    var tbl = '<div><table border=0>';\r\n                                    var re = new RegExp(filter, 'i');\r\n                                    for (var i = 0; i < response.Result.length; ++i)\r\n                                        if (filter == null || filter.search(/\\S/) < 0 || response.Result[i].Apikey.search(re) != -1 || (response.Result[i].Domain != 'Direct' && response.Result[i].Domain.search(re) != -1))\r\n                                            tbl += '<tr><td>' + response.Result[i].Apikey + '</td><td style=\"word-break:break-all\">' + (response.Result[i].AllowDirect ? _gtxt('ProfilePlugin.apiKeyDirectShort') : response.Result[i].Domain) +\r\n                                            //'</td><td>' + (response.Result[i].IsActive ? '<i class=\"icon-check\">' : '') +\r\n\t\t\t\t\t\t\t\t\t\t\t'</td><td>' + '<input type=\"checkbox\" '+(response.Result[i].IsActive ? 'checked' : '') + ' value=\"' + response.Result[i].Apikey + '\">' +\r\n                                            '</td><td>' + response.Result[i].Created + '</td></tr>';\r\n                                    tbl += '</table></div>';\r\n                                    return tbl;\r\n                                };\r\n                                 var filter = $('<div style=\"padding-left:6px\">' + _gtxt('ProfilePlugin.apiKeyFilterApply') + ': <input type=\"text\" placeholder=\"' + _gtxt('ProfilePlugin.apiKeyFilter') + '\"></div>').appendTo(akDialog);\r\n                                 filter.find('input[type=\"text\"]').keyup(function () {\r\n                                     list.find('table').parent().remove();\r\n                                     list.mCustomScrollbar('destroy')\r\n                                     .append(createTbl($(this).val())).mCustomScrollbar();\r\n\t\t\t\t\t\t\t\t\t apiKeyActivation();\r\n                                     keys = list.find('table');\r\n                                     resize(akDialog.parent().dialog(\"option\", \"width\") - startW);\r\n                                 });\r\n                                 list.appendTo(akDialog)\r\n                                .append($(createTbl()))\r\n                                .mCustomScrollbar();\r\n\t\t\t\t\t\t\t\tapiKeyActivation();\r\n\t\t\t\t\t\t\t\t\r\n                                var header = list.before($(Handlebars.compile('<table border=0><tr><th>ключ</th><th>тип/сайт</th><th>активен</th><th>{{i \"ProfilePlugin.apiKeyCreated\"}}</th></tr></table>')())).prev(),\r\n                                keys = list.find('table'),\r\n                                resize = function (dif) {\r\n                                    var th = header.find('tr th')\r\n                                    var td = keys.find('tr:eq(0) td');\r\n                                    header.width(keys.width(514 + dif).width());\r\n                                    th.eq(0).width(td.eq(0).width(90).width());\r\n                                    th.eq(2).width(td.eq(2).width(70).width());\r\n                                    th.eq(3).width(td.eq(3).width(90).width());\r\n                                    th.eq(1).width(td.eq(1).width());\r\n                                };\r\n                                 akDialog.parent().on(\"dialogresize\", function (event, ui) {\r\n                                     resize(ui.size.width - startW);\r\n                                 });\r\n                                 resize(0);\r\n                             }\r\n                         }\r\n                         else {\r\n                             removeDialog(akDialog.parent()[0]);\r\n                         }\r\n                     });\r\n                }\r\n                else {\r\n                    var fordirect = dtype == 'Direct' ?\r\n                    '<div>{{{i \"ProfilePlugin.directKeyPurpose1\"}}}</div>' +\r\n                    '<div>{{i \"ProfilePlugin.directKeyPurpose2\"}}</div>'\r\n                    : '';\r\n                    var fordomain = dtype == 'Domain' ?\r\n                    '<div>{{i \"ProfilePlugin.apiKeySite\"}}<input type=\"text\" tabindex=\"2\" class=\"ApiKeySite ApiKeySiteEmpty ApiKeySiteInvalid\" value=\"http://\"></div>'\r\n                    : '';\r\n                    var akForm = $(Handlebars.compile('<div class=\"apiKeyDialog\">' +\r\n                    '<div class=\"first\">' +\r\n                    '<div>{{i \"ProfilePlugin.apiKeyReadAgreement\"}}<span class=\"showLicence hyperLink\">{{i \"ProfilePlugin.apiKeyConditions\"}}</span></div>' +\r\n                    '<div><div style=\"float:left;margin:0\"><input type=\"checkbox\" tabindex=\"1\" id=\"agree\" class=\"agree\"></div><div style=\"padding-left:10px\"><label for=\"agree\">{{i \"ProfilePlugin.apiKeyAgreement\"}} {{i \"ProfilePlugin.apiKeyConditions\"}}</div></div>' +\r\n                    fordomain +\r\n                    fordirect +\r\n                    '<div class=\"spacer\"></div>' +\r\n                    '<div class=\"ErrorSummary\"><span class=\"fail\"></span><span class=\"success\"></span><img class=\"wait\" src=\"img/progress.gif\"></div>' +\r\n                    '<div class=\"submit\"><input tabindex=\"3\" type=\"button\" class=\"get\" title=\"{{i \"ProfilePlugin.apiKeyUrge\"}}\" value=\"{{i \"ProfilePlugin.apiKeyGet\"}}\"/></div>' +\r\n                    '</div>' +\r\n                    '<div class=\"licence\"></div>' +\r\n                    '<div class=\"submit\"><input tabindex=\"1\" type=\"button\" class=\"accept\" value=\"{{i \"ProfilePlugin.apiKeyAccept\"}}\"/><input tabindex=\"2\" type=\"button\" class=\"cancel\" value=\"{{i \"ProfilePlugin.apiKeyCancel\"}}\"/></div>' +\r\n                    '</div>')());\r\n\r\n                    let licence = akForm.find('.licence'),\r\n                        spacer = akForm.find('.spacer'),\r\n                        startH;\r\n                    licence.hide().next().hide();\r\n                    if (dtype == 'Domain')\r\n                        spacer.height('20px');\r\n\r\n                    let summary = akForm.find('.ErrorSummary'),\r\n                        wait = summary.children('.wait'),\r\n                        site = akForm.find('.ApiKeySite'),\r\n                        agree = akForm.find('.agree'),\r\n                        getKey = akForm.find('.get').css('opacity', 0.5)\r\n                        .click(function () {\r\n                            var respHandler = function (response) {\r\n                                wait.css('visibility', 'hidden');\r\n                                if (response.Status.toLowerCase() == 'ok' && response.Result) {\r\n                                    summary.children('span.success').text(_gtxt('ProfilePlugin.apiKeyReceive') + ' ' + response.Result.Key);\r\n                                }\r\n                                else {\r\n                                    summary.children('span.fail').text(_gtxt('ProfilePlugin.Error' + response.Result.Message));\r\n                                    akForm.find('.' + response.Result.Message).addClass('error')\r\n                                }\r\n                            };\r\n                            clearError();\r\n                            wait.css('visibility', 'visible');\r\n                            if (site.length)\r\n                                sendCrossDomainPostRequest(mykosmosnimki\r\n                            + \"/Handler/CreateKey\", { WrapStyle: 'message', domain: site.val(), agree: agree.is(':checked') }\r\n                            , respHandler);\r\n                            else\r\n                                sendCrossDomainPostRequest(mykosmosnimki\r\n                            + \"/Handler/CreateDirect\", { WrapStyle: 'message', agree: agree.is(':checked') }\r\n                            , respHandler);\r\n                        });\r\n                    getKey.prop('disabled', true);\r\n                    site.prop('disabled', true).keydown(function (e) {\r\n                        if ($(this).is('.error')) clearError();\r\n                        if (e.which == 13)\r\n                            getKey.click();\r\n                    });\r\n                    var clearError = function () {\r\n                        summary.children('span').text('');\r\n                        site.removeClass('error');\r\n                    };\r\n                    akForm.find('.showLicence').click(function () {\r\n                        clearError();\r\n                        licence.show().prev().hide();\r\n                        licence.next().show();\r\n                        if (licence.text() == '')\r\n                            licence.load(window.gmxCore.getModulePath('ProfilePlugin') + 'license.html', function () { licence.mCustomScrollbar() });\r\n                    });\r\n                    licence.next('div').children('input').click(function () {\r\n                        licence.next().hide();\r\n                        licence.hide().prev().show();\r\n                    })\r\n                    .first().click(function () {\r\n                        agree[0].checked = true;\r\n                        agree.change();\r\n                    })\r\n                    .next('.cancel').click(function () {\r\n                        agree[0].checked = false;\r\n                        agree.change();\r\n                    });\r\n                    agree.change(function () {\r\n                        getKey.prop('disabled', !agree.is(':checked'));\r\n                        site.prop('disabled', !agree.is(':checked'));\r\n\r\n                        if (agree.is(':checked')) {\r\n                            getKey.css('opacity', 1)\r\n                            .focus()\r\n                            .attr('title', _gtxt('ProfilePlugin.apiKeyGet'));\r\n                        }\r\n                        else {\r\n                            getKey.css('opacity', 0.5)\r\n                            .attr('title', _gtxt('ProfilePlugin.apiKeyUrge'));\r\n                        }\r\n                    });\r\n\r\n                    window.showDialog(_gtxt('ProfilePlugin.apiKey' + dtype + 'Cap'), akForm[0], 555, 320);\r\n                    akForm.parent('.ui-dialog-content').css('overflow', 'hidden');\r\n                    akForm.parent().on(\"dialogresizestart\", function (event, ui) { startH = ui.size.height; })\r\n                    .on(\"dialogresize\", function (event, ui) {\r\n                        licence.height(licence.height() + ui.size.height - startH);\r\n                        spacer.height(spacer.height() + ui.size.height - startH);\r\n                        startH = ui.size.height;\r\n                    });\r\n                }\r\n            };\r\n            page3.find('.apiKeyDomain').click(function () { showApiKeyDialog('Domain'); });\r\n            page3.find('.apiKeyDirect').click(function () { showApiKeyDialog('Direct'); });\r\n            page3.find('.apiKeyList').click(function () { showApiKeyDialog('List'); });\r\n\r\n            ppPages.find('input[type=\"text\"], input[type=\"password\"]').keyup(function (e) {\r\n                if (e.which == 13) {\r\n                    var submit = $(this).siblings('div.SubmitBlock').children('input[type=\"button\"]');\r\n                    if (!submit.length)\r\n                        submit = $(this).parent().siblings('div.SubmitBlock').children('input[type=\"button\"]');\r\n                    submit.click();\r\n                }\r\n                else\r\n                    clearInputErrors($(this));\r\n            })\r\n            .focusin(function () {\r\n                closeApiKeyDialog();\r\n                clearInputErrors($(this));\r\n            });\r\n\r\n            // Error display\r\n            var clearInputErrors = function (input) {\r\n                if (input.val().search(/\\S/) != -1 && input.is('.error')) {\r\n                    var es = input.nextAll('.ErrorSummary');\r\n                    if (es.length == 0)\r\n                        es = input.parent().nextAll('.ErrorSummary');\r\n                    if (input.is('.NotMatch')) {\r\n                        var s = input.siblings('.NotMatch');\r\n                        if (s.val() === input.val()) {\r\n                            input.removeClass('error');\r\n                            s.removeClass('error');\r\n                            es.slideUp(); //.hide();\r\n                        }\r\n                    }\r\n                    else {\r\n                        input.removeClass('error').addClass('correct');\r\n                        es.slideUp(); //.hide();\r\n                    }\r\n                }\r\n            }\r\n            var clearPageErrors = function (page) {\r\n                page.find('.ErrorSummary').hide();\r\n                page.find('.error').removeClass('error');\r\n            }\r\n            changePassForm.bind('onerror', function (e, m) {\r\n                $(this).children('.ErrorSummary').text(_gtxt('ProfilePlugin.Error' + m)).slideDown('slow');\r\n                $(this).find('.' + m).addClass('error');\r\n                $(this).find(':password,:text').filter(function () { return $(this).val() == \"\"; }).addClass('error');\r\n                return false;\r\n            });\r\n            changePassForm.bind('onrender', function () {\r\n                $(this).children('input[type=\"password\"]').val('');\r\n                clearPageErrors($(this));\r\n                clearPageErrors(page1);\r\n                return false;\r\n            });\r\n            ppPages.bind('onerror', function (e, m1, m2) {\r\n                var m = _gtxt('ProfilePlugin.Error' + m1);\r\n                if (m2)\r\n                    m += \" \" + m2;\r\n                $(this).children('.ErrorSummary').text(m).slideDown('slow');\r\n                $(this).find('.' + m1).removeClass('correct').addClass('error');\r\n                return false;\r\n            })\r\n            ppPages.bind('onrender', function () {\r\n                clearPageErrors($(this));\r\n                changePassForm.hide();\r\n                changePassControls.first().val(_gtxt('ProfilePlugin.getNew'));\r\n                return false;\r\n            });\r\n\r\n            ppPages.first().show();\r\n            ppScrollableContainer.hide().appendTo('#all').append(ppFrame);\r\n\r\n            // Menu\r\n            var menuEntryTemplate = '<div class=\"MenuEntry\">{{text}}</div>';\r\n            var showPage = function (e, page) {\r\n\r\n                closeApiKeyDialog();\r\n\r\n                ppMenu.children('.MenuEntry').removeClass('selected');\r\n                ppPages.hide();\r\n                page.show();\r\n                $(e.target).removeClass('targeted').addClass('selected');\r\n                page.trigger('onrender');\r\n            };\r\n            $(Handlebars.compile(menuEntryTemplate)({ text: _gtxt('ProfilePlugin.profile') })).appendTo(ppMenu).click(function (e) { showPage(e, page1); });\r\n            $(Handlebars.compile(menuEntryTemplate)({ text: _gtxt('ProfilePlugin.billing') })).appendTo(ppMenu).click(function (e) { showPage(e, page2); });\r\n            $(Handlebars.compile(menuEntryTemplate)({ text: _gtxt('ProfilePlugin.developer') })).appendTo(ppMenu).click(function (e) { showPage(e, page3); });\r\n\r\n            //wait.appendTo(ppMenu).hide();\r\n            success.appendTo(ppMenu).hide();\r\n            fail.appendTo(ppMenu).hide();\r\n            ppMenu.hide().appendTo('#all');\r\n            var ppMenuEntries = ppMenu.children('.MenuEntry');\r\n            ppMenuEntries.first().addClass('selected');\r\n            ppMenuEntries.mouseover(function (e) { if (!$(e.target).is('.selected')) $(e.target).addClass('targeted') });\r\n            ppMenuEntries.mouseout(function (e) { if (!$(e.target).is('.selected')) $(e.target).removeClass('targeted') });\r\n\r\n            // All together\r\n            ppMainParts = $([ppScrollableContainer, ppMenu]).map(function () { return this[0]; });\r\n            ppMainParts.data('ondataload', function () {\r\n                if (ppBackScreen.is(':visible')) {\r\n                    ppPages.trigger('onrender');\r\n                    ppMainParts.show();\r\n                }\r\n            });\r\n            $('body>div>div').mousedown(function (e) {\r\n                if (!ppMainParts.is($(e.target)) && !ppMainParts.find($(e.target)).length) {\r\n                    ppBackScreen.hide();\r\n                    ppMainParts.hide();\r\n                    closeApiKeyDialog();\r\n                    if (!nsGmx.leafletMap.gmxControlsManager.get('layers')) {\r\n                        nsGmx.leafletMap.addControl(overlays);\r\n                    }\r\n                }\r\n            });\r\n            ppScrollableContainer.mCustomScrollbar();\r\n            $(window).resize(resizePanel);\r\n        }\r\n\r\n        // Show\r\n        var overlays = nsGmx.leafletMap.gmxControlsManager.get('layers');\r\n        ppBackScreen.show();\r\n        fillProfile(ppMainParts.data('ondataload'), function () { ppBackScreen.hide(); });\r\n        resizePanel();\r\n    };\r\n\r\n    var fillProfile = function (onsuccess, onerror) {\r\n        sendCrossDomainJSONRequest(mykosmosnimki + \"/currentuser.ashx\", function (response) {\r\n            if (parseResponse(response) && response.Result) {\r\n                var content = $('.profilePanel-content');\r\n                content.find('.Email').text(response.Result[0].Email);\r\n                content.find('.PasswordState').text(_gtxt('ProfilePlugin.passwordSaved'));\r\n                content.find('.Login').val(response.Result[0].Login);\r\n                content.find('.FullName').val(response.Result[0].FullName);\r\n                content.find('.Phone').val(response.Result[0].Phone);\r\n                content.find('.Company').val(response.Result[0].Company);\r\n                content.find('.CompanyProfile').val(response.Result[0].CompanyProfile);\r\n                content.find('.CompanyPosition').val(response.Result[0].CompanyPosition);\r\n                content.find('.Subscribe').prop('checked', response.Result[0].Subscribe);\r\n                content.find('.IsCompany').prop('checked', response.Result[0].IsCompany);\r\n                fillBillingPage(content, response);\r\n                fillDeveloperPage(content, response);\r\n                onsuccess();\r\n            }\r\n            else {\r\n                onerror();\r\n            }\r\n        });\r\n    };\r\n\r\n    var fillBillingPage = function (content, response) {\r\n        content.find('.FileStorageUsed').text((response.Result[0].FileStorageUsed / 1000000).toFixed(2) + _gtxt('ProfilePlugin.megabyte'));\r\n        content.find('.FileStorageRemain').text(response.Result[0].FileStorageAvailable == null ? '' : ((response.Result[0].FileStorageAvailable - response.Result[0].FileStorageUsed) / 1000000).toFixed(2) + _gtxt('ProfilePlugin.megabyte'));\r\n        content.find('.VectorLayerStorageUsed').text((response.Result[0].VectorLayerStorageUsed / 1000000).toFixed(2) + _gtxt('ProfilePlugin.megabyte'));\r\n        content.find('.VectorLayerStorageRemain').text(response.Result[0].VectorLayerStorageAvailable == null ? '' : ((response.Result[0].VectorLayerStorageAvailable - response.Result[0].VectorLayerStorageUsed) / 1000000).toFixed(2) + _gtxt('ProfilePlugin.megabyte'));\r\n        content.find('.VectorLayers').text(response.Result[0].VectorLayers);\r\n        content.find('.VectorLayerObjects').text(response.Result[0].VectorLayerObjects);\r\n\r\n        content.find('.SmsAvailable').text(response.Result[0].SmsAvailable == null || response.Result[0].SmsAvailable > 0 ? _gtxt('ProfilePlugin.yes') : _gtxt('ProfilePlugin.no'));\r\n        content.find('.SubscriptionUsed').text(response.Result[0].SubscriptionUsed != null ? response.Result[0].SubscriptionUsed : '');\r\n        content.find('.SubscriptionRemain').text(response.Result[0].SubscriptionRemain != null ? response.Result[0].SubscriptionRemain : '');\r\n    }\r\n\r\n    var fillDeveloperPage = function (content, response) {\r\n        content.find('.AppName').val(response.Result[0].AppName);\r\n        content.find('.ClientID').text(response.Result[0].ID);\r\n        content.find('.ClientSecret').text(response.Result[0].ClientSecret);\r\n        content.find('.RedirectUri').val(response.Result[0].RedirectUri);\r\n    }\r\n\r\n    var resizePanel = function () {\r\n        var h = $('#leftMenu').css('height');\r\n        $('.profilePanel, .profilePanel-scrollable, .profilePanel-menu').height(h);\r\n    }\r\n\r\n    // RegistrationForm\r\n    var showRegistrationForm = function () {\r\n        var registrationForm = $(Handlebars.compile(\r\n        '<table style=\"width:100%;height:100%;\" border=\"0\"><tr><td>\\\r\n        <form>\\\r\n            <table class=\"registrationForm\" border=\"0\">\\\r\n            <tr><td colspan=\"2\" class=\"header\">{{i \"ProfilePlugin.registrationPageAnnotation\"}}</td></tr>\\\r\n\t\t\t<tr><td colspan=\"2\">\\\r\n\t\t\t<table border=\"0\"><tr>\\\r\n\t\t\t<td>{{i \"ProfilePlugin.firstName\"}}</td><td align=\"right\"><input type=\"text\" tabindex=\"1\" class=\"FirstName\" id=\"RegFirstName\" name=\"RegFirstName\"/></td>\\\r\n\t\t\t<td class=\"LastNameLbl\">{{i \"ProfilePlugin.lastName\"}}</td><td align=\"right\"><input type=\"text\" tabindex=\"1\" class=\"LastName\" id=\"RegLastName\" name=\"RegLastName\"/></td>\\\r\n\t\t\t</tr></table>\\\r\n\t\t\t</td></tr>\\\r\n            <tr><td colspan=\"2\"><table border=\"0\"><tr><td>{{i \"ProfilePlugin.email\"}}</td><td align=\"right\"><input type=\"text\" tabindex=\"1\" class=\"Login EmailEmpty WrongEmail EmailExists\" id=\"RegEmail\" name=\"RegEmail\"/></td></tr></table></td></tr>\\\r\n            <tr>\\\r\n                <td>\\\r\n                    <table border=\"0\"><tr><td>{{i \"ProfilePlugin.password\"}}</td><td align=\"right\"><input tabindex=\"2\" type=\"password\" class=\"Password NewPassword NotMatch\"/></td></tr></table>\\\r\n                </td>\\\r\n                <td>\\\r\n                    <table border=\"0\"><tr><td>{{i \"ProfilePlugin.repeat\"}}</td><td align=\"right\"><input type=\"password\" tabindex=\"3\" class=\"Repeat NotMatch\"/></td></tr></table>\\\r\n                </td>\\\r\n            </tr>\\\r\n            <tr>\\\r\n                <td>\\\r\n                    <table border=\"0\"><tr><td>{{i \"ProfilePlugin.login\"}}</td><td align=\"right\"><input type=\"text\" tabindex=\"4\" class=\"NickName LoginEmpty LoginFormat LoginExists\" id=\"RegNick\" name=\"RegNick\"/></td></tr></table>\\\r\n                </td>\\\r\n                <td>\\\r\n                    <table border=\"0\"><tr><td>{{i \"ProfilePlugin.capcha\"}}</td><td align=\"right\"><input type=\"text\" tabindex=\"5\" class=\"Capcha CapchaRequired WrongCapcha\"/></td><td align=\"right\">' +\r\n                    '<img src=\"' + mykosmosnimki + '/Account/Captcha?r=' + Math.round(Math.random() * Math.pow(10, 9)) + '\">' +\r\n                    '</td></tr></table>\\\r\n            </tr>\\\r\n            <tr><td colspan=\"2\" class=\"submit\">\\\r\n                <div class=\"ErrorSummary\"></div>\\\r\n                <div class=\"SubmitBlock\">\\\r\n                <input tabindex=\"6\" type=\"button\" value=\"{{i \"ProfilePlugin.register\"}}\"/>\\\r\n                <img src=\"img/progress.gif\"></div>\\\r\n            </td></tr>\\\r\n            <tr><td colspan=\"2\">\\\r\n            <div class=\"policy\">\\\r\n            Нажимая на кнопку, вы соглашаетесь с <a target=\"blank\" href=\"//my.kosmosnimki.ru/Docs/Политика конфиденциальности.pdf\">политикой конфиденциальности</a>\\\r\n            и <a target=\"blank\" href=\"//my.kosmosnimki.ru/Docs/Политика оператора в отношении обработки и защиты персональных данных.pdf\">политикой оператора</a> в отношении обработки и защиты персональных данных\\\r\n            </td></tr>\\\r\n            </table>\\\r\n        </form>\\\r\n        </td></tr></table>'\r\n        )()),\r\n            confirmScreen = $(Handlebars.compile('<div class=\"registrationConfirm\"><div></div><div><input type=\"button\" value=\"{{i \"ProfilePlugin.close\"}}\"/></div></div>')()),\r\n            errorSummaryHeight,\r\n        submit = registrationForm.find('input[type=\"button\"]').click(function () {\r\n            var errorSummary = registrationForm.find('.ErrorSummary'),\r\n            wait = submit.next('img').css('visibility', 'visible');\r\n            registrationForm.find('form').submit();\r\n\r\n            _mapHelper.createPermalink(function (id) {\r\n                sendCrossDomainPostRequest(mykosmosnimki + \"/Handler/RegistrationExt\", { WrapStyle: 'message',\r\n\t\t\t\t\tfirstName: registrationForm.find('.FirstName').val(),\r\n\t\t\t\t\tlastName: registrationForm.find('.LastName').val(),\r\n                    email: registrationForm.find('.Login').val(),\r\n                    login: registrationForm.find('.NickName').val(),\r\n                    password: registrationForm.find('.Password').val(),\r\n                    repeat: registrationForm.find('.Repeat').val(),\r\n                    captcha: registrationForm.find('.Capcha').val(),\r\n                    permalink: \"http://\" + window.location.host + window.location.pathname + \"?permalink=\" + id + (window.defaultMapID == window.globalMapName ? \"\" : (\"&\" + window.globalMapName))\r\n                },\r\n                function (response) {\r\n\r\n                    registrationForm.find('.Capcha').val(\"\");\r\n                    registrationForm.find('input[type=\"button\"]').focus();\r\n                    wait.css('visibility', 'hidden');\r\n\r\n                    if (response.Status.toLowerCase() == 'ok' && response.Result) {\r\n                        //afterRegistration();\r\n                        regFormDialog.style.height = errorSummaryHeight;\r\n                        registrationForm.fadeOut(\"slow\", function () {\r\n                            $(this).replaceWith(confirmScreen); //.fadeIn(\"slow\");\r\n                        });\r\n                        confirmScreen.children('div').first().text(response.Result.Message);\r\n                        confirmScreen.find('input').click(function () { removeDialog(regFormDialog); });\r\n                    }\r\n                    else {\r\n                        registrationForm.find('.error').removeClass('error');\r\n                        errorSummary.text('');\r\n                        registrationForm.find(':password,:text').filter(function () { return $(this).val() == \"\"; }).addClass('error');\r\n                        if (response.Result.length > 0 && response.Result[0].Key) {\r\n                            errorSummaryHeight = errorSummary.text(\r\n                            _gtxt('ProfilePlugin.Error' + response.Result[0].Key) + \" \" + response.Result[0].Value.Errors[0].ErrorMessage).height();\r\n                            registrationForm.find('.' + response.Result[0].Key).addClass('error');\r\n                        }\r\n                        else {\r\n                            errorSummaryHeight = errorSummary.text(_gtxt('ProfilePlugin.Error' + response.Result.Message)).height();\r\n                            registrationForm.find('.' + response.Result.Message).addClass('error');\r\n                        }\r\n                        errorSummary.slideDown();\r\n                        registrationForm.find('img').first().attr(\"src\", mykosmosnimki + '/Account/Captcha/sort?r=' + Math.round(Math.random() * Math.pow(10, 9)));\r\n                    }\r\n                })\r\n            });\r\n        });\r\n\r\n        registrationForm.find('form').submit(function (e) {\r\n            e.preventDefault();\r\n        });\r\n\r\n        var regFormDialog = window.showDialog(_gtxt('ProfilePlugin.registration'), registrationForm[0], 560, 272);\r\n        $(regFormDialog).dialog('option', 'resizable', false);\r\n        regFormDialog.style.overflow = 'hidden';\r\n        errorSummaryHeight = regFormDialog.style.height;\r\n        regFormDialog.style.height = '';\r\n\r\n        var clearError = function () {\r\n            registrationForm.find('.error').removeClass('error');\r\n            registrationForm.find('.ErrorSummary').text('').slideUp();\r\n        };\r\n\r\n        registrationForm.find('input[type=\"text\"], input[type=\"password\"]')\r\n        .keydown(function (e) {\r\n            if (e.which == 13)\r\n                submit.click();\r\n        })\r\n        .focusin(clearError);\r\n\r\n        return regFormDialog;\r\n    };\r\n\r\n    // var SubmitBlock = function (form, onsuccess, onerror) {\r\n    //     this.submit = function () { }\r\n    // };\r\n\r\n    var checkExist;\r\n\r\n    window.gmxCore.addModule('ProfilePlugin', {\r\n        pluginName: 'ProfilePlugin',\r\n        showProfile: showProfile,\r\n        showRegistrationForm: showRegistrationForm,\r\n        afterViewer: function () {\r\n            checkExist = setInterval(function () {\r\n                if (nsGmx.widgets.authWidget && nsGmx.widgets.authWidget.getUserInfo() != null) {\r\n                    if (nsGmx.widgets.authWidget.getUserInfo().Login != null) {\r\n                        var a = $('a:contains(\"' + nsGmx.Translations.getText('auth.myAccount') + '\")');\r\n                        a.attr({ 'class': 'dropdownMenuWidget-dropdownItemAnchor' });\r\n                        a.siblings('div').remove();\r\n                        a.attr('href', 'javascript:void(0)');\r\n                        a.removeAttr('target');\r\n                        a.click(function (event) {\r\n                            showProfile();\r\n                            event.stopPropagation();\r\n                        });\r\n                    }\r\n                    else {\r\n                        var showLoginDialog = nsGmx.widgets.authWidget._authManager.login,\r\n                        regForm;\r\n                        nsGmx.widgets.authWidget._authManager.login = function () {\r\n                            if (regForm && $(regForm).is(':visible')) {\r\n                                removeDialog(regForm);\r\n                                regForm = false;\r\n                            }\r\n                            showLoginDialog();\r\n                            var regLink = $(':ui-dialog .registration');\r\n                            regLink.off(\"click\").click(function () {\r\n                                regLink.parents(':ui-dialog').dialog(\"close\");\r\n                                regForm = showRegistrationForm(function () {\r\n                                    window.location.reload();\r\n                                });\r\n                            });\r\n                        };\r\n                    }\r\n                    clearInterval(checkExist);\r\n                }\r\n            }, 100);\r\n        }\r\n    },\r\n    {\r\n        // css: 'ProfilePlugin.css',\r\n        init: function () {\r\n            initTranslations();\r\n        }\r\n    });\r\n})(jQuery)\r\n\r\n","﻿import nsGmx from '../nsGmx.js';\r\nimport {makeLinkButton} from '../utilities.js';\r\n\r\n_translationsHash.addtext('rus', {LayerRCControl: {\r\n    minZoom         : 'Мин. зум',\r\n    titleTemplate   : 'Шаблон имени',\r\n    pathTemplate    : 'Шаблон тайлов',\r\n    advancedLink    : 'Дополнительно',\r\n    layerTagTitle   : 'Параметр слоя',\r\n    attributeTitle  : 'Атрибут объекта'\r\n}});\r\n\r\n_translationsHash.addtext('eng', {LayerRCControl: {\r\n    minZoom         : 'Min zoom',\r\n    titleTemplate   : 'Title template',\r\n    pathTemplate    : 'Path template',\r\n    advancedLink    : 'Advanced',\r\n    layerTagTitle   : 'Layer parameter',\r\n    attributeTitle  : 'Object Attribute'\r\n}});\r\n\r\nnsGmx.LayerRCProperties = Backbone.Model.extend({\r\n    defaults: {\r\n        IsRasterCatalog: false,\r\n        RCMinZoomForRasters: 0,\r\n        RCMaskForRasterTitle: '',\r\n        RCMaskForRasterPath: '',\r\n        ColumnTagLinks: {}\r\n    },\r\n    isAnyLinks: function() {\r\n        return window._.size(this.attributes.ColumnTagLinks) > 0;\r\n    }\r\n});\r\n\r\n/**\r\nКонтрол для задания параметров каталогов растров\r\n@memberOf nsGmx\r\n@class\r\n*/\r\nnsGmx.LayerRasterCatalogWidget = function(container, rcProperties)\r\n{\r\n    var advancedMode = !!(\r\n            rcProperties.get('RCMaskForRasterPath') ||\r\n            rcProperties.get('RCMaskForRasterTitle') ||\r\n            rcProperties.isAnyLinks()\r\n        );\r\n\r\n    var updateVisibility = function()\r\n    {\r\n        // var isRasterCatalog = rcProperties.get('IsRasterCatalog');\r\n        $('.RCCreate-advanced', container).toggle(advancedMode);\r\n        $('.RCCreate-advanced-link', container).toggle(!advancedMode);\r\n        $('.RCCreate-tagContainer', container).toggle(advancedMode);\r\n    };\r\n\r\n    rcProperties.on('change:IsRasterCatalog', updateVisibility);\r\n\r\n    var RCCheckbox = $('<input/>', {type: 'checkbox', 'class': 'RCCreate-checkbox'}).change(function() {\r\n        rcProperties.set('IsRasterCatalog', RCCheckbox[0].checked);\r\n    });\r\n\r\n    var advancedParamsLink = $(makeLinkButton(_gtxt('LayerRCControl.advancedLink'))).addClass('RCCreate-advanced-link').click(function()\r\n    {\r\n        advancedMode = !advancedMode;\r\n        updateVisibility();\r\n    });\r\n\r\n    RCCheckbox[0].checked = rcProperties.get('IsRasterCatalog');\r\n\r\n    var minZoomInput = $('<input/>', {'class': 'inputStyle RCCreate-zoom-input'}).val(rcProperties.get('RCMinZoomForRasters') || '').bind('keyup change', function() {\r\n        rcProperties.set('RCMinZoomForRasters', parseInt(this.value));\r\n    });\r\n\r\n    var titleInput = $('<input/>', {'class': 'inputStyle'}).val(rcProperties.get('RCMaskForRasterTitle') || '').bind('keyup change', function() {\r\n        rcProperties.set('RCMaskForRasterTitle', this.value);\r\n    });\r\n\r\n    var pathInput = $('<input/>', {'class': 'inputStyle'}).val(rcProperties.get('RCMaskForRasterPath') || '').bind('keyup change', function() {\r\n        rcProperties.set('RCMaskForRasterPath', this.value);\r\n    });\r\n\r\n    // var RCParamsTable =\r\n        $('<table/>', {'class': 'RCCreate-params'})\r\n            .append($('<tr/>')\r\n                .append($('<td/>').text(_gtxt('LayerRCControl.minZoom')).css('padding-right', '6px'))\r\n                .append($('<td/>').append(minZoomInput)))\r\n            .append($('<tr/>', {'class': 'RCCreate-advanced'})\r\n                .append($('<td/>').text(_gtxt('LayerRCControl.titleTemplate')))\r\n                .append($('<td/>').append(titleInput)))\r\n            .append($('<tr/>', {'class': 'RCCreate-advanced'})\r\n                .append($('<td/>').text(_gtxt('LayerRCControl.pathTemplate')))\r\n                .append($('<td/>').append(pathInput)))\r\n            .appendTo(container);\r\n\r\n    nsGmx.TagMetaInfo.loadFromServer(function(realTagInfo)\r\n    {\r\n        var realTagsInfo = realTagInfo.getTagArrayExt();\r\n        var fakeTagsInfo = {};\r\n        for (let iT = 0; iT < realTagsInfo.length; iT++)\r\n        {\r\n            var info = realTagsInfo[iT];\r\n            fakeTagsInfo[info.name] = {Type: 'String', Description: info.descr};\r\n        }\r\n        var fakeTagManager = new nsGmx.TagMetaInfo(fakeTagsInfo);\r\n\r\n        var initTags = {};\r\n\r\n        var columnTagLinks = rcProperties.get('ColumnTagLinks');\r\n\r\n        for (let iP in columnTagLinks)\r\n            initTags[columnTagLinks[iP]] = {Value: iP};\r\n\r\n        var layerTags = new nsGmx.LayerTagsWithInfo(fakeTagManager, initTags);\r\n\r\n        var tagContainer = $('<div/>', {'class': 'RCCreate-tagContainer RCCreate-advanced'}).addClass().appendTo(container);\r\n        new nsGmx.LayerTagSearchControl(layerTags, tagContainer, {\r\n            inputWidth: 100,\r\n            tagHeader: _gtxt('LayerRCControl.layerTagTitle'),\r\n            valueHeader: _gtxt('LayerRCControl.attributeTitle')\r\n        });\r\n\r\n        $(layerTags).change(function() {\r\n            var columnTagLinks = {};\r\n            layerTags.eachValid(function(id, tag, value) { columnTagLinks[value] = tag;});\r\n            rcProperties.set('ColumnTagLinks', columnTagLinks);\r\n        });\r\n\r\n        advancedParamsLink.appendTo(container);\r\n\r\n        updateVisibility();\r\n    });\r\n};","import nsGmx from './nsGmx.js';\r\n\r\n/** Параметры мультивременного слоя, связанные со временем\r\n  @class\r\n  @extends Backbone.Model\r\n  @prop {number} [minPeriod=1] Минимальный период создания тайлов\r\n  @prop {number} [maxPeriod=1] Максимальный период создания тайлов\r\n  @prop {number} [columnName=null]  Название мультивременной колонки\r\n  @prop {number} [isTemporal=false] Является ли слой мультивременным\r\n*/\r\nnsGmx.TemporalLayerParams = Backbone.Model.extend(\r\n/** @lends nsGmx.TemporalLayerParams.prototype */\r\n{\r\n    defaults: {\r\n        isTemporal: false,\r\n        maxShowPeriod: 0,\r\n        minPeriod: 1,\r\n        maxPeriod: 256,\r\n        columnName: null\r\n    },\r\n\r\n    /** Возвращает строчку с перечислением временнЫх периодов (для передачи серверу) */\r\n    getPeriodString: function() {\r\n        var periods = [1, 16, 256],\r\n            minPeriod = Number(this.attributes.minPeriod),\r\n            maxPeriod = Number(this.attributes.maxPeriod);\r\n\r\n            minPeriod = (minPeriod > 1 && minPeriod < 16) ? 16 : minPeriod;\r\n            minPeriod = (minPeriod > 16 && minPeriod < 256) ? 256 : minPeriod;\r\n            maxPeriod = (maxPeriod > 1 && maxPeriod < 16) ? 16 : maxPeriod;\r\n            maxPeriod = (maxPeriod > 16 && maxPeriod < 256) ? 256 : maxPeriod;\r\n\r\n        return periods.splice(periods.indexOf(minPeriod), periods.indexOf(maxPeriod) + 1).join(',');\r\n    }\r\n}, {PERIOD_STEP: 4});\r\n","import nsGmx from './nsGmx.js';\r\n\r\n/** Связанные с квиклуками параметры векторных слоёв. Умеет сериализовать/десериализовать себя в строку для хранения на сервере.\r\n * @class\r\n * @memberOf nsGmx\r\n * @extends Backbone.Model\r\n * @property {String} template Шаблон URL квиклука\r\n * @property {Number} minZoom Минимальный зум показа квиклуков\r\n * @property {Number} X1-X4,Y1-Y4 Названия полей слоя, в которых хранятся координаты привязки 4 углов изображения. Если не указаны, будут использованы значения по умолчанию (поля \"X1\"-\"X4\", \"Y1\"-\"Y4\" или их аналоги в нижнем регистре)\r\n */\r\nnsGmx.QuicklookParams = Backbone.Model.extend({\r\n    /** Загружает параметры из строки с сервера.\r\n     * @param {String} quicklookString Строка с параметрами с сервера\r\n     */\r\n    fromServerString: function(quicklookString) {\r\n        if (quicklookString) {\r\n            //раньше это была просто строка с шаблоном квиклука, а теперь стало JSON'ом\r\n            if (quicklookString[0] === '{') {\r\n                var p = JSON.parse(quicklookString);\r\n                this.set({\r\n                    template: p.template,\r\n                    minZoom: p.minZoom || 8,\r\n                    X1: p.X1, Y1: p.Y1,\r\n                    X2: p.X2, Y2: p.Y2,\r\n                    X3: p.X3, Y3: p.Y3,\r\n                    X4: p.X4, Y4: p.Y4\r\n                });\r\n            } else {\r\n                this.set({\r\n                    template: quicklookString,\r\n                    minZoom: 8\r\n                });\r\n            }\r\n        } else {\r\n            this.set({\r\n                minZoom: 8\r\n            });\r\n        }\r\n    },\r\n    /** Сохраняет все параметры в строку, которую можно передать серверу.\r\n     * @return {String}\r\n     */\r\n    toServerString: function() {\r\n        //$.extend чтобы удалить undefined поля\r\n        return this.attributes.template ? JSON.stringify($.extend({}, this.attributes)) : '';\r\n    }\r\n});\r\n","﻿import nsGmx from './nsGmx.js';\r\nimport './LayerEditor/LayerRasterCatalogWidget.js';\r\nimport './TemporalLayerParams.js';\r\nimport './QuicklookParams.js';\r\nimport {sendCrossDomainJSONRequest} from './utilities.js';\r\nimport './AsyncTaskManager.js';\r\n\r\n/** Объект, описывающий один атрибут слоя. Формат для передачи на сервер\r\n * @typedef {Object} nsGmx.LayerProperties.Column\r\n * @property {String} Name Имя атрибута\r\n * @property {String} OldName Исходное имя атрибута. Используется для переименования атрибутов. Для новых атрибутов это поле должно отсутствовать.\r\n * @property {String}  ColumnSimpleType Тип атрибута\r\n * @property {Boolean} IsPrimary\r\n * @property {Boolean} IsIdentity\r\n * @property {Boolean} IsComputed\r\n*/\r\n\r\nvar LatLngColumnsModel = Backbone.Model.extend({\r\n    defaults: {\r\n        XCol: null,\r\n        YCol: null\r\n    }\r\n});\r\n\r\n/** Расширенный набор свойства слоя. Используется для редактирования свойств. Умеет сохранять себя на сервере\r\n * @class\r\n * @memberOf nsGmx\r\n * @extends Backbone.Model\r\n * @property {String} Type Тип слоя. Vector/Raster/MultiLayer/Virtual\r\n * @property {Number} LayerID Серверный ID слоя\r\n * @property {String} Name Уникальный неитерируемый ID слоя\r\n * @property {String} Title Заголовок слоя\r\n * @property {String} Copyright Копирайт слоя\r\n * @property {String} Description Описание слоя\r\n * @property {Object} MetaProperties Метаданные слоя\r\n * @property {Object} ShapePath Имеет атрибут Path. Для векторных слоёв из файла - источник слоя. Для растровых - файл с границей растра\r\n * @property {Object} Geometry Граница растрового слоя\r\n\r\n * @property {String} Legend Легенда слоя. Только для растровых слоёв\r\n\r\n * @property {String} NameObject Шаблон названий объектов. Только для векторных слоёв\r\n * @property {String} GeometryType Тип геометрии слоя. Только для векторных слоёв (point/linestring/polygon)\r\n * @property {nsGmx.QuicklookParams} Quicklook Параметры квиклуков. Только для векторных слоёв\r\n * @property {Object} TilePath Имеет атрибут Path. Путь к файлу с тайлами. Только для векторных слоёв\r\n * @property {String} EncodeSource Кодировка источника данных слоя. Только для векторных слоёв\r\n * @property {nsGmx.LayerProperties.Column[]} Columns Описание типов и названий атрибутов слоя. Только для векторных слоёв\r\n * @property {String} TableName Название таблицы, если источник был таблицей. Только для векторных слоёв\r\n * @property {String} TableCS Система координат выбранной таблицы (\"EPSG:4326\"/\"EPSG:3395\"). Только для векторных слоёв\r\n * @property {String} SourceType Тип источника данных для слоя (file/table/manual/sql)\r\n * @property {String[]} Attributes Список имён атрибутов векторного слоя (не сохраняется)\r\n * @property {String[]} AttrTypes Список типов атрибутов векторного слоя (не сохраняется)\r\n * @property {nsGmx.LayerRCProperties} RC Параметры каталога растров. Только для векторных слоёв\r\n * @property {nsGmx.TemporalLayerParams} Temporal Параметры мультивременного слоя. Только для векторных слоёв\r\n * @property {LatLngColumnsModel} GeometryColumnsLatLng Описание выбранных в таблице колонок с геометрией\r\n * @property {String} ZIndexField Название поля для сортировки объектов внутри векторного слоя\r\n*/\r\nvar LayerProperties = Backbone.Model.extend(\r\n    /** @lends nsGmx.LayerProperties.prototype */\r\n{\r\n    initialize: function(attrs) {\r\n        this.attributes = _.clone(attrs || {});\r\n    },\r\n\r\n    initFromViewer: function(type, divProperties, layerProperties) {\r\n\r\n        this.set({\r\n            Type:           type || (divProperties && divProperties.type) || (layerProperties && layerProperties.type),\r\n            Title:          divProperties ? (divProperties.title || '') : (layerProperties.Title || ''),\r\n            Copyright:      divProperties ? (divProperties.Copyright || '') : (layerProperties.Copyright || ''),\r\n            Legend:         divProperties ? (divProperties.Legend || '') : (layerProperties.Legend || ''),\r\n            Description:    divProperties ? (divProperties.description || '') : (layerProperties.Description || ''),\r\n            NameObject:     divProperties ? (divProperties.NameObject || '') : (layerProperties.NameObject || ''),\r\n            GeometryType:   divProperties ? divProperties.GeometryType : layerProperties.GeometryType,\r\n            LayerID:        divProperties ? divProperties.LayerID : layerProperties.LayerID,\r\n            ZIndexField:    divProperties ? divProperties.ZIndexField : layerProperties.ZIndexField,\r\n            ContentID:      divProperties ? divProperties.ContentID : layerProperties.ContentID,\r\n            ShapePath:      layerProperties.ShapePath || {},\r\n            TilePath:       layerProperties.TilePath || {},\r\n            Name:           layerProperties.name,\r\n            EncodeSource:   layerProperties.EncodeSource,\r\n            Columns:        layerProperties.Columns,\r\n            TableName:      layerProperties.TableName,\r\n            TableCS:        layerProperties.TableCS,\r\n            SourceType:     layerProperties.SourceType || 'file',\r\n            Geometry:       layerProperties.Geometry,\r\n            Attributes:     divProperties ? divProperties.attributes : [],\r\n            AttrTypes:      divProperties ? divProperties.attrTypes : []\r\n        })\r\n\r\n        var metaProperties = layerProperties.MetaProperties;\r\n        var convertedTagValues = {};\r\n        for (var mp in metaProperties)\r\n        {\r\n            var tagtype = metaProperties[mp].Type;\r\n            convertedTagValues[mp] = {Type: tagtype, Value: nsGmx.Utils.convertFromServer(tagtype, metaProperties[mp].Value)};\r\n        }\r\n        this.set('MetaProperties', new nsGmx.LayerTags(convertedTagValues));\r\n\r\n        this.set('RC', new nsGmx.LayerRCProperties({\r\n            IsRasterCatalog:      layerProperties.IsRasterCatalog,\r\n            RCMinZoomForRasters:  layerProperties.RCMinZoomForRasters,\r\n            RCMaskForRasterTitle: layerProperties.RCMaskForRasterTitle,\r\n            RCMaskForRasterPath:  layerProperties.RCMaskForRasterPath,\r\n            ColumnTagLinks:       layerProperties.ColumnTagLinks\r\n        }));\r\n\r\n        divProperties = divProperties || {};\r\n\r\n        var tempPeriods = divProperties.TemporalPeriods;\r\n        this.set('Temporal', new nsGmx.TemporalLayerParams({\r\n            isTemporal: !!divProperties.Temporal,\r\n            minPeriod: tempPeriods && tempPeriods[0],\r\n            maxPeriod: tempPeriods && tempPeriods[tempPeriods.length-1],\r\n            maxShownPeriod: divProperties.maxShownPeriod || 0,\r\n            columnName: divProperties.TemporalColumnName\r\n        }));\r\n\r\n        this.set('GeometryColumnsLatLng', new LatLngColumnsModel({\r\n            XCol: layerProperties.GeometryXCol,\r\n            YCol: layerProperties.GeometryYCol\r\n        }));\r\n\r\n        if (layerProperties.Name) {\r\n            this.set(\"Name\", layerProperties.Name);\r\n        }\r\n\r\n        var quicklookString = divProperties.Quicklook || layerProperties.Quicklook,\r\n            quicklookParams = new nsGmx.QuicklookParams();\r\n\r\n        quicklookParams.fromServerString(quicklookString);\r\n        this.set('Quicklook', quicklookParams);\r\n    },\r\n\r\n    /** Инициализирует класс, используя информацию о слое с сервера.\r\n     * @param {String} layerName ID слоя, информацию о котором нужно получить\r\n     * @return {jQuery.Deferred} Deferred, который будет заполнен после инициализации класса\r\n     */\r\n    initFromServer: function(layerName) {\r\n        var def = $.Deferred(),\r\n            _this = this;\r\n\r\n        sendCrossDomainJSONRequest(window.serverBase + \"Layer/GetLayerInfo.ashx?NeedAttrValues=false&LayerName=\" + encodeURIComponent(layerName), function(response) {\r\n            if (!window.parseResponse(response)) {\r\n                def.reject(response);\r\n                return;\r\n            }\r\n\r\n            _this.initFromViewer(null, null, response.Result);\r\n\r\n            def.resolve();\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /** Сохраняет изменения в слое или создаёт новый слой на сервере\r\n     * @param {Boolean} geometryChanged Нужно ли передавать на сервер геометрию растрового слоя\r\n     * @param {Function} [callback] Будет вызван после получения ответа от сервера\r\n     * @return {jQuery.Deferred} Deferred, который будет заполнен после сохранения всей информации на сервере\r\n     */\r\n    save: function(geometryChanged, callback, params) {\r\n        var attrs = this.attributes,\r\n            name = attrs.Name,\r\n            stype = attrs.SourceType,\r\n            def;\r\n\r\n        var reqParams = {\r\n            WrapStyle: \"window\",\r\n            Title: attrs.Title,\r\n            Description: attrs.Description,\r\n            Copyright: attrs.Copyright\r\n        };\r\n\r\n        if (attrs.MetaProperties) {\r\n            var metaProperties = {};\r\n            attrs.MetaProperties.eachValid(function(id, tag, value, type)\r\n            {\r\n                //для неизвестных тегов присваиваем тип String\r\n                type = type || 'String';\r\n                value = nsGmx.Utils.convertToServer(type, value);\r\n                if (value !== null) {\r\n                    metaProperties[tag] = {Value: value, Type: type};\r\n                }\r\n            }, true)\r\n\r\n            reqParams.MetaProperties = JSON.stringify(metaProperties);\r\n        }\r\n\r\n        if (attrs.Type === 'Vector') {\r\n            if (attrs.EncodeSource) reqParams.EncodeSource = attrs.EncodeSource;\r\n            reqParams.NameObject = attrs.NameObject || '';\r\n            reqParams.srs = nsGmx.leafletMap.options.srs || '';\r\n            if (stype === 'table') reqParams.TableCS = attrs.TableCS;\r\n\r\n            var rcProps = attrs.RC;\r\n            reqParams.IsRasterCatalog = !!(rcProps && rcProps.get('IsRasterCatalog'));\r\n            if (reqParams.IsRasterCatalog)\r\n            {\r\n                reqParams.RCMinZoomForRasters = rcProps.get('RCMinZoomForRasters');\r\n                reqParams.RCMaskForRasterPath = rcProps.get('RCMaskForRasterPath');\r\n                reqParams.RCMaskForRasterTitle = rcProps.get('RCMaskForRasterTitle');\r\n                reqParams.ColumnTagLinks = JSON.stringify(rcProps.get('ColumnTagLinks'));\r\n            }\r\n\r\n            var tempProperties = attrs.Temporal;\r\n\r\n            reqParams.TemporalLayer = !!(tempProperties && tempProperties.get('isTemporal') && tempProperties.get('columnName'));\r\n\r\n            if ( reqParams.TemporalLayer ) {\r\n                reqParams.TemporalColumnName = tempProperties.get('columnName');\r\n                reqParams.TemporalPeriods = tempProperties.getPeriodString();\r\n                reqParams.maxShownPeriod = tempProperties.get('maxShownPeriod');\r\n            }\r\n\r\n            /* отсылать на сервер колонки нужно только если это:\r\n             * - уже созданный слой или тип слоя \"Вручную\",\r\n             * - копия слоя\r\n            */\r\n            if (attrs.Columns && (name || stype === 'manual') || (params && params.copy)) {\r\n                reqParams.Columns = JSON.stringify(attrs.Columns);\r\n            }\r\n\r\n            if (attrs.LayerID) reqParams.VectorLayerID = attrs.LayerID;\r\n\r\n            if (attrs.Quicklook) {\r\n                reqParams.Quicklook = attrs.Quicklook.toServerString();\r\n                /*JSON.stringify({\r\n                    minZoom: attrs.MinZoomQuicklooks,\r\n                    template: attrs.Quicklook\r\n                });*/\r\n            } else {\r\n                attrs.Quicklook = '';\r\n            }\r\n\r\n            reqParams.ZIndexField = attrs.ZIndexField || '';\r\n\r\n            if (!name && stype === 'manual' && !(params && params.copy)) {\r\n                reqParams.UserBorder = attrs.UserBorder ? JSON.stringify(attrs.UserBorder) : null;\r\n                reqParams.geometrytype = attrs.GeometryType;\r\n\r\n                def = nsGmx.asyncTaskManager.sendGmxPostRequest(window.serverBase + \"VectorLayer/CreateVectorLayer.ashx\", reqParams);\r\n            } else if (!name && (params && params.copy)) {\r\n                var copyParams = {},\r\n                    columnsList = [{Value:\"[geomixergeojson]\",Alias:\"gmx_geometry\"}],\r\n                    sqlString = params.buffer ?\r\n                        'select Buffer([gmx_geometry], ' + (params.bufferSize || 0) + ') as gmx_geometry' :\r\n                        'select [geomixergeojson] as gmx_geometry';\r\n\r\n                for (var i = 0; i < attrs.Columns.length; i++) {\r\n                    var col = attrs.Columns[i];\r\n\r\n\t\t\t\t\tif (col.Name !== 'gmx_geometry') {\r\n\t\t\t\t\t\tcolumnsList.push({\r\n\t\t\t\t\t\t\tValue: col.Name,\r\n\t\t\t\t\t\t\tAlias: col.Name\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tvar exp = col.expression || '\"' + col.Name + '\"';\r\n\r\n\t\t\t\t\t\tsqlString += ', ' + exp + ' as \"' + col.Name + '\"';\r\n\t\t\t\t\t}\r\n                }\r\n\r\n                sqlString += ' from [' + params.sourceLayerName + ']';\r\n\r\n                if (params.query) {\r\n                    sqlString += (' WHERE ' + params.query);\r\n                }\r\n\r\n                copyParams.WrapStyle = \"message\";\r\n                copyParams.Title = attrs.Title;\r\n                copyParams.SourceType = attrs.SourceType;\r\n                copyParams.Sql = sqlString;\r\n                copyParams.srs = nsGmx.leafletMap.options.srs || '';\r\n\r\n                 def = nsGmx.asyncTaskManager.sendGmxPostRequest(window.serverBase + \"VectorLayer/Insert.ashx\", copyParams);\r\n            } else {\r\n                //Если нет колонки с геометрией, то нужно передавать выбранные пользователем колонки\r\n                var parsedColumns = nsGmx.LayerProperties.parseColumns(attrs.Columns);\r\n                var geomColumns = attrs.GeometryColumnsLatLng;\r\n                if (parsedColumns.geomCount === 0 && geomColumns && geomColumns.get('XCol') && geomColumns.get('YCol')) {\r\n                    reqParams.ColX = geomColumns.get('XCol');\r\n                    reqParams.ColY = geomColumns.get('YCol');\r\n                }\r\n\r\n                if (stype !== 'manual') {\r\n                    reqParams.GeometryDataSource = stype === 'file' ? attrs.ShapePath.Path : attrs.TableName;\r\n                }\r\n\r\n                def = nsGmx.asyncTaskManager.sendGmxPostRequest(window.serverBase + \"VectorLayer/\" + (name ? \"Update.ashx\" : \"Insert.ashx\"), reqParams);\r\n            }\r\n        } else if (attrs.Type === 'Raster') {\r\n            var curBorder = _mapHelper.drawingBorders.get(name);\r\n\r\n            reqParams.Legend = attrs.Legend;\r\n            reqParams.srs = nsGmx.leafletMap.options.srs || '';\r\n            if (attrs.TilePath.Path) reqParams.TilePath = attrs.TilePath.Path;\r\n            reqParams.GeometryChanged = geometryChanged;\r\n\r\n            if (geometryChanged) {\r\n                if (typeof curBorder === 'undefined') {\r\n                    if (attrs.ShapePath.Path) {\r\n                        reqParams.BorderFile = attrs.ShapePath.Path;\r\n                    } else if (typeof attrs.Geometry !== 'undefined') {\r\n                        //может быть как null (удалили), так и undefined (не поменялась)\r\n                        reqParams.BorderGeometry = JSON.stringify(attrs.Geometry);\r\n                    }\r\n                } else {\r\n                    reqParams.BorderGeometry = JSON.stringify(L.gmxUtil.geoJSONtoGeometry(curBorder.toGeoJSON(), true));\r\n                }\r\n            }\r\n\r\n            if (attrs.LayerID) reqParams.RasterLayerID = attrs.LayerID;\r\n\r\n            def = nsGmx.asyncTaskManager.sendGmxPostRequest(window.serverBase + \"RasterLayer/\" + (name ? \"Update.ashx\" : \"Insert.ashx\"), reqParams);\r\n        } else if (attrs.Type === 'MultiLayer') {\r\n            var multiLayerInfo = {\r\n                LayersChanged: false, //изменение состава слоёв пока не поддерживается\r\n                Properties: {\r\n                    Title: attrs.Title,\r\n                    Description: attrs.Description\r\n                }\r\n            };\r\n\r\n            if ('MetaProperties' in reqParams) {\r\n                multiLayerInfo.Properties.MetaProperties = JSON.parse(reqParams.MetaProperties);\r\n            }\r\n\r\n            if (attrs.LayerID) {\r\n                multiLayerInfo.Properties.MultiLayerID = attrs.LayerID;\r\n            }\r\n\r\n            var multiReqParams = {\r\n                WrapStyle: \"window\",\r\n                MultiLayerInfo: JSON.stringify(multiLayerInfo)\r\n            }\r\n\r\n            def = nsGmx.asyncTaskManager.sendGmxPostRequest(window.serverBase + \"MultiLayer/\" + (name ? \"Update.ashx\" : \"Insert.ashx\"), multiReqParams);\r\n        } else if (attrs.Type === 'Virtual') {\r\n            if (name) {\r\n                reqParams.VectorLayerID = name;\r\n            } else {\r\n                reqParams.SourceType = 'Virtual';\r\n            }\r\n\r\n            if (attrs.ContentID) {\r\n                reqParams.ContentID = attrs.ContentID;\r\n            }\r\n\r\n            reqParams.Legend = attrs.Legend || '';\r\n\r\n            def = nsGmx.asyncTaskManager.sendGmxPostRequest(window.serverBase + \"VectorLayer/\" + (name ? \"Update.ashx\" : \"Insert.ashx\"), reqParams);\r\n        }\r\n\r\n        callback && def.done(callback);\r\n        return def.promise();\r\n    }\r\n})\r\n\r\nLayerProperties.parseColumns = function(columns) {\r\n    var geomCount = 0;     //кол-во колонок с типом Геометрия\r\n    var coordColumns = []; //колонки, которые могут быть использованы для выбора координат\r\n    var dateColumns = [];  //колонки, которые могут быть использованы для выбора временнОго параметра\r\n\r\n    columns = columns || [];\r\n\r\n    for (var f = 0; f < columns.length; f++)\r\n    {\r\n        var type = columns[f].ColumnSimpleType.toLowerCase();\r\n        if ( type === 'geometry')\r\n            geomCount++;\r\n\r\n        if ((type === 'string' || type === 'integer' || type === 'float') && !columns[f].IsIdentity && !columns[f].IsPrimary)\r\n            coordColumns.push(columns[f].Name);\r\n\r\n        if (type === 'date' || type === 'datetime')\r\n            dateColumns.push(columns[f].Name);\r\n    }\r\n\r\n    return { geomCount: geomCount, coordColumns: coordColumns, dateColumns: dateColumns };\r\n}\r\n\r\nnsGmx.LayerProperties = LayerProperties;\r\nnsGmx.LatLngColumnsModel = LatLngColumnsModel;\r\n\r\n// window.gmxCore.addModule('LayerProperties', {\r\n//     LayerProperties: LayerProperties,\r\n//     LatLngColumnsModel: LatLngColumnsModel\r\n// })","﻿import nsGmx from './nsGmx.js';\r\n\r\n//event: change\r\nnsGmx.ShpEncodingWidget = function()\r\n{\r\n    var _encodings = {\r\n        'windows-1251': 'windows-1251',\r\n        'utf-8': 'utf-8',\r\n        'koi8-r': 'koi8-r',\r\n        'utf-7': 'utf-7',\r\n        'iso-8859-5': 'iso-8859-5',\r\n        'koi8-u': 'koi8-u',\r\n        'cp866': 'cp866'\r\n        \r\n    };\r\n    var _DEFAULT_ENCODING = 'windows-1251';\r\n    var _curEncoding = _DEFAULT_ENCODING;\r\n    var _this = this;\r\n    \r\n    this.drawWidget = function(container, initialEncoding)\r\n    {\r\n        initialEncoding = initialEncoding || _DEFAULT_ENCODING;\r\n        var select = $(\"<select></select>\").addClass('selectStyle VectorLayerEncodingInput');\r\n        select.change(function()\r\n        {\r\n            _curEncoding = $('option:selected', select).val();\r\n            $(_this).change();\r\n        });\r\n        \r\n        var isStandard = false;\r\n        for (var enc in _encodings)\r\n        {\r\n            var opt = $('<option></option>').val(enc).text(enc);\r\n            \r\n            if (_encodings[enc] === initialEncoding)\r\n            {\r\n                opt.attr('selected', 'selected');\r\n                _curEncoding = enc;\r\n                isStandard = true;\r\n            }\r\n                \r\n            select.append(opt);\r\n        }\r\n        \r\n        var anotherCheckbox = $(\"<input></input>\", {'class': 'box', type: 'checkbox', id: 'otherEncoding'});\r\n        var anotherInput = $(\"<input></input>\", {'class': 'VectorLayerEncodingInput'});\r\n        \r\n        if (!isStandard)\r\n        {\r\n            anotherCheckbox[0].checked = 'checked';\r\n            anotherInput.val(initialEncoding);\r\n            select.attr('disabled', 'disabled');\r\n        }\r\n        else\r\n        {\r\n            anotherInput.attr('disabled', 'disabled');\r\n        }\r\n        \r\n        anotherInput.bind('keyup', function()\r\n        {\r\n            _curEncoding = this.value;\r\n            $(_this).change();\r\n        });\r\n        \r\n        anotherCheckbox.click(function()\r\n        {\r\n            if (this.checked)\r\n            {\r\n                select.attr('disabled', 'disabled');\r\n                anotherInput.removeAttr('disabled');\r\n                anotherInput.focus();\r\n                _curEncoding = anotherInput.val();\r\n            }\r\n            else\r\n            {\r\n                select.removeAttr('disabled');\r\n                anotherInput.attr('disabled', 'disabled');\r\n                _curEncoding = $('option:selected', select).val();\r\n            }\r\n            $(_this).change();\r\n        });\r\n        \r\n        \r\n        var tr1 = $(\"<tr></tr>\")\r\n            .append($(\"<td></td>\").text(_gtxt(\"Кодировка\")))\r\n            .append($(\"<td></td>\").append(select));\r\n            \r\n        var tr2 = $(\"<tr></tr>\")\r\n            .append($(\"<td></td>\").append(anotherCheckbox).append($(\"<label></label>\", {'for': 'otherEncoding'}).text(_gtxt(\"Другая\"))))\r\n            .append($(\"<td></td>\").append(anotherInput));\r\n        \r\n        $(container)\r\n            .append($(\"<table></table>\", {'class': 'VectorLayerEncoding'})\r\n                .append(tr1).append(tr2));\r\n    }\r\n    \r\n    this.getServerEncoding = function()\r\n    {\r\n        return _curEncoding;\r\n    }\r\n};","import nsGmx from '../nsGmx.js';\r\n\r\n(function() {\r\n\r\nHandlebars.registerPartial('TemporalLayerWidgetOptions',\r\n    '{{#periods}}<option name=\"{{.}}\">{{.}}</option>{{/periods}}'\r\n);\r\n\r\n_translationsHash.addtext('rus', {\r\n    'Макс. период на экране': 'На экране не более',\r\n    'Тайлы с': 'Тайлы с',\r\n    'Тайлы по дням до': 'Тайлы по дням до',\r\n    'дней': 'дней'\r\n});\r\n\r\n_translationsHash.addtext('eng', {\r\n    'Макс. период на экране': 'Max period to show',\r\n    'Тайлы с': 'Tiles from',\r\n    'Тайлы по дням до': 'Max tiling period',\r\n    'дней': 'days'\r\n});\r\n\r\n/** Создаёт виджет для задания мультивременных параметров слоя\r\n* @class\r\n* @param {HTMLNode} parentDiv контейнер для размещения виджета\r\n* @param {nsGmx.TemporalLayerParams} paramsModel начальные параметры\r\n* @param {String[]} columns массив имён колонок, из которых можно выбрать врменнУю\r\n*/\r\nnsGmx.TemporalLayerParamsWidget = function(parentDiv, paramsModel, columns)\r\n{\r\n    var PERIODS = [1, 16, 256];\r\n    // var optionsHtml = '{{#periods}}<option name=\"{{.}}\">{{.}}</option>{{/periods}}';\r\n\r\n    var template = Handlebars.compile(\r\n        '<table><tbody>' +\r\n            '<tr>' +\r\n                '<td>{{i \"Макс. период на экране\"}}</td>' +\r\n                '<td><input id=\"maxShownPeriod\" class=\"inputStyle temporal-maxshow\"></input> <span>{{i \"дней\"}}</span> </td>' +\r\n            '</tr>' +\r\n            '<tr class=\"temporal-columns\">' +\r\n                '<td>{{i \"Колонка даты\"}}</td>' +\r\n                '<td><select id=\"columnSelect\" class=\"selectStyle\"></select></td>' +\r\n            '</tr>' +\r\n            // '<tr class=\"temporal-advanced\">' +\r\n            //     '<td>{{i \"Тайлы с\"}}</td>' +\r\n            //     '<td><select id=\"minPeriod\" class=\"selectStyle\">{{>TemporalLayerWidgetOptions}}</select></td>' +\r\n            // '</tr>' +\r\n            '<tr class=\"temporal-advanced\">' +\r\n                '<td>{{i \"Тайлы по дням до\"}}</td>' +\r\n                '<td><select id=\"maxPeriod\" class=\"selectStyle\">{{>TemporalLayerWidgetOptions}}</select></td>' +\r\n            '</tr>' +\r\n        '</tbody></table>' +\r\n        '<span class=\"buttonLink RCCreate-advanced-link\">{{i \"LayerRCControl.advancedLink\"}}</span>');\r\n\r\n    $(parentDiv).html(template({periods: PERIODS}));\r\n\r\n    var _columns = columns;\r\n    var isAdvancedMode =\r\n            paramsModel.get('minPeriod') !== paramsModel.defaults.minPeriod ||\r\n            paramsModel.get('maxPeriod') !== paramsModel.defaults.maxPeriod;\r\n\r\n    var wasInAdvancedMode = isAdvancedMode;\r\n    var updateVisibility = function() {\r\n        // var isTemporal = paramsModel.get('isTemporal');\r\n        $('.temporal-advanced', parentDiv).toggle(isAdvancedMode);\r\n        $('.RCCreate-advanced-link', parentDiv).toggle(!isAdvancedMode);\r\n        $('.temporal-columns', parentDiv).toggle(_columns.length > 1);\r\n    };\r\n\r\n    var updateColumnsSelect = function()\r\n\t{\r\n        var selectDateColumn = $('#columnSelect', parentDiv);\r\n\t\tvar curColumn = paramsModel.get('columnName');\r\n\t\tvar foundOption = null;\r\n\r\n\t\tselectDateColumn.empty();\r\n\t\tfor (var i = 0; i < _columns.length; i++) {\r\n\t\t\tvar option = $('<option></option>').text(_columns[i]);\r\n\t\t\tselectDateColumn.append(option);\r\n\t\t\tif (curColumn === _columns[i]) {\r\n\t\t\t\tfoundOption = option;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (foundOption) {\r\n\t\t\tfoundOption.attr('selected', 'selected');\r\n\t\t} else if (_columns.length) {\r\n\t\t\tparamsModel.set('columnName', _columns[0]);\r\n\t\t}\r\n\t};\r\n\r\n    updateVisibility();\r\n\r\n    $('.RCCreate-advanced-link', parentDiv).click(function() {\r\n        isAdvancedMode = !isAdvancedMode;\r\n        wasInAdvancedMode = true;\r\n        updateVisibility();\r\n    });\r\n\r\n    paramsModel.on('change:isTemporal', updateVisibility);\r\n\r\n    updateColumnsSelect();\r\n    $('#columnSelect', parentDiv).change(function()\r\n    {\r\n        paramsModel.set('columnName', $('option:selected', this).val());\r\n    });\r\n\r\n    $('#minPeriod>option[name=' + paramsModel.get('minPeriod') + ']', parentDiv).attr('selected', 'selected');\r\n    $('#minPeriod', parentDiv).change(function()\r\n    {\r\n        paramsModel.set('minPeriod', $('option:selected', this).val());\r\n    });\r\n\r\n    $('#maxPeriod>option[name=' + paramsModel.get('maxPeriod') + ']', parentDiv).attr('selected', 'selected');\r\n    $('#maxPeriod', parentDiv).change(function()\r\n    {\r\n        paramsModel.set('maxPeriod', $('option:selected', this).val());\r\n    });\r\n\r\n    $('#maxShownPeriod', parentDiv).val(paramsModel.get('maxShownPeriod') || '').bind('keyup', function()\r\n    {\r\n        var val = parseInt(this.value) || 0;\r\n\r\n        var paramsToSet = {maxShownPeriod: Math.max(0, val)};\r\n\r\n        if (!wasInAdvancedMode) {\r\n            if (val > 0) {\r\n                var index = Math.ceil(Math.log(val) / Math.log(4));\r\n                paramsToSet.maxPeriod = PERIODS[Math.min(PERIODS.length - 1, index)];\r\n            } else {\r\n                paramsToSet.maxPeriod = paramsModel.defaults.maxPeriod;\r\n            }\r\n            $('#maxPeriod>option[name=' + paramsToSet.maxPeriod + ']', parentDiv).attr('selected', 'selected');\r\n        }\r\n\r\n        paramsModel.set(paramsToSet);\r\n    });\r\n\r\n    /**\r\n        Обновляет список доступных для выбора колонок даты\r\n        @param {String[]} columns массив имён колонок\r\n    */\r\n\tthis.updateColumns = function(columns)\r\n\t{\r\n\t\t_columns = columns;\r\n\t\tupdateColumnsSelect();\r\n        updateVisibility();\r\n\t};\r\n};\r\n\r\n})();\r\n","import nsGmx from '../nsGmx.js';\r\nimport {\r\n    insertAtCursor,        \r\n    stopEvent,\r\n    _title,\r\n}\r\nfrom \"../utilities.js\";\r\n\r\nimport './SuggestWidget.css';\r\n\r\nnsGmx.SuggestWidget = function(attrNames, textarea, textTemplate, func, valuesArr, addValueFlag, attrType) {\r\n    var _this = this;\r\n    this.textArea = textarea;\r\n    this.func = func;\r\n    this.currentTextArea = textarea[0] || textarea;\r\n\r\n    if (valuesArr && !(valuesArr instanceof nsGmx.ILazyAttributeValuesProvider)) {\r\n        valuesArr = new nsGmx.LazyAttributeValuesProviderFromArray(valuesArr);\r\n    }\r\n\r\n    var canvas = this.el = nsGmx.Utils._div(null, [['dir', 'className', 'suggest-helper']]);\r\n    canvas.style.display = 'none';\r\n\r\n    canvas.onmouseout = function(e) {\r\n        var evt = e || window.event,\r\n            target = evt.srcElement || evt.target,\r\n            relTarget = evt.relatedTarget || evt.toElement;\r\n\r\n        if (canvas.getAttribute('arr')) {\r\n            try {\r\n                while (relTarget && !$(relTarget).hasClass('suggest-helper-elem-group')) {\r\n                    if (relTarget === canvas) { return; }\r\n                    relTarget = relTarget.parentNode;\r\n                }\r\n                $(canvas).fadeOut(100, function() {$(this).remove();});\r\n            } catch (ev) {\r\n                if (target === canvas) {\r\n                    $(canvas).fadeOut(100, function() {$(this).remove();});\r\n\t\t\t\t}\r\n            }\r\n        }\r\n    };\r\n\r\n    attrNames.forEach(function(name) {\r\n        var className;\r\n        if (attrType === 'functions') {\r\n            className = 'suggest-helper-elem suggest-helper-elem-custom-tooltip';\r\n        } else {\r\n            className = 'suggest-helper-elem';\r\n        }\r\n\r\n        if (typeof name === 'object') {\r\n            name = name.groupTag;\r\n            let div = nsGmx.Utils._div([nsGmx.Utils._t(String(name))], [['dir', 'className', className], ['dir', 'className', 'suggest-helper-elem-group']]);\r\n            $(div).css('margin-top', '3px')\r\n\r\n            $(canvas).append(div);\r\n        } else {\r\n            let div = nsGmx.Utils._div([nsGmx.Utils._t(String(name))], [['dir', 'className', className]]);\r\n            var hasCustomTooltip = $(div).hasClass('suggest-helper-elem-custom-tooltip');\r\n\r\n            if (hasCustomTooltip) {\r\n                var titleObj = nsGmx.sqlTemplates[name],\r\n                    isRus = window.language === 'rus',\r\n                    description = isRus ? titleObj.descRus : titleObj.descEng,\r\n                    title = titleObj.interface + ' - \\n' + description;\r\n\r\n                _title(div, title);\r\n            } else {\r\n                _title(div, name);\r\n            }\r\n\r\n            div.onmouseover = function() {\r\n                var _curDiv = this,\r\n                    attrType;\r\n\r\n                $(this.parentNode).children('.suggest-helper-hover').removeClass('suggest-helper-hover');\r\n                $(this).addClass('suggest-helper-hover');\r\n\r\n                if (!valuesArr) { return; }\r\n\r\n                $(canvas.parentNode).children('[arr]').each(function() {\r\n                    if (this.getAttribute('arr') !== name) {\r\n                        $(this).fadeOut(100, function() {\r\n                            $(this).remove();\r\n                        });\r\n                    }\r\n                });\r\n\r\n                if (!valuesArr.isAttributeExists(name)) { return; }\r\n\r\n                attrType = valuesArr.getAttributeType(name);\r\n\r\n                if (!$(canvas.parentNode).children('[arr=\\'' + name + '\\']').length) {\r\n                    this.timer = setTimeout(function() {\r\n                        valuesArr.getValuesForAttribute(name, function(attrValues) {\r\n                            if (!attrValues || !$(_curDiv).hasClass('suggest-helper-hover')) { return; }\r\n\r\n                            var arrSuggestCanvas = new nsGmx.SuggestWidget(attrValues, [_this.currentTextArea], 'suggest', function()\r\n                            {\r\n                                _this.func && _this.func();\r\n\r\n                                $(canvasArr.parentNode.childNodes[2]).fadeOut(100);\r\n\r\n                                canvasArr.removeNode(true);\r\n                            }, false, addValueFlag, attrType);\r\n\r\n                            var canvasArr = arrSuggestCanvas.el;\r\n\r\n                            canvasArr.style.left = '86px';\r\n                            canvasArr.style.height = '220px';\r\n                            canvasArr.style.width = '100px';\r\n\r\n                            $(canvasArr).children().css('width', '80px');\r\n\r\n                            canvasArr.setAttribute('arr', name);\r\n\r\n                            $(canvas.parentNode).append(canvasArr);\r\n\r\n                            $(canvasArr).fadeIn(100);\r\n                        });\r\n                    }, 300);\r\n                }\r\n            };\r\n\r\n            div.onmouseout = function(e) {\r\n                var evt = e || window.event,\r\n                target = evt.srcElement || evt.target,\r\n                relTarget = evt.relatedTarget || evt.toElement;\r\n\r\n                if ($(target).hasClass('suggest-helper-hover') && relTarget === this.parentNode) {\r\n                    $(this).removeClass('suggest-helper-hover');\r\n                }\r\n\r\n                if (this.timer) {\r\n                    clearTimeout(this.timer);\r\n                }\r\n            };\r\n\r\n            div.onclick = function(e) {\r\n                console.log(div);\r\n                var val = textTemplate.replace(/suggest/g, name);\r\n                if (this.parentNode.getAttribute('arr') != null) {\r\n                    var isNumber = attrType === 'float' || attrType === 'integer';\r\n\r\n                    if (isNumber) {\r\n                        val = val.replace(/,/g, '.')\r\n                    } else {\r\n                        val = '\\'' + val + '\\'';\r\n                    }\r\n\r\n                    if (addValueFlag) {\r\n                        val = '\"' + this.parentNode.getAttribute('arr') + '\" = ' + val;\r\n                    }\r\n                }\r\n\r\n                insertAtCursor(_this.currentTextArea, val, this.parentNode.sel);\r\n\r\n                $(canvas).fadeOut(100);\r\n\r\n                if (this.timer) {\r\n                    clearTimeout(this.timer);\r\n                }\r\n\r\n                $(canvas.parentNode).children('[arr]').fadeOut(100, function()\r\n                {\r\n                    $(this).remove();\r\n                });\r\n\r\n                _this.func && _this.func();\r\n\r\n                stopEvent(e);\r\n            };\r\n\r\n            $(canvas).append(div);\r\n        }\r\n\r\n    });\r\n};\r\n\r\nnsGmx.SuggestWidget.prototype.setActiveTextArea = function (textArea) {\r\n\r\n    for (var i = 0; i < this.textArea.length; i++) {\r\n        if (this.textArea[i] === textArea) {\r\n            this.currentTextArea = this.textArea[i];\r\n            break;\r\n        }\r\n    }\r\n};\r\n\r\nnsGmx.SuggestWidget.prototype.setCallback = function (func) {\r\n    this.func = func;\r\n}\r\n\r\n\r\n/**\r\n * @param {domElement} targetTextarea textArea to append\r\n * @param {array} attrNames\r\n * @param {object} attrValuesProvider\r\n * @param {function} changeCallback\r\n * @param {array} selectors array of sub-widgets (attrs, operators, functions)\r\n */\r\n\r\nnsGmx.AttrSuggestWidget = function(targetTextarea, attrNames, attrValuesProvider, changeCallback, selectors) {\r\n    this.changeCallback = changeCallback;\r\n    this.targetTextarea = targetTextarea;\r\n\r\n    var template = Handlebars.compile('<div class=\"suggest-container\">' +\r\n        '<table><tbody><tr>' +\r\n            '{{#if attrs}}<td><div class=\"suggest-link-container selectStyle suggest-attr\">{{i \"Колонки\"}}<span class=\"ui-icon ui-icon-triangle-1-s\"></span></div></td>{{/if}}' +\r\n            '{{#if operators}}<td><div class=\"suggest-link-container selectStyle suggest-op\">{{i \"Операторы\"}}<span class=\"ui-icon ui-icon-triangle-1-s\"></span></div></td>{{/if}}' +\r\n            '{{#if functions}}<td><div class=\"suggest-link-container selectStyle suggest-func\">{{i \"Функции\"}}<span class=\"ui-icon ui-icon-triangle-1-s\"></span></div></td>{{/if}}' +\r\n        '</tr></tbody></table>' +\r\n    '</div>');\r\n\r\n    var ui = this.el = $(template({\r\n        attrs: selectors.indexOf('attrs') !== -1,\r\n        functions: selectors.indexOf('functions') !== -1,\r\n        operators: selectors.indexOf('operators') !== -1\r\n    }));\r\n\r\n    this.attrsSuggest = selectors.indexOf('attrs') !== -1 ? new nsGmx.SuggestWidget(attrNames, targetTextarea, '\"suggest\"', changeCallback, attrValuesProvider, true) : null;\r\n    this.functionsSuggest = selectors.indexOf('functions') !== -1 ? new nsGmx.SuggestWidget(transformHash(nsGmx.sqlFunctions), targetTextarea, 'suggest()', this.changeCallback, null, false, 'functions') : null;\r\n    this.operatorsSuggest = selectors.indexOf('operators') !== -1 ? new nsGmx.SuggestWidget(['=', '>', '<', '>=', '<=', '<>', 'AND', 'OR', 'NOT', 'IN', 'CONTAINS', 'CONTAINSIGNORECASE', 'BETWEEN', 'STARTSWITH', 'ENDSWITH'], targetTextarea, 'suggest', this.changeCallback) : null;\r\n\r\n    this.attrsSuggest && ui.find('.suggest-attr').append(this.attrsSuggest.el);\r\n    this.functionsSuggest && ui.find('.suggest-func').append(this.functionsSuggest.el);\r\n    this.operatorsSuggest && ui.find('.suggest-op').append(this.operatorsSuggest.el);\r\n\r\n    var clickFunc = function(div) {\r\n        if (document.selection) {\r\n            targetTextarea.focus();\r\n            var sel = document.selection.createRange();\r\n            div.sel = sel;\r\n            targetTextarea.blur();\r\n        }\r\n\r\n        ui.find('.attrsHelperCanvas').children('[arr]').fadeOut(100, function() {\r\n            $(this).remove();\r\n        });\r\n    };\r\n\r\n    ui.find('.suggest-link-container').click(function(e) {\r\n        var evt = e || window.event,\r\n            target = evt.srcElement || evt.target;\r\n            //var relTarget = evt.relatedTarget || evt.toElement;\r\n\r\n        if (!$(target).hasClass('suggest-helper-elem-group')) {\r\n            var placeholder = $(this).children('.suggest-helper');\r\n            clickFunc(placeholder[0]);\r\n\r\n            ui.find('.suggest-helper').fadeOut(100);\r\n            placeholder.fadeIn(100);\r\n        }\r\n    });\r\n\r\n    $(targetTextarea).click(function() {\r\n        ui.find('.suggest-helper').fadeOut(100);\r\n        return true;\r\n    });\r\n\r\n    /**\r\n     * SQLHASH TRANSFORM HELPER\r\n     */\r\n     function transformHash(hash) {\r\n        var arr = [],\r\n            res = [];\r\n\r\n        for (var key in hash) {\r\n            if (hash.hasOwnProperty(key)) {\r\n                res.push({groupTag: key});\r\n\r\n                arr = hash[key];\r\n                for (var i = 0; i < arr.length; i++) {\r\n                    res.push(arr[i]);\r\n                }\r\n            }\r\n        }\r\n\r\n        return res;\r\n     }\r\n};\r\n\r\nnsGmx.AttrSuggestWidget.prototype.setActiveTextArea = function (textArea) {\r\n    this.attrsSuggest && this.attrsSuggest.setActiveTextArea(textArea);\r\n    this.functionsSuggest && this.functionsSuggest.setActiveTextArea(textArea);\r\n    this.operatorsSuggest && this.operatorsSuggest.setActiveTextArea(textArea);\r\n}\r\n\r\nnsGmx.AttrSuggestWidget.prototype.setCallback = function (callback) {\r\n    this.attrsSuggest && this.attrsSuggest.setCallback(callback);\r\n    this.functionsSuggest && this.functionsSuggest.setCallback(callback);\r\n    this.operatorsSuggest && this.operatorsSuggest.setCallback(callback);\r\n}","﻿import nsGmx from '../nsGmx.js';\r\nimport '../SuggestWidget/AttrSuggestWidget.js';\r\nimport './LayerQuicklookWidget.css';\r\n\r\nwindow._translationsHash.addtext('rus', {LayerQuicklookWidget: {\r\n    minZoom: 'Мин. зум',\r\n    regTitle: 'Атрибуты привязки',\r\n    title: 'Показать'\r\n}});\r\n\r\nwindow._translationsHash.addtext('eng', {LayerQuicklookWidget: {\r\n    minZoom: 'Min zoom',\r\n    regTitle: 'Registration fields',\r\n    title: 'Expand'\r\n}});\r\n\r\nvar template = Handlebars.compile('<div>' +\r\n    '{{#if isMinimized}}<span class=\"lqw-title buttonLink\">{{i \"LayerQuicklookWidget.title\"}}</span>{{/if}}' +\r\n    '<div class=\"lqw-container\" {{#if isMinimized}}style=\"display:none\"{{/if}}>' +\r\n        '<div>{{i \"LayerQuicklookWidget.minZoom\"}}<input class=\"lqw-minzoom-input inputStyle\" value=\"{{minZoom}}\"></div>' +\r\n        '<textarea class=\"inputStyle lqw-textarea\">{{quicklook}}</textarea>' +\r\n        '<div class=\"suggest-link-container\">{{i \"Атрибут >\"}}</div>' +\r\n        '<div class=\"lqw-registration-link\">{{i \"LayerQuicklookWidget.regTitle\"}}</div>' +\r\n        '<table class=\"lqw-registration-container\">' +\r\n            '{{#points}}' +\r\n                '<tr><td>X{{idx}}{{../regSelect \"X\"}}</td><td>Y{{idx}}{{../regSelect \"Y\"}}</td></tr>' +\r\n            '{{/points}}' +\r\n        '</table>' +\r\n    '</div>' +\r\n'</div>');\r\n\r\nvar selectTemplate = Handlebars.compile('<select data-name=\"{{targetName}}\" class=\"lqw-point-select selectStyle\">' +\r\n    '{{#opts}}' +\r\n        '<option value=\"{{name}}\"{{#if isDefault}} selected{{/if}}>{{name}}</option>' +\r\n    '{{/opts}}' +\r\n'</select>');\r\n\r\n/**\r\nВиджет для задания параметров слоя, связанных с показом квиклуков\r\n@memberOf nsGmx\r\n@class\r\n*/\r\nnsGmx.LayerQuicklookWidget = function(container, layerProperties) {\r\n    var DEFAULT_OPTION = {name: '', isDefault: false};\r\n\r\n    var layerColumns = window._.pluck(layerProperties.get('Columns'), 'Name'),\r\n        quicklookParams = layerProperties.get('Quicklook');\r\n\r\n    var ui = $(template({\r\n        isMinimized: !quicklookParams.get('template'),\r\n        minZoom: quicklookParams.get('minZoom'),\r\n        quicklook: quicklookParams.get('template'),\r\n        points: Array.apply(null, {length: 4}).map(function(elem, index) { return {idx: index + 1};}),\r\n        regSelect: function(label) {\r\n            var targetName = (label + this.idx),\r\n                initValue = (quicklookParams.get(targetName) || targetName).toLowerCase();\r\n            return new Handlebars.SafeString(selectTemplate({\r\n                targetName: targetName,\r\n                opts: [].concat(DEFAULT_OPTION, layerColumns.map(function(column) {\r\n                    return {\r\n                        name: column,\r\n                        isDefault: column.toLowerCase() === initValue\r\n                    };\r\n                }))\r\n            }));\r\n        }\r\n    }));\r\n\r\n    ui.find('.lqw-title').click(function() {\r\n        ui.find('.lqw-title').hide();\r\n        ui.find('.lqw-container').show();\r\n    });\r\n\r\n    var updateRegistrationStatus = function() {\r\n        ui.find('td').each(function(index, td) {\r\n            $(td).toggleClass('lqw-reg-error', !$(td).find('option:selected').val());\r\n        });\r\n    };\r\n\r\n    ui.find('.lqw-minzoom-input').on('change keyup', function() {\r\n        var minZoom = Number(this.value);\r\n        quicklookParams.set('minZoom', minZoom);\r\n    });\r\n\r\n    ui.find('select').change(function() {\r\n        updateRegistrationStatus();\r\n        var name = $(this).data('name');\r\n        quicklookParams.set(name, this.value || undefined);\r\n    });\r\n\r\n    updateRegistrationStatus();\r\n\r\n    if (ui.find('.lqw-reg-error').length === 0) {\r\n        ui.find('.lqw-registration-container').hide();\r\n        ui.find('.lqw-registration-link').addClass('buttonLink').click(function() {\r\n            $(this).removeClass('buttonLink');\r\n            ui.find('.lqw-registration-container').show();\r\n        });\r\n    }\r\n\r\n    var quicklookText = ui.find('.lqw-textarea');\r\n\r\n    var setQuicklook = function() {\r\n        layerProperties.get('Quicklook').set('template', quicklookText.val());\r\n    };\r\n\r\n    var suggestWidget = new nsGmx.SuggestWidget(layerProperties.get('Attributes') || [], quicklookText[0], '[suggest]', setQuicklook, ['attrs', 'operators']);\r\n\r\n    quicklookText.on('focus', function() {\r\n        $(suggestWidget.el).hide();\r\n    });\r\n\r\n    ui.find('.suggest-link-container')\r\n        .append(suggestWidget.el)\r\n        .click(function() {\r\n            if (suggestWidget.el.style.display === 'none') {\r\n                $(suggestWidget.el).fadeIn(500);\r\n            }\r\n        });\r\n\r\n    quicklookText.on('keyup change', setQuicklook);\r\n\r\n    ui.appendTo(container);\r\n};\r\n","import nsGmx from '../nsGmx.js';\r\n\t\r\nfunction capitaliseFirstLetter(str)\r\n{\r\n    return str.charAt(0).toUpperCase() + str.slice(1);\r\n}\r\n\r\n//events: newAttribute, delAttribute, updateAttribute, updateExpression, moveAttribute, change\r\nnsGmx.ManualAttrModel = function(isRCLayer) {\r\n    var _attributes = [];\r\n    this.expressions = [];\r\n\r\n    this.addAttribute = function(type, name)\r\n    {\r\n        _attributes.push({\r\n            type: type,\r\n            name: name,\r\n            IsPrimary: false,\r\n            IsIdentity: false,\r\n            IsComputed: false,\r\n            expression: '\"' + name + '\"'\r\n        });\r\n\r\n        this.expressions.push({\r\n            name: name,\r\n            expression: '\"' + name + '\"'\r\n        })\r\n\r\n        $(this).triggerHandler('newAttribute');\r\n        $(this).triggerHandler('change');\r\n\r\n        return _attributes.length - 1;\r\n    };\r\n\r\n    this.changeName = function(idx, newName)\r\n    {\r\n        _attributes[idx].name = newName;\r\n        $(this).triggerHandler('updateAttribute');\r\n        $(this).triggerHandler('change');\r\n    };\r\n\r\n    this.changeType = function(idx, newType)\r\n    {\r\n        _attributes[idx].type = newType;\r\n        $(this).triggerHandler('updateAttribute');\r\n        $(this).triggerHandler('change');\r\n    };\r\n\r\n\r\n    this.changeExpression = function(name, newExp)\r\n    {\r\n        var obj = this.expressions.find(function (obj){return obj.name === name});\r\n\r\n        obj.expression = newExp;\r\n        $(this).triggerHandler('updateExpression');\r\n        $(this).triggerHandler('change');\r\n    };\r\n\r\n    this.deleteAttribute = function(idx)\r\n    {\r\n        _attributes.splice(idx, 1);\r\n        $(this).triggerHandler('delAttribute');\r\n        $(this).triggerHandler('change');\r\n    };\r\n\r\n    this.getAttribute = function(idx) { return _attributes[idx]; };\r\n    this.getCount = function() { return _attributes.length; };\r\n    this.each = function(callback, addInternalColumns, params) {\r\n        for (var k = 0; k < _attributes.length; k++) {\r\n            var column = _attributes[k];\r\n            var isInternal = column.IsPrimary || column.IsIdentity || column.IsComputed ||\r\n                             column.type.server === 'geometry' || (isRCLayer && column.name === 'GMX_RasterCatalogID');\r\n\r\n            if (!isInternal || addInternalColumns) {\r\n                callback(column, k, params);\r\n            }\r\n        }\r\n    };\r\n\r\n    this.moveAttribute = function(oldIdx, newIdx) {\r\n        if (newIdx > oldIdx) {\r\n            newIdx--;\r\n        }\r\n\r\n        if (oldIdx !== newIdx) {\r\n            _attributes.splice(newIdx, 0, _attributes.splice(oldIdx, 1)[0]);\r\n            $(this).triggerHandler('moveAttribute');\r\n            $(this).triggerHandler('change');\r\n        }\r\n    };\r\n\r\n    this.initFromServerFormat = function(serverColumns) {\r\n        var _this = this;\r\n        _attributes = [];\r\n        $.each(serverColumns || [], function(i, column) {\r\n            var type = window._.find(nsGmx.ManualAttrModel.TYPES, function(elem) {return elem.server === column.ColumnSimpleType.toLowerCase();});\r\n\r\n            var obj = _this.expressions.find(function (obj){return obj.name === column.Name});\r\n\r\n            if (!obj) {\r\n                _this.expressions.push({\r\n                    name: column.Name,\r\n                    expression: '\"' + column.Name + '\"'\r\n                })\r\n            }\r\n\r\n            _attributes.push({\r\n                type: type || {server: column.ColumnSimpleType.toLowerCase()},\r\n                name: column.Name,\r\n                oldName: column.Name,\r\n                IsPrimary: column.IsPrimary,\r\n                IsIdentity: column.IsIdentity,\r\n                IsComputed: column.IsComputed\r\n            });\r\n        });\r\n        $(this).triggerHandler('newAttribute');\r\n        $(this).triggerHandler('change');\r\n    };\r\n\r\n    this.toServerFormat = function() {\r\n        var _this = this;\r\n        var res = [];\r\n        $.each(_attributes, function(i, attr) {\r\n            var obj = _this.expressions.find(function (obj){return obj.name === attr.name});\r\n\r\n            res.push({\r\n                Name: attr.name,\r\n                OldName: attr.oldName,\r\n                ColumnSimpleType: capitaliseFirstLetter(attr.type.server),\r\n                IsPrimary: attr.IsPrimary,\r\n                IsIdentity: attr.IsIdentity,\r\n                IsComputed: attr.IsComputed,\r\n                expression: obj ? obj.expression : '\"' + attr.name + '\"'\r\n            });\r\n        });\r\n\r\n        return res;\r\n    };\r\n\r\n    this.replaceString = function (string) {\r\n        if (!string) return;\r\n        _attributes.forEach(function (attr) {\r\n            if (attr.name) {\r\n                var re = new RegExp('\\\\\"' + attr.name + '\\\\\"',\"g\");\r\n\r\n                if (!string.match(re)) {\r\n                    string = string.replace(attr.name, '\"' + attr.name + '\"');\r\n                }\r\n            }\r\n        });\r\n        return string;\r\n    };\r\n};\r\n\r\nnsGmx.ManualAttrModel.TYPES = {\r\n    DOUBLE:   {user: 'Float',    server: 'float'},\r\n    INTEGER:  {user: 'Integer',  server: 'integer'},\r\n    STRING:   {user: 'String',   server: 'string'},\r\n    TIME:     {user: 'Time',     server: 'time'},\r\n    DATE:     {user: 'Date',     server: 'date'},\r\n    DATETIME: {user: 'DateTime', server: 'datetime'},\r\n    BOOL:     {user: 'Boolean',  server: 'boolean'}\r\n};","import nsGmx from '../nsGmx.js';\r\n\r\nvar utils = nsGmx.Utils;\r\n_translationsHash.addtext('rus', {ManualAttrView: {\r\n    headerName: 'Название',\r\n    headerType: 'Тип',\r\n    headerExp: 'Выражение'\r\n}});\r\n\r\n_translationsHash.addtext('eng', {ManualAttrView: {\r\n    headerName: 'Name',\r\n    headerType: 'Type',\r\n    headerExp: 'Expression'\r\n}});\r\n\r\nvar selectorTemplate = Handlebars.compile('<select class=\"selectStyle customAttr-typesselect\">' +\r\n        '{{#each types}}' +\r\n            '<option value=\"{{server}}\" id=\"{{server}}\"{{#if @root.isSelected}} selected{{/if}}>{{user}}</option>' +\r\n        '{{/each}}' +\r\n    '</select>'\r\n);\r\n\r\nnsGmx.ManualAttrView = function()\r\n{\r\n    var _parent = null;\r\n    var _model = null;\r\n    var _params = null;\r\n    var _trs = [];\r\n    var _isActive = true;\r\n    var _this = this;\r\n    var isAddingNew = false;\r\n\r\n    var createTypeSelector = function(selectedType)\r\n    {\r\n        return $(selectorTemplate({\r\n            types: nsGmx.ManualAttrModel.TYPES,\r\n            isSelected: function() {\r\n                return this.server === selectedType;\r\n            }\r\n        }));\r\n    };\r\n\r\n    var createRow = function(attr, i, params) {\r\n        var sqlSelector, cellsArr;\r\n\r\n        var typeSelector = createTypeSelector(attr.type.server)[0];\r\n        $(typeSelector).data('idx', i);\r\n\r\n        $(typeSelector).change(function() {\r\n            var serverType = $('option:selected', this).val(),\r\n                attrType = window._.findWhere(nsGmx.ManualAttrModel.TYPES, {server: serverType});\r\n\r\n            _model.changeType($(this).data('idx'), attrType);\r\n        });\r\n\r\n        var nameSelectorLength = params.copy ? 90 : 120;\r\n\r\n        var nameSelector = utils._input(null, [['attr', 'class', 'customAttrNameInput inputStyle'], ['css', 'width', nameSelectorLength + 'px']]);\r\n\r\n        $(nameSelector).data('idx', i).val(attr.name);\r\n\r\n        var deleteIcon = utils.makeImageButton('img/recycle.png', 'img/recycle_a.png');\r\n\r\n        if (params.copy) {\r\n\r\n            var obj = _model.expressions.find(function (obj){\r\n                return obj.name === attr.name\r\n            });\r\n\r\n            var expression = obj ? obj.expression : '';\r\n\r\n            sqlSelector = utils._input(null, [['attr', 'class', 'manualSqlAttrInput inputStyle'], ['css', 'width', '100px']]);\r\n            $(sqlSelector).data('idx', i).val(_model.replaceString(expression));\r\n\r\n            $(sqlSelector).on('keyup', function()\r\n            {\r\n                var idx = $(this).data('idx');\r\n                var exp = $(this).val();\r\n\r\n                if (idx >= 0) {\r\n                    _model.changeExpression(attr.name, exp);\r\n                } else if (name) {\r\n                    // isAddingNew = true;\r\n                    // $(tr).find('td:gt(0)').show();\r\n                    // $(tr).removeClass('customAttributes-new');\r\n                    // var newIdx = _model.addAttribute(nsGmx.ManualAttrModel.TYPES.STRING, name);\r\n                    // $([nameSelector, typeSelector, deleteIcon]).data('idx', newIdx);\r\n                    // isAddingNew = false;\r\n                }\r\n            });\r\n\r\n\r\n            cellsArr = [utils._td([nameSelector]), utils._td([typeSelector]), utils._td([sqlSelector]), utils._td([deleteIcon])];\r\n        } else {\r\n            // sqlSelector =\r\n            cellsArr = [utils._td([nameSelector]), utils._td([typeSelector]), utils._td([deleteIcon])];\r\n        }\r\n\r\n        var tr = utils._tr(cellsArr);\r\n\r\n        $(nameSelector).on('keyup', function()\r\n        {\r\n            var idx = $(this).data('idx');\r\n            var name = $(this).val();\r\n\r\n            if (idx >= 0) {\r\n                _model.changeName(idx, name);\r\n            } else if (name) {\r\n                isAddingNew = true;\r\n                $(tr).find('td:gt(0)').show();\r\n                $(tr).removeClass('customAttributes-new');\r\n                var newIdx = _model.addAttribute(nsGmx.ManualAttrModel.TYPES.STRING, name);\r\n                $([nameSelector, typeSelector, deleteIcon]).data('idx', newIdx);\r\n                isAddingNew = false;\r\n            }\r\n        });\r\n\r\n        $(deleteIcon).addClass('removeIcon').data('idx', i);\r\n        deleteIcon.onclick = function()\r\n        {\r\n            _model.deleteAttribute($(this).data('idx'));\r\n        };\r\n\r\n        return tr;\r\n    };\r\n\r\n    var redraw = function()\r\n    {\r\n        if (!_model || isAddingNew) { return; }\r\n\r\n        $(_parent).empty();\r\n        _trs = [];\r\n\r\n        _model.each(function(attr, i) {\r\n            _trs.push(createRow(attr, i, _params));\r\n        });\r\n\r\n        var newAttr = createRow({name: '', type: nsGmx.ManualAttrModel.TYPES.STRING}, -1, _params);\r\n        $(newAttr).find('td:gt(0)').hide();\r\n        $(newAttr).addClass('customAttributes-new');\r\n\r\n        _trs.push(newAttr);\r\n\r\n        var tbody = nsGmx.Utils._tbody(_trs);\r\n        var theader = $(Handlebars.compile(\r\n            '<thead>' +\r\n                '<tr>' +\r\n                    '<th>{{i \"ManualAttrView.headerName\"}}</th>' +\r\n                    '<th>{{i \"ManualAttrView.headerType\"}}</th>' +\r\n                    '{{#if copy}}<th>{{i \"ManualAttrView.headerExp\"}}</th>{{/if}}' +\r\n                '</tr>' +\r\n            '</thead>')({copy: _params.copy}));\r\n\r\n        $(_parent).append($('<fieldset/>').css('border', 'none').append(nsGmx.Utils._table([theader[0], tbody], [['dir', 'className', 'customAttributes']])));\r\n        _this.setActive(_isActive);\r\n    };\r\n\r\n    this.setActive = function(isActive) {\r\n        _isActive = isActive;\r\n        var fieldset = $(_parent).children('fieldset');\r\n        if (isActive) {\r\n            fieldset.removeAttr('disabled');\r\n        } else {\r\n            fieldset.attr('disabled', 'disabled');\r\n        }\r\n        $('.removeIcon, .customAttributes-new', fieldset).toggle(isActive);\r\n    };\r\n\r\n    this.init = function(parent, model, params)\r\n    {\r\n        _parent = parent;\r\n        _model = model;\r\n        _params = params;\r\n        $(_model).on('newAttribute delAttribute moveAttribute', redraw);\r\n\r\n        $(_model).on('newAttribute', function() {\r\n            if (!$(_parent).find('.customAttributes-new').length) {\r\n                var newAttr = createRow({name: '', type: nsGmx.ManualAttrModel.TYPES.STRING}, -1, params);\r\n                $(newAttr).find('td:gt(0)').hide();\r\n                $(newAttr).addClass('customAttributes-new');\r\n                $(_parent).find('tbody').append(newAttr);\r\n            }\r\n        });\r\n        redraw();\r\n    };\r\n};","import nsGmx from './nsGmx.js';\r\nimport {\r\n\tattachEffects,\r\n\t_br,\r\n\t_div, _form,\r\n\t_input,\r\n\tinputError,\r\n\tmakeImageButton, makeButton,\r\n\tmakeLinkButton,\r\n\tparseResponse,\r\n\tsendCrossDomainJSONRequest,\r\n\tsendCrossDomainPostRequest,\r\n\tshowDialog,\r\n\t_span,\r\n\t_t,\r\n\t_title,\r\n\t_table,\r\n\t_tbody,\r\n\t_thead,\r\n\t_tr,\r\n\t_td, valueInArray,\r\n} from './utilities.js';\r\n\r\nconst _ = nsGmx.Utils._;\r\n\r\n/**\r\n* @class Веб браузер для выбора и загрузки файлов на сервер\r\n*/\r\nvar fileBrowser = function()\r\n{\r\n\tvar _this = this;\r\n\tthis.parentCanvas = null;\r\n\r\n\tthis._homeDir = '';\r\n\r\n\tthis._status = {\r\n\t\t_state: false,\r\n\t\tstart: function() {\r\n\t\t\tthis._state = true;\r\n\t\t\tvar me = this;\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif (me._state) {\r\n\t\t\t\t\t$(_this.statusContainer).show();\r\n\t\t\t\t}\r\n\t\t\t}, 100);\r\n\t\t},\r\n\t\tstop: function() {\r\n\t\t\t$(_this.statusContainer).hide();\r\n\t\t\tthis._state = false;\r\n\t\t}\r\n\t}\r\n\r\n\tthis._path = (function()\r\n\t{\r\n\t\tvar path;\r\n\t\tvar alternativePath;\r\n\t\treturn {\r\n\t\t\tset: function(newPath, newAlternativePath)\r\n\t\t\t{\r\n\t\t\t\tpath = newPath + (newPath.charAt(newPath.length-1) === _this.slash ? '' : _this.slash);\r\n\t\t\t\tif (newAlternativePath) {\r\n\t\t\t\t\talternativePath = newAlternativePath + (newAlternativePath.charAt(newAlternativePath.length-1) === _this.slash ? '' : _this.slash);\r\n\t\t\t\t} else {\r\n\t\t\t\t\talternativePath = undefined;\r\n\t\t\t\t}\r\n\t\t\t\t$(this).change();\r\n\t\t\t},\r\n\t\t\tget: function()\r\n\t\t\t{\r\n\t\t\t\treturn path;\r\n\t\t\t},\r\n\t\t\tgetAlternative: function()\r\n\t\t\t{\r\n\t\t\t\treturn alternativePath;\r\n\t\t\t},\r\n\t\t\tisRoot: function()\r\n\t\t\t{\r\n\t\t\t\treturn path && path.indexOf(_this.slash) === path.length-1;\r\n\t\t\t},\r\n\t\t\tisInited: function()\r\n\t\t\t{\r\n\t\t\t\treturn typeof path !== 'undefined';\r\n\t\t\t},\r\n\t\t\tisInHome: function()\r\n\t\t\t{\r\n\t\t\t\treturn path && path.indexOf(_this._homeDir) === 0;\r\n\t\t\t},\r\n\t\t\tgetRoot: function()\r\n\t\t\t{\r\n\t\t\t\tvar index = String(path).indexOf(_this.slash);\r\n\t\t\t\treturn String(path).substr(0, index+1);\r\n\t\t\t},\r\n\t\t\tgetParentFolder: function()\r\n\t\t\t{\r\n\t\t\t\tvar index = String(path).lastIndexOf(_this.slash, path.length-2);\r\n\t\t\t\treturn String(path).substr(0, index+1);\r\n\t\t\t}\r\n\t\t}\r\n\t})();\r\n\r\n\tthis.currentFiles = [];\r\n\r\n\tthis.slash = \"\\\\\";\r\n\r\n\tthis.fileCanvas = null;\r\n\tthis.fileHeader = null;\r\n\tthis.fileUpload = null;\r\n\r\n\tthis.sortFuncs =\r\n\t{\r\n\t\tname:[\r\n\t\t\tfunction(_a,_b){var a = String(_a.Name).toLowerCase(), b = String(_b.Name).toLowerCase(); if (a > b) return 1; else if (a < b) return -1; else return 0},\r\n\t\t\tfunction(_a,_b){var a = String(_a.Name).toLowerCase(), b = String(_b.Name).toLowerCase(); if (a < b) return 1; else if (a > b) return -1; else return 0}\r\n\t\t],\r\n\t\text:[\r\n\t\t\tfunction(_a,_b)\r\n\t\t\t{\r\n\t\t\t\tvar a = String(_a.Name).toLowerCase(),\r\n\t\t\t\t\tb = String(_b.Name).toLowerCase(),\r\n\t\t\t\t\tindex1 = a.lastIndexOf('.'),\r\n\t\t\t\t\text1 = a.substr(index1 + 1, a.length),\r\n\t\t\t\t\tindex2 = b.lastIndexOf('.'),\r\n\t\t\t\t\text2 = b.substr(index2 + 1, b.length);\r\n\r\n\t\t\t\tif (ext1 > ext2) return 1; else if (ext1 < ext2) return -1; else return 0;\r\n\t\t\t},\r\n\t\t\tfunction(_a,_b)\r\n\t\t\t{\r\n\t\t\t\tvar a = String(_a.Name).toLowerCase(),\r\n\t\t\t\t\tb = String(_b.Name).toLowerCase(),\r\n\t\t\t\t\tindex1 = a.lastIndexOf('.'),\r\n\t\t\t\t\text1 = a.substr(index1 + 1, a.length),\r\n\t\t\t\t\tindex2 = b.lastIndexOf('.'),\r\n\t\t\t\t\text2 = b.substr(index2 + 1, b.length);\r\n\r\n\t\t\t\tif (ext1 < ext2) return 1; else if (ext1 > ext2) return -1; else return 0;\r\n\t\t\t}\r\n\t\t],\r\n\t\tsize:[\r\n\t\t\tfunction(a,b){return a.Size - b.Size},\r\n\t\t\tfunction(a,b){return b.Size - a.Size}\r\n\t\t],\r\n\t\tdate:[\r\n\t\t\tfunction(a,b){return a.Date - b.Date},\r\n\t\t\tfunction(a,b){return b.Date - a.Date}\r\n\t\t]\r\n\t};\r\n\r\n\tthis.currentSortType = 'name';\r\n\tthis.currentSortIndex =\r\n\t{\r\n\t\tname: 0,\r\n\t\text: 0,\r\n\t\tsize: 0,\r\n\t\tdate: 0\r\n\t};\r\n\r\n\tthis.shownPathScroll = false;\r\n\r\n\tthis.returnMask = ['noname'];\r\n\r\n\tthis._discs = null;\r\n\r\n\tthis._params = null;\r\n\r\n\tthis.ext7z = ['7Z', 'ZIP', 'GZIP', 'BZIP2', 'TAR', 'ARJ', 'CAB', 'CHM', 'CPIO', 'DEB', 'DMG', 'HFS', 'ISO', 'LZH', 'LZMA', 'MSI', 'NSIS', 'RAR', 'RPM', 'UDF', 'WIM', 'XAR', 'Z'];\r\n}\r\n\r\nfileBrowser.MAX_UPLOAD_SIZE = 500*1024*1024;\r\n\r\n/**\r\n Показать браузер пользователю. Если браузер уже показывается, он будет закрыт и открыт новый\r\n @param {String} title Заголовок окна браузера\r\n @param {String[]} mask Массив допустимых для выбора разрешений файлов. Если массив пустой, то выбираются директории, а не отдельные файлы\r\n @param {function(path)} closeFunc Функция, которая будет вызвана при выборе файла/директории (если браузер просто закрыли, не вызовется)\r\n @param {Object} params Параметры браузера\r\n @param {String} params.restrictDir Ограничивающая директория (поддерево). Нельзя посмотреть файлы вне этой директории (даже для админов)\r\n @param {String} params.startDir Начальная директория. Если нет, то будет открыто в том же месте, где и закрыт в прошлый раз.\r\n*/\r\nfileBrowser.prototype.createBrowser = function(title, mask, closeFunc, params)\r\n{\r\n\tthis._params = $.extend({restrictDir: null, startDir: null}, params);\r\n\r\n\tif (this._params.startDir !== null)\r\n\t\tthis._path.set(this._params.startDir);\r\n\r\n\tif ($('#fileBrowserDialog').length)\r\n\t{\r\n\t\t$('#fileBrowserDialog').parent().dialog(\"destroy\");\r\n\t\t$('#fileBrowserDialog').parent().remove();\r\n\t}\r\n\r\n\tvar canvas = _div(null, [['attr','id','fileBrowserDialog']]);\r\n\r\n\tvar oDialog = showDialog(title, canvas, 800, 400, false, false, this.resize);\r\n\r\n\tthis.returnMask = mask;\r\n\tthis.parentCanvas = canvas;\r\n\tthis.closeFunc = closeFunc;\r\n\tthis._homeDir = nsGmx.AuthManager.getUserFolder();\r\n\r\n\tif (this._discs === null )// && nsGmx.AuthManager.canDoAction(nsGmx.ACTION_SEE_FILE_STRUCTURE )\r\n\t\tthis.loadInfo();\r\n\telse\r\n\t\tthis.loadInfoHandler()\r\n\r\n\treturn oDialog;\r\n}\r\n\r\nfileBrowser.prototype.resize = function()\r\n{\r\n\tif (!$(\"#fileBrowserDialog\").find(\".fileCanvas\").length)\r\n\t\treturn;\r\n\r\n\tvar container = $('#fileBrowserDialog')[0];\r\n\r\n\tvar titleHeight = container.parentNode.parentNode.firstChild.offsetHeight;\r\n\r\n\tcontainer.childNodes[1].lastChild.style.height = container.parentNode.parentNode.offsetHeight - titleHeight - 6 - container.lastChild.offsetHeight - container.firstChild.offsetHeight - container.childNodes[1].firstChild.offsetHeight - 20 + 'px';\r\n}\r\n\r\nfileBrowser.prototype.close = function(path)\r\n{\r\n\tthis.closeFunc(path);\r\n\r\n\tvar canvas = $('#fileBrowserDialog')[0];\r\n\r\n\t$(canvas.parentNode).dialog(\"destroy\");\r\n\r\n\tcanvas.parentNode.removeNode(true);\r\n}\r\n\r\nfileBrowser.prototype.loadInfo = function()\r\n{\r\n\tvar _this = this;\r\n\tsendCrossDomainJSONRequest(window.serverBase + \"FileBrowser/GetDrives.ashx?WrapStyle=func\", function(response)\r\n\t{\r\n\t\tif (!parseResponse(response))\r\n\t\t\treturn;\r\n\r\n\t\t_this._discs = response.Result;\r\n\t\t_this.loadInfoHandler()\r\n\t})\r\n}\r\n\r\nfileBrowser.prototype._showWarningDialog = function() {\r\n\tvar canvas = _div([_t(_gtxt(\"FileBrowser.ExceedLimitMessage\"))], [['dir', 'className', 'CustomErrorText']]);\r\n\tshowDialog(_gtxt(\"Ошибка!\"), canvas, 220, 100);\r\n}\r\n\r\nfileBrowser.prototype._uploadFilesAjax = function(formData) {\r\n\tvar _this = this;\r\n\tthis.progressBar.progressbar('option', 'value', 0);\r\n\tthis.progressBar.show();\r\n\r\n\tformData.append('WrapStyle', 'None');\r\n\r\n\tvar xhr = new XMLHttpRequest();\r\n\r\n\txhr.upload.addEventListener(\"progress\", function(e) {\r\n\t\t_this.progressBar.progressbar('option', 'value', e.loaded / e.total * 100);\r\n\t}, false);\r\n\r\n\txhr.open('POST', window.serverBase + 'FileBrowser/Upload.ashx');\r\n\txhr.withCredentials = true;\r\n\txhr.onload = function () {\r\n\t\t_this.progressBar.hide();\r\n\t\tif (xhr.status === 200) {\r\n\t\t\tlet response = JSON.parse(xhr.responseText);\r\n\r\n\t\t\tif (!parseResponse(response))\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif (typeof response.Result == 'string') {\r\n\t\t\t\tvar indexSlash = String(response.Result).lastIndexOf(_this.slash),\r\n\t\t\t\t\tfileName = String(response.Result).substring(indexSlash + 1, response.Result.length);\r\n\r\n\t\t\t\t_this.shownPath = fileName;\r\n\t\t\t}\r\n\r\n\t\t\t_this.getFiles();\r\n\t\t}\r\n\t};\r\n\r\n\txhr.send(formData);\r\n}\r\n\r\nfileBrowser.prototype.loadInfoHandler = function()\r\n{\r\n\tvar _this = this;\r\n\tif (!this._path.isInited())\r\n\t{\r\n\t\tvar mapFolder = _layersTree.treeModel.getMapProperties().LayersDir;\r\n\t\tif (mapFolder) {\r\n\t\t\tthis._path.set(_layersTree.treeModel.getMapProperties().LayersDir, nsGmx.AuthManager.getUserFolder());\r\n\t\t} else {\r\n\t\t\tthis._path.set(nsGmx.AuthManager.getUserFolder());\r\n\t\t}\r\n\t}\r\n\r\n\tthis.currentSortFunc = this.sortFuncs['name'][0];\r\n\r\n\tthis.fileUpload = _div(null, [['dir','className','fileUpload']]);\r\n\tthis.fileHeader = _div(null, [['css','height','24px']]);\r\n\tthis.fileCanvas = _div(null, [['dir','className','fileCanvas']]);\r\n\r\n\t$(this.parentCanvas).bind('dragover', function()\r\n\t{\r\n\t\treturn false;\r\n\t});\r\n\r\n\t$(this.parentCanvas).bind('drop', function(e)\r\n\t{\r\n\t\tif (!window.FormData) return false;\r\n\r\n\t\tvar files = e.originalEvent.dataTransfer.files;\r\n\t\tvar formData = new FormData();\r\n\r\n\t\tvar totalSize = 0;\r\n\t\tfor (let f = 0; f < files.length; f++) {\r\n\t\t\ttotalSize += files[f].size;\r\n\t\t}\r\n\r\n\t\tif (totalSize > fileBrowser.MAX_UPLOAD_SIZE) {\r\n\t\t\t_this._showWarningDialog();\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tfor (let f = 0; f < files.length; f++) {\r\n\t\t\tformData.append('rawdata', files[f]);\r\n\t\t}\r\n\r\n\t\tformData.append('ParentDir', _this._path.get());\r\n\r\n\t\t_this._uploadFilesAjax(formData);\r\n\r\n\t\treturn false;\r\n\t})\r\n\r\n\t_(this.parentCanvas, [this.fileHeader, this.fileCanvas, this.fileUpload]);\r\n\r\n\tthis.createHeader();\r\n\tthis.createUpload();\r\n\r\n\tthis._updateUploadVisibility();\r\n\r\n\tthis.getFiles();\r\n}\r\n\r\nfileBrowser.prototype._updateUploadVisibility = function()\r\n{\r\n\t$([this.fileUpload, this.tdAddFolder]).toggle(nsGmx.AuthManager.isRole(nsGmx.ROLE_ADMIN) || this._path.isInHome())\r\n}\r\n\r\nfileBrowser.prototype.createHeader = function()\r\n{\r\n\tvar reloadButton = makeImageButton(\"img/reload.png\"),\r\n\t\thomeButton = makeImageButton(\"img/home.png\"),\r\n\t\tdiscButtonTds = [],\r\n\t\t_this = this;\r\n\r\n\treloadButton.style.margin = '0px 5px 0px 10px';\r\n\thomeButton.style.margin = '0px 10px 0px 5px';\r\n\r\n\treloadButton.style.width = '14px';\r\n\treloadButton.style.height = '15px';\r\n\thomeButton.style.width = '15px';\r\n\thomeButton.style.height = '15px';\r\n\r\n\t_title(reloadButton, _gtxt(\"Обновить\"));\r\n\t_title(homeButton, _gtxt(\"Домашняя директория\"));\r\n\r\n\treloadButton.onclick = function()\r\n\t{\r\n\t\t_this.getFiles();\r\n\t}\r\n\r\n\thomeButton.onclick = function()\r\n\t{\r\n\t\t_this._path.set(_layersTree.treeModel.getMapProperties().LayersDir, _this._homeDir);\r\n\t\t_this.getFiles(_layersTree.treeModel.getMapProperties().LayersDir);\r\n\t}\r\n\r\n\t//if ( nsGmx.AuthManager.canDoAction(nsGmx.ACTION_SEE_FILE_STRUCTURE ) )\r\n\t//{\r\n\t\tfor (var i = 0; i < this._discs.length; i++)\r\n\t\t{\r\n\t\t\tvar discButtons = makeButton(this._discs[i]);\r\n\r\n\t\t\t(function(i)\r\n\t\t\t{\r\n\t\t\t\tdiscButtons.onclick = function()\r\n\t\t\t\t{\r\n\t\t\t\t\t_this.getFiles(_this._discs[i])\r\n\t\t\t\t}\r\n\t\t\t})(i)\r\n\r\n\t\t\tdiscButtonTds.push(_td([discButtons]))\r\n\t\t}\r\n\t//}\r\n\r\n\tdiscButtonTds.push(_td([reloadButton], [['attr','vAlign','top']]));\r\n\tdiscButtonTds.push(_td([homeButton], [['attr','vAlign','top']]));\r\n\r\n\tvar newFolderName = _input(null, [['dir','className','inputStyle'], ['css','width','150px']]),\r\n\t\tshowFolderButton = makeImageButton(\"img/newfolder.png\"),\r\n\t\tnewFolderButton = makeButton(_gtxt(\"Создать\")),\r\n\t\tcreateFolder = function()\r\n\t\t{\r\n\t\t\t_this._status.start();\r\n\t\t\tsendCrossDomainJSONRequest(window.serverBase + 'FileBrowser/CreateFolder.ashx?WrapStyle=func&FullName=' + encodeURIComponent(_this._path.get() + newFolderName.value), function(response)\r\n\t\t\t{\r\n\t\t\t\t_this._status.stop();\r\n\t\t\t\tif (!parseResponse(response))\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t_this.shownPath = newFolderName.value;\r\n\r\n\t\t\t\tnewFolderName.value = '';\r\n\r\n\t\t\t\t_this.getFiles();\r\n\t\t\t})\r\n\t\t};\r\n\r\n\tshowFolderButton.style.width = '16px';\r\n\tshowFolderButton.style.height = '13px';\r\n\r\n\tnewFolderName.style.margin = '0px 3px';\r\n\r\n\t_title(showFolderButton, _gtxt(\"Новая папка\"))\r\n\r\n\tshowFolderButton.style.marginRight = '10px';\r\n\r\n\tshowFolderButton.onclick = function()\r\n\t{\r\n\t\t$(newFolderName).toggle().focus();\r\n\t\t$(newFolderButton).toggle();\r\n\t}\r\n\r\n\tnewFolderName.style.display = 'none';\r\n\tnewFolderButton.style.display = 'none';\r\n\r\n\t$(newFolderName).on('keydown', function(e)\r\n\t{\r\n\t\tif (e.keyCode === 13)\r\n\t  \t{\r\n\t  \t\tif (newFolderName.value != '')\r\n\t\t\t\tcreateFolder();\r\n\t\t\telse\r\n\t\t\t\tinputError(newFolderName);\r\n\r\n\t  \t\treturn false;\r\n\t  \t}\r\n\t});\r\n\r\n\tnewFolderButton.onclick = function()\r\n\t{\r\n\t\tif (newFolderName.value != '')\r\n\t\t\tcreateFolder();\r\n\t\telse\r\n\t\t\tinputError(newFolderName);\r\n\t}\r\n\r\n\tthis.tdAddFolder = _td([_table([_tbody([_tr([\r\n\t\t\t_td([showFolderButton], [['attr','vAlign','top']]),\r\n\t\t\t_td([newFolderName]),\r\n\t\t\t_td([newFolderButton])]\r\n\t\t)])])], [['attr','vAlign','top'], ['css','height','20px']]);\r\n\r\n\tdiscButtonTds.push(this.tdAddFolder);\r\n\r\n\t_(this.fileHeader, [_table([_tbody([_tr(discButtonTds)])])]);\r\n}\r\n\r\nfileBrowser.prototype.createUpload = function()\r\n{\r\n\tvar div = _div(null, [['css','height','30px']]),\r\n\t\t_this = this;\r\n\r\n\tvar formFile = _form(null,[['attr','enctype','multipart/form-data'],['dir','method','post'],['dir','action', window.serverBase + 'FileBrowser/Upload.ashx?WrapStyle=message'],['attr','target','fileBrowserUpload_iframe']]);\r\n\r\n\tvar attach = _input(null,[['attr','type','file'],['dir','name','rawdata'],['css','width','200px'], ['attr','multiple','multiple']]);\r\n\t_(formFile, [attach]);\r\n\r\n\tattach.onchange = function()\r\n\t{\r\n\t\tif (attach.files && attach.files[0] && attach.files[0].size > fileBrowser.MAX_UPLOAD_SIZE) {\r\n\t\t\t_this._showWarningDialog();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//если можем послать через AJAX, посылаем - будет работать прогресс-бар\r\n\t\tif (window.FormData) {\r\n\t\t\tvar formData = new FormData(formFile);\r\n\t\t\tformData.append('ParentDir', _this._path.get());\r\n\t\t\t_this._uploadFilesAjax(formData);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsendCrossDomainPostRequest(window.serverBase + 'FileBrowser/Upload.ashx',\r\n\t\t\t{\r\n\t\t\t\tWrapStyle: 'message',\r\n\t\t\t\tParentDir: _this._path.get()\r\n\t\t\t},\r\n\t\t\tfunction(response) {\r\n\t\t\t\tif (!parseResponse(response))\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tvar indexSlash = String(response.Result).lastIndexOf(_this.slash),\r\n\t\t\t\t\tfileName = String(response.Result).substring(indexSlash + 1, response.Result.length);\r\n\r\n\t\t\t\t_this.shownPath = fileName;\r\n\r\n\t\t\t\t_this.getFiles();\r\n\t\t\t},\r\n\t\t\tformFile\r\n\t\t);\r\n\t}\r\n\r\n\tvar dropInfoDiv = window.FormData ? _div([_t(_gtxt('FileBrowser.DropInfo'))], [['dir', 'className', 'fileBrowser-dragFileMessage']]) : _div();\r\n\r\n\t_(div, [\r\n\t\tdropInfoDiv,\r\n\t\t_table([_tbody([_tr([\r\n\t\t\t_td([formFile], [['css', 'paddingTop', '18px']])\r\n\t\t])])])\r\n\t]);\r\n\r\n\tthis.progressBar = $('<div/>').addClass('fileBrowser-progressBar').progressbar({value: 100}).hide();\r\n\r\n\t_(this.fileUpload, [this.progressBar[0], div]);\r\n}\r\n\r\nfileBrowser.prototype.getFiles = function(path)\r\n{\r\n\tpath = (typeof path != 'undefined') ? path : this._path.get();\r\n\tvar alternativePath = this._path.getAlternative();\r\n\tvar _this = this;\r\n\r\n\tif (this._isRestrictedPath(path))\r\n\t\treturn;\r\n\r\n\tvar doProcessResponce = function(response) {\r\n\t\t_this._status.stop();\r\n\r\n\t\tif (!parseResponse(response))\r\n\t\t\treturn;\r\n\r\n\t\t_this.getFilesHandler(response.Result, path);\r\n\t}\r\n\r\n\tthis._status.start();\r\n\tsendCrossDomainJSONRequest(window.serverBase + \"FileBrowser/GetDirectoryContent.ashx?WrapStyle=func&root=\" + encodeURIComponent(path), function(response)\r\n\t{\r\n\t\tif (response.Status !== 'ok' && alternativePath) {\r\n\t\t\tpath = alternativePath;\r\n\t\t\t_this._path.set(alternativePath);\r\n\t\t\tsendCrossDomainJSONRequest(window.serverBase + \"FileBrowser/GetDirectoryContent.ashx?WrapStyle=func&root=\" + encodeURIComponent(alternativePath), doProcessResponce);\r\n\t\t} else {\r\n\t\t\tdoProcessResponce(response);\r\n\t\t}\r\n\t})\r\n}\r\n\r\nfileBrowser.prototype.getFilesHandler = function(files, path)\r\n{\r\n\tthis._path.set(path);\r\n\tthis.currentFiles = files;\r\n\r\n\tthis._updateUploadVisibility();\r\n\r\n\tthis.reloadFiles();\r\n}\r\n\r\nfileBrowser.prototype.pathWidget = function()\r\n{\r\n\tvar shortPath = this._path.get();\r\n\tvar _this = this;\r\n\r\n\tvar parent = $('<span/>', {'class': 'fileBrowser-pathWidget'});\r\n\tvar pathElements = [];\r\n\r\n\tvar highlightPath = function(index)\r\n\t{\r\n\t\tfor (var e = 0; e < pathElements.length; e++)\r\n\t\t\tif (e <= index)\r\n\t\t\t\tpathElements[e].addClass('fileBrowser-activePathElem');\r\n\t\t\telse\r\n\t\t\t\tpathElements[e].removeClass('fileBrowser-activePathElem');\r\n\t}\r\n\r\n\tvar appendElem = function(text, path){\r\n\t\tvar elemIndex = pathElements.length;\r\n\t\tvar newElem = $('<span/>', {'class': 'fileBrowser-pathElem'}).text(text + _this.slash)\r\n\t\t.click(function()\r\n\t\t{\r\n\t\t\t_this.getFiles(path[path.legnth - 1] === _this.slash ? path : path  + _this.slash);\r\n\t\t})\r\n\t\t.hover(function(){highlightPath(elemIndex)}, function(){highlightPath(-1)});\r\n\r\n\t\tpathElements.push(newElem);\r\n\t\tparent.append(newElem);//.append( $('<span/>').text(_this.slash) );\r\n\t}\r\n\r\n\tvar curFolder = '';\r\n\twhile (shortPath.length)\r\n\t{\r\n\t\tvar index = shortPath.indexOf(this.slash);\r\n\t\tif (index == 0) break;\r\n\r\n\t\tif (index < 0)\r\n\t\t{\r\n\t\t\tappendElem(shortPath, curFolder + shortPath);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tvar curText = shortPath.substr(0, index);\r\n\t\tcurFolder += curText + this.slash;\r\n\t\tshortPath = shortPath.substr(index+1);\r\n\r\n\t\tappendElem(curText, curFolder.substr(0, curFolder.length-1));\r\n\t}\r\n\r\n\treturn parent[0];\r\n}\r\n\r\nfileBrowser.prototype.quickSearch = function()\r\n{\r\n\tvar input = _input(null, [['dir','className','inputStyle'],['css','width','200px']]),\r\n\t\t_this = this;\r\n\r\n\tinput.onkeyup = function()\r\n\t{\r\n\t\tif (this.value != \"\")\r\n\t\t{\r\n\t\t\tvar scroll = _this.findContent(this.value);\r\n\r\n\t\t\tif (scroll >= 0)\r\n\t\t\t\t_this.fileCanvas.lastChild.scrollTop = scroll;\r\n\t\t}\r\n\t}\r\n\r\n\treturn input;\r\n}\r\n\r\nfileBrowser.prototype.findContent = function(value)\r\n{\r\n\tvar tbody = this.fileCanvas.lastChild.firstChild.lastChild;\r\n\r\n\tfor (var i = 0; i < tbody.childNodes.length; ++i)\r\n\t{\r\n\t\tvar text = tbody.childNodes[i].textContent.toLowerCase();\r\n\r\n\t\tif (text != \"[..]\" && text.indexOf(value.toLowerCase()) == 0)\r\n\t\t\treturn tbody.childNodes[i].offsetTop;\r\n\t}\r\n\r\n\treturn -1;\r\n}\r\n\r\nfileBrowser.prototype.reloadFiles = function()\r\n{\r\n\t$(this.fileCanvas).empty();\r\n\r\n\tthis.statusContainer = _div(null, [['dir', 'className', 'fileBrowser-progress'], ['css', 'display', 'none']]);\r\n\r\n\t_(this.fileCanvas, [_div([this.pathWidget(), _br(), _t(_gtxt(\"Фильтр\")), this.quickSearch(), this.statusContainer], [['dir','className','currentDir'],['css','color','#153069'],['css','fontSize','12px']])]);\r\n\r\n\t_(this.fileCanvas, [this.draw(this.currentFiles)]);\r\n\r\n\tthis.resize();\r\n\r\n\tif (this.shownPathScroll)\r\n\t{\r\n\t\tthis.fileCanvas.lastChild.scrollTop = this.shownPathScroll.offsetTop;\r\n\r\n\t\tthis.shownPathScroll = false;\r\n\t}\r\n}\r\n\r\nfileBrowser.prototype._getParentFolder = function(path)\r\n{\r\n\tvar index = String(path).lastIndexOf(this.slash),\r\n\t\tnewPath = String(path).substr(0, index);\r\n\r\n\tif (new RegExp('^[a-z]:$','i').test(newPath))\r\n\t\tnewPath += this.slash;\r\n\r\n\treturn newPath;\r\n}\r\n\r\nfileBrowser.prototype._isRestrictedPath = function(path)\r\n{\r\n\treturn this._params.restrictDir !== null && path.indexOf(this._params.restrictDir) != 0;\r\n}\r\n\r\nfileBrowser.prototype.draw = function(files)\r\n{\r\n\tvar nameSort = makeLinkButton(_gtxt(\"Имя\")),\r\n\t\textSort = makeLinkButton(_gtxt(\"Тип\")),\r\n\t\tsizeSort = makeLinkButton(_gtxt(\"Размер\")),\r\n\t\tdateSort = makeLinkButton(_gtxt(\"Дата\")),\r\n\t\t_this = this;\r\n\r\n\tnameSort.sortType = 'name';\r\n\textSort.sortType = 'ext';\r\n\tsizeSort.sortType = 'size';\r\n\tdateSort.sortType = 'date';\r\n\r\n\tnameSort.onclick = extSort.onclick = sizeSort.onclick = dateSort.onclick = function()\r\n\t{\r\n\t\t_this.currentSortType = this.sortType;\r\n\t\t_this.currentSortIndex[_this.currentSortType] = 1 - _this.currentSortIndex[_this.currentSortType];\r\n\r\n\t\t_this.reloadFiles();\r\n\t}\r\n\r\n\tvar tdRoot = _td(null, [['css','width','20px']]);\r\n\r\n\tif ( nsGmx.AuthManager.canDoAction(nsGmx.ACTION_SEE_FILE_STRUCTURE ) )\r\n\t{\r\n\t\tvar rootButton = makeButton(this.slash);\r\n\r\n\t\t_(tdRoot, [rootButton]);\r\n\r\n\t\trootButton.onclick = function()\r\n\t\t{\r\n\t\t\t_this.getFiles(_this._path.getRoot());\r\n\t\t}\r\n\t}\r\n\r\n\tvar tableHeaderTr = _tr([tdRoot, _td([nameSort],[['css','textAlign','left']]), _td([extSort], [['css','width','10%'],['css','textAlign','center']]), _td([sizeSort], [['css','width','15%'],['css','textAlign','center']]), _td([dateSort], [['css','width','25%'],['css','textAlign','center']])]),\r\n\t\tprevDirTr = _tr([_td(), _td([_t(\"[..]\")]), _td(), _td(), _td()]),\r\n\t\ttableFilesTrs = [];\r\n\r\n\tvar parentFolder = _this._path.getParentFolder();\r\n\tif (parentFolder && !this._isRestrictedPath(parentFolder))\r\n\t{\r\n\t\ttableFilesTrs.push(prevDirTr)\r\n\r\n\t\tattachEffects(prevDirTr, 'hover')\r\n\r\n\t\tprevDirTr.onclick = function()\r\n\t\t{\r\n\t\t\t_this.getFiles(parentFolder);\r\n\t\t}\r\n\t}\r\n\r\n\ttableFilesTrs = tableFilesTrs.concat(this.drawFolders(files));\r\n\ttableFilesTrs = tableFilesTrs.concat(this.drawFiles(files));\r\n\r\n\treturn _div([_table([_thead([tableHeaderTr]), _tbody(tableFilesTrs)], [['css','width','100%']])], [['css','overflowY','scroll']]);\r\n}\r\n\r\nfileBrowser.prototype.getCurrentSortFunc = function()\r\n{\r\n\treturn this.sortFuncs[this.currentSortType][this.currentSortIndex[this.currentSortType]];\r\n}\r\n\r\nfileBrowser.prototype.formatDate = function(sec)\r\n{\r\n\tvar sysDate = new Date(sec * 1000),\r\n\t\tdate = new Array(6);\r\n\r\n\tdate[0] = sysDate.getDate(),\r\n\tdate[1] = sysDate.getMonth() + 1,\r\n\tdate[2] = sysDate.getFullYear(),\r\n\tdate[3] = sysDate.getHours(),\r\n\tdate[4] = sysDate.getMinutes(),\r\n\tdate[5] = sysDate.getSeconds();\r\n\r\n\tfor (let i = 0; i < 6; i++) {\r\n\t\tif (date[i] < 10)\r\n\t\t\tdate[i] = '0' + date[i];\r\n\t}\r\n\r\n\treturn date[0] + '.' + date[1] + '.' + date[2] + ' ' + date[3] + ':' + date[4] + ':' + date[5];\r\n}\r\n\r\nfileBrowser.prototype.drawFolders = function(arr)\r\n{\r\n\tvar folders = [],\r\n\t\ttrs = [],\r\n\t\t_this = this;\r\n\r\n\tfor (let i = 0; i < arr.length; i++) {\r\n\t\tif (arr[i].Directory)\r\n\t\t\tfolders.push(arr[i]);\r\n\t}\r\n\r\n\tif (this.currentSortType == 'name' || this.currentSortType == 'date')\r\n\t\tfolders = folders.sort(this.getCurrentSortFunc());\r\n\r\n\tfor (let i = 0; i < folders.length; i++)\r\n\t{\r\n\t\tvar tdReturn = _td();\r\n\r\n\t\tif (!this.returnMask.length)\r\n\t\t{\r\n\t\t\tvar returnButton = makeImageButton(\"img/choose.png\", \"img/choose_a.png\");\r\n\t\t\treturnButton.style.cursor = 'pointer';\r\n\t\t\treturnButton.style.marginLeft = '5px';\r\n\r\n\t\t\t_title(returnButton, _gtxt(\"Выбрать\"));\r\n\r\n\t\t\t(function(i){\r\n\t\t\t\treturnButton.onclick = function()\r\n\t\t\t\t{\r\n\t\t\t\t\t_this.close(_this._path.get() + folders[i].Name + _this.slash);\r\n\t\t\t\t}\r\n\t\t\t})(i);\r\n\r\n\t\t\t_(tdReturn, [returnButton])\r\n\t\t}\r\n\r\n\t\tvar tr = _tr([\r\n\t\t\ttdReturn,\r\n\t\t\t_td([_div(null, [['dir','className','fileCanvas-folder-icon']]), this.createFolderActions(folders[i].Name)]),\r\n\t\t\t_td(),\r\n\t\t\t_td([_t(_gtxt(\"Папка\"))],[['css','textAlign','center'],['dir','className','invisible']]),\r\n\t\t\t_td([_t(this.formatDate(folders[i].Date))],[['css','textAlign','center'],['dir','className','invisible']])\r\n\t\t]);\r\n\r\n\t\t(function(i){\r\n\t\t\ttr.onclick = function()\r\n\t\t\t{\r\n\t\t\t\t_this.getFiles(_this._path.get() + folders[i].Name);\r\n\t\t\t}\r\n\t\t})(i);\r\n\r\n\t\tattachEffects(tr, 'hover');\r\n\r\n\t\tif (this.shownPath && folders[i].Name == this.shownPath)\r\n\t\t{\r\n\t\t\t$(tr).children(\"td\").css('backgroundColor', '#CEEECE');\r\n\r\n\t\t\tthis.shownPath = null;\r\n\r\n\t\t\tthis.shownPathScroll = tr;\r\n\t\t}\r\n\r\n\t\ttrs.push(tr)\r\n\t}\r\n\r\n\treturn trs;\r\n}\r\n\r\nfileBrowser.prototype.drawFiles = function(arr)\r\n{\r\n\tvar files = [],\r\n\t\ttrs = [],\r\n\t\t_this = this;\r\n\r\n\tfor (let i = 0; i < arr.length; i++)\r\n\t\tif (!arr[i].Directory)\r\n\t\t\tfiles.push(arr[i]);\r\n\r\n\tfiles = files.sort(this.getCurrentSortFunc());\r\n\r\n\tfor (let i = 0; i < files.length; i++)\r\n\t{\r\n\t\tvar index = String(files[i].Name).lastIndexOf('.'),\r\n\t\t\tname = String(files[i].Name).substr(0, index),\r\n\t\t\text = String(files[i].Name).substr(index + 1, files[i].Name.length),\r\n\t\t\ttdReturn = _td(),\r\n\t\t\ttdSize = _td([_t(this.makeSize(files[i].Size))], [['attr','size',files[i].Size],['css','textAlign','right'],['dir','className','invisible']]);\r\n\r\n\t\tif (this.returnMask.length && valueInArray(this.returnMask, ext.toLowerCase()))\r\n\t\t{\r\n\t\t\tvar returnButton = makeImageButton(\"img/choose.png\", \"img/choose_a.png\");\r\n\t\t\treturnButton.style.cursor = 'pointer';\r\n\t\t\treturnButton.style.marginLeft = '5px';\r\n\r\n\t\t\t_title(returnButton, _gtxt(\"Выбрать\"));\r\n\r\n\t\t\t(function(i){\r\n\t\t\t\treturnButton.onclick = function()\r\n\t\t\t\t{\r\n\t\t\t\t\t_this.close(_this._path.get() + files[i].Name);\r\n\t\t\t\t}\r\n\t\t\t})(i);\r\n\r\n\t\t\t_(tdReturn, [returnButton])\r\n\t\t}\r\n\r\n\t\tvar\ttr = _tr([tdReturn, _td([this.createFileActions(name, ext)]), _td([_t(ext)],[['css','textAlign','right'],['css','fontSize','12px']]), tdSize, _td([_t(this.formatDate(files[i].Date))],[['css','textAlign','center'],['dir','className','invisible']])]);\r\n\r\n\t\tattachEffects(tr, 'hover');\r\n\r\n\t\tif (this.shownPath && files[i].Name == this.shownPath)\r\n\t\t{\r\n\t\t\t$(tr).children(\"td\").css('backgroundColor', '#CEEECE');\r\n\r\n\t\t\tthis.shownPath = null;\r\n\r\n\t\t\tthis.shownPathScroll = tr;\r\n\t\t}\r\n\r\n\t\ttrs.push(tr);\r\n\t}\r\n\r\n\treturn trs;\r\n}\r\n\r\nfileBrowser.prototype.createFolderActions = function(name)\r\n{\r\n\tvar span = _span([_t(name)],[['css','fontSize','12px']]),\r\n\t\tspanParent = _div([span],[['css','display', 'inline-block'],['css','position','relative']]),\r\n\t\t_this = this;\r\n\r\n\tnsGmx.ContextMenuController.bindMenuToElem(spanParent, 'FileBrowserFolder',\r\n\t\tfunction()\r\n\t\t{\r\n\t\t\treturn _this._path.isInHome() || nsGmx.AuthManager.canDoAction( nsGmx.ACTION_SEE_FILE_STRUCTURE );\r\n\t\t},\r\n\t\t{\r\n\t\t\tfullPath: this._path.get() + name + this.slash,\r\n\t\t\tfileBrowser: this,\r\n\t\t\tenableZip: true\r\n\t\t}\r\n\t);\r\n\r\n\treturn spanParent;\r\n}\r\n\r\nfileBrowser.prototype.createFileActions = function(name, ext)\r\n{\r\n\tvar span = _span([_t(name)],[['css','fontSize','12px']]),\r\n\t\tspanParent = _div([span],[['css','display','inline-block'],['css','position','relative']]),\r\n\t\t_this = this;\r\n\r\n\tnsGmx.ContextMenuController.bindMenuToElem(spanParent, 'FileBrowserFile',\r\n\t\tfunction()\r\n\t\t{\r\n\t\t\treturn _this._path.isInHome() || nsGmx.AuthManager.canDoAction( nsGmx.ACTION_SEE_FILE_STRUCTURE );\r\n\t\t},\r\n\t\t{\r\n\t\t\tfullPath: this._path.get() + name + '.' + ext,\r\n\t\t\tfileBrowser: this,\r\n\t\t\tenableUnzip: valueInArray(_this.ext7z, ext.toUpperCase())\r\n\t\t}\r\n\t);\r\n\r\n\treturn spanParent;\r\n}\r\n\r\n//TODO: translate\r\nfileBrowser.prototype.makeSize = function(size)\r\n{\r\n\tif (size > 1024 * 1024 * 1024)\r\n\t\treturn (size / (1024 * 1024 * 1024)).toFixed(2) + ' Гб';\r\n\telse if (size > 1024 * 1024)\r\n\t\treturn (size / (1024 * 1024)).toFixed(2) + ' Мб';\r\n\telse if (size > 1024)\r\n\t\treturn (size / 1024).toFixed(2) + ' Кб';\r\n\r\n\treturn size + ' б';\r\n}\r\n\r\nwindow.fileBrowser = fileBrowser;\r\nwindow._fileBrowser = new fileBrowser();\r\n\r\n///////////////////////////////////////////////////////////////////////////////\r\n////////////////////////// Контекстное меню браузера //////////////////////////\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\n//фабрика, которая может возвращать элементы меню для архивирования (isZip=true) и разархивирования (isZip=false)\r\nvar zipUnzipActionFactory = function(isZip)\r\n{\r\n\treturn {\r\n\t\ttitle:  function() { return isZip ? _gtxt(\"Упаковать\") : _gtxt(\"Извлечь\"); },\r\n\t\tclickCallback: function(context)\r\n\t\t{\r\n\t\t\tcontext.fileBrowser._status.start();\r\n\t\t\tsendCrossDomainJSONRequest(window.serverBase + (context.enableUnzip ? 'FileBrowser/Unzip.ashx' : 'FileBrowser/Zip.ashx') + '?WrapStyle=func&FullName=' + encodeURIComponent(context.fullPath), function(response)\r\n\t\t\t{\r\n\t\t\t\tcontext.fileBrowser._status.stop();\r\n\r\n\t\t\t\tif (!parseResponse(response))\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tvar indexSlash = String(response.Result).lastIndexOf('\\\\'),\r\n\t\t\t\t\tfileName = String(response.Result).substring(indexSlash + 1, response.Result.length);\r\n\r\n\t\t\t\tcontext.fileBrowser.shownPath = fileName;\r\n\r\n\t\t\t\tcontext.fileBrowser.getFiles();\r\n\t\t\t})\r\n\t\t},\r\n\t\tisVisible: function(context)\r\n\t\t{\r\n\t\t\treturn isZip ? !context.enableUnzip : context.enableUnzip; //XOR\r\n\t\t}\r\n\t}\r\n}\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Скачать\"); },\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tvar form = _form([_input(null,[['attr','name','FullName'], ['attr','value', context.fullPath]])], [['css','display','none'],['attr','method','POST'],['attr','action',window.serverBase + \"FileBrowser/Download.ashx\"]]);\r\n\r\n\t\t_(document.body, [form]);\r\n\r\n\t\tform.submit();\r\n\r\n\t\tform.removeNode(true);\r\n\t}\r\n}, ['FileBrowserFolder', 'FileBrowserFile']);\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Удалить\"); },\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tcontext.fileBrowser._status.start();\r\n\t\tsendCrossDomainJSONRequest(window.serverBase + 'FileBrowser/Delete.ashx?WrapStyle=func&FullName=' + encodeURIComponent(context.fullPath), function(response)\r\n\t\t{\r\n\t\t\tcontext.fileBrowser._status.stop();\r\n\t\t\tif (!parseResponse(response))\r\n\t\t\t\treturn;\r\n\r\n\t\t\tcontext.fileBrowser.getFiles();\r\n\t\t})\r\n\t}\r\n}, ['FileBrowserFolder', 'FileBrowserFile']);\r\n\r\nnsGmx.ContextMenuController.addContextMenuElem({\r\n\ttitle: function() { return _gtxt(\"Очистить\"); },\r\n\tclickCallback: function(context)\r\n\t{\r\n\t\tcontext.fileBrowser._status.start();\r\n\t\tsendCrossDomainJSONRequest(window.serverBase + 'FileBrowser/CleanFolder.ashx?WrapStyle=func&FullName=' + encodeURIComponent(context.fullPath), function(response)\r\n\t\t{\r\n\t\t\tcontext.fileBrowser._status.stop();\r\n\t\t\tif (!parseResponse(response))\r\n\t\t\t\treturn;\r\n\r\n\t\t\tcontext.fileBrowser.getFiles();\r\n\t\t})\r\n\t}\r\n}, 'FileBrowserFolder');\r\n\r\n//упаковываем и файлы и папки\r\nnsGmx.ContextMenuController.addContextMenuElem(zipUnzipActionFactory(true), ['FileBrowserFolder', 'FileBrowserFile']);\r\n\r\n//распаковываем только файлы\r\nnsGmx.ContextMenuController.addContextMenuElem(zipUnzipActionFactory(false), 'FileBrowserFile');\r\n\r\nexport default window._fileBrowser;","﻿import nsGmx from './nsGmx.js';\r\nimport {\r\n    attachEffects,\r\n    _div,\r\n    _input,    \r\n    makeImageButton,\r\n    parseResponse,\r\n    sendCrossDomainJSONRequest,\r\n    showDialog,\r\n    _t,\r\n    _title,\r\n    _td,\r\n    _tr,\r\n} from './utilities.js';\r\nwindow._translationsHash.addtext(\"rus\", {\r\n    \"tableBrowser.title\" : \"Список таблиц\",\r\n    \"tableBrowser.filterText\" : \"Фильтр по названию\"\r\n});\r\n                         \r\nwindow._translationsHash.addtext(\"eng\", {\r\n    \"tableBrowser.title\" : \"Tables list\",\r\n    \"tableBrowser.filterText\" : \"Filter by name\"\r\n});\r\n\r\nvar tableBrowser = function()\r\n{\r\n\tthis.sortFuncs = \r\n\t{\r\n\t\tname:[\r\n\t\t\tfunction(_a,_b){var a = String(_a).toLowerCase(), b = String(_b).toLowerCase(); if (a > b) return 1; else if (a < b) return -1; else return 0},\r\n\t\t\tfunction(_a,_b){var a = String(_a).toLowerCase(), b = String(_b).toLowerCase(); if (a < b) return 1; else if (a > b) return -1; else return 0}\r\n\t\t]\r\n\t};\r\n\t\r\n\tthis.tables = [];\r\n}\r\n\r\ntableBrowser.prototype.createBrowser = function(closeFunc)\r\n{\r\n    var canvas = $('#tableBrowserDialog');\r\n    \r\n\tif (canvas)\r\n\t{\r\n\t\tcanvas.parent().dialog(\"destroy\");\r\n\t\t\r\n\t\tcanvas.parent().remove();\r\n\t}\r\n\t\t\r\n\tthis.closeFunc = closeFunc;\r\n\t\r\n\tif (!this.tables.length)\r\n\t\tthis.loadInfo();\r\n\telse\r\n\t\tthis.loadInfoHandler(this.tables)\r\n}\r\n\r\ntableBrowser.prototype.close = function(name)\r\n{\r\n\tthis.closeFunc(name);\r\n\t\r\n\tvar canvas = $('#tableBrowserDialog');\r\n\t\r\n\t$(canvas).parent().dialog(\"destroy\");\r\n\t\r\n\t$(canvas).parent().remove();\r\n}\r\n\r\ntableBrowser.prototype.loadInfo = function()\r\n{\r\n\tsendCrossDomainJSONRequest(window.serverBase + \"VectorLayer/GetGeometryTables.ashx?WrapStyle=func\", function(response)\r\n\t{\r\n\t\tif (!parseResponse(response))\r\n\t\t\treturn;\r\n\t\t\r\n\t\t_tableBrowser.loadInfoHandler(response.Result)\r\n\t})\r\n}\r\n\r\ntableBrowser.prototype.loadInfoHandler = function(tables)\r\n{\r\n\tthis.tables = tables;\r\n    \r\n    var _this = this;\r\n    var renderTableRow = function(table)\r\n    {\r\n        var\ttdName = _td([_t(table)],[['css','fontSize','12px']]),\r\n\t\t\treturnButton = makeImageButton(\"img/choose.png\", \"img/choose_a.png\"),\r\n\t\t\ttr = _tr([_td([returnButton]), tdName], [['dir', 'className', 'tableTableRow']]);\r\n\t\t\r\n\t\treturnButton.style.cursor = 'pointer';\r\n\t\treturnButton.style.marginLeft = '5px';\r\n\t\r\n\t\t_title(returnButton, _gtxt(\"Выбрать\"));\r\n\t\t\t\r\n        returnButton.onclick = function()\r\n        {\r\n            _this.close(table);\r\n        }\r\n\t\t\r\n\t\tattachEffects(tr, 'hover');\r\n        \r\n        for (var i = 0; i < tr.childNodes.length; i++)\r\n            tr.childNodes[i].style.width = this._fields[i].width;\r\n        \r\n        return tr;\r\n    }\r\n    \r\n    var sortFuncs = {};\r\n    sortFuncs[_gtxt('Имя')] = this.sortFuncs['name'];\r\n    \r\n    var tableProvider = new nsGmx.ScrollTable.StaticDataProvider();\r\n    tableProvider.setOriginalItems(this.tables);\r\n    tableProvider.setSortFunctions(sortFuncs);\r\n    \r\n    var tableTable = new nsGmx.ScrollTable({limit:5000, pagesCount: 5, height: 220, showFooter: false});\r\n    tableTable.setDataProvider(tableProvider);\r\n    \r\n    var tableParent = _div(null, [['dir', 'id', 'tableBrowserDialog']]);\r\n    tableTable.createTable({\r\n        parent: tableParent, \r\n        name: 'tableTable', \r\n        width: 0, \r\n        fields: ['', _gtxt('Имя')], \r\n        fieldsWidths: ['10%', '90%'], \r\n        sortableFields: sortFuncs,\r\n        drawFunc: renderTableRow, \r\n        isWidthScroll: false\r\n    });\r\n    \r\n    var filterInput = _input(null, [['css','width','150px'],['dir','className','selectStyle']]);\r\n    $(tableParent).prepend(filterInput).prepend($('<span/>', {'class': 'tableFilter'}).text(_gtxt(\"tableBrowser.filterText\") + \": \"));\r\n    tableProvider.attachFilterEvents(filterInput, 'Table', function(fieldName, fieldValue, vals)\r\n    {\r\n        return vals.filter(function(val) {\r\n            return String(val).toLowerCase().indexOf(fieldValue.toLowerCase()) > -1;\r\n        });\r\n    });\r\n    \r\n    showDialog( _gtxt(\"tableBrowser.title\"), tableParent, {width: 300, height: 300} );\r\n}\r\n\r\nvar _tableBrowser = new tableBrowser();\r\n\r\nexport default _tableBrowser;","﻿import nsGmx from './nsGmx.js';\r\nimport {        \r\n    _br,        \r\n    _div,\t    \r\n    _input,\r\n    _li,\r\n    makeImageButton,\r\n    makeLinkButton,    \r\n    _option,    \r\n    parseResponse,    \r\n    sendCrossDomainJSONRequest,    \r\n    switchSelect,\r\n    _span,\r\n\t_a,\r\n    _t,\r\n    _title,\r\n    _textarea,\r\n\t_table,\r\n\t_tbody,\t\r\n    _tr,\t\r\n\t_td,\r\n    _ul,    \r\n} from './utilities.js';\r\nimport './ShpEncodingWidget.js';\r\nimport './LayerEditor/TemporalLayerParamsWidget.js';\r\nimport './LayerEditor/LayerQuicklookWidget.js';\r\nimport './SuggestWidget/AttrSuggestWidget.js';\r\nimport './LayerEditor/ManualAttrModel.js';\r\nimport './LayerEditor/ManualAttrView.js';\r\nimport {mapHelper} from './mapHelper.js';\r\nimport './fileBrowser.js';\r\nimport _tableBrowser from './tableBrowser.js';\r\nimport _fileBrowser from './fileBrowser.js';\r\nimport './LayerProperties.js';\r\n\r\n//Создание интерфейса редактирования свойств слоя\r\n\r\n/** Виджет для выбора полей для X и Y координат из списка полей\r\n* @function\r\n* @param parent {DOMElement} - контейнер для размещения виджета\r\n* @param columns {LatLngColumnsModel} - модель для сохранения выбранных колонок\r\n* @param sourceColumns {Array} - доступные для выбора колонки\r\n*/\r\nvar SelectLatLngColumnsWidget = function(parent, columns, sourceColumns)\r\n{\r\n    var updateWidget = function() {\r\n        var parsedColumns = nsGmx.LayerProperties.parseColumns(sourceColumns);\r\n\r\n        $(parent).empty();\r\n\r\n        if (!parsedColumns.geomCount && parsedColumns.coordColumns.length) {\r\n            var fields = parsedColumns.coordColumns;\r\n\r\n\t\t\tvar selectLat = nsGmx.Utils._select(null, [['attr','selectLat',true],['dir','className','selectStyle'],['css','width','150px'],['css','margin','0px']]),\r\n\t\t\t\tselectLon = nsGmx.Utils._select(null, [['attr','selectLon',true],['dir','className','selectStyle'],['css','width','150px'],['css','margin','0px']]);\r\n\r\n            selectLat.onchange = function() {\r\n                columns.set('YCol', this.value);\r\n            }\r\n\r\n            selectLon.onchange = function() {\r\n                columns.set('XCol', this.value);\r\n            }\r\n\r\n\t\t\tfor (var i = 0; i < fields.length; i++)\r\n\t\t\t{\r\n\t\t\t\tvar opt = _option([_t(fields[i])], [['attr','value',fields[i]]]);\r\n\r\n\t\t\t\t_(selectLat, [opt.cloneNode(true)]);\r\n\t\t\t\t_(selectLon, [opt.cloneNode(true)]);\r\n            }\r\n\r\n           nsGmx.Utils._(parent, [_table([_tbody([\r\n                _tr([\r\n                    _td([_span([_t(_gtxt(\"Y (широта)\"))],[['css','margin','0px 3px']])], [['css','width','73px'],['css','border','none']]),\r\n                    _td([selectLat], [['css','width','150px'],['css','border','none']])\r\n                ]),\r\n                _tr([\r\n                    _td([_span([_t(_gtxt(\"X (долгота)\"))],[['css','margin','0px 3px']])], [['css','width','73px'],['css','border','none']]),\r\n                    _td([selectLon], [['css','width','150px'],['css','border','none']])\r\n                ])\r\n            ])])]);\r\n\r\n\r\n            if (columns.get('XCol')) {\r\n                selectLon = switchSelect(selectLon, columns.get('XCol'));\r\n            }\r\n\r\n            if (columns.get('YCol')) {\r\n                selectLat = switchSelect(selectLat, columns.get('YCol'));\r\n            }\r\n\r\n\t\t\tcolumns.set({\r\n\t\t\t\tXCol: selectLon.value,\r\n\t\t\t\tYCol: selectLat.value\r\n\t\t\t})\r\n        }\r\n    }\r\n\r\n    updateWidget();\r\n\r\n    this.updateColumns = function(newFields) {\r\n        sourceColumns = newFields;\r\n        updateWidget();\r\n    }\r\n}\r\n\r\nvar getSourceColumns = function(name)\r\n{\r\n    var deferred = $.Deferred();\r\n    sendCrossDomainJSONRequest(window.serverBase + \"VectorLayer/GetSourceColumns.ashx?SourceName=\" + encodeURIComponent(name), function(response)\r\n    {\r\n        if (!parseResponse(response))\r\n        {\r\n            deferred.reject();\r\n            return;\r\n        }\r\n\r\n        deferred.resolve(response.Result);\r\n    })\r\n\r\n    return deferred.promise();\r\n}\r\n\r\nvar getFileExt = function(path)\r\n{\r\n    return String(path).substr(String(path).lastIndexOf('.') + 1, path.length);\r\n}\r\n\r\n/**\r\n Диалог редактирования свойств слоя с вкладками (tabs) и кнопкой \"Сохранить\" под ними\r\n @memberOf nsGmx\r\n @param {DOMElement} div Элемент дерева слоёв, соответствующий редактируемому слою\r\n @param {String} type тип слоя (\"Vector\" или \"Raster\")\r\n @param {DOMElement} parent контейнер, в которым нужно разместить диалог\r\n @param {Object} properties Параметры слоя. В том формате, в котором они приходят с сервера.\r\n @param {Object} [params] Дополнительные параметры\r\n @param {String[]} [params.standardTabs] Массив с названиями стандартных вкладок, которые нужно показывать. По умолчанию показывать все (main, attrs, metadata, advanced)\r\n @param {Object[]} [params.additionalTabs] Массив дополнительных вкладок со следующими полями:\r\n\r\n   - {String} title Что будет написано но вкладке\r\n   - {String} name Уникальный идентификатор вкладки\r\n   - {DOMElement} container Контент вкладки\r\n\r\n @param {String} [params.selected] Идентификатор вкладки, которую нужно сделать активной\r\n @param {Function(controller)} [params.createdCallback] Ф-ция, которая будет вызвана после того, как диалог будет создан.\r\n        В ф-цию передаётся объект со следующими свойствами:\r\n\r\n   - {function(tabName)} selectTab Активизировать вкладку с идентификатором tabName\r\n\r\n  @param {Object} [params.additionalUI] Хеш массивов с доп. UI во вкладках. Ключ хеша - ID вкладки (main, attrs, metadata, advanced)\r\n  @param {Boolean} [params.copy] Является ли создаваемый слой копией\r\n*/\r\nvar LayerEditor = function(div, type, parent, properties, params) {\r\n\r\n    /** Генерируется перед изменением/добавлением слоя. Может быть использован для сохранения в свойствах объекта каких-то внешних данных.\r\n     * @event nsGmx.LayerEditor#premodify\r\n     */\r\n\r\n    var _params = $.extend({\r\n            addToMap: true,\r\n            doneCallback: null,\r\n            standardTabs: ['main', 'attrs', 'metadata', 'advanced'],\r\n            additionalUI: {}\r\n        }, params)\r\n\r\n\r\n    // меняем тип источника на 'Sql', если слой является копией\r\n\r\n    if (_params.copy) {\r\n        properties = JSON.parse(JSON.stringify(properties));\r\n        properties.SourceType = 'Sql';\r\n    }\r\n\r\n    var _this = this;\r\n    this._originalTabs = [];\r\n    this._saveButton = null;\r\n\r\n    this.selectTab = function(tabName) {\r\n        var selectedTab = $(tabMenu).tabs('option', 'active');\r\n        $.each(tabs, function(i, tab) {\r\n            if (tab.name === tabName && i !== selectedTab) {\r\n                $(tabMenu).tabs('option', 'active', i);\r\n            }\r\n        })\r\n    }\r\n\r\n    params = params || {};\r\n\r\n    var genPageDiv = function() {\r\n        return _div([\r\n                _div(null, [['dir', 'className', 'layer-container-inner']])\r\n            ], [['dir', 'className', 'layer-container-outer']]\r\n        );\r\n    }\r\n    \r\n    var props = div && (typeof(div) === 'string' ? properties : div.gmxProperties.content.properties) || {};\r\n    var isReadonly = div && _queryMapLayers.layerRights(props.name || props.Name) !== 'edit' && props.Access !== 'edit';\r\n    // var isReadonly = div && _queryMapLayers.layerRights(div.gmxProperties.content.properties.name) !== 'edit' && div.gmxProperties.content.properties.Access !== 'edit';\r\n\r\n    var createUI = function() {\r\n\r\n        // var divProperties = div ? div.gmxProperties.content.properties : !_params.copy ? {} : false,\r\n        var divProperties = props ? props : !_params.copy ? {} : false,\r\n            layerProperties = new nsGmx.LayerProperties();\r\n            // tabs = [];\r\n\r\n        layerProperties.initFromViewer(type, divProperties,  properties || divProperties);\r\n\r\n        _params = LayerEditor.applyInitHooks(_this, layerProperties, _params);\r\n\r\n        var mainContainer     = genPageDiv();\r\n        var metadataContainer = genPageDiv();\r\n        var advancedContainer = genPageDiv();\r\n        var attrContainer     = genPageDiv();\r\n\r\n\r\n        if (_params.standardTabs.indexOf('main') >= 0) {\r\n            _this._originalTabs.push({title: _gtxt('Общие'), name: 'main', container: mainContainer});\r\n        }\r\n\r\n        if (type === 'Vector' && _params.standardTabs.indexOf('attrs') >= 0) {\r\n            _this._originalTabs.push({title: _gtxt('Колонки'), name: 'attrs', container: attrContainer});\r\n        }\r\n\r\n        if (!isReadonly) {\r\n\r\n            if (_params.standardTabs.indexOf('metadata') >= 0) {\r\n                _this._originalTabs.push({title: _gtxt('Метаданные'), name: 'metadata', container: metadataContainer});\r\n            }\r\n\r\n            if (type === 'Vector' && _params.standardTabs.indexOf('advanced') >= 0) {\r\n                _this._originalTabs.push({title: _gtxt('Дополнительно'), name: 'advanced', container: advancedContainer});\r\n            }\r\n        }\r\n\r\n        _this._saveButton = null;\r\n\r\n        _this._saveButton = makeLinkButton(div ? _gtxt(\"Изменить\") : _gtxt(\"Создать\"));\r\n\r\n        var origLayerProperties = layerProperties.clone();\r\n\r\n        _this._createPageMain(mainContainer.firstChild, layerProperties, isReadonly, _params);\r\n        _this._createPageMetadata(metadataContainer.firstChild, layerProperties, isReadonly, _params);\r\n\r\n        if (type === 'Vector') {\r\n            _this._createPageAdvanced(advancedContainer.firstChild, layerProperties, isReadonly, _params);\r\n            _this._createPageAttributes(attrContainer.firstChild, layerProperties, isReadonly, _params);\r\n        }\r\n\r\n        for (var i in _params.additionalUI) {\r\n            var tab = _.findWhere(_this._originalTabs, {name: i});\r\n            if (tab) {\r\n                var container = tab.container.firstChild;\r\n                _params.additionalUI[i].forEach(function(ui) {\r\n                    $(container).append(ui);\r\n                })\r\n            }\r\n        }\r\n\r\n        if (div) {\r\n            layerProperties.on({\r\n                'change:Title': function() {\r\n                    var title =  layerProperties.get('Title');\r\n\r\n                    var span = $(div).find(\".layer\")[0];\r\n                    $(span).empty();\r\n                   nsGmx.Utils._(span, [_t(title)]);\r\n\r\n                    divProperties.title = title;\r\n                },\r\n                'change:Copyright': function() {\r\n                    var copyright = layerProperties.get('Copyright')\r\n\r\n                    nsGmx.gmxMap.layersByID[layerProperties.get('Name')].options.attribution = copyright;\r\n                    nsGmx.leafletMap.gmxControlIconManager.get('copyright')._redraw();\r\n\r\n                    divProperties.Copyright = copyright;\r\n                },\r\n                'change:Description': function() {\r\n                    var description = layerProperties.get('Description');\r\n\r\n                    var span = $(div).find(\".layerDescription\")[0];\r\n                    $(span).empty();\r\n                    span.innerHTML = description;\r\n\r\n                    divProperties.description = description;\r\n                },\r\n                'change:Legend': function() {\r\n                    divProperties.Legend = layerProperties.get('Legend');\r\n                },\r\n                'change:NameObject': function() {\r\n                    divProperties.NameObject = layerProperties.get('NameObject');\r\n                }\r\n            });\r\n        }\r\n\r\n        _this._saveButton.onclick = function() {\r\n\r\n            $(_this).trigger('premodify');\r\n\r\n            var name = layerProperties.get('Name'),\r\n                curBorder = _mapHelper.drawingBorders.get(name),\r\n                oldDrawing = origLayerProperties.get('Geometry'),\r\n                isVector = layerProperties.get('Type') === 'Vector',\r\n                needRetiling = false;\r\n\r\n            // если изменились поля с геометрией, то нужно тайлить заново и перегрузить слой в карте\r\n            if (isVector ||\r\n                layerProperties.get('ShapePath').Path != origLayerProperties.get('ShapePath').Path ||\r\n                layerProperties.get('TilePath').Path != origLayerProperties.get('TilePath').Path ||\r\n                (oldDrawing && typeof curBorder != 'undefined') ||\r\n                (!oldDrawing && typeof curBorder != 'undefined') ||\r\n                (oldDrawing && typeof curBorder == 'undefined'))\r\n            {\r\n                needRetiling = true;\r\n            }\r\n            var def = layerProperties.save(needRetiling, null, _params),\r\n                layerTitle = layerProperties.get('Title');\r\n\r\n            //doneCallback вызываем при первом progress notification - признаке того, что вызов непосредственно скрипта модификации слоя прошёл успешно\r\n            var onceCallback = _.once(function(){\r\n                _params.doneCallback && _params.doneCallback(def, layerTitle);\r\n            });\r\n\r\n                def.always(parseResponse);\r\n                def.then(onceCallback, null, onceCallback);\r\n\r\n            if (isVector && !name && (layerProperties.get('SourceType') === 'manual')) {\r\n                if (_params.addToMap) {\r\n                    def.done(function(response) {\r\n                        var mapProperties = _layersTree.treeModel.getMapProperties(),\r\n                            targetDiv = $(_queryMapLayers.buildedTree.firstChild).children(\"div[MapID]\")[0],\r\n                            gmxProperties = {type: 'layer', content: response.Result};\r\n\r\n                        gmxProperties.content.properties.mapName = mapProperties.name;\r\n                        gmxProperties.content.properties.hostName = mapProperties.hostName;\r\n                        gmxProperties.content.properties.visible = true;\r\n\r\n                        gmxProperties.content.properties.styles = [{\r\n                            MinZoom: 1,\r\n                            MaxZoom:21,\r\n                            RenderStyle:gmxProperties.content.properties.IsPhotoLayer ? _mapHelper.defaultPhotoIconStyles[gmxProperties.content.properties.GeometryType] : _mapHelper.defaultStyles[gmxProperties.content.properties.GeometryType]\r\n                        }];\r\n\r\n                        _layersTree.copyHandler(gmxProperties, targetDiv, false, true);\r\n                    })\r\n                }\r\n            } else if (name) {\r\n                _queryMapLayers.asyncUpdateLayer(def, properties, true);\r\n            } else if (_params.addToMap) {\r\n                _queryMapLayers.asyncCreateLayer(def, layerTitle);\r\n            }            \r\n        }\r\n    }\r\n\r\n    createUI();\r\n\r\n    // var id = 'layertabs' + (div ? div.gmxProperties.content.properties.name : '');\r\n    var id = 'layertabs' + (props ? props.name : '');\r\n\r\n    var tabs = this._originalTabs;\r\n\r\n    if (!isReadonly) {\r\n        tabs = tabs.concat(params.additionalTabs || []);\r\n    }\r\n\r\n    var lis = [], containers = [];\r\n    for (var t = 0; t < tabs.length; t++) {\r\n        lis.push(_li([_a([_t(tabs[t].title)],[['attr','href','#' + tabs[t].name + id]])]));\r\n        containers.push(tabs[t].container);\r\n        $(tabs[t].container).attr('id', tabs[t].name + id);\r\n    }\r\n\r\n    var tabMenu = _div([_ul(lis)].concat(containers));\r\n\r\n    var saveMenuCanvas;\r\n\r\n    if (isReadonly) {\r\n        saveMenuCanvas = _div([_t(_gtxt(\"Недостаточно прав для редактирования настроек слоя\"))],[['css','padding','5px 0px 5px 5px'],['css','color','red']]);\r\n    } else {\r\n        saveMenuCanvas = _div([this._saveButton]);\r\n    }\r\n\r\n    $(parent).empty().append(_table([\r\n        _tr([_td([tabMenu])], [['css', 'height', '100%'], ['css', 'verticalAlign', 'top']]),\r\n        _tr([_td([_div(null, [['css', 'height', '1px']]), saveMenuCanvas])])\r\n    ], [['css', 'height', '100%'], ['css', 'width', '100%'], ['css', 'position', 'relative']]));\r\n\r\n    var getTabIndex = function(tabName) {\r\n        for (var i = 0; i < tabs.length; i++)\r\n            if (tabs[i].name === tabName)\r\n                return i;\r\n        return -1;\r\n    }\r\n\r\n    var selectIndex = getTabIndex(params.selected);\r\n    $(tabMenu).tabs({\r\n        active: selectIndex > -1 ? selectIndex : 0,\r\n        activate: function() {\r\n            var activeIndex = $(tabMenu).tabs('option', 'active');\r\n            $(saveMenuCanvas).toggle(activeIndex < _this._originalTabs.length);\r\n        }\r\n    });\r\n\r\n    $(saveMenuCanvas).toggle(selectIndex < this._originalTabs.length);\r\n\r\n    params.createdCallback && params.createdCallback(this);\r\n}\r\n\r\n\r\nLayerEditor.prototype._createPageMain = function(parent, layerProperties, isReadonly, params) {\r\n\r\n    var title = _input(null,[['attr','fieldName','title'],['attr','value',layerProperties.get('Title')],['dir','className','inputStyle'],['css','width','220px']]);\r\n    title.onkeyup = function() {\r\n        layerProperties.set('Title', this.value);\r\n        return true;\r\n    }\r\n\r\n    layerProperties.on('change:Title', function() {\r\n        var newTitle = layerProperties.get('Title');\r\n        if ( newTitle !== title.value ) {\r\n            title.value = newTitle;\r\n        }\r\n    })\r\n\r\n    var copyright = _input(null,[['attr','fieldName','copyright'],['attr','value',layerProperties.get('Copyright')],['dir','className','inputStyle'],['css','width','220px']]);\r\n    copyright.onkeyup = function() {\r\n        layerProperties.set('Copyright', this.value);\r\n        return true;\r\n    }\r\n\r\n    var legend = _input(null,[['attr','fieldName','Legend'],['attr','value',layerProperties.get('Legend')],['dir','className','inputStyle'],['css','width','220px']])\r\n    legend.onkeyup = legend.onchange = function() {\r\n        layerProperties.set('Legend', this.value);\r\n        return true;\r\n    }\r\n\r\n    var descr = _textarea(null,[\r\n        ['attr','fieldName','description'],\r\n        ['dir','className','inputStyle'],\r\n        ['css','width','220px'],\r\n        ['css','height','50px']\r\n    ]);\r\n\r\n    descr.onkeyup = function() {\r\n        layerProperties.set('Description', this.value);\r\n        return true;\r\n    }\r\n\r\n    descr.value = layerProperties.get('Description');\r\n\r\n    var currentGeometryType = layerProperties.get('GeometryType');\r\n    var geometryTitle = null;\r\n\r\n    var geometryTypes = [\r\n        {title: _gtxt('полигоны'), type: 'polygon'},\r\n        {title: _gtxt('линии'), type: 'linestring'},\r\n        {title: _gtxt('точки'), type: 'point'}\r\n    ];\r\n\r\n    for (var i = 0; i < geometryTypes.length; i++) {\r\n        if (currentGeometryType === geometryTypes[i].type) {\r\n            geometryTitle = geometryTypes[i].title\r\n        }\r\n    }\r\n\r\n    var geometryType = _input(null,[['attr','fieldName','geom_type'],['attr','value', geometryTitle],['attr','disabled', 'disabled'],['dir','className','inputStyle'],['css','width','220px']]);\r\n\r\n    var shownProperties = [];\r\n\r\n    shownProperties.push({name: _gtxt(\"Имя\"), field: 'Title', elem: title});\r\n    shownProperties.push({name: _gtxt(\"Копирайт\"), field: 'Copyright', elem: copyright});\r\n\r\n    if (layerProperties.get('Name')) {\r\n        shownProperties.push({name: _gtxt(\"ID\"), field: 'Name'});\r\n    }\r\n\r\n    shownProperties.push({name: _gtxt(\"Описание\"), field: 'Description', elem: descr});\r\n\r\n    if (layerProperties.get('Type') === \"Vector\" && layerProperties.get('Geometry') !== undefined) {\r\n        shownProperties.push({name: _gtxt(\"Геометрия\"), field: 'geometryType', elem: geometryType});\r\n    }\r\n\r\n    if (layerProperties.get('Type') != \"Vector\") {\r\n        var selectImage = new mapHelper.ImageSelectionWidget();\r\n        selectImage.on('selected', function(url) {\r\n            var imgHtml = '<img src=\"' + url + '\"></img>';\r\n            legend.value = imgHtml;\r\n            layerProperties.set('Legend', imgHtml);\r\n        })\r\n\r\n        var tr = $(Handlebars.compile('<tr>' +\r\n            '<td class=\"propertiesTable-title\">{{i \"Легенда\"}}<span class=\"layer-editor-legend-image\"></span></td>' +\r\n            '<td class=\"layer-editor-legend\"></td>' +\r\n        '</tr>')());\r\n        tr.find('.layer-editor-legend-image').append(selectImage.el);\r\n        tr.find('.layer-editor-legend').append(legend);\r\n        shownProperties.push({tr: tr[0]});\r\n    }\r\n\r\n    if (!isReadonly) {\r\n        if (layerProperties.get('Type') === \"Vector\") {\r\n            shownProperties = shownProperties.concat(!params.copy ? this._createPageVectorSource(layerProperties, params) : []);\r\n        } else if (layerProperties.get('Type') === \"Raster\") {\r\n            shownProperties = shownProperties.concat(this._createPageRasterSource(layerProperties));\r\n        }\r\n    }\r\n\r\n    var trs = _mapHelper.createPropertiesTable(shownProperties, layerProperties.attributes, {leftWidth: 70});\r\n   nsGmx.Utils._(parent, [_table([_tbody(trs)],[['dir','className','propertiesTable']])]);\r\n\r\n    if (isReadonly) {\r\n        $(parent).find('input, textarea').prop('disabled', true);\r\n    }\r\n}\r\n\r\nLayerEditor.prototype._createPageVectorSource = function(layerProperties, params) {\r\n    var _this = this;\r\n    var LatLngColumnsModel = nsGmx.LatLngColumnsModel;\r\n    var shownProperties = [];\r\n    var layerName = layerProperties.get('Name');\r\n    var sourceType = layerProperties.get('SourceType');\r\n\r\n    /*------------ Источник: файл ------------*/\r\n    var shapePath = layerProperties.get('ShapePath');\r\n\r\n    var shapePathInput = _input(null,[['attr','fieldName','ShapePath.Path'],['attr','value', shapePath.Path || ''],['dir','className','inputStyle'],['css','width', '200px']]),\r\n        shapeFileLink = makeImageButton(\"img/choose2.png\", \"img/choose2_a.png\"),\r\n        encodingParent = _div(),\r\n        xlsColumnsParent = _div();\r\n\r\n    shapePathInput.onkeyup = shapePathInput.onchange = function() {\r\n        layerProperties.set('ShapePath', {Path: this.value});\r\n    }\r\n\r\n    var fileSourceColumns = sourceType === 'file' ? layerProperties.get('Columns') : [];\r\n    var fileSelectedColumns = sourceType === 'file' ? layerProperties.get('GeometryColumnsLatLng') : new LatLngColumnsModel();\r\n    var fileColumnsWidget = !params.copy ? new SelectLatLngColumnsWidget(xlsColumnsParent, fileSelectedColumns, fileSourceColumns) : null;\r\n\r\n    shapeFileLink.style.marginLeft = '3px';\r\n\r\n    var encodingWidget = new nsGmx.ShpEncodingWidget();\r\n    shapePathInput.oldValue = shapePathInput.value;\r\n\r\n    $(encodingWidget).change(function() {\r\n        layerProperties.set('EncodeSource', encodingWidget.getServerEncoding());\r\n    })\r\n\r\n    if (getFileExt(shapePathInput.value) === 'shp') {\r\n        encodingWidget.drawWidget(encodingParent, layerProperties.get('EncodeSource'));\r\n    }\r\n\r\n    if (shapePath && shapePath.Path != null && shapePath.Path != '' && !shapePath.Exists) {\r\n        $(shapePathInput).addClass('error');\r\n    }\r\n\r\n    //TODO: использовать события модели\r\n    shapeFileLink.onclick = function()\r\n    {\r\n        window._fileBrowser.createBrowser(_gtxt(\"Файл\"), ['shp','tab', 'xls', 'xlsx', 'xlsm', 'mif', 'gpx', 'kml', 'csv', 'sxf', 'gdbtable', 'geojson', 'kmz','sqlite'], function(path)\r\n        {\r\n            shapePathInput.value = path;\r\n            layerProperties.set('ShapePath', {Path: path});\r\n\r\n            var index = String(path).lastIndexOf('.'),\r\n                ext = String(path).substr(index + 1, path.length);\r\n\r\n            if (layerProperties.get('Title') == '')\r\n            {\r\n                var indexSlash = String(path).lastIndexOf('\\\\'),\r\n                    fileName = String(path).substring(indexSlash + 1, index);\r\n\r\n                layerProperties.set('Title', fileName);\r\n            }\r\n\r\n            getSourceColumns(path).done(function(sourceColumns)\r\n            {\r\n                layerProperties.set('Columns', sourceColumns);\r\n                fileSourceColumns = sourceColumns;\r\n            })\r\n\r\n            $(encodingParent).empty();\r\n            if (ext === 'shp')\r\n            {\r\n                encodingWidget.drawWidget(encodingParent);\r\n            }\r\n        })\r\n    }\r\n\r\n    var sourceFile = _div(null, [['dir', 'id', 'fileSource' + layerName]]);\r\n   nsGmx.Utils._(sourceFile, [shapePathInput, shapeFileLink, encodingParent, xlsColumnsParent/*, fileAddAttribute, fileColumnsContainer*/]);\r\n\r\n    /*------------ Источник: таблица ------------*/\r\n    var tableLink = makeImageButton(\"img/choose2.png\", \"img/choose2_a.png\"),\r\n        tableColumnsParent = _div();\r\n\r\n    var tableSourceColumns   = sourceType === 'table' ? layerProperties.get('Columns') : [];\r\n    var tableSelectedColumns = sourceType === 'table' ? layerProperties.get('GeometryColumnsLatLng') : new LatLngColumnsModel();\r\n    var tableColumnsWidget = new SelectLatLngColumnsWidget(tableColumnsParent, tableSelectedColumns, tableSourceColumns);\r\n\r\n    var tablePathInput = _input(null,[\r\n        ['attr','fieldName','TableName'],\r\n        ['attr','value', layerProperties.get('TableName') || ''],\r\n        ['dir','className','inputStyle'],\r\n        ['css','width', '200px']\r\n    ]);\r\n\r\n    tablePathInput.onkeyup = tablePathInput.onchange = function() {\r\n        layerProperties.set('TableName', this.value);\r\n    }\r\n\r\n    tableLink.onclick = function()\r\n    {\r\n        _tableBrowser.createBrowser(function(name)\r\n        {\r\n            tablePathInput.value = name;\r\n            layerProperties.set('TableName', name);\r\n\r\n            if (layerProperties.get('Title') == '') {\r\n                layerProperties.set('Title', name);\r\n            }\r\n\r\n            getSourceColumns(name).done(function(sourceColumns)\r\n            {\r\n                layerProperties.set('Columns', sourceColumns);\r\n                tableSourceColumns = sourceColumns;\r\n            })\r\n        })\r\n    }\r\n\r\n    tableLink.style.marginLeft = '3px';\r\n\r\n    var TableCSParent = _div();\r\n    var TableCSSelect = $('<select/>', {'class': 'selectStyle'}).css('width', '165px')\r\n        .append($('<option>').val('EPSG:4326').text(_gtxt('Широта/Долгота (EPSG:4326)')))\r\n        .append($('<option>').val('EPSG:3395').text(_gtxt('Меркатор (EPSG:3395)')))\r\n        .change(function() {\r\n            layerProperties.set('TableCS', $(this).find(':selected').val());\r\n        })\r\n\r\n    if (layerProperties.get('TableCS')) {\r\n        TableCSSelect.find('[value=\"' + layerProperties.get('TableCS') +'\"]').attr('selected', 'selected');\r\n    }\r\n\r\n    $(TableCSParent).append($('<span/>').text(_gtxt('Проекция')).css('margin', '3px')).append(TableCSSelect);\r\n\r\n    var sourceTable = _div([tablePathInput, tableLink, TableCSParent, tableColumnsParent], [['dir', 'id', 'tableSource' + layerName]])\r\n\r\n    /*------------ Источник: вручную ------------*/\r\n    var geometryTypes = [\r\n        {title: _gtxt('полигоны'), type: 'polygon'   , className: 'manual-polygon'},\r\n        {title: _gtxt('линии'),          type: 'linestring', className: 'manual-linestring'},\r\n        {title: _gtxt('точки'),          type: 'point'     , className: 'manual-point'}\r\n    ];\r\n\r\n    var RadioButtonsWidget = function(container, buttons, activeType) {\r\n        var _this = this;\r\n        var _activeType = activeType || buttons[0].type;\r\n        $(container).empty().addClass('manual-type-widget');\r\n\r\n        for (var b = 0; b < buttons.length; b++) {\r\n            $('<div/>')\r\n                .addClass(buttons[b].className)\r\n                .toggleClass('manual-active-type', _activeType === buttons[b].type)\r\n                .attr('title', buttons[b].title)\r\n                .appendTo(container)\r\n                .data('type', buttons[b].type);\r\n        }\r\n\r\n        $('div', container).click(function() {\r\n            $(this).siblings().removeClass('manual-active-type');\r\n            $(this).addClass('manual-active-type');\r\n            _activeType = $(this).data('type');\r\n            $(_this).change();\r\n        })\r\n\r\n        this.getActiveType = function() {\r\n            return _activeType;\r\n        }\r\n    }\r\n\r\n    var geometryTypeContainer = $('<div/>').css({'display': 'inline-block', 'vertical-align': 'middle'});\r\n    var geometryTypeWidget = new RadioButtonsWidget(geometryTypeContainer, geometryTypes, layerProperties.get('GeometryType'));\r\n    $(geometryTypeWidget).change(function() {\r\n        layerProperties.set('GeometryType', geometryTypeWidget.getActiveType());\r\n    })\r\n\r\n    layerProperties.set('GeometryType', geometryTypeWidget.getActiveType());\r\n\r\n    var editAttributeLink = $('<span/>').addClass('buttonLink').text(_gtxt('Редактировать колонки')).click(function() {\r\n        _this.selectTab('attrs');\r\n    })\r\n\r\n    var attrViewParent = _div();\r\n    var geometryTypeTitle = _span([_t(_gtxt('Геометрия') + ': ')], [['css', 'height', '20px'], ['css', 'verticalAlign', 'middle']]);\r\n    var attrContainer = _div([\r\n        _div([\r\n            layerName ? _div(): _div([geometryTypeTitle, geometryTypeContainer[0]]),\r\n            editAttributeLink[0]\r\n        ]),\r\n        _div([attrViewParent], [['css', 'margin', '3px']])\r\n    ], [['css', 'marginLeft', '3px']]);\r\n\r\n    var sourceManual = _div([attrContainer], [['dir', 'id', 'manualSource' + layerName]]);\r\n\r\n    /*------------ Общее ------------*/\r\n    layerProperties.on({\r\n        'change:Columns': function() {\r\n            var columns = layerProperties.get('Columns');\r\n            tableColumnsWidget.updateColumns(columns);\r\n            fileColumnsWidget && fileColumnsWidget.updateColumns(columns);\r\n        }\r\n    })\r\n\r\n    /*------------ Переключалка источника слоя ------------*/\r\n    var sourceContainers = [sourceFile, sourceTable, sourceManual];\r\n\r\n    var template = Handlebars.compile(\r\n        '<form>' +\r\n            '<label><input type=\"radio\" name=\"sourceCheckbox\" id=\"chxFileSource\" data-container-idx=\"0\" checked>{{i \"Файл\"}}</label><br/>' +\r\n            '{{#unless copy}}' +\r\n            '{{#if admin}}<label><input type=\"radio\" name=\"sourceCheckbox\" id=\"chxTableSource\" data-container-idx=\"1\">{{i \"Таблица\"}}</label><br/>{{/if}}' +\r\n            '<label><input type=\"radio\" name=\"sourceCheckbox\" id=\"chxManualSource\" data-container-idx=\"2\">{{i \"Вручную\"}}</label>' +\r\n            '{{/unless}}' +\r\n        '</form>'\r\n    )\r\n\r\n    var sourceCheckbox = $(template({\r\n        admin: nsGmx.AuthManager.isRole(nsGmx.ROLE_ADMIN),\r\n        copy: params.copy\r\n    }));\r\n\r\n    sourceCheckbox.find('input, label').css({verticalAlign: 'middle'});\r\n    sourceCheckbox.find('input').css({marginRight: 2});\r\n    sourceCheckbox.find('input').click(function()\r\n    {\r\n        var activeIdx = $(this).data('containerIdx');\r\n        $(sourceTab).tabs('option', 'active', activeIdx);\r\n    });\r\n\r\n\r\n    var activeCheckboxID = {'file': 'chxFileSource', 'table': 'chxTableSource', 'manual': 'chxManualSource'}[sourceType];\r\n    $('#' + activeCheckboxID, sourceCheckbox).attr('checked', 'checked');\r\n\r\n    var sourceTab = _div([_ul([\r\n        _li([_a([_t(_gtxt('Файл'))],   [['attr','href','#fileSource' + layerName]])]),\r\n        _li([_a([_t(_gtxt('Таблица'))],[['attr','href','#tableSource' + layerName]])]),\r\n        _li([_a([_t(_gtxt('Вручную'))],[['attr','href','#manualSource' + layerName]])])\r\n    ], [['css', 'display', 'none']])]);\r\n\r\n    var selectedSource = {'file': 0, 'table': 1, 'manual': 2}[sourceType];\r\n   nsGmx.Utils._(sourceTab, sourceContainers);\r\n\r\n    $(sourceTab).tabs({\r\n        active: selectedSource,\r\n        activate: function()\r\n        {\r\n            var selectedSource = $(sourceTab).tabs('option', 'active');\r\n\r\n            if (selectedSource == 0) {\r\n                layerProperties.set('Columns', fileSourceColumns);\r\n                layerProperties.set('SourceType', 'file');\r\n                layerProperties.set('GeometryColumnsLatLng', fileSelectedColumns);\r\n            } else if (selectedSource == 1) {\r\n                layerProperties.set('Columns', tableSourceColumns);\r\n                layerProperties.set('SourceType', 'table');\r\n                layerProperties.set('GeometryColumnsLatLng', tableSelectedColumns);\r\n                layerProperties.set('TableCS', TableCSSelect.find(':selected').val());\r\n            } else if (selectedSource == 2) {\r\n                layerProperties.set('SourceType', 'manual');\r\n            }\r\n        }\r\n    });\r\n\r\n    var sourceTr2;\r\n\r\n    if (!layerName) {\r\n        sourceTr2 = _tr([_td([sourceCheckbox[0]], [['css','padding','5px'], ['css', 'verticalAlign', 'top'], ['css', 'lineHeight', '18px']]), _td([_div([sourceTab])])]);\r\n    } else {\r\n        var sourceTitle = {'file': _gtxt('Файл'), 'table': _gtxt('Таблица'), 'manual': _gtxt('Вручную')}[sourceType];\r\n        var sourceControls = {'file': sourceFile, 'table': sourceTable, 'manual': sourceManual}[sourceType];\r\n        sourceTr2 = _tr([\r\n            _td([_t(_gtxt(\"Источник\") + ': ' + sourceTitle)], [['css','padding','5px'], ['css', 'verticalAlign', 'top'], ['css', 'lineHeight', '18px']]),\r\n            _td([sourceControls])\r\n        ]);\r\n    }\r\n\r\n    if (!layerName || sourceType !== 'manual') {\r\n        shownProperties.push({tr: sourceTr2});\r\n    }\r\n\r\n    return shownProperties;\r\n}\r\n\r\nLayerEditor.prototype._createPageRasterSource = function(layerProperties) {\r\n    var shapePath = layerProperties.get('ShapePath');\r\n    var tilePath = layerProperties.get('TilePath');\r\n    var name = layerProperties.get('Name');\r\n\r\n    var shapePathInput = _input(null,[['attr','fieldName','ShapePath.Path'],['attr','value',shapePath.Path || ''], ['dir','className','inputStyle'],['css','width','220px']]),\r\n        tilePathInput = _input(null,[['attr','fieldName','TilePath.Path'],['attr','value',tilePath.Path || ''], ['dir','className','inputStyle'],['css','width','220px']]),\r\n        tileCatalogLink = makeImageButton(\"img/choose2.png\", \"img/choose2_a.png\"),\r\n        tileFileLink = makeImageButton(\"img/choose2.png\", \"img/choose2_a.png\"),\r\n        shapeLink = makeImageButton(\"img/choose2.png\", \"img/choose2_a.png\"),\r\n        drawingBorderLink = makeImageButton(\"img/choose2.png\", \"img/choose2_a.png\"),\r\n        drawingBorderDescr = _span(null, [['attr','id','drawingBorderDescr' + name],['css','color','#215570'],['css','marginLeft','3px']]),\r\n        removeBorder = makeImageButton('img/closemin.png','img/close_orange.png'),\r\n        divBorder = _div([drawingBorderDescr, removeBorder]),\r\n        isAdmin = nsGmx.AuthManager.isRole(nsGmx.ROLE_ADMIN),\r\n        catalogPathElems = [_t(_gtxt(\"Каталог\")), tileCatalogLink, _br()],\r\n        filePathElems = [_t(_gtxt(\"Файл\")), tileFileLink],\r\n        trPath = _tr([_td(isAdmin ? catalogPathElems.concat(filePathElems) : filePathElems, [['css','paddingLeft','5px'],['css','fontSize','12px']]), _td([tilePathInput])]),\r\n        trShape = _tr([_td([_t(_gtxt(\"Граница\")), shapeLink],[['css','paddingLeft','5px'],['css','fontSize','12px']]),\r\n                       _td([shapePathInput, divBorder])]),\r\n        shapeVisible = function(flag)\r\n        {\r\n            if (flag)\r\n            {\r\n                shapePathInput.style.display = '';\r\n                divBorder.style.display = 'none';\r\n            }\r\n            else\r\n            {\r\n                shapePathInput.style.display = 'none';\r\n                divBorder.style.display = '';\r\n            }\r\n        };\r\n\r\n    divBorder.style.cssText = \"height:22px; padding-top:3px;\";\r\n\r\n    removeBorder.style.cssText = \"height:16px;padding:0;width:16px;cursor:pointer;margin:-1px 0px -3px 5px;\";\r\n\r\n    _title(removeBorder, _gtxt(\"Удалить\"));\r\n\r\n    tilePathInput.onchange = tilePathInput.oninput = function() {\r\n        layerProperties.set('TilePath', {Path: this.value});\r\n    }\r\n\r\n    shapePathInput.onchange = shapePathInput.oninput = function() {\r\n        layerProperties.set('ShapePath', {Path: this.value});\r\n    }\r\n\r\n    removeBorder.onclick = function()\r\n    {\r\n        shapeVisible(true);\r\n        _mapHelper.drawingBorders.removeRoute(name, true);\r\n        layerProperties.set('Geometry', null);\r\n    }\r\n\r\n    if (name)\r\n    {\r\n       nsGmx.Utils._(trShape.firstChild, [_br(), _t(_gtxt(\"Контур\")), drawingBorderLink]);\r\n\r\n        if (shapePath.Path)\r\n            shapeVisible(true);\r\n        else\r\n        {\r\n            shapeVisible(false);\r\n\r\n            var geometry = layerProperties.get('Geometry');\r\n\r\n            var geom = L.gmxUtil.geometryToGeoJSON(geometry, true);\r\n            var drawingBorder = nsGmx.leafletMap.gmxDrawing.addGeoJSON(geom)[0];\r\n\r\n            _mapHelper.drawingBorders.set(name, drawingBorder);\r\n\r\n            _mapHelper.drawingBorders.updateBorder(name, drawingBorderDescr);\r\n        }\r\n    }\r\n    else {\r\n        shapeVisible(true);\r\n    }\r\n\r\n    if (shapePath && shapePath.Path != null && shapePath.Path != '' && !shapePath.Exists)\r\n        $(shapePathInput).addClass('error');\r\n\r\n    if (tilePath.Path != null && tilePath.Path != '' && !tilePath.Exists)\r\n        $(tilePathInput).addClass('error');\r\n\r\n    tileCatalogLink.onclick = function()\r\n    {\r\n        _fileBrowser.createBrowser(_gtxt(\"Каталог\"), [], function(path)\r\n        {\r\n            tilePathInput.value = path;\r\n            layerProperties.set('TilePath', {Path: path});\r\n\r\n            if (!layerProperties.get('Title'))\r\n            {\r\n                path = path.substring(0, path.length - 1); //убираем слеш на конце\r\n                var indexSlash = String(path).lastIndexOf('\\\\'),\r\n                    fileName = String(path).substring(indexSlash + 1, path.length);\r\n\r\n                layerProperties.set('Title', fileName);\r\n            }\r\n        })\r\n    }\r\n\r\n    var appendMetadata = function(data)\r\n    {\r\n        var layerTags = layerProperties.get('MetaProperties');\r\n        if (!data || !layerTags) return;\r\n\r\n        // var convertedTagValues = {};\r\n        for (var mp in data)\r\n        {\r\n            var tagtype = data[mp].Type;\r\n            layerTags.addNewTag(mp, nsGmx.Utils.convertFromServer(tagtype, data[mp].Value), tagtype);\r\n        }\r\n\r\n        if (!layerProperties.get('Title'))\r\n        {\r\n            var platform = layerTags.getTagByName('platform');\r\n            var dateTag  = layerTags.getTagByName('acqdate');\r\n            var timeTag  = layerTags.getTagByName('acqtime');\r\n\r\n            if (typeof platform !== 'undefined' && typeof dateTag !== 'undefined' && typeof timeTag !== 'undefined')\r\n            {\r\n                var timeOffset = (new Date()).getTimezoneOffset()*60*1000;\r\n\r\n                var dateInt = nsGmx.Utils.convertToServer('Date', dateTag.value);\r\n                var timeInt = nsGmx.Utils.convertToServer('Time', timeTag.value);\r\n\r\n                var date = new Date( (dateInt+timeInt)*1000 + timeOffset );\r\n\r\n                var dateString = $.datepicker.formatDate('yy.mm.dd', date);\r\n                var timeString = $.datepicker.formatTime('HH:mm', {hour: date.getHours(), minute: date.getMinutes()});\r\n\r\n                layerProperties.set('Title', platform.value + '_' + dateString + '_' + timeString + '_UTC');\r\n            }\r\n        }\r\n    }\r\n\r\n    tileFileLink.onclick = function()\r\n    {\r\n        _fileBrowser.createBrowser(_gtxt(\"Файл\"), ['jpeg', 'jpg', 'tif', 'tiff', 'bmp', 'png', 'img', 'tiles', 'cpyr', 'mbtiles'], function(path)\r\n        {\r\n            tilePathInput.value = path;\r\n            layerProperties.set('TilePath', {Path: path});\r\n\r\n            sendCrossDomainJSONRequest(window.serverBase + 'Layer/GetMetadata.ashx?basepath=' + encodeURIComponent(path), function(response)\r\n            {\r\n                if (!parseResponse(response))\r\n                    return;\r\n\r\n                appendMetadata(response.Result.MetaProperties);\r\n\r\n                if (!layerProperties.get('Title'))\r\n                {\r\n                    var indexExt = String(path).lastIndexOf('.');\r\n                    var indexSlash = String(path).lastIndexOf('\\\\'),\r\n                        fileName = String(path).substring(indexSlash + 1, indexExt);\r\n\r\n                    layerProperties.set('Title', fileName);\r\n                }\r\n            })\r\n        })\r\n    }\r\n\r\n    shapeLink.onclick = function()\r\n    {\r\n        _fileBrowser.createBrowser(_gtxt(\"Граница\"), ['mif','tab','shp', 'geojson', 'kmz'], function(path)\r\n        {\r\n            shapePathInput.value = path;\r\n            layerProperties.set('ShapePath', {Path: path});\r\n\r\n            _mapHelper.drawingBorders.removeRoute(name, true);\r\n\r\n            shapeVisible(true);\r\n\r\n            sendCrossDomainJSONRequest(window.serverBase + 'Layer/GetMetadata.ashx?geometryfile=' + encodeURIComponent(path), function(response)\r\n            {\r\n                if (!parseResponse(response))\r\n                    return;\r\n\r\n                appendMetadata(response.Result.MetaProperties);\r\n            })\r\n        })\r\n    }\r\n\r\n    drawingBorderLink.onclick = function()\r\n    {\r\n        nsGmx.Controls.chooseDrawingBorderDialog( name, function(polygon)\r\n        {\r\n            _mapHelper.drawingBorders.set(name, polygon);\r\n            _mapHelper.drawingBorders.updateBorder(name);\r\n            shapeVisible(false);\r\n\r\n        }, {geomType: 'POLYGON', errorMessage: _gtxt(\"$$phrase$$_17\")} );\r\n    }\r\n\r\n    tileCatalogLink.style.marginLeft = '3px';\r\n    tileFileLink.style.marginLeft = '3px';\r\n    shapeLink.style.marginLeft = '3px';\r\n    drawingBorderLink.style.marginLeft = '3px';\r\n\r\n    var shownProperties = [\r\n        {tr:trPath},\r\n        {tr:trShape}\r\n    ];\r\n\r\n    return shownProperties;\r\n}\r\n\r\nLayerEditor.prototype._createPageAttributes = function(parent, props, isReadonly, params) {\r\n\r\n    var isNewLayer = !props.get('Name');\r\n    var fileColumnsContainer = _div();\r\n    var fileAttrModel = new nsGmx.ManualAttrModel(props.get('RC').get('IsRasterCatalog'));\r\n    var type = props.get('SourceType');\r\n\r\n    if (isNewLayer) {\r\n        props.on('change:Columns', function() {\r\n            if (props.get('SourceType') !== 'manual' && props.get('SourceType') !== 'Sql') {\r\n                fileAttrModel.initFromServerFormat(props.get('Columns'));\r\n            }\r\n        });\r\n    }\r\n\r\n    fileAttrModel.initFromServerFormat(props.get('Columns'));\r\n\r\n    var fileAttrView = new nsGmx.ManualAttrView();\r\n    fileAttrView.init(fileColumnsContainer, fileAttrModel, {copy: params.copy});\r\n    var allowEdit = !isReadonly && (type === 'manual' || (!isNewLayer && type === 'file') || params.copy);\r\n    fileAttrView.setActive(allowEdit);\r\n\r\n    $(fileAttrModel).change(function() {        \r\n        props.set('Columns', fileAttrModel.toServerFormat());\r\n    });\r\n\r\n   nsGmx.Utils._(parent, [fileColumnsContainer]);\r\n\r\n    props.on('change:SourceType', function() {\r\n        var type = props.get('SourceType');\r\n        var allowEdit = type === 'manual' || (!isNewLayer && type === 'file');\r\n        fileAttrModel.initFromServerFormat(props.get('Columns'));\r\n        fileAttrView.setActive(allowEdit);\r\n    });\r\n}\r\n\r\nLayerEditor.prototype._createPageMetadata = function(parent, layerProperties) {\r\n    nsGmx.TagMetaInfo.loadFromServer(function(tagsInfo)\r\n    {\r\n        var layerTags = layerProperties.get('MetaProperties');\r\n        nsGmx.LayerTagsWithInfo.call(layerTags, tagsInfo);\r\n        new nsGmx.LayerTagSearchControl(layerTags, parent);\r\n    })\r\n}\r\n\r\nLayerEditor.prototype._createPageAdvanced = function(parent, layerProperties) {\r\n    //мультивременной слой\r\n    var temporalLayerParent = _div(null, [['dir', 'className', 'TemporalLayer']]);\r\n    var temporalProperties = layerProperties.get('Temporal');\r\n    var temporalLayerView = new nsGmx.TemporalLayerParamsWidget(temporalLayerParent, temporalProperties, []);\r\n    var isTemporalCheckbox = $('<input/>')\r\n        .attr({type: 'checkbox'})\r\n        .change(function() {\r\n            temporalProperties.set('isTemporal', this.checked);\r\n        });\r\n\r\n    var updateTemporalVisibility = function() {\r\n        var isTemporal = temporalProperties.get('isTemporal');\r\n        if (isTemporal) {\r\n            temporalFieldset.children('fieldset').removeAttr('disabled');\r\n        } else {\r\n            temporalFieldset.children('fieldset').attr('disabled', 'disabled');\r\n        }\r\n\r\n        if (isTemporalCheckbox[0].checked != isTemporal) {\r\n            isTemporalCheckbox[0].checked = isTemporal;\r\n        }\r\n    }\r\n\r\n    var updateTemporalColumns = function() {\r\n        var parsedColumns = nsGmx.LayerProperties.parseColumns(layerProperties.get('Columns'));\r\n        temporalLayerView.updateColumns(parsedColumns.dateColumns);\r\n        if (parsedColumns.dateColumns.length === 0) {\r\n            isTemporalCheckbox.attr('disabled', 'disabled');\r\n            $('legend label', temporalFieldset).css('color', 'gray');\r\n            $('legend', temporalFieldset).attr('title', _gtxt(\"Отсутствует временной атрибут\"));\r\n            temporalProperties.set('isTemporal', false);\r\n        } else {\r\n            isTemporalCheckbox.removeAttr('disabled');\r\n            $('legend label', temporalFieldset).css('color', '');\r\n            $('legend', temporalFieldset).removeAttr('title');\r\n        }\r\n    }\r\n\r\n    temporalProperties.on('change:isTemporal', updateTemporalVisibility);\r\n    layerProperties.on('change:Columns', updateTemporalColumns);\r\n\r\n    var temporalFieldset = $('<fieldset/>').addClass('layer-fieldset').append(\r\n        $('<legend/>').append(\r\n            $('<label/>').append(isTemporalCheckbox).append(_gtxt(\"Данные с датой\"))\r\n        ),\r\n        $('<fieldset/>').append(temporalLayerParent) //вложенный fieldset нужен из-за бага в Opera\r\n    ).appendTo(parent);\r\n\r\n    updateTemporalVisibility();\r\n    updateTemporalColumns();\r\n\r\n    //каталог растров\r\n    var RCTemplate = Handlebars.compile(\r\n        '<fieldset class=\"layer-fieldset\">' +\r\n            '<legend><label>' +\r\n                '<input type=\"checkbox\" id=\"rc-params-isRC\" {{#isRC}}checked{{/isRC}}>{{i \"Каталог растров\"}}' +\r\n            '</label></legend>' +\r\n            //вложенный fieldset нужен из-за бага в Opera\r\n            '<fieldset {{^isRC}}disabled=\"disabled\"{{/isRC}}><div id=\"rc-params-div\"></div></fieldset>' +\r\n        '</fieldset>');\r\n\r\n    var rcFieldset = $(RCTemplate({\r\n            isRC: layerProperties.get('RC').get('IsRasterCatalog')\r\n        })).appendTo(parent);\r\n\r\n    // var rasterCatalogControl = new nsGmx.LayerRasterCatalogWidget($('#rc-params-div', rcFieldset), layerProperties.get('RC'));\r\n\r\n    // var quicklookTemplate = Handlebars.compile(\r\n    //     '<fieldset class=\"layer-fieldset\">' +\r\n    //         '<legend>{{i \"Накладываемое изображение\"}}</legend>' +\r\n    //         '<div class=\"layer-editor-quicklooks\"></div>' +\r\n    //     '</fieldset>'\r\n    // );\r\n\r\n    // var quicklookFieldset = $(quicklookTemplate()).appendTo(parent);\r\n\r\n    // var quicklookWidget = new nsGmx.LayerQuicklookWidget($('.layer-editor-quicklooks', quicklookFieldset), layerProperties);\r\n\r\n    $('#rc-params-isRC', rcFieldset).change(function() {\r\n        layerProperties.get('RC').set('IsRasterCatalog', this.checked);\r\n        rcFieldset.children('fieldset').prop('disabled', !this.checked);\r\n    });\r\n\r\n    //Шаблон имени\r\n    var nameObjectInput = _input(null,[['attr','fieldName','NameObject'],['attr','value',layerProperties.get('NameObject')],['dir','className','inputStyle'],['css','width','220px']])\r\n    nameObjectInput.onkeyup = function()\r\n    {\r\n        layerProperties.set('NameObject', this.value);\r\n        return true;\r\n    }\r\n\r\n    $('<div/>').append(\r\n        $('<span/>').text(_gtxt(\"Шаблон названий объектов\")).css('margin-left', '5px'),\r\n        nameObjectInput\r\n    ).appendTo(parent);\r\n}\r\n\r\nLayerEditor._initHooks = [];\r\nLayerEditor.addInitHook = function(hook) {\r\n    LayerEditor._initHooks.push(hook);\r\n}\r\n\r\nLayerEditor.applyInitHooks = function(layerEditor, layerProperties, params) {\r\n    LayerEditor._initHooks.forEach(function(hook){\r\n        params = hook(layerEditor, layerProperties, params) || params;\r\n    })\r\n\r\n    return params;\r\n}\r\n\r\nvar createLayerEditor = function(div, type, parent, properties, params) {\r\n    var def = $.Deferred();\r\n\r\n    params = $.extend(true, {}, params);\r\n\r\n    params.createdCallback = function() {\r\n        def.resolve(layerEditor);\r\n    }\r\n\r\n    var layerEditor = new LayerEditor(div, type, parent, properties, params);\r\n\r\n    return def;\r\n}\r\n\r\nnsGmx.LayerEditor = LayerEditor;\r\n\r\nwindow.gmxCore.addModule('LayerEditor', {\r\n        createLayerEditor: createLayerEditor,\r\n        LayerEditor: LayerEditor\r\n    }, {\r\n        // require: ['LayerProperties']\r\n    }\r\n)","﻿import nsGmx from './nsGmx.js';\r\n\r\nvar nsMapCommon = function($){\r\n    var publicInterface = {\r\n        generateWinniePermalink: function() {\r\n            var mapProps = nsGmx.gmxMap.properties,\r\n                lmap = nsGmx.leafletMap,\r\n                center = lmap.getCenter(),\r\n                layersState = {expanded: {}, visible: {}};\r\n\r\n            _layersTree.treeModel.forEachNode(function(elem) {\r\n                var props = elem.content.properties;\r\n                if (elem.type == 'group') {\r\n                    var groupId = props.GroupID;\r\n\r\n                    if ($(\"div[GroupID='\" + groupId + \"']\").length || props.changedByViewer) {\r\n                        layersState.expanded[groupId] = props.expanded;\r\n                    }\r\n                } else if (props.changedByViewer) {\r\n                    layersState.visible[props.name] = props.visible;\r\n                }                \r\n            });\r\n\r\n            var config = {\r\n                app: {\r\n                    gmxMap: {\r\n                        mapID: mapProps.name,\r\n                        apiKey: window.apiKey\r\n                    }\r\n                },\r\n                state: {\r\n                    map: {\r\n                        position: {\r\n                            x: center.lng,\r\n                            y: center.lat,\r\n                            z: lmap.getZoom()\r\n                        }\r\n                    },\r\n                    calendar: nsGmx.widgets.commonCalendar.getDateInterval().saveState(),\r\n                    baseLayersManager: lmap.gmxBaseLayersManager.saveState(),\r\n                    layersTree: layersState\r\n                }\r\n            }\r\n\r\n            return nsGmx.Utils.TinyReference.create(config, false);\r\n        },\r\n        /**\r\n        * Выбирает данные из дерева слоёв по описанию слоёв и групп\r\n        * @param {FlashMapObject} map - текущая карта\r\n        * @param {object} mapTree - дерево, в котором нужно искать\r\n        * @param {array} description - массив с описанием нужных слоёв. Каждый элемент массива может быть либо строкой (имя слоя), либо объектом {group: '<groupName>'} - выбрать все слои из группы\r\n        */\r\n        selectLayersFromTree: function(map, mapTree, description)\r\n        {\r\n            var _array = [];\r\n            var _hash = {};\r\n\r\n            var _getLayersInGroup = function(map, mapTree, groupTitle)\r\n            {\r\n                var res = {};\r\n                var visitor = function(treeElem, isInGroup)\r\n                {\r\n                    if (treeElem.type === \"layer\" && isInGroup)\r\n                    {\r\n                        res[treeElem.content.properties.name] = map.layers[treeElem.content.properties.name];\r\n                    }\r\n                    else if (treeElem.type === \"group\")\r\n                    {\r\n                        isInGroup = isInGroup || treeElem.content.properties.title == groupTitle;\r\n                        var a = treeElem.content.children;\r\n                        for (var k = a.length - 1; k >= 0; k--)\r\n                            visitor(a[k], isInGroup);\r\n                    }\r\n                }\r\n\r\n                visitor( {type: \"group\", content: { children: mapTree.children, properties: {} } }, false );\r\n                return res;\r\n            }\r\n\r\n            for (var k = 0; k < description.length; k++)\r\n                if ( typeof description[k] === \"string\" )\r\n                {\r\n                    _hash[description[k]] = map.layers[description[k]];\r\n                    _array.push( map.layers[description[k]] );\r\n                }\r\n                else if ('group' in description[k])\r\n                {\r\n                    var groupHash = _getLayersInGroup(map, mapTree, description[k].group);\r\n                    for (var l in groupHash)\r\n                    {\r\n                        _hash[l] = groupHash[l];\r\n                        _array.push( groupHash[l] );\r\n                    }\r\n                }\r\n\r\n            return {\r\n                asArray: function() { return _array; },\r\n                asHash: function() { return _hash; },\r\n                names: function()\r\n                {\r\n                    var res = [];\r\n\r\n                    for (var l in _hash)\r\n                        res.push(l);\r\n\r\n                    return res;\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    if (typeof window.gmxCore !== 'undefined')\r\n    {\r\n        window.gmxCore.addModule('MapCommon', publicInterface);\r\n    }\r\n\r\n    return publicInterface;\r\n}(jQuery);\r\n\r\nexport default nsMapCommon;","﻿import nsGmx from './nsGmx.js';\r\nimport {\r\n\tparseResponse,\r\n\tsendCrossDomainJSONRequest,\r\n} from './utilities.js';\r\n\r\n(function(){\r\n\r\n//Интерфейс для провайдеров значений параметров\r\nnsGmx.ILazyAttributeValuesProvider = function() {\r\n\tthis.isAttributeExists = function(){};\r\n\tthis.getValuesForAttribute = function(){};\r\n};\r\n\r\n//Простая обёртка над массивами для обратной совместимости\r\nnsGmx.LazyAttributeValuesProviderFromArray = function( attributes ) {\r\n\tvar _attrs = attributes;\r\n\r\n\tthis.isAttributeExists = function( attrName )\r\n\t{\r\n\t\treturn attrName in _attrs;\r\n\t};\r\n\r\n\tthis.getValuesForAttribute = function(attrName, callback )\t{\r\n\t\tif (attrName in _attrs )\r\n\t\t\tcallback(_attrs[attrName]);\r\n\t\telse\r\n\t\t\tcallback();\r\n\t};\r\n};\r\nnsGmx.LazyAttributeValuesProviderFromArray.prototype = new nsGmx.ILazyAttributeValuesProvider();\r\n\r\n/** При необходимости этот провайдер будет запрашивать значения аттрибутов у сервера\r\n * @class\r\n * @memberOf nsGmx\r\n * @param {Object} attributes Хеш имён атрибутов, значения которых хочется иметь\r\n * @param {String} layerName ID слоя\r\n*/\r\nnsGmx.LazyAttributeValuesProviderFromServer = function(attributes, layerName) {\r\n\tvar _attrs = attributes;\r\n\tvar _isInited = false;\r\n\tvar _isProcessing = false;\r\n\r\n\t//в процессе ожидания ответа от сервера мы можем получать запросы на разные аттрибуты\r\n\t//важно все их правильно сохранить и выхвать при получении данных\r\n\tvar _callbacks = {};\r\n\r\n    /** Проверить, есть ли такой атрибут\r\n        @param {String} attrName Имя атрибута\r\n        @return {Boolean} Есть ли такой атрибут среди атрибутов\r\n    */\r\n\tthis.isAttributeExists = function( attrName ) {\r\n\t\treturn attrName in _attrs;\r\n\t};\r\n\r\n    /** Получить доступные значения атрибута\r\n        @param {String} attrName Имя атрибута\r\n        @param {Function} callback Ф-ция, которая будет вызвана со списком атрибутов, когда он станет доступным\r\n    */\r\n\tthis.getValuesForAttribute = function( attrName, callback )\t{\r\n\t\tif ( !(attrName in _attrs) ) //вообще нет такого имени\r\n\t\t\tcallback();\r\n\t\telse if ( _attrs[attrName].length ) //есть вектор значений!\r\n\t\t\tcallback( _attrs[attrName] );\r\n\t\telse if (_isInited) //вектора значений всё ещё нет и уже ходили на сервер - второй раз пробовать не будем...\r\n\t\t\tcallback();\r\n\t\telse\r\n\t\t{\r\n\t\t\tif ( !(attrName in _callbacks) )\r\n\t\t\t\t_callbacks[attrName] = [];\r\n\r\n\t\t\t_callbacks[attrName].push(callback);\r\n\r\n\t\t\tif (_isProcessing) return;\r\n\t\t\t//идём на сервер и запрашиваем значения аттрибутов!\r\n\r\n\t\t\t_isProcessing = true;\r\n\t\t\tsendCrossDomainJSONRequest(window.serverBase + \"VectorLayer/GetVectorAttrValues.ashx?WrapStyle=func&LayerName=\" + layerName, function(response)\r\n\t\t\t{\r\n\t\t\t\t_isInited = true;\r\n\t\t\t\t_isProcessing = false;\r\n\t\t\t\tif (!parseResponse(response))\r\n\t\t\t\t{\r\n\t\t\t\t\tfor (let n in _callbacks)\r\n\t\t\t\t\t\tfor (let k = 0; k < _callbacks[n].length; k++)\r\n\t\t\t\t\t\t\t_callbacks[n][k]();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_attrs = response.Result;\r\n\t\t\t\tfor (let n in _callbacks)\r\n\t\t\t\t\tfor (let k = 0; k < _callbacks[n].length; k++)\r\n\t\t\t\t\t\t_callbacks[n][k](_attrs[n]);\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tthis.getAttributesTypesHash = function(layerName) {\r\n\t\tvar layer = nsGmx.gmxMap.layersByID[layerName],\r\n\t\t\tprops = layer.getGmxProperties && layer.getGmxProperties(),\r\n\t\t\tres = {};\r\n\r\n\t\tif (props) {\r\n\t\t\tvar attrTypes = props.attrTypes,\r\n\t\t\t\tattributes = props.attributes;\r\n\r\n\t\t\tfor (var i = 0; i < attributes.length; i++) {\r\n\t\t\t\tres[attributes[i]] = attrTypes[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn res;\r\n\t}\r\n\r\n\tvar _attrsTypes = this.getAttributesTypesHash(layerName);\r\n\r\n\tthis.getAttributeType = function (attr) {\r\n\t\treturn _attrsTypes[attr];\r\n\t}\r\n}\r\nnsGmx.LazyAttributeValuesProviderFromServer.prototype = new nsGmx.ILazyAttributeValuesProvider();\r\n\r\n})();\r\n","/**\r\n *\r\n * Zoomimage\r\n * Author: Stefan Petre www.eyecon.ro\r\n * \r\n */\r\n(function($){\r\n\tvar EYE = window.EYE = function() {\r\n\t\tvar _registered = {\r\n\t\t\tinit: []\r\n\t\t};\r\n\t\treturn {\r\n\t\t\tinit: function() {\r\n\t\t\t\t$.each(_registered.init, function(nr, fn){\r\n\t\t\t\t\tfn.call();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\textend: function(prop) {\r\n\t\t\t\tfor (var i in prop) {\r\n\t\t\t\t\tif (prop[i] != undefined) {\r\n\t\t\t\t\t\tthis[i] = prop[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tregister: function(fn, type) {\r\n\t\t\t\tif (!_registered[type]) {\r\n\t\t\t\t\t_registered[type] = [];\r\n\t\t\t\t}\r\n\t\t\t\t_registered[type].push(fn);\r\n\t\t\t}\r\n\t\t};\r\n\t}();\r\n\t$(EYE.init);\t\r\n})(jQuery);\r\n","import './eye.js';\r\n\r\n/**\r\n *\r\n * Utilities\r\n * Author: Stefan Petre www.eyecon.ro\r\n * \r\n */\r\n(function($) {\r\nwindow.EYE.extend({\r\n\tgetPosition : function(e, forceIt)\r\n\t{\r\n\t\tvar x = 0;\r\n\t\tvar y = 0;\r\n\t\tvar es = e.style;\r\n\t\tvar restoreStyles = false;\r\n\t\tif (forceIt && jQuery.curCSS(e,'display') == 'none') {\r\n\t\t\tvar oldVisibility = es.visibility;\r\n\t\t\tvar oldPosition = es.position;\r\n\t\t\trestoreStyles = true;\r\n\t\t\tes.visibility = 'hidden';\r\n\t\t\tes.display = 'block';\r\n\t\t\tes.position = 'absolute';\r\n\t\t}\r\n\t\tvar el = e;\r\n\t\tif (el.getBoundingClientRect) { // IE\r\n\t\t\tvar box = el.getBoundingClientRect();\r\n\t\t\tx = box.left + Math.max(document.documentElement.scrollLeft, document.body.scrollLeft) - 2;\r\n\t\t\ty = box.top + Math.max(document.documentElement.scrollTop, document.body.scrollTop) - 2;\r\n\t\t} else {\r\n\t\t\tx = el.offsetLeft;\r\n\t\t\ty = el.offsetTop;\r\n\t\t\tel = el.offsetParent;\r\n\t\t\tif (e != el) {\r\n\t\t\t\twhile (el) {\r\n\t\t\t\t\tx += el.offsetLeft;\r\n\t\t\t\t\ty += el.offsetTop;\r\n\t\t\t\t\tel = el.offsetParent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (jQuery.browser.safari && jQuery.curCSS(e, 'position') == 'absolute' ) {\r\n\t\t\t\tx -= document.body.offsetLeft;\r\n\t\t\t\ty -= document.body.offsetTop;\r\n\t\t\t}\r\n\t\t\tel = e.parentNode;\r\n\t\t\twhile (el && el.tagName.toUpperCase() != 'BODY' && el.tagName.toUpperCase() != 'HTML') \r\n\t\t\t{\r\n\t\t\t\tif (jQuery.curCSS(el, 'display') != 'inline') {\r\n\t\t\t\t\tx -= el.scrollLeft;\r\n\t\t\t\t\ty -= el.scrollTop;\r\n\t\t\t\t}\r\n\t\t\t\tel = el.parentNode;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (restoreStyles == true) {\r\n\t\t\tes.display = 'none';\r\n\t\t\tes.position = oldPosition;\r\n\t\t\tes.visibility = oldVisibility;\r\n\t\t}\r\n\t\treturn {x:x, y:y};\r\n\t},\r\n\tgetSize : function(e)\r\n\t{\r\n\t\tvar w = parseInt(jQuery.curCSS(e,'width'), 10);\r\n\t\tvar h = parseInt(jQuery.curCSS(e,'height'), 10);\r\n\t\tvar wb = 0;\r\n\t\tvar hb = 0;\r\n\t\tif (jQuery.curCSS(e, 'display') != 'none') {\r\n\t\t\twb = e.offsetWidth;\r\n\t\t\thb = e.offsetHeight;\r\n\t\t} else {\r\n\t\t\tvar es = e.style;\r\n\t\t\tvar oldVisibility = es.visibility;\r\n\t\t\tvar oldPosition = es.position;\r\n\t\t\tes.visibility = 'hidden';\r\n\t\t\tes.display = 'block';\r\n\t\t\tes.position = 'absolute';\r\n\t\t\twb = e.offsetWidth;\r\n\t\t\thb = e.offsetHeight;\r\n\t\t\tes.display = 'none';\r\n\t\t\tes.position = oldPosition;\r\n\t\t\tes.visibility = oldVisibility;\r\n\t\t}\r\n\t\treturn {w:w, h:h, wb:wb, hb:hb};\r\n\t},\r\n\tgetClient : function(e)\r\n\t{\r\n\t\tvar h, w;\r\n\t\tif (e) {\r\n\t\t\tw = e.clientWidth;\r\n\t\t\th = e.clientHeight;\r\n\t\t} else {\r\n\t\t\tvar de = document.documentElement;\r\n\t\t\tw = window.innerWidth || self.innerWidth || (de&&de.clientWidth) || document.body.clientWidth;\r\n\t\t\th = window.innerHeight || self.innerHeight || (de&&de.clientHeight) || document.body.clientHeight;\r\n\t\t}\r\n\t\treturn {w:w,h:h};\r\n\t},\r\n\tgetScroll : function (e)\r\n\t{\r\n\t\tvar t=0, l=0, w=0, h=0, iw=0, ih=0;\r\n\t\tif (e && e.nodeName.toLowerCase() != 'body') {\r\n\t\t\tt = e.scrollTop;\r\n\t\t\tl = e.scrollLeft;\r\n\t\t\tw = e.scrollWidth;\r\n\t\t\th = e.scrollHeight;\r\n\t\t} else  {\r\n\t\t\tif (document.documentElement) {\r\n\t\t\t\tt = document.documentElement.scrollTop;\r\n\t\t\t\tl = document.documentElement.scrollLeft;\r\n\t\t\t\tw = document.documentElement.scrollWidth;\r\n\t\t\t\th = document.documentElement.scrollHeight;\r\n\t\t\t} else if (document.body) {\r\n\t\t\t\tt = document.body.scrollTop;\r\n\t\t\t\tl = document.body.scrollLeft;\r\n\t\t\t\tw = document.body.scrollWidth;\r\n\t\t\t\th = document.body.scrollHeight;\r\n\t\t\t}\r\n\t\t\tif (typeof pageYOffset != 'undefined') {\r\n\t\t\t\tt = pageYOffset;\r\n\t\t\t\tl = pageXOffset;\r\n\t\t\t}\r\n\t\t\tiw = self.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0;\r\n\t\t\tih = self.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0;\r\n\t\t}\r\n\t\treturn { t: t, l: l, w: w, h: h, iw: iw, ih: ih };\r\n\t},\r\n\tgetMargins : function(e, toInteger)\r\n\t{\r\n\t\tvar t = jQuery.curCSS(e,'marginTop') || '';\r\n\t\tvar r = jQuery.curCSS(e,'marginRight') || '';\r\n\t\tvar b = jQuery.curCSS(e,'marginBottom') || '';\r\n\t\tvar l = jQuery.curCSS(e,'marginLeft') || '';\r\n\t\tif (toInteger)\r\n\t\t\treturn {\r\n\t\t\t\tt: parseInt(t, 10)||0,\r\n\t\t\t\tr: parseInt(r, 10)||0,\r\n\t\t\t\tb: parseInt(b, 10)||0,\r\n\t\t\t\tl: parseInt(l, 10)\r\n\t\t\t};\r\n\t\telse\r\n\t\t\treturn {t: t, r: r,\tb: b, l: l};\r\n\t},\r\n\tgetPadding : function(e, toInteger)\r\n\t{\r\n\t\tvar t = jQuery.curCSS(e,'paddingTop') || '';\r\n\t\tvar r = jQuery.curCSS(e,'paddingRight') || '';\r\n\t\tvar b = jQuery.curCSS(e,'paddingBottom') || '';\r\n\t\tvar l = jQuery.curCSS(e,'paddingLeft') || '';\r\n\t\tif (toInteger)\r\n\t\t\treturn {\r\n\t\t\t\tt: parseInt(t, 10)||0,\r\n\t\t\t\tr: parseInt(r, 10)||0,\r\n\t\t\t\tb: parseInt(b, 10)||0,\r\n\t\t\t\tl: parseInt(l, 10)\r\n\t\t\t};\r\n\t\telse\r\n\t\t\treturn {t: t, r: r,\tb: b, l: l};\r\n\t},\r\n\tgetBorder : function(e, toInteger)\r\n\t{\r\n\t\tvar t = jQuery.curCSS(e,'borderTopWidth') || '';\r\n\t\tvar r = jQuery.curCSS(e,'borderRightWidth') || '';\r\n\t\tvar b = jQuery.curCSS(e,'borderBottomWidth') || '';\r\n\t\tvar l = jQuery.curCSS(e,'borderLeftWidth') || '';\r\n\t\tif (toInteger)\r\n\t\t\treturn {\r\n\t\t\t\tt: parseInt(t, 10)||0,\r\n\t\t\t\tr: parseInt(r, 10)||0,\r\n\t\t\t\tb: parseInt(b, 10)||0,\r\n\t\t\t\tl: parseInt(l, 10)||0\r\n\t\t\t};\r\n\t\telse\r\n\t\t\treturn {t: t, r: r,\tb: b, l: l};\r\n\t},\r\n\ttraverseDOM : function(nodeEl, func)\r\n\t{\r\n\t\tfunc(nodeEl);\r\n\t\tnodeEl = nodeEl.firstChild;\r\n\t\twhile(nodeEl){\r\n\t\t\twindow.EYE.traverseDOM(nodeEl, func);\r\n\t\t\tnodeEl = nodeEl.nextSibling;\r\n\t\t}\r\n\t},\r\n\tgetInnerWidth :  function(el, scroll) {\r\n\t\tvar offsetW = el.offsetWidth;\r\n\t\treturn scroll ? Math.max(el.scrollWidth,offsetW) - offsetW + el.clientWidth:el.clientWidth;\r\n\t},\r\n\tgetInnerHeight : function(el, scroll) {\r\n\t\tvar offsetH = el.offsetHeight;\r\n\t\treturn scroll ? Math.max(el.scrollHeight,offsetH) - offsetH + el.clientHeight:el.clientHeight;\r\n\t},\r\n\tgetExtraWidth : function(el) {\r\n\t\tif($.boxModel)\r\n\t\t\treturn (parseInt($.curCSS(el, 'paddingLeft'))||0)\r\n\t\t\t\t+ (parseInt($.curCSS(el, 'paddingRight'))||0)\r\n\t\t\t\t+ (parseInt($.curCSS(el, 'borderLeftWidth'))||0)\r\n\t\t\t\t+ (parseInt($.curCSS(el, 'borderRightWidth'))||0);\r\n\t\treturn 0;\r\n\t},\r\n\tgetExtraHeight : function(el) {\r\n\t\tif($.boxModel)\r\n\t\t\treturn (parseInt($.curCSS(el, 'paddingTop'))||0)\r\n\t\t\t\t+ (parseInt($.curCSS(el, 'paddingBottom'))||0)\r\n\t\t\t\t+ (parseInt($.curCSS(el, 'borderTopWidth'))||0)\r\n\t\t\t\t+ (parseInt($.curCSS(el, 'borderBottomWidth'))||0);\r\n\t\treturn 0;\r\n\t},\r\n\tisChildOf: function(parentEl, el, container) {\r\n\t\tif (parentEl == el) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (!el || !el.nodeType || el.nodeType != 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (parentEl.contains) {\r\n\t\t\treturn parentEl.contains(el);\r\n\t\t}\r\n\t\tif ( parentEl.compareDocumentPosition ) {\r\n\t\t\treturn !!(parentEl.compareDocumentPosition(el) & 16);\r\n\t\t}\r\n\t\tvar prEl = el.parentNode;\r\n\t\twhile(prEl && prEl != container) {\r\n\t\t\tif (prEl == parentEl)\r\n\t\t\t\treturn true;\r\n\t\t\tprEl = prEl.parentNode;\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\tcenterEl : function(el, axis)\r\n\t{\r\n\t\tvar clientScroll = window.EYE.getScroll();\r\n\t\tvar size = window.EYE.getSize(el);\r\n\t\tif (!axis || axis == 'vertically')\r\n\t\t\t$(el).css(\r\n\t\t\t\t{\r\n\t\t\t\t\ttop: clientScroll.t + ((Math.min(clientScroll.h,clientScroll.ih) - size.hb)/2) + 'px'\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\tif (!axis || axis == 'horizontally')\r\n\t\t\t$(el).css(\r\n\t\t\t\t{\r\n\t\t\t\t\tleft: clientScroll.l + ((Math.min(clientScroll.w,clientScroll.iw) - size.wb)/2) + 'px'\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t}\r\n});\r\nif (!$.easing.easeout) {\r\n\t$.easing.easeout = function(p, n, firstNum, delta, duration) {\r\n\t\treturn -delta * ((n=n/duration-1)*n*n*n - 1) + firstNum;\r\n\t};\r\n}\r\n\t\r\n})(jQuery);","import './utils.js';\r\nimport '../css/colorpicker.css';\r\n\r\n/**\r\n *\r\n * Color picker\r\n * Author: Stefan Petre www.eyecon.ro\r\n * \r\n * Dual licensed under the MIT and GPL licenses\r\n * \r\n */\r\n(function ($) {\r\n\tvar ColorPicker = function () {\r\n\t\tvar\r\n\t\t\t// ids = {},\r\n\t\t\t// inAction,\r\n\t\t\tcharMin = 65,\r\n\t\t\t// visible,\r\n\t\t\ttpl = '<div class=\"colorpicker\"><div class=\"colorpicker_color\"><div><div></div></div></div><div class=\"colorpicker_hue\"><div></div></div><div class=\"colorpicker_new_color\"></div><div class=\"colorpicker_current_color\"></div><div class=\"colorpicker_hex\"><input type=\"text\" maxlength=\"6\" size=\"6\" /></div><div class=\"colorpicker_rgb_r colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_rgb_g colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_rgb_b colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_h colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_s colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_b colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_submit\"></div></div>',\r\n\t\t\tdefaults = {\r\n\t\t\t\teventName: 'click',\r\n\t\t\t\tonShow: function () {},\r\n\t\t\t\tonBeforeShow: function(){},\r\n\t\t\t\tonHide: function () {},\r\n\t\t\t\tonChange: function () {},\r\n\t\t\t\tonSubmit: function () {},\r\n\t\t\t\tcolor: 'ff0000',\r\n\t\t\t\tlivePreview: true,\r\n\t\t\t\tflat: false\r\n\t\t\t},\r\n\t\t\tfillRGBFields = function  (hsb, cal) {\r\n\t\t\t\tvar rgb = HSBToRGB(hsb);\r\n\t\t\t\t$(cal).data('colorpicker').fields\r\n\t\t\t\t\t.eq(1).val(rgb.r).end()\r\n\t\t\t\t\t.eq(2).val(rgb.g).end()\r\n\t\t\t\t\t.eq(3).val(rgb.b).end();\r\n\t\t\t},\r\n\t\t\tfillHSBFields = function  (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').fields\r\n\t\t\t\t\t.eq(4).val(hsb.h).end()\r\n\t\t\t\t\t.eq(5).val(hsb.s).end()\r\n\t\t\t\t\t.eq(6).val(hsb.b).end();\r\n\t\t\t},\r\n\t\t\tfillHexFields = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').fields\r\n\t\t\t\t\t.eq(0).val(HSBToHex(hsb)).end();\r\n\t\t\t},\r\n\t\t\tsetSelector = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').selector.css('backgroundColor', '#' + HSBToHex({h: hsb.h, s: 100, b: 100}));\r\n\t\t\t\t$(cal).data('colorpicker').selectorIndic.css({\r\n\t\t\t\t\tleft: parseInt(150 * hsb.s/100, 10),\r\n\t\t\t\t\ttop: parseInt(150 * (100-hsb.b)/100, 10)\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsetHue = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').hue.css('top', parseInt(150 - 150 * hsb.h/360, 10));\r\n\t\t\t},\r\n\t\t\tsetCurrentColor = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').currentColor.css('backgroundColor', '#' + HSBToHex(hsb));\r\n\t\t\t},\r\n\t\t\tsetNewColor = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').newColor.css('backgroundColor', '#' + HSBToHex(hsb));\r\n\t\t\t},\r\n\t\t\tkeyDown = function (ev) {\r\n\t\t\t\tvar pressedKey = ev.charCode || ev.keyCode || -1;\r\n\t\t\t\tif ((pressedKey > charMin && pressedKey <= 90) || pressedKey == 32) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar cal = $(this).parent().parent();\r\n\t\t\t\tif (cal.data('colorpicker').livePreview === true) {\r\n\t\t\t\t\tchange.apply(this);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchange = function (ev) {\r\n\t\t\t\tvar cal = $(this).parent().parent(), col;\r\n\t\t\t\tif (this.parentNode.className.indexOf('_hex') > 0) {\r\n\t\t\t\t\tcal.data('colorpicker').color = col = HexToHSB(fixHex(this.value));\r\n\t\t\t\t} else if (this.parentNode.className.indexOf('_hsb') > 0) {\r\n\t\t\t\t\tcal.data('colorpicker').color = col = fixHSB({\r\n\t\t\t\t\t\th: parseInt(cal.data('colorpicker').fields.eq(4).val(), 10),\r\n\t\t\t\t\t\ts: parseInt(cal.data('colorpicker').fields.eq(5).val(), 10),\r\n\t\t\t\t\t\tb: parseInt(cal.data('colorpicker').fields.eq(6).val(), 10)\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcal.data('colorpicker').color = col = RGBToHSB(fixRGB({\r\n\t\t\t\t\t\tr: parseInt(cal.data('colorpicker').fields.eq(1).val(), 10),\r\n\t\t\t\t\t\tg: parseInt(cal.data('colorpicker').fields.eq(2).val(), 10),\r\n\t\t\t\t\t\tb: parseInt(cal.data('colorpicker').fields.eq(3).val(), 10)\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t\tif (ev) {\r\n\t\t\t\t\tfillRGBFields(col, cal.get(0));\r\n\t\t\t\t\tfillHexFields(col, cal.get(0));\r\n\t\t\t\t\tfillHSBFields(col, cal.get(0));\r\n\t\t\t\t}\r\n\t\t\t\tsetSelector(col, cal.get(0));\r\n\t\t\t\tsetHue(col, cal.get(0));\r\n\t\t\t\tsetNewColor(col, cal.get(0));\r\n\t\t\t\tcal.data('colorpicker').onChange.apply(cal, [col, HSBToHex(col), HSBToRGB(col)]);\r\n\t\t\t},\r\n\t\t\tblur = function () {\r\n\t\t\t\tvar cal = $(this).parent().parent();\r\n\t\t\t\tcal.data('colorpicker').fields.parent().removeClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tfocus = function () {\r\n\t\t\t\tcharMin = this.parentNode.className.indexOf('_hex') > 0 ? 70 : 65;\r\n\t\t\t\t$(this).parent().parent().data('colorpicker').fields.parent().removeClass('colorpicker_focus');\r\n\t\t\t\t$(this).parent().addClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tdownIncrement = function (ev) {\r\n\t\t\t\tvar field = $(this).parent().find('input').focus();\r\n\t\t\t\tvar current = {\r\n\t\t\t\t\tel: $(this).parent().addClass('colorpicker_slider'),\r\n\t\t\t\t\tmax: this.parentNode.className.indexOf('_hsb_h') > 0 ? 360 : (this.parentNode.className.indexOf('_hsb') > 0 ? 100 : 255),\r\n\t\t\t\t\ty: ev.pageY,\r\n\t\t\t\t\tfield: field,\r\n\t\t\t\t\tval: parseInt(field.val(), 10),\r\n\t\t\t\t\tpreview: $(this).parent().parent().data('colorpicker').livePreview\t\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\t$(document).bind('mouseup', current, upIncrement);\r\n\t\t\t\t$(document).bind('mousemove', current, moveIncrement);\r\n\t\t\t},\r\n\t\t\tmoveIncrement = function (ev) {\r\n\t\t\t\tev.data.field.val(Math.max(0, Math.min(ev.data.max, parseInt(ev.data.val + ev.pageY - ev.data.y, 10))));\r\n\t\t\t\tif (ev.data.preview) {\r\n\t\t\t\t\tchange.apply(ev.data.field.get(0), [true]);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tupIncrement = function (ev) {\r\n\t\t\t\tchange.apply(ev.data.field.get(0), [true]);\r\n\t\t\t\tev.data.el.removeClass('colorpicker_slider').find('input').focus();\r\n\t\t\t\t$(document).unbind('mouseup', upIncrement);\r\n\t\t\t\t$(document).unbind('mousemove', moveIncrement);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tdownHue = function () {\r\n\t\t\t\tvar current = {\r\n\t\t\t\t\tcal: $(this).parent(),\r\n\t\t\t\t\ty: $(this).offset().top\r\n\t\t\t\t};\r\n\t\t\t\tcurrent.preview = current.cal.data('colorpicker').livePreview;\r\n\t\t\t\t$(document).bind('mouseup', current, upHue);\r\n\t\t\t\t$(document).bind('mousemove', current, moveHue);\r\n\t\t\t},\r\n\t\t\tmoveHue = function (ev) {\r\n\t\t\t\tchange.apply(\r\n\t\t\t\t\tev.data.cal.data('colorpicker')\r\n\t\t\t\t\t\t.fields\r\n\t\t\t\t\t\t.eq(4)\r\n\t\t\t\t\t\t.val(parseInt(360*(150 - Math.max(0,Math.min(150,(ev.pageY - ev.data.y))))/150, 10))\r\n\t\t\t\t\t\t.get(0),\r\n\t\t\t\t\t[ev.data.preview]\r\n\t\t\t\t);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tupHue = function (ev) {\r\n\t\t\t\tfillRGBFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\tfillHexFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\t$(document).unbind('mouseup', upHue);\r\n\t\t\t\t$(document).unbind('mousemove', moveHue);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tdownSelector = function () {\r\n\t\t\t\tvar current = {\r\n\t\t\t\t\tcal: $(this).parent(),\r\n\t\t\t\t\tpos: $(this).offset()\r\n\t\t\t\t};\r\n\t\t\t\tcurrent.preview = current.cal.data('colorpicker').livePreview;\r\n\t\t\t\t$(document).bind('mouseup', current, upSelector);\r\n\t\t\t\t$(document).bind('mousemove', current, moveSelector);\r\n\t\t\t},\r\n\t\t\tmoveSelector = function (ev) {\r\n\t\t\t\tchange.apply(\r\n\t\t\t\t\tev.data.cal.data('colorpicker')\r\n\t\t\t\t\t\t.fields\r\n\t\t\t\t\t\t.eq(6)\r\n\t\t\t\t\t\t.val(parseInt(100*(150 - Math.max(0,Math.min(150,(ev.pageY - ev.data.pos.top))))/150, 10))\r\n\t\t\t\t\t\t.end()\r\n\t\t\t\t\t\t.eq(5)\r\n\t\t\t\t\t\t.val(parseInt(100*(Math.max(0,Math.min(150,(ev.pageX - ev.data.pos.left))))/150, 10))\r\n\t\t\t\t\t\t.get(0),\r\n\t\t\t\t\t[ev.data.preview]\r\n\t\t\t\t);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tupSelector = function (ev) {\r\n\t\t\t\tfillRGBFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\tfillHexFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\t$(document).unbind('mouseup', upSelector);\r\n\t\t\t\t$(document).unbind('mousemove', moveSelector);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tenterSubmit = function () {\r\n\t\t\t\t$(this).addClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tleaveSubmit = function () {\r\n\t\t\t\t$(this).removeClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tclickSubmit = function () {\r\n\t\t\t\tvar cal = $(this).parent();\r\n\t\t\t\tvar col = cal.data('colorpicker').color;\r\n\t\t\t\tcal.data('colorpicker').origColor = col;\r\n\t\t\t\tsetCurrentColor(col, cal.get(0));\r\n\t\t\t\tcal.data('colorpicker').onSubmit(col, HSBToHex(col), HSBToRGB(col), cal.data('colorpicker').el);\r\n\t\t\t},\r\n\t\t\tshow = function () {\r\n\t\t\t\tvar cal = $('#' + $(this).data('colorpickerId'));\r\n\t\t\t\tcal.data('colorpicker').onBeforeShow.apply(this, [cal.get(0)]);\r\n\t\t\t\tvar pos = $(this).offset();\r\n\t\t\t\tvar viewPort = getViewport();\r\n\t\t\t\tvar top = pos.top + this.offsetHeight;\r\n\t\t\t\tvar left = pos.left;\r\n\t\t\t\tif (top + 176 > viewPort.t + viewPort.h) {\r\n\t\t\t\t\ttop -= this.offsetHeight + 176;\r\n\t\t\t\t}\r\n\t\t\t\tif (left + 356 > viewPort.l + viewPort.w) {\r\n\t\t\t\t\tleft -= 356;\r\n\t\t\t\t}\r\n\t\t\t\tcal.css({left: left + 'px', top: top + 'px'});\r\n\t\t\t\tif (cal.data('colorpicker').onShow.apply(this, [cal.get(0)]) != false) {\r\n\t\t\t\t\tcal.show();\r\n\t\t\t\t}\r\n\t\t\t\t$(document).bind('mousedown', {cal: cal}, hide);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\thide = function (ev) {\r\n\t\t\t\tif (!isChildOf(ev.data.cal.get(0), ev.target, ev.data.cal.get(0))) {\r\n\t\t\t\t\tif (ev.data.cal.data('colorpicker').onHide.apply(this, [ev.data.cal.get(0)]) != false) {\r\n\t\t\t\t\t\tev.data.cal.hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(document).unbind('mousedown', hide);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisChildOf = function(parentEl, el, container) {\r\n\t\t\t\tif (parentEl == el) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tif (parentEl.contains) {\r\n\t\t\t\t\treturn parentEl.contains(el);\r\n\t\t\t\t}\r\n\t\t\t\tif ( parentEl.compareDocumentPosition ) {\r\n\t\t\t\t\treturn !!(parentEl.compareDocumentPosition(el) & 16);\r\n\t\t\t\t}\r\n\t\t\t\tvar prEl = el.parentNode;\r\n\t\t\t\twhile (prEl && prEl != container) {\r\n\t\t\t\t\tif (prEl == parentEl)\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\tprEl = prEl.parentNode;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tgetViewport = function () {\r\n\t\t\t\tvar m = document.compatMode == 'CSS1Compat';\r\n\t\t\t\treturn {\r\n\t\t\t\t\tl : window.pageXOffset || (m ? document.documentElement.scrollLeft : document.body.scrollLeft),\r\n\t\t\t\t\tt : window.pageYOffset || (m ? document.documentElement.scrollTop : document.body.scrollTop),\r\n\t\t\t\t\tw : window.innerWidth || (m ? document.documentElement.clientWidth : document.body.clientWidth),\r\n\t\t\t\t\th : window.innerHeight || (m ? document.documentElement.clientHeight : document.body.clientHeight)\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tfixHSB = function (hsb) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\th: Math.min(360, Math.max(0, hsb.h)),\r\n\t\t\t\t\ts: Math.min(100, Math.max(0, hsb.s)),\r\n\t\t\t\t\tb: Math.min(100, Math.max(0, hsb.b))\r\n\t\t\t\t};\r\n\t\t\t}, \r\n\t\t\tfixRGB = function (rgb) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tr: Math.min(255, Math.max(0, rgb.r)),\r\n\t\t\t\t\tg: Math.min(255, Math.max(0, rgb.g)),\r\n\t\t\t\t\tb: Math.min(255, Math.max(0, rgb.b))\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tfixHex = function (hex) {\r\n\t\t\t\tvar len = 6 - hex.length;\r\n\t\t\t\tif (len > 0) {\r\n\t\t\t\t\tvar o = [];\r\n\t\t\t\t\tfor (var i=0; i<len; i++) {\r\n\t\t\t\t\t\to.push('0');\r\n\t\t\t\t\t}\r\n\t\t\t\t\to.push(hex);\r\n\t\t\t\t\thex = o.join('');\r\n\t\t\t\t}\r\n\t\t\t\treturn hex;\r\n\t\t\t}, \r\n\t\t\tHexToRGB = function (hex) {\r\n\t\t\t\thex = parseInt(((hex.indexOf('#') > -1) ? hex.substring(1) : hex), 16);\r\n\t\t\t\treturn {r: hex >> 16, g: (hex & 0x00FF00) >> 8, b: (hex & 0x0000FF)};\r\n\t\t\t},\r\n\t\t\tHexToHSB = function (hex) {\r\n\t\t\t\treturn RGBToHSB(HexToRGB(hex));\r\n\t\t\t},\r\n\t\t\tRGBToHSB = function (rgb) {\r\n\t\t\t\tvar hsb = {\r\n\t\t\t\t\th: 0,\r\n\t\t\t\t\ts: 0,\r\n\t\t\t\t\tb: 0\r\n\t\t\t\t};\r\n\t\t\t\tvar min = Math.min(rgb.r, rgb.g, rgb.b);\r\n\t\t\t\tvar max = Math.max(rgb.r, rgb.g, rgb.b);\r\n\t\t\t\tvar delta = max - min;\r\n\t\t\t\thsb.b = max;\t\t\t\t\r\n\t\t\t\thsb.s = max != 0 ? 255 * delta / max : 0;\r\n\t\t\t\tif (hsb.s != 0) {\r\n\t\t\t\t\tif (rgb.r == max) {\r\n\t\t\t\t\t\thsb.h = (rgb.g - rgb.b) / delta;\r\n\t\t\t\t\t} else if (rgb.g == max) {\r\n\t\t\t\t\t\thsb.h = 2 + (rgb.b - rgb.r) / delta;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\thsb.h = 4 + (rgb.r - rgb.g) / delta;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thsb.h = -1;\r\n\t\t\t\t}\r\n\t\t\t\thsb.h *= 60;\r\n\t\t\t\tif (hsb.h < 0) {\r\n\t\t\t\t\thsb.h += 360;\r\n\t\t\t\t}\r\n\t\t\t\thsb.s *= 100/255;\r\n\t\t\t\thsb.b *= 100/255;\r\n\t\t\t\treturn hsb;\r\n\t\t\t},\r\n\t\t\tHSBToRGB = function (hsb) {\r\n\t\t\t\tvar rgb = {};\r\n\t\t\t\tvar h = Math.round(hsb.h);\r\n\t\t\t\tvar s = Math.round(hsb.s*255/100);\r\n\t\t\t\tvar v = Math.round(hsb.b*255/100);\r\n\t\t\t\tif (s == 0) {\r\n\t\t\t\t\trgb.r = rgb.g = rgb.b = v;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar t1 = v;\r\n\t\t\t\t\tvar t2 = (255 - s) * v / 255;\r\n\t\t\t\t\tvar t3 = (t1 - t2) * (h % 60) / 60;\r\n\t\t\t\t\tif (h == 360) h = 0;\r\n\t\t\t\t\tif (h < 60) {rgb.r = t1; rgb.b = t2; rgb.g = t2 + t3}\r\n\t\t\t\t\telse if (h < 120) {rgb.g = t1; rgb.b = t2;\trgb.r = t1 - t3}\r\n\t\t\t\t\telse if (h < 180) {rgb.g = t1; rgb.r = t2;\trgb.b = t2 + t3}\r\n\t\t\t\t\telse if (h < 240) {rgb.b = t1; rgb.r = t2;\trgb.g = t1 - t3}\r\n\t\t\t\t\telse if (h < 300) {rgb.b = t1; rgb.g = t2;\trgb.r = t2 + t3}\r\n\t\t\t\t\telse if (h < 360) {rgb.r = t1; rgb.g = t2;\trgb.b = t1 - t3}\r\n\t\t\t\t\telse {rgb.r = 0; rgb.g = 0;\trgb.b = 0}\r\n\t\t\t\t}\r\n\t\t\t\treturn {r:Math.round(rgb.r), g:Math.round(rgb.g), b:Math.round(rgb.b)};\r\n\t\t\t},\r\n\t\t\tRGBToHex = function (rgb) {\r\n\t\t\t\tvar hex = [\r\n\t\t\t\t\trgb.r.toString(16),\r\n\t\t\t\t\trgb.g.toString(16),\r\n\t\t\t\t\trgb.b.toString(16)\r\n\t\t\t\t];\r\n\t\t\t\t$.each(hex, function (nr, val) {\r\n\t\t\t\t\tif (val.length == 1) {\r\n\t\t\t\t\t\thex[nr] = '0' + val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn hex.join('');\r\n\t\t\t},\r\n\t\t\tHSBToHex = function (hsb) {\r\n\t\t\t\treturn RGBToHex(HSBToRGB(hsb));\r\n\t\t\t},\r\n\t\t\trestoreOriginal = function () {\r\n\t\t\t\tvar cal = $(this).parent();\r\n\t\t\t\tvar col = cal.data('colorpicker').origColor;\r\n\t\t\t\tcal.data('colorpicker').color = col;\r\n\t\t\t\tfillRGBFields(col, cal.get(0));\r\n\t\t\t\tfillHexFields(col, cal.get(0));\r\n\t\t\t\tfillHSBFields(col, cal.get(0));\r\n\t\t\t\tsetSelector(col, cal.get(0));\r\n\t\t\t\tsetHue(col, cal.get(0));\r\n\t\t\t\tsetNewColor(col, cal.get(0));\r\n\t\t\t};\r\n\t\treturn {\r\n\t\t\tinit: function (opt) {\r\n\t\t\t\topt = $.extend({}, defaults, opt||{});\r\n\t\t\t\tif (typeof opt.color == 'string') {\r\n\t\t\t\t\topt.color = HexToHSB(opt.color);\r\n\t\t\t\t} else if (opt.color.r != undefined && opt.color.g != undefined && opt.color.b != undefined) {\r\n\t\t\t\t\topt.color = RGBToHSB(opt.color);\r\n\t\t\t\t} else if (opt.color.h != undefined && opt.color.s != undefined && opt.color.b != undefined) {\r\n\t\t\t\t\topt.color = fixHSB(opt.color);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.each(function () {\r\n\t\t\t\t\tif (!$(this).data('colorpickerId')) {\r\n\t\t\t\t\t\tvar options = $.extend({}, opt);\r\n\t\t\t\t\t\toptions.origColor = opt.color;\r\n\t\t\t\t\t\tvar id = 'collorpicker_' + parseInt(Math.random() * 1000);\r\n\t\t\t\t\t\t$(this).data('colorpickerId', id);\r\n\t\t\t\t\t\tvar cal = $(tpl).attr('id', id);\r\n\t\t\t\t\t\tif (options.flat) {\r\n\t\t\t\t\t\t\tcal.appendTo(this).show();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcal.appendTo(document.body);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\toptions.fields = cal\r\n\t\t\t\t\t\t\t\t\t\t\t.find('input')\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('keyup', keyDown)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('change', change)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('blur', blur)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('focus', focus);\r\n\t\t\t\t\t\tcal\r\n\t\t\t\t\t\t\t.find('span').bind('mousedown', downIncrement).end()\r\n\t\t\t\t\t\t\t.find('>div.colorpicker_current_color').bind('click', restoreOriginal);\r\n\t\t\t\t\t\toptions.selector = cal.find('div.colorpicker_color').bind('mousedown', downSelector);\r\n\t\t\t\t\t\toptions.selectorIndic = options.selector.find('div div');\r\n\t\t\t\t\t\toptions.el = this;\r\n\t\t\t\t\t\toptions.hue = cal.find('div.colorpicker_hue div');\r\n\t\t\t\t\t\tcal.find('div.colorpicker_hue').bind('mousedown', downHue);\r\n\t\t\t\t\t\toptions.newColor = cal.find('div.colorpicker_new_color');\r\n\t\t\t\t\t\toptions.currentColor = cal.find('div.colorpicker_current_color');\r\n\t\t\t\t\t\tcal.data('colorpicker', options);\r\n\t\t\t\t\t\tcal.find('div.colorpicker_submit')\r\n\t\t\t\t\t\t\t.bind('mouseenter', enterSubmit)\r\n\t\t\t\t\t\t\t.bind('mouseleave', leaveSubmit)\r\n\t\t\t\t\t\t\t.bind('click', clickSubmit);\r\n\t\t\t\t\t\tfillRGBFields(options.color, cal.get(0));\r\n\t\t\t\t\t\tfillHSBFields(options.color, cal.get(0));\r\n\t\t\t\t\t\tfillHexFields(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetHue(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetSelector(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetCurrentColor(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetNewColor(options.color, cal.get(0));\r\n\t\t\t\t\t\tif (options.flat) {\r\n\t\t\t\t\t\t\tcal.css({\r\n\t\t\t\t\t\t\t\tposition: 'relative',\r\n\t\t\t\t\t\t\t\tdisplay: 'block'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$(this).bind(options.eventName, show);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tshowPicker: function() {\r\n\t\t\t\treturn this.each( function () {\r\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\r\n\t\t\t\t\t\tshow.apply(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\thidePicker: function() {\r\n\t\t\t\treturn this.each( function () {\r\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\r\n\t\t\t\t\t\t$('#' + $(this).data('colorpickerId')).hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsetColor: function(col) {\r\n\t\t\t\tif (typeof col == 'string') {\r\n\t\t\t\t\tcol = HexToHSB(col);\r\n\t\t\t\t} else if (col.r != undefined && col.g != undefined && col.b != undefined) {\r\n\t\t\t\t\tcol = RGBToHSB(col);\r\n\t\t\t\t} else if (col.h != undefined && col.s != undefined && col.b != undefined) {\r\n\t\t\t\t\tcol = fixHSB(col);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.each(function(){\r\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\r\n\t\t\t\t\t\tvar cal = $('#' + $(this).data('colorpickerId'));\r\n\t\t\t\t\t\tcal.data('colorpicker').color = col;\r\n\t\t\t\t\t\tcal.data('colorpicker').origColor = col;\r\n\t\t\t\t\t\tfillRGBFields(col, cal.get(0));\r\n\t\t\t\t\t\tfillHSBFields(col, cal.get(0));\r\n\t\t\t\t\t\tfillHexFields(col, cal.get(0));\r\n\t\t\t\t\t\tsetHue(col, cal.get(0));\r\n\t\t\t\t\t\tsetSelector(col, cal.get(0));\r\n\t\t\t\t\t\tsetCurrentColor(col, cal.get(0));\r\n\t\t\t\t\t\tsetNewColor(col, cal.get(0));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t}();\r\n\t$.fn.extend({\r\n\t\tColorPicker: ColorPicker.init,\r\n\t\tColorPickerHide: ColorPicker.hidePicker,\r\n\t\tColorPickerShow: ColorPicker.showPicker,\r\n\t\tColorPickerSetColor: ColorPicker.setColor\r\n\t});\r\n})(jQuery);","import nsGmx from '../nsGmx.js';\r\nimport './GridPlugin.css';\r\nimport {leftMenu} from '../menu.js';\r\nimport '../gmxcore.js';\r\n\r\n(function() {\r\n    window._translationsHash.addtext('rus', {\r\n        gridPlugin: {\r\n            gridSettings: 'Настройка координатной сетки',\r\n            gridColorSettings: 'цвет',\r\n            gridStepSettings: 'шаг',\r\n            gridUnitsSettings: 'единицы',\r\n            gridFormatSettings: 'формат вывода',\r\n            set : 'установить',\r\n            reset : 'сбросить',\r\n            unitsKilometers : 'км',\r\n            unitsDegrees : 'градусы',\r\n            formatDecimal : 'десятичные градусы',\r\n            formatDM : 'градусы, минуты',\r\n            formatDMS : 'градусы, минуты, секунды',\r\n            latitude : 'по широте',\r\n            longitude : 'по долготе'\r\n        }\r\n    });\r\n    window._translationsHash.addtext('eng', {\r\n        gridPlugin: {\r\n            gridSettings : 'Coordinate grid settings',\r\n            gridColorSettings : 'color',\r\n            gridStepSettings : 'step',\r\n            gridUnitsSettings: 'units',\r\n            gridFormatSettings: 'format',\r\n            set : 'set',\r\n            reset : 'reset',\r\n            unitsKilometers : 'km',\r\n            unitsDegrees : 'degrees',\r\n            formatDecimal: 'decimal degrees',\r\n            formatDM: 'degrees minutes',\r\n            formatDMS : 'degrees minutes seconds',\r\n            latitude : 'latitude',\r\n            longitude: 'longitude'\r\n        }\r\n    });\r\n\r\n    // создает левое меню с параметрами координатной сетки\r\n    var ConfigureGridMenu = function (manager) {\r\n        var control = manager.gridControl,\r\n            tempStyle = {\r\n                outline: {\r\n                    color: control.options.color\r\n                }\r\n            },\r\n            lm = new leftMenu();\r\n\r\n        // заполняем левое меню\r\n        function createGridLeftMenu() {\r\n            var gridConfigLeftMenu = nsGmx.Utils._div(null, [['dir','className','gridConfigLeftMenu']]);\r\n            createGridConfig(gridConfigLeftMenu);\r\n\r\n            return gridConfigLeftMenu;\r\n        }\r\n\r\n        // создание элементов отображения настроек сетки\r\n        function createGridConfig(menu) {\r\n            var gridConfigCanvas = nsGmx.Utils._div(null, [['dir','className','gridSettings']]),\r\n                gridConfigTitle = nsGmx.Utils._span(null, [['dir','className','gridSettingsTitle']]),\r\n                gridConfigIcon = CreateGridConfigIcon(tempStyle, 'linestring');\r\n\r\n            $(gridConfigIcon).find('.borderIcon')[0].style.borderColor = tempStyle.outline.color;\r\n            $(gridConfigTitle).append(window._gtxt('gridPlugin.gridSettings'));\r\n            $(gridConfigCanvas).append(gridConfigIcon, gridConfigTitle);\r\n            $(menu).append(gridConfigCanvas);\r\n\r\n            gridConfigIcon.onclick = function () {\r\n                createConfigDialog(this);\r\n            };\r\n        }\r\n\r\n        // диалоговое окно для редактирования координатной сетки\r\n        function createConfigDialog(elem) {\r\n            if (manager.configDialog) {\r\n                return;\r\n            }\r\n            var map = nsGmx.leafletMap,\r\n                gridConfigEditor = nsGmx.Utils._div(null, [['dir','className','gridConfigEditor']]);\r\n\r\n            // редактирование цвета сетки - колорпикер\r\n            var fcp = nsGmx.Controls.createColorPicker(tempStyle.outline.color,\r\n                function (colpkr) {\r\n                    $(colpkr).fadeIn(500);\r\n                    return false;\r\n                },\r\n                function (colpkr) {\r\n                    $(colpkr).fadeOut(500);\r\n                    $(this).change();\r\n                    return false;\r\n                },\r\n                function (hsb, hex) {\r\n                    tempStyle.outline.color = '#' + hex;\r\n                    fcp.style.backgroundColor = tempStyle.outline.color;\r\n                    control.setColor(tempStyle.outline.color);\r\n                    $(elem).find('.borderIcon')[0].style.borderColor = tempStyle.outline.color;\r\n                    manager.saveOptions();\r\n                    $(this).ColorPickerSetColor(tempStyle.outline.color);\r\n                    $(this).change();\r\n                }\r\n            );\r\n\r\n            $(fcp).ColorPickerSetColor(tempStyle.outline.color);\r\n            $(fcp).css('background-color', tempStyle.outline.color);\r\n\r\n            // редактирования шага сетки\r\n            var gridStepYInputPanel = nsGmx.Utils._span(null, [['dir','className','gridStepConfig']]),\r\n                gridStepXInputPanel = nsGmx.Utils._span(null, [['dir','className','gridStepConfig']]),\r\n                gridStepYInput = nsGmx.Utils._input(null, [['dir','className','gridStepInput']]),\r\n                gridStepXInput = nsGmx.Utils._input(null, [['dir','className','gridStepInput']]),\r\n                gridUnitsConfig = nsGmx.Utils._span(null, [['dir','className','gridStepConfig']]),\r\n                gridStepConfig = nsGmx.Utils._span(null, [['dir','className','gridStepConfig']]),\r\n                gridFormatConfig = nsGmx.Utils._span(null, [['dir','className','gridFormatConfig']]),\r\n                gridStepUnitsDegrees = nsGmx.Utils._input(null, [\r\n                    ['dir','id','gridStepUnitsDegrees'],\r\n                    ['attr', 'type', 'radio'],\r\n                    ['attr', 'id', 'gridStepUnitsDegrees'],\r\n                    ['attr', 'name', 'gridStepUnits'],\r\n                    ['attr', 'value', 'degrees']\r\n                ]),\r\n                gridStepUnitsKilometers = nsGmx.Utils._input(null, [\r\n                    ['dir','id','gridStepUnitsKilometers'],\r\n                    ['attr', 'type', 'radio'],\r\n                    ['attr', 'name', 'gridStepUnits'],\r\n                    ['attr', 'value', 'kilometers']\r\n                ]),\r\n                gridFormatDD = nsGmx.Utils._input(null, [\r\n                    ['dir','id','gridFormatDD'],\r\n                    ['attr', 'type', 'radio'],\r\n                    ['attr', 'name', 'gridFormat'],\r\n                    ['attr', 'value', 0],\r\n                    control.options.units === 'kilometers' ? ['attr', 'disabled', true] : []\r\n                ]),\r\n                gridFormatDM = nsGmx.Utils._input(null, [\r\n                    ['dir','id','gridFormatDM'],\r\n                    ['attr', 'type', 'radio'],\r\n                    ['attr', 'name', 'gridFormat'],\r\n                    ['attr', 'value', 1],\r\n                    control.options.units === 'kilometers' ? ['attr', 'disabled', true] : []\r\n                ]),\r\n                gridFormatDMS = nsGmx.Utils._input(null, [\r\n                    ['dir','id','gridFormatDMS'],\r\n                    ['attr', 'type', 'radio'],\r\n                    ['attr', 'name', 'gridFormat'],\r\n                    ['attr', 'value', 2],\r\n                    control.options.units === 'kilometers' ? ['attr', 'disabled', true] : []\r\n                ]),\r\n                gridSetStepButton = nsGmx.Utils._button([nsGmx.Utils._t(window._gtxt('gridPlugin.set'))], [['dir', 'className', 'gridStepButton']]),\r\n                gridResetStepButton = nsGmx.Utils._button([nsGmx.Utils._t(window._gtxt('gridPlugin.reset'))], [['dir', 'className', 'gridStepButton']]);\r\n\r\n            $(gridStepYInputPanel).append(\r\n                gridStepYInput,\r\n                nsGmx.Utils._t(window._gtxt('gridPlugin.latitude'))\r\n            );\r\n\r\n            $(gridStepXInputPanel).append(\r\n                gridStepXInput,\r\n                nsGmx.Utils._t(window._gtxt('gridPlugin.longitude'))\r\n            );\r\n\r\n            $(gridUnitsConfig).append(\r\n              nsGmx.Utils._label(\r\n                  [gridStepUnitsDegrees, nsGmx.Utils._t(window._gtxt('gridPlugin.unitsDegrees'))],\r\n                  [['dir', 'className', 'gridUnitsLabel'], ['attr', 'for', 'gridStepUnitsDegrees']]\r\n\r\n              ),\r\n              nsGmx.Utils._label(\r\n                  [gridStepUnitsKilometers, nsGmx.Utils._t(window._gtxt('gridPlugin.unitsKilometers'))],\r\n                  [['dir', 'className', 'gridUnitsLabel'], ['attr', 'for', 'gridStepUnitsKilometers']]\r\n              )\r\n            );\r\n\r\n            $(gridFormatConfig).append(\r\n                nsGmx.Utils._label(\r\n                    [gridFormatDD, nsGmx.Utils._t(window._gtxt('gridPlugin.formatDecimal'))],\r\n                    [\r\n                        ['dir', 'className', control.options.units === 'kilometers' ? 'gridFormatLabel disabledLabel' : 'gridFormatLabel'],\r\n                        ['attr', 'for', 'gridFormatDD']\r\n                    ]\r\n                ),\r\n                $('<br></br>'),\r\n                nsGmx.Utils._label(\r\n                    [gridFormatDM, nsGmx.Utils._t(window._gtxt('gridPlugin.formatDM'))],\r\n                    [\r\n                        ['dir', 'className', control.options.units === 'kilometers' ? 'gridFormatLabel disabledLabel' : 'gridFormatLabel'],\r\n                        ['attr', 'for', 'gridFormatDM']\r\n                    ]\r\n                ),\r\n                $('<br></br>'),\r\n                nsGmx.Utils._label(\r\n                    [gridFormatDMS, nsGmx.Utils._t(window._gtxt('gridPlugin.formatDMS'))],\r\n                    [\r\n                        ['dir', 'className', control.options.units === 'kilometers' ? 'gridFormatLabel disabledLabel' : 'gridFormatLabel'],\r\n                        ['attr', 'for', 'gridFormatDMS']\r\n                    ]\r\n                )\r\n            );\r\n\r\n            $(gridStepConfig).append(\r\n                gridSetStepButton,\r\n                gridResetStepButton\r\n            );\r\n\r\n            $(gridConfigEditor).append(nsGmx.Utils._table([\r\n                nsGmx.Utils._tbody([\r\n                    nsGmx.Utils._tr([\r\n                        nsGmx.Utils._td([nsGmx.Utils._t(window._gtxt('gridPlugin.gridColorSettings'))], [['css','width','70px']]),\r\n                        nsGmx.Utils._td([fcp])\r\n                    ]),\r\n                    nsGmx.Utils._tr(\r\n                        null, [['dir', 'className', 'bigEmptyTableRow']]\r\n                    ),\r\n                    nsGmx.Utils._tr([\r\n                        nsGmx.Utils._td([nsGmx.Utils._t(window._gtxt('gridPlugin.gridStepSettings'))], [['attr', 'rowspan', '2'], ['css','width','70px']]),\r\n                        nsGmx.Utils._td([gridStepYInputPanel])\r\n                    ]),\r\n                    nsGmx.Utils._tr([\r\n                        nsGmx.Utils._td([gridStepXInputPanel])\r\n                    ]),\r\n                    nsGmx.Utils._tr(\r\n                      null, [['dir', 'className', 'bigEmptyTableRow']]\r\n                    ),\r\n                    nsGmx.Utils._tr([\r\n                        nsGmx.Utils._td([nsGmx.Utils._t(window._gtxt('gridPlugin.gridUnitsSettings'))], [['css','width','70px']]),\r\n                        nsGmx.Utils._td([gridUnitsConfig])\r\n                    ]),\r\n                    nsGmx.Utils._tr(\r\n                        null, [['dir', 'className', 'bigEmptyTableRow']]\r\n                    ),\r\n                    nsGmx.Utils._tr([\r\n                        nsGmx.Utils._td([nsGmx.Utils._t(window._gtxt('gridPlugin.gridFormatSettings'))], [\r\n                            ['css','width','70px'], ['css', 'vertical-align', 'middle']]),\r\n                        nsGmx.Utils._td([gridFormatConfig])\r\n                    ]),\r\n                    nsGmx.Utils._tr(\r\n                      null, [['dir', 'className', 'bigEmptyTableRow']]\r\n                    ),\r\n                    nsGmx.Utils._tr([\r\n                        nsGmx.Utils._td(null, [['css','width','70px']]),\r\n                        nsGmx.Utils._td([gridStepConfig])\r\n                    ])\r\n                ])\r\n            ], [['dir', 'className', 'gridConfigTable']]));\r\n\r\n            if (control.options.units === 'degrees') {\r\n                gridStepUnitsDegrees.checked = true;\r\n                enableFormats();\r\n            } else if (control.options.units === 'kilometers') {\r\n                gridStepUnitsKilometers.checked = true;\r\n                disableFormats();\r\n            }\r\n\r\n            gridStepUnitsDegrees.onclick = handleUnits;\r\n            gridStepUnitsKilometers.onclick = handleUnits;\r\n\r\n            gridFormatDD.onclick = handleFormats;\r\n            gridFormatDM.onclick = handleFormats;\r\n            gridFormatDMS.onclick = handleFormats;\r\n\r\n            gridSetStepButton.onclick = function () {\r\n                control.setStep(gridStepXInput.value, gridStepYInput.value);\r\n                updateInputsValues();\r\n            };\r\n\r\n            gridResetStepButton.onclick = function () {\r\n                control.setTitleFormat(0);\r\n                control.clearStep();\r\n                enableFormats();\r\n                gridStepUnitsDegrees.checked = true;\r\n                gridFormatDD.checked = true;\r\n                updateInputsValues();\r\n            };\r\n\r\n            gridStepUnitsDegrees.checked = true;\r\n            gridFormatDD.checked = true;\r\n            updateInputsValues();\r\n            handleFormats();\r\n\r\n            map.on('zoomend', function () {\r\n                control.repaint();\r\n                updateInputsValues();\r\n            });\r\n\r\n            var pos = nsGmx.Utils.getDialogPos(elem, false, 0);\r\n\r\n            var closeFunc = function () {\r\n                $(gridConfigEditor).find('.colorSelector').each(function() {\r\n                    $('#' + $(this).data('colorpickerId')).remove();\r\n                });\r\n                manager.configDialog = null;\r\n                control.options.units  === 'degrees' ? enableFormats() : disableFormats();\r\n\r\n                // control.clearStep();\r\n            };\r\n\r\n            var params = {\r\n                width: 280,\r\n                height: 280,\r\n                posX: pos.left,\r\n                posY: pos.top,\r\n                resizeFunc: false,\r\n                closeFunc: closeFunc\r\n            };\r\n\r\n            manager.configDialog = nsGmx.Utils.showDialog(window._gtxt('gridPlugin.gridSettings'), gridConfigEditor, params);\r\n\r\n            function updateInputsValues() {\r\n                gridStepXInput.value = control.options.customStep.x ? Math.round(control.options.customStep.x * 100) / 100 : control.options.defaultStep.x;\r\n                gridStepYInput.value = control.options.customStep.y ? Math.round(control.options.customStep.y * 100) / 100 : control.options.defaultStep.y;\r\n            }\r\n\r\n            function handleUnits() {\r\n                var value = this.value;\r\n                if (control.options.units !== value) {\r\n                    control.setUnits(value);\r\n                }\r\n                value === 'degrees' ? enableFormats() : disableFormats();\r\n                        updateInputsValues();\r\n            }\r\n\r\n            function handleFormats() {\r\n                var value = this.value;\r\n                if (control.options.titleFormat !== value) {\r\n                    control.setTitleFormat(value);\r\n                }\r\n            }\r\n\r\n            function disableFormats() {\r\n                $('#gridFormatDD').prop('disabled', true);\r\n                $('#gridFormatDM').prop('disabled', true);\r\n                $('#gridFormatDMS').prop('disabled', true);\r\n\r\n                $('.gridFormatLabel').addClass('disabledLabel');\r\n            }\r\n\r\n            function enableFormats() {\r\n                $('#gridFormatDD').prop('disabled', false);\r\n                $('#gridFormatDM').prop('disabled', false);\r\n                $('#gridFormatDMS').prop('disabled', false);\r\n\r\n                $('.gridFormatLabel').removeClass('disabledLabel');\r\n            }\r\n        }\r\n\r\n        // создание иконки редактирования стиля\r\n        function CreateGridConfigIcon(style, type) {\r\n            var icon = nsGmx.Controls.createGeometryIcon(style, type);\r\n            nsGmx.Utils._title(icon, window._gtxt('gridPlugin.gridSettings'));\r\n            return icon;\r\n        }\r\n\r\n        this.Load = function () {\r\n            if (lm != null){\r\n                var alreadyLoaded = lm.createWorkCanvas('mapGrid', function () {\r\n                    if (manager.state) {\r\n                        manager.setState({isActive: false});\r\n                    } else {\r\n                        this.Unload();\r\n                    }\r\n                });\r\n                if (!alreadyLoaded) {\r\n                    $(lm.workCanvas).append(createGridLeftMenu());\r\n                    control.setColor(tempStyle.outline.color);\r\n                    manager.saveOptions();\r\n                }\r\n            }\r\n        }\r\n        this.Unload = function () {\r\n            $(manager.configDialog).remove();\r\n            manager.configDialog = null;\r\n            $(lm.parentWorkCanvas).hide();\r\n        };\r\n    }\r\n\r\n    var publicInterface = {\r\n        pluginName: 'GridPlugin',\r\n        ConfigureGridMenu: ConfigureGridMenu\r\n  };\r\n\r\n    window.gmxCore.addModule('GridPlugin',\r\n        publicInterface\r\n    );\r\n})();\r\n","import nsGmx from '../nsGmx.js';\r\nimport '../drawingObjectsCustomControllers.js';\r\nimport {leftMenu} from '../menu.js';\r\nimport {\r\n    _div,\r\n    parseResponse,\r\n    sendCrossDomainJSONRequest,\r\n} from '../utilities.js';\r\nimport '../AsyncTaskManager.js';\r\nimport './MapExport.css';\r\n\r\n    var MAX_SIZE = 10000;\r\n    var EPS = 1E-9;\r\n\r\n    // мы не хотим, чтобы рамка фигурировала в списке пользовательских объектов\r\n    nsGmx.DrawingObjectCustomControllers.addDelegate({\r\n        isHidden: function(obj) {\r\n            if (obj.options.exportRect) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n    });\r\n\r\n    window._translationsHash.addtext('rus', {\r\n        mapExport: {\r\n            settings: {\r\n                settings: 'Настройки экспорта карты:',\r\n                zoom: 'масштаб (зум)',\r\n                size: 'размер',\r\n                format: 'формат растра',\r\n                fileType: 'тип файла',\r\n                width: 'ширина (пк)',\r\n                height: 'высота (пк)',\r\n                name: 'имя файла'\r\n            },\r\n            formats: {\r\n\t\t\t\tgeoTiff: 'GEOTIFF',\r\n\t\t\t\tgeoTiffJpeg: 'GEOTIFF-JPEG',\r\n                jpeg: 'JPEG',\r\n                png: 'PNG'\r\n            },\r\n            filetypes: {\r\n                raster: 'растр',\r\n                mbTiles: 'MBTiles',\r\n                kmz: 'kmz'\r\n            },\r\n            select: 'Выделить область карты',\r\n            unselect: 'Снять выделение',\r\n            zoomToBox: 'Перейти к выделенному',\r\n            zoomToLevel: 'Перейти на зум',\r\n            exportMap: 'Экспорт',\r\n            cancel: 'Отмена',\r\n            sizeWarn: 'максимальный размер - 10000 пикселей',\r\n            valueWarn: 'недопустимое значение',\r\n            inQueue: 'в очереди',\r\n            inProcess: 'файл формируется',\r\n            exportError: 'ошибка экспорта'\r\n        }\r\n    });\r\n    window._translationsHash.addtext('eng', {\r\n        mapExport: {\r\n            exportTooltip: 'Select area',\r\n            settings: {\r\n                settings: 'Map export settings:',\r\n                zoom: 'zoom',\r\n                size: 'size',\r\n                format: 'raster format',\r\n                fileType: 'file type',\r\n                width: 'width (px)',\r\n                height: 'height (px)',\r\n                name: 'file name'\r\n            },\r\n            formats: {\r\n\t\t\t\tgeoTiff: 'GEOTIFF',\r\n\t\t\t\tgeoTiffJpeg: 'GEOTIFF-JPEG',\r\n                jpeg: 'JPEG',\r\n                png: 'PNG'\r\n            },\r\n            filetypes: {\r\n                raster: 'raster',\r\n                mbTiles: 'MBTiles',\r\n                kmz: 'kmz'\r\n            },\r\n            select: 'Select',\r\n            unselect: 'Clear selection',\r\n            zoomToBox: 'Zoom to selected',\r\n            zoomToLevel: 'Zoom to level',\r\n            exportMap: 'Export',\r\n            cancel: 'Cancel',\r\n            sizeWarn: 'incorrect size',\r\n            valueWarn: 'incorrect value',\r\n            inQueue: 'waiting',\r\n            inProcess: 'processing file',\r\n            exportError: 'export error'\r\n        }\r\n    });\r\n\r\n    var formatTypes = [\r\n        'geoTiff',\r\n\t\t'geoTiffJpeg',\r\n\t\t'jpeg',\r\n        'png'\t\t\r\n    ];\r\n\r\n    var view;\r\n\r\n    var MapExportMenu = function () {\r\n        var canvas = _div(null, [['dir','className','mapExportConfigLeftMenu']]);\r\n\r\n        var ExportModel = Backbone.Model.extend({\r\n            defaults: {\r\n                lm: new leftMenu(),\r\n                lmap: nsGmx.leafletMap,\r\n                selArea: null,\r\n                exportMode: true,\r\n                width: 0,\r\n                height: 0,\r\n                widthValueErr: false,\r\n                heightValueErr: false,\r\n                widthSizeErr: false,\r\n                heightSizeErr: false,\r\n                format: null,\r\n                fileType: null,\r\n                x: null,\r\n                y: null,\r\n                z: null,\r\n                latLng: null,\r\n                coords: null,\r\n                zoomLevels: getZoomLevels(),\r\n                formatTypes: getTypes(formatTypes),\r\n                fileTypes: null,\r\n                name: '',\r\n                taskInfo: null,\r\n                exportErr: false\r\n            }\r\n        });\r\n\r\n        var model = new ExportModel();\r\n\r\n        var ExportView = Backbone.View.extend({\r\n            el: $(canvas),\r\n            model: model,\r\n            template: Handlebars.compile(\r\n                '<div class=\"selectButtons\">' +\r\n                        '<span class=\"buttonLink areaButton mapExportSelectButton\"> {{i \"mapExport.select\"}}</span>' +\r\n                        '<span class=\"zoomToBoxButton\" style=\"display:none\">' +\r\n                        '</span>' +\r\n                '</div>' +\r\n                '<div class=\"exportSettings\">' +\r\n                    '<span>' +\r\n                        '{{i \"mapExport.settings.settings\"}}' +\r\n                    '</span>' +\r\n                '</div>' +\r\n                '<table class=\"settings\">' +\r\n                    '<tbody>' +\r\n                        '<tr class=\"zoomSelect\">' +\r\n                            '<td class=\"eLabel\">{{i \"mapExport.settings.zoom\"}}</td>' +\r\n                            '<td class=\"eInput\">' +\r\n                                '<select class=\"zoomLevel\">' +\r\n                                    '{{#each this.zoomLevels}}' +\r\n                                    '<option value=\"{{this.zoom}}\"' +\r\n                                        '{{#if this.current}} selected=\"selected\"{{/if}}>' +\r\n                                        '{{this.zoom}}' +\r\n                                    '</option>' +\r\n                                    '{{/each}}' +\r\n                                '</select>' +\r\n                            '</td>' +\r\n                            '<td class=\"zoomToLevel\">' +\r\n                                '<span class=\"zoomToLevelButtonWrap\" style=\"display:none\">' +\r\n                                '</span>' +\r\n                            '</td>' +\r\n                        '</tr>' +\r\n                        '<tr class=\"dims\">' +\r\n                            '<td class=\"eLabel\">{{i \"mapExport.settings.width\"}}</td>' +\r\n                            '<td class=\"eInput\">' +\r\n                                '<input type=\"text\" class=\"mapExportWidth\" value=\"{{width}}\"/>' +\r\n                            '</td>' +\r\n                            '<td class=\"mapExportWarn\" rowspan=2></td>' +\r\n                        '</tr>' +\r\n                        '<tr class=\"dims\">' +\r\n                            '<td class=\"eLabel\">{{i \"mapExport.settings.height\"}}</td>' +\r\n                            '<td class=\"eInput\">' +\r\n                                '<input type=\"text\" class=\"mapExportHeight\" value=\"{{height}}\"/>' +\r\n                            '</td>' +\r\n                        '</tr>' +\r\n                        '<tr class=\"formatSelect\">' +\r\n                            '<td class=\"eLabel\">{{i \"mapExport.settings.format\"}}</td>' +\r\n                            '<td class=\"eInput\">' +\r\n                                '<select class=\"formatTypes\">' +\r\n                                    '{{#each this.formatTypes}}' +\r\n                                    '<option value=\"{{this.type}}\"' +\r\n                                        '{{#if this.current}} selected=\"selected\" {{/if}}>' +\r\n                                        '{{this.type}}' +\r\n                                    '</option>' +\r\n                                    '{{/each}}' +\r\n                                '</select>' +\r\n                            '</td>' +\r\n                        '</tr>' +\r\n                        '<tr class=\"typeSelect\">' +\r\n                            '<td class=\"eLabel\">{{i \"mapExport.settings.fileType\"}}</td>' +\r\n                            '<td class=\"eInput\">' +\r\n                                '<select class=\"fileTypes\">' +\r\n                                    '{{#each this.fileTypes}}' +\r\n                                    '<option value=\"{{this.type}}\"' +\r\n                                        '{{#if this.current}} selected=\"selected\" {{/if}}>' +\r\n                                        '{{this.type}}' +\r\n                                    '</option>' +\r\n                                    '{{/each}}' +\r\n                                '</select>' +\r\n                            '</td>' +\r\n                        '</tr>' +\r\n                        '<tr class=\"nameSelect\">' +\r\n                            '<td class=\"eLabel\">{{i \"mapExport.settings.name\"}}</td>' +\r\n                            '<td class=\"eInput\">' +\r\n                                '<input type=\"text\" class=\"mapExportName\" value=\"\"/>' +\r\n                            '</td>' +\r\n                        '</tr>' +\r\n                    '</tbody>' +\r\n                '</table>' +\r\n                '<div class=\"exportWrap\">' +\r\n                    '<div class=\"export\">' +\r\n                        '<span class=\"buttonLink mapExportButton\"> {{i \"mapExport.exportMap\"}}</span>' +\r\n                        '<span class=\"buttonLink cancelButton\" style=\"display:none\"> {{i \"mapExport.cancel\"}}</span>' +\r\n                        '<span class=\"spinHolder\" style=\"display:none\">' +\r\n                            // '<img src=\"img/progress.gif\"/>' +\r\n                            '<span class=\"spinMessage\"></span>' +\r\n                            '</span>' +\r\n                        '<span class=\"exportErrorMessage\" style=\"display:none\">{{i \"mapExport.exportError\"}}</span>' +\r\n                    '</div>' +\r\n                    '<div class=\"export-progress-container\" style=\"display:none\">' +\r\n                        '<div class=\"export-progressbar\"></div>' +\r\n                    '</div>' +\r\n                '</div>'\r\n            ),\r\n            events: {\r\n                'click .mapExportSelectButton': 'selectArea',\r\n                'click .mapExportUnselectButton': 'unselectArea',\r\n                'click .zoomToBoxButton': 'zoomToBox',\r\n                'click .zoomToLevelButtonWrap': 'zoomToLevel',\r\n                'input .mapExportWidth': 'resize',\r\n                'input .mapExportHeight': 'resize',\r\n                'change .zoomLevel': 'setZoom',\r\n                'change .formatTypes': 'setFormat',\r\n                'change .fileTypes': 'setFileType',\r\n                'input .mapExportName': 'setName',\r\n                'click .mapExportButton': 'exportMap',\r\n                'click .cancelButton': 'cancelExport'\r\n            },\r\n\r\n            initialize: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    currentZoom = attrs.lmap.getZoom(),\r\n                    zoomLevels = attrs.zoomLevels,\r\n                    formatTypes = attrs.formatTypes,\r\n\r\n                    // объявление типов файлов происходит здесь, так как необходима обработка смены языка\r\n                    // типы файлов хранятся в текущем языке\r\n                    fileTypes = [\r\n                        window._gtxt('mapExport.filetypes.raster'),\r\n                        window._gtxt('mapExport.filetypes.mbTiles'),\r\n                        window._gtxt('mapExport.filetypes.kmz')\r\n                    ],\r\n                    \r\n                    updatedFileTypes = getTypes(fileTypes);\r\n\r\n                this.listenTo(this.model, 'change:selArea', this.updateArea);\r\n                this.listenTo(this.model, 'change:width', this.updateSize);\r\n                this.listenTo(this.model, 'change:height', this.updateSize);\r\n                this.listenTo(this.model, 'change:widthValueErr', this.handleValueError);\r\n                this.listenTo(this.model, 'change:heightValueErr', this.handleValueError);\r\n                this.listenTo(this.model, 'change:widthSizeErr', this.handleSizeError);\r\n                this.listenTo(this.model, 'change:heightSizeErr', this.handleSizeError);\r\n                this.listenTo(this.model, 'change:name', this.updateName);\r\n                this.listenTo(this.model, 'change:z', this.updateZoom);\r\n                this.listenTo(this.model, 'change:exportErr', this.handleExportError);\r\n\t\t\t\tthis.listenTo(this.model, 'change:format', this.handleFormat);\r\n\t\t\t\tthis.listenTo(this.model, 'change:fileType', this.handleFormat);\r\n\r\n                for (let i = attrs.lmap.getMinZoom(); i < zoomLevels.length; i++) {\r\n                    zoomLevels[i].current = false;\r\n\r\n                    if (i === currentZoom) {\r\n                        zoomLevels[i].current = true;\r\n                    }\r\n                }\r\n\r\n                for (let j = 0; j < formatTypes.length; j++) {\r\n                    if (formatTypes[j].current === true) {\r\n                        this.model.set('format', formatTypes[j].type);\r\n                    }\r\n                }\r\n\r\n                for (let j = 0; j < updatedFileTypes.length; j++) {\r\n                    if (updatedFileTypes[j].current === true) {\r\n                        this.model.set('fileType', updatedFileTypes[j].type);\r\n                    }\r\n                }\r\n\r\n                this.model.set({\r\n                    z: currentZoom,\r\n                    zoomLevels: zoomLevels,\r\n                    formatTypes: formatTypes,\r\n                    fileTypes: updatedFileTypes,\r\n\t\t\t\t\tformat: 'jpeg',\r\n                    name: nsGmx.gmxMap.properties.title\r\n                });\r\n\r\n                this.updateArea();\r\n\r\n                this.render();\r\n            },\r\n\r\n            render: function () {\r\n                var zoomToBoxButton,\r\n                    zoomToLevelButton;\r\n\r\n                this.$el.html(this.template(this.model.toJSON()));\r\n                this.$('.zoomLevel').prop('disabled', true)\r\n                this.$('.mapExportWidth').prop('disabled', true);\r\n                this.$('.mapExportHeight').prop('disabled', true);\r\n                this.$('.formatTypes').prop('disabled', true);\r\n                this.$('.fileTypes').prop('disabled', true);\r\n                this.$('.mapExportName').val(this.model.get('name'));\r\n                this.$('.mapExportName').prop('disabled', true);\r\n                this.$('.mapExportButton').addClass('gmx-disabled');\r\n\r\n                zoomToBoxButton = nsGmx.Utils.makeImageButton('img/zoom_to_box_tool_small.png', 'img/zoom_to_box_tool_small.png');\r\n                nsGmx.Utils._title(zoomToBoxButton, window._gtxt('mapExport.zoomToBox'));\r\n\r\n                this.$('.zoomToBoxButton').append(zoomToBoxButton);\r\n\r\n                zoomToLevelButton = nsGmx.Utils.makeImageButton('img/zoom_to_level_tool_small.png', 'img/zoom_to_level_tool_small.png');\r\n                $(zoomToLevelButton).addClass('zoomToLevelButton');\r\n                nsGmx.Utils._title(zoomToLevelButton, (window._gtxt('mapExport.zoomToLevel') + ' ' + this.model.get('z')));\r\n\r\n                this.$('.zoomToLevelButtonWrap').append(zoomToLevelButton);\r\n\r\n                return this;\r\n            },\r\n\r\n            updateArea: function () {\r\n                var attrs = this.model.toJSON(),\r\n\t\t\t\t\t// format = attrs.format,\r\n                    areaButton = this.$('.areaButton'),\r\n                    zoomToBoxButton = this.$('.zoomToBoxButton'),\r\n                    zoomToLevelButton = this.$('.zoomToLevelButtonWrap'),\r\n                    zoomSelect = this.$('.zoomLevel'),\r\n                    widthInput = this.$('.mapExportWidth'),\r\n                    heightInput = this.$('.mapExportHeight'),\r\n                    formatSelect = this.$('.formatTypes'),\r\n                    fileSelect = this.$('.fileTypes'),\r\n                    exportNameInput = this.$('.mapExportName'),\r\n                    exportButton = this.$('.mapExportButton'),\r\n                    inputs = [\r\n                        zoomSelect,\r\n                        widthInput,\r\n                        heightInput,\r\n                        formatSelect,\r\n                        fileSelect,\r\n                        exportNameInput,\r\n                        exportButton\r\n                    ];\r\n\r\n                for (var i = 0; i < inputs.length; i++) {\r\n                    if (!attrs.selArea) {\r\n                        $(inputs[i]).prop('disabled', true);\r\n                    } else {\r\n                        $(inputs[i]).prop('disabled', false);\r\n                    }\r\n                }\r\n                if (attrs.selArea) {\r\n                    $(areaButton).removeClass('mapExportSelectButton');\r\n                    $(areaButton).addClass('mapExportUnselectButton');\r\n                    $(areaButton).text(window._gtxt('mapExport.unselect'));\r\n                    $(zoomToBoxButton).show();\r\n                    $(zoomToLevelButton).show();\r\n                    if (!attrs.widthValueErr    &&\r\n                        !attrs.widthSizeErr     &&\r\n                        !attrs.heightValueErr   &&\r\n                        !attrs.heightSizeErr    &&\r\n                        attrs.name !== '') {\r\n                            $(exportButton).removeClass('gmx-disabled');\r\n                    }\r\n                } else {\r\n                    $(areaButton).removeClass('mapExportUnselectButton');\r\n                    $(areaButton).addClass('mapExportSelectButton');\r\n                    $(areaButton).text(window._gtxt('mapExport.select'));\r\n                    $(zoomToBoxButton).hide();\r\n                    $(zoomToLevelButton).hide();\r\n                    $(exportButton).addClass('gmx-disabled');\r\n                }\r\n\t\t\t\tthis.handleFormat();\r\n            },\r\n\r\n            updateSize: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    widthInput = this.$('.mapExportWidth'),\r\n                    width = Number(attrs.width).toFixed(0),\r\n                    heightInput = this.$('.mapExportHeight'),\r\n                    height = Number(attrs.height).toFixed(0);\r\n\r\n                if (!attrs.widthValueErr) {\r\n                    $(widthInput).val((width));\r\n                }\r\n\r\n                if (!attrs.heightValueErr) {\r\n                    $(heightInput).val((height));\r\n                }\r\n            },\r\n\r\n            handleValueError: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    widthInput = this.$('.mapExportWidth'),\r\n                    heightInput = this.$('.mapExportHeight'),\r\n                    exportButton = this.$('.mapExportButton'),\r\n                    warn = this.$('.mapExportWarn');\r\n\r\n                if (attrs.widthValueErr) {\r\n                    $(widthInput).addClass('error');\r\n                }\r\n                else if (!attrs.widthSizeErr) {\r\n                    $(widthInput).removeClass('error');\r\n                }                \r\n\r\n                if (attrs.heightValueErr) {\r\n                    $(heightInput).addClass('error');\r\n                }\r\n                else if (!attrs.heightSizeErr) {\r\n                    $(heightInput).removeClass('error');                    \r\n                }\r\n\r\n                if (attrs.widthValueErr || attrs.heightValueErr) {\r\n                    $(exportButton).addClass('gmx-disabled');\r\n                    $(warn).html(window._gtxt('mapExport.valueWarn'));\r\n                } else {\r\n                    if (attrs.selArea && attrs.name) {\r\n                        $(exportButton).removeClass('gmx-disabled');\r\n                    }\r\n                    if (attrs.widthSizeErr || attrs.heightSizeErr) {\r\n                        $(warn).html(window._gtxt('mapExport.sizeWarn'));\r\n                    } else {\r\n                        $(warn).html('');\r\n                    }\r\n                }\r\n            },\r\n\r\n            handleSizeError: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    widthInput = this.$('.mapExportWidth'),\r\n                    heightInput = this.$('.mapExportHeight'),\r\n                    exportButton = this.$('.mapExportButton'),\r\n                    warn = this.$('.mapExportWarn');\r\n\r\n                if (attrs.widthSizeErr) {\r\n                    $(widthInput).addClass('error');\r\n                }\r\n                else if (!attrs.widthValueErr) {\r\n                    $(widthInput).removeClass('error');\r\n                }\r\n                \r\n\r\n                if (attrs.heightSizeErr) {\r\n                    $(heightInput).addClass('error');\r\n                }\r\n                else if (!attrs.heightValueErr) {\r\n                    $(heightInput).removeClass('error');\r\n                }                \r\n\r\n                if (attrs.widthSizeErr || attrs.heightSizeErr) {\r\n                    $(exportButton).addClass('gmx-disabled');\r\n                    if (!attrs.widthValueErr && !attrs.heightValueErr) {\r\n                        $(warn).html(window._gtxt('mapExport.sizeWarn'));\r\n                    }\r\n                }\r\n                else if (!attrs.widthValueErr && !attrs.heightValueErr) {\r\n                    if (attrs.selArea && attrs.name) {\r\n                        $(exportButton).removeClass('gmx-disabled');\r\n                    }\r\n                    $(warn).html('');\r\n                }                \r\n            },\r\n\r\n            handleExportError: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    exportButton = this.$('.mapExportButton'),\r\n                    progressBarContainer = this.$('.export-progress-container'),\r\n                    spinHolder = this.$('.spinHolder'),\r\n                    cancelButton = this.$('.cancelButton'),\r\n                    exportErrorMessage = this.$('.exportErrorMessage');\r\n\r\n                if (attrs.selArea) {\r\n                    $(exportButton).removeClass('gmx-disabled');\r\n                } else {\r\n                    $(exportButton).addClass('gmx-disabled');\r\n                }\r\n\r\n                if (attrs.exportErr) {\r\n                    $(spinHolder).toggle();\r\n                    $(progressBarContainer).toggle();\r\n                    $(exportButton).toggle();\r\n                    $(cancelButton).toggle();\r\n                    $(exportErrorMessage).toggle();\r\n                } else {\r\n                    $(exportErrorMessage).toggle();\r\n                }\r\n            },\r\n\t\t\t\r\n\t\t\thandleFormat: function () {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\tvar attrs = this.model.toJSON(),\r\n\t\t\t\t\tformat = attrs.format,\r\n\t\t\t\t\tfileType = attrs.fileType;\r\n\t\t\t\r\n\t\t\t\tvar fileSelect = this.$('.fileTypes');\r\n\t\t\t\tif (format === 'geoTiff' || format === 'geoTiffJpeg') {\r\n\t\t\t\t\tfileType = window._gtxt('mapExport.filetypes.raster');\r\n\t\t\t\t\tfileSelect.prop('disabled', true);\r\n\t\t\t\t}\r\n\t\t\t\telse {\t\t\t\t\t\r\n\t\t\t\t\tfileSelect.prop('disabled', false);\r\n\t\t\t\t}\r\n\t\t\t\tthis.$('.formatTypes').val (format);\t\t\t\t\r\n\t\t\t\tfileSelect.val (fileType);\r\n\t\t\t\tthis.model.set({fileType: fileType});\t\t\t\t\r\n\t\t\t},\r\n\r\n            updateName: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    exportNameInput = this.$('.mapExportName'),\r\n                    exportButton = this.$('.mapExportButton');\r\n\r\n                if (attrs.name === '') {\r\n                    $(exportNameInput).addClass('error');\r\n                    $(exportButton).addClass('gmx-disabled');\r\n                } else {\r\n                    if (\r\n                        attrs.selArea           &&\r\n                        !attrs.widthValueErr    &&\r\n                        !attrs.widthSizeErr     &&\r\n                        !attrs.heightValueErr   &&\r\n                        !attrs.heightSizeErr\r\n                        ) {\r\n                        $(exportButton).removeClass('gmx-disabled');\r\n                    }\r\n\r\n                    $(exportNameInput).removeClass('error');\r\n                }\r\n            },\r\n\r\n            updateZoom: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    levels = this.$('.zoomLevel'),\r\n                    list = $(levels).find('option'),\r\n                    zoomToLevelButton = this.$('.zoomToLevelButton')[0];\r\n\r\n                for (var i = 0; i < list.length; i++) {\r\n                    var el = list[i];\r\n\r\n                    if (el.tagName === 'OPTION') {\r\n\r\n                        if (Number($(el).val()) === attrs.z) {\r\n                            $(el).prop('selected', true);\r\n                        } else {\r\n                            $(el).prop('selected', false);\r\n                        }\r\n\r\n                    }\r\n                }\r\n\r\n                if (zoomToLevelButton) {\r\n                    nsGmx.Utils._title(zoomToLevelButton, (window._gtxt('mapExport.zoomToLevel') + ' ' + attrs.z));\r\n                }\r\n            },\r\n\r\n            setZoom: function (e) {\r\n                var attrs = this.model.toJSON(),\r\n                    selectedZoom = Number(e.target.value),\r\n                    zoomLevels = attrs.zoomLevels;\r\n\r\n                for (var i = attrs.lmap.getMinZoom(); i < zoomLevels.length; i++) {\r\n                    zoomLevels[i].current = false;\r\n\r\n                    if (i === selectedZoom) {\r\n                        zoomLevels[i].current = true;\r\n                    }\r\n                }\r\n\r\n                this.model.set({\r\n                    zoomLevels: zoomLevels,\r\n                    z: selectedZoom\r\n                });\r\n\r\n                this._updateCoords();\r\n            },\r\n\r\n            setFormat: function (e) {\r\n                var attrs = this.model.toJSON(),\r\n                    formatTypes = attrs.formatTypes,\t\t\t\t\t\r\n                    selectedFormat = e.target.value;\r\n\r\n                for (var i = 0; i < formatTypes.length; i++) {\r\n                    formatTypes[i].current = false;\r\n\r\n                    if (formatTypes[i].type === selectedFormat) {\r\n                        formatTypes[i].current = true;\r\n                    }\r\n                }\r\n\r\n                this.model.set({\r\n                    formatTypes: formatTypes,\r\n                    format: selectedFormat\r\n                });\r\n\t\t\t\t\t\t\t\t\r\n            },\r\n\r\n            setFileType: function (e) {\r\n                var attrs = this.model.toJSON(),\r\n                    fileTypes = attrs.fileTypes,\r\n                    selectedFileType = e.target.value;\r\n\r\n                for (var i = 0; i < fileTypes.length; i++) {\r\n                    fileTypes[i].current = false;\r\n\r\n                    if (fileTypes[i].type === selectedFileType) {\r\n                        fileTypes[i].current = true;\r\n                    }\r\n                }\r\n\r\n                this.model.set({\r\n                    fileTypes: fileTypes,\r\n                    fileType: selectedFileType\r\n                });\r\n            },\r\n\r\n            setName: function (e) {\r\n                this.model.set('name', e.target.value)\r\n            },\r\n\r\n            selectArea: function () {\r\n                var attrs = this.model.toJSON();\r\n\r\n                if (!attrs.lmap || attrs.selArea) {\r\n                    return;\r\n                }\r\n\r\n                var currentZoom = attrs.lmap.getZoom(),\r\n                    zoomLevels = attrs.zoomLevels,\r\n                    mapBounds = attrs.lmap.getBounds(),\r\n                    latLngs = [\r\n                        mapBounds.getSouthWest(),\r\n                        mapBounds.getNorthWest(),\r\n                        mapBounds.getNorthEast(),\r\n                        mapBounds.getSouthEast()\r\n                    ],\r\n                    // n = mapBounds.getNorth(),\r\n                    // e = mapBounds.getEast(),\r\n                    // s = mapBounds.getSouth(),\r\n                    // w = mapBounds.getWest(),\r\n                    // mapHeight = n - s,\r\n                    // mapWidth = e - w,\r\n\r\n                    // какую часть экрана отсекать с краев первоначальной рамки\r\n                    scale = 4,\r\n                    converted = this._convertFromLatLngs(latLngs, attrs.z),\r\n                    dims = this._getDimensions(converted),\r\n                    xx = [converted[0].x, converted[1].x, converted[2].x, converted[3].x],\r\n                    yy = [converted[0].y, converted[1].y, converted[2].y, converted[3].y],\r\n                    bottomLeft =    L.point(this._getMin(xx) + dims.width / scale,  this._getMax(yy) - dims.height / scale),\r\n                    topLeft =       L.point(this._getMin(xx) + dims.width / scale,  this._getMin(yy) + dims.height / scale),\r\n                    topRight =      L.point(this._getMax(xx) - dims.width / scale,  this._getMin(yy) + dims.height / scale),\r\n                    bottomRight =   L.point(this._getMax(xx) - dims.width / scale,  this._getMax(yy) - dims.height / scale),\r\n                    initialBounds = this._convertToLantLngs([bottomLeft, topLeft, topRight, bottomRight], attrs.z);\r\n\r\n                for (var i = attrs.lmap.getMinZoom(); i < zoomLevels.length; i++) {\r\n                    zoomLevels[i].current = false;\r\n\r\n                    if (i === currentZoom) {\r\n                        zoomLevels[i].current = true;\r\n                    }\r\n                }\r\n\r\n                // прямоугольная рамка\r\n                var rect = L.rectangle(initialBounds);\r\n\r\n                this.model.set({\r\n                    z: currentZoom,\r\n                    zoomLevels: zoomLevels\r\n                });\r\n\r\n                this._createFrame(rect);\r\n\r\n                this._updateCoords();\r\n            },\r\n\r\n            unselectArea: function () {\r\n                var attrs = this.model.toJSON();\r\n                this._removeFrame();\r\n\r\n                this.model.set({\r\n                    width: 0,\r\n                    height: 0,\r\n                    z: attrs.lmap.getZoom(),\r\n                    widthValueErr: false,\r\n                    widthSizeErr: false,\r\n                    heightValueErr: false,\r\n                    heightSizeErr: false,\r\n                    exportErr: false\r\n                });\r\n            },\r\n\r\n            zoomToBox: function () {\r\n                var attrs = this.model.toJSON();\r\n\r\n                attrs.lmap.fitBounds(attrs.selArea.getBounds());\r\n            },\r\n\r\n            zoomToLevel: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    initialCoords = attrs.selArea.rings[0].ring._getLatLngsArr(),\r\n                    converted = this._convertFromLatLngs(initialCoords, attrs.z),\r\n                    dims = this._getDimensions(converted);\r\n\r\n                attrs.lmap.setView(dims.latLng, attrs.z);\r\n            },\r\n\r\n            exportMap: function () {\r\n                var _this = this,\r\n                    attrs = this.model.toJSON(),\r\n                    initialCoords = attrs.selArea.rings[0].ring._getLatLngsArr(),\r\n                    screenCoords = !attrs.coords ? this._convertFromLatLngs(initialCoords, attrs.z) : this._convertFromLatLngs(attrs.coords, attrs.z),\r\n                    dimensions = this._getDimensions(screenCoords),\r\n                    mapStateParams = {\r\n                        exportMode: true,\r\n                        isFullScreen: true,\r\n                        width: Math.floor(Number(attrs.width)) + 'px',\r\n                        height: Math.floor(Number(attrs.height)) + 'px',\r\n                        position: {\r\n                            x: dimensions.mercCenter.x,\r\n                            y: dimensions.mercCenter.y,\r\n                            z: attrs.z ? 17 - attrs.z : 17 - attrs.lmap.getZoom()\r\n                        },\r\n                        latLng: dimensions.latLng,\r\n                        exportBounds: attrs.selArea.getBounds(),\r\n                        grid: nsGmx.gridManager.state\r\n                    },\r\n                    exportParams = {\r\n                        width: Math.floor(Number(attrs.width)),\r\n                        height: Math.floor(Number(attrs.height)),\r\n                        filename: attrs.name,\r\n                        container: attrs.fileType === window._gtxt('mapExport.filetypes.raster') ? 'grimage' : attrs.fileType,\r\n                        format: attrs.format\r\n                    },\r\n                    exportButton = this.$('.mapExportButton'),\r\n                    cancelButton = this.$('.cancelButton'),\r\n                    progressBarContainer = this.$('.export-progress-container'),\r\n                    progressBar = this.$('.export-progressbar'),\r\n                    spinHolder = this.$('.spinHolder'),\r\n                    spinMessage = this.$('.spinMessage'),\r\n                    def;\r\n\r\n                $(exportButton).toggle();\r\n                $(cancelButton).toggle();\r\n\r\n                if (attrs.format === 'png' && nsGmx.leafletMap.gmxBaseLayersManager.getCurrentID() === 'empty') {\r\n                    exportParams.transparentColor='DDDDDD';\r\n                }\r\n\r\n                window._mapHelper.createExportPermalink(mapStateParams, processLink);\r\n\r\n                function processLink(id){\r\n                    var url = window.serverBase + 'Map/Render?' + $.param(exportParams) + '&uri=' + window.location.protocol + '//' + window.location.host + window.location.pathname + '?permalink=' + id;\r\n\r\n                    _this.model.set({\r\n                        exportErr: false\r\n                    });\r\n\r\n                    $(exportButton).addClass('gmx-disabled');\r\n\r\n                    $(progressBarContainer).toggle();\r\n                    $(spinHolder).toggle();\r\n\r\n                    $(progressBar).progressbar({\r\n                        max: 100,\r\n                        value: 0\r\n                    });\r\n\r\n                    def = nsGmx.asyncTaskManager.sendGmxPostRequest(url);\r\n\r\n                    def.done(function(taskInfo){\r\n                        var url2 = window.serverBase + taskInfo.Result.downloadFile,\r\n                            selArea = _this.model.get('selArea');\r\n\r\n                        if (selArea) {\r\n                            $(exportButton).removeClass('gmx-disabled');\r\n                        } else {\r\n                            $(exportButton).addClass('gmx-disabled');\r\n                        }\r\n\r\n                        $(exportButton).toggle();\r\n                        $(cancelButton).toggle();\r\n                        $(spinHolder).toggle();\r\n                        $(progressBarContainer).toggle();\r\n\r\n                        downloadFile(url2);\r\n\r\n                    }).fail(function(taskInfo){\r\n                        if (taskInfo.ErrorInfo.ErrorMessage !== 'Task is canceled') {\r\n                            $(exportButton).removeClass('gmx-disabled');\r\n\r\n                            _this.model.set({\r\n                                exportErr: true\r\n                            });\r\n                        }\r\n                    }).progress(function(taskInfo){\r\n                        _this.model.set({\r\n                            taskInfo: taskInfo\r\n                        });\r\n\r\n                        if (taskInfo.Status === 'queue') {\r\n                            $(spinMessage).html(window._gtxt('mapExport.inQueue'));\r\n                        } else if (taskInfo.Status === 'progress') {\r\n                            $(spinMessage).html(window._gtxt('mapExport.inProcess'));\r\n\r\n                            $(progressBar).progressbar('value', taskInfo.Progress);\r\n                        }\r\n                    });\r\n\r\n                    function downloadFile(url) {\r\n                        var isChrome = navigator.userAgent.toLowerCase().indexOf('chrome') > -1,\r\n                            isSafari = navigator.userAgent.toLowerCase().indexOf('safari') > -1;\r\n\r\n                        if (isChrome || isSafari) {\r\n                            var link = document.createElement('a');\r\n                            link.href = url;\r\n                            link.download = attrs.name;\r\n\r\n                            if (document.createEvent) {\r\n                                var e = document.createEvent('MouseEvents');\r\n                                e.initEvent('click', true, true);\r\n                                link.dispatchEvent(e);\r\n                                return true;\r\n                            }\r\n                        } else {\r\n                            window.open(url, '_self');\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n\r\n            cancelExport: function() {\r\n                var attrs = this.model.toJSON(),\r\n                    taskInfo = this.model.get('taskInfo'),\r\n                    exportButton = this.$('.mapExportButton'),\r\n                    cancelButton = this.$('.cancelButton'),\r\n                    progressBarContainer = this.$('.export-progress-container'),\r\n                    spinHolder = this.$('.spinHolder'),\r\n                    spinMessage = this.$('.spinMessage'),\r\n                    url;\r\n\r\n\r\n                url = window.serverBase + 'AsyncTaskCancel?' + $.param({TaskID: taskInfo.TaskID});\r\n\r\n                sendCrossDomainJSONRequest(url, function(response) {\r\n                    if (!parseResponse(response))\r\n                        return;\r\n\r\n                    if (response.Result) {\r\n                        if (attrs.selArea) {\r\n                            $(exportButton).removeClass('gmx-disabled');\r\n                        }\r\n\r\n                        $(exportButton).toggle();\r\n                        $(cancelButton).toggle();\r\n                        $(spinMessage).empty();\r\n                        $(spinHolder).toggle();\r\n                        $(progressBarContainer).toggle();\r\n                    }\r\n                })\r\n            },\r\n\r\n            resize: function(e) {\r\n                var attrs = this.model.toJSON(),\r\n                    start = e.target.selectionStart,\r\n                    end = e.target.selectionEnd,\r\n                    initialCoords,\r\n                    scale,\r\n                    screenCoords,\r\n                    width, height,\r\n                    bottomLeft, bottomRight,\r\n                    topLeft, topRight,\r\n                    newBounds,\r\n                    value, valueErr, sizeErr;\r\n\r\n                if (!attrs.lmap || !attrs.selArea) {\r\n                    return;\r\n                }\r\n\r\n                initialCoords = attrs.selArea.rings[0].ring._getLatLngsArr();\r\n\r\n                // разница между целевым и текущим зумом\r\n                scale = Math.pow(2, (attrs.z - attrs.lmap.getZoom()));\r\n\r\n                screenCoords = !attrs.coords ? this._revertCoords(this._convertFromLatLngs(initialCoords, attrs.z)) : this._revertCoords(this._convertFromLatLngs(attrs.coords, attrs.z));\r\n\r\n                value = Number(e.target.value);\r\n                valueErr = value <= 0 || isNaN(value);\r\n                sizeErr = value - MAX_SIZE > EPS;\r\n\r\n                // обработка инпута ширины\r\n                if (e.target.className === 'mapExportWidth' || e.target.className === 'mapExportWidth error') {\r\n                    if (valueErr) {\r\n                        this.model.set('widthValueErr', true)\r\n                    } else {\r\n                        this.model.set('widthValueErr', false)\r\n                        this.model.set('width', e.target.value);\r\n\r\n                        if (sizeErr) {\r\n                            this.model.set('widthSizeErr', true);\r\n                        } else {\r\n                            this.model.set('widthSizeErr', false);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // обработка инпута высоты\r\n                if (e.target.className === 'mapExportHeight' || e.target.className === 'mapExportHeight error') {\r\n                    if (valueErr) {\r\n                        this.model.set('heightValueErr', true)\r\n                    } else {\r\n                        this.model.set('heightValueErr', false)\r\n                        this.model.set('height', e.target.value);\r\n\r\n                        if (sizeErr) {\r\n                            this.model.set('heightSizeErr', true);\r\n                        } else {\r\n                            this.model.set('heightSizeErr', false);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                attrs = this.model.toJSON();\r\n\r\n                if (attrs.widthValueErr || attrs.heightValueErr) return;\r\n\r\n                width = e.target.className === 'mapExportWidth' || e.target.className === 'mapExportWidth error' ? Number(e.target.value) : Number(attrs.width);\r\n                height = e.target.className === 'mapExportHeight' || e.target.className === 'mapExportHeight error' ? Number(e.target.value) : Number(attrs.height);\r\n\r\n                newBounds = [];\r\n\r\n                // изменяем координаты объекта, учитывая изменившуюся ширину или высоту\r\n                // геометрия изменяется в соответствии с введенными значениями\r\n                // topLeft остается неизменным\r\n                bottomLeft = screenCoords[0];\r\n                topLeft = screenCoords[1];\r\n                topRight = screenCoords[2];\r\n                bottomRight = screenCoords[3];\r\n\r\n                topRight.x = (topLeft.x + width);\r\n                topRight.y = topLeft.y;\r\n\r\n                bottomLeft.x = topLeft.x;\r\n                bottomLeft.y = (topLeft.y + height);\r\n\r\n                bottomRight.x = (topLeft.x + width);\r\n                bottomRight.y = (topLeft.y + height);\r\n\r\n                // topLeft.x = topLeft.x;\r\n                // topLeft.y = topLeft.y;\r\n\r\n                newBounds.push(\r\n                    [attrs.lmap.unproject([bottomLeft.x / scale, bottomLeft.y / scale])],\r\n                    [attrs.lmap.unproject([topRight.x / scale, topRight.y / scale])]\r\n                );\r\n\r\n                // измененная прямоугольная рамка\r\n                var newRect = L.rectangle(newBounds);\r\n                this.model.set('coords', L.version === \"0.7.7\" ? newRect.getLatLngs() : newRect.getLatLngs()[0]);\r\n\r\n                attrs.lmap.gmxDrawing.remove(attrs.selArea);\r\n\r\n                this._createFrame(newRect);\r\n                this._updateCoords();\r\n\r\n                // восстановим позицию курсора\r\n                e.target.setSelectionRange(start, end);\r\n            },\r\n\r\n            _createFrame: function(rectangle) {\r\n                var attrs = this.model.toJSON(),\r\n                    options = {\r\n                        editable: true,\r\n                        map: true,\r\n                        lineStyle: {\r\n                            dashArray: '5 5',\r\n                            color: '#f57c00',\r\n                            weight: 3.5\r\n                        },\r\n                        pointStyle: {\r\n                            size: L.Browser.mobile ? 40 : 8,\r\n                            color: '#f57c00'\r\n                        }\r\n                    };\r\n\r\n                this.model.set({\r\n                    selArea: attrs.lmap.gmxDrawing.add(rectangle, L.extend(options, {\r\n                        exportRect: true\r\n                    }))\r\n                });\r\n\r\n                // навешивает обработчики на рамку выделения\r\n                var frame = this.model.get('selArea'),\r\n                    _this = this;\r\n\r\n                frame.on('edit', _this._resizeFrame.bind(_this));\r\n                frame.on('remove', function () {\r\n                    // var attrs = _this.model.toJSON();\r\n\r\n                    _this.model.set({\r\n                        width: 0,\r\n                        height: 0,\r\n                        widthValueErr: false,\r\n                        widthSizeErr: false,\r\n                        heightValueErr: false,\r\n                        heightSizeErr: false,\r\n                        exportErr: false\r\n                    });\r\n                });\r\n\r\n            },\r\n\r\n            _resizeFrame: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    initialCoords,\r\n                    screenCoords,\r\n                    dimensions,\r\n                    w, h;\r\n\r\n                initialCoords = attrs.selArea.rings[0].ring._getLatLngsArr();\r\n                screenCoords = this._convertFromLatLngs(initialCoords, attrs.z);\r\n                dimensions = this._getDimensions(screenCoords);\r\n\r\n                w = Math.abs(dimensions.width);\r\n                h = Math.abs(dimensions.height);\r\n\r\n                if (w - MAX_SIZE > EPS) {\r\n                    this.model.set('widthSizeErr', true)\r\n                } else {\r\n                    this.model.set('widthSizeErr', false)\r\n                }\r\n\r\n                if (h - MAX_SIZE > EPS) {\r\n                    this.model.set('heightSizeErr', true)\r\n                } else {\r\n                    this.model.set('heightSizeErr', false)\r\n                }\r\n\r\n                this.model.set({\r\n                    coords: initialCoords,\r\n                    width: String(w),\r\n                    height: String(h)\r\n                });\r\n            },\r\n\r\n            _removeFrame: function () {\r\n                var attrs = this.model.toJSON();\r\n\r\n                if (!attrs.selArea) {\r\n                    return;\r\n                }\r\n\r\n                attrs.lmap.gmxDrawing.remove(attrs.selArea);\r\n\r\n                this.model.set({\r\n                    selArea: null,\r\n                    coords: null\r\n                });\r\n            },\r\n\r\n            _updateCoords: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    initialCoords,\r\n                    screenCoords,\r\n                    dimensions,\r\n                    w, h;\r\n\r\n                if (!attrs.selArea) {\r\n                    return;\r\n                }\r\n\r\n                initialCoords = attrs.selArea.rings[0].ring._getLatLngsArr();\r\n                screenCoords = !attrs.coords ? this._convertFromLatLngs(initialCoords, attrs.z) : this._convertFromLatLngs(attrs.coords, attrs.z);\r\n                dimensions = this._getDimensions(screenCoords);\r\n\r\n                w = Math.abs(dimensions.width);\r\n                h = Math.abs(dimensions.height);\r\n\r\n                if (!attrs.coords) {\r\n                    this.model.set('coords', initialCoords)\r\n                }\r\n\r\n                if (w - MAX_SIZE > EPS) {\r\n                    this.model.set('widthSizeErr', true)\r\n                } else {\r\n                    this.model.set('widthSizeErr', false)\r\n                }\r\n\r\n                if (h - MAX_SIZE > EPS) {\r\n                    this.model.set('heightSizeErr', true)\r\n                } else {\r\n                    this.model.set('heightSizeErr', false)\r\n                }\r\n\r\n                this.model.set({\r\n                    width: String(w),\r\n                    height: String(h)\r\n                });\r\n            },\r\n\r\n            _revertCoords: function (coords) {\r\n                var xx,\r\n                    yy,\r\n                    bottomLeft, topLeft,\r\n                    topRight, bottomRight;\r\n\r\n                xx = [coords[0].x, coords[1].x, coords[2].x, coords[3].x];\r\n                yy = [coords[0].y, coords[1].y, coords[2].y, coords[3].y];\r\n                bottomLeft = L.point(this._getMin(xx), this._getMax(yy));\r\n                topLeft = L.point(this._getMin(xx), this._getMin(yy));\r\n                topRight = L.point(this._getMax(xx), this._getMin(yy));\r\n                bottomRight = L.point(this._getMax(xx), this._getMax(yy));\r\n\r\n                return [bottomLeft, topLeft, topRight, bottomRight];\r\n\r\n            },\r\n\r\n            _convertFromLatLngs: function (latlngs, zoom) {\r\n                var attrs = this.model.toJSON(),\r\n                    converted = latlngs.map(function(ll) {\r\n                        return attrs.lmap.project([ll.lat, ll.lng], zoom);\r\n                    });\r\n\r\n                return converted;\r\n            },\r\n\r\n            _convertToLantLngs: function (points, zoom) {\r\n                var attrs = this.model.toJSON(),\r\n                    converted = points.map(function(point) {\r\n                        return attrs.lmap.unproject([point.x, point.y], zoom);\r\n                    });\r\n\r\n                return converted;\r\n            },\r\n\r\n            _getDimensions: function(points) {\r\n                var attrs = this.model.toJSON(),\r\n                    bottomLeft, topRight,\r\n                    width, height,\r\n                    x, y;\r\n\r\n                points = this._revertCoords(points);\r\n                bottomLeft = points[0];\r\n                topRight = points[2];\r\n                width = Math.abs(topRight.x - bottomLeft.x);\r\n                height = Math.abs(bottomLeft.y - topRight.y);\r\n                x = bottomLeft.x + width / 2;\r\n                y = topRight.y + height / 2;\r\n\r\n                return {\r\n                    bottomLeft: bottomLeft,\r\n                    topRight: topRight,\r\n                    width: width,\r\n                    height: height,\r\n                    mercCenter: L.Projection.Mercator.project(attrs.lmap.unproject([x, y], attrs.z)),\r\n                    latLng: attrs.lmap.unproject([x, y], attrs.z)\r\n                }\r\n            },\r\n\r\n            _getMax: function(arr) {\r\n                return Math.max.apply(null, arr);\r\n            },\r\n\r\n            _getMin: function(arr) {\r\n                return Math.min.apply(null, arr);\r\n            }\r\n        });\r\n\r\n        view = new ExportView();\r\n\r\n        function getZoomLevels() {\r\n            var zoomLevels = [],\r\n                lmap = nsGmx.leafletMap,\r\n                min = lmap.getMinZoom() || 0,\r\n                max = lmap.getMaxZoom() !== Infinity ? lmap.getMaxZoom() : 21,\r\n                currentZoom = lmap.getZoom();\r\n\r\n            for (var i = min; i <= max; i++) {\r\n                zoomLevels[i] = {zoom: i, current: false};\r\n\r\n                if (i === currentZoom) {\r\n                    zoomLevels[i].current = true;\r\n                }\r\n            }\r\n            return zoomLevels;\r\n        }\r\n\r\n        function getTypes(types) {\r\n            var arr = [];\r\n\r\n            for (var i = 0; i < types.length; i++) {\r\n                arr[i] = {type: types[i], current: false};\r\n\r\n                if (i === 0) {\r\n                    arr[i].current = true;\r\n                }\r\n            }\r\n            return arr;\r\n        }\r\n\r\n        this.Load = function () {\r\n            var lm = model.get('lm');\r\n\r\n            if (lm != null) {\r\n                var alreadyLoaded = lm.createWorkCanvas('export', this.Unload);\r\n                if (!alreadyLoaded) {\r\n                    $(lm.workCanvas).append(view.el);\r\n                }\r\n            }\r\n        }\r\n        this.Unload = function () {\r\n            var attrs = model.toJSON();\r\n            attrs.lmap.gmxDrawing.remove(attrs.selArea);\r\n            model.set({\r\n                selArea: null,\r\n                width: 0,\r\n                height: 0,\r\n                widthValueErr: false,\r\n                heightValueErr: false,\r\n                widthSizeErr: false,\r\n                heightSizeErr: false,\r\n                format: null,\r\n                x: null,\r\n                z: attrs.lmap.getZoom(),\r\n                y: null,\r\n                latLng: null,\r\n                coords: null,\r\n                zoomLevels: getZoomLevels(),\r\n                formatTypes: getTypes(formatTypes),\r\n                fileTypes: null,\r\n                exportErr: false\r\n            });\r\n        };\r\n    }\r\n\r\n    var publicInterface = {\r\n        pluginName: 'MapExport',\r\n        MapExportMenu: MapExportMenu\r\n  };\r\n\r\n    gmxCore.addModule('MapExport',\r\n        publicInterface\r\n    );\r\n","import nsGmx from '../nsGmx.js';\r\nimport {\r\n    sendCrossDomainJSONRequest,\r\n    parseResponse,\r\n} from '../utilities.js';\r\nimport {leftMenu} from '../menu.js';\r\nimport './BufferZones.css';\r\nimport '../gmxcore.js';\r\n\r\n(function() {\r\n    window._translationsHash.addtext('rus', {\r\n        bufferZones: {\r\n            title: 'Создание буферных зон',\r\n            selectTooltip: 'Выберите кликом векторный слой',\r\n            select: 'Кликните на векторный слой в панели слоев',\r\n            selectedLayer: 'Выбранный слой',\r\n            layerTypeError: 'Слой не является векторным',\r\n            bufferSize: 'Размер буфера',\r\n            createBuffer: 'Создать',\r\n            units: 'м'\r\n        }\r\n    });\r\n    window._translationsHash.addtext('eng', {\r\n        bufferZones: {\r\n            title: 'Buffer zones creation',\r\n            selectTooltip: 'Select vector layer by click',\r\n            select: 'Select vector layer',\r\n            selectedLayer: 'Selected layer',\r\n            layerTypeError: 'Selected layer is not vector type',\r\n            bufferSize: 'Buffer size',\r\n            createBuffer: 'Create',\r\n            units: 'm'\r\n        }\r\n    });\r\n\r\n    var view;\r\n\r\n    var BufferZonesMenu = function () {\r\n        var canvas = nsGmx.Utils._div(null, [['dir','className','bufferZonesConfigLeftMenu']]);\r\n\r\n        var BufferModel = window.Backbone.Model.extend({\r\n            defaults: {\r\n                lm: new leftMenu(),\r\n                lmap: nsGmx.leafletMap,\r\n                selectedLayer: null,\r\n                selectedLayerName: '',\r\n                bufferSize: 50,\r\n                error: true\r\n            }\r\n        });\r\n\r\n        var model = new BufferModel();\r\n\r\n        var BufferView = window.Backbone.View.extend({\r\n            el: $(canvas),\r\n            model: model,\r\n            template: window.Handlebars.compile(\r\n                '<div class=\"\">' +\r\n                    '<div class=\"buffer-row buffer-select-title\">{{i \"bufferZones.select\"}}:</div>' +\r\n                    '<div class=\"buffer-row buffer-layer-name {{#if error}}buffer-layer-name-error{{/if}}\">' +\r\n                        '{{selectedLayerName}}' +\r\n                    '</div>' +\r\n                    '<div class=\"buffer-row\">{{i \"bufferZones.bufferSize\"}}: ' +\r\n                        '<input type=\"number\" class=\"buffer-size\" value={{bufferSize}}></input>' +\r\n                        ' {{i \"bufferZones.units\"}}' +\r\n                    '</div>' +\r\n                    '<div class=\"buffer-row buffer-button-container\"><span class=\"buttonLink create-buffer-button {{#if error}}gmx-disabled{{/if}}\">{{i \"bufferZones.createBuffer\"}}</span></div>' +\r\n                '</div>'\r\n            ),\r\n            events: {\r\n                'click .create-buffer-button': 'createBuffer',\r\n                'change .buffer-size': 'setBufferSize',\r\n            },\r\n\r\n            initialize: function () {\r\n                var\r\n                    // attrs = this.model.toJSON(),\r\n                    _this = this;\r\n\r\n                $(_layersTree).on('activeNodeChange', function(event, elem) {\r\n                    if (elem) {\r\n                        if (elem.hasAttribute('groupid')) {\r\n                            _this.model.set({\r\n                                selectedLayerName: '',\r\n                                selectedLayer: null,\r\n                                error: true\r\n                            });\r\n                            return;\r\n                        }\r\n\r\n                        var layerID = $(elem).attr('layerid'),\r\n                            layer = nsGmx.gmxMap.layersByID[layerID];\r\n\r\n                        if (layer && layer.getGmxProperties) {\r\n                            var type = layer.getGmxProperties().type\r\n                            if (type === 'Vector') {\r\n                                _this.model.set({\r\n                                    selectedLayerName: layer.getGmxProperties ? layer.getGmxProperties().title : '',\r\n                                    selectedLayer: layerID,\r\n                                    error: false\r\n                                });\r\n                            } else {\r\n                                _this.model.set({\r\n                                    selectedLayerName: window._gtxt('bufferZones.layerTypeError'),\r\n                                    selectedLayer: null,\r\n                                    error: true\r\n                                });\r\n                            }\r\n                        } else {\r\n                            _this.model.set({\r\n                                selectedLayerName: window._gtxt('bufferZones.layerTypeError'),\r\n                                selectedLayer: null,\r\n                                error: true\r\n                            });\r\n                        }\r\n                    } else {\r\n                        _this.model.set({\r\n                            selectedLayerName: '',\r\n                            selectedLayer: null,\r\n                            error: true\r\n                        });\r\n                    }\r\n                });\r\n\r\n                this.listenTo(this.model, 'selectedLayerName: change', this.render);\r\n                this.listenTo(this.model, 'bufferSize: change', this.render);\r\n\r\n                this.render();\r\n            },\r\n\r\n            render: function () {\r\n                this.$el.html(this.template(this.model.toJSON()));\r\n\r\n                // console.log('----- bs: ', this.model.get('bufferSize'));\r\n\r\n                return this;\r\n            },\r\n\r\n            setBufferSize: function (e) {\r\n                var value = Number(e.target.value);\r\n\r\n                if (isNaN(value)) {\r\n                    this.model.set('error', true);\r\n                    return;\r\n                } else {\r\n                    this.model.set({\r\n                        error: false,\r\n                        bufferSize: value\r\n                    });\r\n                }\r\n            },\r\n\r\n            createBuffer: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    _this = this,\r\n                    selectedLayer = attrs.selectedLayer;\r\n\r\n                if (!selectedLayer) {\r\n                    return;\r\n                }\r\n\r\n                sendCrossDomainJSONRequest(window.serverBase + \"Layer/GetLayerInfo.ashx?NeedAttrValues=false&LayerName=\" + encodeURIComponent(selectedLayer), function(response) {\r\n                    if (!parseResponse(response)) {\r\n                        return;\r\n                    }\r\n                    var layerProperties = new nsGmx.LayerProperties(),\r\n                        params = {\r\n                            sourceLayerName: selectedLayer,\r\n                            copy: true,\r\n                            addToMap: true,\r\n                            buffer: true,\r\n                            bufferSize: _this.model.toJSON().bufferSize\r\n                        },\r\n                        properties = {\r\n                            Columns: response.Result.Columns,\r\n                            Title:  response.Result.Title + '_' + window._gtxt('Буфер').toLowerCase(),\r\n                            Copyright: response.Result.Copyright,\r\n                            Description: response.Result.Description,\r\n                            Date: response.Result.Date,\r\n                            MetaProperties: response.Result.MetaProperties,\r\n                            TilePath: {\r\n                                Path: ''\r\n                            },\r\n                            ShapePath: response.Result.ShapePath,\r\n                            IsRasterCatalog: response.Result.IsRasterCatalog,\r\n                            SourceType: \"sql\",\r\n                            Quicklook: response.Result.Quicklook\r\n                        }, layerTitle;\r\n\r\n                    layerProperties.initFromViewer('Vector', null, properties);\r\n\r\n                    var def = layerProperties.save(true, null, params);\r\n                    layerTitle = layerProperties.get('Title');\r\n\r\n                    if (params.addToMap) {\r\n                        window._queryMapLayers.asyncCreateLayer(def, layerTitle);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        view = new BufferView();\r\n\r\n        // DEBUG:\r\n        window.v = view;\r\n\r\n        this.Load = function () {\r\n            var lm = model.get('lm');\r\n\r\n            if (lm != null) {\r\n                var alreadyLoaded = lm.createWorkCanvas('buffer', this.Unload);\r\n                if (!alreadyLoaded) {\r\n                    $(lm.workCanvas).append(view.el);\r\n                }\r\n            }\r\n        }\r\n        this.Unload = function () {\r\n            // var attrs = model.toJSON();\r\n\r\n            model.set({});\r\n        };\r\n    }\r\n\r\n    var publicInterface = {\r\n        pluginName: 'BufferZones',\r\n        BufferZonesMenu: BufferZonesMenu\r\n  };\r\n\r\n    window.gmxCore.addModule('BufferZones', publicInterface);\r\n})();\r\n","import nsGmx from '../nsGmx.js';\r\nimport '../AsyncTaskManager.js';\r\nimport './IndexGrid.css';\r\nimport {leftMenu} from '../menu.js';\r\n\r\n    var MAX_INDEX_COUNT = 10000;\r\n    var KM_PER_DEGREE = 111.31949;\r\n\r\n    nsGmx.DrawingObjectCustomControllers.addDelegate({\r\n        isHidden: function(obj) {\r\n            if (obj.options.exportRect) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n    });\r\n\r\n    window._translationsHash.addtext('rus', {\r\n        indexGrid: {\r\n            settings: 'Настройки индексной сетки',\r\n            select: 'Выделить область карты',\r\n            unselect: 'Снять выделение',\r\n            coordinates: 'координаты',\r\n            lat: 'широта',\r\n            lng: 'долгота',\r\n            min: 'мин',\r\n            max: 'макс',\r\n            step: 'шаг (км)',\r\n            onLat: 'по широте',\r\n            onLng: 'по долготе',\r\n            count: 'количество идексов',\r\n            name: 'имя слоя',\r\n            create: 'Создать слой индексной сетки',\r\n            valueWarn: 'недопустимое значение',\r\n            indexCountWarn: 'превышено допустимое число ячеек (10 000)',\r\n            nameWarn: 'имя слоя не должно быть пустым'\r\n        }\r\n    });\r\n    window._translationsHash.addtext('eng', {\r\n        indexGrid: {\r\n            settings: 'Index grid settings',\r\n            select: 'Select',\r\n            unselect: 'Clear selection',\r\n            coordinates: 'coordinates',\r\n            lat: 'latitude',\r\n            lng: 'longitude',\r\n            max: 'max',\r\n            min: 'min',\r\n            step: 'Step (km)',\r\n            onLat: 'on latitude',\r\n            onLng: 'on longitude',\r\n            count: 'index count',\r\n            name: 'layer name',\r\n            create: 'Create index grid layer',\r\n            valueWarn: 'incorrect value',            \r\n            indexCountWarn: 'max ceils number exceeded (10 000)',\r\n            nameWarn: 'layer name cannot be empty'\r\n        }\r\n    });\r\n\r\n    var view;\r\n\r\n    var IndexGridMenu = function () {\r\n        var canvas = nsGmx.Utils._div(null, [['dir','className','indexGridConfigLeftMenu']]);\r\n\r\n        var IndexGridModel = window.Backbone.Model.extend({\r\n            defaults: {\r\n                lm: new leftMenu(),\r\n                lmap: nsGmx.leafletMap,\r\n                selArea: null,\r\n                xStep: 1,\r\n                yStep: 1,\r\n                xCount: null,\r\n                yCount: null,\r\n                xStepErr: false,\r\n                yStepErr: false,\r\n                indexCount: null,\r\n                indexCountErr: false,\r\n                maxLat: null,\r\n                maxLng: null,\r\n                minLat: null,\r\n                minLng: null,\r\n                maxLatErr: false,\r\n                maxLngErr: false,\r\n                minLatErr: false,\r\n                minLngErr: false,\r\n                z: null,\r\n                coords: null,\r\n                name: '',\r\n                nameErr: true\r\n            }\r\n        });\r\n\r\n        var model = new IndexGridModel();\r\n\r\n        var IndexGridView = window.Backbone.View.extend({\r\n            el: $(canvas),\r\n            model: model,\r\n            template: window.Handlebars.compile(\r\n                '<div class=\"selectButtons\">' +\r\n                        '<span class=\"buttonLink areaButton indexGridSelectButton\"> {{i \"indexGrid.select\"}}</span>' +\r\n                        '</span>' +\r\n                '</div>' +\r\n                '<div class=\"indexgridsettings\">' +\r\n                    '<span>' +\r\n                        '{{i \"indexGrid.settings\"}}' +\r\n                    '</span>' +\r\n                '</div>' +\r\n                '<table class=\"settings\">' +\r\n                    '<tbody>' +\r\n                        // Широта / Долгота\r\n                        '<tr class=\"dims\">' +\r\n                            '<td class=\"eLabel\">{{i \"indexGrid.coordinates\"}}</td>' +\r\n                            '<td class=\"eLabel colname\">{{i \"indexGrid.lat\"}}</td>' +\r\n                            '<td class=\"eLabel colname\">{{i \"indexGrid.lng\"}}</td>' +\r\n                        '</tr>' +\r\n                        // Макс\r\n                        '<tr class=\"dims\">' +\r\n                            '<td class=\"eLabel\">{{i \"indexGrid.max\"}}</td>' +\r\n                            '<td class=\"eInput\">' +\r\n                                '<input type=\"text\" class=\"maxLat\" value=\"{{maxLat}}\"/>' +\r\n                            '</td>' +\r\n                            '<td class=\"eInput\">' +\r\n                                '<input type=\"text\" class=\"maxLng\" value=\"{{maxLng}}\"/>' +\r\n                            '</td>' +\r\n                        '</tr>' +\r\n                        // Мин\r\n                        '<tr class=\"dims\">' +\r\n                            '<td class=\"eLabel\">{{i \"indexGrid.min\"}}</td>' +\r\n                            '<td class=\"eInput\">' +\r\n                                '<input type=\"text\" class=\"minLat\" value=\"{{minLat}}\"/>' +\r\n                            '</td>' +\r\n                            '<td class=\"eInput\">' +\r\n                                '<input type=\"text\" class=\"minLng\" value=\"{{minLng}}\"/>' +\r\n                            '</td>' +\r\n                        '</tr>' +\r\n                        // Шаг\r\n                        '<tr class=\"dims\">' +\r\n                            '<td class=\"eLabel\" rowspan=2>{{i \"indexGrid.step\"}}</td>' +\r\n                            '<td class=\"eLabel\">{{i \"indexGrid.onLat\"}}</td>' +\r\n                            '<td class=\"eInput\">' +\r\n                            '<input type=\"text\" class=\"yStep\" value=\"{{yStep}}\"/>' +\r\n                            '</td>' +\r\n                        '</tr>' +\r\n                        '<tr class=\"dims\">' +\r\n                            '<td class=\"eLabel\">{{i \"indexGrid.onLng\"}}</td>' +\r\n                            '<td class=\"eInput\">' +\r\n                            '<input type=\"text\" class=\"xStep\" value=\"{{xStep}}\"/>' +\r\n                            '</td>' +\r\n                        '</tr>' +\r\n                        // Количество индексов\r\n                        '<tr class=\"dims\">' +\r\n                            '<td class=\"eLabel\">{{i \"indexGrid.count\"}}</td>' +\r\n                            '<td class=\"eLabel\"></td>' +\r\n                            '<td class=\"eLabel indexCount\">{{indexCount}}</td>' +\r\n                        '</tr>' +\r\n                        // Имя\r\n                        '<tr class=\"nameSelect\">' +\r\n                            '<td class=\"eLabel\">{{i \"indexGrid.name\"}}</td>' +\r\n                            '<td class=\"eInput\" colspan=2>' +\r\n                                '<input type=\"text\" class=\"name\" value=\"\"/>' +\r\n                            '</td>' +\r\n                        '</tr>' +\r\n                    '</tbody>' +\r\n                '</table>' +\r\n                '<div class=\"createWrap\">' +\r\n                    '<div class=\"create\">' +\r\n                        '<span class=\"buttonLink createIndexGridButton\"> {{i \"indexGrid.create\"}}</span>' +\r\n                        '<span class=\"spinHolder\" style=\"display:none\">' +\r\n                            '<img src=\"img/progress.gif\"/>' +\r\n                            '<span class=\"spinMessage\"></span>' +\r\n                            '</span>' +\r\n                        '<br/>' +\r\n                        '<span class=\"warnMessage errorMessage\" style=\"display:none\"></span>' +\r\n                    '</div>' +\r\n                '</div>'\r\n            ),\r\n            events: {\r\n                'click .indexGridSelectButton': 'selectArea',\r\n                'click .indexGridUnelectButton': 'unselectArea',\r\n                'input .minLat': 'resize',\r\n                'input .maxLat': 'resize',\r\n                'input .minLng': 'resize',\r\n                'input .maxLng': 'resize',\r\n                'input .xStep': 'setStep',\r\n                'input .yStep': 'setStep',\r\n                'input .name': 'setName',\r\n                'click .createIndexGridButton': 'createIndexGrid'\r\n            },\r\n\r\n            initialize: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    currentZoom = attrs.lmap.getZoom();\r\n\r\n                this.listenTo(this.model, 'change:selArea', this.updateArea);\r\n                this.listenTo(this.model, 'change:selArea', this.updateStepInput.bind(this, 'xStep'));\r\n                this.listenTo(this.model, 'change:selArea', this.updateStepInput.bind(this, 'yStep'));\r\n\r\n                this.listenTo(this.model, 'change:minLat', this.updateLatLngInput.bind(this, 'minLat'));\r\n                this.listenTo(this.model, 'change:maxLat', this.updateLatLngInput.bind(this, 'maxLat'));\r\n                this.listenTo(this.model, 'change:maxLng', this.updateLatLngInput.bind(this, 'maxLng'));\r\n                this.listenTo(this.model, 'change:minLng', this.updateLatLngInput.bind(this, 'minLng'));\r\n\r\n                this.listenTo(this.model, 'change:minLatErr', this.handleInputErr.bind(this, 'minLat'));\r\n                this.listenTo(this.model, 'change:maxLatErr', this.handleInputErr.bind(this, 'maxLat'));\r\n                this.listenTo(this.model, 'change:maxLngErr', this.handleInputErr.bind(this, 'maxLng'));\r\n                this.listenTo(this.model, 'change:minLngErr', this.handleInputErr.bind(this, 'minLng'));\r\n\r\n                this.listenTo(this.model, 'change:xStep', this.updateStepInput.bind(this, 'xStep'));\r\n                this.listenTo(this.model, 'change:yStep', this.updateStepInput.bind(this, 'yStep'));\r\n\r\n                this.listenTo(this.model, 'change:xStepErr', this.handleInputErr.bind(this, 'xStep'));\r\n                this.listenTo(this.model, 'change:yStepErr', this.handleInputErr.bind(this, 'yStep'));\r\n                this.listenTo(this.model, 'change:indexCount', this.updateIndexCount);\r\n                this.listenTo(this.model, 'change:indexCountErr', this.handleIndexCountErr);\r\n                this.listenTo(this.model, 'change:name', this.updateName);\r\n                this.listenTo(this.model, 'change:nameErr', this.handleInputErr.bind(this, 'name'));\r\n\r\n                this.model.set({\r\n                    z: currentZoom,\r\n                    name: nsGmx.gmxMap.properties.title,\r\n                    nameErr: false\r\n                });\r\n\r\n                this.updateArea();\r\n\r\n                this.render();\r\n            },\r\n\r\n            render: function () {\r\n                this.$el.html(this.template(this.model.toJSON()));\r\n                this.$('.minLat').prop('disabled', true);\r\n                this.$('.maxLat').prop('disabled', true);\r\n                this.$('.maxLng').prop('disabled', true);\r\n                this.$('.minLng').prop('disabled', true);\r\n                this.$('.xStep').prop('disabled', true);\r\n                this.$('.yStep').prop('disabled', true);\r\n                this.$('.name').val(this.model.get('name'));\r\n                this.$('.name').prop('disabled', true);\r\n                this.$('.createIndexGridButton').addClass('gmx-disabled');\r\n\r\n                return this;\r\n            },\r\n\r\n            updateArea: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    minLatInput = this.$('.minLat'),\r\n                    maxLatInput = this.$('.maxLat'),\r\n                    maxLngInput = this.$('.maxLng'),\r\n                    minLngInput = this.$('.minLng'),\r\n                    xStepInput = this.$('.xStep'),\r\n                    yStepInput = this.$('.yStep'),\r\n                    areaButton = this.$('.areaButton'),\r\n                    nameInput = this.$('.name'),\r\n                    createIndexGridButton = this.$('.createIndexGridButton'),\r\n                    inputs = [\r\n                        minLatInput,\r\n                        maxLatInput,\r\n                        maxLngInput,\r\n                        minLngInput,\r\n                        xStepInput,\r\n                        yStepInput,\r\n                        nameInput,\r\n                        createIndexGridButton\r\n                    ];\r\n\r\n                for (var i = 0; i < inputs.length; i++) {\r\n                    if (!attrs.selArea) {\r\n                        $(inputs[i]).prop('disabled', true);\r\n                    } else {\r\n                        $(inputs[i]).prop('disabled', false);\r\n                    }\r\n                }\r\n                if (attrs.selArea) {\r\n                    $(areaButton).removeClass('indexGridSelectButton');\r\n                    $(areaButton).addClass('indexGridUnelectButton');\r\n                    $(areaButton).text(window._gtxt('indexGrid.unselect'));\r\n\r\n                    if (\r\n                        !attrs.minLatErr        &&\r\n                        !attrs.maxLatErr        &&\r\n                        !attrs.maxLngErr        &&\r\n                        !attrs.minLngErr        &&\r\n                        !attrs.xStepErr         &&\r\n                        !attrs.yStepErr         &&\r\n                        !attrs.indexCountErr    &&\r\n                        attrs.name !== ''\r\n                    ) {\r\n                            $(createIndexGridButton).removeClass('gmx-disabled');\r\n                    }\r\n                } else {\r\n                    $(areaButton).removeClass('indexGridUnelectButton');\r\n                    $(areaButton).addClass('indexGridSelectButton');\r\n                    $(areaButton).text(window._gtxt('indexGrid.select'));\r\n                    $(createIndexGridButton).addClass('gmx-disabled');\r\n                }\r\n            },\r\n\r\n            updateLatLngInput: function (latLng) {\r\n                var\r\n                    // attrs = this.model.toJSON(),\r\n                    input = this.$('.' + latLng),\r\n                    value = this.model.get(latLng);\r\n\r\n                $(input).val(value !== null ? this._roundInputNumber(value) : '');\r\n            },\r\n\r\n            handleInputErr: function (inputName) {\r\n                var input = this.$('.' + inputName);\r\n\r\n                $(input).toggleClass('error', this.model.get(inputName + 'Err'));\r\n                this.setCreateButtonStatus();\r\n                this.setWarnMessage();\r\n            },\r\n\r\n            updateStepInput: function (inputName) {\r\n                var\r\n                    // attrs = this.model.toJSON(),\r\n                    input = this.$('.' + inputName),\r\n                    value = this.model.get(inputName);\r\n\r\n                $(input).val(value);\r\n            },\r\n\r\n            updateXStep: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    xStepInput = this.$('.xStep');\r\n\r\n                $(xStepInput).val(attrs.xStep);\r\n            },\r\n\r\n            updateYStep: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    yStepInput = this.$('.yStep');\r\n\r\n                $(yStepInput).val(attrs.yStep);\r\n            },\r\n\r\n            updateIndexCount: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    indexCount = this.$('.indexCount');\r\n\r\n                $(indexCount).html(attrs.indexCount ? attrs.indexCount : '');\r\n            },\r\n\r\n            handleIndexCountErr: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    indexCount = this.$('.indexCount');\r\n\r\n                $(indexCount).toggleClass('errorMessage', attrs.indexCountErr);\r\n                this.setCreateButtonStatus();\r\n                this.setWarnMessage();\r\n            },\r\n\r\n            updateName: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    nameInput = this.$('.name');\r\n\r\n                $(nameInput).val(attrs.name);\r\n            },\r\n\r\n            setCreateButtonStatus: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    createIndexGridButton = this.$('.createIndexGridButton'),\r\n                    err = attrs.minLatErr\r\n                        || attrs.maxLatErr\r\n                        || attrs.maxLngErr\r\n                        || attrs.minLngErr\r\n                        || attrs.xStepErr\r\n                        || attrs.yStepErr\r\n                        || attrs.indexCountErr;\r\n\r\n                    $(createIndexGridButton).toggleClass('gmx-disabled', err);\r\n            },\r\n\r\n            setWarnMessage: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    warnMessage = this.$('.warnMessage'),\r\n                    err = attrs.minLatErr\r\n                        || attrs.maxLatErr\r\n                        || attrs.maxLngErr\r\n                        || attrs.minLngErr\r\n                        || attrs.xStepErr\r\n                        || attrs.yStepErr\r\n                        || attrs.indexCountErr\r\n                        || attrs.nameErr;\r\n\r\n                    $(warnMessage).toggle(err);\r\n\r\n                if (\r\n                       attrs.minLatErr\r\n                    || attrs.maxLatErr\r\n                    || attrs.maxLngErr\r\n                    || attrs.minLngErr\r\n                    || attrs.xStepErr\r\n                    || attrs.yStepErr\r\n                ) {\r\n                    $(warnMessage).text(window._gtxt('indexGrid.valueWarn'));\r\n                } else if (attrs.indexCountErr) {\r\n                    $(warnMessage).text(window._gtxt('indexGrid.indexCountWarn'));\r\n                } else if (attrs.nameErr) {\r\n                    $(warnMessage).text(window._gtxt('indexGrid.nameWarn'));\r\n                } else {\r\n                    $(warnMessage).text('');\r\n                }\r\n            },\r\n\r\n            setName: function (e) {\r\n                var value,\r\n                    valueErr;\r\n\r\n                value = e.target.value;\r\n                valueErr = value === '';\r\n\r\n                if (valueErr) {\r\n                    this.model.set('nameErr', true);\r\n                } else {\r\n                    this.model.set('nameErr', false);\r\n                    this.model.set('name', value)\r\n                }\r\n            },\r\n\r\n            selectArea: function () {\r\n                var attrs = this.model.toJSON();\r\n\r\n                if (!attrs.lmap || attrs.selArea) {\r\n                    return;\r\n                }\r\n\r\n                var currentZoom = attrs.lmap.getZoom(),\r\n                    mapBounds = attrs.lmap.getBounds(),\r\n                    latLngs = [\r\n                        mapBounds.getSouthWest(),\r\n                        mapBounds.getNorthWest(),\r\n                        mapBounds.getNorthEast(),\r\n                        mapBounds.getSouthEast()\r\n                    ],\r\n                    // n = mapBounds.getNorth(),\r\n                    // e = mapBounds.getEast(),\r\n                    // s = mapBounds.getSouth(),\r\n                    // w = mapBounds.getWest(),\r\n                    // mapHeight = n - s,\r\n                    // mapWidth = e - w,\r\n\r\n                    // какую часть экрана отсекать с краев первоначальной рамки\r\n                    scale = 4,\r\n                    converted = this._convertFromLatLngs(latLngs, attrs.z),\r\n                    dims = this._getDimensions(converted),\r\n                    xx = [converted[0].x, converted[1].x, converted[2].x, converted[3].x],\r\n                    yy = [converted[0].y, converted[1].y, converted[2].y, converted[3].y],\r\n                    bottomLeft =    L.point(this._getMin(xx) + dims.width / scale,  this._getMax(yy) - dims.height / scale),\r\n                    topLeft =       L.point(this._getMin(xx) + dims.width / scale,  this._getMin(yy) + dims.height / scale),\r\n                    topRight =      L.point(this._getMax(xx) - dims.width / scale,  this._getMin(yy) + dims.height / scale),\r\n                    bottomRight =   L.point(this._getMax(xx) - dims.width / scale,  this._getMax(yy) - dims.height / scale),\r\n                    initialBounds = this._convertToLantLngs([bottomLeft, topLeft, topRight, bottomRight], attrs.z);\r\n\r\n                // прямоугольная рамка\r\n                var rect = L.rectangle(initialBounds);\r\n\r\n                this.model.set({\r\n                    z: currentZoom\r\n                });\r\n\r\n                this._createFrame(rect);\r\n\r\n                this._updateCoords();\r\n                this._updateCorners();\r\n                this._countIndex();\r\n            },\r\n\r\n            unselectArea: function () {\r\n                var attrs = this.model.toJSON();\r\n                this._removeFrame();\r\n\r\n                this.model.set({\r\n                    width: 0,\r\n                    height: 0,\r\n                    z: attrs.lmap.getZoom(),\r\n                    xStep: 1,\r\n                    yStep: 1,\r\n                    xCount: null,\r\n                    yCount: null,\r\n                    xStepErr: false,\r\n                    yStepErr: false,\r\n                    indexCount: null,\r\n                    indexCountErr: false,\r\n                    minLat: null,\r\n                    minLng: null,\r\n                    maxLat: null,\r\n                    maxLng: null,\r\n                    minLatErr: false,\r\n                    maxLatErr: false,\r\n                    maxLngErr: false,\r\n                    minLngErr: false\r\n                });\r\n            },\r\n\r\n            createIndexGrid: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    name = attrs.name,\r\n                    columns = [\r\n                        {\r\n                            Name:\"gmx_id\",\r\n                            ColumnSimpleType:\"Integer\",\r\n                            IsIdentity:true,\r\n                            IsComputed:false,\r\n                            IsPrimary:true\r\n                        },\r\n                        {\r\n                            Name:\"index\",\r\n                            ColumnSimpleType:\"String\",\r\n                            IsIdentity:false,\r\n                            IsComputed:false,\r\n                            IsPrimary:false\r\n                        }\r\n                    ],\r\n                    layerParams = {\r\n                        Title: name,\r\n                        geometrytype: 'polygon',\r\n                        Columns: JSON.stringify(columns),\r\n                    },\r\n                    indexes = this.generatePolygons(),\r\n                    spinHolder = this.$('.spinHolder'),\r\n                    def = nsGmx.asyncTaskManager.sendGmxPostRequest(window.serverBase + \"VectorLayer/CreateVectorLayer.ashx\", layerParams),\r\n                    // promise,\r\n                    _this = this;\r\n\r\n                def.done(function(response) {\r\n                    var layerName = response.Result.properties.name,\r\n                        mapProperties = _layersTree.treeModel.getMapProperties(),\r\n                        targetDiv = $(_queryMapLayers.buildedTree.firstChild).children(\"div[MapID]\")[0],\r\n                        gmxProperties = {type: 'layer', content: response.Result},\r\n                        def2 = _mapHelper.modifyObjectLayer(layerName, indexes, 'EPSG:4326');\r\n\r\n                    gmxProperties.content.properties.mapName = mapProperties.name;\r\n                    gmxProperties.content.properties.hostName = mapProperties.hostName;\r\n                    gmxProperties.content.properties.visible = true;\r\n\r\n                    gmxProperties.content.properties.styles = [{\r\n                        MinZoom: 1,\r\n                        MaxZoom:21,\r\n                        RenderStyle:_mapHelper.defaultStyles[gmxProperties.content.properties.GeometryType]\r\n                    }];\r\n\r\n                    $(spinHolder).show();\r\n\r\n                    def2.always(function() {\r\n                        _layersTree.copyHandler(gmxProperties, targetDiv, false, true);\r\n                        $(spinHolder).hide();\r\n                        _this.unselectArea();\r\n                    })\r\n                });\r\n\r\n            },\r\n\r\n            generatePolygons: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    xStep = this._convertXStep(attrs.xStep),\r\n                    yStep = this._convertYStep(attrs.yStep),\r\n                    xCount = attrs.xCount,\r\n                    yCount = attrs.yCount,\r\n                    // proj = L.Projection.Mercator,\r\n                    north = attrs.maxLat,\r\n                    // south = attrs.minLat,\r\n                    west = attrs.minLng,\r\n                    // east = attrs.maxLng,\r\n                    indexes = [],\r\n                    index,\r\n                    letterIndexes = this._getLetterIndexes(xCount),\r\n                    letter,\r\n                    n, s, e, w;\r\n\r\n                for (var i = 0; i < yCount; i++) {\r\n                    n = north - yStep * i;\r\n                    s = north - yStep * (i+1);\r\n\r\n                    for (var j = 0; j < xCount; j++) {\r\n                        letter = letterIndexes[j];\r\n                        w = west + xStep * j;\r\n                        e = west + xStep * (j+1);\r\n\r\n                        index = {\r\n                            geometry: L.polygon(\r\n                                [\r\n                                    L.latLng(s, w),\r\n                                    L.latLng(n, w),\r\n                                    L.latLng(n, e),\r\n                                    L.latLng(s, e)\r\n                                ]\r\n                            ).toGeoJSON(),\r\n                            properties: {\r\n                                index: letter + (i+1)\r\n                            }\r\n                        };\r\n                        indexes.push(index);\r\n                    }\r\n                }\r\n\r\n                return indexes;\r\n            },\r\n\r\n            setStep: function (e) {\r\n                var value,\r\n                    valueErr;\r\n\r\n                value = Number(e.target.value);\r\n                valueErr = value <= 0 || isNaN(value);\r\n\r\n                // обработка xStep\r\n                if (e.target.className === 'xStep' || e.target.className === 'xStep error') {\r\n                    if (valueErr) {\r\n                        this.model.set('xStepErr', true);\r\n                    } else {\r\n                        this.model.set('xStepErr', false);\r\n                        this.model.set('xStep', value);\r\n                    }\r\n                }\r\n\r\n                // обработка yStep\r\n                if (e.target.className === 'yStep' || e.target.className === 'yStep error') {\r\n                    if (valueErr) {\r\n                        this.model.set('yStepErr', true);\r\n                    } else {\r\n                        this.model.set('yStepErr', false);\r\n                        this.model.set('yStep', value);\r\n                    }\r\n                }\r\n\r\n                this._countIndex();\r\n\r\n            },\r\n\r\n            resize: function (e) {\r\n                var attrs = this.model.toJSON(),\r\n                    initialCoords,\r\n                    coords,\r\n                    // bounds,\r\n                    // scale,\r\n                    // screenCoords,\r\n                    // newBounds,\r\n                    value, valueErr;\r\n\r\n                if (!attrs.lmap || !attrs.selArea) {\r\n                    return;\r\n                }\r\n\r\n                // разница между целевым и текущим зумом\r\n                // scale = Math.pow(2, (attrs.z - attrs.lmap.getZoom()));\r\n                initialCoords = attrs.selArea.rings[0].ring.points._latlngs;\r\n                coords = attrs.coords ? attrs.coords : initialCoords;\r\n\r\n                value = Number(e.target.value);\r\n\r\n                valueErr = !value || isNaN(value);\r\n\r\n                // обработка ввода значений с плавающей точкой\r\n                if (e.target.value.indexOf(\".\") === e.target.value.length - 1) {\r\n                    valueErr = true;\r\n                }\r\n                // обработка minLat\r\n                if (e.target.className === 'minLat' || e.target.className === 'minLat error') {\r\n                    if (valueErr) {\r\n                        this.model.set('minLatErr', true);\r\n                    } else {\r\n                        var north = this._getBounds(coords).getNorth();\r\n\r\n                        if (value < north) {\r\n                            this.model.set('minLatErr', false);\r\n\r\n                            this.model.set('minLat', value);\r\n                        } else {\r\n                            this.model.set('minLatErr', true);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // обработка minLng\r\n                if (e.target.className === 'minLng' || e.target.className === 'minLng error') {\r\n                    if (valueErr) {\r\n                        this.model.set('minLngErr', true);\r\n                    } else {\r\n                        var east = this._getBounds(coords).getEast();\r\n\r\n                        if (value < east) {\r\n                            this.model.set('minLngErr', false);\r\n                            this.model.set('minLng', value);\r\n                        } else {\r\n                            this.model.set('minLngErr', true);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // обработка maxLat\r\n                if (e.target.className === 'maxLat' || e.target.className === 'maxLat error') {\r\n                    if (valueErr) {\r\n                        this.model.set('maxLatErr', true);\r\n                    } else {\r\n                        var south = this._getBounds(coords).getSouth();\r\n\r\n                        if (value > south) {\r\n                            this.model.set('maxLatErr', false);\r\n                            this.model.set('maxLat', value);\r\n                        } else {\r\n                            this.model.set('maxLatErr', true);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // обработка maxLng\r\n                if (e.target.className === 'maxLng' || e.target.className === 'maxLng error') {\r\n                    if (valueErr) {\r\n                        this.model.set('maxLngErr', true);\r\n                    } else {\r\n                        var west = this._getBounds(coords).getWest();\r\n\r\n                        if (value > west) {\r\n                            this.model.set('maxLngErr', false);\r\n                            this.model.set('maxLng', value);\r\n                        } else {\r\n                            this.model.set('maxLngErr', true);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                attrs = this.model.toJSON();\r\n\r\n                if (attrs.maxLngErr || attrs.minLngErr || attrs.minLatErr || attrs.maxLatErr) return;\r\n\r\n                var newRect = L.rectangle([L.latLng(attrs.minLat, attrs.minLng), L.latLng(attrs.maxLat, attrs.maxLng)]);\r\n\r\n                this.model.set({\r\n                    'coords': newRect._latlngs\r\n                });\r\n\r\n                this._removeFrame();\r\n\r\n                this._createFrame(newRect);\r\n                // restore model attributes\r\n                this.model.set({\r\n                    xStep:          attrs.xStep,\r\n                    yStep:          attrs.yStep,\r\n                    xStepErr:       attrs.xStepErr,\r\n                    yStepErr:       attrs.yStepErr,\r\n                    minLatErr:      attrs.minLatErr,\r\n                    maxLatErr:      attrs.maxLatErr,\r\n                    maxLngErr:      attrs.maxLngErr,\r\n                    minLngErr:      attrs.minLngErr\r\n                });\r\n\r\n                this._updateCoords();\r\n                this._updateCorners();\r\n                this._countIndex();\r\n\r\n            },\r\n\r\n            _createFrame: function(rectangle) {\r\n                var attrs = this.model.toJSON(),\r\n                    options = {\r\n                        editable: true,\r\n                        map: true,\r\n                        lineStyle: {\r\n                            dashArray: '5 5',\r\n                            color: '#f57c00',\r\n                            weight: 3.5\r\n                        },\r\n                        pointStyle: {\r\n                            size: L.Browser.mobile ? 40 : 8,\r\n                            color: '#f57c00'\r\n                        }\r\n                    };\r\n\r\n                this.model.set({\r\n                    selArea: attrs.lmap.gmxDrawing.add(rectangle, L.extend(options, {\r\n                        exportRect: true\r\n                    }))\r\n                });\r\n\r\n                // навешивает обработчики на рамку выделения\r\n                var frame = this.model.get('selArea'),\r\n                    _this = this;\r\n\r\n                frame.on('edit', _this._resizeFrame.bind(_this));\r\n                frame.on('remove', _this.unselectArea.bind(_this));\r\n\r\n            },\r\n\r\n            _resizeFrame: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    initialCoords = attrs.selArea.rings[0].ring.points._latlngs,\r\n                    bounds = this._getBounds(initialCoords),\r\n                    err = attrs.minLatErr\r\n                        || attrs.maxLatErr\r\n                        || attrs.maxLngErr\r\n                        || attrs.minLngErr;\r\n\r\n                if (err) {\r\n                    return;\r\n                }\r\n\r\n                this.model.set({\r\n                    coords: initialCoords,\r\n                    minLat: bounds.getSouth(),\r\n                    minLng: bounds.getWest(),\r\n                    maxLat: bounds.getNorth(),\r\n                    maxLng: bounds.getEast()\r\n                });\r\n\r\n                // this.model.set({\r\n                //     minLatErr: false,\r\n                //     maxLatErr: false,\r\n                //     minLngErr: false,\r\n                //     maxLngErr: false\r\n                // });\r\n\r\n\r\n                this._countIndex();\r\n            },\r\n\r\n            _countIndex: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    initialCoords = attrs.selArea.rings[0].ring.points._latlngs,\r\n                    coords = attrs.coords ? attrs.coords : initialCoords,\r\n                    dims = this._getLatLngDimensions(coords);\r\n\r\n                if (attrs.xStep && attrs.yStep) {\r\n                    var xCount = Math.ceil(dims.width / this._convertXStep(attrs.xStep));\r\n                    var yCount = Math.ceil(dims.height / this._convertYStep(attrs.yStep));\r\n                    var indexCount = xCount * yCount;\r\n\r\n                    if (!attrs.xStepErr && !attrs.yStepErr) {\r\n                        if (indexCount > MAX_INDEX_COUNT) {\r\n                            this.model.set('indexCountErr', true);\r\n                        } else {\r\n                            this.model.set('indexCountErr', false);\r\n                        }\r\n                    this.model.set('xCount', xCount);\r\n                    this.model.set('yCount', yCount);\r\n                    this.model.set('indexCount', indexCount);\r\n                    }\r\n                } else {\r\n                    this.model.set('xCount', null);\r\n                    this.model.set('yCount', null);\r\n                    this.model.set('indexCount', null);\r\n                }\r\n            },\r\n\r\n            _getBounds: function (latLngs) {\r\n                var lats,\r\n                    lngs,\r\n                    bottomLeft,\r\n                    topRight;\r\n\r\n\t\t\t\tlats = [latLngs[0][0].lat, latLngs[0][1].lat, latLngs[0][2].lat, latLngs[0][3].lat];\r\n                lngs = [latLngs[0][0].lng, latLngs[0][1].lng, latLngs[0][2].lng, latLngs[0][3].lng];\r\n                bottomLeft = L.latLng(this._getMin(lats), this._getMin(lngs));\r\n                topRight = L.latLng(this._getMax(lats), this._getMax(lngs));\r\n\r\n                return L.latLngBounds(bottomLeft, topRight);\r\n            },\r\n\r\n            _removeFrame: function () {\r\n                var attrs = this.model.toJSON();\r\n\r\n                if (!attrs.selArea) {\r\n                    return;\r\n                }\r\n\r\n                attrs.lmap.gmxDrawing.remove(attrs.selArea);\r\n\r\n                this.model.set({\r\n                    selArea: null,\r\n                    coords: null\r\n                });\r\n            },\r\n\r\n            _updateCoords: function () {\r\n                var attrs = this.model.toJSON(),                    \r\n                    // screenCoords,\r\n                    // dimensions,\r\n                    // bounds,\r\n                    initialCoords;\r\n\r\n                if (!attrs.selArea) {\r\n                    return;\r\n                }\r\n\r\n                initialCoords = attrs.selArea.rings[0].ring.points._latlngs;\r\n\r\n                if (!attrs.coords) {\r\n                    this.model.set('coords', initialCoords);\r\n                }\r\n            },\r\n\r\n            _updateCorners: function () {\r\n                var attrs = this.model.toJSON(),\r\n                    initialCoords = attrs.selArea.rings[0].ring.points._latlngs,\r\n                    bounds = this._getBounds(initialCoords);\r\n\r\n                this.model.set({\r\n                    minLat: bounds.getSouth(),\r\n                    minLng: bounds.getWest(),\r\n                    maxLat: bounds.getNorth(),\r\n                    maxLng: bounds.getEast()\r\n                });\r\n            },\r\n\r\n            _revertCoords: function (coords) {\r\n                var xx,\r\n                    yy,\r\n                    bottomLeft, topLeft,\r\n                    topRight, bottomRight;\r\n\r\n                xx = [coords[0].x, coords[1].x, coords[2].x, coords[3].x];\r\n                yy = [coords[0].y, coords[1].y, coords[2].y, coords[3].y];\r\n                bottomLeft = L.point(this._getMin(xx), this._getMax(yy));\r\n                topLeft = L.point(this._getMin(xx), this._getMin(yy));\r\n                topRight = L.point(this._getMax(xx), this._getMin(yy));\r\n                bottomRight = L.point(this._getMax(xx), this._getMax(yy));\r\n\r\n                return [bottomLeft, topLeft, topRight, bottomRight];\r\n\r\n            },\r\n\r\n            _revertLatLngs: function (latlngs) {\r\n                var lats,\r\n                    lngs,\r\n                    bottomLeft, topLeft,\r\n                    topRight, bottomRight;\r\n\r\n\t\t\t\tlats = [latlngs[0][0].lat, latlngs[0][1].lat, latlngs[0][2].lat, latlngs[0][3].lat];\r\n                lngs = [latlngs[0][0].lng, latlngs[0][1].lng, latlngs[0][2].lng, latlngs[0][3].lng];\r\n                bottomLeft = L.latLng(this._getMin(lats), this._getMin(lngs));\r\n                topLeft = L.latLng(this._getMax(lats), this._getMin(lngs));\r\n                topRight = L.latLng(this._getMax(lats), this._getMax(lngs));\r\n                bottomRight = L.latLng(this._getMin(lats), this._getMax(lngs));\r\n\r\n                return [bottomLeft, topLeft, topRight, bottomRight];\r\n            },\r\n\r\n            _convertFromLatLngs: function (latlngs, zoom) {\r\n                var attrs = this.model.toJSON(),\r\n                    converted = latlngs.map(function(ll) {\r\n                        return attrs.lmap.project([ll.lat, ll.lng], zoom);\r\n                    });\r\n\r\n                return converted;\r\n            },\r\n\r\n            _convertToLantLngs: function (points, zoom) {\r\n                var attrs = this.model.toJSON(),\r\n                    converted = points.map(function(point) {\r\n                        return attrs.lmap.unproject([point.x, point.y], zoom);\r\n                    });\r\n\r\n                return converted;\r\n            },\r\n\r\n            _convertToMercator: function (latlngs) {\r\n                var attrs = this.model.toJSON(),\r\n                    converted = latlngs.map(function(ll) {\r\n                        return attrs.lmap.options.crs.project(ll);\r\n                    });\r\n\r\n                return converted;\r\n            },\r\n\r\n            _convertYStep: function (value) {\r\n                return value / KM_PER_DEGREE;\r\n            },\r\n\r\n            _convertXStep: function (value) {\r\n                var attrs = this.model.toJSON(),\r\n                    centerLat = attrs.minLat + ((attrs.maxLat - attrs.minLat) / 2),\r\n                    centerY = (centerLat * Math.PI) / 180;\r\n\r\n                return (value / KM_PER_DEGREE) / Math.cos(centerY);\r\n            },\r\n\r\n            _getLatLngDimensions: function (latlngs) {\r\n                var bottomLeft, topRight,\r\n                    width, height;\r\n\r\n                latlngs = this._revertLatLngs(latlngs);\r\n\r\n                bottomLeft = latlngs[0];\r\n                topRight = latlngs[2];\r\n                width = Math.abs(topRight.lng - bottomLeft.lng);\r\n                height = Math.abs(topRight.lat - bottomLeft.lat);\r\n\r\n                return {\r\n                    width: width,\r\n                    height: height\r\n                }\r\n            },\r\n\r\n            // get array of string letters (['A'...'Z', 'AA'...'ZZ'...])\r\n            _getLetterIndexes: function (number) {\r\n                var convert = function(srcNum, scrDict, targetDict) {\r\n                   var targetNum = \"\";\r\n                   for (var idx = 0; idx < srcNum.length; ++idx) {\r\n                      var srcDictIdx = scrDict.search(srcNum[idx]);\r\n                      targetNum += targetDict[srcDictIdx];\r\n                   }\r\n                   return targetNum;\r\n                }\r\n\r\n                var buildLettersArray = function (num) {\r\n                    var xlsDict = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\",\r\n                        jsDict  = \"0123456789abcdefghijklmnop\",\r\n                        radix = xlsDict.length,\r\n                        numStart = 0,\r\n                        numEnd = num,\r\n                        rnt = [];\r\n\r\n                    for (var col = numStart; col <= numEnd; col++) {\r\n                       // Unfortunately, the situation is not ideal, we have A...Z and then\r\n                       // AA ... AZ, while A represents the zero digit, so in numbers it is\r\n                       // like having 0..9 and then 00..09 and only then 10...19\r\n                       // so we artificially emulate 00...09 situation here\r\n                       var prefix = \"\";\r\n                       var numb = col;\r\n                       if (col >= radix) {\r\n                           numb = col - radix;\r\n                       }\r\n                       if (col >= radix && col < radix*2) {\r\n                           prefix = \"A\";\r\n                       }\r\n                       var jsNum = Number(numb).toString(radix);\r\n                       rnt.push(prefix + convert(jsNum, jsDict, xlsDict));\r\n                    }\r\n                    return rnt;\r\n                };\r\n\r\n                return buildLettersArray(number);\r\n            },\r\n\r\n            _getDimensions: function(points) {\r\n                var\r\n                    // attrs = this.model.toJSON(),\r\n                    // x, y,\r\n                    bottomLeft, topRight,\r\n                    width, height;\r\n\r\n                points = this._revertCoords(points);\r\n                bottomLeft = points[0];\r\n                topRight = points[2];\r\n                width = Math.abs(topRight.x - bottomLeft.x);\r\n                height = Math.abs(bottomLeft.y - topRight.y);\r\n\r\n                return {\r\n                    width: width,\r\n                    height: height\r\n                }\r\n            },\r\n\r\n            _getMax: function(arr) {\r\n                return Math.max.apply(null, arr);\r\n            },\r\n\r\n            _getMin: function(arr) {\r\n                return Math.min.apply(null, arr);\r\n            },\r\n\r\n            _roundInputNumber: function (value) {\r\n                value = (typeof(value) === 'string') ? value : String(value);\r\n                if (value.indexOf(\".\") != '-1') {\r\n                    value = value.substring(0,value.indexOf(\".\") + 5);\r\n                }\r\n                return value;\r\n            }\r\n        });\r\n\r\n        view = new IndexGridView();\r\n\r\n        this.Load = function () {\r\n            var lm = model.get('lm');\r\n\r\n            if (lm != null) {\r\n                var alreadyLoaded = lm.createWorkCanvas('mapIndexGrid', this.Unload);\r\n                if (!alreadyLoaded) {\r\n                    $(lm.workCanvas).append(view.el);\r\n                }\r\n            }\r\n        }\r\n        this.Unload = function () {\r\n            var attrs = model.toJSON();\r\n            attrs.lmap.gmxDrawing.remove(attrs.selArea);\r\n            model.set({\r\n                selArea: null,\r\n                xStep: 1,\r\n                yStep: 1,\r\n                xCount: null,\r\n                yCount: null,\r\n                xStepErr: false,\r\n                yStepErr: false,\r\n                indexCount: null,\r\n                indexCountErr: false,\r\n                maxLat: null,\r\n                maxLng: null,\r\n                minLat: null,\r\n                minLng: null,\r\n                maxLatErr: false,\r\n                minLatErr: false,\r\n                maxLngErr: false,\r\n                minLngErr: false,\r\n                z: attrs.lmap.getZoom(),\r\n                coords: null\r\n            });\r\n        };\r\n    }\r\n\r\n    var publicInterface = {\r\n        pluginName: 'IndexGrid',\r\n        IndexGridMenu: IndexGridMenu\r\n  };\r\n\r\n    gmxCore.addModule('IndexGrid',\r\n        publicInterface\r\n    );","import nsGmx from '../nsGmx.js'\r\nimport '../AsyncTaskManager.js';\r\nimport {\r\n    parseResponse,\r\n    sendCrossDomainJSONRequest,\r\n} from '../utilities.js';\r\nimport './PhotoLayer.css';\r\nimport '../gmxcore.js';\r\n\r\n    window._translationsHash.addtext('rus', {\r\n        photoLayer: {\r\n            catalog: \"Каталог\",\r\n            newCatalog: \"в новый каталог\",\r\n            existingCatalog: \"в существующий каталог\",\r\n            placeholder: \"Введите имя каталога\",\r\n            name: \"Имя каталога\",\r\n            available: \"доступные каталоги\",\r\n            load: \"Загрузить фотографии\",\r\n            loadShort: \"ЗАГРУЗИТЬ\",\r\n            processing: \"обработка изображений\",\r\n            error: \"ошибка\",\r\n            successResult: \"загружено фотографий\",\r\n            exifError: \"ошибка чтения координат\",\r\n            ok: \"готово\"\r\n        }\r\n    });\r\n\r\n    window._translationsHash.addtext('eng', {\r\n        photoLayer: {\r\n            catalog: \"Catalog\",\r\n            newCatalog: \"into new catalog\",\r\n            existingCatalog: \"into existing catalog\",\r\n            placeholder: \"Type catalog name\",\r\n            name: \"name\",\r\n            available: \"available catalogs\",\r\n            load: \"Load photos\",\r\n            loadShort: \"LOAD\",\r\n            processing: \"image processing\",\r\n            error: \"error\",\r\n            successResult: \"images uploaded\",\r\n            exifError: \"coordinates error\",\r\n            ok: \"done\"\r\n        }\r\n    });\r\n\r\n    var PhotoLayer = function () {\r\n        var dialog;\r\n\r\n    var PhotoLayerModel = window.Backbone.Model.extend({\r\n        defaults: {\r\n            fileName: null,\r\n            photoLayersFlag: false,\r\n            currentPhotoLayer: null,\r\n            photoLayers: [],\r\n            sandbox: ''\r\n        }\r\n    });\r\n\r\n\r\n    var PhotoLayerView = window.Backbone.View.extend({\r\n        tagName: 'div',\r\n        model: new PhotoLayerModel(),\r\n        template: Handlebars.compile('' +\r\n            '<div class=\"photolayer-ui-container photolayer-properties-container\">' +\r\n                '<div class=\"photolayer-ui-container photolayer-catalog-selector-container\">' +\r\n                    '{{#if photoLayersFlag}}' +\r\n                    '<span class=\"select-catalog-button existing-catalog-button\">{{i \"photoLayer.existingCatalog\"}}</span>' +\r\n                    '{{/if}}' +\r\n                    '<span class=\"select-catalog-button new-catalog-button\">{{i \"photoLayer.newCatalog\"}}</span>' +\r\n                '</div>' +\r\n                '<div class=\"photolayer-ui-container photolayer-newlayer-input-container\"' +\r\n                '{{#if photoLayersFlag}}' +\r\n                'style=\"display:none\"' +\r\n                '{{/if}}' +\r\n                '>' +\r\n                    '<span class=\"photolayer-title photolayer-name-title\">{{i \"photoLayer.name\"}}</span>' +\r\n                    '<input type=\"text\" class=\"photolayer-name-input photolayer-newlayer-input minInputStyle\"/>' +\r\n                '</div>' +\r\n                '<div class=\"photolayer-ui-container photolayer-existinglayer-input-container\" ' +\r\n                '{{#unless photoLayersFlag}}' +\r\n                'style=\"display:none\"' +\r\n                '{{/unless}}' +\r\n                '>' +\r\n                    '<span class=\"photolayer-title photolayer-name-title\">{{i \"photoLayer.name\"}}</span>' +\r\n                    '<select class=\"photolayer-name-input photolayer-existinglayer-input\">' +\r\n                        '{{#each this.photoLayers}}' +\r\n                        '<option value=\"{{this.layer}}\"' +\r\n                            '{{#if this.current}} selected=\"selected\"{{/if}}>' +\r\n                            '{{this.layer}}' +\r\n                        '</option>' +\r\n                        '{{/each}}' +\r\n                    '</select>' +\r\n                '</div>' +\r\n                '<div class=\"photolayer-ui-block photolayer-loader-block\">' +\r\n                        '<label class=\"photo-uploader-label\">' +\r\n                        '<span class=\"photo-uploader-button\">{{i \"photoLayer.loadShort\"}}</span>' +\r\n                            '<form id=\"photo-uploader-form\" name=\"photouploader\" enctype=\"multipart/form-data\" method=\"post\">' +\r\n                                '<input type=\"file\" name=\"file\" id=\"photo-uploader\" accept=\"image/*\" multiple></input>' +\r\n                            '</form>' +\r\n                        '</label>' +\r\n                    '<span class=\"photolayer-progress-container\">' +\r\n                        '<span class=\"progressbar\"></span>' +\r\n                    '</span>' +\r\n                    '<span class=\"photolayer-spin-container\" style=\"display:none\">' +\r\n                        '<img src=\"img/progress.gif\"/>' +\r\n                        '<span class=\"spin-message\">{{i \"photoLayer.processing\"}}</span>' +\r\n                    '</span>' +\r\n                    '<span class=\"photolayer-ui-container photolayer-ok-button-container\" style=\"display:none\">' +\r\n                        '<span class=\"ok-button\">{{i \"photoLayer.ok\"}}</span>' +\r\n                    '</span>' +\r\n                    '<span class=\"photolayer-error-message\" style=\"display:none\"></span>' +\r\n                '</div>' +\r\n                '<div class=\"photo-upload-result photo-upload-result-uploaded\" style=\"display:none\">' +\r\n                '</div>' +\r\n                '<div class=\"photo-upload-result photo-upload-result-error\" style=\"display:none\">' +\r\n                '</div>' +\r\n            '</div>'\r\n        ),\r\n\r\n        events: {\r\n            'click .select-catalog-button': 'setCatalogType',\r\n            'keyup .photolayer-newlayer-input': 'setName',\r\n            'change .photolayer-existinglayer-input': 'setCurrentLayer',\r\n            'change #photo-uploader': 'selectFile'\r\n        },\r\n\r\n        initialize: function () {\r\n            this.getPhotoLayers();\r\n            this.createSandbox();\r\n            this.render();\r\n\r\n            this.listenTo(this.model, 'change:fileName', this.updateName);\r\n            this.listenTo(this.model, 'change:photoLayers', this.updatePhotoLayersList);\r\n        },\r\n\r\n        render: function () {\r\n            var attrs = this.model.toJSON();\r\n\r\n            this.$el.html(this.template(this.model.toJSON()));\r\n            this.updatePhotoLayersList();\r\n\r\n            var firstButton = this.$('.select-catalog-button')[0],\r\n                uploadBlock = this.$('.photo-uploader-label').add(this.$('.photo-uploader-button'));\r\n\r\n            $(firstButton).addClass('active');\r\n\r\n            $(uploadBlock).toggleClass('gmx-disabled', !attrs.photoLayersFlag);\r\n            this.$('.photolayer-newlayer-input').prop('placeholder', _gtxt('photoLayer.placeholder'))\r\n        },\r\n\r\n        getPhotoLayers: function (layers) {\r\n            layers = layers || nsGmx.gmxMap.layers;\r\n            var attrs = this.model.toJSON(),\r\n                photoLayersFlag = attrs.photoLayersFlag,\r\n                currentPhotoLayer,\r\n                photoLayers = [];\r\n\r\n            for (let i = 0; i < layers.length; i++) {\r\n                let layer = layers[i],\r\n                    props = layer.getGmxProperties(),\r\n                    isPhotoLayer;\r\n\r\n                if (props) {\r\n                    isPhotoLayer = props.IsPhotoLayer;\r\n\r\n                    if (isPhotoLayer && props.Access === 'edit') {\r\n                        photoLayersFlag = true;\r\n\r\n                        photoLayers.push({layer: props.title, LayerID: props.LayerID, current: false});\r\n                    }\r\n                }\r\n\r\n                for (let j = 0; j < photoLayers.length; j++) {\r\n                    photoLayers[j].current = j === 0;\r\n\r\n                    if (j === 0) {\r\n                        currentPhotoLayer = nsGmx.gmxMap.layersByID[photoLayers[j].LayerID];\r\n                    }\r\n                }\r\n            }\r\n\r\n            this.model.set({\r\n                photoLayersFlag: photoLayersFlag,\r\n                photoLayers: photoLayers,\r\n                currentPhotoLayer: currentPhotoLayer\r\n            });\r\n        },\r\n\r\n        setCatalogType: function (e) {\r\n            var attrs = this.model.toJSON(),\r\n                newCatalog = $(e.target).hasClass('new-catalog-button'),\r\n                newContainer = $('.photolayer-newlayer-input-container'),\r\n                existingContainer = $('.photolayer-existinglayer-input-container'),\r\n                newLayerInput = this.$('.photolayer-newlayer-input'),\r\n                uploadBlock = this.$('.photo-uploader-label').add(this.$('.photo-uploader-button'));\r\n\r\n            if (newCatalog) {\r\n                $(uploadBlock).toggleClass('gmx-disabled', !attrs.fileName);\r\n                $(newContainer).toggle(true);\r\n                $(existingContainer).toggle(false);\r\n                $(e.target).toggleClass('active', true);\r\n                $('.existing-catalog-button').toggleClass('active', false);\r\n                $(newLayerInput).focus();\r\n\r\n                this.model.set({\r\n                    photoLayers: [],\r\n                    fileName: null,\r\n                    currentPhotoLayer: null\r\n                });\r\n\r\n                this.createSandbox();\r\n            } else {\r\n                this.getPhotoLayers();\r\n                $(uploadBlock).toggleClass('gmx-disabled', false);\r\n                $(existingContainer).toggle(true);\r\n                $(newContainer).toggle(false);\r\n                $(e.target).toggleClass('active', true);\r\n                $('.new-catalog-button').toggleClass('active', false);\r\n            }\r\n        },\r\n\r\n        createSandbox: function () {\r\n            var _this = this;\r\n\r\n            sendCrossDomainJSONRequest(window.serverBase + 'Sandbox/CreateSandbox', function(response) {\r\n                if (parseResponse(response) && response.Result) {\r\n                    _this.model.set('sandbox', response.Result.sandbox);\r\n                }\r\n            });\r\n        },\r\n\r\n        setName: function (e) {\r\n            var layers = layers || nsGmx.gmxMap.layers,\r\n                // attrs = this.model.toJSON(),\r\n                start = e.target.selectionStart,\r\n                end = e.target.selectionEnd,\r\n                matchingLayer;\r\n\r\n            for (var i = 0; i < layers.length; i++) {\r\n                var layer = layers[i],\r\n                    props = layer.getGmxProperties();\r\n\r\n                if (props) {\r\n                    if (e.target.value === props.title) {\r\n                        matchingLayer = layer;\r\n                    }\r\n                }\r\n            }\r\n\r\n            this.model.set('fileName', e.target.value);\r\n\r\n            this.model.set('currentPhotoLayer', matchingLayer ? matchingLayer : null);\r\n\r\n            // восстановим позицию курсора\r\n            e.target.setSelectionRange(start, end);\r\n        },\r\n\r\n        setCurrentLayer: function (e) {\r\n            var layers = nsGmx.gmxMap.layers,\r\n                currentPhotoLayer;\r\n\r\n\r\n            for (var i = 0, len = layers.length; i < len; i++) {\r\n                var layer = layers[i],\r\n                    props = layer.getGmxProperties();\r\n\r\n                if (props && props.title === e.target.value) {\r\n                    currentPhotoLayer = layer;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            this.model.set({\r\n                currentPhotoLayer: currentPhotoLayer\r\n            });\r\n        },\r\n\r\n        updateName: function () {\r\n            var attrs = this.model.toJSON(),\r\n                newLayerInput = this.$('.photolayer-newlayer-input'),\r\n                uploadBlock = this.$('.photo-uploader-label').add(this.$('.photo-uploader-button'));\r\n\r\n            $(newLayerInput).val(attrs.fileName);\r\n            $(uploadBlock).toggleClass('gmx-disabled', !attrs.fileName);\r\n        },\r\n\r\n        updatePhotoLayersList: function () {\r\n            var attrs = this.model.toJSON(),\r\n                photoLayers = attrs.photoLayers,\r\n                currentPhotoLayerName = attrs.currentPhotoLayer && attrs.currentPhotoLayer.getGmxProperties().title,\r\n                str = '',\r\n                select = this.$('.photolayer-existinglayer-input');\r\n\r\n            if (photoLayers.length) {\r\n                for (var i = 0; i < photoLayers.length; i++) {\r\n                    str += '<option>' + photoLayers[i].layer + '</option>';\r\n                }\r\n            }\r\n            $(select).html(str);\r\n\r\n            $('.photolayer-existinglayer-input option[value=\"' + currentPhotoLayerName + '\"]').prop('selected', true);\r\n        },\r\n\r\n        selectFile: function (e) {\r\n            var files = e.target.files,\r\n                form = this.$('#photo-uploader-form'),\r\n                arr = [],\r\n                newLayerInput = this.$('.photolayer-newlayer-input'),\r\n                uploadLabel = this.$('.photo-uploader-label'),\r\n                uploadButton = this.$('.photo-uploader-button'),\r\n                progressBarContainer = this.$('.photolayer-progress-container'),\r\n                progressBar = this.$('.progressbar'),\r\n                spinContainer = this.$('.photolayer-spin-container'),\r\n                okButton = this.$('.photolayer-ok-button-container'),\r\n                uploadResSuccess = this.$('.photo-upload-result-uploaded'),\r\n                uploadResError = this.$('.photo-upload-result-error'),\r\n                errorMessage = this.$('.photolayer-error-message');\r\n\r\n            for (var key in files) {\r\n                if (files.hasOwnProperty(key)) {\r\n                    arr.push(files[key]);\r\n                }\r\n            }\r\n\r\n            $(progressBarContainer).hide();\r\n            $(spinContainer).hide();\r\n            $(okButton).hide();\r\n            $(errorMessage).hide();\r\n            $(uploadResSuccess).hide();\r\n            $(uploadResError).hide();\r\n\r\n            files = e.target.files;\r\n            var attrs = this.model.toJSON(),\r\n                _this = this,                \r\n                // sandbox,\r\n                uploadParams = {\r\n                    sandbox: attrs.sandbox\r\n                },\r\n                params,\r\n                url, def;\r\n\r\n                if (attrs.currentPhotoLayer) {\r\n                    params = {\r\n                        LayerID: attrs.currentPhotoLayer.getGmxProperties().LayerID,\r\n                        PhotoSource: JSON.stringify({sandbox: attrs.sandbox})\r\n                    }\r\n                } else {\r\n                    params = {\r\n                        Columns: \"[]\",\r\n                        Copyright: \"\",\r\n                        Description: \"\",\r\n                        SourceType: \"manual\",\r\n                        title: attrs.fileName,\r\n                        IsPhotoLayer: true,\r\n                        PhotoSource: JSON.stringify({sandbox: attrs.sandbox})\r\n                    }\r\n                }\r\n\r\n                $(form).prop('action', window.serverBase + 'Sandbox/Upload' + '?' + $.param(uploadParams));\r\n\r\n                var formData = new FormData($(form)[0]);\r\n\r\n                formData.append(\"sandbox\", attrs.sandbox);\r\n\r\n                for (var i = 0; i < files.length; i++) {\r\n                    formData.append(i, files[i]);\r\n                }\r\n\r\n                $(progressBar).progressbar({\r\n                    max: 100,\r\n                    value: 0\r\n                });\r\n\r\n                $(progressBarContainer).show();\r\n                var xhr = new XMLHttpRequest();\r\n\r\n                xhr.upload.addEventListener(\"progress\", function(e) {\r\n                        $(progressBar).progressbar('option', 'value', e.loaded / e.total * 100);\r\n                }, false);\r\n\r\n                xhr.open('POST', window.serverBase + 'Sandbox/Upload');\r\n                $(uploadButton).toggleClass('gmx-disabled', true);\r\n                $(uploadLabel).toggleClass('gmx-disabled', true);\r\n                xhr.withCredentials = true;\r\n                xhr.onload = function () {\r\n                    if (xhr.status === 200) {\r\n                        var response = xhr.responseText;\r\n\r\n                        if (!(response)) {\r\n                            return;\r\n                        }\r\n\r\n                        $(progressBarContainer).hide();\r\n                        $(spinContainer).show();\r\n\r\n                        if (attrs.currentPhotoLayer) {\r\n                            url = window.serverBase + 'Photo/AppendPhoto' + '?' + $.param(params);\r\n                        } else {\r\n                            url = window.serverBase + 'VectorLayer/Insert.ashx' + '?' + $.param(params);\r\n                        }\r\n                        def = nsGmx.asyncTaskManager.sendGmxPostRequest(url);\r\n\r\n                        def.done(function(taskInfo){\r\n                            if (!attrs.currentPhotoLayer) {\r\n                                var mapProperties = window._layersTree.treeModel.getMapProperties(),\r\n                                    targetDiv = $(window._queryMapLayers.buildedTree.firstChild).children(\"div[MapID]\")[0],\r\n                                    gmxProperties = {type: 'layer', content: taskInfo.Result},\r\n                                    imageUrlParams = {\r\n                                        LayerID: gmxProperties.content.properties.LayerID,\r\n                                        size: 'M'\r\n                                    },\r\n                                    bigImageUrlParams = {\r\n                                        LayerID: gmxProperties.content.properties.LayerID,\r\n                                        size: 'Native'\r\n                                    },\r\n                                    imageUrl = window.serverBase + 'rest/ver1/photo/getimage.ashx' + '?' + $.param(imageUrlParams) + '&rowId=[gmx_id]',\r\n                                    bigImageUrl = window.serverBase + 'rest/ver1/photo/getimage.ashx' + '?' + $.param(bigImageUrlParams) + '&rowId=[gmx_id]',\r\n                                    balloonString = '' +\r\n                                        '<div style=\"min-width: 300px;\">' +\r\n                                            '<div style=\"width: 100%; text-align: center;\">' +\r\n                                                '<a href=\"' + bigImageUrl + '\" target=\"_blank\">' +\r\n                                                    '<img class=\"popupImage\" src=\"' + imageUrl + '\" alt=\"\"/>' +\r\n                                                '</a>' +\r\n                                            '</div>' +\r\n                                            '<div>' +\r\n                                                '<b>' + window._gtxt(\"Имя\") + ':</b> ' + '[GMX_Filename]' +\r\n                                            '</div>' +\r\n                                            '<div>' +\r\n                                                '<b>' + window._gtxt(\"Момент съемки\") + ':</b> ' + '[GMX_Date]' +\r\n                                            '</div>' +\r\n                                            '<div>' +\r\n                                                '[SUMMARY]' +\r\n                                            '</div>' +\r\n                                            '<div>' +\r\n                                                '<b>' + \"Комментарии\" + ':</b> ' + '[Comments]' +\r\n                                            '</div>' +\r\n                                        '</div>';\r\n\r\n                                gmxProperties.content.properties.mapName = mapProperties.name;\r\n                                gmxProperties.content.properties.hostName = mapProperties.hostName;\r\n                                gmxProperties.content.properties.visible = true;\r\n\r\n                                var renderStyle = {\r\n\t\t\t\t\t\t\t\t\tmarker: {\r\n\t\t\t\t\t\t\t\t\t\tcenter: _mapHelper.defaultPhotoIconStyles.point.marker.center,\r\n\t\t\t\t\t\t\t\t\t\timage: window.serverBase ? window.serverBase.replace('http://', '//').replace ('https://', '//') + _mapHelper.defaultPhotoIconStyles.point.marker.image : _mapHelper.defaultPhotoIconStyles.point.marker.image\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t};\r\n\r\n                                gmxProperties.content.properties.styles = [{\r\n                                    MinZoom: 1,\r\n                                    MaxZoom:21,\r\n                                    Balloon: balloonString,\r\n                                    RenderStyle: renderStyle\r\n                                }];\r\n\r\n                                // вставляем фотослой на карту\r\n                                var modifyMapObjects = [{\r\n                                        Action: 'insert',\r\n                                        index: 'top',\r\n                                        LayerName: gmxProperties.content.properties.LayerID,\r\n                                        Styles: gmxProperties.content.properties.styles\r\n                                    }],\r\n                                    modifyMapParams = {\r\n                                        MapName: mapProperties.MapID,\r\n                                        Objects: JSON.stringify(modifyMapObjects)\r\n                                    },\r\n                                    modifyMapUrl = window.serverBase + 'Map/ModifyMap.ashx' + '?' + $.param(modifyMapParams);\r\n\r\n                                // вставляем фотографии в пустой слой\r\n                                var photoAppendParams = {\r\n                                        LayerID: gmxProperties.content.properties.LayerID,\r\n                                        PhotoSource: JSON.stringify({sandbox: attrs.sandbox})\r\n                                    },\r\n                                    photoAppendUrl = window.serverBase + 'Photo/AppendPhoto' + '?' + $.param(photoAppendParams);\r\n\r\n                                sendCrossDomainJSONRequest(modifyMapUrl, function () {\r\n                                    var def = nsGmx.asyncTaskManager.sendGmxPostRequest(photoAppendUrl);\r\n\r\n                                    def.done(function(taskInfo) {\r\n\r\n                                        parseGeometry(taskInfo, gmxProperties);\r\n\r\n                                        window._layersTree.copyHandler(gmxProperties, targetDiv, false, true);\r\n\r\n                                        var newLayer = nsGmx.gmxMap.layersByID[gmxProperties.content.properties.LayerID];\r\n\r\n                                        newLayer.bindClusters({\r\n                                            iconCreateFunction: function(cluster) {\r\n                                                var photoClusterIcon = L.divIcon({\r\n                                                    html: '<img src=\"' + (window.serverBase ? window.serverBase + _mapHelper.defaultPhotoIconStyles.point.marker.image : _mapHelper.defaultPhotoIconStyles.point.marker.image) + '\" class=\"photo-icon\"/><div class=\"marker-cluster-photo\">' + cluster.getChildCount() + '</div>',\r\n                                                    className: 'photo-div-icon',\r\n                                                    iconSize: [14, 12],\r\n                                                    iconAnchor: [0, 0]\r\n                                                });\r\n                                                return photoClusterIcon;\r\n                                            },\r\n                                            maxClusterRadius: 40,\r\n                                            spiderfyOnMaxZoom: true,\r\n                                            spiderfyZoom: 14,\r\n                                            spiderfyDistanceMultiplier: 1.2,\r\n                                            disableClusteringAtZoom: 19,\r\n                                            maxZoom: 19\r\n                                        });\r\n\r\n                                        // newLayer.updateVersion(gmxProperties.content);\r\n\r\n                                        _this.model.set({\r\n                                            currentPhotoLayer: newLayer\r\n                                        });\r\n\r\n                                        afterLoad(taskInfo);\r\n                                    })\r\n                                    .fail(function(taskInfo) {\r\n                                        var message = taskInfo.ErrorInfo && taskInfo.ErrorInfo.ErrorMessage;\r\n\r\n                                        $(errorMessage).html(message in _mapHelper.customErrorsHash  ? _gtxt(_mapHelper.customErrorsHash[message]) : _gtxt('photoLayer.error'));\r\n                                        $(errorMessage).show();\r\n                                        afterLoad(taskInfo);\r\n                                    }).progress(function(){});\r\n                                });\r\n\r\n                            $(newLayerInput).focus();\r\n\r\n                            } else {\r\n                                // var curName = attrs.currentPhotoLayer.getGmxProperties().name;\r\n                                // parseGeometry(taskInfo, gmxProperties);\r\n                                // window.sendCrossDomainJSONRequest(window.serverBase + \"Layer/GetLayerJson.ashx?WrapStyle=func&LayerName=\" + curName, function(response) {\r\n                                //     if (!parseResponse(response)) {\r\n                                //         return;\r\n                                //     }\r\n                                //     debugger;\r\n                                //     console.log(response);\r\n                                //     // L.gmx.layersVersion.chkVersion(response.Result, null);\r\n                                //     attrs.currentPhotoLayer.updateVersion(response.Result);\r\n                                // });\r\n                                // L.gmx.layersVersion.chkVersion(gmxProperties.content);\r\n                                // attrs.currentPhotoLayer.updateVersion(gmxProperties.content);\r\n\r\n                                afterLoad(taskInfo);\r\n                            }\r\n\r\n                        }).fail(function(taskInfo){\r\n                            var message = taskInfo.ErrorInfo && taskInfo.ErrorInfo.ErrorMessage;\r\n\r\n                            $(errorMessage).html(message in _mapHelper.customErrorsHash  ? _gtxt(_mapHelper.customErrorsHash[message]) : _gtxt('photoLayer.error'));\r\n                            $(errorMessage).show();\r\n                            afterLoad(taskInfo);\r\n\r\n                        }).progress(function(){});\r\n                    }\r\n\r\n                    function parseGeometry(info, properties) {\r\n                        var coords = [],\r\n                            appended = info.Result.Appended,\r\n                            updated = info.Result.Updated,\r\n                            addCoords = function (objects, coordinates) {\r\n                                for (var a = 0; a < objects.length; a++) {\r\n                                    if (objects[a].longitude && objects[a].latitude) {\r\n                                        var point = nsGmx.leafletMap.options.crs.project(L.latLng(objects[a].longitude, objects[a].latitude));\r\n                                        coordinates.push([point.x, point.y]);\r\n                                    }\r\n                                }\r\n                            };\r\n\r\n                        addCoords(appended, coords);\r\n                        addCoords(updated, coords);\r\n\r\n                        if (!coords.length) {\r\n                            properties.content.geometry = null;\r\n                        } else {\r\n                            properties.content.geometry.coordinates = coords.length === 1 ? coords[0] : coords;\r\n                            properties.content.geometry.type = coords.length === 1 ? 'POINT' : 'POLYGON';\r\n                        }\r\n                    }\r\n\r\n                    function afterLoad(taskInfo) {\r\n                        var resObj = taskInfo.Result;\r\n\r\n                        if (resObj) {\r\n                            if (resObj.Appended.length) {\r\n                                $(uploadResSuccess).html(_gtxt('photoLayer.successResult') + \": \" + resObj.Appended.length);\r\n                                $(uploadResSuccess).show();\r\n                            }\r\n                            if (resObj.NoCoords.length) {\r\n                                $(uploadResError).html(_gtxt('photoLayer.exifError') + \": \" + resObj.NoCoords.length);\r\n                                $(uploadResError).show();\r\n                            }\r\n                        }\r\n\r\n                        $(spinContainer).hide();\r\n\r\n                        $(uploadButton).toggleClass('gmx-disabled', false);\r\n                        $(uploadLabel).toggleClass('gmx-disabled', false);\r\n                        _this.createSandbox();\r\n                    }\r\n                };\r\n\r\n            xhr.send(formData);\r\n        }\r\n    });\r\n\r\n    this.Load = function () {\r\n        var view = new PhotoLayerView(),\r\n            resizeFunc = function () {},\r\n            closeFunc = function () {\r\n                view.model.set({\r\n                    photoLayersFlag: false,\r\n                    photoLayers: [],\r\n                    currentPhotoLayer: null,                    \r\n                });\r\n            };\r\n\r\n        dialog = nsGmx.Utils.showDialog(_gtxt('photoLayer.load'), view.el, 340, 220, null, null, resizeFunc, closeFunc);\r\n    }\r\n\r\n    this.Unload = function () {\r\n        $(dialog).remove();\r\n    };\r\n};\r\n\r\nvar publicInterface = {\r\n    pluginName: 'PhotoLayer',\r\n    PhotoLayer: PhotoLayer\r\n};\r\n\r\nwindow.gmxCore.addModule('PhotoLayer',\r\n    publicInterface\r\n);","import nsGmx from '../nsGmx.js';\r\nimport {\r\n    inputError,\r\n    parseResponse,\r\n    sendCrossDomainJSONRequest,\r\n    sendCrossDomainPostRequest,\r\n} from '../utilities.js';\r\nimport './UserGroupWidget.css';\r\n\r\n(function() {\r\n\r\n'use strict';\r\n\r\nnsGmx.Translations.addText('rus', {uglw: {\r\n    headerTitle: 'Фильтр',\r\n    listheader: {\r\n        title: 'Название',\r\n        description: 'Описание'\r\n    },\r\n    groupProps: {\r\n        title: 'Название',\r\n        description: 'Описание'\r\n    },\r\n    popover: {\r\n        title: 'Удалить группу',\r\n        ok: 'Ok',\r\n        cancel: 'Отмена'\r\n    },\r\n    shareLabel: 'Права на ресурсы внутри группы:',\r\n    share: {\r\n        'public': 'общие',\r\n        'private': 'раздельные'\r\n    }\r\n}});\r\n\r\nnsGmx.Translations.addText('eng', {uglw: {\r\n    headerTitle: 'Filter',\r\n    listheader: {\r\n        title: 'Title',\r\n        description: 'Description'\r\n    },\r\n    groupProps: {\r\n        title: 'Title',\r\n        description: 'Description'\r\n    },\r\n    popover: {\r\n        title: 'Delete group',\r\n        ok: 'Ok',\r\n        cancel: 'Cancel'\r\n    },\r\n    shareLabel: 'Sharing resources among members:',\r\n    share: {\r\n        'public': 'selectively',\r\n        'private': 'by default'\r\n    }\r\n}});\r\n\r\nvar Group = Backbone.Model.extend({\r\n    idAttribute: 'UserID'\r\n});\r\n\r\nvar GroupList = Backbone.Collection.extend({\r\n    model: Group\r\n});\r\n\r\nvar GroupListView = Backbone.View.extend({\r\n    template: Handlebars.compile(\r\n        '<table class=\"uglw-table\">' +\r\n            '<thead class=\"tableHeader\">' +\r\n                '<th class=\"uglw-table-title\">{{i \"uglw.listheader.title\"}}</th>' +\r\n                '<th class=\"uglw-table-descr\">{{i \"uglw.listheader.description\"}}</th>' +\r\n                '<th></th>' +\r\n            '</thead><tbody class=\"tableBody\">' +\r\n            '{{#users}}' +\r\n            '<tr class=\"uglw-row\">' +\r\n                '<td><span class=\"uglw-group-name\" data-groupid=\"{{UserID}}\">{{Nickname}}</span></td>' +\r\n                '<td>{{Description}}</td>' +\r\n                '<td><div class=\"gmx-icon-recycle\" data-groupid=\"{{UserID}}\"></div></td>' +\r\n            '</tr>' +\r\n        '{{/users}}</tbody></table>'\r\n    ),\r\n    initialize: function() {\r\n        this.listenTo(this.model, 'reset', this.render);\r\n    },\r\n    render: function() {\r\n        var _this = this;\r\n        var rawAttributes = this.model.map(function(user) {\r\n            return user.attributes;\r\n        });\r\n\r\n        this.$el.empty().append($(this.template({users: rawAttributes})));\r\n\r\n        this.$el.find('.uglw-group-name').click(function() {\r\n            var groupID = Number($(this).data('groupid'));\r\n\r\n            var groupSecurity = new UserGroupSecurity();\r\n\r\n            $(groupSecurity).on('savedone', function() {\r\n                _this.trigger('needupdate');\r\n            });\r\n\r\n            groupSecurity.propertyValue = groupID;\r\n            groupSecurity.title = _this.model.get(groupID).get('Nickname');\r\n            groupSecurity.getSecurityFromServer(groupID).then(function(res) {\r\n                groupSecurity.createSecurityDialog(res);\r\n                $(groupSecurity._dialogDiv).find('.security-props-title').focus();\r\n            })\r\n\r\n        });\r\n\r\n        var popoverUI = $(Handlebars.compile('<div>' +\r\n            '<div>{{i \"uglw.popover.title\"}}?</div>' +\r\n            '<div class=\"uglw-popover-buttons\">' +\r\n                '<button class=\"uglw-popover-ok\">{{i \"uglw.popover.ok\"}}</button>' +\r\n                '<button class=\"uglw-popover-cancel\">{{i \"uglw.popover.cancel\"}}</button>' +\r\n            '</div>' +\r\n        '</div>')());\r\n\r\n        popoverUI.find('.uglw-popover-ok').click(function() {\r\n            sendCrossDomainJSONRequest(window.serverBase + 'User/DeleteGroup?GroupID=' + _this._popoverGroupID, function(response) {\r\n                if (!parseResponse(response)) {\r\n                    return;\r\n                }\r\n\r\n                _this.trigger('needupdate');\r\n                _this.$el.find('.gmx-icon-recycle').popover('hide');\r\n            });\r\n        });\r\n\r\n        popoverUI.find('.uglw-popover-cancel').click(function() {\r\n            _this.$el.find('.gmx-icon-recycle').popover('hide');\r\n        });\r\n\r\n        this.$el.find('.gmx-icon-recycle').click(function() {\r\n            var groupID = Number($(this).data('groupid'));\r\n            _this._popoverGroupID = groupID;\r\n        }).popover({\r\n            content: popoverUI[0],\r\n            placement: 'left',\r\n            html: true\r\n        }).on('shown.bs.popover', function(event) {\r\n            _this.$el.find('.gmx-icon-recycle').each(function(i, icon) {\r\n                if (icon !== event.target) {\r\n                    $(icon).popover('hide');\r\n                }\r\n            })\r\n        });\r\n    }\r\n});\r\n\r\nnsGmx.UserGroupListWidget = function(container) {\r\n    var ui = $(nsGmx.UserGroupListWidget._mainTemplate()).appendTo(container);\r\n\r\n    var groupList = new GroupList();\r\n\r\n    var listView = new GroupListView({\r\n        el: ui.find('.uglw-list-placeholder')[0],\r\n        model: groupList\r\n    });\r\n\r\n    var refilterUsers = function() {\r\n        nsGmx.security.findUsers(ui.find('.uglw-filter-input').val(), {type: 'Group'}).then(function(users) {\r\n            groupList.reset(users);\r\n        })\r\n    }\r\n\r\n    listView.on('needupdate', refilterUsers);\r\n\r\n    var lastValue = null;\r\n    ui.find('.uglw-filter-input').on('keyup change', function(){\r\n        if (lastValue !== this.value) {\r\n            lastValue = this.value;\r\n            refilterUsers();\r\n        }\r\n    });\r\n\r\n    ui.find('.uglw-filter-input').change();\r\n\r\n    ui.find('.uglw-add-icon').click(function() {\r\n        var groupSecurity = new UserGroupSecurity();\r\n\r\n        groupSecurity._save = function() {\r\n            var \r\n                // _this = this,\r\n                si = this._securityInfo.SecurityInfo;\r\n\r\n            if (this.saveCustomParams()) {\r\n                return;\r\n            }\r\n\r\n            var membersJson = si.Users.map(function(user) {\r\n                return {\r\n                    Access: user.Access,\r\n                    UserID: user.UserID\r\n                }\r\n            });\r\n\r\n            sendCrossDomainPostRequest(window.serverBase + 'User/CreateGroup', {\r\n                    WrapStyle: 'message',\r\n                    Nickname: si.Nickname,\r\n                    Description: si.Description,\r\n                    MembersJson: JSON.stringify(membersJson),\r\n                }, function(response) {\r\n                    if (!parseResponse(response)) {\r\n                        return;\r\n                    }\r\n\r\n                    $(groupSecurity._dialogDiv).dialog('close');\r\n                    refilterUsers();\r\n                }\r\n            )\r\n        }\r\n\r\n        groupSecurity.createSecurityDialog({\r\n            SecurityInfo: {\r\n                Users: []\r\n            }\r\n        }, {showOwner: false});\r\n\r\n        $(groupSecurity._dialogDiv).find('.security-props-title').focus();\r\n    });\r\n}\r\n\r\nnsGmx.UserGroupListWidget._mainTemplate = Handlebars.compile('<div>' +\r\n    '<div class=\"uglw-header\">' +\r\n        '{{i \"uglw.headerTitle\"}} <input class=\"uglw-filter-input inputStyle\">' +\r\n        '<div class=\"uglw-add-icon\" title=\"Добавить группу\"></div>' +\r\n    '</div>' +\r\n    '<div class=\"uglw-list-placeholder\"></div>' +\r\n'</div>');\r\n\r\nvar UserGroupSecurity = function()\r\n{\r\n    this.getSecurityName = \"User/GetUserGroupSecurity\";\r\n    this.updateSecurityName = \"User/UpdateUserGroupSecurity\";\r\n\r\n    this.propertyName = \"UserID\";\r\n    this.dialogTitle = \"Состав группы [value0]\";\r\n\r\n    this.accessTypes = ['no', 'view', 'edit'];\r\n}\r\n\r\nUserGroupSecurity.prototype = new nsGmx.security();\r\nUserGroupSecurity.prototype.constructor = UserGroupSecurity;\r\n\r\nUserGroupSecurity.prototype.saveCustomParams = function() {\r\n    var nicknameInput = this._ui.find('.security-props-title'),\r\n        nickname = nicknameInput.val();\r\n\r\n    if (nickname) {\r\n        this._securityInfo.SecurityInfo.Nickname = nickname;\r\n        this._securityInfo.SecurityInfo.Description = this._ui.find('.security-props-description').val();\r\n    } else {\r\n        inputError(nicknameInput[0]);\r\n        return true;\r\n    }\r\n\r\n    var publicCheckbox = this._ui.find('#publicRights')[0];\r\n\r\n    this._securityInfo.SecurityInfo.SharedResources = publicCheckbox.checked;\r\n}\r\n\r\nUserGroupSecurity.prototype.addCustomUI = function(ui, securityInfo) {\r\n    var propsTemplate = Handlebars.compile(\r\n        '<table class=\"security-props\">' +\r\n            '<tr><td>{{i \"uglw.groupProps.title\"}}:</td><td><input class=\"security-props-title inputStyle\" value=\"{{Nickname}}\"></td></tr>' +\r\n            '<tr><td>{{i \"uglw.groupProps.description\"}}:</td><td><input class=\"security-props-description inputStyle\" value=\"{{Description}}\"></td></tr>' +\r\n        '</table>' +\r\n        '<div class=\"security-policy-control\">' +\r\n            '<span class=\"security-policy-label\">{{i \"uglw.shareLabel\"}}</span>' +\r\n            '<span class=\"security-policy-radiogroup\">' +\r\n                '<input id=\"privateRights\" class=\"policy-checkbox\" type=\"radio\" name=\"groupEditingPolicy\" {{#unless SharedResources}} checked {{/unless}}/>' +\r\n                '<label class=\"security-policy-label\" for=\"privateRights\">{{i \"uglw.share.private\"}}</label>' +\r\n                '<input id=\"publicRights\" class=\"policy-checkbox\" type=\"radio\" name=\"groupEditingPolicy\" {{#if SharedResources}} checked {{/if}}/>' +\r\n                '<label class=\"security-policy-label\" for=\"publicRights\">{{i \"uglw.share.public\"}}</label>' +\r\n            '</span>' +\r\n        '</div>'\r\n    );\r\n\r\n    $(propsTemplate({\r\n        Nickname: securityInfo.Nickname,\r\n        Description: securityInfo.Description,\r\n        SharedResources: securityInfo.SharedResources\r\n    })).appendTo(ui.find('.security-custom-ui'));\r\n}\r\n\r\ngmxCore.addModule('UserGroupWidget', {\r\n        UserGroupListWidget: nsGmx.UserGroupListWidget\r\n    }\r\n    // ,{\r\n    //     css: 'css/UserGroupWidget.css'\r\n    // }\r\n);\r\n\r\n})();\r\n","import './Leaflet.Dialog.css';\r\n\r\nL.Control.Dialog = L.Control.extend({\r\n  options: {\r\n    size: [ 300, 300 ],\r\n    minSize: [ 100, 100 ],\r\n    maxSize: [ 350, 350 ],\r\n    anchor: [ 250, 250 ],\r\n    position: 'topleft',\r\n    initOpen: true\r\n  },\r\n\r\n  initialize: function (options){\r\n    L.setOptions(this, options);\r\n\r\n    this._attributions = {};\r\n  },\r\n\r\n  onAdd: function (map){\r\n\r\n    this._initLayout();\r\n    this._map = map;\r\n\r\n    this.update();\r\n\r\n    if(!this.options.initOpen){\r\n      this.close();\r\n    }\r\n\r\n    return this._container;\r\n  },\r\n\r\n  open: function(){\r\n    if(!this._map){\r\n      return;\r\n    }\r\n    this._container.style.visibility = '';\r\n\r\n    this._map.fire('dialog:opened', this);\r\n\r\n    return this;\r\n  },\r\n\r\n  close: function(){\r\n    this._container.style.visibility = 'hidden';\r\n\r\n    this._map.fire('dialog:closed', this);\r\n    return this;\r\n  },\r\n\r\n  destroy: function(){\r\n    if(!this._map){ return this; }\r\n\r\n    this.removeFrom(this._map);\r\n\r\n    if (this.onRemove) {\r\n\t\t\tthis.onRemove(this._map);\r\n\t\t}\r\n\r\n    this._map.fire('dialog:destroyed', this);\r\n    return this;\r\n  },\r\n\r\n  setLocation: function(location){\r\n    location = location || [ 250, 250 ];\r\n\r\n    this.options.anchor[0] = 0;\r\n    this.options.anchor[1] = 0;\r\n    this._oldMousePos.x = 0;\r\n    this._oldMousePos.y = 0;\r\n\r\n    this._move(location[1], location[0]);\r\n\r\n    return this;\r\n  },\r\n\r\n  setSize: function(size){\r\n    size = size || [ 300, 300 ];\r\n\r\n    this.options.size[0] = 0;\r\n    this.options.size[1] = 0;\r\n    this._oldMousePos.x = 0;\r\n    this._oldMousePos.y = 0;\r\n\r\n    this._resize(size[0], size[1]);\r\n\r\n    return this;\r\n  },\r\n\r\n  lock: function(){\r\n    this._resizerNode.style.visibility = 'hidden';\r\n    this._grabberNode.style.visibility = 'hidden';\r\n    this._closeNode.style.visibility = 'hidden';\r\n\r\n    this._map.fire('dialog:locked', this);\r\n    return this;\r\n  },\r\n\r\n  unlock: function(){\r\n    this._resizerNode.style.visibility = '';\r\n    this._grabberNode.style.visibility = '';\r\n    this._closeNode.style.visibility = '';\r\n\r\n    this._map.fire('dialog:unlocked', this);\r\n    return this;\r\n  },\r\n\r\n  freeze: function(){\r\n    this._resizerNode.style.visibility = 'hidden';\r\n    this._grabberNode.style.visibility = 'hidden';\r\n\r\n    this._map.fire('dialog:frozen', this);\r\n    return this;\r\n  },\r\n\r\n  unfreeze : function(){\r\n    this._resizerNode.style.visibility = '';\r\n    this._grabberNode.style.visibility = '';\r\n\r\n    this._map.fire('dialog:unfrozen', this);\r\n    return this;\r\n  },\r\n\r\n  setContent: function(content){\r\n    this._content = content;\r\n    this.update();\r\n    return this;\r\n  },\r\n\r\n  getContent: function(){\r\n    return this._content;\r\n  },\r\n\r\n  getElement: function(){\r\n    return this._container;\r\n  },\r\n\r\n  update: function(){\r\n    if (!this._map) { return; }\r\n\r\n    this._container.style.visibility = 'hidden';\r\n\r\n    this._updateContent();\r\n    this._updateLayout();\r\n\r\n    this._container.style.visibility = '';\r\n    this._map.fire('dialog:updated', this);\r\n\r\n  },\r\n\r\n  _initLayout: function(){\r\n    var className = 'leaflet-control-dialog',\r\n      container = this._container = L.DomUtil.create('div', className);\r\n\r\n    container.style.width = this.options.size[0] + 'px';\r\n    container.style.height = this.options.size[1] + 'px';\r\n\r\n    container.style.top = this.options.anchor[0] + 'px';\r\n    container.style.left = this.options.anchor[1] + 'px';\r\n\r\n    var stop = L.DomEvent.stopPropagation;\r\n    L.DomEvent\r\n        .on(container, 'click', stop)\r\n        .on(container, 'mousedown', stop)\r\n        .on(container, 'touchstart', stop)\r\n        .on(container, 'dblclick', stop)\r\n        .on(container, 'mousewheel', stop)\r\n        .on(container, 'contextmenu', stop)\r\n        .on(container, 'MozMousePixelScroll', stop);\r\n\r\n    var innerContainer = this._innerContainer = L.DomUtil.create('div', className + '-inner');\r\n\r\n    var grabberNode = this._grabberNode = L.DomUtil.create('div', className + '-grabber');\r\n    var grabberIcon = L.DomUtil.create('i', 'fa fa-arrows');\r\n    grabberNode.appendChild(grabberIcon);\r\n\r\n    L.DomEvent.on(grabberNode, 'mousedown', this._handleMoveStart, this);\r\n\r\n    var closeNode = this._closeNode = L.DomUtil.create('div', className + '-close');\r\n    var closeIcon = L.DomUtil.create('i', 'fa fa-times');\r\n    closeNode.appendChild(closeIcon);\r\n    L.DomEvent.on(closeNode, 'click', this._handleClose, this);\r\n\r\n    var resizerNode = this._resizerNode = L.DomUtil.create('div', className + '-resizer');\r\n    var resizeIcon = L.DomUtil.create('i', 'fa fa-arrows-h fa-rotate-45');\r\n    resizerNode.appendChild(resizeIcon);\r\n\r\n    L.DomEvent.on(resizerNode, 'mousedown', this._handleResizeStart, this);\r\n\r\n    var contentNode = this._contentNode = L.DomUtil.create('div', className + \"-contents\");\r\n\r\n    container.appendChild(innerContainer);\r\n\r\n    innerContainer.appendChild(contentNode);\r\n    innerContainer.appendChild(grabberNode);\r\n    innerContainer.appendChild(closeNode);\r\n    innerContainer.appendChild(resizerNode);\r\n\r\n    this._oldMousePos = { x: 0, y: 0 };\r\n\r\n  },\r\n\r\n  _handleClose: function(){\r\n    this.close();\r\n  },\r\n\r\n  _handleResizeStart: function(e){\r\n    this._oldMousePos.x = e.clientX;\r\n    this._oldMousePos.y = e.clientY;\r\n\r\n    L.DomEvent.on(this._map, 'mousemove', this._handleMouseMove, this);\r\n    L.DomEvent.on(this._map, 'mouseup', this._handleMouseUp, this);\r\n\r\n    this._map.fire('dialog:resizestart', this);\r\n    this._resizing = true;\r\n  },\r\n\r\n  _handleMoveStart: function(e){\r\n    this._oldMousePos.x = e.clientX;\r\n    this._oldMousePos.y = e.clientY;\r\n\r\n    L.DomEvent.on(this._map, 'mousemove', this._handleMouseMove, this);\r\n    L.DomEvent.on(this._map, 'mouseup', this._handleMouseUp, this);\r\n\r\n    this._map.fire('dialog:movestart', this);\r\n    this._moving = true;\r\n  },\r\n\r\n  _handleMouseMove: function(e){\r\n    var diffX = e.originalEvent.clientX - this._oldMousePos.x,\r\n      diffY = e.originalEvent.clientY - this._oldMousePos.y;\r\n\r\n      // this helps prevent accidental highlighting on drag:\r\n    if(e.originalEvent.stopPropagation){ e.originalEvent.stopPropagation(); }\r\n    if(e.originalEvent.preventDefault){ e.originalEvent.preventDefault(); }\r\n\r\n    if(this._resizing){\r\n      this._resize(diffX, diffY);\r\n    }\r\n\r\n    if(this._moving){\r\n      this._move(diffX, diffY);\r\n    }\r\n  },\r\n\r\n  _handleMouseUp: function(){\r\n    L.DomEvent.off(this._map, 'mousemove', this._handleMouseMove, this);\r\n    L.DomEvent.off(this._map, 'mouseup', this._handleMouseUp, this);\r\n\r\n    if(this._resizing){\r\n      this._resizing = false;\r\n      this._map.fire('dialog:resizeend', this);\r\n    }\r\n\r\n    if(this._moving){\r\n      this._moving = false;\r\n      this._map.fire('dialog:moveend', this);\r\n    }\r\n  },\r\n\r\n  _move: function(diffX, diffY){\r\n    var newY = this.options.anchor[0] + diffY;\r\n    var newX = this.options.anchor[1] + diffX;\r\n\r\n    this.options.anchor[0] = newY;\r\n    this.options.anchor[1] = newX;\r\n\r\n    this._container.style.top = this.options.anchor[0] + 'px';\r\n    this._container.style.left = this.options.anchor[1] + 'px';\r\n\r\n    this._map.fire('dialog:moving', this);\r\n\r\n    this._oldMousePos.y += diffY;\r\n    this._oldMousePos.x += diffX;\r\n  },\r\n\r\n  _resize: function(diffX, diffY){\r\n    var newX = this.options.size[0] + diffX;\r\n    var newY = this.options.size[1] + diffY;\r\n\r\n    if( newX <= this.options.maxSize[0] && newX >= this.options.minSize[0]){\r\n      this.options.size[0] = newX;\r\n      this._container.style.width = this.options.size[0] + 'px';\r\n      this._oldMousePos.x += diffX;\r\n    }\r\n\r\n    if(newY <= this.options.maxSize[1] && newY >= this.options.minSize[1] ){\r\n      this.options.size[1] = newY;\r\n      this._container.style.height = this.options.size[1] + 'px';\r\n      this._oldMousePos.y += diffY;\r\n    }\r\n\r\n    this._map.fire('dialog:resizing', this);\r\n  },\r\n\r\n  _updateContent: function(){\r\n\r\n    if(!this._content){ return; }\r\n\r\n    var node = this._contentNode;\r\n    var content = (typeof this._content === 'function') ? this._content(this) : this._content;\r\n\r\n    if(typeof content === 'string'){\r\n      node.innerHTML = content;\r\n    }\r\n    else{\r\n      while(node.hasChildNodes()){\r\n        node.removeChild(node.firstChild);\r\n      }\r\n      node.appendChild(content);\r\n    }\r\n\r\n  },\r\n\r\n  _updateLayout: function(){\r\n\r\n    this._container.style.width = this.options.size[0] + 'px';\r\n    this._container.style.height = this.options.size[1] + 'px';\r\n\r\n    this._container.style.top = this.options.anchor[0] + 'px';\r\n    this._container.style.left = this.options.anchor[1] + 'px';\r\n\r\n  }\r\n\r\n});\r\n\r\nL.control.dialog = function (options) {\r\n  return new L.Control.Dialog(options);\r\n};\r\n","﻿import '../css/scroll.css';\r\nimport '../css/print.css';\r\nimport '../css/search.css';\r\nimport '../css/menu.css';\r\nimport '../css/buttons.css';\r\nimport '../css/treeview.css';\r\nimport '../css/drawing.css';\r\nimport '../css/layerstylesmenu.css';\r\nimport '../css/swich-slider.css';\r\nimport '../css/adapter.css';\r\nimport '../css/sidebar.css';\r\nimport '../css/leafletGmx.css';\r\n\r\nimport nsGmx from './nsGmx.js';\r\n\r\nimport './lang_ru.js';\r\nimport './lang_en.js';\r\nimport {leftMenu, _menuUp} from './menu.js';\r\nimport './gmxcore.js';\r\nimport {translationsHash} from './translations.js';\r\nimport './VirtualLayerManager.js';\r\nimport './PluginsManager.js';\r\nimport {mapHelp, _mapHelper} from './mapHelper.js';\r\nimport './AuthManager.js';\r\nimport {\r\n    addParseResponseHook,\r\n    _,\r\n    _div,\r\n    createCookie,\r\n    readCookie,\r\n    eraseCookie,\r\n    getWindowHeight,\r\n    getWindowWidth,\r\n    removeDialog,\r\n    showDialog,\r\n    showErrorMessage\r\n} from './utilities.js';\r\nimport './userObjects.js';\r\nimport './HeaderWidget/HeaderWidget.js'\r\nimport './LanguageWidget/languageWidget.js';\r\nimport './GmxIconLayers/gmxIconLayers.js';\r\nimport './CommonCalendarWidget/CommonCalendarWidget.js';\r\nimport './mapLayers.js';\r\nimport './AuthWidget/AuthWidget.js';\r\nimport './AuthWidget.js';\r\nimport './version.js';\r\nimport {DrawingObjectGeomixer} from './drawingObjects.js';\r\nimport IconSidebarWidget from './IconSidebarControl/src/IconSidebarWidget.js';\r\nimport './contextMenuController.js';\r\nimport './LayersTree.js';\r\nimport './SearchLogic/SearchLogic.js';\r\nimport './SearchLogic/SearchProviders.js';\r\nimport {drawingObjects} from './queryLoadShp.js';\r\nimport {loadServerData} from './loadServerData.js';\r\nimport './HeaderLinksControl.js';\r\nimport './TransparencySliderWidget/TransparencySliderWidget.js';\r\nimport 'leaflet-ext-search/dist/main.css';\r\nimport {SearchControl} from 'leaflet-ext-search';\r\nimport './gmxLayers2/gmxLayers2.js';\r\nimport 'gmx-plugin-media';\r\nimport './EditObjectControl/EditObjectControl.js';\r\nimport _queryTabs from './queryTabs.js';\r\nimport './ProfilePlugin/ProfilePlugin.js';\r\nimport './LayerProperties.js';\r\nimport './LayerEditor.js';\r\nimport nsMapCommon from './mapCommon.js';\r\nimport './AttributeValuesProviders.js';\r\nimport {_queryLoadShp} from './queryLoadShp.js';\r\nimport './colorpicker/js/colorpicker.js';\r\nimport './GridPlugin/GridPlugin.js';\r\nimport './MapExport/MapExport.js';\r\nimport './BufferZones/BufferZones.js';\r\nimport './IndexGrid/IndexGrid.js';\r\nimport './PhotoLayer/PhotoLayer.js';\r\nimport './UserGroupWidget/UserGroupWidget.js';\r\nimport './Leaflet.Dialog/Leaflet.Dialog.js';\r\n\r\n//Тут кратко описываются разные внешние классы для системы генерации документации\r\n\r\n/** ГеоМиксер активно использует {@link http://jquery.com/|jQuery}\r\n * @namespace jQuery\r\n */\r\n\r\n/** Официальная документация: {@link http://api.jquery.com/category/deferred-object/|jQuery Deferred}\r\n * @name Deferred\r\n * @memberOf jQuery\r\n */\r\n\r\n\r\n/** Библиотека для формализации понятия модели и представления: {@link http://backbonejs.org/|Backbone}\r\n * @namespace Backbone\r\n */\r\n\r\n/** Официальная документация: {@link http://backbonejs.org/#Model| Backbone Model}\r\n * @name Model\r\n * @memberOf Backbone\r\n */\r\n\r\n\r\n/**\r\n    Основное пространство имён ГеоМиксера\r\n    @namespace\r\n*/\r\nnsGmx.widgets = nsGmx.widgets || {};\r\n\r\n// var gmxJSHost = window.gmxJSHost || '';\r\n\r\nif (!window.mapHostName && window.gmxJSHost) {\r\n    window.mapHostName = /https?:\\/\\/(.*)\\/api\\//.exec(window.gmxJSHost)[1];\r\n}\r\n\r\nvar _mapHostName; //откуда грузить API\r\nvar protocol = window.location.protocol;\r\n\r\nif (window.mapHostName) {\r\n    _mapHostName = protocol + '//' + window.mapHostName + '/api/';\r\n} else {\r\n    var curUri = L.gmxUtil.parseUri(window.location.href);\r\n    _mapHostName = protocol + '//' + curUri.host + curUri.directory;\r\n}\r\n\r\nvar _serverBase = window.serverBase || new RegExp('(.*)/[^/]*/').exec(_mapHostName)[1] + '/';\r\n\r\n// //подставляет к локальному имени файла хост (window.gmxJSHost) и, опционально, рандомное поле для сброса кэша (window.gmxDropBrowserCache)\r\n// var _getFileName = function(localName) {\r\n//     return gmxJSHost + localName + (window.gmxDropBrowserCache ? '?' + Math.random() : '');\r\n// }\r\n\r\nnsGmx.initGeoMixer = function() {\r\n\r\n    var oSearchLeftMenu = new leftMenu();\r\n    window.searchLogic = new nsGmx.SearchLogic();\r\n\r\n    //для синхронизации меню и тулбара при включении/выключении сетки координат\r\n    nsGmx.gridManager = {\r\n        state: false,\r\n        gridControl: null,\r\n        options: null,\r\n        menu: null,\r\n\r\n        setState: function(state) {\r\n            var isActive = state.isActive,\r\n                options = state.options;\r\n\r\n            if (this.state == isActive) {\r\n                return;\r\n            }\r\n\r\n            //lazy instantantion\r\n            this.gridControl = this.gridControl || new L.GmxGrid();\r\n            nsGmx.leafletMap[isActive ? 'addLayer' : 'removeLayer'](this.gridControl);\r\n            if (options) {\r\n                this.restoreOptions(options);\r\n            }\r\n            this.state = isActive;\r\n            nsGmx.leafletMap.gmxControlIconManager.get('gridTool').setActive(isActive);\r\n            _menuUp.checkItem('mapGrid', isActive);\r\n            _mapHelper.gridView = isActive; //можно удалить?\r\n\r\n            if (this.state) {\r\n                this.configureGrid();\r\n            }\r\n            else if (this.menu) {\r\n                this.menu.Unload();\r\n            }            \r\n        },\r\n\r\n        saveOptions: function() {\r\n            this.options = this.gridControl.options;\r\n        },\r\n\r\n        restoreOptions: function(options) {\r\n            this.gridControl.setUnits(options.units);\r\n            if (options.customStep) {\r\n                this.gridControl.setStep(options.customStep.x, options.customStep.y);\r\n            }\r\n            this.gridControl.setColor(options.color);\r\n            this.gridControl.setTitleFormat(options.titleFormat);\r\n        },\r\n\r\n        configureGrid: function() {\r\n            var _this = this;\r\n            window.gmxCore.loadModule('GridPlugin'\r\n            // , 'src/GridPlugin.js'\r\n            ).then(function(def) {\r\n                _this.menu = new def.ConfigureGridMenu(nsGmx.gridManager);\r\n                _this.menu.Load();\r\n            });\r\n        }\r\n    }\r\n\r\n    var createMenuNew = function() {\r\n        //формирует описание элемента меню для включения/выключения плагина\r\n        var getPluginToMenuBinding = function(pluginName, menuItemName, menuTitle) {\r\n            var plugin = nsGmx.pluginsManager.getPluginByName(pluginName);\r\n\r\n            if (!plugin) {\r\n                return null;\r\n            }\r\n\r\n            var sel = function() {\r\n                nsGmx.pluginsManager.setUsePlugin(pluginName, true);\r\n                nsGmx.pluginsManager.done(function() {\r\n                    var paramsClone = $.extend(true, {}, plugin.params);\r\n                    plugin.body.afterViewer && plugin.body.afterViewer(paramsClone, nsGmx.leafletMap);\r\n                    _mapHelper.mapPlugins.addPlugin(pluginName, plugin.params);\r\n                })\r\n            }\r\n\r\n            var unsel = function() {\r\n                nsGmx.pluginsManager.setUsePlugin(pluginName, false);\r\n                nsGmx.pluginsManager.done(function() {\r\n                    _mapHelper.mapPlugins.remove(pluginName);\r\n                    plugin.body.unload && plugin.body.unload();\r\n                })\r\n            }\r\n\r\n            return {\r\n                id: menuItemName,\r\n                title: menuTitle,\r\n                onsel: sel,\r\n                onunsel: unsel,\r\n                checked: plugin.isUsed()\r\n            }\r\n        }\r\n\r\n        var isMapEditor = _queryMapLayers.currentMapRights() === 'edit',\r\n            isLogined = nsGmx.AuthManager.isLogin();\r\n\r\n        _menuUp.submenus = [];\r\n\r\n        _menuUp.addItem({\r\n            id: 'mapsMenu',\r\n            title: _gtxt('Карта'),\r\n            childs: [].concat(\r\n                isLogined ? [{ id: 'mapList', title: _gtxt('Открыть'), func: function() { _queryMapLayers.getMaps() } }] : [], [{\r\n                        id: 'mapCreate',\r\n                        title: _gtxt('Создать'),\r\n                        func: function() {\r\n                            _queryMapLayers.createMapDialog(_gtxt('Создать карту'), _gtxt('Создать'), _queryMapLayers.createMap)\r\n                        }\r\n                    },\r\n                    { id: 'mapSave', title: _gtxt('Сохранить'), func: _queryMapLayers.saveMap },\r\n                    {\r\n                        id: 'mapSaveAs',\r\n                        title: _gtxt('Сохранить как'),\r\n                        func: function() {\r\n                            _queryMapLayers.createMapDialog(_gtxt('Сохранить карту как'), _gtxt('Сохранить'), _queryMapLayers.saveMapAs)\r\n                        },\r\n                        delimiter: true\r\n                    },\r\n                    {\r\n                        id: 'export',\r\n                        title: _gtxt('Экспорт'),\r\n                        func: function() {\r\n                            mapExportMenu();\r\n                        },\r\n                        disabled: !isLogined\r\n                    },\r\n                    { id: 'shareMenu', title: _gtxt('Поделиться'), func: function() { _mapHelper.showPermalink() } },\r\n                    // {id: 'codeMap',      title: _gtxt('Код для вставки'),   func: function(){_mapHelper.createAPIMapDialog()}, disabled: true},\r\n                    {\r\n                        id: 'mapTabsNew',\r\n                        title: _gtxt('Добавить закладку'),\r\n                        func: function() {\r\n                            mapHelp.tabs.load('mapTabs');\r\n                            _queryTabs.add();\r\n                        }\r\n                    },\r\n                    { id: 'printMap', title: _gtxt('Печать'), func: function() { _mapHelper.print() }, delimiter: true },\r\n                    {\r\n                        id: 'mapProperties',\r\n                        title: _gtxt('Свойства'),\r\n                        func: function() {\r\n                            var div = $(_layersTree._treeCanvas).find('div[MapID]')[0];\r\n                            nsGmx.createMapEditor(div);\r\n                        },\r\n                        disabled: !isMapEditor\r\n                    },\r\n                    {\r\n                        id: 'createGroup',\r\n                        title: _gtxt('Добавить подгруппу'),\r\n                        func: function() {\r\n                            var div = $(_layersTree._treeCanvas).find('div[MapID]')[0];\r\n                            nsGmx.addSubGroup(div, _layersTree);\r\n                        },\r\n                        disabled: !isMapEditor\r\n                    },\r\n                    {\r\n                        id: 'mapSecurity',\r\n                        title: _gtxt('Права доступа'),\r\n                        func: function() {\r\n                            var securityDialog = new nsGmx.mapSecurity(),\r\n                                props = _layersTree.treeModel.getMapProperties();\r\n                            securityDialog.getRights(props.MapID, props.title);\r\n                        },\r\n                        disabled: !isMapEditor\r\n                    }\r\n                ]\r\n            )\r\n        });\r\n\r\n        _menuUp.addItem({\r\n            id: 'dataMenu',\r\n            title: _gtxt('Данные'),\r\n            childs: [\r\n                { id: 'layerList', title: _gtxt('Открыть слой'), func: function() { _queryMapLayers.getLayers() }, disabled: !isMapEditor },\r\n                {\r\n                    id: 'createLayer',\r\n                    title: _gtxt('Создать слой'),\r\n                    childs: [\r\n                        { id: 'createRasterLayer', title: _gtxt('Растровый'), func: _mapHelper.createNewLayer.bind(_mapHelper, 'Raster'), disabled: !isMapEditor },\r\n                        { id: 'createVectorLayer', title: _gtxt('Векторный'), func: _mapHelper.createNewLayer.bind(_mapHelper, 'Vector'), disabled: !isMapEditor },\r\n                        { id: 'createMultiLayer', title: _gtxt('Мультислой'), func: _mapHelper.createNewLayer.bind(_mapHelper, 'Multi'), disabled: !isMapEditor },\r\n                        { id:'createVirtualLayer', title: 'Виртуальный', func: function() {\r\n\r\n                            window.gmxCore.loadModule('LayerEditor').then(function() {\r\n                                nsGmx.LayerEditor.addInitHook(function(layerEditor, layerProperties, params) {\r\n                                    if (layerProperties.get('Type') !== 'Virtual') {\r\n                                        return;\r\n                                    }\r\n\r\n                                    $(layerEditor).on('premodify', function() {\r\n                                        layerProperties.set('ContentID', ui.find('.vlayer-contentid').val());\r\n                                    });\r\n\r\n                                    var template = Handlebars.compile('<div type=\"vlayer-container\">' +\r\n                                        '<span class=\"vlayer-label\">Тип слоя</span>' +\r\n                                        '<input class=\"vlayer-contentid inputStyle\" value=\"{{ContentID}}\">' +\r\n                                    '</div>');\r\n\r\n                                    var ui = $(template({ContentID: layerProperties.get('ContentID')}));\r\n\r\n                                    params.additionalUI = params.additionalUI || {};\r\n                                    params.additionalUI.main = params.additionalUI.advanced || [];\r\n                                    params.additionalUI.main.push(ui);\r\n                                });\r\n\r\n                                var parent = _div(null, [['attr','id','newVirtualLayer'], ['css', 'height', '100%']]),\r\n                                    properties = {Title:'', Description: '', Date: ''};\r\n\r\n                                var dialogDiv = showDialog('Создать виртуальный слой', parent, 340, 340, false, false);\r\n\r\n                                nsGmx.createLayerEditor(false, 'Virtual', parent, properties, {\r\n                                    doneCallback: function() {\r\n                                        removeDialog(dialogDiv);\r\n                                    }\r\n                                });\r\n                            });\r\n\r\n                            }, disabled: !isMapEditor\r\n                        }\r\n                    ],\r\n                    disabled: !isMapEditor\r\n                },\r\n                {\r\n                    id: 'baseLayers',\r\n                    title: _gtxt('Базовые слои'),\r\n                    func: function() {\r\n                        var div = $(_layersTree._treeCanvas).find('div[MapID]')[0];\r\n                        nsGmx.createMapEditor(div, 1);\r\n                    },\r\n                    delimiter: true,\r\n                    disabled: !isMapEditor\r\n                },\r\n                { id: 'loadFile', title: _gtxt('Загрузить объекты'), func: drawingObjects.loadShp.load, delimiter: true },\r\n                { id: 'loadPhotos', title: _gtxt('Загрузить фотографии'), func: function() { PhotoLayerDialog() }, delimiter: true, disabled: !isMapEditor },\r\n                { id: 'wms', title: _gtxt('Подключить WMS'), func: loadServerData.WMS.load },\r\n                { id: 'wfs', title: _gtxt('Подключить WFS'), func: loadServerData.WFS.load }\r\n            ]\r\n        });\r\n\r\n        _menuUp.addItem({\r\n            id: 'viewMenu',\r\n            title: _gtxt('Вид'),\r\n            childs: [\r\n                { id: 'externalMaps', title: _gtxt('Дополнительные карты'), func: mapHelp.externalMaps.load },\r\n                { id: 'mapTabs', title: _gtxt('Закладки'), func: mapHelp.tabs.load },\r\n                { id: 'DrawingObjects', title: _gtxt('Объекты'), func: window.oDrawingObjectGeomixer.Load }\r\n                // {id:'searchView',     title: _gtxt('Результаты поиска'),    func: oSearchControl.Load}\r\n            ]\r\n        });\r\n\r\n        _menuUp.addItem({\r\n            id: 'instrumentsMenu',\r\n            title: _gtxt('Инструменты'),\r\n            childs: [{\r\n                    id: 'mapGrid',\r\n                    title: _gtxt('Координатная сетка'),\r\n                    onsel: nsGmx.gridManager.setState.bind(nsGmx.gridManager, { isActive: true }),\r\n                    onunsel: nsGmx.gridManager.setState.bind(nsGmx.gridManager, { isActive: false }),\r\n                    checked: _mapHelper.gridView\r\n                },\r\n                {\r\n                    id: 'mapIndexGrid',\r\n                    title: _gtxt('Индексная сетка'),\r\n                    func: function() {\r\n                        indexGridMenu();\r\n                    }\r\n                },\r\n                {\r\n                    id: 'buffer',\r\n                    title: _gtxt('Создание буферных зон'),\r\n                    func: function() {\r\n                        BufferZonesMenu();\r\n                    },\r\n                    disabled: !isLogined\r\n                },\r\n                { id: 'shift', title: _gtxt('Ручная привязка растров'), func: function() {}, disabled: true },\r\n                { id: 'crowdsourcing', title: _gtxt('Краудсорсинг данных'), func: function() {}, disabled: true },\r\n                { id: 'geocoding', title: _gtxt('Пакетный геокодинг'), func: function() {}, disabled: true },\r\n                { id: 'directions', title: _gtxt('Маршруты'), func: function() {}, disabled: true }\r\n            ]\r\n        });\r\n\r\n\r\n        function fillPluginsMenu() {\r\n            var plugins = window.menuPlugins || [];\r\n\r\n            // для локальной версии Геомиксера покажем плагины кадастра и Викимапии\r\n            if (!window.menuPlugins) {\r\n                if (nsGmx.pluginsManager.getPluginByName('Cadastre')) {\r\n                    plugins.push({ pluginName: 'Cadastre', menuItemName: 'cadastre', menuTitle: 'Кадастр Росреестра' });\r\n                }\r\n            }\r\n\r\n            if (plugins.length) {\r\n                var childs = [];\r\n                for (var p = 0; p < plugins.length; p++) {\r\n                    childs.push(\r\n                        getPluginToMenuBinding(\r\n                            plugins[p].pluginName,\r\n                            plugins[p].menuItemName,\r\n                            window._gtxt(plugins[p].menuTitle)\r\n                        )\r\n                    )\r\n                }\r\n\r\n                _menuUp.addItem({ id: 'pluginsMenu', title: _gtxt('Сервисы'), childs: childs });\r\n            }\r\n        }\r\n        fillPluginsMenu();\r\n\r\n        _menuUp.addItem({\r\n            id: 'helpMenu',\r\n            title: _gtxt('Справка'),\r\n            childs: nsGmx.gmxMap.properties.MapID !== '31RJS' ? [\r\n                { id: 'about', title: _gtxt('О проекте'), func: _mapHelper.version },\r\n            ].concat(window.mapsSite ? [{\r\n                    id: 'usage',\r\n                    title: _gtxt('Руководство пользователя'),\r\n                    func: function() {\r\n                        window.open('http://geomixer.ru/index.php/docs/', '_blank');\r\n                    }\r\n                },\r\n                {\r\n                    id: 'api',\r\n                    title: _gtxt('GeoMixer API'),\r\n                    func: function() {\r\n                        window.open('https://geomixer.ru/docs/dev-manual/rest-api/get-started/', '_blank');\r\n                    }\r\n                },\r\n                {\r\n                    id: 'pluginsUsage',\r\n                    title: _gtxt('Использование плагинов'),\r\n                    func: function() {\r\n                        window.open('http://geomixer.ru/index.php/docs/manual/plugins', '_blank');\r\n                    }\r\n                }\r\n            ] : []) : [{\r\n                    id: 'usage',\r\n                    title: _gtxt('Руководство'),\r\n                    func: function() {\r\n                        window.open(window.location.protocol + '//kosmosnimki.ru/downloads/%D1%86%D1%81%D0%BC%D1%81.pdf', '_blank');\r\n                    }\r\n                }]\r\n        });\r\n    }\r\n\r\n    var createToolbar = function() {\r\n        var lmap = nsGmx.leafletMap;\r\n\r\n        var SliderControl = L.Control.extend({\r\n            options: {\r\n                position: 'topleft'\r\n            },\r\n            onAdd: function() {\r\n                var sliderContainer = $('<div class=\"gmx-slider-control\"></div>');\r\n                this._widget = new nsGmx.TransparencySliderWidget(sliderContainer);\r\n\r\n                $(this._widget).on('slide slidechange', function(event, ui) {\r\n                    _queryMapLayers.applyOpacityToRasterLayers(ui.value * 100, _queryMapLayers.buildedTree);\r\n                })\r\n\r\n                return sliderContainer[0];\r\n            },\r\n            onRemove: function() {},\r\n            isCollapsed: function() { return this._widget.isCollapsed(); }\r\n        });\r\n        var sliderControl = new SliderControl();\r\n        lmap.addControl(sliderControl);\r\n\r\n        //пополняем тулбар\r\n        var uploadFileIcon = L.control.gmxIcon({\r\n            id: 'uploadFile',\r\n            title: _gtxt('Загрузить объекты')\r\n        }).on('click', drawingObjects.loadShp.load.bind(drawingObjects.loadShp));\r\n\r\n        lmap.gmxControlIconManager.get('drawing').addIcon(uploadFileIcon);\r\n\r\n        // выпадающие группы иконок наезжают на слайдер прозрачности.\r\n        // Эта ф-ция разруливает этот конфликт, скрывая слайдер в нужный момент\r\n        var resolveToolConflict = function(iconGroup) {\r\n            iconGroup\r\n                .on('collapse', function() {\r\n                    $('.gmx-slider-control').removeClass('invisible');\r\n                }).on('expand', function() {\r\n                    sliderControl.isCollapsed() || $('.gmx-slider-control').addClass('invisible');\r\n                });\r\n        }\r\n\r\n        if (_queryMapLayers.currentMapRights() === 'edit') {\r\n\r\n            let saveMapIcon = L.control.gmxIcon({\r\n                    id: 'saveMap',\r\n                    title: _gtxt('Сохранить карту'),\r\n                    addBefore: 'drawing'\r\n                });\r\n            saveMapIcon.addTo(lmap);\r\n            saveMapIcon.on('click', _queryMapLayers.saveMap.bind(_queryMapLayers));\r\n\r\n            //группа создания слоёв\r\n            let createVectorLayerIcon = L.control.gmxIcon({\r\n                id: 'createVectorLayer',\r\n                title: _gtxt('Создать векторный слой'),\r\n                addBefore: 'drawing'\r\n            });\r\n            createVectorLayerIcon.on('click', function() {\r\n                _mapHelper.createNewLayer('Vector');\r\n                createVectorLayerIcon.setActive(true);\r\n                createRasterLayerIcon.setActive(false);\r\n            });\r\n\r\n            var createRasterLayerIcon = L.control.gmxIcon({\r\n                id: 'createRasterLayer',\r\n                title: _gtxt('Создать растровый слой'),\r\n                addBefore: 'drawing'\r\n            });\r\n            createRasterLayerIcon.on('click', function() {\r\n                _mapHelper.createNewLayer('Raster');\r\n                createRasterLayerIcon.setActive(true);\r\n                createVectorLayerIcon.setActive(false);\r\n            });\r\n\r\n            var createLayerIconGroup = L.control.gmxIconGroup({\r\n                id: 'createLayer',\r\n                isSortable: true,\r\n                //isCollapsible: false,\r\n                items: [createVectorLayerIcon, createRasterLayerIcon],\r\n                addBefore: 'drawing'\r\n            });\r\n            createLayerIconGroup.addTo(lmap);\r\n\r\n            var bookmarkIcon = L.control.gmxIcon({\r\n                id: 'bookmark',\r\n                title: _gtxt('Добавить закладку'),\r\n                addBefore: 'drawing'\r\n            });\r\n            bookmarkIcon.on('click', function() {\r\n                mapHelp.tabs.load('mapTabs');\r\n                _queryTabs.add();\r\n            });\r\n            bookmarkIcon.addTo(lmap);\r\n\r\n            resolveToolConflict(createLayerIconGroup);\r\n        } else {\r\n            resolveToolConflict(lmap.gmxControlIconManager.get('drawing'));\r\n        }\r\n\r\n        var printIcon = L.control.gmxIcon({\r\n            id: 'gmxprint',\r\n            title: _gtxt('Печать'),\r\n            addBefore: 'drawing'\r\n        });\r\n        printIcon.addTo(lmap);\r\n        printIcon.on('click', _mapHelper.print.bind(_mapHelper));\r\n\r\n        var permalinkIcon = L.control.gmxIcon({\r\n            id: 'permalink',\r\n            title: _gtxt('Ссылка на карту'),\r\n            addBefore: 'drawing'\r\n        });\r\n        permalinkIcon.addTo(lmap);\r\n        permalinkIcon.on('click', _mapHelper.showPermalink.bind(_mapHelper));\r\n\r\n        if (window.mapsSite) {\r\n            var shareIconControl = new nsGmx.ShareIconControl({\r\n                className: 'shareIcon',\r\n                id: 'share',\r\n                text: 'Share',\r\n                style: {\r\n                    width: 'auto'\r\n                },\r\n                togglable: true,\r\n                permalinkManager: {\r\n                    save: function() {\r\n                        return $.when(\r\n                            _mapHelper.createPermalink(),\r\n                            nsMapCommon.generateWinniePermalink()\r\n                        )\r\n                    }\r\n                },\r\n                permalinkUrlTemplate: '{{href}}?permalink={{permalinkId}}',\r\n                embeddedUrlTemplate: window.location.protocol + '//winnie.kosmosnimki.ru/2.0/?config={{winnieId}}',\r\n                winnieUrlTemplate: window.location.protocol + '//winnie.kosmosnimki.ru/2.0/?config={{winnieId}}&edit=1',\r\n                previewUrlTemplate: 'iframePreview.html?width={{width}}&height={{height}}&permalinkUrl={{{embeddedUrl}}}'\r\n            });\r\n            lmap.addControl(shareIconControl);\r\n        }\r\n\r\n        var gridIcon = L.control.gmxIcon({\r\n                id: 'gridTool',\r\n                title: _gtxt('Координатная сетка'),\r\n                togglable: true,\r\n                addBefore: 'drawing'\r\n            });\r\n        gridIcon.addTo(lmap);\r\n        gridIcon.on('click', function() {\r\n            var state = { isActive: gridIcon.options.isActive };\r\n            nsGmx.gridManager.setState(state);\r\n        });\r\n\r\n        _mapHelper.customParamsManager.addProvider({\r\n            name: 'GridManager',\r\n            loadState: function(state) {\r\n                nsGmx.gridManager.setState(state);\r\n            },\r\n            saveState: function() {\r\n                return {\r\n                    version: '1.0.0',\r\n                    isActive: gridIcon.options.isActive,\r\n                    options: nsGmx.gridManager.options\r\n                }\r\n            }\r\n        });\r\n\r\n        lmap.addControl(L.control.gmxIcon({\r\n            id: 'boxzoom-dashed-rounded',\r\n            toggle: true,\r\n            addBefore: 'drawing',\r\n            title: 'Увеличение',\r\n            onAdd: function(control) {\r\n                var map = control._map,\r\n                    _onMouseDown = map.boxZoom._onMouseDown;\r\n                map.boxZoom._onMouseDown = function(e) {\r\n                    _onMouseDown.call(map.boxZoom, {\r\n                        clientX: e.clientX,\r\n                        clientY: e.clientY,\r\n                        which: 1,\r\n                        shiftKey: true\r\n                    });\r\n                };\r\n                map.on('boxzoomend', function() {\r\n                    map.dragging.enable();\r\n                    map.boxZoom.removeHooks();\r\n                    control.setActive(false);\r\n                });\r\n            },\r\n            stateChange: function(control) {\r\n                var map = control._map;\r\n                if (control.options.isActive) {\r\n                    map.dragging.disable();\r\n                    map.boxZoom.addHooks();\r\n                } else {\r\n                    map.dragging.enable();\r\n                    map.boxZoom.removeHooks();\r\n                }\r\n            }\r\n        }));\r\n\r\n        /**\r\n         * seachParams\r\n         */\r\n\r\n            var osmProvider = new nsGmx.searchProviders.Osm2DataProvider({\r\n                showOnMap: true,\r\n                serverBase: '//maps.kosmosnimki.ru',\r\n                limit: 10\r\n            });\r\n\r\n            var searchProviders = [];\r\n            searchProviders.push(osmProvider);\r\n\r\n            osmProvider.addEventListener('fetch', function (e) {\r\n                window.searchLogic.showResult(e.detail);\r\n            })\r\n\r\n        window.searchControl = new SearchControl({\r\n            id: 'searchcontrol',\r\n            placeHolder: 'Поиск по векторным слоям и адресной базе',\r\n            position: 'topright',\r\n            limit: 10,\r\n            retrieveManyOnEnter: true,\r\n            providers: searchProviders,\r\n            style: {\r\n                editable: false,\r\n                map: true,\r\n                pointStyle: {\r\n                    size: 8,\r\n                    weight: 1,\r\n                    opacity: 1,\r\n                    color: '#00008B'\r\n                },\r\n                lineStyle: {\r\n                    fill: false,\r\n                    weight: 3,\r\n                    opacity: 1,\r\n                    color: '#008B8B'\r\n                }\r\n            }\r\n        });\r\n\r\n        window.searchLogic.searchControl = window.searchControl;\r\n\r\n        lmap.addControl(window.searchControl);\r\n        lmap.gmxControlsManager.add(window.searchControl);\r\n        // shitty trick\r\n        // 'cause Aryunov doesn't use controls id\r\n        window.searchControl._container._id = 'searchcontrol';\r\n\r\n        var searchContainer = window.searchControl._widget._container;\r\n        var stop = L.DomEvent.stopPropagation;\r\n\r\n        L.DomEvent\r\n            .on(searchContainer, 'mousemove', stop)\r\n            .on(searchContainer, 'touchstart', stop)\r\n            .on(searchContainer, 'mousedown', stop)\r\n            .on(searchContainer, 'dblclick', stop)\r\n            .on(searchContainer, 'contextmenu', stop)\r\n            .on(searchContainer, 'click', stop);\r\n\r\n        var gmxLayers = new L.control.gmxLayers2(null, null, {\r\n            title: window._gtxt('Панель оверлеев'),\r\n            collapsed: true,\r\n            togglable: true,\r\n            addBefore: 'searchcontrol',\r\n            direction: '',\r\n            placeHolder: window._gtxt(\"оверлеи отсутствуют\")\r\n\r\n        });\r\n\r\n        lmap.addControl(gmxLayers);\r\n        lmap.gmxControlsManager.add(gmxLayers);\r\n    }\r\n\r\n    var createDefaultMenu = function() {\r\n        _menuUp.submenus = [];\r\n\r\n        _menuUp.addItem({\r\n            id: 'mapsMenu',\r\n            title: _gtxt('Карта'),\r\n            childs: [\r\n                { id: 'mapCreate', title: _gtxt('Создать'), func: function() { _queryMapLayers.createMapDialog(_gtxt('Создать карту'), _gtxt('Создать'), _queryMapLayers.createMap) } },\r\n                { id: 'mapList', title: _gtxt('Открыть'), func: function() { _queryMapLayers.getMaps() } }\r\n            ]\r\n        });\r\n\r\n        _menuUp.addItem({\r\n            id: 'helpMenu',\r\n            title: _gtxt('Справка'),\r\n            childs: [\r\n                { id: 'usage', title: _gtxt('Использование'), onsel: mapHelp.mapHelp.load, onunsel: mapHelp.mapHelp.unload },\r\n                { id: 'serviceHelp', title: _gtxt('Сервисы'), onsel: mapHelp.serviceHelp.load, onunsel: mapHelp.serviceHelp.unload },\r\n                { id: 'about', title: _gtxt('О проекте'), func: _mapHelper.version }\r\n            ]\r\n        });\r\n    }\r\n\r\n    var parseURLParams = function() {\r\n        var q = window.location.search,\r\n            kvp = (q.length > 1) ? q.substring(1).split('&') : [];\r\n\r\n        for (var i = 0; i < kvp.length; i++) {\r\n            kvp[i] = kvp[i].split('=');\r\n        }\r\n\r\n        var params = {},\r\n            givenMapName = false;\r\n\r\n        for (var j = 0; j < kvp.length; j++) {\r\n            if (kvp[j].length == 1) {\r\n                if (!givenMapName)\r\n                    givenMapName = decodeURIComponent(kvp[j][0]);\r\n            } else {\r\n                params[kvp[j][0]] = kvp[j][1];\r\n            }\r\n        }\r\n\r\n        return { params: params, givenMapName: givenMapName };\r\n    }\r\n\r\n    $(function() {\r\n\r\n        var virtualLayerManager = new nsGmx.VirtualLayerManager();\r\n        L.gmx.addLayerClassLoader(virtualLayerManager.loader);\r\n\r\n        $('body').on('keyup', function(event) {\r\n            if ((event.target === document.body || $(event.target).hasClass('leaflet-container')) && event.keyCode === 79) {\r\n                _queryMapLayers.getMaps();\r\n                return false;\r\n            }\r\n        })\r\n\r\n        var languageFromSettings = translationsHash.getLanguageFromCookies() || window.defaultLang;\r\n        window.language = languageFromSettings || 'rus';\r\n\r\n        window.shownTitle = window.pageTitle || _gtxt('ScanEx Web Geomixer - просмотр карты');\r\n        document.title = window.shownTitle;\r\n\r\n        window.serverBase = _serverBase;\r\n\r\n        addParseResponseHook('*', function(response) {\r\n            if (response.Warning) {\r\n                //мы дожидаемся загрузки дерева слоёв, чтобы не добавлять notification widget слишком рано (до инициализации карты в контейнере)\r\n                _queryMapLayers.loadDeferred.then(function() {\r\n                    nsGmx.widgets.notifications.stopAction(null, 'warning', response.Warning, 0);\r\n                });\r\n            }\r\n        })\r\n\r\n        var customErrorTemplate = Handlebars.compile('<div class=\"CustomErrorText\">{{description}}</div>'),\r\n            commonErrorTemplate = Handlebars.compile(\r\n                '<div class=\"CommonErrorText\"><table class=\"CommonErrorTable\">' +\r\n                '<tr><td>{{message}}</td></tr>' +\r\n                '<tr class=\"StacktraceContainer\"><td class=\"StacktraceContainer\">{{#if stacktrace}}<textarea class=\"inputStyle error StacktraceErrorText\">{{stacktrace}}</textarea>{{/if}}</td></tr>' +\r\n                '</table></div>'\r\n            );\r\n\r\n        //при каждой ошибке от сервера будем показывать диалог с ошибкой и стектрейсом.\r\n        addParseResponseHook('error', function(response, customErrorDescriptions) {\r\n            let errInfo = response.ErrorInfo;\r\n\r\n            if (errInfo.ErrorMessage && !(errInfo.ErrorMessage in _mapHelper.customErrorsHash)) {\r\n                if (customErrorDescriptions && errInfo.ExceptionType in customErrorDescriptions) {\r\n                    let canvas = $(customErrorTemplate({\r\n                        description: customErrorDescriptions[errInfo.ExceptionType]\r\n                    }));\r\n                    showDialog(_gtxt('Ошибка!'), canvas[0], 220, 100);\r\n                } else {\r\n                    let stackTrace = response.ErrorInfo.ExceptionType && response.ErrorInfo.StackTrace;\r\n                    let canvas = $(commonErrorTemplate({\r\n                        message: errInfo.ErrorMessage,\r\n                        stacktrace: stackTrace\r\n                    }));\r\n                    showDialog(_gtxt('Ошибка сервера'), canvas[0], 220, 170, false, false);\r\n                    return false;\r\n                }\r\n            }\r\n        })\r\n\r\n        _translationsHash.addErrorHandler(function(text) {\r\n            showErrorMessage('Не найдено тектовое описание для \"' + text + '\"');\r\n        })\r\n\r\n        nsGmx.pluginsManager = new(window.gmxCore.getModule('PluginsManager').PluginsManager)();\r\n\r\n        //будем сохранять в пермалинке все активные плагины\r\n        _mapHelper.customParamsManager.addProvider({\r\n            name: 'PluginManager',\r\n            loadState: function(state) {\r\n                for (var p in state.usage) {\r\n                    var plugin = nsGmx.pluginsManager.getPluginByName(p);\r\n\r\n                    plugin && plugin.setUsage(state.usage[p] ? 'used' : 'notused');\r\n                }\r\n            },\r\n            saveState: function() {\r\n                var usage = {};\r\n                nsGmx.pluginsManager.forEachPlugin(function(plugin) {\r\n                    if (plugin.pluginName) {\r\n                        usage[plugin.pluginName] = plugin.isUsed();\r\n                    }\r\n                })\r\n\r\n                return {\r\n                    version: '1.0.0',\r\n                    usage: usage\r\n                }\r\n            }\r\n        });\r\n\r\n        //сейчас подгружаются все глобальные плагины + все плагины карт, у которых нет имени в конфиге\r\n        nsGmx.pluginsManager.done(function() {\r\n            nsGmx.AuthManager.checkUserInfo(function() {\r\n                nsGmx.pluginsManager.beforeMap();\r\n\r\n                var parsedURL = parseURLParams();\r\n\r\n                parseReferences(parsedURL.params, parsedURL.givenMapName);\r\n\r\n            }, function() {\r\n                //TODO: обработка ошибок\r\n            })\r\n        })\r\n    });\r\n\r\n    function parseReferences(params, givenMapName) {\r\n        window.documentHref = window.location.href.split('?')[0];\r\n\r\n        if (params['permalink']) {\r\n            eraseCookie('TinyReference');\r\n            createCookie('TinyReference', params['permalink']);\r\n\r\n            if (location.search.indexOf('debug=1') === -1) {\r\n                window.location.replace(window.documentHref + (givenMapName ? ('?' + givenMapName) : ''));\r\n            } else {\r\n                var tinyRef = readCookie('TinyReference');\r\n                _mapHelper.restoreTinyReference(tinyRef, function(obj) {\r\n                    if (obj.mapName) {\r\n                        window.globalMapName = obj.mapName;\r\n                    }\r\n                    loadMap(obj);\r\n                });\r\n            }\r\n            return;\r\n        }\r\n\r\n        var defaultState = { isFullScreen: params['fullscreen'] == 'true' || params['fullscreen'] == 'false' ? params['fullscreen'] : 'false' };\r\n\r\n        if ('x' in params && 'y' in params && 'z' in params &&\r\n            !isNaN(Number(params.x)) && !isNaN(Number(params.y)) && !isNaN(Number(params.z)))\r\n            defaultState.position = { x: Number(params.x), y: Number(params.y), z: Number(params.z) }\r\n\r\n        if ('mx' in params && 'my' in params &&\r\n            !isNaN(Number(params.mx)) && !isNaN(Number(params.my)))\r\n            defaultState.marker = { mx: Number(params.mx), my: Number(params.my), mt: 'mt' in params ? params.mt : false }\r\n\r\n        if ('mode' in params)\r\n            defaultState.mode = params.mode;\r\n\r\n        if ('dt' in params) {\r\n            defaultState.dt = params.dt;\r\n        }\r\n\r\n        window.defaultMapID = typeof window.defaultMapID !== 'undefined' ? window.defaultMapID : 'DefaultMap';\r\n\r\n        var mapName = window.defaultMapID && !givenMapName ? window.defaultMapID : givenMapName;\r\n\r\n        window.globalMapName = mapName;\r\n\r\n        if (!window.globalMapName) {\r\n            // нужно прописать дефолтную карту в конфиге\r\n            alert(_gtxt('$$phrase$$_1'))\r\n\r\n            return;\r\n        } else {\r\n            checkUserInfo(defaultState);\r\n        }\r\n    }\r\n\r\n    function checkUserInfo(defaultState) {\r\n        var tinyRef = readCookie('TinyReference');\r\n\r\n        if (tinyRef) {\r\n            eraseCookie('TinyReference');\r\n            _mapHelper.restoreTinyReference(tinyRef, function(obj) {\r\n                if (obj.mapName) {\r\n                    window.globalMapName = obj.mapName;\r\n                }\r\n                loadMap(obj);\r\n            }, function() {\r\n                loadMap(defaultState); //если пермалинк какой-то не такой, просто открываем дефолтное состояние\r\n            });\r\n\r\n            var tempPermalink = readCookie('TempPermalink');\r\n\r\n            if (tempPermalink && tempPermalink == tinyRef) {\r\n                nsGmx.Utils.TinyReference.remove(tempPermalink);\r\n                eraseCookie('TempPermalink');\r\n            }\r\n        } else {\r\n            loadMap(defaultState);\r\n        }\r\n    }\r\n\r\n\r\n    window.layersShown = true;\r\n\r\n    window.resizeAll = function() {\r\n        if (window.printMode) {\r\n            return;\r\n        }\r\n\r\n        var top = 0,\r\n            bottom = 0,\r\n            right = 0,\r\n            left,\r\n            headerHeight = $('#header').outerHeight(),\r\n            mainDiv = $('#flash')[0];\r\n\r\n        if (window.exportMode) {\r\n            left = 0;\r\n        }\r\n        else if (window.iconSidebarWidget)  {\r\n            left = window.iconSidebarWidget.getWidth();\r\n        }\r\n        else {\r\n            left = window.layersShown ? 400 : 40;\r\n        }\r\n        \r\n        mainDiv.style.left = left + 'px';\r\n        mainDiv.style.top = top + 'px';\r\n        mainDiv.style.width = getWindowWidth() - left - right + 'px';\r\n        mainDiv.style.height = getWindowHeight() - top - headerHeight - bottom + 'px';\r\n\r\n        nsGmx.leafletMap && nsGmx.leafletMap.invalidateSize();\r\n\r\n        if (window.layersShown) {\r\n            $('#leftMenu').show();\r\n\r\n            var mapNameHeight = $('.mainmap-title').outerHeight();\r\n\r\n            var baseHeight = getWindowHeight() - top - bottom - headerHeight;\r\n\r\n            $('#leftMenu')[0].style.height = baseHeight + 'px';\r\n\r\n            var leftContentContainer = $('#leftContent')[0];\r\n            if (leftContentContainer) {\r\n                leftContentContainer.style.top = ($('#leftPanelHeader')[0].offsetHeight + mapNameHeight) + 'px';\r\n                leftContentContainer.style.height = baseHeight -\r\n                    $('#leftPanelHeader')[0].offsetHeight -\r\n                    $('#leftPanelFooter')[0].offsetHeight -\r\n                    mapNameHeight + 'px';\r\n            }\r\n        } else {\r\n            $('#leftMenu').hide();\r\n        }\r\n    }\r\n\r\n    var editUIInited = false;\r\n    var initEditUI = function() {\r\n        if (editUIInited) {\r\n            return;\r\n        }\r\n\r\n        var isEditableLayer = function(layer) {\r\n            var props = layer.getGmxProperties(),\r\n                layerRights = _queryMapLayers.layerRights(props.name);\r\n\r\n            return props.type === 'Vector' &&\r\n                (layerRights === 'edit' || layerRights === 'editrows');\r\n        }\r\n\r\n        var hasEditableLayer = false;\r\n        for (var iL = 0; iL < nsGmx.gmxMap.layers.length; iL++)\r\n            if (isEditableLayer(nsGmx.gmxMap.layers[iL])) {\r\n                hasEditableLayer = true;\r\n                break;\r\n            }\r\n\r\n        if (!hasEditableLayer) return;\r\n\r\n        //добавляем пункт меню к нарисованным объектам\r\n        nsGmx.ContextMenuController.addContextMenuElem({\r\n            title: _gtxt('EditObject.drawingMenuTitle'),\r\n            isVisible: function() {\r\n                var active = $(_queryMapLayers.treeCanvas).find('.active');\r\n\r\n                //должен быть векторный слой\r\n                if (!active[0] || !active[0].parentNode.getAttribute('LayerID') ||\r\n                    !active[0].parentNode.gmxProperties.content.properties.type === 'Vector') {\r\n                    return false;\r\n                }\r\n\r\n                //TODO: проверить тип геометрии\r\n\r\n                var layer = nsGmx.gmxMap.layersByID[active[0].parentNode.gmxProperties.content.properties.name];\r\n\r\n                //слой поддерживает редактирование и у нас есть права на это\r\n                return isEditableLayer(layer);\r\n            },\r\n            clickCallback: function(context) {\r\n                var active = $(_queryMapLayers.treeCanvas).find('.active');\r\n                var layerName = active[0].parentNode.gmxProperties.content.properties.name;\r\n                new nsGmx.EditObjectControl(layerName, null, { drawingObject: context.obj });\r\n            }\r\n        }, 'DrawingObject');\r\n\r\n        //добавляем пункт меню ко всем слоям\r\n        nsGmx.ContextMenuController.addContextMenuElem({\r\n            title: _gtxt('EditObject.menuTitle'),\r\n            isVisible: function(context) {\r\n                var layer = nsGmx.gmxMap.layersByID[context.elem.name];\r\n                return !context.layerManagerFlag && isEditableLayer(layer);\r\n            },\r\n            clickCallback: function(context) {\r\n                new nsGmx.EditObjectControl(context.elem.name);\r\n            }\r\n        }, 'Layer');\r\n\r\n        //добавляем тул в тублар карты\r\n        var listeners = {};\r\n        // var pluginPath = window.gmxCore.getModulePath('EditObjectPlugin');\r\n\r\n        var editIcon = L.control.gmxIcon({\r\n            id: 'editTool',\r\n            title: _gtxt('Редактировать'),\r\n            togglable: true,\r\n            addBefore: 'gmxprint'\r\n        }).addTo(nsGmx.leafletMap);\r\n\r\n        editIcon.on('statechange', function() {\r\n            if (editIcon.options.isActive) {\r\n\r\n                var clickHandler = function(event) {\r\n                    let layer = event.target,\r\n                        props = layer.getGmxProperties(),\r\n                        id = event.gmx.properties[props.identityField];\r\n\r\n                    layer.bringToTopItem(id);\r\n                    new nsGmx.EditObjectControl(props.name, id, { event: event });\r\n                    return true; // TODO: как oтключить дальнейшую обработку события\r\n                }\r\n\r\n                for (let iL = 0; iL < nsGmx.gmxMap.layers.length; iL++) {\r\n                    let layer = nsGmx.gmxMap.layers[iL],\r\n                        props = layer.getGmxProperties();\r\n\r\n                    if (layer.disableFlip && layer.disablePopup) {\r\n                        layer.disableFlip();\r\n                        layer.disablePopup();\r\n                    }\r\n\r\n                    listeners[props.name] = clickHandler.bind(null); //bind чтобы были разные ф-ции\r\n                    if (layer instanceof L.gmx.VectorLayer) {\r\n                        layer.on('click', listeners[props.name]);\r\n                    }\r\n                }\r\n            } else {\r\n                for (let layerName in listeners) {\r\n                    // let pt = listeners[layerName];\r\n                    let layer = nsGmx.gmxMap.layersByID[layerName];\r\n                    if (layer && layer instanceof L.gmx.VectorLayer) {\r\n                        layer.off('click', listeners[layerName]);\r\n                        if (layer.getGmxProperties().type !== 'Virtual') {\r\n                            layer.enableFlip();\r\n                            layer.enablePopup();\r\n                        }\r\n                    }\r\n                }\r\n                listeners = {};\r\n            }\r\n        });\r\n\r\n        editUIInited = true;\r\n    }\r\n\r\n    function initAuthWidget() {\r\n        var registrationCallback = function() {\r\n            window.gmxCore.loadModule('ProfilePlugin').then(function(AccountModule) {\r\n                AccountModule.showRegistrationForm(function() {\r\n                    window.location.reload();\r\n                });\r\n            })\r\n        };\r\n\r\n        var nativeAuthWidget = new nsGmx.GeoMixerAuthWidget($('<div/>')[0], nsGmx.AuthManager, function() {\r\n            _mapHelper.reloadMap();\r\n        }, { registrationCallback: registrationCallback });\r\n\r\n        // прокси между nsGmx.AuthManager редактора и AuthManager'а из общей библиотеки\r\n        var authManagerProxy = {\r\n            getUserInfo: function() {\r\n                var def = $.Deferred();\r\n                nsGmx.AuthManager.checkUserInfo(function() {\r\n                    var auth = nsGmx.AuthManager;\r\n                    def.resolve({\r\n                        Status: 'ok',\r\n                        Result: {\r\n                            Login: auth.getLogin(),\r\n                            Nickname: auth.getNickname(),\r\n                            FullName: auth.getFullname()\r\n                        }\r\n                    });\r\n                })\r\n                return def;\r\n            },\r\n\r\n            login: function() {\r\n                nativeAuthWidget.showLoginDialog();\r\n            },\r\n\r\n            logout: function() {\r\n                var def = $.Deferred();\r\n                nsGmx.AuthManager.logout(function() {\r\n                    def.resolve({ Status: 'ok', Result: {} });\r\n                    _mapHelper.reloadMap();\r\n                });\r\n                return def;\r\n            },\r\n            getNative: function() {\r\n                return nativeAuthWidget;\r\n            }\r\n        };\r\n\r\n        nsGmx.widgets.authWidget = new nsGmx.AuthWidget({\r\n            authManager: authManagerProxy,\r\n            showAccountLink: !!window.mapsSite,\r\n            accountLink: null,\r\n            showMapLink: !!window.mapsSite,\r\n            changePassword: !window.mapsSite,\r\n            isAdmin: nsGmx.AuthManager.isRole(nsGmx.ROLE_ADMIN),\r\n            callbacks: {\r\n                'authWidget-usergroupMenuItem': showUserList\r\n            }\r\n        });\r\n\r\n        var authPlaceholder = nsGmx.widgets.header.getAuthPlaceholder();\r\n        nsGmx.widgets.authWidget.appendTo(authPlaceholder);\r\n\r\n        authPlaceholder.on('click', '#AuthWidgetAccountLink', function() {\r\n            window.gmxCore.loadModule('ProfilePlugin').then(function(AccountModule) {\r\n                AccountModule.showProfile();\r\n            })\r\n        });\r\n\r\n        //ugly hack\r\n        nsGmx.widgets.authWidget.showLoginDialog = nativeAuthWidget.showLoginDialog.bind(nativeAuthWidget);\r\n    }\r\n\r\n\r\n    function loadMap(state) {\r\n        //при переходе на новое API мы изменили место хранения мапплетов карты\r\n        //раньше мапплеты хранились в свойстве onLoad карты\r\n        //теперь - внутри клиентских данных (UserData)\r\n\r\n        nsGmx.mappletLoader = {\r\n            _script: '',\r\n\r\n            //UserObjectsManager interface\r\n            collect: function() {\r\n                return this._script;\r\n            },\r\n            load: function(data) {\r\n                this._script = data;\r\n            },\r\n\r\n            //self public interface\r\n            execute: function() {\r\n                // if (this._script) {\r\n                //     var evalStr = '(' + this._script + ')';\r\n                //     try {\r\n                //         eval(evalStr)();\r\n                //     } catch (e) {\r\n                //         console.error(e);\r\n                //     }\r\n                // }\r\n            },\r\n            get: function() {\r\n                return this._script;\r\n            },\r\n            set: function(data) {\r\n                this._script = data;\r\n            }\r\n        }\r\n        nsGmx.userObjectsManager.addDataCollector('mapplet_v2', nsGmx.mappletLoader);\r\n\r\n        window.layersShown = (state.isFullScreen == 'false');\r\n\r\n        if (state.language) {\r\n            window.language = state.language;\r\n            translationsHash.updateLanguageCookies(window.language);\r\n        }\r\n\r\n        window.onresize = window.resizeAll;\r\n        window.resizeAll();\r\n\r\n        L.Icon.Default.imagePath = (window.gmxJSHost || '') + 'img';\r\n        var iconUrl = L.Icon.Default.imagePath + '/flag_blau1.png';\r\n\r\n        if (L.version !== '0.7.7') {\r\n            L.Icon.Default = L.Icon.Default.extend({\r\n                _getIconUrl: function (name) {\r\n                    return L.Icon.prototype._getIconUrl.call(this, name);\r\n                }\r\n            });\r\n        }\r\n\r\n        L.Marker = L.Marker.extend({\r\n            options: {\r\n                icon: new L.Icon.Default({\r\n                    iconUrl: iconUrl,\r\n                    iconSize: [36, 41],\r\n                    iconAnchor: [7, 37],\r\n                    popupAnchor: [3, -25],\r\n                    shadowUrl: iconUrl,\r\n                    shadowSize: [0, 0],\r\n                    shadowAnchor: [0, 0],\r\n                    iconRetinaUrl: L.Icon.Default.imagePath + '/marker-icon.png'\r\n                })\r\n            }\r\n        });\r\n\r\n        L.marker = function (latlng, options) {\r\n            return new L.Marker(latlng, options);\r\n        }\r\n\r\n        var hostName = L.gmxUtil.normalizeHostname(window.serverBase),\r\n            apiKey = window.mapsSite ? window.apiKey : null; //передаём apiKey только если не локальная версия ГеоМиксера\r\n\r\n        //мы явно получаем описание карты, но пока что не начинаем создание слоёв\r\n        //это нужно, чтобы получить список плагинов и загрузить их до того, как начнутся создаваться слои\r\n        var skipTiles = (window.mapOptions ? window.mapOptions.skipTiles : '') || window.gmxSkipTiles || '';\r\n        var srs = window.mapOptions ? window.mapOptions.srs : '';\r\n\r\n        if (!srs) { var arr = location.href.match(/[?&][cs]rs=(\\d+)/); if (arr) { srs = arr[1]; } }\r\n\r\n        var isGeneralized = window.mapOptions && 'isGeneralized' in window.mapOptions ? window.mapOptions.isGeneralized : true;    \r\n\r\n        L.gmx.gmxMapManager.loadMapProperties({\r\n            srs: srs,\r\n            serverHost: hostName,\r\n            apiKey: apiKey,\r\n            mapName: window.globalMapName,\r\n            skipTiles: skipTiles,\r\n            isGeneralized: isGeneralized\r\n        }).then(function(mapInfo) {\r\n            var userObjects = state.userObjects || (mapInfo && mapInfo.properties.UserData);\r\n            userObjects && nsGmx.userObjectsManager.setData(JSON.parse(userObjects));\r\n\r\n            //в самом начале загружаем только данные о плагинах карты.\r\n            //Остальные данные будем загружать чуть позже после частичной инициализации вьюера\r\n            //О да, формат хранения данных о плагинах часто менялся!\r\n            //Поддерживаются все предыдущие форматы из-за старых версий клиента и сложности обновления базы данных\r\n            nsGmx.userObjectsManager.load('mapPlugins');\r\n            nsGmx.userObjectsManager.load('mapPlugins_v2');\r\n            nsGmx.userObjectsManager.load('mapPlugins_v3');\r\n\r\n            //вызываем сразу после загрузки списка плагинов ГеоМиксера,\r\n            //так как в state может содержаться информация о включённых плагинах\r\n            if (state.customParamsCollection) {\r\n                _mapHelper.customParamsManager.loadParams(state.customParamsCollection);\r\n            }\r\n\r\n            //после загрузки списка плагинов карты начали загружаться не глобальные плагины,\r\n            //у которых имя плагина было прописано в конфиге. Ждём их загрузки.\r\n            nsGmx.pluginsManager.done(function() {\r\n                nsGmx.pluginsManager.preloadMap();\r\n                L.gmx.loadMap(window.globalMapName, {\r\n                    srs: srs,\r\n                    skipTiles: skipTiles,\r\n                    hostName: window.serverBase,\r\n                    apiKey: apiKey,\r\n                    setZIndex: true,\r\n                    isGeneralized: isGeneralized\r\n                }).then(processGmxMap.bind(null, state));\r\n            })\r\n        }, function(resp) {\r\n            initHeader();\r\n            initAuthWidget();\r\n\r\n            _menuUp.defaultHash = 'usage';\r\n\r\n            _menuUp.createMenu = function() {\r\n                createDefaultMenu();\r\n                nsGmx.pluginsManager.addMenuItems(_menuUp);\r\n            };\r\n\r\n            _menuUp.go(nsGmx.widgets.header.getMenuPlaceholder()[0]);\r\n\r\n            $('#left_usage').hide();\r\n\r\n            _menuUp.checkView();\r\n\r\n            var str = resp && resp.ErrorInfo && resp.ErrorInfo.ErrorMessage ? resp.ErrorInfo.ErrorMessage : 'У вас нет прав на просмотр данной карты';\r\n            nsGmx.widgets.notifications.stopAction(null, 'failure', _gtxt(str) || str, 0);\r\n\r\n            window.onresize = window.resizeAll;\r\n            window.resizeAll();\r\n\r\n            state.originalReference && createCookie('TinyReference', state.originalReference);\r\n\r\n            nsGmx.widgets.authWidget.showLoginDialog();\r\n        });\r\n    }\r\n\r\n    //создаём подложки в BaseLayerManager по описанию из config.js\r\n    function initDefaultBaseLayers() {\r\n\r\n        var lang = L.gmxLocale.getLanguage(),\r\n            iconPrefix = 'img/baseLayers/',\r\n            blm = nsGmx.leafletMap.gmxBaseLayersManager,\r\n            zIndexOffset = 2000000,\r\n            defaultMapID = window.baseMap.defaultMapID,\r\n            promises = [],\r\n            defaultHostName;\r\n\r\n        if (window.baseMap.defaultHostName) {\r\n            defaultHostName = window.baseMap.defaultHostName === '/' ? _serverBase : window.baseMap.defaultHostName;\r\n        } else {\r\n            defaultHostName = 'maps.kosmosnimki.ru';\r\n        }\r\n\r\n        if (window.baseMap.baseLayers) {\r\n            let baseLayers = window.baseMap.baseLayers,\r\n                bl;\r\n\r\n            // проставляем дефолтным слоям свойства, зависящие от путей, языка, zIndex\r\n            for (let i = 0; i < baseLayers.length; i++) {\r\n                bl = baseLayers[i];\r\n                // у Спутника в конфиге нет иконки и копирайта\r\n                if (bl.id === 'sputnik') {\r\n                    bl.icon = iconPrefix + 'basemap_sputnik_ru.png';\r\n                    bl.layers[0].attribution = '<a href=\"http://maps.sputnik.ru\">Спутник</a> © ' + (lang === 'rus' ? 'Ростелеком' : 'Rostelecom') + ' | © <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>';\r\n                }\r\n                // у ОСМ в конфиге нет иконки и урл\r\n                if (bl.id === 'OSM') {\r\n                    bl.icon = iconPrefix + 'basemap_osm_' + (lang === 'rus' ? 'ru' : 'eng') + '.png';\r\n                    bl.layers[0].urlTemplate = 'http://{s}.tile.osm.kosmosnimki.ru/kosmo' + (lang === 'rus' ? '' : '-en') + '/{z}/{x}/{y}.png';\r\n                }\r\n                // у гибрида в конфиге нет урл\r\n                if (bl.id === 'OSMHybrid') {\r\n                    bl.layers[0].urlTemplate = 'http://{s}.tile.osm.kosmosnimki.ru/kosmohyb' + (lang === 'rus' ? '' : '-en') + '/{z}/{x}/{y}.png';\r\n                    // bl.layers[0].setZIndex(zIndexOffset);\r\n                }\r\n                // у спутника нет иконки\r\n                if (bl.id === 'satellite') {\r\n                    bl.icon = iconPrefix + 'basemap_satellite.png';\r\n                }\r\n            }\r\n\r\n            for (let i = 0; i < baseLayers.length; i++) {\r\n                let bl = baseLayers[i];\r\n                if (bl.layers && bl.layers.length) {\r\n                    let l = bl.layers;\r\n                    for (let j = 0; j < l.length; j++) {\r\n                        if (l[j].urlTemplate) {\r\n                            // заменяем в подложках с айди описания слоев на L.tileLayers\r\n                            l[j] = L.tileLayer(l[j].urlTemplate, l[j]);\r\n                        } else {\r\n                            // let currentTl = bl,\r\n                            let layerID = l[j].layerID,\r\n                                hostName = l[j].hostName || defaultHostName,\r\n                                mapID = l[j].mapID || defaultMapID,\r\n                                skipTiles = (window.mapOptions ? window.mapOptions.skipTiles : '') || window.gmxSkipTiles || '',\r\n                                srs = window.mapOptions ? window.mapOptions.srs : '',\r\n                                isGeneralized = window.mapOptions && 'isGeneralized' in window.mapOptions ? window.mapOptions.isGeneralized : true;\r\n\r\n                            if (!srs) { let arr = location.href.match(/[?&][cs]rs=(\\d+)/); if (arr) { srs = arr[1]; } }\r\n                            // resolve promise -> заменяем в подложках с айди описания слоев на gmxLayers\r\n                            var promise = L.gmx.loadLayer(mapID, layerID, {\r\n                                hostName: hostName,\r\n                                srs: srs,\r\n                                isGeneralized: isGeneralized,\r\n                                skipTiles: skipTiles\r\n                            }).then(function(layer) {\r\n                                var id = layer.getGmxProperties().name;\r\n                                for (let k = 0; k < baseLayers.length; k++) {\r\n                                    let bl = baseLayers[k];\r\n\r\n                                    if (bl.layers && bl.layers.length) {\r\n                                        var l = bl.layers;\r\n\r\n                                        for (var m = 0; m < l.length; m++) {\r\n                                            if (l[m].layerID && l[m].layerID === id) {\r\n                                                l[m] = layer;\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            });\r\n\r\n                            promises.push(promise);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return L.gmx.Deferred.all.apply(null, promises).then(function() {\r\n            if (window.baseMap.baseLayers) {\r\n                var layers = window.baseMap.baseLayers,\r\n                    layersToLoad = {};\r\n\r\n                layers.forEach(function(bl) {\r\n                    layersToLoad[bl.id] = bl;\r\n                });\r\n\r\n                // добавим в гибрид снимок\r\n                if (layersToLoad.satellite && layersToLoad.OSMHybrid) {\r\n                    layersToLoad.OSMHybrid.layers[0].setZIndex(zIndexOffset);\r\n                    layersToLoad.OSMHybrid.layers.push(layersToLoad.satellite.layers[0]);\r\n                }\r\n\r\n                _.each(layersToLoad, function(l, name) {\r\n                    blm.add(name, l);\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    function showUserList() {\r\n        window.gmxCore.loadModule('UserGroupWidget').then(function(module) {\r\n            var canvas = $('<div/>');\r\n            new module.UserGroupListWidget(canvas);\r\n            canvas.dialog({\r\n                width: 400,\r\n                height: 400,\r\n                title: _gtxt('Управление группами пользователей')\r\n            });\r\n        });\r\n    }\r\n\r\n    // Инициализации шапки. Будем оттягивать с инициализацией до последнего момента, так как при инициализации\r\n    // требуется знать текущий язык, а он становится известен только после загрузки карты\r\n    function initHeader() {\r\n        // var rightLinks = [];\r\n\r\n        nsGmx.widgets.header = new nsGmx.HeaderWidget({\r\n            logo: (window.gmxViewerUI && window.gmxViewerUI.logoImage) || 'img/geomixer_transpar_small.svg'\r\n        });\r\n\r\n        nsGmx.widgets.header.appendTo($('.header'));\r\n    }\r\n\r\n    function processGmxMap(state, gmxMap) {\r\n        var DEFAULT_VECTOR_LAYER_ZINDEXOFFSET = 2000000;\r\n        var defCenter = [55.7574, 37.5952],\r\n            mapProps = gmxMap.properties,\r\n            defZoom = mapProps.DefaultZoom || 5,\r\n            data = gmxMap.rawTree;\r\n\r\n        if (mapProps.DefaultLat && mapProps.DefaultLong) {\r\n            defCenter = [mapProps.DefaultLat, mapProps.DefaultLong];\r\n        } else {\r\n            //подсчитаем общий extend всех видимых слоёв\r\n            var visBounds = L.latLngBounds([]);\r\n\r\n            for (var l = 0; l < gmxMap.layers.length; l++) {\r\n                var layer = gmxMap.layers[l];\r\n\r\n                if (layer.getGmxProperties().visible && layer.getBounds) {\r\n                    visBounds.extend(layer.getBounds());\r\n                }\r\n            }\r\n\r\n            if (visBounds.isValid()) {\r\n                //вычислям центр и максимальный zoom по bounds (map.fitBounds() использовать не можем, так как ещё нет карты)\r\n                var proj = L.Projection.Mercator;\r\n                var mercBounds = L.bounds([proj.project(visBounds.getNorthWest()), proj.project(visBounds.getSouthEast())]);\r\n                var ws = 2 * proj.project(L.latLng(0, 180)).x,\r\n                    screenSize = [$('#flash').width(), $('#flash').height()];\r\n\r\n                var zoomX = Math.log(ws * screenSize[0] / (mercBounds.max.x - mercBounds.min.x)) / Math.log(2) - 8;\r\n                var zoomY = Math.log(ws * screenSize[1] / (mercBounds.max.y - mercBounds.min.y)) / Math.log(2) - 8;\r\n\r\n                defZoom = Math.floor(Math.min(zoomX, zoomY, 17));\r\n                defCenter = proj.unproject(mercBounds.getCenter());\r\n            }\r\n        }\r\n\r\n        //если информации о языке нет ни в куках ни в config.js, то используем данные о языке из карты\r\n        if (!translationsHash.getLanguageFromCookies() && !window.defaultLang && data) {\r\n            window.language = data.properties.DefaultLanguage;\r\n        }\r\n\r\n        initHeader();\r\n\r\n        if (!window.gmxViewerUI || !window.gmxViewerUI.hideLanguage) {\r\n            var langContainer = nsGmx.widgets.header.getLanguagePlaceholder();\r\n            nsGmx.widgets.languageWidget = new nsGmx.LanguageWidget();\r\n            nsGmx.widgets.languageWidget.appendTo(langContainer);\r\n        }\r\n        var mapOptions = L.extend(window.mapOptions ? window.mapOptions : {}, {\r\n            contextmenu: true,\r\n            // если есть пермалинк, центрируем и зумируем карту сразу по его параметрам\r\n            center: state.position ? [state.position.y, state.position.x] : defCenter,\r\n            zoom: state.position ? state.position.z : defZoom,\r\n            // boxZoom: false,\r\n            zoomControl: false,\r\n            attributionControl: false,\r\n            trackResize: true,\r\n            fadeAnimation: !window.gmxPhantom, // отключение fadeAnimation при запуске тестов\r\n            zoomAnimation: !window.gmxPhantom, // отключение zoomAnimation при запуске тестов\r\n            distanceUnit: mapProps.DistanceUnit,\r\n            squareUnit: mapProps.SquareUnit,\r\n            minZoom: mapProps.MinZoom || undefined,\r\n            maxZoom: mapProps.MaxZoom || undefined,\r\n            maxPopupCount: mapProps.maxPopupContent\r\n        });\r\n\r\n        var lmap = new L.Map($('#flash')[0], mapOptions);\r\n\r\n\r\n        // update layers zIndexes\r\n        var currentZoom = lmap.getZoom(),\r\n            layerOrder = gmxMap.rawTree.properties.LayerOrder;\r\n\r\n        updateZIndexes();\r\n\r\n        lmap.on('zoomend', function() {\r\n            currentZoom = lmap.getZoom();\r\n            updateZIndexes();\r\n        })\r\n\r\n        //clip polygons\r\n        if (mapProps.MinViewX && mapProps.MinViewY && mapProps.MaxViewX && mapProps.MaxViewY) {\r\n            lmap.on('layeradd', function(e) {\r\n                if (e.layer.addClipPolygon) {\r\n                    _mapHelper.clipLayer(e.layer, mapProps);\r\n                }\r\n            })\r\n        }\r\n\r\n        // bind clusters to photoLayers\r\n        for (let l = 0; l < gmxMap.layers.length; l++) {\r\n            let layer = gmxMap.layers[l],\r\n                props = layer.getGmxProperties();\r\n\r\n            if (props.IsPhotoLayer) {\r\n                layer.bindClusters({\r\n                    iconCreateFunction: function(cluster) {\r\n                        var photoClusterIcon = L.divIcon({\r\n                            html: '<img src=\"' + (window.serverBase ? window.serverBase + _mapHelper.defaultPhotoIconStyles.point.marker.image : _mapHelper.defaultPhotoIconStyles.point.marker.image) + '\" class=\"photo-icon\"/><div class=\"marker-cluster-photo\">' + cluster.getChildCount() + '</div>',\r\n                            className: 'photo-div-icon',\r\n                            iconSize: [14, 12],\r\n                            iconAnchor: [0, 0]\r\n                        });\r\n                        return photoClusterIcon;\r\n                    },\r\n                    maxClusterRadius: 40,\r\n                    spiderfyOnMaxZoom: true,\r\n                    spiderfyZoom: 14,\r\n                    spiderfyDistanceMultiplier: 1.2,\r\n                    disableClusteringAtZoom: 19,\r\n                    maxZoom: 19\r\n                });\r\n            }\r\n        }\r\n        lmap.contextmenu.insertItem({\r\n            text: _gtxt('Поставить маркер'),\r\n            callback: function(event) {\r\n                lmap.gmxDrawing.addGeoJSON({ type: 'Point', coordinates: [event.latlng.lng, event.latlng.lat] });\r\n            }\r\n        })\r\n\r\n        lmap.contextmenu.insertItem({\r\n            text: _gtxt('Центрировать'),\r\n            callback: function(event) {\r\n                lmap.setView(event.latlng);\r\n            }\r\n        });\r\n\r\n        function updateZIndexes() {\r\n            for (var l = 0; l < gmxMap.layers.length; l++) {\r\n                var layer = gmxMap.layers[l],\r\n                    props = layer.getGmxProperties();\r\n\r\n                switch (layerOrder) {\r\n                    case 'VectorOnTop':\r\n                        if (props.type === 'Vector' && layer.setZIndexOffset) {                            \r\n                            let rcMinZoom,\r\n                                quickLookMinZoom,\r\n                                defaultMinZoom = 6;\r\n\r\n                            if (props.IsRasterCatalog || (props.Quicklook && props.Quicklook !== 'null')) {\r\n                                rcMinZoom = props.IsRasterCatalog ? props.RCMinZoomForRasters : null;\r\n                                quickLookMinZoom = (props.Quicklook && nsGmx.Utils.isJSON(props.Quicklook)) ? JSON.parse(props.Quicklook).minZoom : null;\r\n\r\n                                if (props.IsRasterCatalog && !props.Quicklook) {\r\n                                    let minZoom = nsGmx.Utils.checkForNumber(rcMinZoom) ? rcMinZoom : defaultMinZoom;\r\n                                } else if (!props.IsRasterCatalog && props.Quicklook) {\r\n                                    let minZoom = nsGmx.Utils.checkForNumber(quickLookMinZoom) ? quickLookMinZoom : defaultMinZoom;\r\n                                } else if (props.IsRasterCatalog && props.Quicklook) {\r\n                                    rcMinZoom = nsGmx.Utils.checkForNumber(rcMinZoom) ? rcMinZoom : defaultMinZoom;\r\n                                    quickLookMinZoom = nsGmx.Utils.checkForNumber(quickLookMinZoom) ? quickLookMinZoom : defaultMinZoom;                                    \r\n                                }\r\n                                layer.setZIndexOffset(currentZoom < rcMinZoom ? DEFAULT_VECTOR_LAYER_ZINDEXOFFSET : 0);\r\n                            } else {\r\n                                layer.setZIndexOffset(DEFAULT_VECTOR_LAYER_ZINDEXOFFSET);\r\n                            }\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Begin: запоминание текущей позиции карты\r\n        function saveMapPosition(key) {\r\n            window.localStorage.setItem('lastMapPosiotion_' + key, JSON.stringify({ zoom: lmap.getZoom(), center: lmap.getCenter() }));\r\n        }\r\n\r\n        function getMapPosition(key) {\r\n            return JSON.parse(localStorage.getItem('lastMapPosiotion_' + key));\r\n        }\r\n        lmap.on('boxzoomstart', function() { saveMapPosition('z'); });\r\n        L.DomEvent.on(document, 'keydown', function(ev) {\r\n            var key = ev.key;\r\n            if (lmap.gmxMouseDown === 1) {\r\n                var pos = getMapPosition(key);\r\n                if (pos && (key === 'z' || Number(key) >= 0)) {\r\n                    lmap.setView(pos.center, pos.zoom);\r\n                }\r\n            } else if (lmap.gmxMouseDown > 1) {\r\n                if (Number(key) >= 0) {\r\n                    saveMapPosition(key);\r\n                }\r\n            }\r\n\r\n        }, lmap);\r\n        // End: запоминание текущей позиции карты\r\n\r\n        lmap.gmxControlsManager.init(window.controlsOptions);\r\n        // lmap.addControl(new L.Control.gmxLayers(lmap.gmxBaseLayersManager, {\r\n        //     // position: 'topleft',\r\n        //     collapsed: true,\r\n        //     hideBaseLayers: true\r\n        // }));\r\n\r\n        nsGmx.leafletMap = lmap;\r\n\r\n        var loc = nsGmx.leafletMap.gmxControlsManager.get('location');\r\n\r\n        loc.setCoordinatesFormat(gmxMap.properties.coordinatesFormat);\r\n\r\n        loc.on('coordinatesformatchange', function(ev) {\r\n            nsGmx.leafletMap.options.coordinatesFormat = ev.coordinatesFormat;\r\n        });\r\n\r\n        var baseLayerDef = 'baseMap' in window ? initDefaultBaseLayers() : lmap.gmxBaseLayersManager.initDefaults({ hostName: window.mapHostName, apiKey: window.apiKey, srs: lmap.options.srs, skipTiles: lmap.options.skipTiles, isGeneralized: lmap.options.isGeneralized });\r\n\r\n        baseLayerDef.then(function() {\r\n\r\n            nsGmx.gmxMap = gmxMap;\r\n            window.gmxAPI.layersByID = gmxMap.layersByID; // слои по layerID\r\n\r\n            var mapProp = gmxMap.rawTree.properties || {}\r\n            var baseLayers = mapProp.BaseLayers ? JSON.parse(mapProp.BaseLayers) : [window.language === 'eng' ? 'mapbox' : 'sputnik', 'OSMHybrid', 'satellite'];\r\n\r\n            lmap.gmxBaseLayersManager.setActiveIDs(baseLayers);\r\n\r\n            var baseLayersControl = new L.Control.GmxIconLayers(lmap.gmxBaseLayersManager, { id: 'iconLayers' });                \r\n            lmap.gmxControlsManager.add(baseLayersControl);\r\n\r\n            lmap.addControl(baseLayersControl);\r\n\r\n            nsGmx.widgets.commonCalendar = new nsGmx.CommonCalendarWidget();\r\n\r\n            // добавление временных слоев в commonCalendar\r\n            // добавление происходит безопасно, в клон объекта со списком слоев\r\n            var initTemporalLayers = function(layers) {\r\n                layers = layers || nsGmx.gmxMap.layers;\r\n\r\n                var attrs = nsGmx.widgets.commonCalendar.model.toJSON(),\r\n                    showCalendar = undefined,\r\n                    dateInterval,\r\n                    dateBegin,\r\n                    dateEnd;\r\n\r\n                for (var i = 0; i < layers.length; i++) {\r\n                    var layer = layers[i],\r\n                        props = layer.getGmxProperties(),\r\n                        // isVisible = props.visible,\r\n                        isTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.setDateInterval);\r\n                    if (isTemporalLayer) {\r\n                        // показываем виджет календаря, если в карте есть хоть один мультивременной слой\r\n                        showCalendar = true;\r\n\r\n                        dateInterval = layer.getDateInterval ? layer.getDateInterval() : new nsGmx.DateInterval();\r\n\r\n                        if (dateInterval.beginDate && dateInterval.endDate) {\r\n                            dateBegin = dateInterval.beginDate;\r\n                            dateEnd = dateInterval.endDate;\r\n                        } else {\r\n                            dateInterval = new nsGmx.DateInterval();\r\n                            dateBegin = dateInterval.get('dateBegin');\r\n                            dateEnd = dateInterval.get('dateEnd');\r\n                        }\r\n\r\n                        if (!(props.name in attrs.unbindedTemporalLayers)) {\r\n                            nsGmx.widgets.commonCalendar.bindLayer(props.name);\r\n\r\n                            layer.setDateInterval(dateBegin, dateEnd);\r\n\r\n                            if (props.LayerID in attrs.dailyFiltersHash) {\r\n                                nsGmx.widgets.commonCalendar.applyDailyFilter([layer]);\r\n                            }\r\n\r\n                        }\r\n                        //подписка на изменение dateInterval\r\n                        if (layer.getDateInterval) {\r\n                            layer.on('dateIntervalChanged', nsGmx.widgets.commonCalendar.onDateIntervalChanged, nsGmx.widgets.commonCalendar);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                nsGmx.widgets.commonCalendar.updateVisibleTemporalLayers(nsGmx.gmxMap.layers);\r\n\r\n                if (showCalendar && !attrs.isAppended) {\r\n                    nsGmx.widgets.commonCalendar.show();\r\n                }\r\n            }\r\n\r\n            // привяжем изменение активной ноды к календарю\r\n            $(_layersTree).on('activeNodeChange', function(e, p) {\r\n                var layerID = $(p).attr('layerid');\r\n                    // calendar = nsGmx.widgets.commonCalendar.model.get('calendar'),\r\n                    // synchronyzed = nsGmx.widgets.commonCalendar.model.get('synchronyzed');\r\n\r\n                lmap.fireEvent('layersTree.activeNodeChange', { layerID: layerID });\r\n            });\r\n\r\n            $(_layersTree).on('layerVisibilityChange', function(event, elem) {\r\n                let props = elem.content.properties,\r\n                    attrs = nsGmx.widgets.commonCalendar.model.toJSON(),\r\n                    visible = props.visible,\r\n                    layerID = props.LayerID,\r\n                    // calendar = attrs.calendar,\r\n                    currentLayer = attrs.currentLayer,\r\n                    synchronyzed = attrs.synchronyzed;\r\n\r\n                if (synchronyzed) {\r\n                    return;\r\n                }\r\n                else if (layerID) {\r\n                    let layer = nsGmx.gmxMap.layersByID[layerID],\r\n                        props = layer.getGmxProperties(),\r\n                        isTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.getDateInterval),\r\n                        visibleTemporalLayers,\r\n                        index;\r\n\r\n                    if (isTemporalLayer) {\r\n                        if (visible) {\r\n                            if (currentLayer) {\r\n                                return;\r\n                            } else {\r\n                                let dateInterval = layer.getDateInterval();\r\n                                if (dateInterval.beginDate && dateInterval.endDate) {\r\n                                    nsGmx.widgets.commonCalendar.setDateInterval(dateInterval.beginDate, dateInterval.endDate, layer);\r\n                                }\r\n                            }\r\n                        }\r\n                        else if (currentLayer) {\r\n                            if (layerID !== currentLayer) {\r\n                                return;\r\n                            }\r\n                            else {\r\n                                visibleTemporalLayers = getLayersListWithTarget(nsGmx.gmxMap.layers, layer);\r\n                                index = visibleTemporalLayers.indexOf(layer);\r\n\r\n                                if (visibleTemporalLayers.length === 1) {\r\n                                    nsGmx.widgets.commonCalendar.model.set('currentLayer', null);\r\n                                }\r\n                                else if (index === 0) {\r\n                                    let targetLayer = visibleTemporalLayers[index + 1],\r\n                                        // targetLayerID = targetLayer.getGmxProperties().LayerID,\r\n                                        dateInterval = targetLayer.getDateInterval();\r\n\r\n                                    nsGmx.widgets.commonCalendar.setDateInterval(dateInterval.beginDate, dateInterval.endDate, targetLayer);\r\n                                    // nsGmx.widgets.commonCalendar.model.set('currentLayer', targetLayerID)\r\n                                } else {\r\n                                    let targetLayer = visibleTemporalLayers[index - 1],\r\n                                        // targetLayerID = targetLayer.getGmxProperties().LayerID,\r\n                                        dateInterval = targetLayer.getDateInterval();\r\n\r\n                                    nsGmx.widgets.commonCalendar.setDateInterval(dateInterval.beginDate, dateInterval.endDate, targetLayer);\r\n                                    // nsGmx.widgets.commonCalendar.model.set('currentLayer', targetLayerID)\r\n                                }\r\n                            }\r\n                        }\r\n                        else {\r\n                            return;\r\n                        }                        \r\n                    }\r\n                }\r\n                \r\n                nsGmx.widgets.commonCalendar.updateVisibleTemporalLayers(nsGmx.gmxMap.layers);\r\n\r\n                function getLayersListWithTarget(layers, targetLayer) {\r\n                    let visibleTemporalLayers = [];\r\n                    for (let i = 0; i < layers.length; i++) {\r\n                        let layer = layers[i],\r\n                            props = layer.getGmxProperties && layer.getGmxProperties(),\r\n                            isTemporalLayer,\r\n                            isVisible;\r\n\r\n                        if (props) {\r\n                            isTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.getDateInterval);\r\n                            isVisible = props.visible;\r\n\r\n                            if (isTemporalLayer && isVisible || layer === targetLayer) {\r\n                                visibleTemporalLayers.push(layer);\r\n                            }\r\n                        }\r\n                    }\r\n                    return visibleTemporalLayers;\r\n                }\r\n            });\r\n\r\n            $(_layersTree).on('styleVisibilityChange', function(event, styleVisibilityProps) {\r\n                let it = nsGmx.gmxMap.layersByID[styleVisibilityProps.elem.name],\r\n                    styles = it.getStyles(),\r\n                    st = styles[styleVisibilityProps.styleIndex];\r\n\r\n                let div = $(_queryMapLayers.buildedTree).find(\"div[LayerID='\" + styleVisibilityProps.elem.LayerID + \"']\")[0],\r\n                    elemProperties = div.gmxProperties.content.properties,\r\n                    treeStyles = window.newStyles ?  elemProperties.gmxStyles.styles : elemProperties.styles,\r\n                    treeSt = treeStyles[styleVisibilityProps.styleIndex];\r\n\r\n                if (typeof treeSt._MinZoom === 'undefined') {\r\n                    treeSt._MinZoom = treeSt.MinZoom;\r\n                }\r\n\r\n                if (styleVisibilityProps.show) {\r\n                    treeSt.MinZoom = treeSt._MinZoom;\r\n                    st.MinZoom = treeSt._MinZoom;\r\n                    treeSt.disabled = false;\r\n                } else {\r\n                    treeSt.disabled = true;\r\n                }\r\n                st.disabled = treeSt.disabled;\r\n\r\n                it.setStyles(styles);\r\n            });\r\n\r\n            _mapHelper.customParamsManager.addProvider({\r\n                name: 'commonCalendar',\r\n                loadState: function(state) {\r\n                    if (!('version' in state)) {\r\n                        let tmpDateInterval = new nsGmx.DateInterval({\r\n                            dateBegin: new Date(state.dateBegin),\r\n                            dateEnd: new Date(state.dateEnd)\r\n                        });\r\n                        nsGmx.widgets.commonCalendar.getDateInterval().loadState(tmpDateInterval.saveState());\r\n                    } else if (state.version === '1.0.0') {\r\n                        nsGmx.widgets.commonCalendar.model.set('synchronyzed', typeof(state.synchronyzed) !== 'undefined' ? state.synchronyzed : true);\r\n                        nsGmx.widgets.commonCalendar.model.set('currentLayer', typeof(state.currentLayer) !== 'undefined' ? state.currentLayer : null);\r\n                        nsGmx.widgets.commonCalendar.getDateInterval().loadState(state.dateInterval);\r\n                        nsGmx.widgets.commonCalendar.model.set('dailyFilter', typeof(state.dailyFilter) !== 'undefined' ? state.dailyFilter : true);\r\n                    } else {\r\n                        throw 'Unknown params version';\r\n                    }\r\n                },\r\n                saveState: function() {\r\n                    return {\r\n                        version: '1.0.0',\r\n                        dateInterval: nsGmx.widgets.commonCalendar.getDateInterval().saveState(),\r\n                        currentLayer: nsGmx.widgets.commonCalendar.model.get('currentLayer'),\r\n                        synchronyzed: nsGmx.widgets.commonCalendar.model.get('synchronyzed'),\r\n                        dailyFilter: nsGmx.widgets.commonCalendar.model.get('dailyFilter')\r\n                    };\r\n                }\r\n            });\r\n\r\n            $('#flash').bind('dragover', function() {\r\n                return false;\r\n            });\r\n\r\n            $('#flash').bind('drop', function(e) {\r\n                if (!e.originalEvent.dataTransfer) {\r\n                    return;\r\n                }\r\n\r\n                _queryLoadShp.loadAndShowFiles(e.originalEvent.dataTransfer.files);\r\n\r\n                return false;\r\n            })\r\n\r\n            if (state.dt) {\r\n                try {\r\n                    let dateLocal = $.datepicker.parseDate('dd.mm.yy', state.dt);\r\n                    let dateBegin = nsGmx.CalendarWidget.fromUTC(dateLocal);\r\n                    let dateEnd = new Date(dateBegin.valueOf() + 24 * 3600 * 1000);\r\n                    let dateInterval = nsGmx.widgets.commonCalendar.getDateInterval();\r\n                    dateInterval.set({\r\n                        dateBegin: dateBegin,\r\n                        dateEnd: dateEnd\r\n                    });\r\n                } catch (e) {\r\n                    console.log(e);\r\n                }\r\n            }\r\n\r\n            nsGmx.pluginsManager.beforeViewer();\r\n\r\n            //для каждого ответа сервера об отсутствии авторизации (Status == 'auth') сообщаем об этом пользователю или предлагаем залогиниться\r\n            addParseResponseHook('auth', function() {\r\n                if (nsGmx.AuthManager.isLogin()) {\r\n                    showErrorMessage(_gtxt('Недостаточно прав для совершения операции'), true);\r\n                } else {\r\n                    nsGmx.widgets.authWidget.showLoginDialog();\r\n                }\r\n\r\n                return false;\r\n            });\r\n\r\n            initAuthWidget();\r\n\r\n            //инициализация контролов пользовательских объектов\r\n            //соответствующий модуль уже загружен\r\n            // let oDrawingObjectsModule = window.gmxCore.getModule('DrawingObjects');\r\n            window.oDrawingObjectGeomixer = new DrawingObjectGeomixer();\r\n            window.oDrawingObjectGeomixer.Init(nsGmx.leafletMap, nsGmx.gmxMap);\r\n\r\n            //для всех слоёв должно выполняться следующее условие: если хотя бы одна групп-предков невидима, то слой тоже невидим.\r\n            (function fixVisibilityConstrains(o) {\r\n                // o.content.properties.visible = o.content.properties.visible;\r\n\r\n                if (o.type === 'group') {\r\n                    let a = o.content.children;\r\n\r\n                    let isAnyVisibleChild = false;\r\n\r\n                    for (let k = a.length - 1; k >= 0; k--) {\r\n                        let childrenVisibility = fixVisibilityConstrains(a[k]);\r\n                        isAnyVisibleChild = isAnyVisibleChild || childrenVisibility;\r\n                    }\r\n\r\n                    // если внутри группы есть включенные слои, группа тоже включается\r\n                    // если же ни одного включенного слоя нет, то группа выключается\r\n                    o.content.properties.visible = isAnyVisibleChild ? true : false;\r\n                }\r\n                return o.content.properties.visible;\r\n            })({ type: 'group', content: { children: data.children, properties: { visible: true } } });\r\n\r\n            window.oldTree = JSON.parse(JSON.stringify(data));\r\n\r\n            window.defaultLayersVisibility = {};\r\n\r\n            for (let k = 0; k < gmxMap.layers.length; k++) {\r\n                let props = gmxMap.layers[k].getGmxProperties();\r\n                window.defaultLayersVisibility[props.name] = props.visible;\r\n            }\r\n\r\n            //основная карта всегда загружена с того-же сайта, что и серверные скрипты\r\n            data.properties.hostName = window.serverBase.slice(7).slice(0, -1);\r\n\r\n            //DEPRICATED. Do not use it!\r\n            _mapHelper.mapProperties = data.properties;\r\n\r\n            //DEPRICATED. Do not use it!\r\n            _mapHelper.mapTree = data;\r\n\r\n            if (window.copyright && typeof window.copyright === 'string') {\r\n                lmap.gmxControlsManager.get('copyright').setMapCopyright(window.copyright);\r\n            }\r\n\r\n            let condition = false,\r\n                mapStyles = false,\r\n                LayersTreePermalinkParams = false;\r\n\r\n            if (state.condition) {\r\n                condition = state.condition;\r\n            }\r\n\r\n            if (state.mapStyles) {\r\n                mapStyles = state.mapStyles;\r\n            }\r\n            if (state.LayersTreePermalinkParams) {\r\n                LayersTreePermalinkParams = state.LayersTreePermalinkParams;\r\n            }\r\n\r\n            /**\r\n             *\r\n             * SIDEBAR\r\n             *\r\n             */\r\n\r\n            window.iconSidebarWidget = new IconSidebarWidget(document.getElementById('leftMenu'), {\r\n                collapsedWidth: 40,\r\n                extendedWidth: 400,\r\n                position: 'left'\r\n            });\r\n\r\n            window.iconSidebarWidget.addEventListener('opened', window.resizeAll);\r\n            window.iconSidebarWidget.addEventListener('closed', window.resizeAll);\r\n\r\n            window.createTabFunction = function(options) {\r\n                return function(state) {\r\n                    var el = document.createElement(\"div\"),\r\n                        tabEl = document.createElement(\"div\"),\r\n                        href = '#' + options.icon.toLowerCase(),\r\n                        symbol = document.querySelector(href);\r\n                    $(el).addClass(\"tab-icon\");\r\n\r\n                    if (symbol) $(symbol).addClass(\"sidebar-icon\");\r\n\r\n                    tabEl.innerHTML = '<svg role=\"img\" class=\"svgIcon\">\\\r\n                    <use xlink:href=\"' + href + '\" href=\"' + href + '\"></use>\\\r\n                    </svg>';\r\n\r\n                    el.appendChild(tabEl);\r\n\r\n                    options.hint && el.setAttribute(\"title\", options.hint);\r\n                    $(tabEl).addClass(options.icon);\r\n                    if (state === \"active\") {\r\n                        $(tabEl).addClass(options.active);\r\n                        $(el).addClass(\"tab-icon-active\");\r\n                        if (symbol) $(symbol).addClass(\"sidebar-active-icon\");\r\n                    } else {\r\n                        if (symbol && $(symbol).hasClass(\"sidebar-active-icon\")) {\r\n                            $(symbol).removeClass(\"sidebar-active-icon\");\r\n                        }\r\n                        $(tabEl).addClass(options.inactive);\r\n                    }\r\n                    return el;\r\n                };\r\n            };\r\n\r\n            // init tab\r\n            window.iconSidebarWidget._activeTabId = \"layers-tree\";\r\n\r\n            var leftMainContainer = nsGmx.layersTreePane = window.iconSidebarWidget.setPane(\r\n                \"layers-tree\", {\r\n                    createTab: window.createTabFunction({\r\n                        icon: \"s-tree\",\r\n                        active: \"sidebar-icon-active\",\r\n                        inactive: \"sidebar-icon-inactive\",\r\n                        hint: \"Слои\"\r\n                    })\r\n                }\r\n            );\r\n\r\n                leftMainContainer.innerHTML =\r\n                '<div class=\"leftMenu\">' +\r\n                    '<div class=\"mainmap-title\">' + data.properties.title + '</div>' +\r\n                    '<div id=\"leftPanelHeader\" class=\"leftPanelHeader\"></div>' +\r\n                    '<div id=\"leftContent\" class=\"leftContent\">' +\r\n                        '<div id=\"leftContentInner\" class=\"leftContentInner\"></div>' +\r\n                    '</div>' +\r\n                    '<div id=\"leftPanelFooter\" class=\"leftPanelFooter\"></div>' +\r\n                '</div>';\r\n\r\n            window.iconSidebarWidget.open(\"layers-tree\");\r\n\r\n            // $('.leftContent').mCustomScrollbar();\r\n\r\n                // function handleSidebarResize (e) {\r\n                //     var sidebarWidth = window.iconSidebarWidget.getWidth(),\r\n                //         lmap = nsGmx.leafletMap,\r\n                //         newBottomLeft,\r\n                //         newBounds;\r\n                //     var c = lmap.getContainer();\r\n\r\n                //     var pBounds = lmap.getPixelBounds(),\r\n                //         bl = pBounds.getBottomLeft(),\r\n                //         tr = pBounds.getTopRight(),\r\n                //         blll = L.latLng(lmap.unproject(bl)),\r\n                //         trll = L.latLng(lmap.unproject(tr));\r\n\r\n                //     if (e.type === 'sidebar:opened') {\r\n                //         newBottomLeft = L.point(bl.x + sidebarWidth, bl.y);\r\n                //     } else {\r\n                //         newBottomLeft = L.point(bl.x - sidebarWidth, bl.y);\r\n\r\n                //     }\r\n                //     newBounds = L.latLngBounds(L.latLng(lmap.unproject(newBottomLeft)), trll);\r\n                // }\r\n\r\n                /**\r\n                 *\r\n                 * SIDEBAR END\r\n                 *\r\n                 */\r\n\r\n\r\n            _queryMapLayers.addLayers(data, condition, mapStyles, LayersTreePermalinkParams);\r\n\r\n            // переписать на вкладку с деревом\r\n            var headerDiv = $('.mainmap-title');\r\n\r\n            // special for steppe Project\r\n            if (data.properties.MapID === '0786A7383DF74C3484C55AFC3580412D') {\r\n                $(headerDiv).toggle();\r\n            }\r\n\r\n            nsGmx.ContextMenuController.bindMenuToElem(headerDiv[0], 'Map', function() {\r\n                    return _queryMapLayers.currentMapRights() == 'edit';\r\n                },\r\n                function() {\r\n                    return {\r\n                        div: $(_layersTree._treeCanvas).find('div[MapID]')[0],\r\n                        tree: _layersTree\r\n                    }\r\n                }\r\n            );\r\n\r\n            // _menuUp.defaultHash = 'layers';\r\n            window.mapLayers.mapLayers.load();\r\n\r\n            //создаём тулбар\r\n            // var iconContainer = _div(null, [\r\n            //     ['css', 'borderLeft', '1px solid #216b9c']\r\n            // ]);\r\n\r\n            // var searchContainer = nsGmx.widgets.header.getSearchPlaceholder()[0];\r\n\r\n            window.searchLogic.init({\r\n                oMenu: oSearchLeftMenu\r\n            });\r\n\r\n            //инициализация контролов поиска (модуль уже загружен)\r\n            // var oSearchModule = window.gmxCore.getModule('search');\r\n            // window.oSearchControl = new oSearchModule.SearchGeomixer();\r\n\r\n            // if (document.getElementById('searchCanvas')) {\r\n            // window.oSearchControl.Init({\r\n            //     Menu: oSearchLeftMenu,\r\n            //     ContainerInput: searchContainer,\r\n            //     ServerBase: window.serverBase,\r\n            //     layersSearchFlag: true,\r\n            //     Map: lmap,\r\n            //     gmxMap: gmxMap\r\n            // });\r\n\r\n            _menuUp.createMenu = function() {\r\n                createMenuNew();\r\n            };\r\n\r\n            _menuUp.go(nsGmx.widgets.header.getMenuPlaceholder()[0]);\r\n\r\n            var headerLinks = nsGmx.addHeaderLinks();\r\n\r\n            if (headerLinks.length) {\r\n                _menuUp.addItem({ id: 'linksMenu', title: _gtxt('Ссылки'), childs: headerLinks });\r\n            }\r\n\r\n            // Загружаем все пользовательские данные\r\n            nsGmx.userObjectsManager.load();\r\n\r\n            // выставляет правильные z-indexes слоям-вьюхам\r\n            _layersTree.updateZIndexes();\r\n\r\n            //выполняем мапплет карты нового формата\r\n            nsGmx.mappletLoader.execute();\r\n\r\n            //динамически добавляем пункты в меню. DEPRICATED.\r\n            nsGmx.pluginsManager.addMenuItems(_menuUp);\r\n\r\n            _mapHelper.gridView = false;\r\n\r\n            var updateLeftPanelVis = function() {\r\n                // $('.leftCollapser-icon')\r\n                //     .toggleClass('leftCollapser-right', !layersShown)\r\n                //     .toggleClass('leftCollapser-left', !!layersShown);\r\n                window.resizeAll();\r\n            }\r\n\r\n            // $('#leftCollapser').click(function() {\r\n            //     layersShown = !layersShown;\r\n            //     updateLeftPanelVis();\r\n            // });\r\n            updateLeftPanelVis();\r\n\r\n            createToolbar();\r\n\r\n\r\n            var controls = lmap.gmxControlsManager.getAll();\r\n\r\n            for (var key in controls) {\r\n                var ctrl = controls[key],\r\n                    cntr = ctrl.getContainer();\r\n                cntr.addEventListener('click', function (e) {\r\n                    _menuUp.hideOnClick(e);\r\n                });\r\n            }\r\n\r\n            if (state.mode) {\r\n                lmap.gmxBaseLayersManager.setCurrentID(lmap.gmxBaseLayersManager.getIDByAlias(state.mode) || state.mode);\r\n            } else if (baseLayers.length && !lmap.gmxBaseLayersManager.getCurrentID()) {\r\n                lmap.gmxBaseLayersManager.setCurrentID(baseLayers[0]);\r\n            }\r\n\r\n            if (state.drawings) {\r\n                lmap.gmxDrawing.loadState(state.drawings);\r\n            } else if (state.drawnObjects) {\r\n                state.drawnObjects.forEach(function(objInfo) {\r\n                    //старый формат - число, новый - строка\r\n                    var lineStyle = {};\r\n\r\n                    if (objInfo.color) {\r\n                        lineStyle.color = typeof objInfo.color === 'number' ? '#' + L.gmxUtil.dec2hex(objInfo.color) : objInfo.color;\r\n                    }\r\n\r\n                    if (objInfo.thickness) { lineStyle.weight = objInfo.thickness }\r\n                    if (objInfo.opacity) { lineStyle.opacity = objInfo.opacity / 100 }\r\n\r\n                    var featureOptions = $.extend(true, {}, objInfo.properties, {\r\n                        lineStyle: lineStyle\r\n                    });\r\n\r\n                    var drawingFeature = lmap.gmxDrawing.addGeoJSON(L.gmxUtil.geometryToGeoJSON(objInfo.geometry), featureOptions)[0];\r\n\r\n                    if (objInfo.isBalloonVisible) {\r\n                        drawingFeature.openPopup();\r\n                    }\r\n                });\r\n            } else if (state.marker) {\r\n                nsGmx.leafletMap.gmxDrawing.addGeoJSON({\r\n                    type: 'Feature',\r\n                    geometry: { type: 'Point', coordinates: [state.marker.mx, state.marker.my] },\r\n                    properties: { title: state.marker.mt }\r\n                });\r\n            }\r\n\r\n            if (state.openPopups) {\r\n                for (let l in state.openPopups) {\r\n                    let layer = nsGmx.gmxMap.layersByID[l];\r\n                    if (layer && layer.addPopup) {\r\n                        state.openPopups[l].forEach(layer.addPopup.bind(layer));\r\n                    }\r\n                }\r\n            }\r\n\r\n            _menuUp.checkView();\r\n\r\n            if (nsGmx.AuthManager.isLogin()) {\r\n                _queryMapLayers.addUserActions();\r\n            }\r\n\r\n            if (state.dateIntervals) {\r\n                for (let lid in gmxMap.layersByID) {\r\n                    if (lid in state.dateIntervals) {\r\n                        let l = gmxMap.layersByID[lid],\r\n                            beginDate = new Date(state.dateIntervals[lid].beginDate),\r\n                            endDate = new Date(state.dateIntervals[lid].endDate);\r\n\r\n                        l.setDateInterval(beginDate, endDate);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (state.filters) {\r\n                for (let key in state.filters) {\r\n                    let l = nsGmx.gmxMap.layersByID[key],\r\n                        filtersArr = state.filters[key];\r\n\r\n                    for (let i = 0; i < filtersArr.length; i++) {\r\n                        if ('filterById' in filtersArr[i]) {\r\n                            let filteredId = filtersArr[i]['filterById'];\r\n\r\n                            l.addLayerFilter(function(it) { return it.id === filteredId });\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            initEditUI();\r\n            initTemporalLayers();\r\n\r\n            gmxMap.addLayersToMap(lmap);\r\n\r\n            nsGmx.leafletMap.on('layeradd', function(event) {\r\n                var layer = event.layer;\r\n\r\n                if (layer.getGmxProperties) {\r\n                    // var layerProps = layer.getGmxProperties();\r\n\r\n                    initEditUI();\r\n                    initTemporalLayers([layer]);\r\n\r\n                }\r\n            });\r\n            // if (mapProp.MapID !== 'ATTBP') {\r\n            nsGmx.gmxMap.on('onRemoveLayer', function(event) {\r\n                var layer = event.layer;\r\n                if (!layer.getGmxProperties()) {\r\n                    return;\r\n                }\r\n                var props = layer.getGmxProperties(),\r\n                    isTemporalLayer = (layer instanceof L.gmx.VectorLayer && props.Temporal) || (props.type === 'Virtual' && layer.getDateInterval);\r\n\r\n                if (isTemporalLayer && !(props.name in nsGmx.widgets.commonCalendar._unbindedTemporalLayers)) {\r\n                    nsGmx.widgets.commonCalendar.unbindLayer(props.name);\r\n                    nsGmx.widgets.commonCalendar.updateTemporalLayers();\r\n                    delete nsGmx.widgets.commonCalendar._unbindedTemporalLayers[props.name];\r\n                }\r\n            });\r\n\r\n            // special for steppe project\r\n            if (nsGmx.gmxMap.properties.MapID === '0786A7383DF74C3484C55AFC3580412D') {\r\n                nsGmx.widgets.commonCalendar.show();\r\n            }\r\n            nsGmx.pluginsManager.afterViewer();\r\n\r\n            // обработка специальных параметров плагинов\r\n            nsGmx.pluginsManager.forEachPlugin(function (plugin) {\r\n                if (plugin.moduleName === \"gmxTimeLine\" && nsGmx.timeLineControl) {\r\n                    var treeLayers = $(window._layersTree);\r\n                    nsGmx.timeLineControl\r\n                        .on('layerRemove', function(e) {\r\n                            treeLayers.triggerHandler('layerTimelineRemove', e);\r\n                        })\r\n                        .on('layerAdd', function(e) {\r\n                            treeLayers.triggerHandler('layerTimelineAdd', e);\r\n                        })\r\n                        .saveState().dataSources.forEach(function(it) {\r\n                            treeLayers.triggerHandler('layerTimelineAdd', {type: 'layerAdd', layerID: it.layerID});\r\n                        });\r\n                }\r\n            });\r\n\r\n            // экспорт карты\r\n\r\n            if (state.exportMode) {\r\n                _mapHelper.exportMap(state);\r\n            }\r\n        });\r\n    }\r\n\r\n    function mapExportMenu() {\r\n        window.gmxCore.loadModule('MapExport'\r\n        // , 'src/MapExport/MapExport.js'\r\n        ).then(function(def) {\r\n            var menu = new def.MapExportMenu();\r\n            menu.Load();\r\n        });\r\n    }\r\n\r\n    function BufferZonesMenu() {\r\n        window.gmxCore.loadModule('BufferZones'\r\n        // , 'src/BufferZones/BufferZones.js'\r\n        ).then(function(def) {\r\n            var menu = new def.BufferZonesMenu();\r\n            menu.Load();\r\n        });\r\n    }\r\n\r\n    function indexGridMenu() {\r\n        window.gmxCore.loadModule('IndexGrid'\r\n        // , 'src/IndexGrid/IndexGrid.js'\r\n        ).then(function(def) {\r\n            var menu = new def.IndexGridMenu();\r\n            menu.Load();\r\n        });\r\n    }\r\n\r\n    function PhotoLayerDialog() {\r\n        window.gmxCore.loadModule('PhotoLayer'\r\n        // , 'src/PhotoLayer/PhotoLayer.js'\r\n        ).then(function(def) {\r\n            var dialog = new def.PhotoLayer();\r\n            dialog.Load();\r\n        });\r\n    }\r\n\r\n    function promptFunction(title, value) {\r\n        var ui = $(Handlebars.compile(\r\n            '<div class=\"gmx-prompt-canvas\">' +\r\n            '<input class=\"inputStyle gmx-prompt-input\" value=\"{{value}}\">' +\r\n            '</div>')({ value: value }));\r\n\r\n        ui.find('input').on('keydown', function(e) {\r\n            // var evt = e || window.event;\r\n            if (e.which === 13) {\r\n                var coord = L.gmxUtil.parseCoordinates(this.value);\r\n                nsGmx.leafletMap.panTo(coord);\r\n                return false;\r\n            }\r\n        })\r\n\r\n        showDialog(title, ui[0], 300, 80, false, false);\r\n    }\r\n\r\n    window.prompt = promptFunction;\r\n\r\n};\r\n\r\ntinyMCE.init({\r\n    mode : \"none\",\r\n    theme : \"advanced\",\r\n    plugins: 'fullscreen',\r\n    language: 'ru',\r\n    convert_urls: false,\r\n    theme_advanced_buttons1: 'bold,italic,underline,|,justifyleft,justifycenter,justifyright,|,link,unlink,fullscreen,code',\r\n    theme_advanced_buttons2: '',\r\n    theme_advanced_buttons3: '',\r\n    theme_advanced_statusbar_location: 'none',\r\n    theme_advanced_toolbar_location: 'bottom',\r\n    theme_advanced_toolbar_align: 'center'\r\n});\r\n\r\nnsGmx.initGeoMixer();"],"names":["nsGmx","window","gmxCore","_callbacks","_modules","_globalNamespace","_modulesDefaultHost","_modulePathes","_moduleFiles","getScriptURL","scriptName","toLowerCase","scripts1","document","getElementsByTagName","i","length","src","getAttribute","indexOf","getScriptBase","url","substring","invokeCallbacks","k","isAllModules","curModules","modules","m","push","curCallback","callback","splice","apply","LABjsDeferred","lazyLoadLABjs","$","Deferred","g","b","d","c","head","D","E","F","G","H","setTimeout","arguments","callee","a","createElement","e","onload","resolve","gmxJSHost","insertBefore","firstChild","removeEventListener","promise","cssLoader","withCachePostfix","filename","sym","gmxDropBrowserCache","Math","random","buildGUID","publicInterface","addModule","moduleName","moduleObj","options","requiredModules","require","initDeferred","_this","r","loadModule","addModulesCallback","init","cssFiles","css","path","iF","loadCSS","doAdd","done","moduleSource","def","undefined","module","headElem","newScript","match","RegExp","pathRegexp","test","onerror","reject","type","charset","appendChild","moduleNames","getModule","setDefaultModulesHost","defaultHost","setModuleFile","moduleFile","pushModule2GlobalNamespace","p","getModulePath","createDeferredFunction","functionName","deferred","args","res","loadScriptWithCheck","filesInfo","localFilesInfo","slice","doLoad","curInfo","shift","check","forEach","script","loadScript","then","fileName","descr","$LAB","wait","cssFilename","doLoadCss","getCSS","getScript","Utils","domManipulation","_el","str","childs","attributes","el","children","attrs","_childs","_attr","_t","createTextNode","String","atr","style","setAttribute","_table","_caption","_thead","_tbody","_tfoot","_textarea","_th","_tr","_td","_span","_label","_li","_ul","_div","_radio","concat","_button","_a","_select","_option","_form","_iframe","_image","_img","_br","_hr","_p","_b","_i","_input","_","ent","prevGlobals","noConflicts","jQuery","extend","Node","prototype","removeNode","parent","parentNode","removeChild","show","elem","display","hide","hidden","visibility","visible","switchSelect","sel","value","selected","selectedIndex","parseColor","components","split","parseInt","objLength","obj","cnt","field","valueInArray","arr","getOffsetRect","box","getBoundingClientRect","body","docElem","documentElement","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","top","left","round","attachEffects","className","onmouseover","addClass","onmouseout","evt","event","relTarget","relatedTarget","toElement","removeClass","makeButton","id","inp","padding","makeImageButton","urlHover","btn","cursor","border","makeLinkButton","text","span","getOwnChildNumber","childNodes","stopEvent","cancelBubble","returnValue","stopPropagation","preventDefault","showDialog","title","content","width","height","posX","posY","resizeFunc","closeFunc","params","setMinSize","canvas","dialogParams","position","resizable","resize","ui","size","close","removeDialog","open","closeText","minWidth","minHeight","dialog","overflow","focusout","stopImmediatePropagation","support","focusinBubbles","context","st","focusin","uis","each","remove","showErrorMessage","message","removeFlag","jQueryDiv","_checkbox","flag","name","checked","insertAtCursor","myField","myValue","tinyMCE","get","execInstanceCommand","selection","focus","createRange","selectionStart","startPos","endPos","selectionEnd","uniqueGlobalName","freeid","thing","sendCrossDomainJSONRequest","callbackParamName","errorCallback","callbackName","item","sepSym","createCookie","days","expires","date","Date","setTime","getTime","toGMTString","cookie","readCookie","nameEQ","ca","charAt","eraseCookie","getWindowWidth","myWidth","innerWidth","clientWidth","clientHeight","getWindowHeight","myHeight","innerHeight","strip","s","replace","replacements","temp","rus","eng","toUpperCase","translit","result","requests","lastRequestId","uniquePrefix","processMessage","origin","dataStr","decodeURIComponent","data","dataObj","JSON","parse","request","Status","ErrorInfo","ErrorMessage","ExceptionType","StackTrace","CallbackName","iframe","addEventListener","attachEvent","parseUri","o","parser","strictMode","exec","uri","key","q","$0","$1","$2","hostOnly","host","authority","strict","loose","createPostIframe2","uniqueId","parsedURL","protocol","location","sendCrossDomainPostRequest","baseForm","form","rnd","originalFormAction","target","hiddenParamsDiv","WrapStyle","paramName","input","submit","removeAttribute","hooks","addParseResponseHook","hookFunction","parseResponse","response","customErrorDescriptions","responseHooks","h","_title","parseXML","xmlDoc","DOMParser","parseFromString","ActiveXObject","validateOnParse","async","loadXML","alert","disableSelection","onselectstart","MozUserSelect","onmousedown","stringDate","msec","isUtc","excDate","getUTCDate","getDate","excMonth","getUTCMonth","getMonth","excYear","getUTCFullYear","getFullYear","stringTime","excHour","getUTCHours","getHours","excMin","getUTCMinutes","getMinutes","excSec","getUTCSeconds","getSeconds","stringDateTime","inputError","delay","isArray","equals","x","y","toString","generateUniqueID","chars","randomstring","rnum","floor","convertColor","intColor","rgb2hex","map","hex","Number","join","checkForNumber","number","isNaN","isJSON","getDialogPos","div","offsetFlag","pos","windowHeight","offsetWidth","setMapObjectStyle","layer","styleIndex","templateStyle","hoverStyle","getStyle","outline","thickness","fill","opacity","min","newStyle","RenderStyle","L","gmxUtil","fromServerStyle","HoverStyle","labelTemplate","labelAnchor","setStyle","prepareGmxLayerStyle","convertFromServer","lowerCaseType","convertToServer","num","localDateValue","datepicker","parseDate","localValue","valueOf","timeOffset","getTimezoneOffset","resTime","parseTime","hour","minute","second","parseDateTime","login","redirect_uri","authServerBase","authServer","isHidden","oAuthServer","gmxGetServerBase","redirectUri","gmxProcessAuthentication","userInfo","features","w","handlerName","escape","screen","appendTo","parseShpFile","translationsAdded","addTranslationsLazy","_translationsHash","addtext","shpFileForm","errorMessages","_gtxt","File","FormData","formData","append","xhr","XMLHttpRequest","serverBase","status","responseText","substr","Result","send","downloadGeometry","geoJSONFeatures","objectsByType","markerIdx","format","geom","geometry","properties","coordinates","points","stringify","lines","polygons","joinPolygons","objs","polygonObjects","iC","joinClippedPolygon","polygon","origData","segmentsToJoin","joinedSegments","crossPoints","finalPolygon","equal","abs","coords","parseRing","origRing","ring","len","getNextSegment","il","segment","lastI","regularRing","startI","nextSegment","segments","findSegment","joinedSeg","seg","isReg","reverse","lastY","joinSegment","y0","minCrossPoint","parseGeometry","origComp","comp","sort","s1","s2","isExternal","finalComponent","console","log","geomToCopy","TinyReference","create","tempFlag","isIpad","navigator","userAgent","getLatLngBounds","gmxBounds","_gmx","layerID","getGeometryBounds","dataManager","getItemsBounds","array","Projection","Mercator","unproject","max","latLngBounds","DEFAULT_LANGUAGE","_parseLanguageCookie","items","langs","elems","_saveLanguageCookie","cookies","encodeURIComponent","TranslationsManager","flags","titles","hash","_errorHandlers","_language","_addTextWithPrefix","prefix","lang","newHash","fullKey","addText","getText","dictKey","getLanguage","getArg","handler","argIndex","setLanguage","language","addErrorHandler","getLanguageFromCookies","pathname","updateLanguageCookies","commonTranslationsManager","commonManager","addHanlebarsHelper","Handlebars","registerHelper","Translations","prev_gtxt","prev_translationsHash","prevTranslationsHash","translationsHash","DumpClass","gettext","bind","showLanguages","langCanvas","button","marginLeft","fontSize","onclick","GeomixerFramework","_mapHelper","reloadMap","reload","getElementById","UpMenu","submenus","currSel","currUnSel","refs","loginContainer","_isCreated","defaultHash","clicked","openedMenus","currentTopHash","hideOnClick","parents","parentsArr","toArray","isHeader","hasClass","isInsideHeader","some","hideMenus","find","_iterateMenus","addItem","draw","addChildItem","newElem","parentID","insertBeforeID","index","childElem","setParent","empty","disabledTabs","showmenu","hidemenu","_template","compile","attachEventOnClick","attachEventOnMouseover","attachEventOnMouseout","attr","click","disabled","openTab","disableMenus","checkItem","isChecked","toggleClass","removeSelections","openRef","_menuUp","isTopLevel","itemsToClose","checkInsideElem","ee","descendant","isInsideElem","em","getNavigatePath","menuIdx","submenu","childsLevel2","childsLevel3","j","enableMenus","checkView","AuthManager","isLogin","_queryMapLayers","currentMapRights","isRole","ROLE_ADMIN","canDoAction","ACTION_CREATE_LAYERS","ACTION_CREATE_MAP","go","container","createMenu","currUnsel","func","LeftPanelItem","canvasID","showCloseButton","showMinimizeButton","menuPath","getPathHTML","last","panelCanvas","isTitle","pathTR","workCanvas","isUICollapsed","toggleContentVisibility","isCollapsed","toggle","trigger","setTitle","html","leftMenu","parentWorkCanvas","createWorkCanvas","leftPanelItem","prepend","lastChild","VirtualLayerManager","_classes","gmxVirtualClasses","loader","gmx","classInfo","file","layerClass","Plugin","pluginName","mapPlugin","isPublic","lazyLoad","usageState","isLoading","setUsage","usage","isUsed","updateParams","newParams","PluginsManager","_plugins","_pluginsWithName","joinedPluginInfo","_defaultPlugins","info","gmxPlugins","plugin","_genIterativeFunction","funcName","leafletMap","error","stack","f","loadingPlugins","where","count","always","beforeMap","preloadMap","beforeViewer","afterViewer","addMenuItems","upMenu","menuItems","forEachPlugin","setUsePlugin","isInUse","getPluginByName","DrawingObjectCustomControllers","_delegates","addDelegate","delegate","isSerializable","BaseLayersControl","blm","availContainer","mapContainer","constructItem","activeIDs","getActiveIDs","getAll","baseLayer","updateBaseLayers","setActiveIDs","sortable","connectWith","stop","GroupVisibilityPropertiesModel","Backbone","Model","defaults","isChildRadio","isVisibilityControl","isExpanded","GroupVisibilityPropertiesView","model","showVisibilityCheckbox","showExpanded","_model","boxSwitch","radioSwitch","showCheckbox","set","ret","addSubGroup","layersTree","ul","_abstractTree","getChildsUl","newIndex","groupVisibilityProperties","groupVisibilityPropertiesControls","elemProperties","gmxProperties","newName","inputIndex","createSubGroup","parentProperties","newGroupProperties","list","ShowCheckbox","expanded","initExpand","GroupID","li","_layersTree","getChildsList","getLayerVisibility","addDraggable","addDroppable","addSwappable","addTreeElem","childsUl","addNode","updateListType","loaded","dialogDiv","updateUnloadEvent","on","keyCode","marginTop","parentDiv","trs","trsControls","createPropertiesTable","leftWidth","propsTable","createGroupEditorProperties","isMap","mainLayersTree","rawTree","treeModel","getRawTree","visibilityProperties","visibilityPropertiesView","updateNodeVisibility","findTreeElem","curBox","isDummyCheckbox","onkeyup","addProperties","shownProperties","useAPI","UseKosmosnimkiAPI","useOSM","UseOpenStreetMap","defLang","distUnit","squareUnit","coordinatesFormat","maxPopupCount","layerOrder","downloadVectors","CanDownloadVectors","downloadRasters","CanDownloadRasters","WMSLinks","services","site","mapsSite","mapName","MapID","upper","WMSAccess","defLat","DefaultLat","defLong","DefaultLong","defPermalink","ViewUrl","defZoom","DefaultZoom","onLoad","copyright","Copyright","minViewX","MinViewX","minViewY","MinViewY","maxViewX","MaxViewX","maxViewY","MaxViewY","minZoom","MinZoom","maxZoom","MaxZoom","mappletLoader","DefaultLanguage","DistanceUnit","SquareUnit","val","maxPopupContent","LayerOrder","change","distanceUnit","locationControl","gmxControlsManager","setCoordinatesFormat","verticalAlign","shownCommonProperties","shownPolicyProperties","shownViewProperties","tabMenu","divCommon","divBaseLayers","divPolicy","divSearch","divView","divOnload","divPlugins","gmxBaseLayersManager","pluginsEditor","createPluginsEditor","mapPlugins","mapLayersTree","allowActive","allowDblClick","showStyle","visibilityFunc","props","isVisible","origTreeNode","findElem","LayerID","AllowSearch","searchRawTree","cloneRawTree","node","mapLayersDOM","drawTree","treeview","updateFunc","update","closeParamsDialogs","_groupEditorsHash","createGroupEditor","_mapEditorsHash","createMapEditor","activePage","tabs","active","Controls","createColorPicker","color","showFunc","hideFunc","changeFunc","colorPicker","ColorPicker","onShow","onHide","onChange","createGeometryIcon","parentStyle","icon","newStyles","pattern","opaqueStyle","patternData","getPatternIcon","fillColor","color2Hex","fillOpacity","borderOpacity","borderTop","borderBottom","borderLeft","oncontextmenu","createSlider","divSlider","slider","step","slide","zIndex","backgroundImage","background","createInput","chooseDrawingBorderDialog","TYPE_CONVERT_DICT","Polyline","MultiPolyline","Rectangle","Polygon","MultiPolygon","Point","_params","geomType","errorTitle","errorMessage","drawingObjs","gmxDrawing","getFeatures","getType","drawing","collection","DrawingObjectCollection","Add","DrawingObjectList","allowDelete","editStyle","showButtons","drawingObject","jDialog","CollapsibleWidget","titleElem","managedElems","collapseTagIcon","_isCollapsed","updateElems","iE","updateView","addManagedElements","showLayerInfo","typeSpans","contentText","innerHTML","typeSpan","Legend","legend","dialogTitle","TagMetaInfo","loadFromServer","tagInfo","isTag","getTagDescription","getZoomValue","zoomControl","isNotValid","checkZoom","minZoomInput","maxZoomInput","minVal","maxVal","ZoomPropertiesControl","liMinZoom","liMaxZoom","getMinLi","getMaxLi","getMinZoom","getMaxZoom","mode","theme","plugins","convert_urls","theme_advanced_buttons1","theme_advanced_buttons2","theme_advanced_buttons3","theme_advanced_statusbar_location","theme_advanced_toolbar_location","theme_advanced_toolbar_align","applyBalloonDefaultStyle","BalloonEnable","DisableBalloonOnClick","DisableBalloonOnMouseMove","FillStyleControl","initStyle","showSelectors","_fillStyle","image","colors","selectorDiv","colorContainer","patternContainer","imagePatternContainer","colorIcon","patternIcon","patternURLIcon","controls","control","initFillStyle","activeFillType","selectorIconsDiv","fillColorPicker","colpkr","fadeIn","fadeOut","hsb","backgroundColor","fillOpacitySlider","patternURL","mapHelper","ImageInputControl","getControl","patternTypeIcons","patternStyleSelector","patternOpacity","patternOpacitySlider","patternOpacityContainer","widthIcon","stepIcon","widthInput","stepInput","widthStepInputs","PatternColorControl","initColors","_parentDiv","_colors","_redraw","table","deleteIcon","addIcon","initColor","getColors","patternColorSelector","patternColorControl","fillControlsDiv","getSelector","getControls","getFillStyle","fillStyle","setVisibleSelectors","createFilterEditorInner","filter","elemCanvas","filterText","setFilter","filterNum","gmxMap","layersByID","Filter","layerName","attrSuggestWidget","AttrSuggestWidget","attrValues","suggestCanvas","getFilter","createFilterEditor","filterParam","_balloonEditorId","createBalloonEditor","balloonParams","identityField","textareaID","balloonText","setBalloon","getBalloonState","defaultBalloonText","sortAttrs","br","boxClick","boxMove","onAddEditor","add","mgr","ed","onKeyUp","onClick","suggestWidget","Balloon","SuggestWidget","divAttr","setDefaultBalloonText","setContent","getBalloon","getContent","getBalloonEnable","getBalloonDisableOnClick","getDisableBalloonOnMouseMove","state","_labelEditorId","createFilter","geometryType","ulParent","treeviewFlag","makeStyle","zoomPropertiesControl","ulfilterExpr","liLabel","ulLabel","liBalloon","ulBalloon","liStyle","ulStyle","fontSizeInput","label","xShiftInput","yShiftInput","checkedLabelColor","checkedLabelHaloColor","haloColor","checkedFontSize","checkedXShift","checkedYShift","backupLabel","dx","dy","labelColor","labelHaloColor","labelText","keys","updateLabelText","matches","key1","filterEditor","balloonEditor","bindChangeEvent","resObject","symbolsTitle","styleLibIcon","showStyleLibraryDialog","activeStyleManager","styleFromLib","getActiveStyle","createStyleEditor","isWindLayer","description","getClusterStyle","clusterControl","removeColorPickers","updateFilterMoveButtons","upButton","downButton","removeButton","attachLoadingFilterEvent","filterCanvas","ulFilterParams","updateTinyMCE","createFilterHeader","filtersCanvas","addButton","setNodeVisibility","lastStyle","styles","defaultStyle","setStyles","getStyles","createLoadingFilter","GeometryType","swapFilters","firstNum","filters","newFilters","before","openedFlag","nameInput","Name","liFilter","ulFilter","clusters","addFilterParams","filterParams","moveUp","moveDown","margin","filtersParent","hideStyle","updateStyles","newFilterStyle","filterValueElem","filterValue","balloonValueElem","clusterStyle","markerSizeParent","outlineParent","fillParent","iconParent","outlineTitleTds","fillTitleTds","iconTitleTds","outlineTds","fillTds","iconTds","inputUrl","fillToggle","outlineToggle","iconToggle","showIcon","showMarker","angle","scale","fillStyleControl","marker","center","outlineColor","outlineThick","dashInput","dashes","dashSelect","borderValues","dashSelector","dashTable","dashedTds","dashFunc","correct","dashTrs","dashTds","dashTd","onfocus","onblur","borderValue","checkedFillColor","checkedFillOpacity","fillSlider","markerSizeInput","markerSizeTds","markerColor","topPadding","LayerStylesEditor","divStyles","openedStyleIndex","parentIcon","filterHeader","layerStyles","getUpdatedStyles","getStyleCount","setAllFilters","createStylesDialog","treeView","buildedTree","layerStylesHash","_styles","styleEditor","_MinZoom","attributesHash","LazyAttributeValuesProviderFromServer","multiStyleParent","multiFiltersFlag","colorIconFlag","newIcon","createStylesEditorIcon","createMultiStyle","divDialog","execCommand","styleContainer","styleDialogs","updateAllStyles","userObjectsManager","_data","_collectors","setData","getData","collect","load","dataCollectorNames","collectors","dc","addDataCollector","collectorId","collector","LanguageSelector","LANGUAGES","template","newLang","prevLang","siblings","getLang","queryTabs","builded","tabsCanvas","axis","tolerance","containment","orderedTabs","tabInfo","tabIndex","isNew","name_rus","description_rus","name_eng","description_eng","uiTemplate","titleLoc","descrLoc","buttonTitle","titleInput","updateDataLoc","langControl","keyup","createTab","mapState","getMapState","tab","selectValLoc","tmpl","eq","replaceWith","parsedState","lmap","setView","point","z","drawnObjects","geometryToGeoJSON","setCurrentID","getIDByAlias","rawColor","dec2hex","addGeoJSON","lineStyle","weight","applyState","condition","mapStyles","customParamsCollection","customParamsManager","loadParams","openPopups","l","addPopup","_queryTabs","mapHelp","queryExternalMaps","maps","loadedMaps","hostButton","nameButton","loadButton","addMap","paramsTable","addMapElem","mapsCanvas","hostName","silent","mapElem","mapInfo","extLayersTree","forEachLayer","external","removeLayer","loading","loadMap","tree","runLoadingFuncs","getMapProperties","apiKey","srs","isGeneralized","mapOptions","skipTiles","layers","getGmxProperties","addLayer","copyrightLayer","attribution","onAdd","onRemove","addTo","_queryExternalMaps","triggerHandler","externalMaps","drawingObjects","editStyleTitle","removeObject","pointTitle","lineTitle","polygonTitle","rectangleTitle","removeAll","downloadShp","downloadGeoJSON","downloadGpx","downloadCsv","downloadNameTitle","download","downloadRaster","noRectangleError","noRasterError","edit","transparency","lineWidth","setDrawingFeatureStyle","drawingFeature","setOptions","pointStyle","CreateDrawingStylesEditorIcon","CreateDrawingStylesEditor","parentObject","jQueryDialog","borderColor","toGeoJSON","_leaflet_id","_objects","onEdit","Remove","Item","Count","editID","removeID","RemoveAt","getIndex","DrawingObjectInfoRow","oInitMap","oInitContainer","defaultClickFunction","_map","getZoom","fitBounds","getBounds","_options","_drawingObject","_canvas","_text","_summary","lineOptions","GmxDrawing","utils","defaultStyles","regularDrawingStyle","isRectangle","_mouseOverHandler","_mouseOutHandler","UpdateRow","summary","getSummary","RemoveRow","off","getContainer","ContextMenuController","bindMenuToElem","getDrawingObject","oInitDrawingObjectCollection","_rows","_containers","_collection","_divList","_divButtons","divRow","row","mouseover","mouseout","removedDiv","_selectedIndex","Clear","GetDivButtons","delAll","setSelection","isValidIndex","getSelection","DrawingObjectGeomixer","oMap","oMenu","oListDiv","bVisible","oCollection","Unload","Load","alreadyLoaded","fnAddToCollection","ev","feature","object","checkDownloadVisibility","isAnyRectangle","isNonPolygon","downloadContainer","downloadFormat","downloadNameContainer","downloadNameInput","downloadNameButton","downloadMarkers","downloadRasterOptions","checkInfo","checkRasterLayer","bounds","temporalParam","Temporal","dateInterval","getDateInterval","dateBeginStr","beginDate","dateEndStr","endDate","truncate9","href","getWest","getSouth","getEast","getNorth","Init","initGmxMap","oDrawingObjectList","geoms","getCenter","testPolygon","latlng","testRing","isInside","x1","y1","x2","y2","lng","lat","iLayerN","layerBounds","isProperType","IsRasterCatalog","hasLayer","isValid","contains","getGeometry","bIsPolygonBad","createMultiLayerEditorNew","doCreateMultiLayerEditor","createMultiLayerEditorServer","MultiLayerID","elemPropertiesFull","Properties","Layers","isReadonly","layerRights","commonLayersListDiv","selectedLayersDiv","selectedLayersTable","ScrollTable","suggestLayersControl","LayerManagerControl","fixType","enableDragging","getDataProvider","addOriginalItem","disableLayers","uiSelectedRowTemplate","createTable","iconClass","filterOriginalItems","enableLayers","vals","getOriginalItems","setOriginalItems","_fields","propertiesDiv","isCreatedDrawing","borderContainer","shpContainer","borderLink","shpBorderLink","borderTr","fileInput","onchange","postForm","joinedPolygon","pluck","bindPolygon","geometryInfoRow","InfoRow","UserBorder","tr","getUserBorder","geoJSONtoGeometry","isCreate","saveButton","errorElems","selectedItems","updateInfo","Title","Description","LayersChanged","MultiLayerInfo","layerDiv","newLayerProperties","layerData","addLayersToMap","divParent","divProperties","dialogContainer","zoomSource","setZoomBounds","prop","serviceHelp","defaultPhotoIconStyles","stylesDialogsHash","drawingDialogsHash","layerEditorsHash","customErrorsHash","drawingBorders","_borders","editListener","isChanged","updateBorder","areaStr","prettifyArea","geoArea","removeRoute","removeDrawing","unsavedChanges","_providers","loadProviderState","provider","loadState","saveParams","saveState","addProvider","isProvider","providerName","findWhere","removeProvider","givenStyle","PointSize","Icon","baseAddress","BorderColor","BorderWidth","FillColor","Transparency","Label","FieldName","FontColor","FontSize","getMapStateAsPermalink","userObjects","permalinkID","defaultMapID","globalMapName","onbeforeunload","enableHoverBalloon","getGeometrySummary","updateMapStyles","updateTreeStyles","isEditableStyles","gmxStyles","addTitle","restoreTinyReference","callbackSuccess","suppressDefaultPermalink","latLngPos","originalReference","drawings","featureCollection","LayersTreePermalinkParams","mercCenter","project","exportRect","geoJSON","getOptions","getPopup","isBalloonVisible","getPopups","popups","findTreeElems","groupId","changedByViewer","permalinkParams","dateIntervals","isTemporalLayer","VectorLayer","setDateInterval","getCurrentID","getMapStyles","isFullScreen","layersShown","findChilds","child","showPermalink","createPermalink","select","createExportPermalink","ImageSelectionWidget","View","tagName","events","imagesDir","getUserFolder","_fileBrowser","createBrowser","relativePath","getLogin","startDir","restrictDir","initURL","prevValue","mainDiv","ACTION_UPLOAD_FILES","imageSelectionWidget","parentStyles","iconUrlProp","iconUrl","fixFunc","scaleX","scaleY","createLoadingLayerEditorProperties","layerProperties","createLayerEditor","createNewLayer","TilePath","Path","ShapePath","doneCallback","clipLayer","sw","latLng","nw","ne","se","clip","addClipPolygon","td","tdTitle","leftcolumnclass","rightcolumnclass","trid","trclass","selectTab","createTabs","additionalTabs","createdCallback","layerEditor","columns","Columns","createWFSStylesEditor","divCanvas","regularStyle","spanIcon","listenerId","addListener","canvasStyles","canvasCharts","layerElemCanvas","graphDataType","graphDataProperties","removeMapStateListener","divGraph","createChartsEditor","graphTypeSel","propertiesMask","layerManagerFlag","ulFilters","checkbox","iconSpan","bindCheckboxHandler","styleVisibilityProps","gmxViewerUI","usageFilePrefix","_loadHelpTextFromFile","proceess","gmxVersion","gmxData","ajax","success","version","helpFilePrefix","GeomixerFrameworkVersion","print","centerControl","toggleMode","isPreviewMode","setActive","printMode","removeFrom","BIG","SMALL","layout","invalidateSize","resizeAll","exportMap","exportMode","grid","gridManager","gridControl","setState","isActive","exportBounds","setFixBounds","_southWest","_northEast","cs","removeControl","exportCssParams","treeElem","childsArr","modifyObjectLayer","crs","action","LayerName","objects","geometry_cs","addResponse","mapLayer","layersVersion","chkVersion","searchObjectLayer","requestParams","query","includeGeometry","page","pagesize","values","fields","downloadVectorLayer","t","unload","_serviceHelper","serviceHelper","servicesFilePrefix","ROLE_USER","ROLE_GUEST","ROLE_UNAUTHORIZED","ACTION_SAVE_MAP","ACTION_CHANGE_MAP_TYPE","ACTION_SEE_OPEN_MAP_LIST","ACTION_SEE_PRIVATE_MAP_LIST","ACTION_SEE_MAP_RIGHTS","ACTION_SEE_FILE_STRUCTURE","ACTION_SEE_ALL_USERS","ACTION_SEE_USER_FULLNAME","_actions","_userInfo","Login","getNickname","Nickname","getFullname","FullName","Folder","role","Role","isAccounts","IsAccounts","setUserInfo","checkUserInfo","_processResponse","resOk","iProvider","checkProviders","canAuth","doAuth","gmxAuthServer","callbackPath","doAuthServerLogin","Token","password","pass","emailWarning","Message","logout","changePassword","oldPass","newPass","msg","token","addCheckUserMethod","GmxWidgetMixin","_container","_previousStyleDisplayValue","_terminateMouseEvents","DomEvent","disableClickPropagation","GmxWidget","Templates","DropdownMenuWidget","PlainTextWidget","initialize","txt","setText","$el","DropdownWidget","direction","adjustWidth","showTopItem","titleClassName","$titleContainer","$dropdownContainer","$dropdownTitle","expand","collapse","_items","inst","$container","je","currentTarget","_sortItems","_expanded","reset","containerEl","Array","call","titleEl","maxPositionIndex","registerPartial","anchor","_view","dropdownMenuWidget","mouseIsOver","placeholder","HeaderWidget","SocialShareWidget","socials","addDots","leftLinks","rightLinks","warn","getAuthPlaceholder","getMenuPlaceholder","getSearchPlaceholder","getLanguagePlaceholder","getSocialsPlaceholder","header","LanguageWidget","cb","hasOwnProperty","ar","first","IconLayers","Control","includes","Evented","Mixin","Events","_getActiveLayer","_activeLayerId","_layers","_getPreviousLayer","activeLayer","_previousLayerId","_getInactiveLayers","activeLayerId","previousLayerId","_arrangeLayers","behaviors","previous","unshift","behavior","_getLayerCellByLayerId","els","getElementsByClassName","_createLayerElement","layerObj","DomUtil","titleContainerEl","checkIconEl","_createLayerElements","currentRow","layerCell","maxLayersInRow","_expandDirection","_onLayerClick","layerId","setActiveLayer","_attachEvents","layersRowCollection","onMouseEnter","onMouseLeave","_render","_switchMapLayers","previousLayer","layerObject","autoZIndex","manageLayers","Util","setLayers","stamp","fire","Tooltip","element","enabled","timeout","hoverState","$element","VERSION","TRANSITION_DURATION","DEFAULTS","animation","placement","selector","viewport","$viewport","triggers","proxy","eventIn","eventOut","enter","leave","fixTitle","getDefaults","getDelegateOptions","self","constructor","$tip","is","clearTimeout","that","hasContent","_toBeShown","_preloadImages","doShow","$images","srcs","promises","img","Image","when","Event","inDom","ownerDocument","isDefaultPrevented","tip","tipId","getUID","autoToken","autoPlace","detach","insertAfter","getPosition","actualWidth","actualHeight","offsetHeight","orgPlacement","containerDim","bottom","right","calculatedOffset","getCalculatedOffset","applyPlacement","complete","prevHoverState","transition","one","emulateTransitionEnd","offset","setOffset","using","delta","getViewportAdjustedDelta","isVertical","arrowDelta","arrowOffsetPosition","replaceArrow","dimension","isHorizontal","arrow","getTitle","removeAttr","$e","isBody","elRect","elOffset","scroll","outerDims","viewportPadding","viewportDimensions","topEdgeOffset","bottomEdgeOffset","leftEdgeOffset","rightEdgeOffset","$arrow","enable","disable","toggleEnabled","destroy","removeData","option","$this","old","fn","tooltip","Constructor","noConflict","Popover","Error","end","popover","gmxIconLayers","zoominpls","zoomoutpls","GmxIconLayers","_updateLayers","_baseLayersManager","_updateDisabledLayers","_disabledLayerIds","_updateDisabledLayersStyle","elId","_updatePopoversContent","defaultTemplate","createPopover","outerHTML","layerEl","shutterEl","le","DateInterval","getUTCDayBoundary","dateBegin","dateEnd","MS_IN_DAY","toMidnight","midnight","defaultFireDateInterval","now","lastMidnight","isTooSmall","CalendarWidget","Calendar","_shiftDates","minimized","showSwitcher","dateMax","dateMin","dateFormat","_dateMin","_dateMax","_dateInterval","moreIconClass","moreIconTitle","forecast","_moreIcon","_dateBegin","_dateEnd","_dateInputs","onSelect","dateText","_selectFunc","_updateModel","showAnim","changeMonth","changeYear","minDate","toUTC","maxDate","defaultDate","showOn","buttonImage","buttonImageOnly","setMode","SIMPLE_MODE","ADVANCED_MODE","_updateWidget","getDateBegin","getDateEnd","newDateBegin","newDateEnd","activeInput","begin","dateToFix","_curMode","dayms","prevDateBegin","prevDateEnd","vismode","getMode","fromUTC","getDateMax","getDateMin","setDateMin","setDateMax","titleContainer","utcDate","setSwitcherVisibility","isSimple","ExtendedViewTitle","MinimalViewTitle","UTC","FireCalendarWidget","timeTitlePrefix","timeTitleLastPrefix","timeTitlePostfix","n","getStr","hours","minutes","_updateInfo","origDateEnd","currentDayMode","CalendarWidget1","isSimpleMode","ceil","hoursStr","dateEndToShow","ShowIconTitle","createDateInterval","resetDateInterval","selectDateInterval","from","to","CalendarModel","dailyFilter","Calendar1","showCalendar","manuallyChangeDateInterval","jumpByArrow","_opened","setDefaults","constrainInput","calendarTemplates","beginTemplate","endTemplate","hourBegin","hourEnd","showCalendarIconClass","showCalendarIconTitle","listenTo","enableDailyFilter","SVGAnimatedString","_selectTime","beginInput","endInput","oneDayPeriod","parsed","timeBeginValue","timeEndValue","_checkValue","msBeginInputValue","convertTimeValueToMs","msEndInputValue","msBegin","msEnd","endMidnight","beginCalendar","endCalendar","createIntervalButton","resetIntervalButton","selectIntervalButton","beginDialogOptions","dialogClass","draggable","endDialogOptions","_enableCreateIntervalButton","beginTimeValue","endTimeValue","calendarDateBegin","calendarDateEnd","diff","timeBegin","timeEnd","formatDate","prefixTimeValue","source","sourceElem","strEnd","blur","setSelectionRange","_showCalendarIcon","month","day","year","ms","CommonCalendarWidget","Timeline","sync","daily","all","calendarWidgetTemplate","CommonCalendarModel","currentLayer","calendar","isAppended","unbindedTemporalLayers","dailyFiltersHash","synchronyzed","CommonCalendar","updateSync","handleFiltersHash","applyDailyFilter","updateVisibleTemporalLayers","_fillFiltersHash","_clearFiltersHash","setCurrentLayer","oldBegin","oldEnd","updateTemporalLayers","changeCurrentLayer","int","toJSON","replaceCalendarWidget","newCalendar","_calendar","_isAppended","doChange","calendarDiv","getContainerAfter","getContainerBefore","loadDeferred","calendarCanvas","commonCanvas","bindLayer","clone","variable","unbindLayer","removeLayerFilter","_updateOneLayer","maxShownPeriod","msecPeriod","layersMaxDates","localeDate","DateEnd","onDateIntervalChanged","layersList","temporalLayers","widget","selectmenu","_renderItem","di","dateBeginToMidnight","_renderMenu","_renderItemData","temporallayersmenu","_filtersView","layerFilters","toggleSync","setSyncMode","Boolean","listContainer","toggleDailyFilter","setDailyFilter","getDataManager","dm","dmOpt","fullDays","intervals","tmpKeyNum","tileAttributeIndexes","TemporalColumnName","addLayerFilter","itemDate","inside","ClipboardController","_clipboard","popItem","pop","getCount","UPDATE_INTERVAL","sendGmxRequest","requestType","processResponse","TaskID","notify","taskID","interval","setInterval","clearInterval","Completed","paramStrItems","localParams","asyncTaskManager","sendGmxJSONPRequest","sendGmxPostRequest","AttrTable","DefaultSearchParamsManager","_activeColumns","_queryTextarea","_searchValue","_valueTextarea","_setValue","_updateQueryTextarea","_setUpdateQueryValue","_geometryInfoRow","drawSearchUI","attributesTable","getLayerInfo","hideButtonContainer","hideButton","tableTd","nextSibling","originalButton","middleContainer","geomUIContainer","drawGeomUI","oninput","attrNames","attrHash","attrProvider","suggestionCallback","currentTextArea","setCallback","buttonsContainer","searchButton","cleanButton","drawUpdateUI","currentColumnName","selectColumnContainer","attrsTemplate","attrsUI","setActiveTextArea","statusBar","applyButtonContainer","applyButton","spinHolder","spinErrorMessage","updateQuery","whereQuery","addGeomQuery","fetch","method","credentials","toJson","resCallback","catchErr","json","_serverDataProvider","getQuery","geomStr","resQuery","geomUI","onGeometrySelectButtonClick","getActiveColumns","ServerDataProvider","defaultSortParam","titleToParams","_countURL","_dataURL","_countParams","_dataParams","_lastCountResult","getItems","pageSize","sortParam","sortDec","explicitSortParam","orderby","orderdirection","fieldsSet","types","setRequests","countURL","countParams","dataURL","dataParams","serverChanged","getLastCountResult","SquareCalc","dataProvider","searchParamsManager","popoverUI","totalSquare","attrsTable","layerTitle","filterData","activeColumns","_updateVersionHandler","_isLayerOnMap","tableFields","fieldsAsArray","fieldsAsHash","titleToField","fieldParams","_layerInfo","getInfo","origCanvas","outerSizeProvider","_layerColumns","Value","Alias","drawDialog","_updateSearchString","createColumnsList","paramsManager","_activeColumns_","columnsList","attrTitles","presentColumns","showColumnsTemplate","selectColumnsUI","rowTemplate","columnName","rowUI","localStorage","setItem","hideDownload","hideActions","hideRowActions","hideSearchParams","getItem","paramsWidth","tdParams","findObjectsButton","updateObjectsButton","addObjectButton","changeFieldsListButton","oldCanvasWidth","downloadSection","isPolygon","Access","downloadLayer","createEditorFromSelection","filteredColumns","col","MetaProperties","SourceType","Quicklook","copy","sourceLayerName","copyLayerParams","squareLink","queryChange","columnsChange","table2","activateField","columnsForServer","marginRight","EditObjectControl","fielsWidth","attrNamesHash","divTable2","selectAllItems","selectedCount","selectedDelete","showColumnsListButton","selectedCopy","selectedCont","groupBox","getVisibleItems","it","_selected","chkSelectedCount","repaint","Object","reduce","clearSelected","manageSection","tdTable2","pagesCount","limit","prevLimit","drawTableItem2","curIndex","activeHeaders","tds","showButton","editButton","deleteItem","tdControl","columnNames","fitBoundsOptions","tempColumn","datems","widgets","commonCalendar","fieldName","valIndex","textAlign","setDataProvider","tbl","Browser","ie","gecko","lastSTop","onscroll","ths","translate","dialogWidth","dialogHeight","updateHeight","attrsTableHash","_hookID","hookInfo","hook","newAttrsTable","addHook","paramsHook","removeHook","hookID","_attrsTableHash","createAttributesTable","addAttributesTableHook","removeAttributesTableHook","security","ownerName","defAccess","access","no","view","linkview","editrows","preview","share","addHeaderLabel","addOkText","usersHash","currentSelectedItem","autocompleteLabelTemplate","wrapUserListInput","autocomplete","cbResponse","findUsers","term","maxRecords","userInfos","isGroup","IsGroup","templateParams","SecurityOwnerWidget","securityInfo","Owner","ownerAddInput","doChangeUser","user","NewOwnerID","UserID","SecurityUserListWidget","sortFuncs","genSortFunction","fieldNames","fieldWidthes","_securityTable","showFooter","securityUsersProvider","StaticDataProvider","setSortFunctions","arg","_drawMapUsers","addInput","isEmail","searchObj","addedUsers","doAddUser","_addMapUser","curUserInfo","Users","DEFAULT_ACCESS","existedUser","_userRowTemplate","securityScope","Fullname","accessTypes","mapTypeSel","mapAccessSel","defaultAccess","getSecurityName","updateSecurityName","propertyValue","mapSecurity","propertyName","layerSecurity","layerType","multiLayerSecurity","layersGroupSecurity","getGroupSecurityName","groupPropertyName","mapLayers","mapLayersSecurityArray","selectedLayersSecurityArray","originalItems","getSecurityFromServer","getGroupSecurityFromServer","postParams","getRights","createSecurityDialog","addCustomUI","defAccessTemplate","defAccessTypes","isSelected","SecurityInfo","DefAccess","saveCustomParams","_securityInfo","_ui","_save","si","securityUserListWidget","notifications","startAction","stopAction","showOwner","mapTableHeight","nonTableHeight","_dialogDiv","maxRecordsParamStr","typeParamStr","UsersAdd","UsersRemove","findRemovedUsers","updateselectedLayersSecurity","ID","updateSecurity","multiLayer","original","changed","difference","counter","actualCounter","countDiv","countTemplate","templateSecurityInfo","drawnTree","defAccessDiv","userList","getMapLayersRights","saveMapLayersRights","drawAccess","drawDefaultAccess","drawUsersList","defTemplateJSON","checkSameLayersType","getAccessTypes","checkSameDefaultAccess","checkSameUsersAccess","every","userArray","findCommonUsers","sortArraysByLength","obj2","isEqual","_menuItems","SUGGEST_TIMEOUT","_context","menuFunc","checkFunc","menu","contextMenu","pageX","clientX","pageY","clientY","menuArea","_contextClose","_generateMenuDiv","visibleItems","menuElem","separator","isSeparatorBefore","itemIndex","contentMenuArea","contentMenuType","clickCallback","addContextMenuElem","menuItem","menuType","securityDialog","parentTree","removeTreeElem","delNode","RCAddLayerControl","copyLayerName","copyLayerQuery","fail","progress","applyStyleContentMenuItem","stylesType","findElemByGmxProperties","layerContent","findUITreeElem","removeGroup","layersFlag","layersRights","forEachNode","modulePath","appendTranslations","scrollTable","start","reportStart","drawFunc","_requestID","_pageVals","_currValsCount","_dataProvider","next","marginBottom","_drawPagesRow","tableBody","tableParent","_status","_state","me","statusContainer","limitSel","_drawTable","_drawHeader","_drawRows","_getActiveFields","activeFields","tableCount","cntStr","_drawPages","tablePages","link","_updatePageData","getCountAndItems","requestID","currentSortType","currentSortIndex","allPages","headerElemFactory","_isWidthScroll","isSortable","sortType","setSortParams","_tableHeaderRow","baseWidth","fieldsWidths","sortableFields","isWidthScroll","tableLimit","tableHeader","setPage","iPage","sortDirection","getSortDirection","getSortType","originalData","_vals","_filteredVals","_isFiltered","_predicate","_filterVals","_sortFunctions","_filter","filterElem","_update","getCountDirect","getItemsDirect","nMin","nMax","sortDirIndex","sortedVals","filterFunction","newOrigData","addOriginalItems","itemArr","attachFilterEvents","inputField","predicate","addFilter","setFilterValue","attachSelectFilterEvents","selectField","sortFunctions","genAttrSort","attrName1","attrName2","av","bv","MapsManagerControl","_activeIndex","_mapsTable","_mapPreview","_resize","_drawMapsDialog","_previewMapName","mapsTable","mapPreview","mapsList","searchUITemplate","searchCanvas","mapNameInput","mapOwnerInput","sign","n1","n2","sortFuncFactory","f1","f2","idFunc","titleFunc","ownerFunc","dateFunc","LastModificationDateTime","_drawMaps","inputPredicate","fieldValue","numItems","firstItem","mapIndex","mapsManager","img_url","_loadMapJSON","confirm","_deleteMapHandler","modificationDateString","normalizeHostname","gmxMapManager","getMap","gmxSkipTiles","previewLayersTree","clickDiv","hint","MapPlugins","normalizeParams","addPlugin","pluginParams","onlyParams","nameIndex","isExist","getPluginParams","setPluginParams","updateGeomixerPlugins","pluginsManager","save","GeomixerPluginsWidget","DEFAULT_GROUP_NAME","_allPluginGroups","configGroups","gmxPluginGroups","groupByPluginName","groupOrder","group","groupName","isListActive","filteredGroups","pluginGroupTemplate","pluginsTree","groups","ctrlKey","pluginInput","sp","paramsWidgets","MapPluginParamsWidget","FakeTagMetaInfo","getTagType","getTagArray","getTagArrayExt","fakeTagMetaInfo","tagInitInfo","layerTags","LayerTagsWithInfo","LayerTagSearchControl","eachValid","tagid","tag","closeDialog","MapPluginsWidget","_mapPlugins","render","pluginsToShow","isCommon","widgetContainer","allPluginsContainer","_messagesToShow","_messageTimer","_currentStatusClass","actionId","_initContainerLazy","_checkMessages","statusClass","initTagsInfo","tags","Type","desc","extendClass","base","sub","ctor","LayerTags","initTags","_uniqueID","_tags","addNewTag","_verificationFunctions","_isValidTypeValue","updateTag","deleteTag","tagId","allowUnknownTags","isValidValue","isEmptyTag","newId","getTag","getTagByName","getTagIdByName","tagMetaInfo","getTagMetaInfo","isKnownTagname","tagname","inputWidth","tagHeader","valueHeader","mainTable","rows","rowsVector","updateInput","valueInput","timepicker","datetimepicker","timeFormat","showSecond","timeOnly","validateRow","addNewRow","tagInput","minLength","updateModel","trim","deleteButton","moveEmptyLayersToBottom","lastEmptyId","irow","isAnyEmpty","LayersListProvider","filtersProvider","getQueryText","filterStrings","getOwner","getTypes","typeFilters","getTags","sortParams","drawLayers","removeLayerFromList","mapProperties","drawNode","cloneNode","tdRemove","copyHandler","deleteLayerHandler","ondblclick","helper","dummyNode","cursorAt","nameDivInternal","nameDiv","layerOwner","typeSel","_disabledLayers","sortColumns","tagsParent","LayersFilterParams","prevLayerName","prevLayerOwner","pi","_layerTags","setTags","tagsInfo","layersListProvider","layersTable","curParams","getScrollTable","layerNames","AbstractTree","makeSwapChild","swapClass","newNodeCanvas","newSubTree","addExpandedEvents","replaceClass","swapNode","after","renderParams","_renderParams","groupLoadingFuncs","_treeCanvas","_layerViewHooks","addLayerViewHook","_applyLayerViewHooks","layerProps","tempTree","LayersTree","_mapTree","initVisible","updateVisibilityUI","searchRes","parentParams","parentVisibility","addLoadingFunc","root","parentCanvas","grId","clickFunc","divClick","drawLayer","drawHeaderGroupLayer","drawGroupLayer","getActive","activeDiv","getMinLayerZoom","minLayerZoom","layerZoomToExtent","currentZoom","doubleClickZoom","getBoundsZoom","timer","treeNode","dbclickFunc","spanParent","spanDescr","imgIconSrc","borderDescr","metaProps","tagtype","StyleManager","decodeOldStyles","timelineIcon","toServerStyle","CreateTimelineIcon","resElems","conf","disabledSrc","enabledSrc","removeTitle","toggleIcon","classList","tlc","timeLineControl","addControl","LatLngBounds","groupNode","anyChildren","divDestination","spanSource","moveHandler","updateZIndexes","searchStr","chB","curZIndex","setZIndex","divSource","parentElem","swapHandler","divElem","swapFlag","addToMap","isFromList","copyFunc","IsPhotoLayer","addLayerToTree","targetDiv","checkGroupForDuplicates","elements","alreadyOnMap","DEFAULT_VECTOR_LAYER_ZINDEXOFFSET","propsHostName","layerOnMap","createLayer","zIndexOffset","updateZIndex","rcMinZoom","RCMinZoomForRasters","setZIndexOffset","getParentParams","listFlag","skipVisible","newBox","queryMapLayers","buttonsCanvas","addLayers","mapLayersParam","visFlag","equalStyles","style1","style2","treeCanvas","droppable","accept","drop","_droppableHandler","applyOpacityToRasterLayers","setRasterOpacity","rasterLayersSlider","addUserActions","removeUserActions","removeDraggable","removeDroppable","removeSwappable","circle","layerManager","prev","isFromExternalMaps","hoverClass","greedy","swapElem","_swapHandler","over","out","asyncCreateLayer","taskDiv","taskInfo","newLayer","newProps","convertedCoords","convertGeometry","asyncUpdateLayer","recreateLayer","origGeometry","convertedGeometry","checkedLayer","asyncCopyLayer","getLayers","createLayersManager","layerManagerControl","existLayers","getMaps","createMapDialog","buttonName","addLink","tryCreateMap","createMap","saveMapInternal","mapTitle","mapID","saveTree","mStyleEditor","UserData","attributesToSave","BaseLayers","propsToSave","attrName","DEFAULT_STYLE_KEYS","stylesHash","MapJson","saveMap","saveMapAs","AuthWidget","_authManager","authManager","showAccountLink","accountLink","showMapLink","getUserInfo","userName","vm","authWidget","dropdownItems","newWindow","defaultMapLink","mapLink","isAdmin","dropdown","callbacks","native","getNative","changePasswordDialog","$iframeContainer","loginDialog","iframeContainer","eventName","auth","_dialogCanvas","oldInput","newInput","confirmInput","changeButton","checkPassw","loginDialogTemplate","GeoMixerAuthWidget","loginCallback","_createLogin","showLoginDialog","_createLogout","logoutSpan","userText","userSpan","hideLogin","isMapsSite","loginInput","passwordInput","loginButton","checkLogin","err","errorDiv","registrationCallback","IconSidebarWidget","EventTarget","_collapsedWidth","collapsedWidth","_extendedWidth","extendedWidth","_tabsContainer","querySelector","_panesContainer","_onTabClick","_panes","setPane","paneOptions","defaultPaneOptions","activeTabId","_activeTabId","_renderTabs","_ensurePane","pane","paneId","_isAnimating","_setTabActive","_setActiveClass","_isOpened","createEvent","initEvent","detail","dispatchEvent","querySelectorAll","getWidth","getActiveTabId","isOpened","paneEl","activeId","tabId","getFlag","hoveredTabId","tabContainerEl","tabEl","_tree","_findElem","propName","propValue","nodeDepth","forEachNodeRec","filterFunc","forEachLayerRec","newChildren","newNode","newFirstLevelGroups","setSubtreeVisibility","vis","triggerSubnode","isList","triggerNodeVisible","visibleNode","childVisible","gmxDrawingObject","Functions","GetFullName","TypeName","ObjName","Geometry","imagesHost","sType","sName","sFullName","GetPath","oFoundObject","sObjectsSeparator","bParentAfter","sObjNameField","oParentObj","Parent","sObjectName","CountryCode","GetPropertiesString","oProps","sPropSeparator","sResultString","sPropName","ResultRenderer","sInitImagesHost","bInitAutoCenter","sImagesHost","bAutoCenter","arrContainer","counts","getSearchIcon","iPosition","iconAnchor","popupAnchor","bindHoverPopup","bindPopup","DrawObject","oContainer","iCount","sDescr","centerMapElem","boundaryMapElem","CntrLon","CntrLat","geoJson","onEachFeature","boundary","CenterObject","iZoom","MinLon","MaxLon","MinLat","MaxLat","DrawObjects","iDataSourceN","arrFoundObjects","layerGroup","mapObjects","ResultList","oRenderer","ImagesHost","Container","arrDisplayedObjects","iLimit","iPagesCount","oResultCanvas","arrTotalResultSet","oLoading","fnNotFound","SetDisplayedObjects","divChilds","divPages","oDataSource","drawPagesRow","drawObject","elemDiv","bIsParent","realPath","searchElemHeader","drawRows","arrObjects","tbody","elemTR","elemTD","gmxGeoCodeShpDownload","shpFileLink","objsToDownload","ObjCode","distance","startFrom","SearchResult","drawTable","downloadButton","area","drawSearchResult","arrDataSourceList","liInner","downloadVector","fnDisplayedObjectsChanged","fnObjectClick","fnDownloadSHP","ShowResult","sTotalListName","arrTotalList","foundSomething","ulSearch","CreatePager","results","makeNavigButton","pager","imga","containerList","pcount","OneOf","fnShowPage","pagelink","remains","nextPages","nextButTitle","lastindex","rest","GetDisplayedObjects","ShowLoading","ShowError","SearchLogic","oSearchResultDiv","searchByStringHooks","fnBeforeSearch","fnLoad","fnAfterSearch","onDisplayedObjectsChanged","onObjectClick","addSearchByStringHook","searchString","parseCoordinates","panTo","fnUnload","lstResult","showResult","srcElement","priority","removeSearchByStringHook","layersSearch","Promise","promisesArr","layersToSearch","req","withCredentials","handleResponse","res2","statusText","searchReq","iRespCount","arrLayerResult","arrResult","iServer","limitSearchResults","LayerSearchLimit","arrDisplayProperties","attrTypes","NAME","OsmDataProvider","searchProviders","Osm2DataProvider","TypeCode","Request","_serverBase","_key","headers","Headers","cache","_onFetch","strong","retrieveGeometry","_this2","_strong","_withoutGeometry","initPromise","useInternalSearch","json1","searchLogic","json2","json3","rs","_convertGeometry","ObjNameShort","loadShp","queryLoadShp","uploader","_regenerateControl","upload","inputControl","_showObjectsOnMap","loadAndShowFiles","files","flatten","_queryLoadShp","wmsProjections","getTextContent","textContent","getScale","pow","getWMSMapURL","requestProperties","CRSParam","miny","maxy","minx","maxx","bbox","mercMin","mercMax","isMerc","transparentParam","transparent","isV130","minX","maxX","minY","maxY","parseWMSCapabilities","supportedVersions","SRSTagName","BBOXTagName","serviceLayers","xml","mainTag","layersXML","supportedSrs","srsName","loadServerData","WFS","WMS","wfsParser","gmlns","kmlns","axisOrder","elementsNS","getElementsByTagNameNS","allNodes","potentialNode","fullName","nodeName","namespaceURI","getChildValue","nodeType","nodeValue","geometries","strResp","parsedNS","order","nodeList","parsePoint","coordString","xList","yList","swapCoordinates","parseLineString","pointList","parsePolygon","_wfsParser","jsonParser","resp","geometryArr","newCoords","newCoords2","_jsonParser","queryServerData","wfsFormats","oldBalloon","oldBalloonIndex","proj","customParams","parseFunc","convertCoords","coordsStr","coordsPairs","parsedCoords","parseGML","goButton","doGetCapabilities","getCapabilities","customParamsDiv","capabilitiesUrl","servicelayers","parseWFSCapabilities","featuresXML","loadGML","parentTreeCanvas","loadLayerParams","drawGML","saveGML","globalFlashMap","forEachObject","promptFunction","saveObjects","geomsPresent","extendArray","addData","clear","drawWMS","replaceElem","serverParams","ulCanvas","ulChilds","gmxObject","clearLayers","imageOverlay","spanElem","boxes","customWMSParamsManager","_targetDiv","drawWFS","divFormat","formatSelect","newFormat","objUrl","elemChilds","_queryServerDataWFS","_queryServerDataWMS","layersVisibility","wfsLayerInfo","addHeaderLinks","isHeaderLinks","headerLinks","headerLinkItems","TransparencySliderWidget","sliderContainer","isOpaque","updateOnOffIcon","isOpaqueNew","range","dragging","curValue","onOffTitle","GmxLayers2","collapsed","baseLayers","overlays","_initLayout","_iconClick","_iconContainer","stateChange","controlClassName","iconClassName","listClassName","iconContainer","_listContainer","openingDirection","_prefix","touch","disableScrollPropagation","placeHolder","_placeHolder","useHref","_layersLink","_expand","_onInputClick","_collapse","_baseLayersList","_separator","_overlaysList","_addLayer","overlay","_addItemObject","_addItem","defaultChecked","_createRadioElement","presentLayer","presentIndex","_layerControlInputs","holder","_checkDisabledLayers","baseLayersPresent","overlaysPresent","togglable","styleActive","GmxIcon","addBefore","_parent","_controlCorners","_id","gmxLayers2","EditObjectControlsManager","_editControls","_paramsHooks","oid","iD","addParamsHook","applyParamsHook","objectId","getInputElement","FieldsCollection","_asArray","_asHash","origIndex","updateValue","getValue","isRequired","userZIndexDelta","validate","allowDuplicates","afterPropertiesControl","geometryInfoContainer","originalGeometry","drawingObjectLeafletID","bindDrawingObject","objStyle","currentStyle","bindGeometry","geojson","GeoJSON","styleParams","shape","strokeStyle","fieldsCollection","createDialog","createButton","isSaving","originalEvent","dataTransfer","anyErrors","checkValue","selectedGeom","curGeomString","origGeomString","styleEditingDialog","drawAttrList","firstInput","geomTitleTmpl","geometryUI","onGeometrySelection","constant","getUI","rowName","rowType","setValue","validationFunc","fieldHeader","fontWeight","afterPropUI","geometryRow","setGeometry","getGeometryObj","getLayer","mykosmosnimki","initTranslations","ProfilePlugin","profile","billing","developer","firstName","lastName","email","phone","company","companyProfile","companyPosition","isCompany","subscribe","saveChanges","used","remain","fileStorage","fileStorageUsed","fileStorageRemain","vectorLayerStorage","vectorLayerStorageUsed","vectorLayerStorageRemain","subscription","subscriptionUsed","subscriptionRemain","smsAvailable","apiKeys","apiKeyInvite","apiKeyDomain","apiKeyDomainCap","apiKeyDirect","apiKeyDirectCap","apiKeyList","apiKeyListCap","apiKeyDirectShort","apiKeyFilter","apiKeyFilterApply","apiKeyEnabled","apiKeyDisabled","apiKeyCreated","directKeyPurpose1","directKeyPurpose2","apiKeySite","apiKeyReadAgreement","apiKeyAgreement","apiKeyConditions","apiKeyGet","apiKeyUrge","apiKeyAccept","apiKeyCancel","apiKeyReceive","ErrorApiKeySiteEmpty","ErrorApiKeySiteInvalid","ErrorApiKeyConditionsNotAccepted","clientRegistration","appName","clientID","clientSecret","registerClient","getNew","cancelNew","passwordSaved","passwordChanged","newp","repeat","submitp","megabyte","yes","ErrorNOT_AUTHORIZED","ErrorLoginEmpty","ErrorLoginFormat","ErrorLoginExists","ErrorAppName","ErrorRedirectUri","ErrorOldPassword","ErrorNewPassword","ErrorNotMatch","ErrorCapchaRequired","ErrorWrongCapcha","ErrorEmailEmpty","ErrorWrongEmail","ErrorEmailExists","dataUpdateSuccess","registration","registrationPageAnnotation","capcha","register","backOn","loginPage","ppBackScreen","ppMainParts","showProfile","ppFrame","ppScrollableContainer","ppMenu","pageTemplate","page1","text_input","checkbox_group","button_input","page2","column1","column2","column3","cells","page3","form_caption","block","link_button","span_nl","successmess_timeout","changePassForm","slideUp","changePassControls","Phone","Company","Profile","Position","IsCompany","Subscribe","Key","Errors","newsecret_timeout","closeApiKeyDialog","client_secret","AppName","RedirectUri","ppPages","changePass_timeout","oldpassword","slideDown","akd","showApiKeyDialog","dtype","clearPageErrors","startW","startH","akDialog","apiKeyActivation","checkboxes","Apikey","apiKeyResp","IsActive","createTbl","re","search","Domain","AllowDirect","Created","mCustomScrollbar","dif","th","fordirect","fordomain","akForm","licence","spacer","agree","getKey","respHandler","clearError","domain","keydown","which","clearInputErrors","es","nextAll","m1","m2","menuEntryTemplate","showPage","ppMenuEntries","mousedown","resizePanel","fillProfile","onsuccess","Email","CompanyProfile","CompanyPosition","fillBillingPage","fillDeveloperPage","FileStorageUsed","toFixed","FileStorageAvailable","VectorLayerStorageUsed","VectorLayerStorageAvailable","VectorLayers","VectorLayerObjects","SmsAvailable","SubscriptionUsed","SubscriptionRemain","ClientSecret","showRegistrationForm","registrationForm","confirmScreen","errorSummaryHeight","errorSummary","captcha","permalink","regFormDialog","checkExist","regForm","regLink","LayerRCControl","titleTemplate","pathTemplate","advancedLink","layerTagTitle","attributeTitle","LayerRCProperties","RCMaskForRasterTitle","RCMaskForRasterPath","ColumnTagLinks","isAnyLinks","LayerRasterCatalogWidget","rcProperties","advancedMode","updateVisibility","RCCheckbox","advancedParamsLink","pathInput","realTagInfo","realTagsInfo","fakeTagsInfo","iT","fakeTagManager","columnTagLinks","iP","tagContainer","TemporalLayerParams","isTemporal","maxShowPeriod","minPeriod","maxPeriod","getPeriodString","periods","PERIOD_STEP","QuicklookParams","fromServerString","quicklookString","X1","Y1","X2","Y2","X3","Y3","X4","Y4","toServerString","LatLngColumnsModel","XCol","YCol","LayerProperties","initFromViewer","NameObject","ZIndexField","ContentID","EncodeSource","TableName","TableCS","Attributes","AttrTypes","metaProperties","convertedTagValues","mp","tempPeriods","TemporalPeriods","GeometryXCol","GeometryYCol","quicklookParams","initFromServer","geometryChanged","stype","reqParams","rcProps","RC","tempProperties","TemporalLayer","VectorLayerID","geometrytype","copyParams","sqlString","buffer","bufferSize","exp","expression","Sql","parsedColumns","parseColumns","geomColumns","GeometryColumnsLatLng","geomCount","ColX","ColY","GeometryDataSource","curBorder","GeometryChanged","BorderFile","BorderGeometry","RasterLayerID","multiLayerInfo","multiReqParams","coordColumns","dateColumns","ColumnSimpleType","IsIdentity","IsPrimary","ShpEncodingWidget","_encodings","_DEFAULT_ENCODING","_curEncoding","drawWidget","initialEncoding","isStandard","enc","opt","anotherCheckbox","anotherInput","tr1","tr2","getServerEncoding","TemporalLayerParamsWidget","paramsModel","PERIODS","_columns","isAdvancedMode","wasInAdvancedMode","updateColumnsSelect","selectDateColumn","curColumn","foundOption","paramsToSet","updateColumns","textarea","textTemplate","valuesArr","addValueFlag","attrType","textArea","ILazyAttributeValuesProvider","LazyAttributeValuesProviderFromArray","groupTag","hasCustomTooltip","titleObj","sqlTemplates","isRus","descRus","descEng","_curDiv","isAttributeExists","getAttributeType","getValuesForAttribute","arrSuggestCanvas","canvasArr","isNumber","targetTextarea","attrValuesProvider","changeCallback","selectors","functions","operators","attrsSuggest","functionsSuggest","transformHash","sqlFunctions","operatorsSuggest","LayerQuicklookWidget","regTitle","selectTemplate","DEFAULT_OPTION","isDefault","layerColumns","isMinimized","quicklook","idx","regSelect","targetName","initValue","SafeString","opts","column","updateRegistrationStatus","quicklookText","setQuicklook","capitaliseFirstLetter","ManualAttrModel","isRCLayer","_attributes","expressions","addAttribute","IsComputed","changeName","changeType","newType","changeExpression","newExp","deleteAttribute","addInternalColumns","isInternal","server","moveAttribute","oldIdx","newIdx","initFromServerFormat","serverColumns","TYPES","oldName","toServerFormat","OldName","replaceString","string","DOUBLE","INTEGER","STRING","TIME","DATE","DATETIME","BOOL","ManualAttrView","headerName","headerType","headerExp","selectorTemplate","_trs","_isActive","isAddingNew","createTypeSelector","selectedType","createRow","sqlSelector","cellsArr","typeSelector","serverType","nameSelectorLength","nameSelector","redraw","newAttr","theader","fieldset","fileBrowser","_homeDir","_path","alternativePath","newPath","newAlternativePath","slash","getAlternative","isRoot","isInited","isInHome","getRoot","getParentFolder","lastIndexOf","currentFiles","fileCanvas","fileHeader","fileUpload","ext","index1","ext1","index2","ext2","Size","shownPathScroll","returnMask","_discs","ext7z","MAX_UPLOAD_SIZE","mask","oDialog","loadInfo","loadInfoHandler","titleHeight","_showWarningDialog","_uploadFilesAjax","progressBar","progressbar","total","indexSlash","shownPath","getFiles","mapFolder","LayersDir","currentSortFunc","totalSize","createHeader","createUpload","_updateUploadVisibility","tdAddFolder","reloadButton","homeButton","discButtonTds","discButtons","newFolderName","showFolderButton","newFolderButton","createFolder","formFile","attach","ParentDir","dropInfoDiv","_isRestrictedPath","doProcessResponce","getFilesHandler","reloadFiles","pathWidget","shortPath","pathElements","highlightPath","appendElem","elemIndex","legnth","hover","curFolder","curText","quickSearch","findContent","offsetTop","_getParentFolder","nameSort","extSort","sizeSort","dateSort","tdRoot","rootButton","tableHeaderTr","prevDirTr","tableFilesTrs","parentFolder","drawFolders","drawFiles","getCurrentSortFunc","sec","sysDate","folders","Directory","tdReturn","returnButton","createFolderActions","tdSize","makeSize","createFileActions","fullPath","enableZip","enableUnzip","zipUnzipActionFactory","isZip","tableBrowser","tables","_tableBrowser","renderTableRow","tdName","tableProvider","tableTable","filterInput","SelectLatLngColumnsWidget","sourceColumns","updateWidget","selectLat","selectLon","newFields","getSourceColumns","getFileExt","LayerEditor","standardTabs","additionalUI","_originalTabs","_saveButton","tabName","selectedTab","genPageDiv","createUI","applyInitHooks","mainContainer","metadataContainer","advancedContainer","attrContainer","origLayerProperties","_createPageMain","_createPageMetadata","_createPageAdvanced","_createPageAttributes","gmxControlIconManager","oldDrawing","isVector","needRetiling","onceCallback","once","lis","containers","saveMenuCanvas","getTabIndex","selectIndex","activate","activeIndex","newTitle","currentGeometryType","geometryTitle","geometryTypes","selectImage","imgHtml","_createPageVectorSource","_createPageRasterSource","sourceType","shapePath","shapePathInput","shapeFileLink","encodingParent","xlsColumnsParent","fileSourceColumns","fileSelectedColumns","fileColumnsWidget","encodingWidget","oldValue","Exists","sourceFile","tableLink","tableColumnsParent","tableSourceColumns","tableSelectedColumns","tableColumnsWidget","tablePathInput","TableCSParent","TableCSSelect","sourceTable","RadioButtonsWidget","buttons","activeType","_activeType","getActiveType","geometryTypeContainer","geometryTypeWidget","editAttributeLink","attrViewParent","geometryTypeTitle","sourceManual","sourceContainers","sourceCheckbox","admin","activeIdx","sourceTab","activeCheckboxID","selectedSource","sourceTr2","sourceTitle","sourceControls","tilePath","tilePathInput","tileCatalogLink","tileFileLink","shapeLink","drawingBorderLink","drawingBorderDescr","removeBorder","divBorder","catalogPathElems","filePathElems","trPath","trShape","shapeVisible","cssText","drawingBorder","appendMetadata","platform","dateTag","timeTag","dateInt","timeInt","dateString","timeString","formatTime","indexExt","isNewLayer","fileColumnsContainer","fileAttrModel","fileAttrView","allowEdit","temporalLayerParent","temporalProperties","temporalLayerView","isTemporalCheckbox","updateTemporalVisibility","temporalFieldset","updateTemporalColumns","RCTemplate","rcFieldset","isRC","nameObjectInput","_initHooks","addInitHook","nsMapCommon","generateWinniePermalink","mapProps","layersState","config","app","baseLayersManager","selectLayersFromTree","mapTree","_array","_hash","_getLayersInGroup","groupTitle","visitor","isInGroup","groupHash","asArray","asHash","names","_attrs","_isInited","_isProcessing","getAttributesTypesHash","_attrsTypes","EYE","_registered","nr","forceIt","restoreStyles","curCSS","oldVisibility","oldPosition","offsetLeft","offsetParent","browser","safari","getSize","wb","hb","getClient","de","getScroll","iw","ih","scrollWidth","scrollHeight","getMargins","toInteger","getPadding","getBorder","traverseDOM","nodeEl","getInnerWidth","offsetW","getInnerHeight","offsetH","getExtraWidth","boxModel","getExtraHeight","isChildOf","parentEl","compareDocumentPosition","prEl","centerEl","clientScroll","easing","easeout","duration","charMin","tpl","onBeforeShow","onSubmit","livePreview","flat","fillRGBFields","cal","rgb","HSBToRGB","fillHSBFields","fillHexFields","HSBToHex","setSelector","selectorIndic","setHue","hue","setCurrentColor","currentColor","setNewColor","newColor","keyDown","pressedKey","charCode","HexToHSB","fixHex","fixHSB","RGBToHSB","fixRGB","downIncrement","current","upIncrement","moveIncrement","unbind","downHue","upHue","moveHue","downSelector","upSelector","moveSelector","enterSubmit","leaveSubmit","clickSubmit","origColor","viewPort","getViewport","compatMode","HexToRGB","v","t1","t2","t3","RGBToHex","restoreOriginal","showPicker","hidePicker","setColor","ColorPickerHide","ColorPickerShow","ColorPickerSetColor","gridPlugin","gridSettings","gridColorSettings","gridStepSettings","gridUnitsSettings","gridFormatSettings","unitsKilometers","unitsDegrees","formatDecimal","formatDM","formatDMS","latitude","longitude","ConfigureGridMenu","manager","tempStyle","lm","createGridLeftMenu","gridConfigLeftMenu","createGridConfig","gridConfigCanvas","gridConfigTitle","gridConfigIcon","CreateGridConfigIcon","createConfigDialog","configDialog","gridConfigEditor","fcp","saveOptions","gridStepYInputPanel","gridStepXInputPanel","gridStepYInput","gridStepXInput","gridUnitsConfig","gridStepConfig","gridFormatConfig","gridStepUnitsDegrees","gridStepUnitsKilometers","gridFormatDD","units","gridFormatDM","gridFormatDMS","gridSetStepButton","gridResetStepButton","enableFormats","disableFormats","handleUnits","handleFormats","setStep","updateInputsValues","setTitleFormat","clearStep","customStep","defaultStep","setUnits","titleFormat","MAX_SIZE","EPS","mapExport","settings","zoom","fileType","formats","geoTiff","geoTiffJpeg","jpeg","png","filetypes","raster","mbTiles","kmz","unselect","zoomToBox","zoomToLevel","cancel","sizeWarn","valueWarn","inQueue","inProcess","exportError","exportTooltip","formatTypes","MapExportMenu","ExportModel","selArea","widthValueErr","heightValueErr","widthSizeErr","heightSizeErr","zoomLevels","getZoomLevels","fileTypes","exportErr","ExportView","updatedFileTypes","updateArea","updateSize","handleValueError","handleSizeError","updateName","updateZoom","handleExportError","handleFormat","zoomToBoxButton","zoomToLevelButton","areaButton","zoomSelect","heightInput","fileSelect","exportNameInput","exportButton","inputs","progressBarContainer","cancelButton","exportErrorMessage","levels","setZoom","selectedZoom","_updateCoords","setFormat","selectedFormat","setFileType","selectedFileType","setName","selectArea","mapBounds","latLngs","getSouthWest","getNorthWest","getNorthEast","getSouthEast","converted","_convertFromLatLngs","dims","_getDimensions","xx","yy","bottomLeft","_getMin","_getMax","topLeft","topRight","bottomRight","initialBounds","_convertToLantLngs","rect","rectangle","_createFrame","unselectArea","_removeFrame","initialCoords","rings","_getLatLngsArr","screenCoords","dimensions","mapStateParams","exportParams","spinMessage","transparentColor","processLink","param","url2","downloadFile","Progress","isChrome","isSafari","cancelExport","newBounds","valueErr","sizeErr","_revertCoords","newRect","getLatLngs","editable","dashArray","mobile","frame","_resizeFrame","latlngs","ll","Infinity","bufferZones","selectTooltip","selectedLayer","layerTypeError","createBuffer","BufferZonesMenu","BufferModel","selectedLayerName","BufferView","hasAttribute","setBufferSize","MAX_INDEX_COUNT","KM_PER_DEGREE","indexGrid","onLat","onLng","indexCountWarn","nameWarn","IndexGridMenu","IndexGridModel","xStep","yStep","xCount","yCount","xStepErr","yStepErr","indexCount","indexCountErr","maxLat","maxLng","minLat","minLng","maxLatErr","maxLngErr","minLatErr","minLngErr","nameErr","IndexGridView","updateStepInput","updateLatLngInput","handleInputErr","updateIndexCount","handleIndexCountErr","minLatInput","maxLatInput","maxLngInput","minLngInput","xStepInput","yStepInput","createIndexGridButton","_roundInputNumber","inputName","setCreateButtonStatus","setWarnMessage","updateXStep","updateYStep","warnMessage","_updateCorners","_countIndex","createIndexGrid","layerParams","indexes","generatePolygons","def2","_convertXStep","_convertYStep","north","west","letterIndexes","_getLetterIndexes","letter","_latlngs","_getBounds","east","south","_getLatLngDimensions","lats","lngs","_revertLatLngs","_convertToMercator","centerLat","centerY","PI","cos","convert","srcNum","scrDict","targetDict","targetNum","srcDictIdx","buildLettersArray","xlsDict","jsDict","radix","numStart","numEnd","rnt","numb","jsNum","photoLayer","catalog","newCatalog","existingCatalog","available","loadShort","processing","successResult","exifError","ok","PhotoLayer","PhotoLayerModel","photoLayersFlag","currentPhotoLayer","photoLayers","sandbox","PhotoLayerView","getPhotoLayers","createSandbox","updatePhotoLayersList","firstButton","uploadBlock","isPhotoLayer","setCatalogType","newContainer","existingContainer","newLayerInput","matchingLayer","currentPhotoLayerName","selectFile","uploadLabel","uploadButton","spinContainer","okButton","uploadResSuccess","uploadResError","uploadParams","PhotoSource","imageUrlParams","bigImageUrlParams","imageUrl","bigImageUrl","balloonString","renderStyle","modifyMapObjects","Action","Styles","modifyMapParams","MapName","Objects","modifyMapUrl","photoAppendParams","photoAppendUrl","bindClusters","iconCreateFunction","cluster","photoClusterIcon","divIcon","getChildCount","iconSize","maxClusterRadius","spiderfyOnMaxZoom","spiderfyZoom","spiderfyDistanceMultiplier","disableClusteringAtZoom","afterLoad","appended","Appended","updated","Updated","addCoords","resObj","NoCoords","uglw","headerTitle","listheader","groupProps","shareLabel","Group","idAttribute","GroupList","Collection","GroupListView","rawAttributes","users","groupID","groupSecurity","UserGroupSecurity","_popoverGroupID","UserGroupListWidget","_mainTemplate","groupList","listView","refilterUsers","lastValue","membersJson","MembersJson","nicknameInput","nickname","publicCheckbox","SharedResources","propsTemplate","Dialog","minSize","maxSize","initOpen","_attributions","setLocation","_oldMousePos","_move","setSize","lock","_resizerNode","_grabberNode","_closeNode","unlock","freeze","unfreeze","_content","getElement","_updateContent","_updateLayout","innerContainer","_innerContainer","grabberNode","grabberIcon","_handleMoveStart","closeNode","closeIcon","_handleClose","resizerNode","resizeIcon","_handleResizeStart","contentNode","_contentNode","_handleMouseMove","_handleMouseUp","_resizing","_moving","diffX","diffY","newY","newX","hasChildNodes","mapHostName","_mapHostName","curUri","directory","initGeoMixer","oSearchLeftMenu","GmxGrid","restoreOptions","gridView","configureGrid","createMenuNew","getPluginToMenuBinding","menuItemName","menuTitle","paramsClone","unsel","onsel","onunsel","isMapEditor","isLogined","delimiter","mapExportMenu","main","advanced","PhotoLayerDialog","oDrawingObjectGeomixer","indexGridMenu","fillPluginsMenu","menuPlugins","createToolbar","SliderControl","_widget","sliderControl","uploadFileIcon","gmxIcon","resolveToolConflict","iconGroup","saveMapIcon","createVectorLayerIcon","createRasterLayerIcon","createLayerIconGroup","gmxIconGroup","bookmarkIcon","printIcon","permalinkIcon","shareIconControl","ShareIconControl","permalinkManager","permalinkUrlTemplate","embeddedUrlTemplate","winnieUrlTemplate","previewUrlTemplate","gridIcon","_onMouseDown","boxZoom","shiftKey","removeHooks","addHooks","osmProvider","showOnMap","searchControl","SearchControl","retrieveManyOnEnter","providers","searchContainer","gmxLayers","createDefaultMenu","parseURLParams","kvp","givenMapName","virtualLayerManager","addLayerClassLoader","languageFromSettings","defaultLang","shownTitle","pageTitle","Warning","customErrorTemplate","commonErrorTemplate","errInfo","stackTrace","stacktrace","parseReferences","documentHref","tinyRef","defaultState","mx","my","mt","dt","tempPermalink","headerHeight","outerHeight","iconSidebarWidget","mapNameHeight","baseHeight","leftContentContainer","editUIInited","initEditUI","isEditableLayer","hasEditableLayer","iL","listeners","editIcon","clickHandler","bringToTopItem","disableFlip","disablePopup","enableFlip","enablePopup","initAuthWidget","AccountModule","nativeAuthWidget","authManagerProxy","showUserList","authPlaceholder","_script","execute","onresize","Default","imagePath","_getIconUrl","Marker","shadowUrl","shadowSize","shadowAnchor","iconRetinaUrl","loadMapProperties","serverHost","processGmxMap","initHeader","initDefaultBaseLayers","gmxLocale","iconPrefix","baseMap","defaultHostName","bl","urlTemplate","tileLayer","loadLayer","layersToLoad","satellite","OSMHybrid","logo","logoImage","defCenter","visBounds","mercBounds","ws","screenSize","zoomX","zoomY","hideLanguage","langContainer","languageWidget","contextmenu","attributionControl","trackResize","fadeAnimation","gmxPhantom","zoomAnimation","Map","insertItem","quickLookMinZoom","defaultMinZoom","saveMapPosition","getMapPosition","gmxMouseDown","controlsOptions","loc","baseLayerDef","initDefaults","gmxAPI","mapProp","baseLayersControl","initTemporalLayers","fireEvent","visibleTemporalLayers","getLayersListWithTarget","targetLayer","treeStyles","treeSt","tmpDateInterval","dateLocal","fixVisibilityConstrains","isAnyVisibleChild","childrenVisibility","oldTree","defaultLayersVisibility","setMapCopyright","createTabFunction","symbol","inactive","leftMainContainer","layersTreePane","headerDiv","updateLeftPanelVis","ctrl","cntr","objInfo","featureOptions","openPopup","lid","filtersArr","filteredId","_unbindedTemporalLayers","treeLayers","dataSources","coord","prompt"],"mappings":"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"}